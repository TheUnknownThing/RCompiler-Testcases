USE compiler;
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (1, "comprehensive1", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogdmVuaWxsYWxlbW9uClRpbWU6IDIwMjUtMDktMDQKVmVyZGljdDogUGFzcwpDb21tZW50OiBDb21wcmVoZW5zaXZlIHRlc3Qgb2Ygc2VnbWVudCB0cmVlIG1lcmdpbmcKKi8KCmNvbnN0IE1BWE46IHVzaXplID0gMjAwOwpjb25zdCBMT0dfTUFYTjogdXNpemUgPSAxMDsKY29uc3QgTUFYU0VHOiB1c2l6ZSA9IDIwMDA7CgpzdHJ1Y3QgRm9vZCB7CiAgICBjbnQ6IGkzMiwKICAgIHR5OiBpMzIsCn0KaW1wbCBGb29kIHsKICAgIGZuIGJldHRlcihzZWxmLCBvdGhlcjogRm9vZCkgLT4gRm9vZCB7CiAgICAgICAgaWYgKHNlbGYuY250ID09IG90aGVyLmNudCkgewogICAgICAgICAgICBpZiAoc2VsZi50eSA8IG90aGVyLnR5KSB7IHNlbGYgfSBlbHNlIHsgb3RoZXIgfQogICAgICAgIH0gZWxzZSBpZiAoc2VsZi5jbnQgPiBvdGhlci5jbnQpIHsKICAgICAgICAgICAgc2VsZgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG90aGVyCiAgICAgICAgfQogICAgfQp9CgpzdHJ1Y3QgU2VnVCB7CiAgICBsOiBpMzIsCiAgICByOiBpMzIsCiAgICBsYzogdXNpemUsCiAgICByYzogdXNpemUsCiAgICB2YWw6IEZvb2QsCn0KCmZuIG5ld19zZWd0KAogICAgc2VnX3Bvb2w6ICZtdXQgW1NlZ1Q7IE1BWFNFR10sCiAgICBzZWdfY250OiAmbXV0IHVzaXplLAogICAgbDogaTMyLAogICAgcjogaTMyLAogICAgdmFsOiBGb29kLAopIC0+IHVzaXplIHsKICAgICpzZWdfY250ICs9IDE7CiAgICBzZWdfcG9vbFsqc2VnX2NudF0gPSBTZWdUIHsKICAgICAgICBsOiBsLAogICAgICAgIHI6IHIsCiAgICAgICAgbGM6IDAsCiAgICAgICAgcmM6IDAsCiAgICAgICAgdmFsOiB2YWwsCiAgICB9OwogICAgKnNlZ19jbnQKfQoKZm4gYnVpbGQoc2VnX3Bvb2w6ICZtdXQgW1NlZ1Q7IE1BWFNFR10sIHNlZ19jbnQ6ICZtdXQgdXNpemUsIGw6IGkzMiwgcjogaTMyKSAtPiB1c2l6ZSB7CiAgICBpZiAobCA+IHIpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIGlmIChsID09IHIpIHsKICAgICAgICByZXR1cm4gbmV3X3NlZ3Qoc2VnX3Bvb2wsIHNlZ19jbnQsIGwsIHIsIEZvb2QgeyBjbnQ6IDAsIHR5OiBsIH0pOwogICAgfQogICAgbmV3X3NlZ3Qoc2VnX3Bvb2wsIHNlZ19jbnQsIGwsIHIsIEZvb2QgeyBjbnQ6IDAsIHR5OiAwIH0pCn0KCmZuIHVwZGF0ZShzZWdfcG9vbDogJm11dCBbU2VnVDsgTUFYU0VHXSwgc2VnX2NudDogJm11dCB1c2l6ZSwgaWR4OiB1c2l6ZSwgcG9zOiBpMzIsIGRlbHRhOiBpMzIpIHsKICAgIGlmIChpZHggPT0gMCkgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGxldCBsOiBpMzIgPSBzZWdfcG9vbFtpZHhdLmw7CiAgICBsZXQgcjogaTMyID0gc2VnX3Bvb2xbaWR4XS5yOwogICAgaWYgKHBvcyA8IGwgfHwgcG9zID4gcikgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGlmIChsID09IHIpIHsKICAgICAgICBzZWdfcG9vbFtpZHhdLnZhbC5jbnQgKz0gZGVsdGE7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgbGV0IG1pZDogaTMyID0gKGwgKyByKSAvIDI7CiAgICBpZiAocG9zIDw9IG1pZCkgewogICAgICAgIGlmIChzZWdfcG9vbFtpZHhdLmxjID09IDApIHsKICAgICAgICAgICAgc2VnX3Bvb2xbaWR4XS5sYyA9IGJ1aWxkKHNlZ19wb29sLCBzZWdfY250LCBsLCBtaWQpOwogICAgICAgIH0KICAgICAgICB1cGRhdGUoc2VnX3Bvb2wsIHNlZ19jbnQsIHNlZ19wb29sW2lkeF0ubGMsIHBvcywgZGVsdGEpOwogICAgfSBlbHNlIHsKICAgICAgICBpZiAoc2VnX3Bvb2xbaWR4XS5yYyA9PSAwKSB7CiAgICAgICAgICAgIHNlZ19wb29sW2lkeF0ucmMgPSBidWlsZChzZWdfcG9vbCwgc2VnX2NudCwgbWlkICsgMSwgcik7CiAgICAgICAgfQogICAgICAgIHVwZGF0ZShzZWdfcG9vbCwgc2VnX2NudCwgc2VnX3Bvb2xbaWR4XS5yYywgcG9zLCBkZWx0YSk7CiAgICB9CiAgICBsZXQgbXV0IHJlczogRm9vZCA9IEZvb2QgeyBjbnQ6IDAsIHR5OiAwIH07CiAgICBpZiAoc2VnX3Bvb2xbaWR4XS5sYyAhPSAwKSB7CiAgICAgICAgcmVzID0gc2VnX3Bvb2xbaWR4XS5sY192YWwoc2VnX3Bvb2wpLmJldHRlcihyZXMpOwogICAgfQogICAgaWYgKHNlZ19wb29sW2lkeF0ucmMgIT0gMCkgewogICAgICAgIHJlcyA9IHNlZ19wb29sW2lkeF0ucmNfdmFsKHNlZ19wb29sKS5iZXR0ZXIocmVzKTsKICAgIH0KICAgIHNlZ19wb29sW2lkeF0udmFsID0gcmVzOwp9CgppbXBsIFNlZ1QgewogICAgZm4gbGNfdmFsKCZzZWxmLCBzZWdfcG9vbDogJltTZWdUOyBNQVhTRUddKSAtPiBGb29kIHsKICAgICAgICBzZWdfcG9vbFtzZWxmLmxjXS52YWwKICAgIH0KICAgIGZuIHJjX3ZhbCgmc2VsZiwgc2VnX3Bvb2w6ICZbU2VnVDsgTUFYU0VHXSkgLT4gRm9vZCB7CiAgICAgICAgc2VnX3Bvb2xbc2VsZi5yY10udmFsCiAgICB9Cn0KCmZuIG1lcmdlKHNlZ19wb29sOiAmbXV0IFtTZWdUOyBNQVhTRUddLCBzZWdfY250OiAmbXV0IHVzaXplLCB1OiB1c2l6ZSwgdjogdXNpemUpIC0+IHVzaXplIHsKICAgIGlmICh1ID09IDApIHsKICAgICAgICByZXR1cm4gdjsKICAgIH0KICAgIGlmICh2ID09IDApIHsKICAgICAgICByZXR1cm4gdTsKICAgIH0KICAgIGlmIChzZWdfcG9vbFt1XS5sID09IHNlZ19wb29sW3VdLnIpIHsKICAgICAgICBzZWdfcG9vbFt1XS52YWwuY250ICs9IHNlZ19wb29sW3ZdLnZhbC5jbnQ7CiAgICAgICAgcmV0dXJuIHU7CiAgICB9CiAgICBzZWdfcG9vbFt1XS5sYyA9IG1lcmdlKHNlZ19wb29sLCBzZWdfY250LCBzZWdfcG9vbFt1XS5sYywgc2VnX3Bvb2xbdl0ubGMpOwogICAgc2VnX3Bvb2xbdV0ucmMgPSBtZXJnZShzZWdfcG9vbCwgc2VnX2NudCwgc2VnX3Bvb2xbdV0ucmMsIHNlZ19wb29sW3ZdLnJjKTsKICAgIGxldCBtdXQgcmVzOiBGb29kID0gRm9vZCB7IGNudDogMCwgdHk6IDAgfTsKICAgIGlmIChzZWdfcG9vbFt1XS5sYyAhPSAwKSB7CiAgICAgICAgcmVzID0gc2VnX3Bvb2xbdV0ubGNfdmFsKHNlZ19wb29sKS5iZXR0ZXIocmVzKTsKICAgIH0KICAgIGlmIChzZWdfcG9vbFt1XS5yYyAhPSAwKSB7CiAgICAgICAgcmVzID0gc2VnX3Bvb2xbdV0ucmNfdmFsKHNlZ19wb29sKS5iZXR0ZXIocmVzKTsKICAgIH0KICAgIHNlZ19wb29sW3VdLnZhbCA9IHJlczsKICAgIHUKfQoKc3RydWN0IE5vZGUgewogICAgZWRnZXM6IFt1c2l6ZTsgTUFYTiArIDFdLAogICAgZWRnZXNfbGVuOiB1c2l6ZSwKICAgIGQ6IGkzMiwKICAgIGZhOiBbdXNpemU7IExPR19NQVhOICsgMV0sCiAgICBzZWdtZW50OiB1c2l6ZSwKICAgIGFuczogaTMyLAp9CgppbXBsIE5vZGUgewogICAgZm4gcHVzaCgmbXV0IHNlbGYsIHRvOiB1c2l6ZSkgewogICAgICAgIHNlbGYuZWRnZXNbc2VsZi5lZGdlc19sZW5dID0gdG87CiAgICAgICAgc2VsZi5lZGdlc19sZW4gKz0gMTsKICAgIH0KICAgIGZuIGNsZWFyKCZtdXQgc2VsZikgewogICAgICAgIHNlbGYuZWRnZXNfbGVuID0gMDsKICAgIH0KfQoKZm4gcHJlcGFyZShub2RlX3Bvb2w6ICZtdXQgW05vZGU7IE1BWE4gKyAxXSwgdjogdXNpemUsIGY6IHVzaXplKSB7CiAgICBub2RlX3Bvb2xbdl0uZmFbMF0gPSBmOwogICAgbm9kZV9wb29sW3ZdLmQgPSBpZiAoZiA9PSAwKSB7IDEgfSBlbHNlIHsgbm9kZV9wb29sW2ZdLmQgKyAxIH07CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMTsKICAgIHdoaWxlIChpIDw9IExPR19NQVhOKSB7CiAgICAgICAgbGV0IGZmOiB1c2l6ZSA9IG5vZGVfcG9vbFt2XS5mYVtpIC0gMV07CiAgICAgICAgaWYgKGZmICE9IDApIHsKICAgICAgICAgICAgbm9kZV9wb29sW3ZdLmZhW2ldID0gbm9kZV9wb29sW2ZmXS5mYVtpIC0gMV07CiAgICAgICAgfQogICAgICAgIGkgKz0gMTsKICAgIH0KICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX3Bvb2xbdl0uZWRnZXNfbGVuKSB7CiAgICAgICAgbGV0IHRvOiB1c2l6ZSA9IG5vZGVfcG9vbFt2XS5lZGdlc1tpXTsKICAgICAgICBpICs9IDE7CiAgICAgICAgaWYgKHRvID09IGYpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIHByZXBhcmUobm9kZV9wb29sLCB0bywgdik7CiAgICB9Cn0KCmZuIGxjYShub2RlX3Bvb2w6ICZbTm9kZTsgTUFYTiArIDFdLCBtdXQgdTogdXNpemUsIG11dCB2OiB1c2l6ZSkgLT4gdXNpemUgewogICAgaWYgKG5vZGVfcG9vbFt1XS5kIDwgbm9kZV9wb29sW3ZdLmQpIHsKICAgICAgICBsZXQgdG1wOiB1c2l6ZSA9IHU7CiAgICAgICAgdSA9IHY7CiAgICAgICAgdiA9IHRtcDsKICAgIH0KICAgIGxldCBtdXQgaTogaTMyID0gTE9HX01BWE4gYXMgaTMyOwogICAgd2hpbGUgKGkgPj0gMCkgewogICAgICAgIGxldCBmZjogdXNpemUgPSBub2RlX3Bvb2xbdV0uZmFbaSBhcyB1c2l6ZV07CiAgICAgICAgaWYgKGZmICE9IDAgJiYgbm9kZV9wb29sW2ZmXS5kID49IG5vZGVfcG9vbFt2XS5kKSB7CiAgICAgICAgICAgIHUgPSBmZjsKICAgICAgICB9CiAgICAgICAgaSAtPSAxOwogICAgfQogICAgaWYgKHUgPT0gdikgewogICAgICAgIHJldHVybiB1OwogICAgfQogICAgaSA9IExPR19NQVhOIGFzIGkzMjsKICAgIHdoaWxlIChpID49IDApIHsKICAgICAgICBpZiAobm9kZV9wb29sW3VdLmZhW2kgYXMgdXNpemVdICE9IG5vZGVfcG9vbFt2XS5mYVtpIGFzIHVzaXplXSkgewogICAgICAgICAgICB1ID0gbm9kZV9wb29sW3VdLmZhW2kgYXMgdXNpemVdOwogICAgICAgICAgICB2ID0gbm9kZV9wb29sW3ZdLmZhW2kgYXMgdXNpemVdOwogICAgICAgIH0KICAgICAgICBpIC09IDE7CiAgICB9CiAgICBub2RlX3Bvb2xbdV0uZmFbMF0KfQoKZm4gZGZzKAogICAgbm9kZV9wb29sOiAmbXV0IFtOb2RlOyBNQVhOICsgMV0sCiAgICBzZWdfcG9vbDogJm11dCBbU2VnVDsgTUFYU0VHXSwKICAgIHNlZ19jbnQ6ICZtdXQgdXNpemUsCiAgICB2OiB1c2l6ZSwKICAgIGY6IHVzaXplLAopIHsKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX3Bvb2xbdl0uZWRnZXNfbGVuKSB7CiAgICAgICAgbGV0IHRvOiB1c2l6ZSA9IG5vZGVfcG9vbFt2XS5lZGdlc1tpXTsKICAgICAgICBpICs9IDE7CiAgICAgICAgaWYgKHRvID09IGYpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGRmcyhub2RlX3Bvb2wsIHNlZ19wb29sLCBzZWdfY250LCB0bywgdik7CiAgICB9CiAgICBub2RlX3Bvb2xbdl0uYW5zID0gc2VnX3Bvb2xbbm9kZV9wb29sW3ZdLnNlZ21lbnRdLnZhbC50eTsKICAgIGlmIChmICE9IDApIHsKICAgICAgICBub2RlX3Bvb2xbZl0uc2VnbWVudCA9IG1lcmdlKAogICAgICAgICAgICBzZWdfcG9vbCwKICAgICAgICAgICAgc2VnX2NudCwKICAgICAgICAgICAgbm9kZV9wb29sW2ZdLnNlZ21lbnQsCiAgICAgICAgICAgIG5vZGVfcG9vbFt2XS5zZWdtZW50LAogICAgICAgICk7CiAgICB9Cn0KCmZuIG1haW4oKSB7CiAgICBsZXQgbXV0IG5vZGVfcG9vbDogW05vZGU7IE1BWE4gKyAxXSA9IFtOb2RlIHsKICAgICAgICBlZGdlczogWzA7IE1BWE4gKyAxXSwKICAgICAgICBlZGdlc19sZW46IDAsCiAgICAgICAgZDogMCwKICAgICAgICBmYTogWzA7IExPR19NQVhOICsgMV0sCiAgICAgICAgc2VnbWVudDogMCwKICAgICAgICBhbnM6IDAsCiAgICB9OyBNQVhOICsgMV07CgogICAgbGV0IG11dCBzZWdfcG9vbDogW1NlZ1Q7IE1BWFNFR10gPSBbU2VnVCB7CiAgICAgICAgbDogMCwKICAgICAgICByOiAwLAogICAgICAgIGxjOiAwLAogICAgICAgIHJjOiAwLAogICAgICAgIHZhbDogRm9vZCB7IGNudDogMCwgdHk6IDAgfSwKICAgIH07IE1BWFNFR107CiAgICBsZXQgbXV0IHNlZ19jbnQ6IHVzaXplID0gMDsKCiAgICBsZXQgbjogdXNpemUgPSBnZXRJbnQoKSBhcyB1c2l6ZTsKICAgIGxldCBtOiB1c2l6ZSA9IGdldEludCgpIGFzIHVzaXplOwogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDE7CiAgICB3aGlsZSAoaSA8PSBuKSB7CiAgICAgICAgbm9kZV9wb29sW2ldLmNsZWFyKCk7CiAgICAgICAgbm9kZV9wb29sW2ldLnNlZ21lbnQgPSBidWlsZCgmbXV0IHNlZ19wb29sLCAmbXV0IHNlZ19jbnQsIDEsIE1BWE4gYXMgaTMyKTsKICAgICAgICBpICs9IDE7CiAgICB9CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgbiAtIDEpIHsKICAgICAgICBsZXQgYTogdXNpemUgPSBnZXRJbnQoKSBhcyB1c2l6ZTsKICAgICAgICBsZXQgYjogdXNpemUgPSBnZXRJbnQoKSBhcyB1c2l6ZTsKICAgICAgICBub2RlX3Bvb2xbYV0ucHVzaChiKTsKICAgICAgICBub2RlX3Bvb2xbYl0ucHVzaChhKTsKICAgICAgICBpICs9IDE7CiAgICB9CiAgICBwcmVwYXJlKCZtdXQgbm9kZV9wb29sLCAxLCAwKTsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBtKSB7CiAgICAgICAgbGV0IHg6IHVzaXplID0gZ2V0SW50KCkgYXMgdXNpemU7CiAgICAgICAgbGV0IHk6IHVzaXplID0gZ2V0SW50KCkgYXMgdXNpemU7CiAgICAgICAgbGV0IHo6IGkzMiA9IGdldEludCgpOwogICAgICAgIGxldCBmOiB1c2l6ZSA9IGxjYSgmbm9kZV9wb29sLCB4LCB5KTsKICAgICAgICB1cGRhdGUoJm11dCBzZWdfcG9vbCwgJm11dCBzZWdfY250LCBub2RlX3Bvb2xbeF0uc2VnbWVudCwgeiwgMSk7CiAgICAgICAgdXBkYXRlKCZtdXQgc2VnX3Bvb2wsICZtdXQgc2VnX2NudCwgbm9kZV9wb29sW3ldLnNlZ21lbnQsIHosIDEpOwogICAgICAgIHVwZGF0ZSgmbXV0IHNlZ19wb29sLCAmbXV0IHNlZ19jbnQsIG5vZGVfcG9vbFtmXS5zZWdtZW50LCB6LCAtMSk7CiAgICAgICAgaWYgKG5vZGVfcG9vbFtmXS5mYVswXSAhPSAwKSB7CiAgICAgICAgICAgIHVwZGF0ZSgKICAgICAgICAgICAgICAgICZtdXQgc2VnX3Bvb2wsCiAgICAgICAgICAgICAgICAmbXV0IHNlZ19jbnQsCiAgICAgICAgICAgICAgICBub2RlX3Bvb2xbbm9kZV9wb29sW2ZdLmZhWzBdXS5zZWdtZW50LAogICAgICAgICAgICAgICAgeiwKICAgICAgICAgICAgICAgIC0xLAogICAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBpICs9IDE7CiAgICB9CiAgICBkZnMoJm11dCBub2RlX3Bvb2wsICZtdXQgc2VnX3Bvb2wsICZtdXQgc2VnX2NudCwgMSwgMCk7CiAgICBpID0gMTsKICAgIHdoaWxlIChpIDw9IG4pIHsKICAgICAgICBwcmludGxuSW50KG5vZGVfcG9vbFtpXS5hbnMpOwogICAgICAgIGkgKz0gMTsKICAgIH0KICAgIGV4aXQoMCk7Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (2, "comprehensive2", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCAyOiBDb21wbGV4IENvbnRyb2wgRmxvdyBhbmQgRGF0YSBTdHJ1Y3R1cmUgT3BlcmF0aW9ucwpTdW1tYXJ5OiBUaGlzIHRlc3QgZm9jdXNlcyBvbiBjb21waWxlciBvcHRpbWl6YXRpb24gb2Y6CkRldGFpbHM6CkNvbXBsZXggYnJhbmNoaW5nIHBhdHRlcm5zIGFuZCBicmFuY2ggcHJlZGljdGlvbgpMb29wIG5lc3Qgb3B0aW1pemF0aW9uIGFuZCBsb29wIGludGVyY2hhbmdlCkRhdGEgc3RydWN0dXJlIHRyYXZlcnNhbCBvcHRpbWl6YXRpb24KRnVuY3Rpb24gY2FsbCBncmFwaCBvcHRpbWl6YXRpb24KQ29udHJvbCBmbG93IGdyYXBoIG9wdGltaXphdGlvbgpKdW1wIHRhYmxlIG9wdGltaXphdGlvbiBmb3Igc3dpdGNoLWxpa2UgY29uc3RydWN0cwoqLwoKLy8gY29tcHJlaGVuc2l2ZTIucnggLSBDb21wcmVoZW5zaXZlIFRlc3QgMjogQ29tcGxleCBDb250cm9sIEZsb3cgYW5kIERhdGEgU3RydWN0dXJlIE9wZXJhdGlvbnMKLy8gVGhpcyB0ZXN0IGZvY3VzZXMgb24gY29tcGlsZXIgb3B0aW1pemF0aW9uIG9mOgovLyAtIENvbXBsZXggYnJhbmNoaW5nIHBhdHRlcm5zIGFuZCBicmFuY2ggcHJlZGljdGlvbgovLyAtIExvb3AgbmVzdCBvcHRpbWl6YXRpb24gYW5kIGxvb3AgaW50ZXJjaGFuZ2UKLy8gLSBEYXRhIHN0cnVjdHVyZSB0cmF2ZXJzYWwgb3B0aW1pemF0aW9uCi8vIC0gRnVuY3Rpb24gY2FsbCBncmFwaCBvcHRpbWl6YXRpb24KLy8gLSBDb250cm9sIGZsb3cgZ3JhcGggb3B0aW1pemF0aW9uCi8vIC0gSnVtcCB0YWJsZSBvcHRpbWl6YXRpb24gZm9yIHN3aXRjaC1saWtlIGNvbnN0cnVjdHMKCmZuIG1haW4oKSB7CiAgICAvLyBQZXJmb3JtYW5jZSB0ZXN0IG1hcmtlciAtIHN0YXJ0CiAgICBwcmludGxuSW50KDIwMDApOwoKICAgIC8vIFRlc3QgMTogQ29tcGxleCBuZXN0ZWQgY29udHJvbCBzdHJ1Y3R1cmVzCiAgICAvLyBUZXN0cyBicmFuY2ggcHJlZGljdGlvbiBvcHRpbWl6YXRpb24gYW5kIGNvbnRyb2wgZmxvdyBhbmFseXNpcwogICAgcGVyZm9ybUNvbXBsZXhDb250cm9sRmxvd1Rlc3QoKTsKCiAgICAvLyBUZXN0IDI6IEFkdmFuY2VkIGdyYXBoIGFsZ29yaXRobXMKICAgIC8vIFRlc3RzIHBvaW50ZXIgY2hhc2luZyBvcHRpbWl6YXRpb24gYW5kIG1lbW9yeSBsb2NhbGl0eQogICAgcGVyZm9ybUdyYXBoQWxnb3JpdGhtcygpOwoKICAgIC8vIFRlc3QgMzogRHluYW1pYyBwcm9ncmFtbWluZyBwcm9ibGVtcwogICAgLy8gVGVzdHMgbWVtb2l6YXRpb24gb3B0aW1pemF0aW9uIGFuZCBsb29wIG5lc3Qgb3B0aW1pemF0aW9uCiAgICBwZXJmb3JtRHluYW1pY1Byb2dyYW1taW5nKCk7CgogICAgLy8gVGVzdCA0OiBTdGF0ZSBtYWNoaW5lIHNpbXVsYXRpb24KICAgIC8vIFRlc3RzIGp1bXAgdGFibGUgb3B0aW1pemF0aW9uIGFuZCBicmFuY2ggcHJlZGljdGlvbgogICAgcGVyZm9ybVN0YXRlTWFjaGluZVNpbXVsYXRpb24oKTsKCiAgICAvLyBUZXN0IDU6IENvbXBsZXggc2VhcmNoIGFuZCB0cmF2ZXJzYWwgYWxnb3JpdGhtcwogICAgLy8gVGVzdHMgZnVuY3Rpb24gY2FsbCBvcHRpbWl6YXRpb24gYW5kIGxvb3AgdW5yb2xsaW5nCiAgICBwZXJmb3JtU2VhcmNoQWxnb3JpdGhtcygpOwoKICAgIC8vIFBlcmZvcm1hbmNlIHRlc3QgbWFya2VyIC0gZW5kCiAgICBwcmludGxuSW50KDI5OTkpOwogICAgZXhpdCgwKTsKfQoKLy8gVGVzdCAxOiBDb21wbGV4IENvbnRyb2wgRmxvdyBQYXR0ZXJucwovLyBUZXN0cyBjb21waWxlcidzIGFiaWxpdHkgdG8gb3B0aW1pemUgY29tcGxleCBicmFuY2hpbmcgYW5kIG5lc3RlZCBjb250cm9sIHN0cnVjdHVyZXMKZm4gcGVyZm9ybUNvbXBsZXhDb250cm9sRmxvd1Rlc3QoKSB7CiAgICBwcmludGxuSW50KDIwMDEpOyAvLyBTdGFydCBjb250cm9sIGZsb3cgdGVzdAoKICAgIC8vIFRlc3QgbmVzdGVkIGxvb3BzIHdpdGggY29tcGxleCBjb25kaXRpb25zCiAgICBsZXQgcmVzdWx0MTogaTMyID0gY29tcGxleE5lc3RlZExvb3BzKDEwMCk7CiAgICBwcmludGxuSW50KHJlc3VsdDEpOwoKICAgIC8vIFRlc3QgbXVsdGlwbGUgYnJhbmNoaW5nIHBhdHRlcm5zCiAgICBsZXQgcmVzdWx0MjogaTMyID0gbXVsdGlwbGVCcmFuY2hpbmdQYXR0ZXJucygxMDAwKTsKICAgIHByaW50bG5JbnQocmVzdWx0Mik7CgogICAgLy8gVGVzdCBlYXJseSBleGl0IHBhdHRlcm5zCiAgICBsZXQgcmVzdWx0MzogaTMyID0gZWFybHlFeGl0UGF0dGVybnMoNTAwKTsKICAgIHByaW50bG5JbnQocmVzdWx0Myk7CgogICAgLy8gVGVzdCBzd2l0Y2gtbGlrZSBiZWhhdmlvciBzaW11bGF0aW9uCiAgICBsZXQgcmVzdWx0NDogaTMyID0gc2ltdWxhdGVTd2l0Y2hCZWhhdmlvcigyMDApOwogICAgcHJpbnRsbkludChyZXN1bHQ0KTsKCiAgICBwcmludGxuSW50KDIwMDIpOyAvLyBFbmQgY29udHJvbCBmbG93IHRlc3QKfQoKLy8gQ29tcGxleCBuZXN0ZWQgbG9vcHMgd2l0aCBtdWx0aXBsZSBicmVhay9jb250aW51ZSBjb25kaXRpb25zCmZuIGNvbXBsZXhOZXN0ZWRMb29wcyhsaW1pdDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCB0b3RhbDogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICB3aGlsZSAoaSA8IGxpbWl0KSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgaW5uZXJfc3VtOiBpMzIgPSAwOwoKICAgICAgICB3aGlsZSAoaiA8IGxpbWl0KSB7CiAgICAgICAgICAgIGxldCBtdXQgazogaTMyID0gMDsKCiAgICAgICAgICAgIC8vIFRyaXBsZSBuZXN0ZWQgbG9vcCB3aXRoIGNvbXBsZXggY29uZGl0aW9ucwogICAgICAgICAgICB3aGlsZSAoayA8IDUwKSB7CiAgICAgICAgICAgICAgICAvLyBNdWx0aXBsZSBicmFuY2hpbmcgY29uZGl0aW9ucwogICAgICAgICAgICAgICAgaWYgKChpICsgaiArIGspICUgMyA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKChpICogaikgJSA1ID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5uZXJfc3VtICs9IGs7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbm5lcl9zdW0gPiAxMDAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8gRWFybHkgZXhpdCBmcm9tIGlubmVybW9zdCBsb29wCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBrICs9IDI7IC8vIFNraXAgYWhlYWQKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoaSArIGogKyBrKSAlIDcgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGlubmVyX3N1bSAtPSBrIC8gMjsKICAgICAgICAgICAgICAgICAgICBpZiAoaW5uZXJfc3VtIDwgMCkgewogICAgICAgICAgICAgICAgICAgICAgICBpbm5lcl9zdW0gPSAwOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBDb21wbGV4IGNvbmRpdGlvbmFsIGluY3JlbWVudAogICAgICAgICAgICAgICAgaWYgKGsgJSAyID09IDApIHsKICAgICAgICAgICAgICAgICAgICBrICs9IDE7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGsgKz0gMzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgdG90YWwgKz0gaW5uZXJfc3VtOwoKICAgICAgICAgICAgLy8gQ29uZGl0aW9uYWwgaW5jcmVtZW50IGZvciBqCiAgICAgICAgICAgIGlmIChqICUgMyA9PSAwKSB7CiAgICAgICAgICAgICAgICBqICs9IDI7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIEVhcmx5IGV4aXQgY29uZGl0aW9uIGZvciBtaWRkbGUgbG9vcAogICAgICAgICAgICBpZiAodG90YWwgPiA1MDAwMCkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIENvbXBsZXggaW5jcmVtZW50IHBhdHRlcm4gZm9yIG91dGVyIGxvb3AKICAgICAgICBpZiAoaSAlIDEwID09IDApIHsKICAgICAgICAgICAgaSArPSA1OwogICAgICAgIH0gZWxzZSBpZiAoaSAlIDUgPT0gMCkgewogICAgICAgICAgICBpICs9IDM7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gR2xvYmFsIGVhcmx5IGV4aXQgY29uZGl0aW9uCiAgICAgICAgaWYgKHRvdGFsID4gMTAwMDAwKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KCiAgICB0b3RhbCAlIDEwMDAwCn0KCi8vIE11bHRpcGxlIGJyYW5jaGluZyBwYXR0ZXJucyB0byB0ZXN0IGJyYW5jaCBwcmVkaWN0aW9uCmZuIG11bHRpcGxlQnJhbmNoaW5nUGF0dGVybnMoaXRlcmF0aW9uczogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCByZXN1bHQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgd2hpbGUgKGkgPCBpdGVyYXRpb25zKSB7CiAgICAgICAgbGV0IHZhbHVlOiBpMzIgPSAoaSAqIDE3ICsgMjMpICUgMTAwOwoKICAgICAgICAvLyBDb21wbGV4IGJyYW5jaGluZyB0cmVlCiAgICAgICAgaWYgKHZhbHVlIDwgMTApIHsKICAgICAgICAgICAgaWYgKHZhbHVlIDwgNSkgewogICAgICAgICAgICAgICAgaWYgKHZhbHVlICUgMiA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IHZhbHVlICogMzsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IHZhbHVlICogNTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAlIDMgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSB2YWx1ZSAqIDI7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSB2YWx1ZSAqIDQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIDwgMzApIHsKICAgICAgICAgICAgaWYgKHZhbHVlIDwgMjApIHsKICAgICAgICAgICAgICAgIHJlc3VsdCArPSBjb21wbGV4Q2FsY3VsYXRpb24odmFsdWUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmVzdWx0ICs9IHNpbXBsZUNhbGN1bGF0aW9uKHZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodmFsdWUgPCA2MCkgewogICAgICAgICAgICAvLyBOZXN0ZWQgY29uZGl0aW9uYWwgd2l0aCBmdW5jdGlvbiBjYWxscwogICAgICAgICAgICBpZiAoaXNTcGVjaWFsTnVtYmVyKHZhbHVlKSA9PSAxKSB7CiAgICAgICAgICAgICAgICByZXN1bHQgKz0gcHJvY2Vzc1NwZWNpYWxOdW1iZXIodmFsdWUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmVzdWx0ICs9IHByb2Nlc3NOb3JtYWxOdW1iZXIodmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA8IDgwKSB7CiAgICAgICAgICAgIC8vIExvb3Agd2l0aGluIGJyYW5jaAogICAgICAgICAgICBsZXQgbXV0IHRlbXA6IGkzMiA9IDA7CiAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKGogPCB2YWx1ZSAlIDEwKSB7CiAgICAgICAgICAgICAgICB0ZW1wICs9IGogKiBqOwogICAgICAgICAgICAgICAgaiArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlc3VsdCArPSB0ZW1wOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIENvbXBsZXggYXJpdGhtZXRpYyBvcGVyYXRpb25zCiAgICAgICAgICAgIHJlc3VsdCArPSAoKHZhbHVlICogdmFsdWUpICUgMTcpICsgKCh2YWx1ZSArIDEzKSAlIDcpOwogICAgICAgIH0KCiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIHJlc3VsdCAlIDEwMDAwCn0KCi8vIEhlbHBlciBmdW5jdGlvbiBmb3IgY29tcGxleCBjYWxjdWxhdGlvbgpmbiBjb21wbGV4Q2FsY3VsYXRpb24odmFsdWU6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgdGVtcDogaTMyID0gdmFsdWU7CiAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gMDsKCiAgICB3aGlsZSAodGVtcCA+IDApIHsKICAgICAgICByZXN1bHQgKz0gdGVtcCAlIDEwOwogICAgICAgIHRlbXAgLz0gMTA7CiAgICB9CgogICAgcmVzdWx0ICogcmVzdWx0Cn0KCi8vIEhlbHBlciBmdW5jdGlvbiBmb3Igc2ltcGxlIGNhbGN1bGF0aW9uCmZuIHNpbXBsZUNhbGN1bGF0aW9uKHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICB2YWx1ZSAqIDIgKyAxCn0KCi8vIENoZWNrIGlmIG51bWJlciBoYXMgc3BlY2lhbCBwcm9wZXJ0aWVzCmZuIGlzU3BlY2lhbE51bWJlcih2YWx1ZTogaTMyKSAtPiBpMzIgewogICAgKHZhbHVlICUgNyA9PSAwIHx8IHZhbHVlICUgMTEgPT0gMCkgYXMgaTMyCn0KCi8vIFByb2Nlc3Mgc3BlY2lhbCBudW1iZXJzCmZuIHByb2Nlc3NTcGVjaWFsTnVtYmVyKHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gdmFsdWU7CgogICAgaWYgKHZhbHVlICUgNyA9PSAwKSB7CiAgICAgICAgcmVzdWx0ICo9IDc7CiAgICB9CgogICAgaWYgKHZhbHVlICUgMTEgPT0gMCkgewogICAgICAgIHJlc3VsdCAqPSAxMTsKICAgIH0KCiAgICByZXN1bHQgJSAxMDAwCn0KCi8vIFByb2Nlc3Mgbm9ybWFsIG51bWJlcnMKZm4gcHJvY2Vzc05vcm1hbE51bWJlcih2YWx1ZTogaTMyKSAtPiBpMzIgewogICAgKHZhbHVlICogMyArIDcpICUgMTAwCn0KCi8vIEVhcmx5IGV4aXQgcGF0dGVybnMgdGVzdGluZwpmbiBlYXJseUV4aXRQYXR0ZXJucyhsaW1pdDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBmb3VuZF9jb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICB3aGlsZSAoaSA8IGxpbWl0KSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgZm91bmRfaW5fcm93OiBpMzIgPSAwOwoKICAgICAgICAvLyBTZWFyY2ggcGF0dGVybiB3aXRoIGVhcmx5IGV4aXRzCiAgICAgICAgd2hpbGUgKGogPCBsaW1pdCkgewogICAgICAgICAgICBsZXQgdmFsdWU6IGkzMiA9IChpICogMzEgKyBqICogMTcpICUgMTAwOwoKICAgICAgICAgICAgLy8gTXVsdGlwbGUgZWFybHkgZXhpdCBjb25kaXRpb25zCiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSA0MikgewogICAgICAgICAgICAgICAgZm91bmRfaW5fcm93ICs9IDE7CiAgICAgICAgICAgICAgICBmb3VuZF9jb3VudCArPSAxOwoKICAgICAgICAgICAgICAgIC8vIEVhcmx5IGV4aXQgaWYgZm91bmQgdG9vIG1hbnkKICAgICAgICAgICAgICAgIGlmIChmb3VuZF9jb3VudCA+IDIwKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvdW5kX2NvdW50OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID4gOTUpIHsKICAgICAgICAgICAgICAgIC8vIFNraXAgcmVzdCBvZiBpbm5lciBsb29wCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA8IDUpIHsKICAgICAgICAgICAgICAgIC8vIFNraXAgdG8gbmV4dCBpdGVyYXRpb24KICAgICAgICAgICAgICAgIGogKz0gMTA7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gQ29tcGxleCBjb25kaXRpb24gZm9yIGVhcmx5IGV4aXQKICAgICAgICAgICAgaWYgKGZvdW5kX2luX3JvdyA+IDMgJiYgdmFsdWUgJSAxMyA9PSAwKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaiArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gRWFybHkgZXhpdCBmcm9tIG91dGVyIGxvb3AKICAgICAgICBpZiAoZm91bmRfaW5fcm93ID4gNSkgewogICAgICAgICAgICByZXR1cm4gZm91bmRfY291bnQ7CiAgICAgICAgfQoKICAgICAgICBpICs9IDE7CiAgICB9CgogICAgZm91bmRfY291bnQKfQoKLy8gU2ltdWxhdGUgc3dpdGNoLWxpa2UgYmVoYXZpb3IgdXNpbmcgbXVsdGlwbGUgaWYtZWxzZQpmbiBzaW11bGF0ZVN3aXRjaEJlaGF2aW9yKGl0ZXJhdGlvbnM6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgdG90YWw6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgd2hpbGUgKGkgPCBpdGVyYXRpb25zKSB7CiAgICAgICAgbGV0IGNhc2VfdmFsdWU6IGkzMiA9IGkgJSAxNjsgLy8gMTYgZGlmZmVyZW50IGNhc2VzCgogICAgICAgIC8vIFNpbXVsYXRlIHN3aXRjaCBzdGF0ZW1lbnQgd2l0aCAxNiBjYXNlcwogICAgICAgIGlmIChjYXNlX3ZhbHVlID09IDApIHsKICAgICAgICAgICAgdG90YWwgKz0gcHJvY2Vzc0Nhc2UwKGkpOwogICAgICAgIH0gZWxzZSBpZiAoY2FzZV92YWx1ZSA9PSAxKSB7CiAgICAgICAgICAgIHRvdGFsICs9IHByb2Nlc3NDYXNlMShpKTsKICAgICAgICB9IGVsc2UgaWYgKGNhc2VfdmFsdWUgPT0gMikgewogICAgICAgICAgICB0b3RhbCArPSBwcm9jZXNzQ2FzZTIoaSk7CiAgICAgICAgfSBlbHNlIGlmIChjYXNlX3ZhbHVlID09IDMpIHsKICAgICAgICAgICAgdG90YWwgKz0gcHJvY2Vzc0Nhc2UzKGkpOwogICAgICAgIH0gZWxzZSBpZiAoY2FzZV92YWx1ZSA9PSA0KSB7CiAgICAgICAgICAgIHRvdGFsICs9IHByb2Nlc3NDYXNlNChpKTsKICAgICAgICB9IGVsc2UgaWYgKGNhc2VfdmFsdWUgPT0gNSkgewogICAgICAgICAgICB0b3RhbCArPSBwcm9jZXNzQ2FzZTUoaSk7CiAgICAgICAgfSBlbHNlIGlmIChjYXNlX3ZhbHVlID09IDYpIHsKICAgICAgICAgICAgdG90YWwgKz0gcHJvY2Vzc0Nhc2U2KGkpOwogICAgICAgIH0gZWxzZSBpZiAoY2FzZV92YWx1ZSA9PSA3KSB7CiAgICAgICAgICAgIHRvdGFsICs9IHByb2Nlc3NDYXNlNyhpKTsKICAgICAgICB9IGVsc2UgaWYgKGNhc2VfdmFsdWUgPT0gOCkgewogICAgICAgICAgICB0b3RhbCArPSBwcm9jZXNzQ2FzZTgoaSk7CiAgICAgICAgfSBlbHNlIGlmIChjYXNlX3ZhbHVlID09IDkpIHsKICAgICAgICAgICAgdG90YWwgKz0gcHJvY2Vzc0Nhc2U5KGkpOwogICAgICAgIH0gZWxzZSBpZiAoY2FzZV92YWx1ZSA9PSAxMCkgewogICAgICAgICAgICB0b3RhbCArPSBwcm9jZXNzQ2FzZTEwKGkpOwogICAgICAgIH0gZWxzZSBpZiAoY2FzZV92YWx1ZSA9PSAxMSkgewogICAgICAgICAgICB0b3RhbCArPSBwcm9jZXNzQ2FzZTExKGkpOwogICAgICAgIH0gZWxzZSBpZiAoY2FzZV92YWx1ZSA9PSAxMikgewogICAgICAgICAgICB0b3RhbCArPSBwcm9jZXNzQ2FzZTEyKGkpOwogICAgICAgIH0gZWxzZSBpZiAoY2FzZV92YWx1ZSA9PSAxMykgewogICAgICAgICAgICB0b3RhbCArPSBwcm9jZXNzQ2FzZTEzKGkpOwogICAgICAgIH0gZWxzZSBpZiAoY2FzZV92YWx1ZSA9PSAxNCkgewogICAgICAgICAgICB0b3RhbCArPSBwcm9jZXNzQ2FzZTE0KGkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRvdGFsICs9IHByb2Nlc3NDYXNlMTUoaSk7CiAgICAgICAgfQoKICAgICAgICBpICs9IDE7CiAgICB9CgogICAgdG90YWwgJSAxMDAwMAp9CgovLyBJbmRpdmlkdWFsIGNhc2UgcHJvY2Vzc2luZyBmdW5jdGlvbnMgZm9yIHN3aXRjaCBzaW11bGF0aW9uCmZuIHByb2Nlc3NDYXNlMCh2YWx1ZTogaTMyKSAtPiBpMzIgewogICAgdmFsdWUgKiAyCn0KZm4gcHJvY2Vzc0Nhc2UxKHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICB2YWx1ZSAqIDMgKyAxCn0KZm4gcHJvY2Vzc0Nhc2UyKHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICB2YWx1ZSAqIHZhbHVlICUgMTAwCn0KZm4gcHJvY2Vzc0Nhc2UzKHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICAodmFsdWUgKyA1KSAqIDIKfQpmbiBwcm9jZXNzQ2FzZTQodmFsdWU6IGkzMikgLT4gaTMyIHsKICAgIHZhbHVlIC8gMiArIDEwCn0KZm4gcHJvY2Vzc0Nhc2U1KHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICB2YWx1ZSAlIDcgKyB2YWx1ZSAlIDExCn0KZm4gcHJvY2Vzc0Nhc2U2KHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICB2YWx1ZSAqIDcgJSAyMwp9CmZuIHByb2Nlc3NDYXNlNyh2YWx1ZTogaTMyKSAtPiBpMzIgewogICAgKHZhbHVlICsgMykgKiAodmFsdWUgKyA3KSAlIDUwCn0KZm4gcHJvY2Vzc0Nhc2U4KHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICB2YWx1ZSBeIDQyCn0gLy8gWE9SIG9wZXJhdGlvbgpmbiBwcm9jZXNzQ2FzZTkodmFsdWU6IGkzMikgLT4gaTMyIHsKICAgIHZhbHVlICogMTMgJSAxNwp9CmZuIHByb2Nlc3NDYXNlMTAodmFsdWU6IGkzMikgLT4gaTMyIHsKICAgIHZhbHVlICsgdmFsdWUgLyAzCn0KZm4gcHJvY2Vzc0Nhc2UxMSh2YWx1ZTogaTMyKSAtPiBpMzIgewogICAgdmFsdWUgKiAxOSAlIDMxCn0KZm4gcHJvY2Vzc0Nhc2UxMih2YWx1ZTogaTMyKSAtPiBpMzIgewogICAgKHZhbHVlICogMiArIDEpICUgMjUKfQpmbiBwcm9jZXNzQ2FzZTEzKHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICB2YWx1ZSAlIDYgKiB2YWx1ZSAlIDgKfQpmbiBwcm9jZXNzQ2FzZTE0KHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICB2YWx1ZSArIDQ3Cn0KZm4gcHJvY2Vzc0Nhc2UxNSh2YWx1ZTogaTMyKSAtPiBpMzIgewogICAgdmFsdWUgKiAzNyAlIDQxCn0KCi8vIFRlc3QgMjogR3JhcGggQWxnb3JpdGhtIEltcGxlbWVudGF0aW9ucwovLyBUZXN0cyBvcHRpbWl6YXRpb24gb2YgcG9pbnRlci1pbnRlbnNpdmUgb3BlcmF0aW9ucyBhbmQgaXJyZWd1bGFyIG1lbW9yeSBhY2Nlc3MKZm4gcGVyZm9ybUdyYXBoQWxnb3JpdGhtcygpIHsKICAgIHByaW50bG5JbnQoMjAwMyk7IC8vIFN0YXJ0IGdyYXBoIGFsZ29yaXRobXMKCiAgICAvLyBUZXN0IGdyYXBoIHRyYXZlcnNhbCBhbGdvcml0aG1zCiAgICBsZXQgdHJhdmVyc2FsX3Jlc3VsdDogaTMyID0gcGVyZm9ybUdyYXBoVHJhdmVyc2FsKCk7CiAgICBwcmludGxuSW50KHRyYXZlcnNhbF9yZXN1bHQpOwoKICAgIC8vIFRlc3Qgc2hvcnRlc3QgcGF0aCBhbGdvcml0aG1zCiAgICBsZXQgcGF0aF9yZXN1bHQ6IGkzMiA9IHBlcmZvcm1TaG9ydGVzdFBhdGgoKTsKICAgIHByaW50bG5JbnQocGF0aF9yZXN1bHQpOwoKICAgIC8vIFRlc3QgZ3JhcGggY29ubmVjdGl2aXR5CiAgICBsZXQgY29ubmVjdGl2aXR5X3Jlc3VsdDogaTMyID0gcGVyZm9ybUNvbm5lY3Rpdml0eVRlc3QoKTsKICAgIHByaW50bG5JbnQoY29ubmVjdGl2aXR5X3Jlc3VsdCk7CgogICAgcHJpbnRsbkludCgyMDA0KTsgLy8gRW5kIGdyYXBoIGFsZ29yaXRobXMKfQoKLy8gR3JhcGggdHJhdmVyc2FsIHVzaW5nIGFkamFjZW5jeSBtYXRyaXggcmVwcmVzZW50YXRpb24KZm4gcGVyZm9ybUdyYXBoVHJhdmVyc2FsKCkgLT4gaTMyIHsKICAgIGxldCBncmFwaF9zaXplOiB1c2l6ZSA9IDUwOwogICAgbGV0IG11dCBhZGphY2VuY3lfbWF0cml4OiBbaTMyOyAyNTAwXSA9IFswOyAyNTAwXTsgLy8gNTB4NTAgbWF0cml4CiAgICBsZXQgbXV0IHZpc2l0ZWQ6IFtpMzI7IDUwXSA9IFswOyA1MF07CgogICAgLy8gSW5pdGlhbGl6ZSByYW5kb20gZ3JhcGgKICAgIGluaXRpYWxpemVSYW5kb21HcmFwaCgmbXV0IGFkamFjZW5jeV9tYXRyaXgsIGdyYXBoX3NpemUpOwoKICAgIC8vIFBlcmZvcm0gREZTIHRyYXZlcnNhbAogICAgbGV0IGRmc19yZXN1bHQ6IGkzMiA9IGRlcHRoRmlyc3RTZWFyY2goJm11dCBhZGphY2VuY3lfbWF0cml4LCAmbXV0IHZpc2l0ZWQsIGdyYXBoX3NpemUsIDApOwoKICAgIC8vIFJlc2V0IHZpc2l0ZWQgYXJyYXkKICAgIHJlc2V0QXJyYXkoJm11dCB2aXNpdGVkLCBncmFwaF9zaXplKTsKCiAgICAvLyBQZXJmb3JtIEJGUyB0cmF2ZXJzYWwKICAgIGxldCBiZnNfcmVzdWx0OiBpMzIgPSBicmVhZHRoRmlyc3RTZWFyY2goJm11dCBhZGphY2VuY3lfbWF0cml4LCAmbXV0IHZpc2l0ZWQsIGdyYXBoX3NpemUsIDApOwoKICAgIHJldHVybiBkZnNfcmVzdWx0ICsgYmZzX3Jlc3VsdDsKfQoKLy8gSW5pdGlhbGl6ZSByYW5kb20gZ3JhcGggd2l0aCBzcGVjaWZpYyBwYXR0ZXJuCmZuIGluaXRpYWxpemVSYW5kb21HcmFwaChtYXRyaXg6ICZtdXQgW2kzMjsgMjUwMF0sIHNpemU6IHVzaXplKSB7CiAgICBsZXQgbXV0IHNlZWQ6IGkzMiA9IDEyMzQ1OwogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CgogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgbGV0IG11dCBqOiB1c2l6ZSA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgIGlmIChpICE9IGopIHsKICAgICAgICAgICAgICAgIHVwZGF0ZSgmbXV0IHNlZWQpOwoKICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBlZGdlIHdpdGggMjAlIHByb2JhYmlsaXR5CiAgICAgICAgICAgICAgICBpZiAoc2VlZCAlIDEwMCA8IDIwKSB7CiAgICAgICAgICAgICAgICAgICAgbWF0cml4W2kgKiBzaXplICsgal0gPSAxOwogICAgICAgICAgICAgICAgICAgIG1hdHJpeFtqICogc2l6ZSArIGldID0gMTsgLy8gVW5kaXJlY3RlZCBncmFwaAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGogKz0gMTsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQp9CgovLyBSZXNldCBhcnJheSB0byBhbGwgemVyb3MKZm4gcmVzZXRBcnJheShhcnI6ICZtdXQgW2kzMjsgNTBdLCBzaXplOiB1c2l6ZSkgewogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBhcnJbaV0gPSAwOwogICAgICAgIGkgKz0gMTsKICAgIH0KfQoKLy8gRGVwdGgtZmlyc3Qgc2VhcmNoIGltcGxlbWVudGF0aW9uCmZuIGRlcHRoRmlyc3RTZWFyY2goCiAgICBtYXRyaXg6ICZtdXQgW2kzMjsgMjUwMF0sCiAgICB2aXNpdGVkOiAmbXV0IFtpMzI7IDUwXSwKICAgIHNpemU6IHVzaXplLAogICAgc3RhcnQ6IHVzaXplLAopIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN0YWNrOiBbdXNpemU7IDEwMDBdID0gWzA7IDEwMDBdOwogICAgbGV0IG11dCBzdGFja190b3A6IHVzaXplID0gMDsKICAgIGxldCBtdXQgdmlzaXRfY291bnQ6IGkzMiA9IDA7CgogICAgLy8gUHVzaCBzdGFydCB2ZXJ0ZXgKICAgIHN0YWNrW3N0YWNrX3RvcF0gPSBzdGFydDsKICAgIHN0YWNrX3RvcCArPSAxOwoKICAgIHdoaWxlIChzdGFja190b3AgPiAwKSB7CiAgICAgICAgLy8gUG9wIHZlcnRleAogICAgICAgIHN0YWNrX3RvcCAtPSAxOwogICAgICAgIGxldCBjdXJyZW50OiB1c2l6ZSA9IHN0YWNrW3N0YWNrX3RvcF07CgogICAgICAgIGlmICh2aXNpdGVkW2N1cnJlbnRdID09IDApIHsKICAgICAgICAgICAgdmlzaXRlZFtjdXJyZW50XSA9IDE7CiAgICAgICAgICAgIHZpc2l0X2NvdW50ICs9IDE7CgogICAgICAgICAgICAvLyBQdXNoIGFsbCB1bnZpc2l0ZWQgbmVpZ2hib3JzCiAgICAgICAgICAgIGxldCBtdXQgbmVpZ2hib3I6IHVzaXplID0gMDsKICAgICAgICAgICAgd2hpbGUgKG5laWdoYm9yIDwgc2l6ZSkgewogICAgICAgICAgICAgICAgaWYgKG1hdHJpeFtjdXJyZW50ICogc2l6ZSArIG5laWdoYm9yXSA9PSAxICYmIHZpc2l0ZWRbbmVpZ2hib3JdID09IDApIHsKICAgICAgICAgICAgICAgICAgICBzdGFja1tzdGFja190b3BdID0gbmVpZ2hib3I7CiAgICAgICAgICAgICAgICAgICAgc3RhY2tfdG9wICs9IDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBuZWlnaGJvciArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHZpc2l0X2NvdW50Cn0KCi8vIEJyZWFkdGgtZmlyc3Qgc2VhcmNoIGltcGxlbWVudGF0aW9uCmZuIGJyZWFkdGhGaXJzdFNlYXJjaCgKICAgIG1hdHJpeDogJm11dCBbaTMyOyAyNTAwXSwKICAgIHZpc2l0ZWQ6ICZtdXQgW2kzMjsgNTBdLAogICAgc2l6ZTogdXNpemUsCiAgICBzdGFydDogdXNpemUsCikgLT4gaTMyIHsKICAgIGxldCBtdXQgcXVldWU6IFt1c2l6ZTsgNTBdID0gWzA7IDUwXTsKICAgIGxldCBtdXQgcXVldWVfZnJvbnQ6IHVzaXplID0gMDsKICAgIGxldCBtdXQgcXVldWVfcmVhcjogdXNpemUgPSAwOwogICAgbGV0IG11dCB2aXNpdF9jb3VudDogaTMyID0gMDsKCiAgICAvLyBFbnF1ZXVlIHN0YXJ0IHZlcnRleAogICAgcXVldWVbcXVldWVfcmVhcl0gPSBzdGFydDsKICAgIHF1ZXVlX3JlYXIgKz0gMTsKICAgIHZpc2l0ZWRbc3RhcnRdID0gMTsKICAgIHZpc2l0X2NvdW50ICs9IDE7CgogICAgd2hpbGUgKHF1ZXVlX2Zyb250IDwgcXVldWVfcmVhcikgewogICAgICAgIC8vIERlcXVldWUgdmVydGV4CiAgICAgICAgbGV0IGN1cnJlbnQ6IHVzaXplID0gcXVldWVbcXVldWVfZnJvbnRdOwogICAgICAgIHF1ZXVlX2Zyb250ICs9IDE7CgogICAgICAgIC8vIEVucXVldWUgYWxsIHVudmlzaXRlZCBuZWlnaGJvcnMKICAgICAgICBsZXQgbXV0IG5laWdoYm9yOiB1c2l6ZSA9IDA7CiAgICAgICAgd2hpbGUgKG5laWdoYm9yIDwgc2l6ZSkgewogICAgICAgICAgICBpZiAobWF0cml4W2N1cnJlbnQgKiBzaXplICsgbmVpZ2hib3JdID09IDEgJiYgdmlzaXRlZFtuZWlnaGJvcl0gPT0gMCkgewogICAgICAgICAgICAgICAgdmlzaXRlZFtuZWlnaGJvcl0gPSAxOwogICAgICAgICAgICAgICAgdmlzaXRfY291bnQgKz0gMTsKICAgICAgICAgICAgICAgIHF1ZXVlW3F1ZXVlX3JlYXJdID0gbmVpZ2hib3I7CiAgICAgICAgICAgICAgICBxdWV1ZV9yZWFyICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbmVpZ2hib3IgKz0gMTsKICAgICAgICB9CiAgICB9CgogICAgdmlzaXRfY291bnQKfQoKLy8gU2hvcnRlc3QgcGF0aCBhbGdvcml0aG1zIHVzaW5nIEZsb3lkLVdhcnNoYWxsCmZuIHBlcmZvcm1TaG9ydGVzdFBhdGgoKSAtPiBpMzIgewogICAgbGV0IGdyYXBoX3NpemU6IHVzaXplID0gNTA7CiAgICBsZXQgbXV0IGRpc3RhbmNlX21hdHJpeDogW2kzMjsgMjUwMF0gPSBbMDsgMjUwMF07IC8vIDUweDUwIG1hdHJpeAoKICAgIC8vIEluaXRpYWxpemUgZGlzdGFuY2UgbWF0cml4CiAgICBpbml0aWFsaXplRGlzdGFuY2VNYXRyaXgoJm11dCBkaXN0YW5jZV9tYXRyaXgsIGdyYXBoX3NpemUpOwoKICAgIC8vIEZsb3lkLVdhcnNoYWxsIGFsZ29yaXRobQogICAgZmxveWRXYXJzaGFsbCgmbXV0IGRpc3RhbmNlX21hdHJpeCwgZ3JhcGhfc2l6ZSk7CgogICAgLy8gQ2FsY3VsYXRlIHN1bSBvZiBhbGwgc2hvcnRlc3QgZGlzdGFuY2VzCiAgICBsZXQgbXV0IHRvdGFsX2Rpc3RhbmNlOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICB3aGlsZSAoaSA8IGdyYXBoX3NpemUpIHsKICAgICAgICBsZXQgbXV0IGo6IHVzaXplID0gMDsKICAgICAgICB3aGlsZSAoaiA8IGdyYXBoX3NpemUpIHsKICAgICAgICAgICAgaWYgKGkgIT0gaiAmJiBkaXN0YW5jZV9tYXRyaXhbaSAqIGdyYXBoX3NpemUgKyBqXSA8IDEwMDAwMDApIHsKICAgICAgICAgICAgICAgIHRvdGFsX2Rpc3RhbmNlICs9IGRpc3RhbmNlX21hdHJpeFtpICogZ3JhcGhfc2l6ZSArIGpdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogKz0gMTsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIHRvdGFsX2Rpc3RhbmNlICUgMTAwMDAKfQoKLy8gSW5pdGlhbGl6ZSBkaXN0YW5jZSBtYXRyaXggd2l0aCByYW5kb20gd2VpZ2h0cwpmbiBpbml0aWFsaXplRGlzdGFuY2VNYXRyaXgobWF0cml4OiAmbXV0IFtpMzI7IDI1MDBdLCBzaXplOiB1c2l6ZSkgewogICAgbGV0IGluZmluaXR5OiBpMzIgPSAxMDAwMDAwOwogICAgbGV0IG11dCBzZWVkOiBpMzIgPSA1NDMyMTsKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwoKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGxldCBtdXQgajogdXNpemUgPSAwOwogICAgICAgIHdoaWxlIChqIDwgc2l6ZSkgewogICAgICAgICAgICBpZiAoaSA9PSBqKSB7CiAgICAgICAgICAgICAgICBtYXRyaXhbaSAqIHNpemUgKyBqXSA9IDA7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB1cGRhdGUoJm11dCBzZWVkKTsKCiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgZWRnZSB3aXRoIDMwJSBwcm9iYWJpbGl0eQogICAgICAgICAgICAgICAgaWYgKHNlZWQgJSAxMDAgPCAzMCkgewogICAgICAgICAgICAgICAgICAgIG1hdHJpeFtpICogc2l6ZSArIGpdID0gKHNlZWQgJSAyMCkgKyAxOyAvLyBXZWlnaHQgMS0yMAogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBtYXRyaXhbaSAqIHNpemUgKyBqXSA9IGluZmluaXR5OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGogKz0gMTsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQp9CgovLyBGbG95ZC1XYXJzaGFsbCBzaG9ydGVzdCBwYXRoIGFsZ29yaXRobQpmbiBmbG95ZFdhcnNoYWxsKG1hdHJpeDogJm11dCBbaTMyOyAyNTAwXSwgc2l6ZTogdXNpemUpIHsKICAgIGxldCBtdXQgazogdXNpemUgPSAwOwogICAgd2hpbGUgKGsgPCBzaXplKSB7CiAgICAgICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgICAgIGxldCBtdXQgajogdXNpemUgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IHNpemUpIHsKICAgICAgICAgICAgICAgIGxldCBjdXJyZW50X2Rpc3RhbmNlOiBpMzIgPSBtYXRyaXhbaSAqIHNpemUgKyBqXTsKICAgICAgICAgICAgICAgIGxldCBuZXdfZGlzdGFuY2U6IGkzMiA9IG1hdHJpeFtpICogc2l6ZSArIGtdICsgbWF0cml4W2sgKiBzaXplICsgal07CgogICAgICAgICAgICAgICAgaWYgKG5ld19kaXN0YW5jZSA8IGN1cnJlbnRfZGlzdGFuY2UpIHsKICAgICAgICAgICAgICAgICAgICBtYXRyaXhbaSAqIHNpemUgKyBqXSA9IG5ld19kaXN0YW5jZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGogKz0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgICAgIGsgKz0gMTsKICAgIH0KfQoKLy8gR3JhcGggY29ubmVjdGl2aXR5IHRlc3RpbmcKZm4gcGVyZm9ybUNvbm5lY3Rpdml0eVRlc3QoKSAtPiBpMzIgewogICAgbGV0IGdyYXBoX3NpemU6IHVzaXplID0gNTA7CiAgICBsZXQgbXV0IGFkamFjZW5jeV9tYXRyaXg6IFtpMzI7IDI1MDBdID0gWzA7IDI1MDBdOyAvLyA1MHg1MCBtYXRyaXgKCiAgICAvLyBJbml0aWFsaXplIGdyYXBoCiAgICBpbml0aWFsaXplUmFuZG9tR3JhcGgoJm11dCBhZGphY2VuY3lfbWF0cml4LCBncmFwaF9zaXplKTsKCiAgICAvLyBDb3VudCBjb25uZWN0ZWQgY29tcG9uZW50cwogICAgbGV0IGNvbXBvbmVudF9jb3VudDogaTMyID0gY291bnRDb25uZWN0ZWRDb21wb25lbnRzKCZtdXQgYWRqYWNlbmN5X21hdHJpeCwgZ3JhcGhfc2l6ZSk7CgogICAgY29tcG9uZW50X2NvdW50Cn0KCi8vIENvdW50IGNvbm5lY3RlZCBjb21wb25lbnRzIHVzaW5nIERGUwpmbiBjb3VudENvbm5lY3RlZENvbXBvbmVudHMobWF0cml4OiAmbXV0IFtpMzI7IDI1MDBdLCBzaXplOiB1c2l6ZSkgLT4gaTMyIHsKICAgIGxldCBtdXQgdmlzaXRlZDogW2kzMjsgNTBdID0gWzA7IDUwXTsKICAgIGxldCBtdXQgY29tcG9uZW50X2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCB2ZXJ0ZXg6IHVzaXplID0gMDsKCiAgICB3aGlsZSAodmVydGV4IDwgc2l6ZSkgewogICAgICAgIGlmICh2aXNpdGVkW3ZlcnRleF0gPT0gMCkgewogICAgICAgICAgICAvLyBTdGFydCBuZXcgY29tcG9uZW50CiAgICAgICAgICAgIGNvbXBvbmVudF9jb3VudCArPSAxOwogICAgICAgICAgICBkZnNNYXJrQ29tcG9uZW50KG1hdHJpeCwgJm11dCB2aXNpdGVkLCBzaXplLCB2ZXJ0ZXgpOwogICAgICAgIH0KICAgICAgICB2ZXJ0ZXggKz0gMTsKICAgIH0KCiAgICBjb21wb25lbnRfY291bnQKfQoKLy8gREZTIHRvIG1hcmsgYWxsIHZlcnRpY2VzIGluIGEgY29tcG9uZW50CmZuIGRmc01hcmtDb21wb25lbnQobWF0cml4OiAmbXV0IFtpMzI7IDI1MDBdLCB2aXNpdGVkOiAmbXV0IFtpMzI7IDUwXSwgc2l6ZTogdXNpemUsIHN0YXJ0OiB1c2l6ZSkgewogICAgdmlzaXRlZFtzdGFydF0gPSAxOwoKICAgIGxldCBtdXQgbmVpZ2hib3I6IHVzaXplID0gMDsKICAgIHdoaWxlIChuZWlnaGJvciA8IHNpemUpIHsKICAgICAgICBpZiAobWF0cml4W3N0YXJ0ICogc2l6ZSArIG5laWdoYm9yXSA9PSAxICYmIHZpc2l0ZWRbbmVpZ2hib3JdID09IDApIHsKICAgICAgICAgICAgZGZzTWFya0NvbXBvbmVudChtYXRyaXgsIHZpc2l0ZWQsIHNpemUsIG5laWdoYm9yKTsKICAgICAgICB9CiAgICAgICAgbmVpZ2hib3IgKz0gMTsKICAgIH0KfQoKLy8gVGVzdCAzOiBEeW5hbWljIFByb2dyYW1taW5nIFByb2JsZW1zCi8vIFRlc3RzIG1lbW9pemF0aW9uIG9wcG9ydHVuaXRpZXMgYW5kIGxvb3AgbmVzdCBvcHRpbWl6YXRpb24KZm4gcGVyZm9ybUR5bmFtaWNQcm9ncmFtbWluZygpIHsKICAgIHByaW50bG5JbnQoMjAwNSk7IC8vIFN0YXJ0IGR5bmFtaWMgcHJvZ3JhbW1pbmcKCiAgICAvLyBUZXN0IGxvbmdlc3QgY29tbW9uIHN1YnNlcXVlbmNlCiAgICBsZXQgbGNzX3Jlc3VsdDogaTMyID0gbG9uZ2VzdENvbW1vblN1YnNlcXVlbmNlKCk7CiAgICBwcmludGxuSW50KGxjc19yZXN1bHQpOwoKICAgIC8vIFRlc3Qga25hcHNhY2sgcHJvYmxlbQogICAgbGV0IGtuYXBzYWNrX3Jlc3VsdDogaTMyID0ga25hcHNhY2tQcm9ibGVtKCk7CiAgICBwcmludGxuSW50KGtuYXBzYWNrX3Jlc3VsdCk7CgogICAgLy8gVGVzdCBlZGl0IGRpc3RhbmNlCiAgICBsZXQgZWRpdF9yZXN1bHQ6IGkzMiA9IGVkaXREaXN0YW5jZSgpOwogICAgcHJpbnRsbkludChlZGl0X3Jlc3VsdCk7CgogICAgcHJpbnRsbkludCgyMDA2KTsgLy8gRW5kIGR5bmFtaWMgcHJvZ3JhbW1pbmcKfQoKLy8gTG9uZ2VzdCBDb21tb24gU3Vic2VxdWVuY2UgcHJvYmxlbQpmbiBsb25nZXN0Q29tbW9uU3Vic2VxdWVuY2UoKSAtPiBpMzIgewogICAgbGV0IHN0cmluZzFfbGVuZ3RoOiB1c2l6ZSA9IDMwOwogICAgbGV0IHN0cmluZzJfbGVuZ3RoOiB1c2l6ZSA9IDI1OwogICAgbGV0IG11dCBzdHJpbmcxOiBbaTMyOyAzMF0gPSBbMDsgMzBdOwogICAgbGV0IG11dCBzdHJpbmcyOiBbaTMyOyAyNV0gPSBbMDsgMjVdOwogICAgbGV0IG11dCBkcF90YWJsZTogW2kzMjsgODA2XSA9IFswOyA4MDZdOyAvLyAoMzArMSkgKiAoMjUrMSkgdGFibGUKCiAgICAvLyBJbml0aWFsaXplIHN0cmluZ3Mgd2l0aCBwYXR0ZXJuCiAgICBpbml0aWFsaXplU3RyaW5ncygmbXV0IHN0cmluZzEsICZtdXQgc3RyaW5nMiwgMTcsIDIzKTsKCiAgICAvLyBGaWxsIERQIHRhYmxlCiAgICBsZXQgbXV0IGk6IHVzaXplID0gMTsKICAgIHdoaWxlIChpIDw9IHN0cmluZzFfbGVuZ3RoKSB7CiAgICAgICAgbGV0IG11dCBqOiB1c2l6ZSA9IDE7CiAgICAgICAgd2hpbGUgKGogPD0gc3RyaW5nMl9sZW5ndGgpIHsKICAgICAgICAgICAgaWYgKHN0cmluZzFbaSAtIDFdID09IHN0cmluZzJbaiAtIDFdKSB7CiAgICAgICAgICAgICAgICBkcF90YWJsZVtpICogKHN0cmluZzJfbGVuZ3RoICsgMSkgKyBqXSA9CiAgICAgICAgICAgICAgICAgICAgZHBfdGFibGVbKGkgLSAxKSAqIChzdHJpbmcyX2xlbmd0aCArIDEpICsgKGogLSAxKV0gKyAxOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbGV0IG9wdGlvbjE6IGkzMiA9IGRwX3RhYmxlWyhpIC0gMSkgKiAoc3RyaW5nMl9sZW5ndGggKyAxKSArIGpdOwogICAgICAgICAgICAgICAgbGV0IG9wdGlvbjI6IGkzMiA9IGRwX3RhYmxlW2kgKiAoc3RyaW5nMl9sZW5ndGggKyAxKSArIChqIC0gMSldOwoKICAgICAgICAgICAgICAgIGlmIChvcHRpb24xID4gb3B0aW9uMikgewogICAgICAgICAgICAgICAgICAgIGRwX3RhYmxlW2kgKiAoc3RyaW5nMl9sZW5ndGggKyAxKSArIGpdID0gb3B0aW9uMTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgZHBfdGFibGVbaSAqIChzdHJpbmcyX2xlbmd0aCArIDEpICsgal0gPSBvcHRpb24yOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGogKz0gMTsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIGRwX3RhYmxlW3N0cmluZzFfbGVuZ3RoICogKHN0cmluZzJfbGVuZ3RoICsgMSkgKyBzdHJpbmcyX2xlbmd0aF0KfQoKLy8gSW5pdGlhbGl6ZSBzdHJpbmcgd2l0aCBwYXR0ZXJuCmZuIGluaXRpYWxpemVTdHJpbmdzKHN0cjE6ICZtdXQgW2kzMjsgMzBdLCBzdHIyOiAmbXV0IFtpMzI7IDI1XSwgc2VlZDE6IGkzMiwgc2VlZDI6IGkzMikgewogICAgbGV0IG11dCBjdXJyZW50X3NlZWQ6IGkzMiA9IHNlZWQxOwogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CgogICAgd2hpbGUgKGkgPCAzMCkgewogICAgICAgIHVwZGF0ZSgmbXV0IGN1cnJlbnRfc2VlZCk7CiAgICAgICAgc3RyMVtpXSA9IGN1cnJlbnRfc2VlZCAlIDI2OyAvLyAyNiBkaWZmZXJlbnQgY2hhcmFjdGVycwogICAgICAgIGkgKz0gMTsKICAgIH0KCiAgICBsZXQgbXV0IGN1cnJlbnRfc2VlZDogaTMyID0gc2VlZDI7CiAgICBsZXQgbXV0IGo6IHVzaXplID0gMDsKICAgIHdoaWxlIChqIDwgMjUpIHsKICAgICAgICB1cGRhdGUoJm11dCBjdXJyZW50X3NlZWQpOwogICAgICAgIHN0cjJbal0gPSBjdXJyZW50X3NlZWQgJSAyNjsgLy8gMjYgZGlmZmVyZW50IGNoYXJhY3RlcnMKICAgICAgICBqICs9IDE7CiAgICB9Cn0KCi8vIDAtMSBLbmFwc2FjayBwcm9ibGVtCmZuIGtuYXBzYWNrUHJvYmxlbSgpIC0+IGkzMiB7CiAgICBsZXQgaXRlbV9jb3VudDogdXNpemUgPSAyMDsKICAgIGxldCBjYXBhY2l0eTogdXNpemUgPSAxMDA7CiAgICBsZXQgbXV0IHdlaWdodHM6IFtpMzI7IDIwXSA9IFswOyAyMF07CiAgICBsZXQgbXV0IHZhbHVlczogW2kzMjsgMjBdID0gWzA7IDIwXTsKICAgIGxldCBtdXQgZHBfdGFibGU6IFtpMzI7IDIxMjFdID0gWzA7IDIxMjFdOyAvLyAoMjArMSkgKiAoMTAwKzEpIHRhYmxlCgogICAgLy8gSW5pdGlhbGl6ZSBpdGVtcwogICAgaW5pdGlhbGl6ZUtuYXBzYWNrSXRlbXMoJm11dCB3ZWlnaHRzLCAmbXV0IHZhbHVlcywgaXRlbV9jb3VudCk7CgogICAgLy8gRmlsbCBEUCB0YWJsZQogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDE7CiAgICB3aGlsZSAoaSA8PSBpdGVtX2NvdW50KSB7CiAgICAgICAgbGV0IG11dCB3OiB1c2l6ZSA9IDE7CiAgICAgICAgd2hpbGUgKHcgPD0gY2FwYWNpdHkpIHsKICAgICAgICAgICAgbGV0IHdpdGhvdXRfaXRlbTogaTMyID0gZHBfdGFibGVbKGkgLSAxKSAqIChjYXBhY2l0eSArIDEpICsgd107CgogICAgICAgICAgICBpZiAod2VpZ2h0c1tpIC0gMV0gPD0gdyBhcyBpMzIpIHsKICAgICAgICAgICAgICAgIGxldCB3aXRoX2l0ZW06IGkzMiA9IHZhbHVlc1tpIC0gMV0KICAgICAgICAgICAgICAgICAgICArIGRwX3RhYmxlWyhpIC0gMSkgKiAoY2FwYWNpdHkgKyAxKSArICh3IC0gd2VpZ2h0c1tpIC0gMV0gYXMgdXNpemUpXTsKCiAgICAgICAgICAgICAgICBpZiAod2l0aF9pdGVtID4gd2l0aG91dF9pdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgZHBfdGFibGVbaSAqIChjYXBhY2l0eSArIDEpICsgd10gPSB3aXRoX2l0ZW07CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGRwX3RhYmxlW2kgKiAoY2FwYWNpdHkgKyAxKSArIHddID0gd2l0aG91dF9pdGVtOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZHBfdGFibGVbaSAqIChjYXBhY2l0eSArIDEpICsgd10gPSB3aXRob3V0X2l0ZW07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdyArPSAxOwogICAgICAgIH0KICAgICAgICBpICs9IDE7CiAgICB9CgogICAgZHBfdGFibGVbaXRlbV9jb3VudCAqIChjYXBhY2l0eSArIDEpICsgY2FwYWNpdHldCn0KCi8vIEluaXRpYWxpemUga25hcHNhY2sgaXRlbXMKZm4gaW5pdGlhbGl6ZUtuYXBzYWNrSXRlbXMod2VpZ2h0czogJm11dCBbaTMyOyAyMF0sIHZhbHVlczogJm11dCBbaTMyOyAyMF0sIGNvdW50OiB1c2l6ZSkgewogICAgbGV0IG11dCBzZWVkOiBpMzIgPSA5ODc2NTsKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwoKICAgIHdoaWxlIChpIDwgY291bnQpIHsKICAgICAgICB1cGRhdGUoJm11dCBzZWVkKTsKICAgICAgICB3ZWlnaHRzW2ldID0gKHNlZWQgJSAyMCkgKyAxOyAvLyBXZWlnaHQgMS0yMAoKICAgICAgICB1cGRhdGUoJm11dCBzZWVkKTsKICAgICAgICB2YWx1ZXNbaV0gPSAoc2VlZCAlIDUwKSArIDE7IC8vIFZhbHVlIDEtNTAKCiAgICAgICAgaSArPSAxOwogICAgfQp9CgovLyBFZGl0IGRpc3RhbmNlIHByb2JsZW0KZm4gZWRpdERpc3RhbmNlKCkgLT4gaTMyIHsKICAgIGxldCBzdHJpbmcxX2xlbmd0aDogdXNpemUgPSAxNTsKICAgIGxldCBzdHJpbmcyX2xlbmd0aDogdXNpemUgPSAxMjsKICAgIGxldCBtdXQgc3RyaW5nMTogW2kzMjsgMTVdID0gWzA7IDE1XTsKICAgIGxldCBtdXQgc3RyaW5nMjogW2kzMjsgMTJdID0gWzA7IDEyXTsKICAgIGxldCBtdXQgZHBfdGFibGU6IFtpMzI7IDIwOF0gPSBbMDsgMjA4XTsgLy8gKDE1KzEpICogKDEyKzEpIHRhYmxlCgogICAgLy8gSW5pdGlhbGl6ZSBzdHJpbmdzCiAgICBpbml0aWFsaXplRWRpdFN0cmluZ3MoJm11dCBzdHJpbmcxLCAmbXV0IHN0cmluZzIsIHN0cmluZzFfbGVuZ3RoLCBzdHJpbmcyX2xlbmd0aCk7CgogICAgLy8gSW5pdGlhbGl6ZSBmaXJzdCByb3cgYW5kIGNvbHVtbgogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICB3aGlsZSAoaSA8PSBzdHJpbmcxX2xlbmd0aCkgewogICAgICAgIGRwX3RhYmxlW2kgKiAoc3RyaW5nMl9sZW5ndGggKyAxKSArIDBdID0gaSBhcyBpMzI7CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIGxldCBtdXQgajogdXNpemUgPSAwOwogICAgd2hpbGUgKGogPD0gc3RyaW5nMl9sZW5ndGgpIHsKICAgICAgICBkcF90YWJsZVswICogKHN0cmluZzJfbGVuZ3RoICsgMSkgKyBqXSA9IGogYXMgaTMyOwogICAgICAgIGogKz0gMTsKICAgIH0KCiAgICAvLyBGaWxsIERQIHRhYmxlCiAgICBpID0gMTsKICAgIHdoaWxlIChpIDw9IHN0cmluZzFfbGVuZ3RoKSB7CiAgICAgICAgaiA9IDE7CiAgICAgICAgd2hpbGUgKGogPD0gc3RyaW5nMl9sZW5ndGgpIHsKICAgICAgICAgICAgaWYgKHN0cmluZzFbaSAtIDFdID09IHN0cmluZzJbaiAtIDFdKSB7CiAgICAgICAgICAgICAgICBkcF90YWJsZVtpICogKHN0cmluZzJfbGVuZ3RoICsgMSkgKyBqXSA9CiAgICAgICAgICAgICAgICAgICAgZHBfdGFibGVbKGkgLSAxKSAqIChzdHJpbmcyX2xlbmd0aCArIDEpICsgKGogLSAxKV07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBsZXQgaW5zZXJ0X2Nvc3Q6IGkzMiA9IGRwX3RhYmxlW2kgKiAoc3RyaW5nMl9sZW5ndGggKyAxKSArIChqIC0gMSldICsgMTsKICAgICAgICAgICAgICAgIGxldCBkZWxldGVfY29zdDogaTMyID0gZHBfdGFibGVbKGkgLSAxKSAqIChzdHJpbmcyX2xlbmd0aCArIDEpICsgal0gKyAxOwogICAgICAgICAgICAgICAgbGV0IHJlcGxhY2VfY29zdDogaTMyID0gZHBfdGFibGVbKGkgLSAxKSAqIChzdHJpbmcyX2xlbmd0aCArIDEpICsgKGogLSAxKV0gKyAxOwoKICAgICAgICAgICAgICAgIGxldCBtaW5fY29zdDogaTMyID0gZmluZE1pbmltdW0oaW5zZXJ0X2Nvc3QsIGRlbGV0ZV9jb3N0LCByZXBsYWNlX2Nvc3QpOwogICAgICAgICAgICAgICAgZHBfdGFibGVbaSAqIChzdHJpbmcyX2xlbmd0aCArIDEpICsgal0gPSBtaW5fY29zdDsKICAgICAgICAgICAgfQogICAgICAgICAgICBqICs9IDE7CiAgICAgICAgfQogICAgICAgIGkgKz0gMTsKICAgIH0KCiAgICByZXR1cm4gZHBfdGFibGVbc3RyaW5nMV9sZW5ndGggKiAoc3RyaW5nMl9sZW5ndGggKyAxKSArIHN0cmluZzJfbGVuZ3RoXTsKfQoKLy8gSW5pdGlhbGl6ZSBzdHJpbmdzIGZvciBlZGl0IGRpc3RhbmNlCmZuIGluaXRpYWxpemVFZGl0U3RyaW5ncyhzdHIxOiAmbXV0IFtpMzI7IDE1XSwgc3RyMjogJm11dCBbaTMyOyAxMl0sIGxlbjE6IHVzaXplLCBsZW4yOiB1c2l6ZSkgewogICAgbGV0IG11dCBzZWVkMTogaTMyID0gMTExMTE7CiAgICBsZXQgbXV0IHNlZWQyOiBpMzIgPSAyMjIyMjsKCiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgIHdoaWxlIChpIDwgbGVuMSkgewogICAgICAgIHVwZGF0ZSgmbXV0IHNlZWQxKTsKICAgICAgICBzdHIxW2ldID0gc2VlZDEgJSAxMDsgLy8gMTAgZGlmZmVyZW50IGNoYXJhY3RlcnMKICAgICAgICBpICs9IDE7CiAgICB9CgogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IGxlbjIpIHsKICAgICAgICB1cGRhdGUoJm11dCBzZWVkMik7CiAgICAgICAgc3RyMltpXSA9IHNlZWQyICUgMTA7IC8vIDEwIGRpZmZlcmVudCBjaGFyYWN0ZXJzCiAgICAgICAgaSArPSAxOwogICAgfQp9CgovLyBGaW5kIG1pbmltdW0gb2YgdGhyZWUgdmFsdWVzCmZuIGZpbmRNaW5pbXVtKGE6IGkzMiwgYjogaTMyLCBjOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IG1pbjogaTMyID0gYTsKICAgIGlmIChiIDwgbWluKSB7CiAgICAgICAgbWluID0gYjsKICAgIH0KICAgIGlmIChjIDwgbWluKSB7CiAgICAgICAgbWluID0gYzsKICAgIH0KICAgIHJldHVybiBtaW47Cn0KCi8vIFRlc3QgNDogU3RhdGUgTWFjaGluZSBTaW11bGF0aW9uCi8vIFRlc3RzIGp1bXAgdGFibGUgb3B0aW1pemF0aW9uIGFuZCBjb21wbGV4IHN0YXRlIHRyYW5zaXRpb25zCmZuIHBlcmZvcm1TdGF0ZU1hY2hpbmVTaW11bGF0aW9uKCkgewogICAgcHJpbnRsbkludCgyMDA3KTsgLy8gU3RhcnQgc3RhdGUgbWFjaGluZSBzaW11bGF0aW9uCgogICAgLy8gVGVzdCBmaW5pdGUgc3RhdGUgYXV0b21hdG9uCiAgICBsZXQgZnNhX3Jlc3VsdDogaTMyID0gZmluaXRlU3RhdGVBdXRvbWF0b24oKTsKICAgIHByaW50bG5JbnQoZnNhX3Jlc3VsdCk7CgogICAgLy8gVGVzdCB0cmFmZmljIGxpZ2h0IHNpbXVsYXRpb24KICAgIGxldCB0cmFmZmljX3Jlc3VsdDogaTMyID0gdHJhZmZpY0xpZ2h0U2ltdWxhdGlvbigpOwogICAgcHJpbnRsbkludCh0cmFmZmljX3Jlc3VsdCk7CgogICAgcHJpbnRsbkludCgyMDA4KTsgLy8gRW5kIHN0YXRlIG1hY2hpbmUgc2ltdWxhdGlvbgp9CgovLyBGaW5pdGUgc3RhdGUgYXV0b21hdG9uIHNpbXVsYXRpb24KZm4gZmluaXRlU3RhdGVBdXRvbWF0b24oKSAtPiBpMzIgewogICAgbGV0IGlucHV0X2xlbmd0aDogdXNpemUgPSAxMDAwOwogICAgbGV0IG11dCBpbnB1dF9zZXF1ZW5jZTogW2kzMjsgMTAwMF0gPSBbMDsgMTAwMF07CiAgICBsZXQgbXV0IGN1cnJlbnRfc3RhdGU6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGFjY2VwdGVkX2NvdW50OiBpMzIgPSAwOwoKICAgIC8vIEdlbmVyYXRlIGlucHV0IHNlcXVlbmNlCiAgICBnZW5lcmF0ZUlucHV0U2VxdWVuY2UoJm11dCBpbnB1dF9zZXF1ZW5jZSwgaW5wdXRfbGVuZ3RoKTsKCiAgICAvLyBQcm9jZXNzIGlucHV0IHRocm91Z2ggc3RhdGUgbWFjaGluZQogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICB3aGlsZSAoaSA8IGlucHV0X2xlbmd0aCkgewogICAgICAgIGxldCBpbnB1dF9zeW1ib2w6IGkzMiA9IGlucHV0X3NlcXVlbmNlW2ldOwogICAgICAgIGN1cnJlbnRfc3RhdGUgPSBzdGF0ZVRyYW5zaXRpb24oY3VycmVudF9zdGF0ZSwgaW5wdXRfc3ltYm9sKTsKCiAgICAgICAgLy8gQ2hlY2sgaWYgaW4gYWNjZXB0aW5nIHN0YXRlCiAgICAgICAgaWYgKGlzQWNjZXB0aW5nU3RhdGUoY3VycmVudF9zdGF0ZSkgPT0gMSkgewogICAgICAgICAgICBhY2NlcHRlZF9jb3VudCArPSAxOwogICAgICAgIH0KCiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIHJldHVybiBhY2NlcHRlZF9jb3VudDsKfQoKLy8gR2VuZXJhdGUgaW5wdXQgc2VxdWVuY2UgZm9yIGF1dG9tYXRvbgpmbiBnZW5lcmF0ZUlucHV0U2VxdWVuY2Uoc2VxdWVuY2U6ICZtdXQgW2kzMjsgMTAwMF0sIGxlbmd0aDogdXNpemUpIHsKICAgIGxldCBtdXQgc2VlZDogaTMyID0gMTM1Nzk7CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKCiAgICB3aGlsZSAoaSA8IGxlbmd0aCkgewogICAgICAgIHVwZGF0ZSgmbXV0IHNlZWQpOwogICAgICAgIHNlcXVlbmNlW2ldID0gc2VlZCAlIDQ7IC8vIDQgaW5wdXQgc3ltYm9sczogMCwgMSwgMiwgMwogICAgICAgIGkgKz0gMTsKICAgIH0KfQoKLy8gU3RhdGUgdHJhbnNpdGlvbiBmdW5jdGlvbiBmb3IgOC1zdGF0ZSBhdXRvbWF0b24KZm4gc3RhdGVUcmFuc2l0aW9uKGN1cnJlbnRfc3RhdGU6IGkzMiwgaW5wdXQ6IGkzMikgLT4gaTMyIHsKICAgIC8vIFNpbXVsYXRlIGNvbXBsZXggc3RhdGUgbWFjaGluZSB3aXRoIDggc3RhdGVzIGFuZCA0IGlucHV0IHN5bWJvbHMKICAgIGlmIChjdXJyZW50X3N0YXRlID09IDApIHsKICAgICAgICBpZiAoaW5wdXQgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICB9IGVsc2UgaWYgKGlucHV0ID09IDEpIHsKICAgICAgICAgICAgcmV0dXJuIDI7CiAgICAgICAgfSBlbHNlIGlmIChpbnB1dCA9PSAyKSB7CiAgICAgICAgICAgIHJldHVybiAzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoY3VycmVudF9zdGF0ZSA9PSAxKSB7CiAgICAgICAgaWYgKGlucHV0ID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfSBlbHNlIGlmIChpbnB1dCA9PSAxKSB7CiAgICAgICAgICAgIHJldHVybiA0OwogICAgICAgIH0gZWxzZSBpZiAoaW5wdXQgPT0gMikgewogICAgICAgICAgICByZXR1cm4gNTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGN1cnJlbnRfc3RhdGUgPT0gMikgewogICAgICAgIGlmIChpbnB1dCA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiA2OwogICAgICAgIH0gZWxzZSBpZiAoaW5wdXQgPT0gMSkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9IGVsc2UgaWYgKGlucHV0ID09IDIpIHsKICAgICAgICAgICAgcmV0dXJuIDc7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIDI7CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChjdXJyZW50X3N0YXRlID09IDMpIHsKICAgICAgICBpZiAoaW5wdXQgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gNzsKICAgICAgICB9IGVsc2UgaWYgKGlucHV0ID09IDEpIHsKICAgICAgICAgICAgcmV0dXJuIDY7CiAgICAgICAgfSBlbHNlIGlmIChpbnB1dCA9PSAyKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiAzOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoY3VycmVudF9zdGF0ZSA9PSA0KSB7CiAgICAgICAgaWYgKGlucHV0ID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDI7CiAgICAgICAgfSBlbHNlIGlmIChpbnB1dCA9PSAxKSB7CiAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0gZWxzZSBpZiAoaW5wdXQgPT0gMikgewogICAgICAgICAgICByZXR1cm4gNDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gNTsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGN1cnJlbnRfc3RhdGUgPT0gNSkgewogICAgICAgIGlmIChpbnB1dCA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiA0OwogICAgICAgIH0gZWxzZSBpZiAoaW5wdXQgPT0gMSkgewogICAgICAgICAgICByZXR1cm4gMzsKICAgICAgICB9IGVsc2UgaWYgKGlucHV0ID09IDIpIHsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIDY7CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChjdXJyZW50X3N0YXRlID09IDYpIHsKICAgICAgICBpZiAoaW5wdXQgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gNTsKICAgICAgICB9IGVsc2UgaWYgKGlucHV0ID09IDEpIHsKICAgICAgICAgICAgcmV0dXJuIDc7CiAgICAgICAgfSBlbHNlIGlmIChpbnB1dCA9PSAyKSB7CiAgICAgICAgICAgIHJldHVybiAyOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiA0OwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgLy8gY3VycmVudF9zdGF0ZSA9PSA3CiAgICAgICAgaWYgKGlucHV0ID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDM7CiAgICAgICAgfSBlbHNlIGlmIChpbnB1dCA9PSAxKSB7CiAgICAgICAgICAgIHJldHVybiA1OwogICAgICAgIH0gZWxzZSBpZiAoaW5wdXQgPT0gMikgewogICAgICAgICAgICByZXR1cm4gNjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gNzsKICAgICAgICB9CiAgICB9Cn0KCi8vIENoZWNrIGlmIHN0YXRlIGlzIGFjY2VwdGluZwpmbiBpc0FjY2VwdGluZ1N0YXRlKHN0YXRlOiBpMzIpIC0+IGkzMiB7CiAgICByZXR1cm4gKHN0YXRlID09IDMgfHwgc3RhdGUgPT0gNSB8fCBzdGF0ZSA9PSA3KSBhcyBpMzI7Cn0KCi8vIFRyYWZmaWMgbGlnaHQgc2ltdWxhdGlvbiB3aXRoIGNvbXBsZXggdGltaW5nCmZuIHRyYWZmaWNMaWdodFNpbXVsYXRpb24oKSAtPiBpMzIgewogICAgbGV0IHNpbXVsYXRpb25fdGltZTogaTMyID0gMTAwMDsKICAgIGxldCBtdXQgbm9ydGhfc291dGhfc3RhdGU6IGkzMiA9IDA7IC8vIDA9cmVkLCAxPXllbGxvdywgMj1ncmVlbgogICAgbGV0IG11dCBlYXN0X3dlc3Rfc3RhdGU6IGkzMiA9IDI7IC8vIDA9cmVkLCAxPXllbGxvdywgMj1ncmVlbgogICAgbGV0IG11dCB0aW1lX2luX3N0YXRlOiBpMzIgPSAwOwogICAgbGV0IG11dCBzdGF0ZV9jaGFuZ2VzOiBpMzIgPSAwOwoKICAgIGxldCBtdXQgdGltZTogaTMyID0gMDsKICAgIHdoaWxlICh0aW1lIDwgc2ltdWxhdGlvbl90aW1lKSB7CiAgICAgICAgdGltZV9pbl9zdGF0ZSArPSAxOwoKICAgICAgICAvLyBDb21wbGV4IHN0YXRlIHRyYW5zaXRpb24gbG9naWMKICAgICAgICBpZiAoc2hvdWxkQ2hhbmdlU3RhdGUobm9ydGhfc291dGhfc3RhdGUsIGVhc3Rfd2VzdF9zdGF0ZSwgdGltZV9pbl9zdGF0ZSwgdGltZSkgPT0gMSkgewogICAgICAgICAgICAvLyBDaGFuZ2Ugc3RhdGVzCiAgICAgICAgICAgIGxldCBuZXdfbnNfc3RhdGU6IGkzMiA9IGdldE5leHRUcmFmZmljU3RhdGUobm9ydGhfc291dGhfc3RhdGUpOwogICAgICAgICAgICBsZXQgbmV3X2V3X3N0YXRlOiBpMzIgPSBnZXROZXh0VHJhZmZpY1N0YXRlKGVhc3Rfd2VzdF9zdGF0ZSk7CgogICAgICAgICAgICBub3J0aF9zb3V0aF9zdGF0ZSA9IG5ld19uc19zdGF0ZTsKICAgICAgICAgICAgZWFzdF93ZXN0X3N0YXRlID0gbmV3X2V3X3N0YXRlOwogICAgICAgICAgICB0aW1lX2luX3N0YXRlID0gMDsKICAgICAgICAgICAgc3RhdGVfY2hhbmdlcyArPSAxOwogICAgICAgIH0KCiAgICAgICAgdGltZSArPSAxOwogICAgfQoKICAgIHJldHVybiBzdGF0ZV9jaGFuZ2VzOwp9CgovLyBEZXRlcm1pbmUgaWYgdHJhZmZpYyBsaWdodHMgc2hvdWxkIGNoYW5nZSBzdGF0ZQpmbiBzaG91bGRDaGFuZ2VTdGF0ZShuc19zdGF0ZTogaTMyLCBld19zdGF0ZTogaTMyLCB0aW1lX2luX3N0YXRlOiBpMzIsIGN1cnJlbnRfdGltZTogaTMyKSAtPiBpMzIgewogICAgLy8gR3JlZW4gbGlnaHQgZHVyYXRpb246IDMwLTUwIHRpbWUgdW5pdHMgKHZhcmllcyBiYXNlZCBvbiB0cmFmZmljKQogICAgLy8gWWVsbG93IGxpZ2h0IGR1cmF0aW9uOiA1IHRpbWUgdW5pdHMKICAgIC8vIFJlZCBsaWdodCBkdXJhdGlvbjogMzUtNTUgdGltZSB1bml0cwoKICAgIGxldCB0cmFmZmljX2ZhY3RvcjogaTMyID0gKGN1cnJlbnRfdGltZSAlIDEwMCkgLyAxMDsgLy8gU2ltdWxhdGVkIHRyYWZmaWMgZGVuc2l0eQoKICAgIGlmIChuc19zdGF0ZSA9PSAyKSB7CiAgICAgICAgLy8gTm9ydGgtU291dGggZ3JlZW4KICAgICAgICBsZXQgZ3JlZW5fZHVyYXRpb246IGkzMiA9IDMwICsgdHJhZmZpY19mYWN0b3I7CiAgICAgICAgcmV0dXJuICh0aW1lX2luX3N0YXRlID49IGdyZWVuX2R1cmF0aW9uKSBhcyBpMzI7CiAgICB9IGVsc2UgaWYgKG5zX3N0YXRlID09IDEpIHsKICAgICAgICAvLyBOb3J0aC1Tb3V0aCB5ZWxsb3cKICAgICAgICByZXR1cm4gKHRpbWVfaW5fc3RhdGUgPj0gNSkgYXMgaTMyOwogICAgfSBlbHNlIHsKICAgICAgICAvLyBOb3J0aC1Tb3V0aCByZWQKICAgICAgICBsZXQgcmVkX2R1cmF0aW9uOiBpMzIgPSAzNSArIHRyYWZmaWNfZmFjdG9yOwogICAgICAgIHJldHVybiAodGltZV9pbl9zdGF0ZSA+PSByZWRfZHVyYXRpb24pIGFzIGkzMjsKICAgIH0KfQoKLy8gR2V0IG5leHQgdHJhZmZpYyBsaWdodCBzdGF0ZQpmbiBnZXROZXh0VHJhZmZpY1N0YXRlKGN1cnJlbnRfc3RhdGU6IGkzMikgLT4gaTMyIHsKICAgIGlmIChjdXJyZW50X3N0YXRlID09IDApIHsKICAgICAgICAvLyByZWQgLT4gZ3JlZW4KICAgICAgICByZXR1cm4gMjsKICAgIH0gZWxzZSBpZiAoY3VycmVudF9zdGF0ZSA9PSAxKSB7CiAgICAgICAgLy8geWVsbG93IC0+IHJlZAogICAgICAgIHJldHVybiAwOwogICAgfSBlbHNlIHsKICAgICAgICAvLyBncmVlbiAtPiB5ZWxsb3cKICAgICAgICByZXR1cm4gMTsKICAgIH0KfQoKLy8gVGVzdCA1OiBTZWFyY2ggQWxnb3JpdGhtcwovLyBUZXN0cyBmdW5jdGlvbiBjYWxsIG9wdGltaXphdGlvbiBhbmQgZGlmZmVyZW50IHNlYXJjaCBwYXR0ZXJucwpmbiBwZXJmb3JtU2VhcmNoQWxnb3JpdGhtcygpIHsKICAgIHByaW50bG5JbnQoMjAwOSk7IC8vIFN0YXJ0IHNlYXJjaCBhbGdvcml0aG1zCgogICAgLy8gVGVzdCBiaW5hcnkgc2VhcmNoIHZhcmlhdGlvbnMKICAgIGxldCBiaW5hcnlfcmVzdWx0OiBpMzIgPSBwZXJmb3JtQmluYXJ5U2VhcmNoVGVzdHMoKTsKICAgIHByaW50bG5JbnQoYmluYXJ5X3Jlc3VsdCk7CgogICAgLy8gVGVzdCBwYXR0ZXJuIG1hdGNoaW5nCiAgICBsZXQgcGF0dGVybl9yZXN1bHQ6IGkzMiA9IHBlcmZvcm1QYXR0ZXJuTWF0Y2hpbmcoKTsKICAgIHByaW50bG5JbnQocGF0dGVybl9yZXN1bHQpOwoKICAgIHByaW50bG5JbnQoMjAxMCk7IC8vIEVuZCBzZWFyY2ggYWxnb3JpdGhtcwp9CgovLyBCaW5hcnkgc2VhcmNoIHZhcmlhdGlvbnMgdGVzdGluZwpmbiBwZXJmb3JtQmluYXJ5U2VhcmNoVGVzdHMoKSAtPiBpMzIgewogICAgbGV0IGFycmF5X3NpemU6IHVzaXplID0gNTAwOwogICAgbGV0IG11dCBzb3J0ZWRfYXJyYXk6IFtpMzI7IDUwMF0gPSBbMDsgNTAwXTsKICAgIGxldCBtdXQgc2VhcmNoX3Jlc3VsdHM6IGkzMiA9IDA7CgogICAgLy8gSW5pdGlhbGl6ZSBzb3J0ZWQgYXJyYXkKICAgIGluaXRpYWxpemVTb3J0ZWRBcnJheSgmbXV0IHNvcnRlZF9hcnJheSwgYXJyYXlfc2l6ZSk7CgogICAgLy8gVGVzdCBtdWx0aXBsZSBiaW5hcnkgc2VhcmNoZXMKICAgIGxldCBtdXQgdGFyZ2V0OiBpMzIgPSAwOwogICAgd2hpbGUgKHRhcmdldCA8IDEwMCkgewogICAgICAgIGxldCByZXN1bHQ6IGkzMiA9IGJpbmFyeVNlYXJjaChzb3J0ZWRfYXJyYXksIGFycmF5X3NpemUsIHRhcmdldCAqIDEwKTsKICAgICAgICBpZiAocmVzdWx0ICE9IC0xKSB7CiAgICAgICAgICAgIHNlYXJjaF9yZXN1bHRzICs9IDE7CiAgICAgICAgfQogICAgICAgIHRhcmdldCArPSAxOwogICAgfQoKICAgIC8vIFRlc3QgYmluYXJ5IHNlYXJjaCBmb3IgZmlyc3Qgb2NjdXJyZW5jZQogICAgdGFyZ2V0ID0gMDsKICAgIHdoaWxlICh0YXJnZXQgPCA1MCkgewogICAgICAgIGxldCByZXN1bHQ6IGkzMiA9IGJpbmFyeVNlYXJjaEZpcnN0KHNvcnRlZF9hcnJheSwgYXJyYXlfc2l6ZSwgdGFyZ2V0ICogMjApOwogICAgICAgIGlmIChyZXN1bHQgIT0gLTEpIHsKICAgICAgICAgICAgc2VhcmNoX3Jlc3VsdHMgKz0gcmVzdWx0OwogICAgICAgIH0KICAgICAgICB0YXJnZXQgKz0gMTsKICAgIH0KCiAgICAvLyBUZXN0IGJpbmFyeSBzZWFyY2ggZm9yIGxhc3Qgb2NjdXJyZW5jZQogICAgdGFyZ2V0ID0gMDsKICAgIHdoaWxlICh0YXJnZXQgPCA1MCkgewogICAgICAgIGxldCByZXN1bHQ6IGkzMiA9IGJpbmFyeVNlYXJjaExhc3Qoc29ydGVkX2FycmF5LCBhcnJheV9zaXplLCB0YXJnZXQgKiAyMCk7CiAgICAgICAgaWYgKHJlc3VsdCAhPSAtMSkgewogICAgICAgICAgICBzZWFyY2hfcmVzdWx0cyArPSByZXN1bHQ7CiAgICAgICAgfQogICAgICAgIHRhcmdldCArPSAxOwogICAgfQoKICAgIHJldHVybiBzZWFyY2hfcmVzdWx0cyAlIDEwMDAwCn0KCi8vIEluaXRpYWxpemUgc29ydGVkIGFycmF5IHdpdGggZHVwbGljYXRlcwpmbiBpbml0aWFsaXplU29ydGVkQXJyYXkoYXJyOiAmbXV0IFtpMzI7IDUwMF0sIHNpemU6IHVzaXplKSB7CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGFycltpXSA9IChpIGFzIGkzMiAvIDUpICogMTA7IC8vIEdyb3VwcyBvZiA1IHdpdGggc2FtZSB2YWx1ZQogICAgICAgIGkgKz0gMTsKICAgIH0KfQoKLy8gU3RhbmRhcmQgYmluYXJ5IHNlYXJjaApmbiBiaW5hcnlTZWFyY2goYXJyOiBbaTMyOyA1MDBdLCBzaXplOiB1c2l6ZSwgdGFyZ2V0OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGxlZnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHJpZ2h0OiBpMzIgPSAoc2l6ZSAtIDEpIGFzIGkzMjsKCiAgICB3aGlsZSAobGVmdCA8PSByaWdodCkgewogICAgICAgIGxldCBtaWQ6IGkzMiA9IGxlZnQgKyAocmlnaHQgLSBsZWZ0KSAvIDI7CgogICAgICAgIGlmIChhcnJbbWlkIGFzIHVzaXplXSA9PSB0YXJnZXQpIHsKICAgICAgICAgICAgcmV0dXJuIG1pZDsKICAgICAgICB9IGVsc2UgaWYgKGFyclttaWQgYXMgdXNpemVdIDwgdGFyZ2V0KSB7CiAgICAgICAgICAgIGxlZnQgPSBtaWQgKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJpZ2h0ID0gbWlkIC0gMTsKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIC0xOwp9CgovLyBCaW5hcnkgc2VhcmNoIGZvciBmaXJzdCBvY2N1cnJlbmNlCmZuIGJpbmFyeVNlYXJjaEZpcnN0KGFycjogW2kzMjsgNTAwXSwgc2l6ZTogdXNpemUsIHRhcmdldDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBsZWZ0OiBpMzIgPSAwOwogICAgbGV0IG11dCByaWdodDogaTMyID0gKHNpemUgLSAxKSBhcyBpMzI7CiAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gLTE7CgogICAgd2hpbGUgKGxlZnQgPD0gcmlnaHQpIHsKICAgICAgICBsZXQgbWlkOiBpMzIgPSBsZWZ0ICsgKHJpZ2h0IC0gbGVmdCkgLyAyOwoKICAgICAgICBpZiAoYXJyW21pZCBhcyB1c2l6ZV0gPT0gdGFyZ2V0KSB7CiAgICAgICAgICAgIHJlc3VsdCA9IG1pZDsKICAgICAgICAgICAgcmlnaHQgPSBtaWQgLSAxOyAvLyBDb250aW51ZSBzZWFyY2hpbmcgaW4gbGVmdCBoYWxmCiAgICAgICAgfSBlbHNlIGlmIChhcnJbbWlkIGFzIHVzaXplXSA8IHRhcmdldCkgewogICAgICAgICAgICBsZWZ0ID0gbWlkICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByaWdodCA9IG1pZCAtIDE7CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiByZXN1bHQ7Cn0KCi8vIEJpbmFyeSBzZWFyY2ggZm9yIGxhc3Qgb2NjdXJyZW5jZQpmbiBiaW5hcnlTZWFyY2hMYXN0KGFycjogW2kzMjsgNTAwXSwgc2l6ZTogdXNpemUsIHRhcmdldDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBsZWZ0OiBpMzIgPSAwOwogICAgbGV0IG11dCByaWdodDogaTMyID0gKHNpemUgLSAxKSBhcyBpMzI7CiAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gLTE7CgogICAgd2hpbGUgKGxlZnQgPD0gcmlnaHQpIHsKICAgICAgICBsZXQgbWlkOiBpMzIgPSBsZWZ0ICsgKHJpZ2h0IC0gbGVmdCkgLyAyOwoKICAgICAgICBpZiAoYXJyW21pZCBhcyB1c2l6ZV0gPT0gdGFyZ2V0KSB7CiAgICAgICAgICAgIHJlc3VsdCA9IG1pZDsKICAgICAgICAgICAgbGVmdCA9IG1pZCArIDE7IC8vIENvbnRpbnVlIHNlYXJjaGluZyBpbiByaWdodCBoYWxmCiAgICAgICAgfSBlbHNlIGlmIChhcnJbbWlkIGFzIHVzaXplXSA8IHRhcmdldCkgewogICAgICAgICAgICBsZWZ0ID0gbWlkICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByaWdodCA9IG1pZCAtIDE7CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiByZXN1bHQ7Cn0KCi8vIFBhdHRlcm4gbWF0Y2hpbmcgYWxnb3JpdGhtcwpmbiBwZXJmb3JtUGF0dGVybk1hdGNoaW5nKCkgLT4gaTMyIHsKICAgIGxldCB0ZXh0X2xlbmd0aDogdXNpemUgPSAyMDA7CiAgICBsZXQgcGF0dGVybl9sZW5ndGg6IHVzaXplID0gMTA7CiAgICBsZXQgbXV0IHRleHQ6IFtpMzI7IDIwMF0gPSBbMDsgMjAwXTsKICAgIGxldCBtdXQgcGF0dGVybjogW2kzMjsgMTBdID0gWzA7IDEwXTsKCiAgICAvLyBJbml0aWFsaXplIHRleHQgYW5kIHBhdHRlcm4KICAgIGluaXRpYWxpemVUZXh0QW5kUGF0dGVybigmbXV0IHRleHQsICZtdXQgcGF0dGVybiwgdGV4dF9sZW5ndGgsIHBhdHRlcm5fbGVuZ3RoKTsKCiAgICAvLyBUZXN0IG5haXZlIHBhdHRlcm4gbWF0Y2hpbmcKICAgIGxldCBuYWl2ZV9tYXRjaGVzOiBpMzIgPSBuYWl2ZVBhdHRlcm5NYXRjaGluZygmdGV4dCwgJnBhdHRlcm4sIHRleHRfbGVuZ3RoLCBwYXR0ZXJuX2xlbmd0aCk7CgogICAgLy8gVGVzdCBLTVAgcGF0dGVybiBtYXRjaGluZwogICAgbGV0IGttcF9tYXRjaGVzOiBpMzIgPSBrbXBQYXR0ZXJuTWF0Y2hpbmcoJnRleHQsICZwYXR0ZXJuLCB0ZXh0X2xlbmd0aCwgcGF0dGVybl9sZW5ndGgpOwoKICAgIHJldHVybiBuYWl2ZV9tYXRjaGVzICsga21wX21hdGNoZXM7Cn0KCi8vIEluaXRpYWxpemUgdGV4dCBhbmQgcGF0dGVybiBmb3IgbWF0Y2hpbmcKZm4gaW5pdGlhbGl6ZVRleHRBbmRQYXR0ZXJuKAogICAgdGV4dDogJm11dCBbaTMyOyAyMDBdLAogICAgcGF0dGVybjogJm11dCBbaTMyOyAxMF0sCiAgICB0ZXh0X2xlbjogdXNpemUsCiAgICBwYXR0ZXJuX2xlbjogdXNpemUsCikgewogICAgbGV0IG11dCBzZWVkOiBpMzIgPSAyNDY4MTsKCiAgICAvLyBJbml0aWFsaXplIHRleHQKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwogICAgd2hpbGUgKGkgPCB0ZXh0X2xlbikgewogICAgICAgIHVwZGF0ZSgmbXV0IHNlZWQpOwogICAgICAgIHRleHRbaV0gPSBzZWVkICUgNTsgLy8gNSBkaWZmZXJlbnQgY2hhcmFjdGVycwogICAgICAgIGkgKz0gMTsKICAgIH0KCiAgICAvLyBJbml0aWFsaXplIHBhdHRlcm4KICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBwYXR0ZXJuX2xlbikgewogICAgICAgIHVwZGF0ZSgmbXV0IHNlZWQpOwogICAgICAgIHBhdHRlcm5baV0gPSBzZWVkICUgNTsgLy8gNSBkaWZmZXJlbnQgY2hhcmFjdGVycwogICAgICAgIGkgKz0gMTsKICAgIH0KfQoKLy8gTmFpdmUgcGF0dGVybiBtYXRjaGluZyBhbGdvcml0aG0KZm4gbmFpdmVQYXR0ZXJuTWF0Y2hpbmcoCiAgICB0ZXh0OiAmW2kzMjsgMjAwXSwKICAgIHBhdHRlcm46ICZbaTMyOyAxMF0sCiAgICB0ZXh0X2xlbjogdXNpemUsCiAgICBwYXR0ZXJuX2xlbjogdXNpemUsCikgLT4gaTMyIHsKICAgIGxldCBtdXQgbWF0Y2hlczogaTMyID0gMDsKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwoKICAgIHdoaWxlIChpIDw9IHRleHRfbGVuIC0gcGF0dGVybl9sZW4pIHsKICAgICAgICBsZXQgbXV0IGo6IHVzaXplID0gMDsKICAgICAgICBsZXQgbXV0IG1hdGNoX2ZvdW5kOiBpMzIgPSAxOwoKICAgICAgICB3aGlsZSAoaiA8IHBhdHRlcm5fbGVuKSB7CiAgICAgICAgICAgIGlmICh0ZXh0W2kgKyBqXSAhPSBwYXR0ZXJuW2pdKSB7CiAgICAgICAgICAgICAgICBtYXRjaF9mb3VuZCA9IDA7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBqICs9IDE7CiAgICAgICAgfQoKICAgICAgICBpZiAobWF0Y2hfZm91bmQgPT0gMSkgewogICAgICAgICAgICBtYXRjaGVzICs9IDE7CiAgICAgICAgfQoKICAgICAgICBpICs9IDE7CiAgICB9CgogICAgcmV0dXJuIG1hdGNoZXM7Cn0KCi8vIEtNUCBwYXR0ZXJuIG1hdGNoaW5nIGFsZ29yaXRobQpmbiBrbXBQYXR0ZXJuTWF0Y2hpbmcoCiAgICB0ZXh0OiAmW2kzMjsgMjAwXSwKICAgIHBhdHRlcm46ICZbaTMyOyAxMF0sCiAgICB0ZXh0X2xlbjogdXNpemUsCiAgICBwYXR0ZXJuX2xlbjogdXNpemUsCikgLT4gaTMyIHsKICAgIGxldCBtdXQgbHBzOiBbdXNpemU7IDEwXSA9IFswOyAxMF07IC8vIExvbmdlc3QgcHJvcGVyIHByZWZpeCB3aGljaCBpcyBhbHNvIHN1ZmZpeAogICAgbGV0IG11dCBtYXRjaGVzOiBpMzIgPSAwOwoKICAgIC8vIENvbXB1dGUgTFBTIGFycmF5CiAgICBjb21wdXRlTFBTQXJyYXkocGF0dGVybiwgcGF0dGVybl9sZW4sICZtdXQgbHBzKTsKCiAgICAvLyBTZWFyY2ggZm9yIHBhdHRlcm4KICAgIGxldCBtdXQgaTogdXNpemUgPSAwOyAvLyBJbmRleCBmb3IgdGV4dAogICAgbGV0IG11dCBqOiB1c2l6ZSA9IDA7IC8vIEluZGV4IGZvciBwYXR0ZXJuCgogICAgd2hpbGUgKGkgPCB0ZXh0X2xlbikgewogICAgICAgIGlmIChwYXR0ZXJuW2pdID09IHRleHRbaV0pIHsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgICAgICBqICs9IDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoaiA9PSBwYXR0ZXJuX2xlbikgewogICAgICAgICAgICBtYXRjaGVzICs9IDE7CiAgICAgICAgICAgIGogPSBscHNbaiAtIDFdOwogICAgICAgIH0gZWxzZSBpZiAoaSA8IHRleHRfbGVuICYmIHBhdHRlcm5bal0gIT0gdGV4dFtpXSkgewogICAgICAgICAgICBpZiAoaiAhPSAwKSB7CiAgICAgICAgICAgICAgICBqID0gbHBzW2ogLSAxXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbWF0Y2hlczsKfQoKLy8gQ29tcHV0ZSBMUFMgYXJyYXkgZm9yIEtNUCBhbGdvcml0aG0KZm4gY29tcHV0ZUxQU0FycmF5KHBhdHRlcm46ICZbaTMyOyAxMF0sIHBhdHRlcm5fbGVuOiB1c2l6ZSwgbHBzOiAmbXV0IFt1c2l6ZTsgMTBdKSB7CiAgICBsZXQgbXV0IGxlbjogdXNpemUgPSAwOyAvLyBMZW5ndGggb2YgcHJldmlvdXMgbG9uZ2VzdCBwcmVmaXggc3VmZml4CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMTsKCiAgICBscHNbMF0gPSAwOyAvLyBMUFNbMF0gaXMgYWx3YXlzIDAKCiAgICB3aGlsZSAoaSA8IHBhdHRlcm5fbGVuKSB7CiAgICAgICAgaWYgKHBhdHRlcm5baV0gPT0gcGF0dGVybltsZW5dKSB7CiAgICAgICAgICAgIGxlbiArPSAxOwogICAgICAgICAgICBscHNbaV0gPSBsZW47CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAobGVuICE9IDApIHsKICAgICAgICAgICAgICAgIGxlbiA9IGxwc1tsZW4gLSAxXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxwc1tpXSA9IDA7CiAgICAgICAgICAgICAgICBpICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCmZuIHVwZGF0ZShzZWVkOiAmbXV0IGkzMikgewogICAgKnNlZWQgPSAoKnNlZWQgKiAxMTAzICsgNDcyMSkgJSAxMDQ4NTgzOwogICAgaWYgKCpzZWVkIDwgMCkgewogICAgICAgICpzZWVkID0gLSpzZWVkOwogICAgfQp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (3, "comprehensive3", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCAzOiBJbnRlbnNpdmUgTnVtZXJpY2FsIENvbXB1dGF0aW9ucyBhbmQgTWF0aGVtYXRpY2FsIEFsZ29yaXRobXMKU3VtbWFyeTogVGhpcyB0ZXN0IGZvY3VzZXMgb24gY29tcGlsZXIgb3B0aW1pemF0aW9uIG9mOgpEZXRhaWxzOgpJbnRlZ2VyIGFyaXRobWV0aWMgb3B0aW1pemF0aW9uIGFuZCBvdmVyZmxvdyBoYW5kbGluZwpNYXRoZW1hdGljYWwgZnVuY3Rpb24gb3B0aW1pemF0aW9uCk51bWVyaWNhbCBhbGdvcml0aG0gb3B0aW1pemF0aW9uCkxvb3AtaW50ZW5zaXZlIG1hdGhlbWF0aWNhbCBjb21wdXRhdGlvbnMKU2NpZW50aWZpYyBjb21wdXRpbmcgcGF0dGVybnMgd2l0aCBpbnRlZ2VycwpDb21wbGV4IG1hdGhlbWF0aWNhbCBleHByZXNzaW9ucwoqLwoKLy8gY29tcHJlaGVuc2l2ZTMucnggLSBDb21wcmVoZW5zaXZlIFRlc3QgMzogSW50ZW5zaXZlIE51bWVyaWNhbCBDb21wdXRhdGlvbnMgYW5kIE1hdGhlbWF0aWNhbCBBbGdvcml0aG1zCi8vIFRoaXMgdGVzdCBmb2N1c2VzIG9uIGNvbXBpbGVyIG9wdGltaXphdGlvbiBvZjoKLy8gLSBJbnRlZ2VyIGFyaXRobWV0aWMgb3B0aW1pemF0aW9uIGFuZCBvdmVyZmxvdyBoYW5kbGluZwovLyAtIE1hdGhlbWF0aWNhbCBmdW5jdGlvbiBvcHRpbWl6YXRpb24KLy8gLSBOdW1lcmljYWwgYWxnb3JpdGhtIG9wdGltaXphdGlvbgovLyAtIExvb3AtaW50ZW5zaXZlIG1hdGhlbWF0aWNhbCBjb21wdXRhdGlvbnMKLy8gLSBTY2llbnRpZmljIGNvbXB1dGluZyBwYXR0ZXJucyB3aXRoIGludGVnZXJzCi8vIC0gQ29tcGxleCBtYXRoZW1hdGljYWwgZXhwcmVzc2lvbnMKCmZuIG1haW4oKSB7CiAgICAvLyBQZXJmb3JtYW5jZSB0ZXN0IG1hcmtlciAtIHN0YXJ0CiAgICBwcmludGxuSW50KDMwMDApOwoKICAgIC8vIFRlc3QgMTogTWF0aGVtYXRpY2FsIGNvbnN0YW50cyBhbmQgc2VyaWVzIGNhbGN1bGF0aW9ucwogICAgLy8gVGVzdHMgb3B0aW1pemF0aW9uIG9mIG1hdGhlbWF0aWNhbCBzZXJpZXMgY29tcHV0YXRpb25zCiAgICBwZXJmb3JtTWF0aGVtYXRpY2FsU2VyaWVzKCk7CgogICAgLy8gVGVzdCAyOiBOdW1iZXIgdGhlb3J5IGFsZ29yaXRobXMKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBtb2R1bGFyIGFyaXRobWV0aWMgYW5kIHByaW1hbGl0eSB0ZXN0aW5nCiAgICBwZXJmb3JtTnVtYmVyVGhlb3J5QWxnb3JpdGhtcygpOwoKICAgIC8vIFRlc3QgMzogTGluZWFyIGFsZ2VicmEgd2l0aCBpbnRlZ2VyIGFyaXRobWV0aWMKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBtYXRyaXggb3BlcmF0aW9ucyBhbmQgdmVjdG9yIGNvbXB1dGF0aW9ucwogICAgcGVyZm9ybUxpbmVhckFsZ2VicmFPcGVyYXRpb25zKCk7CgogICAgLy8gVGVzdCA0OiBDb21iaW5hdG9yaWFsIGFsZ29yaXRobXMKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBmYWN0b3JpYWwsIHBlcm11dGF0aW9uLCBhbmQgY29tYmluYXRpb24gY2FsY3VsYXRpb25zCiAgICBwZXJmb3JtQ29tYmluYXRvcmlhbEFsZ29yaXRobXMoKTsKCiAgICAvLyBUZXN0IDU6IENyeXB0b2dyYXBoaWMgYWxnb3JpdGhtcwogICAgLy8gVGVzdHMgb3B0aW1pemF0aW9uIG9mIG1vZHVsYXIgZXhwb25lbnRpYXRpb24gYW5kIGxhcmdlIG51bWJlciBhcml0aG1ldGljCiAgICBwZXJmb3JtQ3J5cHRvZ3JhcGhpY09wZXJhdGlvbnMoKTsKCiAgICAvLyBQZXJmb3JtYW5jZSB0ZXN0IG1hcmtlciAtIGVuZAogICAgcHJpbnRsbkludCgzOTk5KTsKICAgIGV4aXQoMCk7Cn0KCi8vIFRlc3QgMTogTWF0aGVtYXRpY2FsIFNlcmllcyBDYWxjdWxhdGlvbnMKLy8gVGVzdHMgb3B0aW1pemF0aW9uIG9mIGl0ZXJhdGl2ZSBtYXRoZW1hdGljYWwgY29tcHV0YXRpb25zCmZuIHBlcmZvcm1NYXRoZW1hdGljYWxTZXJpZXMoKSB7CiAgICBwcmludGxuSW50KDMwMDEpOyAvLyBTdGFydCBtYXRoZW1hdGljYWwgc2VyaWVzCgogICAgLy8gQ2FsY3VsYXRlIGFwcHJveGltYXRpb24gb2YgbWF0aGVtYXRpY2FsIGNvbnN0YW50cyB1c2luZyBzZXJpZXMKICAgIGxldCBwaV9hcHByb3g6IGkzMiA9IGNhbGN1bGF0ZVBpQXBwcm94aW1hdGlvbigxMDAwKTsKICAgIHByaW50bG5JbnQocGlfYXBwcm94KTsKCiAgICAvLyBDYWxjdWxhdGUgRmlib25hY2NpIHNlcmllcyB3aXRoIGxhcmdlIG51bWJlcnMKICAgIGxldCBmaWJvbmFjY2lfc3VtOiBpMzIgPSBjYWxjdWxhdGVGaWJvbmFjY2lTdW0oNTApOwogICAgcHJpbnRsbkludChmaWJvbmFjY2lfc3VtKTsKCiAgICAvLyBDYWxjdWxhdGUgZmFjdG9yaWFsIHNlcmllcwogICAgbGV0IGZhY3RvcmlhbF9zZXJpZXM6IGkzMiA9IGNhbGN1bGF0ZUZhY3RvcmlhbFNlcmllcygyMCk7CiAgICBwcmludGxuSW50KGZhY3RvcmlhbF9zZXJpZXMpOwoKICAgIC8vIENhbGN1bGF0ZSBoYXJtb25pYyBzZXJpZXMgYXBwcm94aW1hdGlvbgogICAgbGV0IGhhcm1vbmljX2FwcHJveDogaTMyID0gY2FsY3VsYXRlSGFybW9uaWNTZXJpZXMoMTAwMDApOwogICAgcHJpbnRsbkludChoYXJtb25pY19hcHByb3gpOwoKICAgIC8vIENhbGN1bGF0ZSBnZW9tZXRyaWMgc2VyaWVzCiAgICBsZXQgZ2VvbWV0cmljX3Jlc3VsdDogaTMyID0gY2FsY3VsYXRlR2VvbWV0cmljU2VyaWVzKDEwMCwgMyk7CiAgICBwcmludGxuSW50KGdlb21ldHJpY19yZXN1bHQpOwoKICAgIHByaW50bG5JbnQoMzAwMik7IC8vIEVuZCBtYXRoZW1hdGljYWwgc2VyaWVzCn0KCi8vIENhbGN1bGF0ZSBQaSBhcHByb3hpbWF0aW9uIHVzaW5nIExlaWJuaXogc2VyaWVzCi8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBkaXZpc2lvbiBhbmQgYWx0ZXJuYXRpbmcgc2VyaWVzCmZuIGNhbGN1bGF0ZVBpQXBwcm94aW1hdGlvbih0ZXJtczogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGRlbm9taW5hdG9yOiBpMzIgPSAxOwogICAgbGV0IG11dCBzaWduOiBpMzIgPSAxOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDwgdGVybXMpIHsKICAgICAgICAvLyBQaS80ID0gMSAtIDEvMyArIDEvNSAtIDEvNyArIDEvOSAtIC4uLgogICAgICAgIC8vIFVzaW5nIGludGVnZXIgYXJpdGhtZXRpYzogbXVsdGlwbHkgYnkgMTAwMDAgZm9yIHByZWNpc2lvbgogICAgICAgIGxldCB0ZXJtOiBpMzIgPSAoc2lnbiAqIDEwMDAwKSAvIGRlbm9taW5hdG9yOwogICAgICAgIHN1bSArPSB0ZXJtOwoKICAgICAgICBzaWduID0gLXNpZ247CiAgICAgICAgZGVub21pbmF0b3IgKz0gMjsKICAgICAgICBpICs9IDE7CiAgICB9CgogICAgLy8gUmV0dXJuIFBpIGFwcHJveGltYXRpb24gKiAxMDAwMAogICAgcmV0dXJuIChzdW0gKiA0KSAlIDEwMDAwMDsKfQoKLy8gQ2FsY3VsYXRlIHN1bSBvZiBGaWJvbmFjY2kgbnVtYmVycyB3aXRoIG9wdGltaXplZCBpdGVyYXRpb24KZm4gY2FsY3VsYXRlRmlib25hY2NpU3VtKGNvdW50OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIGxldCBtdXQgcHJldjogaTMyID0gMDsKICAgIGxldCBtdXQgY3VycjogaTMyID0gMTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICB3aGlsZSAoaSA8IGNvdW50KSB7CiAgICAgICAgc3VtICs9IGN1cnI7CgogICAgICAgIC8vIFByZXZlbnQgb3ZlcmZsb3cgYnkgdGFraW5nIG1vZHVsbwogICAgICAgIHN1bSA9IHN1bSAlIDEwMDAwMDA7CgogICAgICAgIGxldCB0ZW1wOiBpMzIgPSBjdXJyOwogICAgICAgIGN1cnIgPSAocHJldiArIGN1cnIpICUgMTAwMDAwMDsKICAgICAgICBwcmV2ID0gdGVtcDsKCiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIHJldHVybiBzdW0gJSAxMDAwMDsKfQoKLy8gQ2FsY3VsYXRlIHNlcmllcyBvZiBmYWN0b3JpYWxzCmZuIGNhbGN1bGF0ZUZhY3RvcmlhbFNlcmllcyhtYXhfbjogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBzZXJpZXNfc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBmYWN0b3JpYWw6IGkzMiA9IDE7CiAgICBsZXQgbXV0IG46IGkzMiA9IDE7CgogICAgd2hpbGUgKG4gPD0gbWF4X24pIHsKICAgICAgICBmYWN0b3JpYWwgPSAoZmFjdG9yaWFsICogbikgJSAxMDAwMDAwOyAvLyBQcmV2ZW50IG92ZXJmbG93CiAgICAgICAgc2VyaWVzX3N1bSA9IChzZXJpZXNfc3VtICsgZmFjdG9yaWFsKSAlIDEwMDAwMDA7CiAgICAgICAgbiArPSAxOwogICAgfQoKICAgIHJldHVybiBzZXJpZXNfc3VtICUgMTAwMDA7Cn0KCi8vIENhbGN1bGF0ZSBoYXJtb25pYyBzZXJpZXMgYXBwcm94aW1hdGlvbiBIX24gPSAxICsgMS8yICsgMS8zICsgLi4uICsgMS9uCmZuIGNhbGN1bGF0ZUhhcm1vbmljU2VyaWVzKHRlcm1zOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMTsKCiAgICB3aGlsZSAoaSA8PSB0ZXJtcykgewogICAgICAgIC8vIFVzZSBpbnRlZ2VyIGFyaXRobWV0aWM6IG11bHRpcGx5IGJ5IDEwMDAwIGZvciBwcmVjaXNpb24KICAgICAgICBzdW0gKz0gMTAwMDAgLyBpOwogICAgICAgIGkgKz0gMTsKICAgIH0KCiAgICByZXR1cm4gc3VtICUgMTAwMDA7Cn0KCi8vIENhbGN1bGF0ZSBnZW9tZXRyaWMgc2VyaWVzOiBhICsgYXIgKyBhcl4yICsgLi4uICsgYXJebgpmbiBjYWxjdWxhdGVHZW9tZXRyaWNTZXJpZXModGVybXM6IGkzMiwgcmF0aW86IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBwb3dlcjogaTMyID0gMTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICB3aGlsZSAoaSA8IHRlcm1zKSB7CiAgICAgICAgc3VtID0gKHN1bSArIHBvd2VyKSAlIDEwMDAwMDA7CiAgICAgICAgcG93ZXIgPSAocG93ZXIgKiByYXRpbykgJSAxMDAwMDAwOwogICAgICAgIGkgKz0gMTsKICAgIH0KCiAgICByZXR1cm4gc3VtICUgMTAwMDA7Cn0KCi8vIFRlc3QgMjogTnVtYmVyIFRoZW9yeSBBbGdvcml0aG1zCi8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBtb2R1bGFyIGFyaXRobWV0aWMgYW5kIHByaW1lIG51bWJlciBvcGVyYXRpb25zCmZuIHBlcmZvcm1OdW1iZXJUaGVvcnlBbGdvcml0aG1zKCkgewogICAgcHJpbnRsbkludCgzMDAzKTsgLy8gU3RhcnQgbnVtYmVyIHRoZW9yeQoKICAgIC8vIFByaW1lIG51bWJlciBnZW5lcmF0aW9uIGFuZCB0ZXN0aW5nCiAgICBsZXQgcHJpbWVfY291bnQ6IGkzMiA9IHNpZXZlT2ZFcmF0b3N0aGVuZXMoMjAwMCk7CiAgICBwcmludGxuSW50KHByaW1lX2NvdW50KTsKCiAgICAvLyBHcmVhdGVzdCBjb21tb24gZGl2aXNvciBjYWxjdWxhdGlvbnMKICAgIGxldCBnY2RfcmVzdWx0czogaTMyID0gcGVyZm9ybUdDRE9wZXJhdGlvbnMoMTAwKTsKICAgIHByaW50bG5JbnQoZ2NkX3Jlc3VsdHMpOwoKICAgIC8vIE1vZHVsYXIgZXhwb25lbnRpYXRpb24gdGVzdHMKICAgIGxldCBtb2RleHBfcmVzdWx0czogaTMyID0gcGVyZm9ybU1vZHVsYXJFeHBvbmVudGlhdGlvbigpOwogICAgcHJpbnRsbkludChtb2RleHBfcmVzdWx0cyk7CgogICAgLy8gRXVsZXIncyB0b3RpZW50IGZ1bmN0aW9uIGNhbGN1bGF0aW9ucwogICAgbGV0IHRvdGllbnRfc3VtOiBpMzIgPSBjYWxjdWxhdGVUb3RpZW50U3VtKDEwMCk7CiAgICBwcmludGxuSW50KHRvdGllbnRfc3VtKTsKCiAgICAvLyBQZXJmZWN0IG51bWJlciBkZXRlY3Rpb24KICAgIGxldCBwZXJmZWN0X2NvdW50OiBpMzIgPSBmaW5kUGVyZmVjdE51bWJlcnMoMTAwMCk7CiAgICBwcmludGxuSW50KHBlcmZlY3RfY291bnQpOwoKICAgIHByaW50bG5JbnQoMzAwNCk7IC8vIEVuZCBudW1iZXIgdGhlb3J5Cn0KCi8vIFNpZXZlIG9mIEVyYXRvc3RoZW5lcyBmb3IgcHJpbWUgZ2VuZXJhdGlvbgpmbiBzaWV2ZU9mRXJhdG9zdGhlbmVzKGxpbWl0OiB1c2l6ZSkgLT4gaTMyIHsKICAgIGxldCBtdXQgaXNfcHJpbWU6IFtpMzI7IDIwMDBdID0gWzA7IDIwMDBdOwogICAgbGV0IG11dCBwcmltZV9jb3VudDogaTMyID0gMDsKCiAgICAvLyBJbml0aWFsaXplIGFsbCBudW1iZXJzIGFzIHByaW1lCiAgICBsZXQgbXV0IGk6IHVzaXplID0gMjsKICAgIHdoaWxlIChpIDwgbGltaXQpIHsKICAgICAgICBpc19wcmltZVtpXSA9IDE7CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIC8vIFNpZXZlIHByb2Nlc3MKICAgIGkgPSAyOwogICAgd2hpbGUgKGkgKiBpIDwgbGltaXQpIHsKICAgICAgICBpZiAoaXNfcHJpbWVbaV0gPT0gMSkgewogICAgICAgICAgICAvLyBNYXJrIG11bHRpcGxlcyBhcyBub3QgcHJpbWUKICAgICAgICAgICAgbGV0IG11dCBqOiB1c2l6ZSA9IGkgKiBpOwogICAgICAgICAgICB3aGlsZSAoaiA8IGxpbWl0KSB7CiAgICAgICAgICAgICAgICBpc19wcmltZVtqXSA9IDA7CiAgICAgICAgICAgICAgICBqICs9IGk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIC8vIENvdW50IHByaW1lcwogICAgaSA9IDI7CiAgICB3aGlsZSAoaSA8IGxpbWl0KSB7CiAgICAgICAgaWYgKGlzX3ByaW1lW2ldID09IDEpIHsKICAgICAgICAgICAgcHJpbWVfY291bnQgKz0gMTsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIHJldHVybiBwcmltZV9jb3VudDsKfQoKLy8gUGVyZm9ybSBtdWx0aXBsZSBHQ0Qgb3BlcmF0aW9ucyB1c2luZyBkaWZmZXJlbnQgYWxnb3JpdGhtcwpmbiBwZXJmb3JtR0NET3BlcmF0aW9ucyhsaW1pdDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBnY2Rfc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAxOwoKICAgIHdoaWxlIChpIDw9IGxpbWl0KSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAxOwogICAgICAgIHdoaWxlIChqIDw9IGxpbWl0KSB7CiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSBHQ0QgdXNpbmcgRXVjbGlkZWFuIGFsZ29yaXRobQogICAgICAgICAgICBnY2Rfc3VtICs9IGV1Y2xpZGVhbkdDRChpICogMTMgKyA3LCBqICogMTcgKyAxMSk7CgogICAgICAgICAgICAvLyBDYWxjdWxhdGUgR0NEIHVzaW5nIFN0ZWluJ3MgYWxnb3JpdGhtIChiaW5hcnkgR0NEKQogICAgICAgICAgICBnY2Rfc3VtICs9IGJpbmFyeUdDRChpICogMTkgKyAzLCBqICogMjMgKyA1KTsKCiAgICAgICAgICAgIGogKz0gMTA7IC8vIFNraXAgc29tZSBpdGVyYXRpb25zIGZvciBwZXJmb3JtYW5jZQogICAgICAgIH0KICAgICAgICBpICs9IDEwOwogICAgfQoKICAgIHJldHVybiBnY2Rfc3VtICUgMTAwMDA7Cn0KCi8vIEV1Y2xpZGVhbiBHQ0QgYWxnb3JpdGhtCmZuIGV1Y2xpZGVhbkdDRChhOiBpMzIsIGI6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgeDogaTMyID0gYTsKICAgIGxldCBtdXQgeTogaTMyID0gYjsKCiAgICB3aGlsZSAoeSAhPSAwKSB7CiAgICAgICAgbGV0IHRlbXA6IGkzMiA9IHk7CiAgICAgICAgeSA9IHggJSB5OwogICAgICAgIHggPSB0ZW1wOwogICAgfQoKICAgIHJldHVybiB4Owp9CgovLyBCaW5hcnkgR0NEIGFsZ29yaXRobSAoU3RlaW4ncyBhbGdvcml0aG0pCmZuIGJpbmFyeUdDRChhOiBpMzIsIGI6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgeDogaTMyID0gYTsKICAgIGxldCBtdXQgeTogaTMyID0gYjsKICAgIGxldCBtdXQgc2hpZnQ6IGkzMiA9IDA7CgogICAgaWYgKHggPT0gMCkgewogICAgICAgIHJldHVybiB5OwogICAgfQogICAgaWYgKHkgPT0gMCkgewogICAgICAgIHJldHVybiB4OwogICAgfQoKICAgIC8vIEZhY3RvciBvdXQgY29tbW9uIHBvd2VycyBvZiAyCiAgICB3aGlsZSAoKCh4IHwgeSkgJiAxKSA9PSAwKSB7CiAgICAgICAgc2hpZnQgKz0gMTsKICAgICAgICB4ID4+PSAxOwogICAgICAgIHkgPj49IDE7CiAgICB9CgogICAgLy8gUmVtb3ZlIGZhY3RvcnMgb2YgMiBmcm9tIHgKICAgIHdoaWxlICgoeCAmIDEpID09IDApIHsKICAgICAgICB4ID4+PSAxOwogICAgfQoKICAgIHdoaWxlICh5ICE9IDApIHsKICAgICAgICAvLyBSZW1vdmUgZmFjdG9ycyBvZiAyIGZyb20geQogICAgICAgIHdoaWxlICgoeSAmIDEpID09IDApIHsKICAgICAgICAgICAgeSA+Pj0gMTsKICAgICAgICB9CgogICAgICAgIC8vIEVuc3VyZSB4IDw9IHkKICAgICAgICBpZiAoeCA+IHkpIHsKICAgICAgICAgICAgbGV0IHRlbXA6IGkzMiA9IHg7CiAgICAgICAgICAgIHggPSB5OwogICAgICAgICAgICB5ID0gdGVtcDsKICAgICAgICB9CgogICAgICAgIHkgPSB5IC0geDsKICAgIH0KCiAgICByZXR1cm4geCA8PCBzaGlmdDsKfQoKLy8gTW9kdWxhciBleHBvbmVudGlhdGlvbiBvcGVyYXRpb25zCmZuIHBlcmZvcm1Nb2R1bGFyRXhwb25lbnRpYXRpb24oKSAtPiBpMzIgewogICAgbGV0IG11dCByZXN1bHRfc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBiYXNlOiBpMzIgPSAyOwoKICAgIHdoaWxlIChiYXNlIDw9IDEwKSB7CiAgICAgICAgbGV0IG11dCBleHBvbmVudDogaTMyID0gMTsKICAgICAgICB3aGlsZSAoZXhwb25lbnQgPD0gMjApIHsKICAgICAgICAgICAgbGV0IG11dCBtb2R1bHVzOiBpMzIgPSA5NzsgLy8gVXNlIHByaW1lIG1vZHVsdXMKICAgICAgICAgICAgbGV0IG1vZF9yZXN1bHQ6IGkzMiA9IG1vZHVsYXJQb3dlcihiYXNlLCBleHBvbmVudCwgbW9kdWx1cyk7CiAgICAgICAgICAgIHJlc3VsdF9zdW0gPSAocmVzdWx0X3N1bSArIG1vZF9yZXN1bHQpICUgMTAwMDA7CgogICAgICAgICAgICBleHBvbmVudCArPSAxOwogICAgICAgIH0KICAgICAgICBiYXNlICs9IDE7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdF9zdW07Cn0KCi8vIEZhc3QgbW9kdWxhciBleHBvbmVudGlhdGlvbiB1c2luZyBiaW5hcnkgbWV0aG9kCmZuIG1vZHVsYXJQb3dlcihiYXNlOiBpMzIsIGV4cG9uZW50OiBpMzIsIG1vZHVsdXM6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgcmVzdWx0OiBpMzIgPSAxOwogICAgbGV0IG11dCBjdXJyZW50X2Jhc2U6IGkzMiA9IGJhc2UgJSBtb2R1bHVzOwogICAgbGV0IG11dCBjdXJyZW50X2V4cDogaTMyID0gZXhwb25lbnQ7CgogICAgd2hpbGUgKGN1cnJlbnRfZXhwID4gMCkgewogICAgICAgIGlmIChjdXJyZW50X2V4cCAlIDIgPT0gMSkgewogICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0ICogY3VycmVudF9iYXNlKSAlIG1vZHVsdXM7CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50X2V4cCA+Pj0gMTsKICAgICAgICBjdXJyZW50X2Jhc2UgPSAoY3VycmVudF9iYXNlICogY3VycmVudF9iYXNlKSAlIG1vZHVsdXM7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKfQoKLy8gQ2FsY3VsYXRlIEV1bGVyJ3MgdG90aWVudCBmdW5jdGlvbiBmb3IgbnVtYmVycyAxIHRvIG4KZm4gY2FsY3VsYXRlVG90aWVudFN1bShuOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHRvdGllbnRfc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAxOwoKICAgIHdoaWxlIChpIDw9IG4pIHsKICAgICAgICB0b3RpZW50X3N1bSArPSBldWxlclRvdGllbnQoaSk7CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIHJldHVybiB0b3RpZW50X3N1bSAlIDEwMDAwOwp9CgovLyBFdWxlcidzIHRvdGllbnQgZnVuY3Rpb24gz4YobikKZm4gZXVsZXJUb3RpZW50KG46IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgcmVzdWx0OiBpMzIgPSBuOwogICAgbGV0IG11dCBudW06IGkzMiA9IG47CiAgICBsZXQgbXV0IHA6IGkzMiA9IDI7CgogICAgLy8gQ2hlY2sgZm9yIGZhY3RvciAyCiAgICBpZiAobnVtICUgMiA9PSAwKSB7CiAgICAgICAgd2hpbGUgKG51bSAlIDIgPT0gMCkgewogICAgICAgICAgICBudW0gLz0gMjsKICAgICAgICB9CiAgICAgICAgcmVzdWx0IC09IHJlc3VsdCAvIDI7CiAgICB9CgogICAgLy8gQ2hlY2sgZm9yIG9kZCBmYWN0b3JzCiAgICBwID0gMzsKICAgIHdoaWxlIChwICogcCA8PSBudW0pIHsKICAgICAgICBpZiAobnVtICUgcCA9PSAwKSB7CiAgICAgICAgICAgIHdoaWxlIChudW0gJSBwID09IDApIHsKICAgICAgICAgICAgICAgIG51bSAvPSBwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlc3VsdCAtPSByZXN1bHQgLyBwOwogICAgICAgIH0KICAgICAgICBwICs9IDI7CiAgICB9CgogICAgLy8gSWYgbnVtIGlzIHN0aWxsIGdyZWF0ZXIgdGhhbiAxLCB0aGVuIGl0J3MgYSBwcmltZQogICAgaWYgKG51bSA+IDEpIHsKICAgICAgICByZXN1bHQgLT0gcmVzdWx0IC8gbnVtOwogICAgfQoKICAgIHJldHVybiByZXN1bHQ7Cn0KCi8vIEZpbmQgcGVyZmVjdCBudW1iZXJzIHVwIHRvIGxpbWl0CmZuIGZpbmRQZXJmZWN0TnVtYmVycyhsaW1pdDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBwZXJmZWN0X2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBudW06IGkzMiA9IDY7IC8vIEZpcnN0IHBlcmZlY3QgbnVtYmVyCgogICAgd2hpbGUgKG51bSA8PSBsaW1pdCkgewogICAgICAgIGlmIChpc1BlcmZlY3ROdW1iZXIobnVtKSA9PSAxKSB7CiAgICAgICAgICAgIHBlcmZlY3RfY291bnQgKz0gMTsKICAgICAgICB9CiAgICAgICAgbnVtICs9IDE7CiAgICB9CgogICAgcmV0dXJuIHBlcmZlY3RfY291bnQ7Cn0KCi8vIENoZWNrIGlmIG51bWJlciBpcyBwZXJmZWN0IChzdW0gb2YgcHJvcGVyIGRpdmlzb3JzIGVxdWFscyB0aGUgbnVtYmVyKQpmbiBpc1BlcmZlY3ROdW1iZXIobjogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBkaXZpc29yX3N1bTogaTMyID0gMTsgLy8gMSBpcyBhbHdheXMgYSBwcm9wZXIgZGl2aXNvcgogICAgbGV0IG11dCBpOiBpMzIgPSAyOwoKICAgIHdoaWxlIChpICogaSA8PSBuKSB7CiAgICAgICAgaWYgKG4gJSBpID09IDApIHsKICAgICAgICAgICAgZGl2aXNvcl9zdW0gKz0gaTsKICAgICAgICAgICAgaWYgKGkgIT0gbiAvIGkpIHsKICAgICAgICAgICAgICAgIGRpdmlzb3Jfc3VtICs9IG4gLyBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgKz0gMTsKICAgIH0KCiAgICByZXR1cm4gKGRpdmlzb3Jfc3VtID09IG4pIGFzIGkzMjsKfQoKLy8gVGVzdCAzOiBMaW5lYXIgQWxnZWJyYSBPcGVyYXRpb25zIHdpdGggSW50ZWdlciBBcml0aG1ldGljCi8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBtYXRyaXggYW5kIHZlY3RvciBvcGVyYXRpb25zCmZuIHBlcmZvcm1MaW5lYXJBbGdlYnJhT3BlcmF0aW9ucygpIHsKICAgIHByaW50bG5JbnQoMzAwNSk7IC8vIFN0YXJ0IGxpbmVhciBhbGdlYnJhCgogICAgLy8gTWF0cml4IG9wZXJhdGlvbnMKICAgIGxldCBtYXRyaXhfcmVzdWx0OiBpMzIgPSBwZXJmb3JtTWF0cml4Q2FsY3VsYXRpb25zKCk7CiAgICBwcmludGxuSW50KG1hdHJpeF9yZXN1bHQpOwoKICAgIC8vIFZlY3RvciBvcGVyYXRpb25zCiAgICBsZXQgdmVjdG9yX3Jlc3VsdDogaTMyID0gcGVyZm9ybVZlY3RvckNhbGN1bGF0aW9ucygpOwogICAgcHJpbnRsbkludCh2ZWN0b3JfcmVzdWx0KTsKCiAgICAvLyBTeXN0ZW0gb2YgbGluZWFyIGVxdWF0aW9ucyAodXNpbmcgaW50ZWdlciBhcml0aG1ldGljKQogICAgbGV0IGVxdWF0aW9uX3Jlc3VsdDogaTMyID0gc29sdmVMaW5lYXJTeXN0ZW0oKTsKICAgIHByaW50bG5JbnQoZXF1YXRpb25fcmVzdWx0KTsKCiAgICBwcmludGxuSW50KDMwMDYpOyAvLyBFbmQgbGluZWFyIGFsZ2VicmEKfQoKLy8gQ29tcHJlaGVuc2l2ZSBtYXRyaXggY2FsY3VsYXRpb25zCmZuIHBlcmZvcm1NYXRyaXhDYWxjdWxhdGlvbnMoKSAtPiBpMzIgewogICAgbGV0IHNpemU6IHVzaXplID0gMjU7CiAgICBsZXQgbXV0IG1hdHJpeF9hOiBbaTMyOyA2MjVdID0gWzA7IDYyNV07IC8vIDI1eDI1CiAgICBsZXQgbXV0IG1hdHJpeF9iOiBbaTMyOyA2MjVdID0gWzA7IDYyNV07IC8vIDI1eDI1CiAgICBsZXQgbXV0IHJlc3VsdF9tYXRyaXg6IFtpMzI7IDYyNV0gPSBbMDsgNjI1XTsgLy8gMjV4MjUKCiAgICAvLyBJbml0aWFsaXplIG1hdHJpY2VzCiAgICBpbml0aWFsaXplTWF0cml4QSgmbXV0IG1hdHJpeF9hLCBzaXplKTsKICAgIGluaXRpYWxpemVNYXRyaXhCKCZtdXQgbWF0cml4X2IsIHNpemUpOwoKICAgIC8vIE1hdHJpeCBtdWx0aXBsaWNhdGlvbgogICAgbXVsdGlwbHlNYXRyaWNlcygmbWF0cml4X2EsICZtYXRyaXhfYiwgJm11dCByZXN1bHRfbWF0cml4LCBzaXplKTsKCiAgICAvLyBDYWxjdWxhdGUgbWF0cml4IHRyYWNlCiAgICBsZXQgdHJhY2U6IGkzMiA9IGNhbGN1bGF0ZU1hdHJpeFRyYWNlKCZyZXN1bHRfbWF0cml4LCBzaXplKTsKCiAgICAvLyBDYWxjdWxhdGUgbWF0cml4IGRldGVybWluYW50ICh1c2luZyBjb2ZhY3RvciBleHBhbnNpb24gZm9yIHNtYWxsIHN1Ym1hdHJpeCkKICAgIGxldCBtdXQgc21hbGxfbWF0cml4OiBbaTMyOyAxNl0gPSBbMDsgMTZdOyAvLyA0eDQgc3VibWF0cml4CiAgICBleHRyYWN0U3VibWF0cml4KCZyZXN1bHRfbWF0cml4LCAmbXV0IHNtYWxsX21hdHJpeCwgc2l6ZSwgNCk7CiAgICBsZXQgZGV0ZXJtaW5hbnQ6IGkzMiA9IGNhbGN1bGF0ZURldGVybWluYW50NHg0KHNtYWxsX21hdHJpeCk7CgogICAgcmV0dXJuICh0cmFjZSArIGRldGVybWluYW50KSAlIDEwMDAwOwp9CgovLyBJbml0aWFsaXplIG1hdHJpeCBBIHdpdGggc3BlY2lmaWMgcGF0dGVybgpmbiBpbml0aWFsaXplTWF0cml4QShtYXRyaXg6ICZtdXQgW2kzMjsgNjI1XSwgc2l6ZTogdXNpemUpIHsKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgbGV0IG11dCBqOiB1c2l6ZSA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgIG1hdHJpeFtpICogc2l6ZSArIGpdID0gKGkgKyBqICsgMSkgYXMgaTMyICUgMTA7CiAgICAgICAgICAgIGogKz0gMTsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQp9CgovLyBJbml0aWFsaXplIG1hdHJpeCBCIHdpdGggZGlmZmVyZW50IHBhdHRlcm4KZm4gaW5pdGlhbGl6ZU1hdHJpeEIobWF0cml4OiAmbXV0IFtpMzI7IDYyNV0sIHNpemU6IHVzaXplKSB7CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGxldCBtdXQgajogdXNpemUgPSAwOwogICAgICAgIHdoaWxlIChqIDwgc2l6ZSkgewogICAgICAgICAgICBtYXRyaXhbaSAqIHNpemUgKyBqXSA9IChpICogaiArIDEpIGFzIGkzMiAlIDEwOwogICAgICAgICAgICBqICs9IDE7CiAgICAgICAgfQogICAgICAgIGkgKz0gMTsKICAgIH0KfQoKLy8gTWF0cml4IG11bHRpcGxpY2F0aW9uIG9wdGltaXplZCBmb3IgY2FjaGUgbG9jYWxpdHkKZm4gbXVsdGlwbHlNYXRyaWNlcyhhOiAmW2kzMjsgNjI1XSwgYjogJltpMzI7IDYyNV0sIHJlc3VsdDogJm11dCBbaTMyOyA2MjVdLCBzaXplOiB1c2l6ZSkgewogICAgLy8gSW5pdGlhbGl6ZSByZXN1bHQgbWF0cml4CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGxldCBtdXQgajogdXNpemUgPSAwOwogICAgICAgIHdoaWxlIChqIDwgc2l6ZSkgewogICAgICAgICAgICByZXN1bHRbaSAqIHNpemUgKyBqXSA9IDA7CiAgICAgICAgICAgIGogKz0gMTsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIC8vIEJsb2NrZWQgbWF0cml4IG11bHRpcGxpY2F0aW9uIGZvciBiZXR0ZXIgY2FjaGUgcGVyZm9ybWFuY2UKICAgIGxldCBibG9ja19zaXplOiB1c2l6ZSA9IDU7CiAgICBsZXQgbXV0IGlfYmxvY2s6IHVzaXplID0gMDsKCiAgICB3aGlsZSAoaV9ibG9jayA8IHNpemUpIHsKICAgICAgICBsZXQgbXV0IGpfYmxvY2s6IHVzaXplID0gMDsKICAgICAgICB3aGlsZSAoal9ibG9jayA8IHNpemUpIHsKICAgICAgICAgICAgbGV0IG11dCBrX2Jsb2NrOiB1c2l6ZSA9IDA7CiAgICAgICAgICAgIHdoaWxlIChrX2Jsb2NrIDwgc2l6ZSkgewogICAgICAgICAgICAgICAgLy8gUHJvY2VzcyBibG9jawogICAgICAgICAgICAgICAgaSA9IGlfYmxvY2s7CiAgICAgICAgICAgICAgICBsZXQgbXV0IGlfZW5kOiB1c2l6ZSA9IGlfYmxvY2sgKyBibG9ja19zaXplOwogICAgICAgICAgICAgICAgaWYgKGlfZW5kID4gc2l6ZSkgewogICAgICAgICAgICAgICAgICAgIGlfZW5kID0gc2l6ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB3aGlsZSAoaSA8IGlfZW5kKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IG11dCBqOiB1c2l6ZSA9IGpfYmxvY2s7CiAgICAgICAgICAgICAgICAgICAgbGV0IG11dCBqX2VuZDogdXNpemUgPSBqX2Jsb2NrICsgYmxvY2tfc2l6ZTsKICAgICAgICAgICAgICAgICAgICBpZiAoal9lbmQgPiBzaXplKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGpfZW5kID0gc2l6ZTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHdoaWxlIChqIDwgal9lbmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG11dCBrOiB1c2l6ZSA9IGtfYmxvY2s7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtdXQga19lbmQ6IHVzaXplID0ga19ibG9jayArIGJsb2NrX3NpemU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrX2VuZCA+IHNpemUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtfZW5kID0gc2l6ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGsgPCBrX2VuZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2kgKiBzaXplICsgal0gKz0gYVtpICogc2l6ZSArIGtdICogYltrICogc2l6ZSArIGpdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgayArPSAxOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGogKz0gMTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaSArPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAga19ibG9jayArPSBibG9ja19zaXplOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGpfYmxvY2sgKz0gYmxvY2tfc2l6ZTsKICAgICAgICB9CiAgICAgICAgaV9ibG9jayArPSBibG9ja19zaXplOwogICAgfQp9CgovLyBDYWxjdWxhdGUgbWF0cml4IHRyYWNlIChzdW0gb2YgZGlhZ29uYWwgZWxlbWVudHMpCmZuIGNhbGN1bGF0ZU1hdHJpeFRyYWNlKG1hdHJpeDogJltpMzI7IDYyNV0sIHNpemU6IHVzaXplKSAtPiBpMzIgewogICAgbGV0IG11dCB0cmFjZTogaTMyID0gMDsKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwoKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIHRyYWNlICs9IG1hdHJpeFtpICogc2l6ZSArIGldOwogICAgICAgIGkgKz0gMTsKICAgIH0KCiAgICByZXR1cm4gdHJhY2U7Cn0KCi8vIEV4dHJhY3Qgc3VibWF0cml4IGZvciBkZXRlcm1pbmFudCBjYWxjdWxhdGlvbgpmbiBleHRyYWN0U3VibWF0cml4KAogICAgc291cmNlOiAmW2kzMjsgNjI1XSwKICAgIGRlc3Q6ICZtdXQgW2kzMjsgMTZdLAogICAgc291cmNlX3NpemU6IHVzaXplLAogICAgZGVzdF9zaXplOiB1c2l6ZSwKKSB7CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgIHdoaWxlIChpIDwgZGVzdF9zaXplKSB7CiAgICAgICAgbGV0IG11dCBqOiB1c2l6ZSA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBkZXN0X3NpemUpIHsKICAgICAgICAgICAgZGVzdFtpICogZGVzdF9zaXplICsgal0gPSBzb3VyY2VbaSAqIHNvdXJjZV9zaXplICsgal07CiAgICAgICAgICAgIGogKz0gMTsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQp9CgovLyBDYWxjdWxhdGUgZGV0ZXJtaW5hbnQgb2YgNHg0IG1hdHJpeCB1c2luZyBjb2ZhY3RvciBleHBhbnNpb24KZm4gY2FsY3VsYXRlRGV0ZXJtaW5hbnQ0eDQobWF0cml4OiBbaTMyOyAxNl0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IGRldGVybWluYW50OiBpMzIgPSAwOwoKICAgIC8vIEZpcnN0IHJvdyBleHBhbnNpb24KICAgIGxldCBtdXQgY29sOiB1c2l6ZSA9IDA7CiAgICB3aGlsZSAoY29sIDwgNCkgewogICAgICAgIGxldCBtdXQgbWlub3I6IFtpMzI7IDldID0gWzA7IDldOyAvLyAzeDMgbWlub3IKCiAgICAgICAgLy8gQ3JlYXRlIDN4MyBtaW5vciBtYXRyaXgKICAgICAgICBsZXQgbXV0IG1pbm9yX2k6IHVzaXplID0gMDsKICAgICAgICBsZXQgbXV0IGk6IHVzaXplID0gMTsgLy8gU2tpcCBmaXJzdCByb3cKICAgICAgICB3aGlsZSAoaSA8IDQpIHsKICAgICAgICAgICAgbGV0IG11dCBtaW5vcl9qOiB1c2l6ZSA9IDA7CiAgICAgICAgICAgIGxldCBtdXQgajogdXNpemUgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IDQpIHsKICAgICAgICAgICAgICAgIGlmIChqICE9IGNvbCkgewogICAgICAgICAgICAgICAgICAgIG1pbm9yW21pbm9yX2kgKiAzICsgbWlub3Jfal0gPSBtYXRyaXhbaSAqIDQgKyBqXTsKICAgICAgICAgICAgICAgICAgICBtaW5vcl9qICs9IDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbWlub3JfaSArPSAxOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBDYWxjdWxhdGUgM3gzIGRldGVybWluYW50CiAgICAgICAgbGV0IG1pbm9yX2RldDogaTMyID0gY2FsY3VsYXRlRGV0ZXJtaW5hbnQzeDMobWlub3IpOwoKICAgICAgICAvLyBBZGQgdG8gdG90YWwgd2l0aCBhcHByb3ByaWF0ZSBzaWduCiAgICAgICAgaWYgKGNvbCAlIDIgPT0gMCkgewogICAgICAgICAgICBkZXRlcm1pbmFudCArPSBtYXRyaXhbY29sXSAqIG1pbm9yX2RldDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkZXRlcm1pbmFudCAtPSBtYXRyaXhbY29sXSAqIG1pbm9yX2RldDsKICAgICAgICB9CgogICAgICAgIGNvbCArPSAxOwogICAgfQoKICAgIHJldHVybiBkZXRlcm1pbmFudDsKfQoKLy8gQ2FsY3VsYXRlIGRldGVybWluYW50IG9mIDN4MyBtYXRyaXgKZm4gY2FsY3VsYXRlRGV0ZXJtaW5hbnQzeDMobWF0cml4OiBbaTMyOyA5XSkgLT4gaTMyIHsKICAgIGxldCBhOiBpMzIgPSBtYXRyaXhbMF0gKiAobWF0cml4WzRdICogbWF0cml4WzhdIC0gbWF0cml4WzVdICogbWF0cml4WzddKTsKICAgIGxldCBiOiBpMzIgPSBtYXRyaXhbMV0gKiAobWF0cml4WzNdICogbWF0cml4WzhdIC0gbWF0cml4WzVdICogbWF0cml4WzZdKTsKICAgIGxldCBjOiBpMzIgPSBtYXRyaXhbMl0gKiAobWF0cml4WzNdICogbWF0cml4WzddIC0gbWF0cml4WzRdICogbWF0cml4WzZdKTsKCiAgICByZXR1cm4gYSAtIGIgKyBjOwp9CgovLyBWZWN0b3Igb3BlcmF0aW9ucwpmbiBwZXJmb3JtVmVjdG9yQ2FsY3VsYXRpb25zKCkgLT4gaTMyIHsKICAgIGxldCBzaXplOiB1c2l6ZSA9IDEwMDsKICAgIGxldCBtdXQgdmVjdG9yX2E6IFtpMzI7IDEwMF0gPSBbMDsgMTAwXTsKICAgIGxldCBtdXQgdmVjdG9yX2I6IFtpMzI7IDEwMF0gPSBbMDsgMTAwXTsKICAgIGxldCBtdXQgcmVzdWx0X3ZlY3RvcjogW2kzMjsgMTAwXSA9IFswOyAxMDBdOwoKICAgIC8vIEluaXRpYWxpemUgdmVjdG9ycwogICAgaW5pdGlhbGl6ZVZlY3RvcnMoJm11dCB2ZWN0b3JfYSwgJm11dCB2ZWN0b3JfYiwgc2l6ZSk7CgogICAgLy8gVmVjdG9yIGRvdCBwcm9kdWN0CiAgICBsZXQgZG90X3Byb2R1Y3Q6IGkzMiA9IHZlY3RvckRvdFByb2R1Y3QoJnZlY3Rvcl9hLCAmdmVjdG9yX2IsIHNpemUpOwoKICAgIC8vIFZlY3RvciBhZGRpdGlvbgogICAgdmVjdG9yQWRkaXRpb24oJnZlY3Rvcl9hLCAmdmVjdG9yX2IsICZtdXQgcmVzdWx0X3ZlY3Rvciwgc2l6ZSk7CgogICAgLy8gVmVjdG9yIG1hZ25pdHVkZSBjYWxjdWxhdGlvbgogICAgbGV0IG1hZ25pdHVkZV9hOiBpMzIgPSB2ZWN0b3JNYWduaXR1ZGUodmVjdG9yX2EsIHNpemUpOwogICAgbGV0IG1hZ25pdHVkZV9iOiBpMzIgPSB2ZWN0b3JNYWduaXR1ZGUodmVjdG9yX2IsIHNpemUpOwoKICAgIC8vIFZlY3RvciBzY2FsYXIgbXVsdGlwbGljYXRpb24KICAgIHZlY3RvclNjYWxhck11bHRpcGx5KCZtdXQgcmVzdWx0X3ZlY3RvciwgMywgc2l6ZSk7CgogICAgcmV0dXJuIChkb3RfcHJvZHVjdCArIG1hZ25pdHVkZV9hICsgbWFnbml0dWRlX2IpICUgMTAwMDA7Cn0KCi8vIEluaXRpYWxpemUgdmVjdG9ycyB3aXRoIHBhdHRlcm5zCmZuIGluaXRpYWxpemVWZWN0b3JzKHZlY19hOiAmbXV0IFtpMzI7IDEwMF0sIHZlY19iOiAmbXV0IFtpMzI7IDEwMF0sIHNpemU6IHVzaXplKSB7CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIHZlY19hW2ldID0gKGkgKyAxKSBhcyBpMzIgJSAyMDsKICAgICAgICB2ZWNfYltpXSA9IChpICogMiArIDMpIGFzIGkzMiAlIDE1OwogICAgICAgIGkgKz0gMTsKICAgIH0KfQoKLy8gVmVjdG9yIGRvdCBwcm9kdWN0CmZuIHZlY3RvckRvdFByb2R1Y3QodmVjX2E6ICZbaTMyOyAxMDBdLCB2ZWNfYjogJltpMzI7IDEwMF0sIHNpemU6IHVzaXplKSAtPiBpMzIgewogICAgbGV0IG11dCBkb3RfcHJvZHVjdDogaTMyID0gMDsKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwoKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGRvdF9wcm9kdWN0ICs9IHZlY19hW2ldICogdmVjX2JbaV07CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIHJldHVybiBkb3RfcHJvZHVjdCAlIDEwMDAwOwp9CgovLyBWZWN0b3IgYWRkaXRpb24KZm4gdmVjdG9yQWRkaXRpb24odmVjX2E6ICZbaTMyOyAxMDBdLCB2ZWNfYjogJltpMzI7IDEwMF0sIHJlc3VsdDogJm11dCBbaTMyOyAxMDBdLCBzaXplOiB1c2l6ZSkgewogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICByZXN1bHRbaV0gPSB2ZWNfYVtpXSArIHZlY19iW2ldOwogICAgICAgIGkgKz0gMTsKICAgIH0KfQoKLy8gVmVjdG9yIG1hZ25pdHVkZSAodXNpbmcgaW50ZWdlciBhcHByb3hpbWF0aW9uKQpmbiB2ZWN0b3JNYWduaXR1ZGUodmVjOiBbaTMyOyAxMDBdLCBzaXplOiB1c2l6ZSkgLT4gaTMyIHsKICAgIGxldCBtdXQgc3VtX29mX3NxdWFyZXM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKCiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBzdW1fb2Zfc3F1YXJlcyArPSB2ZWNbaV0gKiB2ZWNbaV07CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIC8vIEludGVnZXIgc3F1YXJlIHJvb3QgYXBwcm94aW1hdGlvbgogICAgcmV0dXJuIGludGVnZXJTcXVhcmVSb290KHN1bV9vZl9zcXVhcmVzKTsKfQoKLy8gSW50ZWdlciBzcXVhcmUgcm9vdCB1c2luZyBOZXd0b24ncyBtZXRob2QKZm4gaW50ZWdlclNxdWFyZVJvb3QobjogaTMyKSAtPiBpMzIgewogICAgaWYgKG4gPT0gMCkgewogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIGxldCBtdXQgeDogaTMyID0gbjsKICAgIGxldCBtdXQgcHJldl94OiBpMzIgPSAwOwoKICAgIHdoaWxlICh4ICE9IHByZXZfeCkgewogICAgICAgIHByZXZfeCA9IHg7CiAgICAgICAgeCA9ICh4ICsgbiAvIHgpIC8gMjsKICAgIH0KCiAgICByZXR1cm4geDsKfQoKLy8gVmVjdG9yIHNjYWxhciBtdWx0aXBsaWNhdGlvbgpmbiB2ZWN0b3JTY2FsYXJNdWx0aXBseSh2ZWM6ICZtdXQgW2kzMjsgMTAwXSwgc2NhbGFyOiBpMzIsIHNpemU6IHVzaXplKSB7CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIHZlY1tpXSAqPSBzY2FsYXI7CiAgICAgICAgaSArPSAxOwogICAgfQp9CgovLyBTb2x2ZSBzeXN0ZW0gb2YgbGluZWFyIGVxdWF0aW9ucyB1c2luZyBHYXVzc2lhbiBlbGltaW5hdGlvbiAoaW50ZWdlciBhcml0aG1ldGljKQpmbiBzb2x2ZUxpbmVhclN5c3RlbSgpIC0+IGkzMiB7CiAgICBsZXQgc2l6ZTogdXNpemUgPSA1OwogICAgbGV0IG11dCBhdWdtZW50ZWRfbWF0cml4OiBbaTMyOyAzMF0gPSBbMDsgMzBdOyAvLyA1eDYgYXVnbWVudGVkIG1hdHJpeAoKICAgIC8vIEluaXRpYWxpemUgc3lzdGVtIG9mIGVxdWF0aW9ucwogICAgaW5pdGlhbGl6ZUxpbmVhclN5c3RlbSgmbXV0IGF1Z21lbnRlZF9tYXRyaXgsIHNpemUpOwoKICAgIC8vIEdhdXNzaWFuIGVsaW1pbmF0aW9uCiAgICBnYXVzc2lhbkVsaW1pbmF0aW9uKCZtdXQgYXVnbWVudGVkX21hdHJpeCwgc2l6ZSk7CgogICAgLy8gQmFjayBzdWJzdGl0dXRpb24gYW5kIHN1bSBvZiBzb2x1dGlvbnMKICAgIGxldCBzb2x1dGlvbl9zdW06IGkzMiA9IGJhY2tTdWJzdGl0dXRpb24oYXVnbWVudGVkX21hdHJpeCwgc2l6ZSk7CgogICAgcmV0dXJuIHNvbHV0aW9uX3N1bSAlIDEwMDAwOwp9CgovLyBJbml0aWFsaXplIGxpbmVhciBzeXN0ZW0gQXggPSBiCmZuIGluaXRpYWxpemVMaW5lYXJTeXN0ZW0obWF0cml4OiAmbXV0IFtpMzI7IDMwXSwgc2l6ZTogdXNpemUpIHsKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgbGV0IG11dCBqOiB1c2l6ZSA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgIC8vIENyZWF0ZSBkaWFnb25hbGx5IGRvbWluYW50IG1hdHJpeCBmb3IgbnVtZXJpY2FsIHN0YWJpbGl0eQogICAgICAgICAgICBpZiAoaSA9PSBqKSB7CiAgICAgICAgICAgICAgICBtYXRyaXhbaSAqIChzaXplICsgMSkgKyBqXSA9IDEwICsgaSBhcyBpMzI7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBtYXRyaXhbaSAqIChzaXplICsgMSkgKyBqXSA9IChpICsgaiArIDEpIGFzIGkzMiAlIDU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiArPSAxOwogICAgICAgIH0KICAgICAgICAvLyBSaWdodC1oYW5kIHNpZGUKICAgICAgICBtYXRyaXhbaSAqIChzaXplICsgMSkgKyBzaXplXSA9IChpICsgMSkgYXMgaTMyICogMTA7CiAgICAgICAgaSArPSAxOwogICAgfQp9CgovLyBHYXVzc2lhbiBlbGltaW5hdGlvbiB3aXRoIHBhcnRpYWwgcGl2b3RpbmcKZm4gZ2F1c3NpYW5FbGltaW5hdGlvbihtYXRyaXg6ICZtdXQgW2kzMjsgMzBdLCBzaXplOiB1c2l6ZSkgewogICAgbGV0IG11dCBrOiB1c2l6ZSA9IDA7CiAgICB3aGlsZSAoayA8IHNpemUpIHsKICAgICAgICAvLyBGaW5kIHBpdm90CiAgICAgICAgbGV0IG11dCBtYXhfcm93OiB1c2l6ZSA9IGs7CiAgICAgICAgbGV0IG11dCBpOiB1c2l6ZSA9IGsgKyAxOwogICAgICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgICAgICBpZiAoYWJzKG1hdHJpeFtpICogKHNpemUgKyAxKSArIGtdKSA+IGFicyhtYXRyaXhbbWF4X3JvdyAqIChzaXplICsgMSkgKyBrXSkpIHsKICAgICAgICAgICAgICAgIG1heF9yb3cgPSBpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIFN3YXAgcm93cyBpZiBuZWVkZWQKICAgICAgICBpZiAobWF4X3JvdyAhPSBrKSB7CiAgICAgICAgICAgIHN3YXBSb3dzKG1hdHJpeCwgaywgbWF4X3Jvdywgc2l6ZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBFbGltaW5hdGUgY29sdW1uCiAgICAgICAgaSA9IGsgKyAxOwogICAgICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgICAgICBpZiAobWF0cml4W2sgKiAoc2l6ZSArIDEpICsga10gIT0gMCkgewogICAgICAgICAgICAgICAgbGV0IGZhY3RvcjogaTMyID0gbWF0cml4W2kgKiAoc2l6ZSArIDEpICsga10gLyBtYXRyaXhbayAqIChzaXplICsgMSkgKyBrXTsKICAgICAgICAgICAgICAgIGxldCBtdXQgajogdXNpemUgPSBrOwogICAgICAgICAgICAgICAgd2hpbGUgKGogPD0gc2l6ZSkgewogICAgICAgICAgICAgICAgICAgIG1hdHJpeFtpICogKHNpemUgKyAxKSArIGpdIC09IGZhY3RvciAqIG1hdHJpeFtrICogKHNpemUgKyAxKSArIGpdOwogICAgICAgICAgICAgICAgICAgIGogKz0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBrICs9IDE7CiAgICB9Cn0KCi8vIFN3YXAgdHdvIHJvd3MgaW4gdGhlIG1hdHJpeApmbiBzd2FwUm93cyhtYXRyaXg6ICZtdXQgW2kzMjsgMzBdLCByb3cxOiB1c2l6ZSwgcm93MjogdXNpemUsIHNpemU6IHVzaXplKSB7CiAgICBsZXQgbXV0IGo6IHVzaXplID0gMDsKICAgIHdoaWxlIChqIDw9IHNpemUpIHsKICAgICAgICBsZXQgdGVtcDogaTMyID0gbWF0cml4W3JvdzEgKiAoc2l6ZSArIDEpICsgal07CiAgICAgICAgbWF0cml4W3JvdzEgKiAoc2l6ZSArIDEpICsgal0gPSBtYXRyaXhbcm93MiAqIChzaXplICsgMSkgKyBqXTsKICAgICAgICBtYXRyaXhbcm93MiAqIChzaXplICsgMSkgKyBqXSA9IHRlbXA7CiAgICAgICAgaiArPSAxOwogICAgfQp9CgovLyBCYWNrIHN1YnN0aXR1dGlvbiB0byBmaW5kIHNvbHV0aW9ucwpmbiBiYWNrU3Vic3RpdHV0aW9uKG1hdHJpeDogW2kzMjsgMzBdLCBzaXplOiB1c2l6ZSkgLT4gaTMyIHsKICAgIGxldCBtdXQgc29sdXRpb25fc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBzb2x1dGlvbnM6IFtpMzI7IDVdID0gWzA7IDVdOwoKICAgIC8vIEJhY2sgc3Vic3RpdHV0aW9uCiAgICBsZXQgbXV0IGk6IGkzMiA9IChzaXplIC0gMSkgYXMgaTMyOwogICAgd2hpbGUgKGkgPj0gMCkgewogICAgICAgIGkgLT0gMTsKICAgICAgICBsZXQgaTogdXNpemUgPSAoaSArIDEpIGFzIHVzaXplOwogICAgICAgIHNvbHV0aW9uc1tpXSA9IG1hdHJpeFtpICogKHNpemUgKyAxKSArIHNpemVdOwoKICAgICAgICBsZXQgbXV0IGo6IHVzaXplID0gaSArIDE7CiAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgIHNvbHV0aW9uc1tpXSAtPSBtYXRyaXhbaSAqIChzaXplICsgMSkgKyBqXSAqIHNvbHV0aW9uc1tqXTsKICAgICAgICAgICAgaiArPSAxOwogICAgICAgIH0KCiAgICAgICAgaWYgKG1hdHJpeFtpICogKHNpemUgKyAxKSArIGldICE9IDApIHsKICAgICAgICAgICAgc29sdXRpb25zW2ldIC89IG1hdHJpeFtpICogKHNpemUgKyAxKSArIGldOwogICAgICAgIH0KCiAgICAgICAgc29sdXRpb25fc3VtICs9IHNvbHV0aW9uc1tpXTsKICAgIH0KCiAgICByZXR1cm4gc29sdXRpb25fc3VtOwp9CgovLyBBYnNvbHV0ZSB2YWx1ZSBmdW5jdGlvbgpmbiBhYnMoeDogaTMyKSAtPiBpMzIgewogICAgaWYgKHggPCAwKSB7CiAgICAgICAgcmV0dXJuIC14OwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4geDsKICAgIH0KfQoKLy8gVGVzdCA0OiBDb21iaW5hdG9yaWFsIEFsZ29yaXRobXMKLy8gVGVzdHMgb3B0aW1pemF0aW9uIG9mIGZhY3RvcmlhbCBhbmQgY29tYmluYXRvcmlhbCBjYWxjdWxhdGlvbnMKZm4gcGVyZm9ybUNvbWJpbmF0b3JpYWxBbGdvcml0aG1zKCkgewogICAgcHJpbnRsbkludCgzMDA3KTsgLy8gU3RhcnQgY29tYmluYXRvcmlhbCBhbGdvcml0aG1zCgogICAgLy8gUGFzY2FsJ3MgdHJpYW5nbGUgY2FsY3VsYXRpb24KICAgIGxldCBwYXNjYWxfc3VtOiBpMzIgPSBjYWxjdWxhdGVQYXNjYWxUcmlhbmdsZSgyMCk7CiAgICBwcmludGxuSW50KHBhc2NhbF9zdW0pOwoKICAgIC8vIFBlcm11dGF0aW9uIGNhbGN1bGF0aW9ucwogICAgbGV0IHBlcm11dGF0aW9uX3N1bTogaTMyID0gY2FsY3VsYXRlUGVybXV0YXRpb25zKDE1KTsKICAgIHByaW50bG5JbnQocGVybXV0YXRpb25fc3VtKTsKCiAgICAvLyBDb21iaW5hdGlvbiBjYWxjdWxhdGlvbnMKICAgIGxldCBjb21iaW5hdGlvbl9zdW06IGkzMiA9IGNhbGN1bGF0ZUNvbWJpbmF0aW9ucygyMCk7CiAgICBwcmludGxuSW50KGNvbWJpbmF0aW9uX3N1bSk7CgogICAgLy8gQ2F0YWxhbiBudW1iZXJzCiAgICBsZXQgY2F0YWxhbl9zdW06IGkzMiA9IGNhbGN1bGF0ZUNhdGFsYW5OdW1iZXJzKDE1KTsKICAgIHByaW50bG5JbnQoY2F0YWxhbl9zdW0pOwoKICAgIHByaW50bG5JbnQoMzAwOCk7IC8vIEVuZCBjb21iaW5hdG9yaWFsIGFsZ29yaXRobXMKfQoKLy8gQ2FsY3VsYXRlIFBhc2NhbCdzIHRyaWFuZ2xlIGFuZCBzdW0gZWxlbWVudHMKZm4gY2FsY3VsYXRlUGFzY2FsVHJpYW5nbGUocm93czogdXNpemUpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHRyaWFuZ2xlOiBbaTMyOyA0MTBdID0gWzA7IDQxMF07IC8vIFRyaWFuZ2xlIHdpdGggMjAgcm93cyBtYXgKICAgIGxldCBtdXQgdG90YWxfc3VtOiBpMzIgPSAwOwoKICAgIC8vIEZpcnN0IHJvdwogICAgdHJpYW5nbGVbMF0gPSAxOwogICAgdG90YWxfc3VtICs9IDE7CgogICAgbGV0IG11dCByb3c6IHVzaXplID0gMTsKICAgIHdoaWxlIChyb3cgPCByb3dzKSB7CiAgICAgICAgLy8gRmlyc3QgZWxlbWVudCBvZiBlYWNoIHJvdyBpcyAxCiAgICAgICAgdHJpYW5nbGVbcm93ICogcm93c10gPSAxOwogICAgICAgIHRvdGFsX3N1bSArPSAxOwoKICAgICAgICAvLyBDYWxjdWxhdGUgbWlkZGxlIGVsZW1lbnRzCiAgICAgICAgbGV0IG11dCBjb2w6IHVzaXplID0gMTsKICAgICAgICB3aGlsZSAoY29sIDwgcm93KSB7CiAgICAgICAgICAgIHRyaWFuZ2xlW3JvdyAqIHJvd3MgKyBjb2xdID0KICAgICAgICAgICAgICAgIHRyaWFuZ2xlWyhyb3cgLSAxKSAqIHJvd3MgKyBjb2wgLSAxXSArIHRyaWFuZ2xlWyhyb3cgLSAxKSAqIHJvd3MgKyBjb2xdOwogICAgICAgICAgICB0b3RhbF9zdW0gKz0gdHJpYW5nbGVbcm93ICogcm93cyArIGNvbF07CiAgICAgICAgICAgIGNvbCArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gTGFzdCBlbGVtZW50IG9mIGVhY2ggcm93IGlzIDEKICAgICAgICB0cmlhbmdsZVtyb3cgKiByb3dzICsgcm93XSA9IDE7CiAgICAgICAgdG90YWxfc3VtICs9IDE7CgogICAgICAgIHJvdyArPSAxOwogICAgfQoKICAgIHJldHVybiB0b3RhbF9zdW0gJSAxMDAwMDsKfQoKLy8gQ2FsY3VsYXRlIHBlcm11dGF0aW9ucyBQKG4scikgZm9yIHZhcmlvdXMgbiBhbmQgcgpmbiBjYWxjdWxhdGVQZXJtdXRhdGlvbnMobWF4X246IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgcGVybXV0YXRpb25fc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBuOiBpMzIgPSAxOwoKICAgIHdoaWxlIChuIDw9IG1heF9uKSB7CiAgICAgICAgbGV0IG11dCByOiBpMzIgPSAxOwogICAgICAgIHdoaWxlIChyIDw9IG4pIHsKICAgICAgICAgICAgbGV0IHBlcm06IGkzMiA9IHBlcm11dGF0aW9uKG4sIHIpOwogICAgICAgICAgICBwZXJtdXRhdGlvbl9zdW0gPSAocGVybXV0YXRpb25fc3VtICsgcGVybSkgJSAxMDAwMDAwOwogICAgICAgICAgICByICs9IDE7CiAgICAgICAgfQogICAgICAgIG4gKz0gMTsKICAgIH0KCiAgICByZXR1cm4gcGVybXV0YXRpb25fc3VtICUgMTAwMDA7Cn0KCi8vIENhbGN1bGF0ZSBQKG4scikgPSBuISAvIChuLXIpIQpmbiBwZXJtdXRhdGlvbihuOiBpMzIsIHI6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgcmVzdWx0OiBpMzIgPSAxOwogICAgbGV0IG11dCBpOiBpMzIgPSBuIC0gciArIDE7CgogICAgd2hpbGUgKGkgPD0gbikgewogICAgICAgIHJlc3VsdCA9IChyZXN1bHQgKiBpKSAlIDEwMDAwMDA7IC8vIFByZXZlbnQgb3ZlcmZsb3cKICAgICAgICBpICs9IDE7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKfQoKLy8gQ2FsY3VsYXRlIGNvbWJpbmF0aW9ucyBDKG4scikgZm9yIHZhcmlvdXMgbiBhbmQgcgpmbiBjYWxjdWxhdGVDb21iaW5hdGlvbnMobWF4X246IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgY29tYmluYXRpb25fc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBuOiBpMzIgPSAxOwoKICAgIHdoaWxlIChuIDw9IG1heF9uKSB7CiAgICAgICAgbGV0IG11dCByOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChyIDw9IG4pIHsKICAgICAgICAgICAgbGV0IGNvbWI6IGkzMiA9IGNvbWJpbmF0aW9uKG4sIHIpOwogICAgICAgICAgICBjb21iaW5hdGlvbl9zdW0gPSAoY29tYmluYXRpb25fc3VtICsgY29tYikgJSAxMDAwMDAwOwogICAgICAgICAgICByICs9IDE7CiAgICAgICAgfQogICAgICAgIG4gKz0gMTsKICAgIH0KCiAgICByZXR1cm4gY29tYmluYXRpb25fc3VtICUgMTAwMDA7Cn0KCi8vIENhbGN1bGF0ZSBDKG4scikgPSBuISAvIChyISAqIChuLXIpISkgdXNpbmcgb3B0aW1pemVkIG1ldGhvZApmbiBjb21iaW5hdGlvbihuOiBpMzIsIHI6IGkzMikgLT4gaTMyIHsKICAgIGxldCBhY3R1YWxfcjogaTMyID0gaWYgKHIgPiBuIC0gcikgeyBuIC0gciB9IGVsc2UgeyByIH07CiAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gMTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICB3aGlsZSAoaSA8IGFjdHVhbF9yKSB7CiAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICogKG4gLSBpKSAvIChpICsgMSk7CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIHJldHVybiByZXN1bHQgJSAxMDAwMDAwOwp9CgovLyBDYWxjdWxhdGUgQ2F0YWxhbiBudW1iZXJzIHVzaW5nIGR5bmFtaWMgcHJvZ3JhbW1pbmcKZm4gY2FsY3VsYXRlQ2F0YWxhbk51bWJlcnMoY291bnQ6IHVzaXplKSAtPiBpMzIgewogICAgbGV0IG11dCBjYXRhbGFuOiBbaTMyOyAxNV0gPSBbMDsgMTVdOwogICAgbGV0IG11dCBjYXRhbGFuX3N1bTogaTMyID0gMDsKCiAgICAvLyBCYXNlIGNhc2VzCiAgICBjYXRhbGFuWzBdID0gMTsKICAgIGNhdGFsYW5bMV0gPSAxOwogICAgY2F0YWxhbl9zdW0gPSAyOwoKICAgIGxldCBtdXQgaTogdXNpemUgPSAyOwogICAgd2hpbGUgKGkgPCBjb3VudCkgewogICAgICAgIGNhdGFsYW5baV0gPSAwOwogICAgICAgIGxldCBtdXQgajogdXNpemUgPSAwOwogICAgICAgIHdoaWxlIChqIDwgaSkgewogICAgICAgICAgICBjYXRhbGFuW2ldID0gKGNhdGFsYW5baV0gKyBjYXRhbGFuW2pdICogY2F0YWxhbltpIC0gMSAtIGpdKSAlIDEwMDAwMDA7CiAgICAgICAgICAgIGogKz0gMTsKICAgICAgICB9CiAgICAgICAgY2F0YWxhbl9zdW0gPSAoY2F0YWxhbl9zdW0gKyBjYXRhbGFuW2ldKSAlIDEwMDAwMDA7CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIHJldHVybiBjYXRhbGFuX3N1bSAlIDEwMDAwOwp9CgovLyBUZXN0IDU6IENyeXB0b2dyYXBoaWMgT3BlcmF0aW9ucwovLyBUZXN0cyBvcHRpbWl6YXRpb24gb2YgbW9kdWxhciBhcml0aG1ldGljIGFuZCBsYXJnZSBudW1iZXIgb3BlcmF0aW9ucwpmbiBwZXJmb3JtQ3J5cHRvZ3JhcGhpY09wZXJhdGlvbnMoKSB7CiAgICBwcmludGxuSW50KDMwMDkpOyAvLyBTdGFydCBjcnlwdG9ncmFwaGljIG9wZXJhdGlvbnMKCiAgICAvLyBSU0Etc3R5bGUgbW9kdWxhciBleHBvbmVudGlhdGlvbgogICAgbGV0IHJzYV9yZXN1bHQ6IGkzMiA9IHBlcmZvcm1SU0FPcGVyYXRpb25zKCk7CiAgICBwcmludGxuSW50KHJzYV9yZXN1bHQpOwoKICAgIC8vIE1vZHVsYXIgaW52ZXJzZSBjYWxjdWxhdGlvbnMKICAgIGxldCBpbnZlcnNlX3Jlc3VsdDogaTMyID0gcGVyZm9ybU1vZHVsYXJJbnZlcnNlKCk7CiAgICBwcmludGxuSW50KGludmVyc2VfcmVzdWx0KTsKCiAgICAvLyBQcmltYWxpdHkgdGVzdGluZyB3aXRoIEZlcm1hdCdzIHRlc3QKICAgIGxldCBwcmltYWxpdHlfcmVzdWx0OiBpMzIgPSBwZXJmb3JtUHJpbWFsaXR5VGVzdGluZygpOwogICAgcHJpbnRsbkludChwcmltYWxpdHlfcmVzdWx0KTsKCiAgICAvLyBTaW1wbGUgaGFzaCBmdW5jdGlvbiBpbXBsZW1lbnRhdGlvbnMKICAgIGxldCBoYXNoX3Jlc3VsdDogaTMyID0gcGVyZm9ybUhhc2hPcGVyYXRpb25zKCk7CiAgICBwcmludGxuSW50KGhhc2hfcmVzdWx0KTsKCiAgICBwcmludGxuSW50KDMwMTApOyAvLyBFbmQgY3J5cHRvZ3JhcGhpYyBvcGVyYXRpb25zCn0KCi8vIFJTQS1zdHlsZSBvcGVyYXRpb25zIHdpdGggbW9kdWxhciBleHBvbmVudGlhdGlvbgpmbiBwZXJmb3JtUlNBT3BlcmF0aW9ucygpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHJlc3VsdF9zdW06IGkzMiA9IDA7CgogICAgLy8gU2ltdWxhdGUgUlNBIGVuY3J5cHRpb24vZGVjcnlwdGlvbiB3aXRoIHNtYWxsIG51bWJlcnMKICAgIGxldCBwOiBpMzIgPSA2MTsgLy8gU21hbGwgcHJpbWUKICAgIGxldCBxOiBpMzIgPSA1MzsgLy8gU21hbGwgcHJpbWUKICAgIGxldCBuOiBpMzIgPSBwICogcTsgLy8gTW9kdWx1cwogICAgbGV0IHBoaV9uOiBpMzIgPSAocCAtIDEpICogKHEgLSAxKTsgLy8gRXVsZXIncyB0b3RpZW50CgogICAgbGV0IGU6IGkzMiA9IDE3OyAvLyBQdWJsaWMgZXhwb25lbnQgKG11c3QgYmUgY29wcmltZSB0byBwaGlfbikKICAgIGxldCBkOiBpMzIgPSBtb2R1bGFySW52ZXJzZShlLCBwaGlfbik7IC8vIFByaXZhdGUgZXhwb25lbnQKCiAgICAvLyBFbmNyeXB0IGFuZCBkZWNyeXB0IG11bHRpcGxlIG1lc3NhZ2VzCiAgICBsZXQgbXV0IG1lc3NhZ2U6IGkzMiA9IDI7CiAgICB3aGlsZSAobWVzc2FnZSA8IDEwMCkgewogICAgICAgIC8vIEVuY3J5cHRpb246IGNpcGhlcnRleHQgPSBtZXNzYWdlXmUgbW9kIG4KICAgICAgICBsZXQgY2lwaGVydGV4dDogaTMyID0gbW9kdWxhclBvd2VyKG1lc3NhZ2UsIGUsIG4pOwoKICAgICAgICAvLyBEZWNyeXB0aW9uOiBwbGFpbnRleHQgPSBjaXBoZXJ0ZXh0XmQgbW9kIG4KICAgICAgICBsZXQgcGxhaW50ZXh0OiBpMzIgPSBtb2R1bGFyUG93ZXIoY2lwaGVydGV4dCwgZCwgbik7CgogICAgICAgIC8vIFZlcmlmeSBlbmNyeXB0aW9uL2RlY3J5cHRpb24gd29ya2VkCiAgICAgICAgaWYgKHBsYWludGV4dCA9PSBtZXNzYWdlKSB7CiAgICAgICAgICAgIHJlc3VsdF9zdW0gKz0gbWVzc2FnZTsKICAgICAgICB9CgogICAgICAgIG1lc3NhZ2UgKz0gNzsgLy8gU2tpcCBzb21lIHZhbHVlcyBmb3IgcGVyZm9ybWFuY2UKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0X3N1bSAlIDEwMDAwOwp9CgovLyBFeHRlbmRlZCBFdWNsaWRlYW4gYWxnb3JpdGhtIGZvciBtb2R1bGFyIGludmVyc2UKZm4gbW9kdWxhckludmVyc2UoYTogaTMyLCBtOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IG9sZF9yOiBpMzIgPSBhOwogICAgbGV0IG11dCByOiBpMzIgPSBtOwogICAgbGV0IG11dCBvbGRfczogaTMyID0gMTsKICAgIGxldCBtdXQgczogaTMyID0gMDsKCiAgICB3aGlsZSAociAhPSAwKSB7CiAgICAgICAgbGV0IHF1b3RpZW50OiBpMzIgPSBvbGRfciAvIHI7CgogICAgICAgIGxldCB0ZW1wX3I6IGkzMiA9IHI7CiAgICAgICAgciA9IG9sZF9yIC0gcXVvdGllbnQgKiByOwogICAgICAgIG9sZF9yID0gdGVtcF9yOwoKICAgICAgICBsZXQgdGVtcF9zOiBpMzIgPSBzOwogICAgICAgIHMgPSBvbGRfcyAtIHF1b3RpZW50ICogczsKICAgICAgICBvbGRfcyA9IHRlbXBfczsKICAgIH0KCiAgICAvLyBNYWtlIHN1cmUgcmVzdWx0IGlzIHBvc2l0aXZlCiAgICBpZiAob2xkX3MgPCAwKSB7CiAgICAgICAgb2xkX3MgKz0gbTsKICAgIH0KCiAgICByZXR1cm4gb2xkX3M7Cn0KCi8vIFBlcmZvcm0gbXVsdGlwbGUgbW9kdWxhciBpbnZlcnNlIGNhbGN1bGF0aW9ucwpmbiBwZXJmb3JtTW9kdWxhckludmVyc2UoKSAtPiBpMzIgewogICAgbGV0IG11dCBpbnZlcnNlX3N1bTogaTMyID0gMDsKICAgIGxldCBtb2R1bHVzOiBpMzIgPSA5NzsgLy8gUHJpbWUgbW9kdWx1cwoKICAgIGxldCBtdXQgYTogaTMyID0gMjsKICAgIHdoaWxlIChhIDwgbW9kdWx1cykgewogICAgICAgIGlmIChldWNsaWRlYW5HQ0QoYSwgbW9kdWx1cykgPT0gMSkgewogICAgICAgICAgICAvLyBDaGVjayBpZiBjb3ByaW1lCiAgICAgICAgICAgIGxldCBpbnZlcnNlOiBpMzIgPSBtb2R1bGFySW52ZXJzZShhLCBtb2R1bHVzKTsKICAgICAgICAgICAgaW52ZXJzZV9zdW0gPSAoaW52ZXJzZV9zdW0gKyBpbnZlcnNlKSAlIDEwMDAwOwogICAgICAgIH0KICAgICAgICBhICs9IDE7CiAgICB9CgogICAgcmV0dXJuIGludmVyc2Vfc3VtOwp9CgovLyBGZXJtYXQgcHJpbWFsaXR5IHRlc3QKZm4gcGVyZm9ybVByaW1hbGl0eVRlc3RpbmcoKSAtPiBpMzIgewogICAgbGV0IG11dCBwcm9iYWJsZV9wcmltZXM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IG51bTogaTMyID0gMzsKCiAgICB3aGlsZSAobnVtIDwgNTAwKSB7CiAgICAgICAgaWYgKGZlcm1hdFByaW1hbGl0eVRlc3QobnVtLCA1KSA9PSAxKSB7CiAgICAgICAgICAgIC8vIFRlc3Qgd2l0aCA1IGl0ZXJhdGlvbnMKICAgICAgICAgICAgcHJvYmFibGVfcHJpbWVzICs9IDE7CiAgICAgICAgfQogICAgICAgIG51bSArPSAyOyAvLyBDaGVjayBvbmx5IG9kZCBudW1iZXJzCiAgICB9CgogICAgcmV0dXJuIHByb2JhYmxlX3ByaW1lczsKfQoKLy8gRmVybWF0IHByaW1hbGl0eSB0ZXN0OiBpZiBuIGlzIHByaW1lLCB0aGVuIGFeKG4tMSkg4omhIDEgKG1vZCBuKSBmb3IgYW55IGEgY29wcmltZSB0byBuCmZuIGZlcm1hdFByaW1hbGl0eVRlc3QobjogaTMyLCBpdGVyYXRpb25zOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobiA8PSAxKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICBpZiAobiA8PSAzKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CiAgICBpZiAobiAlIDIgPT0gMCkgewogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIGxldCBtdXQgc2VlZDogaTMyID0gbjsgLy8gVXNlIG4gYXMgc2VlZCBmb3IgcHNldWRvcmFuZG9tIG51bWJlciBnZW5lcmF0aW9uCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgd2hpbGUgKGkgPCBpdGVyYXRpb25zKSB7CiAgICAgICAgLy8gR2VuZXJhdGUgcHNldWRvcmFuZG9tIGJhc2UgYQogICAgICAgIHNlZWQgPSB1cGRhdGVTZWVkKHNlZWQpOwogICAgICAgIGxldCBhOiBpMzIgPSAyICsgKHNlZWQgJSAobiAtIDMpKTsgLy8gQmFzZSBpbiByYW5nZSBbMiwgbi0xXQoKICAgICAgICAvLyBDaGVjayBpZiBhXihuLTEpIOKJoSAxIChtb2QgbikKICAgICAgICBpZiAobW9kdWxhclBvd2VyKGEsIG4gLSAxLCBuKSAhPSAxKSB7CiAgICAgICAgICAgIHJldHVybiAwOyAvLyBDb21wb3NpdGUKICAgICAgICB9CgogICAgICAgIGkgKz0gMTsKICAgIH0KCiAgICByZXR1cm4gMTsgLy8gUHJvYmFibHkgcHJpbWUKfQoKLy8gU2ltcGxlIGhhc2ggb3BlcmF0aW9ucwpmbiBwZXJmb3JtSGFzaE9wZXJhdGlvbnMoKSAtPiBpMzIgewogICAgbGV0IGlucHV0X3NpemU6IHVzaXplID0gMTAwOwogICAgbGV0IG11dCBpbnB1dF9kYXRhOiBbaTMyOyAxMDBdID0gWzA7IDEwMF07CiAgICBsZXQgbXV0IGhhc2hfc3VtOiBpMzIgPSAwOwoKICAgIC8vIEluaXRpYWxpemUgaW5wdXQgZGF0YQogICAgaW5pdGlhbGl6ZUhhc2hJbnB1dCgmbXV0IGlucHV0X2RhdGEsIGlucHV0X3NpemUpOwoKICAgIC8vIFRlc3QgbXVsdGlwbGUgaGFzaCBmdW5jdGlvbnMKICAgIGxldCBkamIyX2hhc2g6IGkzMiA9IGRqYjJIYXNoKGlucHV0X2RhdGEsIGlucHV0X3NpemUpOwogICAgbGV0IHNkYm1faGFzaDogaTMyID0gc2RibUhhc2goaW5wdXRfZGF0YSwgaW5wdXRfc2l6ZSk7CiAgICBsZXQgZm52X2hhc2g6IGkzMiA9IGZudkhhc2goaW5wdXRfZGF0YSwgaW5wdXRfc2l6ZSk7CgogICAgaGFzaF9zdW0gPSAoZGpiMl9oYXNoICsgc2RibV9oYXNoICsgZm52X2hhc2gpICUgMTAwMDA7CgogICAgLy8gVGVzdCBoYXNoIGRpc3RyaWJ1dGlvbgogICAgbGV0IGRpc3RyaWJ1dGlvbl9zY29yZTogaTMyID0gdGVzdEhhc2hEaXN0cmlidXRpb24oaW5wdXRfZGF0YSwgaW5wdXRfc2l6ZSk7CiAgICBoYXNoX3N1bSA9IChoYXNoX3N1bSArIGRpc3RyaWJ1dGlvbl9zY29yZSkgJSAxMDAwMDsKCiAgICByZXR1cm4gaGFzaF9zdW07Cn0KCmZuIHVwZGF0ZVNlZWQobXV0IHNlZWQ6IGkzMikgLT4gaTMyIHsKICAgIHNlZWQgPSAoc2VlZCAqIDExMDMgKyA0NzIxKSAlIDEwNDg1ODM7CiAgICBpZiAoc2VlZCA8IDApIHsKICAgICAgICBzZWVkID0gLXNlZWQ7CiAgICB9CiAgICBzZWVkCn0KCi8vIEluaXRpYWxpemUgaW5wdXQgZGF0YSBmb3IgaGFzaGluZwpmbiBpbml0aWFsaXplSGFzaElucHV0KGRhdGE6ICZtdXQgW2kzMjsgMTAwXSwgc2l6ZTogdXNpemUpIHsKICAgIGxldCBtdXQgc2VlZDogaTMyID0gNDI7CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKCiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBzZWVkID0gdXBkYXRlU2VlZChzZWVkKTsKICAgICAgICBkYXRhW2ldID0gc2VlZCAlIDI1NjsgLy8gQnl0ZSB2YWx1ZXMKICAgICAgICBpICs9IDE7CiAgICB9Cn0KCi8vIERKQjIgaGFzaCBmdW5jdGlvbgpmbiBkamIySGFzaChkYXRhOiBbaTMyOyAxMDBdLCBzaXplOiB1c2l6ZSkgLT4gaTMyIHsKICAgIGxldCBtdXQgaGFzaDogaTMyID0gNTM4MTsKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwoKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGhhc2ggPSAoKGhhc2ggPDwgNSkgJSA2NTUzNiArIGhhc2gpICUgNjU1MzYgKyBkYXRhW2ldOyAvLyBoYXNoICogMzMgKyBkYXRhW2ldCiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIHJldHVybiBoYXNoICUgNjU1MzY7IC8vIDE2LWJpdCBoYXNoCn0KCi8vIFNEQk0gaGFzaCBmdW5jdGlvbgpmbiBzZGJtSGFzaChkYXRhOiBbaTMyOyAxMDBdLCBzaXplOiB1c2l6ZSkgLT4gaTMyIHsKICAgIGxldCBtdXQgaGFzaDogaTMyID0gMDsKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwoKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGhhc2ggPSBkYXRhW2ldICsgKGhhc2ggPDwgNikgJSA2NTUzNiArIChoYXNoIDw8IDE2KSAlIDY1NTM2IC0gaGFzaDsKICAgICAgICBpICs9IDE7CiAgICB9CgogICAgcmV0dXJuIGhhc2ggJSA2NTUzNjsgLy8gMTYtYml0IGhhc2gKfQoKLy8gRk5WLTFhIGhhc2ggZnVuY3Rpb24gKHNpbXBsaWZpZWQpCmZuIGZudkhhc2goZGF0YTogW2kzMjsgMTAwXSwgc2l6ZTogdXNpemUpIC0+IGkzMiB7CiAgICBsZXQgZm52X3ByaW1lOiB1MzIgPSAxNjc3NzYxOTsKICAgIGxldCBtdXQgaGFzaDogdTMyID0gMjE2NjEzNjI2MXUzMjsgLy8gRk5WIG9mZnNldCBiYXNpcwogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CgogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgaGFzaCBePSBkYXRhW2ldIGFzIHUzMjsKICAgICAgICBoYXNoID0gKGhhc2ggJSA2NTUzNikgKiAoZm52X3ByaW1lICUgNjU1MzYpICUgNjU1MzY7CiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIHJldHVybiBoYXNoIGFzIGkzMiAlIDY1NTM2OyAvLyAxNi1iaXQgaGFzaAp9CgovLyBUZXN0IGhhc2ggZGlzdHJpYnV0aW9uIGJ5IGNvbXB1dGluZyBoYXNoZXMgZm9yIHNpbWlsYXIgaW5wdXRzCmZuIHRlc3RIYXNoRGlzdHJpYnV0aW9uKGJhc2VfZGF0YTogW2kzMjsgMTAwXSwgc2l6ZTogdXNpemUpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGRpc3RyaWJ1dGlvbl9zY29yZTogaTMyID0gMDsKICAgIGxldCBtdXQgbW9kaWZpZWRfZGF0YTogW2kzMjsgMTAwXSA9IFswOyAxMDBdOwoKICAgIGxldCBtdXQgbW9kaWZpY2F0aW9uOiB1c2l6ZSA9IDE7CiAgICB3aGlsZSAobW9kaWZpY2F0aW9uIDw9IDEwKSB7CiAgICAgICAgLy8gQ29weSBiYXNlIGRhdGEgYW5kIG1vZGlmeSBzbGlnaHRseQogICAgICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgICAgICBtb2RpZmllZF9kYXRhW2ldID0gYmFzZV9kYXRhW2ldOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBNb2RpZnkgb25lIGVsZW1lbnQKICAgICAgICBtb2RpZmllZF9kYXRhW21vZGlmaWNhdGlvbiAqIDcgJSBzaXplXSArPSBtb2RpZmljYXRpb24gYXMgaTMyOwoKICAgICAgICAvLyBDYWxjdWxhdGUgaGFzaCBhbmQgYWNjdW11bGF0ZQogICAgICAgIGxldCBoYXNoOiBpMzIgPSBkamIySGFzaChtb2RpZmllZF9kYXRhLCBzaXplKTsKICAgICAgICBkaXN0cmlidXRpb25fc2NvcmUgPSAoZGlzdHJpYnV0aW9uX3Njb3JlICsgaGFzaCkgJSAxMDAwMDsKCiAgICAgICAgbW9kaWZpY2F0aW9uICs9IDE7CiAgICB9CgogICAgcmV0dXJuIGRpc3RyaWJ1dGlvbl9zY29yZTsKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (4, "comprehensive4", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCA0OiBSZWN1cnNpdmUgQWxnb3JpdGhtcyBhbmQgRGVlcCBDYWxsIFN0YWNrIE9wdGltaXphdGlvbgpTdW1tYXJ5OiBUaGlzIHRlc3QgZm9jdXNlcyBvbiBjb21waWxlciBvcHRpbWl6YXRpb24gb2Y6CkRldGFpbHM6ClRhaWwgcmVjdXJzaW9uIG9wdGltaXphdGlvbgpDYWxsIHN0YWNrIG1hbmFnZW1lbnQgYW5kIG9wdGltaXphdGlvbgpSZWN1cnNpdmUgZnVuY3Rpb24gaW5saW5pbmcgZGVjaXNpb25zCkRlZXAgcmVjdXJzaW9uIHBlcmZvcm1hbmNlCkZ1bmN0aW9uIHByb2xvZ3VlL2VwaWxvZ3VlIG9wdGltaXphdGlvbgpSZXR1cm4gdmFsdWUgb3B0aW1pemF0aW9uCiovCgovLyBjb21wcmVoZW5zaXZlNC5yeCAtIENvbXByZWhlbnNpdmUgVGVzdCA0OiBSZWN1cnNpdmUgQWxnb3JpdGhtcyBhbmQgRGVlcCBDYWxsIFN0YWNrIE9wdGltaXphdGlvbgovLyBUaGlzIHRlc3QgZm9jdXNlcyBvbiBjb21waWxlciBvcHRpbWl6YXRpb24gb2Y6Ci8vIC0gVGFpbCByZWN1cnNpb24gb3B0aW1pemF0aW9uCi8vIC0gQ2FsbCBzdGFjayBtYW5hZ2VtZW50IGFuZCBvcHRpbWl6YXRpb24KLy8gLSBSZWN1cnNpdmUgZnVuY3Rpb24gaW5saW5pbmcgZGVjaXNpb25zCi8vIC0gRGVlcCByZWN1cnNpb24gcGVyZm9ybWFuY2UKLy8gLSBGdW5jdGlvbiBwcm9sb2d1ZS9lcGlsb2d1ZSBvcHRpbWl6YXRpb24KLy8gLSBSZXR1cm4gdmFsdWUgb3B0aW1pemF0aW9uCgpmbiBtYWluKCkgewogICAgLy8gUGVyZm9ybWFuY2UgdGVzdCBtYXJrZXIgLSBzdGFydAogICAgcHJpbnRsbkludCgxNDAwKTsKCiAgICAvLyBUZXN0IDE6IERlZXAgcmVjdXJzaXZlIGFsZ29yaXRobXMKICAgIC8vIFRlc3RzIGNvbXBpbGVyJ3MgdGFpbCByZWN1cnNpb24gb3B0aW1pemF0aW9uIGFuZCBzdGFjayBtYW5hZ2VtZW50CiAgICB0ZXN0RGVlcFJlY3Vyc2l2ZUFsZ29yaXRobXMoKTsKCiAgICAvLyBUZXN0IDI6IE11dHVhbCByZWN1cnNpb24gcGF0dGVybnMKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBtdXR1YWxseSByZWN1cnNpdmUgZnVuY3Rpb25zCiAgICB0ZXN0TXV0dWFsUmVjdXJzaW9uKCk7CgogICAgLy8gVGVzdCAzOiBUcmVlIHRyYXZlcnNhbCBhbGdvcml0aG1zCiAgICAvLyBUZXN0cyByZWN1cnNpdmUgdHJlZSBvcGVyYXRpb25zIG9wdGltaXphdGlvbgogICAgdGVzdFRyZWVUcmF2ZXJzYWxBbGdvcml0aG1zKCk7CgogICAgLy8gVGVzdCA0OiBEaXZpZGUgYW5kIGNvbnF1ZXIgYWxnb3JpdGhtcwogICAgLy8gVGVzdHMgb3B0aW1pemF0aW9uIG9mIHJlY3Vyc2l2ZSBkaXZpZGUgYW5kIGNvbnF1ZXIgcGF0dGVybnMKICAgIHRlc3REaXZpZGVBbmRDb25xdWVyQWxnb3JpdGhtcygpOwoKICAgIC8vIFRlc3QgNTogUmVjdXJzaXZlIG1hdGhlbWF0aWNhbCBjb21wdXRhdGlvbnMKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBtYXRoZW1hdGljYWwgcmVjdXJzaXZlIGZ1bmN0aW9ucwogICAgdGVzdFJlY3Vyc2l2ZU1hdGhlbWF0aWNhbENvbXB1dGF0aW9ucygpOwoKICAgIC8vIFBlcmZvcm1hbmNlIHRlc3QgbWFya2VyIC0gZW5kCiAgICBwcmludGxuSW50KDE0OTkpOwogICAgZXhpdCgwKTsKfQoKLy8gVGVzdCAxOiBEZWVwIFJlY3Vyc2l2ZSBBbGdvcml0aG1zCmZuIHRlc3REZWVwUmVjdXJzaXZlQWxnb3JpdGhtcygpIHsKICAgIHByaW50bG5JbnQoMTQwMSk7IC8vIFN0YXJ0IGRlZXAgcmVjdXJzaW9uIHRlc3QKCiAgICAvLyBUZXN0IHRhaWwgcmVjdXJzaW9uIG9wdGltaXphdGlvbgogICAgbGV0IGZhY3RvcmlhbF9yZXN1bHQ6IGkzMiA9IHRhaWxSZWN1cnNpdmVGYWN0b3JpYWwoMTIsIDEpOwogICAgcHJpbnRsbkludChmYWN0b3JpYWxfcmVzdWx0KTsKCiAgICAvLyBUZXN0IGRlZXAgcmVjdXJzaW9uIHdpdGggYWNjdW11bGF0b3IKICAgIGxldCBzdW1fcmVzdWx0OiBpMzIgPSBkZWVwUmVjdXJzaXZlU3VtKDEwMDAsIDApOwogICAgcHJpbnRsbkludChzdW1fcmVzdWx0KTsKCiAgICAvLyBUZXN0IHJlY3Vyc2l2ZSBjb3VudGRvd24KICAgIGxldCBjb3VudGRvd25fcmVzdWx0OiBpMzIgPSByZWN1cnNpdmVDb3VudGRvd24oNTAwKTsKICAgIHByaW50bG5JbnQoY291bnRkb3duX3Jlc3VsdCk7CgogICAgLy8gVGVzdCByZWN1cnNpdmUgcG93ZXIgY2FsY3VsYXRpb24KICAgIGxldCBwb3dlcl9yZXN1bHQ6IGkzMiA9IHJlY3Vyc2l2ZVBvd2VyKDIsIDIwKTsKICAgIHByaW50bG5JbnQocG93ZXJfcmVzdWx0KTsKCiAgICBwcmludGxuSW50KDE0MDIpOyAvLyBFbmQgZGVlcCByZWN1cnNpb24gdGVzdAp9CgovLyBUYWlsIHJlY3Vyc2l2ZSBmYWN0b3JpYWwKZm4gdGFpbFJlY3Vyc2l2ZUZhY3RvcmlhbChuOiBpMzIsIGFjY3VtdWxhdG9yOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobiA8PSAxKSB7CiAgICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yOwogICAgfQogICAgcmV0dXJuIHRhaWxSZWN1cnNpdmVGYWN0b3JpYWwobiAtIDEsIGFjY3VtdWxhdG9yICogbik7Cn0KCi8vIERlZXAgcmVjdXJzaXZlIHN1bSB3aXRoIGFjY3VtdWxhdG9yCmZuIGRlZXBSZWN1cnNpdmVTdW0objogaTMyLCBhY2N1bXVsYXRvcjogaTMyKSAtPiBpMzIgewogICAgaWYgKG4gPD0gMCkgewogICAgICAgIHJldHVybiBhY2N1bXVsYXRvcjsKICAgIH0KICAgIHJldHVybiBkZWVwUmVjdXJzaXZlU3VtKG4gLSAxLCBhY2N1bXVsYXRvciArIG4pOwp9CgovLyBSZWN1cnNpdmUgY291bnRkb3duIGZ1bmN0aW9uCmZuIHJlY3Vyc2l2ZUNvdW50ZG93bihuOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobiA8PSAwKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICByZXR1cm4gMSArIHJlY3Vyc2l2ZUNvdW50ZG93bihuIC0gMSk7Cn0KCi8vIFJlY3Vyc2l2ZSBwb3dlciBjYWxjdWxhdGlvbgpmbiByZWN1cnNpdmVQb3dlcihiYXNlOiBpMzIsIGV4cG9uZW50OiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoZXhwb25lbnQgPT0gMCkgewogICAgICAgIHJldHVybiAxOwogICAgfQogICAgaWYgKGV4cG9uZW50ID09IDEpIHsKICAgICAgICByZXR1cm4gYmFzZTsKICAgIH0KICAgIGlmIChleHBvbmVudCAlIDIgPT0gMCkgewogICAgICAgIGxldCBoYWxmX3Bvd2VyOiBpMzIgPSByZWN1cnNpdmVQb3dlcihiYXNlLCBleHBvbmVudCAvIDIpOwogICAgICAgIHJldHVybiBoYWxmX3Bvd2VyICogaGFsZl9wb3dlcjsKICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGJhc2UgKiByZWN1cnNpdmVQb3dlcihiYXNlLCBleHBvbmVudCAtIDEpOwogICAgfQp9CgovLyBUZXN0IDI6IE11dHVhbCBSZWN1cnNpb24gUGF0dGVybnMKZm4gdGVzdE11dHVhbFJlY3Vyc2lvbigpIHsKICAgIHByaW50bG5JbnQoMTQwMyk7IC8vIFN0YXJ0IG11dHVhbCByZWN1cnNpb24gdGVzdAoKICAgIC8vIFRlc3QgbXV0dWFsIHJlY3Vyc2lvbiB3aXRoIGV2ZW4vb2RkIGZ1bmN0aW9ucwogICAgbGV0IGV2ZW5fcmVzdWx0OiBpMzIgPSBjb3VudEV2ZW5PZGRNdXR1YWwoMTAwKTsKICAgIHByaW50bG5JbnQoZXZlbl9yZXN1bHQpOwoKICAgIC8vIFRlc3QgbXV0dWFsIHJlY3Vyc2lvbiB3aXRoIHBpbmctcG9uZyBwYXR0ZXJuCiAgICBsZXQgcGluZ19wb25nX3Jlc3VsdDogaTMyID0gcGluZ1BvbmdNdXR1YWwoNTAsIHRydWUpOwogICAgcHJpbnRsbkludChwaW5nX3BvbmdfcmVzdWx0KTsKCiAgICAvLyBUZXN0IG11dHVhbCByZWN1cnNpb24gd2l0aCBzdGF0ZSBtYWNoaW5lcwogICAgbGV0IHN0YXRlX3Jlc3VsdDogaTMyID0gc3RhdGVNYWNoaW5lQSg3NSwgMCk7CiAgICBwcmludGxuSW50KHN0YXRlX3Jlc3VsdCk7CgogICAgcHJpbnRsbkludCgxNDA0KTsgLy8gRW5kIG11dHVhbCByZWN1cnNpb24gdGVzdAp9CgovLyBNdXR1YWwgcmVjdXJzaW9uOiBldmVuL29kZCBjaGVja2luZwpmbiBpc0V2ZW5NdXR1YWwobjogaTMyKSAtPiBpMzIgewogICAgaWYgKG4gPT0gMCkgewogICAgICAgIHJldHVybiAxOyAvLyB0cnVlCiAgICB9CiAgICByZXR1cm4gaXNPZGRNdXR1YWwobiAtIDEpOwp9CgpmbiBpc09kZE11dHVhbChuOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobiA9PSAwKSB7CiAgICAgICAgcmV0dXJuIDA7IC8vIGZhbHNlCiAgICB9CiAgICByZXR1cm4gaXNFdmVuTXV0dWFsKG4gLSAxKTsKfQoKZm4gY291bnRFdmVuT2RkTXV0dWFsKGxpbWl0OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGNvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDw9IGxpbWl0KSB7CiAgICAgICAgaWYgKGlzRXZlbk11dHVhbChpKSA9PSAxKSB7CiAgICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcmV0dXJuIGNvdW50Owp9CgovLyBNdXR1YWwgcmVjdXJzaW9uOiBwaW5nLXBvbmcgcGF0dGVybgpmbiBwaW5nTXV0dWFsKG46IGkzMiwgYWRkX3ZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobiA8PSAwKSB7CiAgICAgICAgcmV0dXJuIGFkZF92YWx1ZTsKICAgIH0KICAgIHJldHVybiBwb25nTXV0dWFsKG4gLSAxLCBhZGRfdmFsdWUgKyAxKTsKfQoKZm4gcG9uZ011dHVhbChuOiBpMzIsIGFkZF92YWx1ZTogaTMyKSAtPiBpMzIgewogICAgaWYgKG4gPD0gMCkgewogICAgICAgIHJldHVybiBhZGRfdmFsdWU7CiAgICB9CiAgICByZXR1cm4gcGluZ011dHVhbChuIC0gMSwgYWRkX3ZhbHVlICsgMik7Cn0KCmZuIHBpbmdQb25nTXV0dWFsKG46IGkzMiwgc3RhcnRfd2l0aF9waW5nOiBib29sKSAtPiBpMzIgewogICAgaWYgKHN0YXJ0X3dpdGhfcGluZykgewogICAgICAgIHJldHVybiBwaW5nTXV0dWFsKG4sIDApOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gcG9uZ011dHVhbChuLCAwKTsKICAgIH0KfQoKLy8gTXV0dWFsIHJlY3Vyc2lvbjogc3RhdGUgbWFjaGluZSBwYXR0ZXJuCmZuIHN0YXRlTWFjaGluZUEobjogaTMyLCB2YWx1ZTogaTMyKSAtPiBpMzIgewogICAgaWYgKG4gPD0gMCkgewogICAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICAgIGlmIChuICUgMyA9PSAwKSB7CiAgICAgICAgcmV0dXJuIHN0YXRlTWFjaGluZUIobiAtIDEsIHZhbHVlICsgMTApOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gc3RhdGVNYWNoaW5lQyhuIC0gMSwgdmFsdWUgKyAxKTsKICAgIH0KfQoKZm4gc3RhdGVNYWNoaW5lQihuOiBpMzIsIHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobiA8PSAwKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQogICAgaWYgKG4gJSAyID09IDApIHsKICAgICAgICByZXR1cm4gc3RhdGVNYWNoaW5lQyhuIC0gMSwgdmFsdWUgKyA1KTsKICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHN0YXRlTWFjaGluZUEobiAtIDEsIHZhbHVlICsgMik7CiAgICB9Cn0KCmZuIHN0YXRlTWFjaGluZUMobjogaTMyLCB2YWx1ZTogaTMyKSAtPiBpMzIgewogICAgaWYgKG4gPD0gMCkgewogICAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KICAgIGlmIChuICUgNSA9PSAwKSB7CiAgICAgICAgcmV0dXJuIHN0YXRlTWFjaGluZUEobiAtIDEsIHZhbHVlICsgMjApOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gc3RhdGVNYWNoaW5lQihuIC0gMSwgdmFsdWUgKyAzKTsKICAgIH0KfQoKLy8gVGVzdCAzOiBUcmVlIFRyYXZlcnNhbCBBbGdvcml0aG1zCmZuIHRlc3RUcmVlVHJhdmVyc2FsQWxnb3JpdGhtcygpIHsKICAgIHByaW50bG5JbnQoMTQwNSk7IC8vIFN0YXJ0IHRyZWUgdHJhdmVyc2FsIHRlc3QKCiAgICAvLyBCdWlsZCBhIGJpbmFyeSB0cmVlIHN0cnVjdHVyZSB1c2luZyBhcnJheXMKICAgIGxldCBtdXQgdHJlZV9ub2RlczogW2kzMjsgMTI3XSA9IFswOyAxMjddOyAvLyBDb21wbGV0ZSBiaW5hcnkgdHJlZSB3aXRoIDcgbGV2ZWxzCiAgICBidWlsZEJpbmFyeVRyZWUodHJlZV9ub2Rlcyk7CgogICAgLy8gVGVzdCBkaWZmZXJlbnQgdHJhdmVyc2FsIG1ldGhvZHMKICAgIGxldCBwcmVvcmRlcl9zdW06IGkzMiA9IHByZW9yZGVyVHJhdmVyc2FsKHRyZWVfbm9kZXMsIDApOwogICAgcHJpbnRsbkludChwcmVvcmRlcl9zdW0pOwoKICAgIGxldCBpbm9yZGVyX3N1bTogaTMyID0gaW5vcmRlclRyYXZlcnNhbCh0cmVlX25vZGVzLCAwKTsKICAgIHByaW50bG5JbnQoaW5vcmRlcl9zdW0pOwoKICAgIGxldCBwb3N0b3JkZXJfc3VtOiBpMzIgPSBwb3N0b3JkZXJUcmF2ZXJzYWwodHJlZV9ub2RlcywgMCk7CiAgICBwcmludGxuSW50KHBvc3RvcmRlcl9zdW0pOwoKICAgIC8vIFRlc3QgdHJlZSBzZWFyY2ggb3BlcmF0aW9ucwogICAgbGV0IHNlYXJjaF9yZXN1bHQ6IGkzMiA9IHJlY3Vyc2l2ZVRyZWVTZWFyY2godHJlZV9ub2RlcywgMCwgNTApOwogICAgcHJpbnRsbkludChzZWFyY2hfcmVzdWx0KTsKCiAgICAvLyBUZXN0IHRyZWUgZGVwdGggY2FsY3VsYXRpb24KICAgIGxldCBkZXB0aF9yZXN1bHQ6IGkzMiA9IGNhbGN1bGF0ZVRyZWVEZXB0aCh0cmVlX25vZGVzLCAwKTsKICAgIHByaW50bG5JbnQoZGVwdGhfcmVzdWx0KTsKCiAgICBwcmludGxuSW50KDE0MDYpOyAvLyBFbmQgdHJlZSB0cmF2ZXJzYWwgdGVzdAp9CgovLyBCdWlsZCBiaW5hcnkgdHJlZSB3aXRoIHZhbHVlcwpmbiBidWlsZEJpbmFyeVRyZWUobXV0IHRyZWU6IFtpMzI7IDEyN10pIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgMTI3KSB7CiAgICAgICAgdHJlZVtpIGFzIHVzaXplXSA9IChpICsgMSkgKiAxMDsgLy8gU2ltcGxlIHZhbHVlIGFzc2lnbm1lbnQKICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIFByZW9yZGVyIHRyYXZlcnNhbCAocm9vdCwgbGVmdCwgcmlnaHQpCmZuIHByZW9yZGVyVHJhdmVyc2FsKHRyZWU6IFtpMzI7IDEyN10sIGluZGV4OiB1c2l6ZSkgLT4gaTMyIHsKICAgIGlmIChpbmRleCA+PSAxMjcgfHwgdHJlZVtpbmRleF0gPT0gMCkgewogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIGxldCBjdXJyZW50X3ZhbHVlOiBpMzIgPSB0cmVlW2luZGV4XTsKICAgIGxldCBsZWZ0X3N1bTogaTMyID0gcHJlb3JkZXJUcmF2ZXJzYWwodHJlZSwgMiAqIGluZGV4ICsgMSk7CiAgICBsZXQgcmlnaHRfc3VtOiBpMzIgPSBwcmVvcmRlclRyYXZlcnNhbCh0cmVlLCAyICogaW5kZXggKyAyKTsKCiAgICByZXR1cm4gY3VycmVudF92YWx1ZSArIGxlZnRfc3VtICsgcmlnaHRfc3VtOwp9CgovLyBJbm9yZGVyIHRyYXZlcnNhbCAobGVmdCwgcm9vdCwgcmlnaHQpCmZuIGlub3JkZXJUcmF2ZXJzYWwodHJlZTogW2kzMjsgMTI3XSwgaW5kZXg6IHVzaXplKSAtPiBpMzIgewogICAgaWYgKGluZGV4ID49IDEyNyB8fCB0cmVlW2luZGV4XSA9PSAwKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgbGV0IGxlZnRfc3VtOiBpMzIgPSBpbm9yZGVyVHJhdmVyc2FsKHRyZWUsIDIgKiBpbmRleCArIDEpOwogICAgbGV0IGN1cnJlbnRfdmFsdWU6IGkzMiA9IHRyZWVbaW5kZXhdOwogICAgbGV0IHJpZ2h0X3N1bTogaTMyID0gaW5vcmRlclRyYXZlcnNhbCh0cmVlLCAyICogaW5kZXggKyAyKTsKCiAgICByZXR1cm4gbGVmdF9zdW0gKyBjdXJyZW50X3ZhbHVlICsgcmlnaHRfc3VtOwp9CgovLyBQb3N0b3JkZXIgdHJhdmVyc2FsIChsZWZ0LCByaWdodCwgcm9vdCkKZm4gcG9zdG9yZGVyVHJhdmVyc2FsKHRyZWU6IFtpMzI7IDEyN10sIGluZGV4OiB1c2l6ZSkgLT4gaTMyIHsKICAgIGlmIChpbmRleCA+PSAxMjcgfHwgdHJlZVtpbmRleF0gPT0gMCkgewogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIGxldCBsZWZ0X3N1bTogaTMyID0gcG9zdG9yZGVyVHJhdmVyc2FsKHRyZWUsIDIgKiBpbmRleCArIDEpOwogICAgbGV0IHJpZ2h0X3N1bTogaTMyID0gcG9zdG9yZGVyVHJhdmVyc2FsKHRyZWUsIDIgKiBpbmRleCArIDIpOwogICAgbGV0IGN1cnJlbnRfdmFsdWU6IGkzMiA9IHRyZWVbaW5kZXhdOwoKICAgIHJldHVybiBsZWZ0X3N1bSArIHJpZ2h0X3N1bSArIGN1cnJlbnRfdmFsdWU7Cn0KCi8vIFJlY3Vyc2l2ZSB0cmVlIHNlYXJjaApmbiByZWN1cnNpdmVUcmVlU2VhcmNoKHRyZWU6IFtpMzI7IDEyN10sIGluZGV4OiB1c2l6ZSwgdGFyZ2V0OiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoaW5kZXggPj0gMTI3IHx8IHRyZWVbaW5kZXhdID09IDApIHsKICAgICAgICByZXR1cm4gMDsgLy8gTm90IGZvdW5kCiAgICB9CgogICAgaWYgKHRyZWVbaW5kZXhdID09IHRhcmdldCkgewogICAgICAgIHJldHVybiAxOyAvLyBGb3VuZAogICAgfQoKICAgIGxldCBsZWZ0X3Jlc3VsdDogaTMyID0gcmVjdXJzaXZlVHJlZVNlYXJjaCh0cmVlLCAyICogaW5kZXggKyAxLCB0YXJnZXQpOwogICAgaWYgKGxlZnRfcmVzdWx0ID09IDEpIHsKICAgICAgICByZXR1cm4gMTsKICAgIH0KCiAgICBsZXQgcmlnaHRfcmVzdWx0OiBpMzIgPSByZWN1cnNpdmVUcmVlU2VhcmNoKHRyZWUsIDIgKiBpbmRleCArIDIsIHRhcmdldCk7CiAgICByZXR1cm4gcmlnaHRfcmVzdWx0Owp9CgovLyBDYWxjdWxhdGUgdHJlZSBkZXB0aCByZWN1cnNpdmVseQpmbiBjYWxjdWxhdGVUcmVlRGVwdGgodHJlZTogW2kzMjsgMTI3XSwgaW5kZXg6IHVzaXplKSAtPiBpMzIgewogICAgaWYgKGluZGV4ID49IDEyNyB8fCB0cmVlW2luZGV4XSA9PSAwKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgbGV0IGxlZnRfZGVwdGg6IGkzMiA9IGNhbGN1bGF0ZVRyZWVEZXB0aCh0cmVlLCAyICogaW5kZXggKyAxKTsKICAgIGxldCByaWdodF9kZXB0aDogaTMyID0gY2FsY3VsYXRlVHJlZURlcHRoKHRyZWUsIDIgKiBpbmRleCArIDIpOwoKICAgIGlmIChsZWZ0X2RlcHRoID4gcmlnaHRfZGVwdGgpIHsKICAgICAgICBsZWZ0X2RlcHRoICsgMQogICAgfSBlbHNlIHsKICAgICAgICByaWdodF9kZXB0aCArIDEKICAgIH0KfQoKLy8gVGVzdCA0OiBEaXZpZGUgYW5kIENvbnF1ZXIgQWxnb3JpdGhtcwpmbiB0ZXN0RGl2aWRlQW5kQ29ucXVlckFsZ29yaXRobXMoKSB7CiAgICBwcmludGxuSW50KDE0MDcpOyAvLyBTdGFydCBkaXZpZGUgYW5kIGNvbnF1ZXIgdGVzdAoKICAgIC8vIFRlc3QgcmVjdXJzaXZlIG1lcmdlIHNvcnQKICAgIGxldCBtdXQgdGVzdF9hcnJheTogW2kzMjsgMTAwXSA9IFswOyAxMDBdOwogICAgaW5pdGlhbGl6ZVJhbmRvbUFycmF5KHRlc3RfYXJyYXksIDEwMCk7CiAgICBsZXQgc29ydF9yZXN1bHQ6IGkzMiA9IHJlY3Vyc2l2ZU1lcmdlU29ydCgmbXV0IHRlc3RfYXJyYXksIDAsIDk5KTsKICAgIHByaW50bG5JbnQoc29ydF9yZXN1bHQpOwoKICAgIC8vIFRlc3QgcmVjdXJzaXZlIGJpbmFyeSBzZWFyY2gKICAgIGxldCBzZWFyY2hfdGFyZ2V0OiBpMzIgPSA0MjsKICAgIGxldCBiaW5hcnlfc2VhcmNoX3Jlc3VsdDogaTMyID0gcmVjdXJzaXZlQmluYXJ5U2VhcmNoKCZ0ZXN0X2FycmF5LCAwLCA5OSwgc2VhcmNoX3RhcmdldCk7CiAgICBwcmludGxuSW50KGJpbmFyeV9zZWFyY2hfcmVzdWx0KTsKCiAgICAvLyBUZXN0IHJlY3Vyc2l2ZSBxdWljayBzZWxlY3QKICAgIGxldCBrdGhfZWxlbWVudDogaTMyID0gcmVjdXJzaXZlUXVpY2tTZWxlY3QoJm11dCB0ZXN0X2FycmF5LCAwLCA5OSwgNTApOwogICAgcHJpbnRsbkludChrdGhfZWxlbWVudCk7CgogICAgLy8gVGVzdCByZWN1cnNpdmUgbWF0cml4IG11bHRpcGxpY2F0aW9uCiAgICBsZXQgbWF0cml4X3Jlc3VsdDogaTMyID0gdGVzdFJlY3Vyc2l2ZU1hdHJpeE11bHRpcGxpY2F0aW9uKCk7CiAgICBwcmludGxuSW50KG1hdHJpeF9yZXN1bHQpOwoKICAgIHByaW50bG5JbnQoMTQwOCk7IC8vIEVuZCBkaXZpZGUgYW5kIGNvbnF1ZXIgdGVzdAp9CgovLyBJbml0aWFsaXplIGFycmF5IHdpdGggcHNldWRvLXJhbmRvbSB2YWx1ZXMKZm4gaW5pdGlhbGl6ZVJhbmRvbUFycmF5KG11dCBhcnI6IFtpMzI7IDEwMF0sIHNpemU6IHVzaXplKSB7CiAgICBsZXQgbXV0IHNlZWQ6IGkzMiA9IDEyMzQ1OwogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CgogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgc2VlZCA9IChzZWVkICogMTEwMyArIDQ3MjEpICUgMTA0ODU4MzsKICAgICAgICBpZiAoc2VlZCA8IDApIHsKICAgICAgICAgICAgc2VlZCA9IC1zZWVkOwogICAgICAgIH0KICAgICAgICBhcnJbaSBhcyB1c2l6ZV0gPSBzZWVkICUgMTAwMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIFJlY3Vyc2l2ZSBtZXJnZSBzb3J0CmZuIHJlY3Vyc2l2ZU1lcmdlU29ydChhcnI6ICZtdXQgW2kzMjsgMTAwXSwgbGVmdDogdXNpemUsIHJpZ2h0OiB1c2l6ZSkgLT4gaTMyIHsKICAgIGlmIChsZWZ0ID49IHJpZ2h0KSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgbGV0IG1pZDogdXNpemUgPSBsZWZ0ICsgKHJpZ2h0IC0gbGVmdCkgLyAyOwogICAgbGV0IGxlZnRfY29tcGFyaXNvbnM6IGkzMiA9IHJlY3Vyc2l2ZU1lcmdlU29ydChhcnIsIGxlZnQsIG1pZCk7CiAgICBsZXQgcmlnaHRfY29tcGFyaXNvbnM6IGkzMiA9IHJlY3Vyc2l2ZU1lcmdlU29ydChhcnIsIG1pZCArIDEsIHJpZ2h0KTsKICAgIGxldCBtZXJnZV9jb21wYXJpc29uczogaTMyID0gcmVjdXJzaXZlTWVyZ2UoYXJyLCBsZWZ0LCBtaWQsIHJpZ2h0KTsKCiAgICByZXR1cm4gbGVmdF9jb21wYXJpc29ucyArIHJpZ2h0X2NvbXBhcmlzb25zICsgbWVyZ2VfY29tcGFyaXNvbnM7Cn0KCi8vIFJlY3Vyc2l2ZSBtZXJnZSBvcGVyYXRpb24KZm4gcmVjdXJzaXZlTWVyZ2UoYXJyOiAmbXV0IFtpMzI7IDEwMF0sIGxlZnQ6IHVzaXplLCBtaWQ6IHVzaXplLCByaWdodDogdXNpemUpIC0+IGkzMiB7CiAgICBsZXQgbGVmdF9zaXplOiB1c2l6ZSA9IG1pZCAtIGxlZnQgKyAxOwogICAgbGV0IHJpZ2h0X3NpemU6IHVzaXplID0gcmlnaHQgLSBtaWQ7CgogICAgLy8gQ3JlYXRlIHRlbXBvcmFyeSBhcnJheXMKICAgIGxldCBtdXQgbGVmdF9hcnI6IFtpMzI7IDUwXSA9IFswOyA1MF07CiAgICBsZXQgbXV0IHJpZ2h0X2FycjogW2kzMjsgNTBdID0gWzA7IDUwXTsKCiAgICAvLyBDb3B5IGRhdGEgdG8gdGVtcG9yYXJ5IGFycmF5cwogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICB3aGlsZSAoaSA8IGxlZnRfc2l6ZSkgewogICAgICAgIGxlZnRfYXJyW2kgYXMgdXNpemVdID0gYXJyW2xlZnQgKyBpXTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgbGV0IG11dCBqOiB1c2l6ZSA9IDA7CiAgICB3aGlsZSAoaiA8IHJpZ2h0X3NpemUpIHsKICAgICAgICByaWdodF9hcnJbaiBhcyB1c2l6ZV0gPSBhcnJbbWlkICsgMSArIGpdOwogICAgICAgIGogPSBqICsgMTsKICAgIH0KCiAgICAvLyBNZXJnZSB0aGUgdGVtcG9yYXJ5IGFycmF5cyBiYWNrCiAgICBpID0gMDsKICAgIGogPSAwOwogICAgbGV0IG11dCBrOiB1c2l6ZSA9IGxlZnQ7CiAgICBsZXQgbXV0IGNvbXBhcmlzb25zOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDwgbGVmdF9zaXplICYmIGogPCByaWdodF9zaXplKSB7CiAgICAgICAgY29tcGFyaXNvbnMgPSBjb21wYXJpc29ucyArIDE7CiAgICAgICAgaWYgKGxlZnRfYXJyW2ldIDw9IHJpZ2h0X2FycltqXSkgewogICAgICAgICAgICBhcnJba10gPSBsZWZ0X2FycltpXTsKICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFycltrXSA9IHJpZ2h0X2FycltqXTsKICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBrID0gayArIDE7CiAgICB9CgogICAgLy8gQ29weSByZW1haW5pbmcgZWxlbWVudHMKICAgIHdoaWxlIChpIDwgbGVmdF9zaXplKSB7CiAgICAgICAgYXJyW2tdID0gbGVmdF9hcnJbaV07CiAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIGsgPSBrICsgMTsKICAgIH0KCiAgICB3aGlsZSAoaiA8IHJpZ2h0X3NpemUpIHsKICAgICAgICBhcnJba10gPSByaWdodF9hcnJbal07CiAgICAgICAgaiA9IGogKyAxOwogICAgICAgIGsgPSBrICsgMTsKICAgIH0KCiAgICByZXR1cm4gY29tcGFyaXNvbnM7Cn0KCi8vIFJlY3Vyc2l2ZSBiaW5hcnkgc2VhcmNoCmZuIHJlY3Vyc2l2ZUJpbmFyeVNlYXJjaChhcnI6ICZbaTMyOyAxMDBdLCBsZWZ0OiB1c2l6ZSwgcmlnaHQ6IHVzaXplLCB0YXJnZXQ6IGkzMikgLT4gaTMyIHsKICAgIGlmIChsZWZ0ID4gcmlnaHQpIHsKICAgICAgICByZXR1cm4gLTE7IC8vIE5vdCBmb3VuZAogICAgfQoKICAgIGxldCBtaWQ6IHVzaXplID0gbGVmdCArIChyaWdodCAtIGxlZnQpIC8gMjsKCiAgICBpZiAoYXJyW21pZF0gPT0gdGFyZ2V0KSB7CiAgICAgICAgcmV0dXJuIG1pZCBhcyBpMzI7CiAgICB9IGVsc2UgaWYgKGFyclttaWRdID4gdGFyZ2V0KSB7CiAgICAgICAgcmV0dXJuIHJlY3Vyc2l2ZUJpbmFyeVNlYXJjaChhcnIsIGxlZnQsIG1pZCAtIDEsIHRhcmdldCk7CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiByZWN1cnNpdmVCaW5hcnlTZWFyY2goYXJyLCBtaWQgKyAxLCByaWdodCwgdGFyZ2V0KTsKICAgIH0KfQoKLy8gUmVjdXJzaXZlIHF1aWNrIHNlbGVjdCBhbGdvcml0aG0KZm4gcmVjdXJzaXZlUXVpY2tTZWxlY3QoYXJyOiAmbXV0IFtpMzI7IDEwMF0sIGxlZnQ6IHVzaXplLCByaWdodDogdXNpemUsIGs6IHVzaXplKSAtPiBpMzIgewogICAgaWYgKGxlZnQgPT0gcmlnaHQpIHsKICAgICAgICByZXR1cm4gYXJyW2xlZnRdOwogICAgfQoKICAgIGxldCBwaXZvdF9pbmRleDogdXNpemUgPSByZWN1cnNpdmVQYXJ0aXRpb24oYXJyLCBsZWZ0LCByaWdodCk7CgogICAgaWYgKGsgPT0gcGl2b3RfaW5kZXgpIHsKICAgICAgICByZXR1cm4gYXJyW2tdOwogICAgfSBlbHNlIGlmIChrIDwgcGl2b3RfaW5kZXgpIHsKICAgICAgICByZXR1cm4gcmVjdXJzaXZlUXVpY2tTZWxlY3QoYXJyLCBsZWZ0LCBwaXZvdF9pbmRleCAtIDEsIGspOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gcmVjdXJzaXZlUXVpY2tTZWxlY3QoYXJyLCBwaXZvdF9pbmRleCArIDEsIHJpZ2h0LCBrKTsKICAgIH0KfQoKLy8gUmVjdXJzaXZlIHBhcnRpdGlvbiBmb3IgcXVpY2sgc2VsZWN0CmZuIHJlY3Vyc2l2ZVBhcnRpdGlvbihhcnI6ICZtdXQgW2kzMjsgMTAwXSwgbGVmdDogdXNpemUsIHJpZ2h0OiB1c2l6ZSkgLT4gdXNpemUgewogICAgbGV0IHBpdm90OiBpMzIgPSBhcnJbcmlnaHRdOwogICAgbGV0IG11dCBpOiB1c2l6ZSA9IGxlZnQ7CiAgICBsZXQgbXV0IGo6IHVzaXplID0gbGVmdDsKCiAgICB3aGlsZSAoaiA8IHJpZ2h0KSB7CiAgICAgICAgaWYgKGFycltqXSA8PSBwaXZvdCkgewogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgICAgIGxldCB0ZW1wOiBpMzIgPSBhcnJbaSAtIDFdOwogICAgICAgICAgICBhcnJbaSAtIDFdID0gYXJyW2pdOwogICAgICAgICAgICBhcnJbal0gPSB0ZW1wOwogICAgICAgIH0KICAgICAgICBqID0gaiArIDE7CiAgICB9CgogICAgbGV0IHRlbXA6IGkzMiA9IGFycltpXTsKICAgIGFycltpXSA9IGFycltyaWdodF07CiAgICBhcnJbcmlnaHRdID0gdGVtcDsKCiAgICByZXR1cm4gaTsKfQoKLy8gVGVzdCByZWN1cnNpdmUgbWF0cml4IG11bHRpcGxpY2F0aW9uCmZuIHRlc3RSZWN1cnNpdmVNYXRyaXhNdWx0aXBsaWNhdGlvbigpIC0+IGkzMiB7CiAgICBsZXQgbXV0IG1hdHJpeF9hOiBbaTMyOyAxNl0gPSBbMDsgMTZdOyAvLyA0eDQgbWF0cml4CiAgICBsZXQgbXV0IG1hdHJpeF9iOiBbaTMyOyAxNl0gPSBbMDsgMTZdOyAvLyA0eDQgbWF0cml4CiAgICBsZXQgbXV0IHJlc3VsdF9tYXRyaXg6IFtpMzI7IDE2XSA9IFswOyAxNl07IC8vIDR4NCByZXN1bHQKCiAgICAvLyBJbml0aWFsaXplIG1hdHJpY2VzCiAgICBpbml0aWFsaXplTWF0cml4KCZtdXQgbWF0cml4X2EsIDQpOwogICAgaW5pdGlhbGl6ZU1hdHJpeCgmbXV0IG1hdHJpeF9iLCA0KTsKCiAgICAvLyBQZXJmb3JtIHJlY3Vyc2l2ZSBtYXRyaXggbXVsdGlwbGljYXRpb24KICAgIHJlY3Vyc2l2ZU1hdHJpeE11bHRpcGx5KCZtYXRyaXhfYSwgJm1hdHJpeF9iLCAmbXV0IHJlc3VsdF9tYXRyaXgsIDQpOwoKICAgIC8vIENhbGN1bGF0ZSBzdW0gb2YgcmVzdWx0IG1hdHJpeAogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgIHdoaWxlIChpIDwgMTYpIHsKICAgICAgICBzdW0gPSBzdW0gKyByZXN1bHRfbWF0cml4W2ldOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gc3VtOwp9CgovLyBJbml0aWFsaXplIG1hdHJpeCB3aXRoIHZhbHVlcwpmbiBpbml0aWFsaXplTWF0cml4KG1hdHJpeDogJm11dCBbaTMyOyAxNl0sIHNpemU6IHVzaXplKSB7CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSAqIHNpemUpIHsKICAgICAgICBtYXRyaXhbaV0gPSAoaSAlIDEwKSBhcyBpMzIgKyAxOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gUmVjdXJzaXZlIG1hdHJpeCBtdWx0aXBsaWNhdGlvbgpmbiByZWN1cnNpdmVNYXRyaXhNdWx0aXBseSgKICAgIG1hdHJpeF9hOiAmW2kzMjsgMTZdLAogICAgbWF0cml4X2I6ICZbaTMyOyAxNl0sCiAgICByZXN1bHQ6ICZtdXQgW2kzMjsgMTZdLAogICAgc2l6ZTogdXNpemUsCikgewogICAgaWYgKHNpemUgPT0gMSkgewogICAgICAgIHJlc3VsdFswXSA9IG1hdHJpeF9hWzBdICogbWF0cml4X2JbMF07CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIEZvciBzaW1wbGljaXR5LCBpbXBsZW1lbnQgYmFzaWMgbXVsdGlwbGljYXRpb24gZm9yIHNtYWxsIG1hdHJpY2VzCiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGxldCBtdXQgajogdXNpemUgPSAwOwogICAgICAgIHdoaWxlIChqIDwgc2l6ZSkgewogICAgICAgICAgICByZXN1bHRbaSAqIHNpemUgKyBqXSA9IDA7CiAgICAgICAgICAgIGxldCBtdXQgazogdXNpemUgPSAwOwogICAgICAgICAgICB3aGlsZSAoayA8IHNpemUpIHsKICAgICAgICAgICAgICAgIHJlc3VsdFtpICogc2l6ZSArIGpdID0KICAgICAgICAgICAgICAgICAgICByZXN1bHRbaSAqIHNpemUgKyBqXSArIG1hdHJpeF9hW2kgKiBzaXplICsga10gKiBtYXRyaXhfYltrICogc2l6ZSArIGpdOwogICAgICAgICAgICAgICAgayA9IGsgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBUZXN0IDU6IFJlY3Vyc2l2ZSBNYXRoZW1hdGljYWwgQ29tcHV0YXRpb25zCmZuIHRlc3RSZWN1cnNpdmVNYXRoZW1hdGljYWxDb21wdXRhdGlvbnMoKSB7CiAgICBwcmludGxuSW50KDE0MDkpOyAvLyBTdGFydCByZWN1cnNpdmUgbWF0aCB0ZXN0CgogICAgLy8gVGVzdCByZWN1cnNpdmUgR0NEIGNvbXB1dGF0aW9uCiAgICBsZXQgZ2NkX3Jlc3VsdDogaTMyID0gcmVjdXJzaXZlR0NEKDEwNzEsIDQ2Mik7CiAgICBwcmludGxuSW50KGdjZF9yZXN1bHQpOwoKICAgIC8vIFRlc3QgcmVjdXJzaXZlIEZpYm9uYWNjaSBzZXF1ZW5jZQogICAgbGV0IGZpYm9uYWNjaV9yZXN1bHQ6IGkzMiA9IHJlY3Vyc2l2ZUZpYm9uYWNjaSgyNSk7CiAgICBwcmludGxuSW50KGZpYm9uYWNjaV9yZXN1bHQpOwoKICAgIC8vIFRlc3QgcmVjdXJzaXZlIGNvbWJpbmF0b3JpY3MKICAgIGxldCBjb21iaW5hdGlvbl9yZXN1bHQ6IGkzMiA9IHJlY3Vyc2l2ZUNvbWJpbmF0aW9uKDEwLCA1KTsKICAgIHByaW50bG5JbnQoY29tYmluYXRpb25fcmVzdWx0KTsKCiAgICAvLyBUZXN0IHJlY3Vyc2l2ZSBudW1iZXIgdGhlb3J5IGZ1bmN0aW9ucwogICAgbGV0IHN1bV9vZl9kaXZpc29yczogaTMyID0gcmVjdXJzaXZlU3VtT2ZEaXZpc29ycyg2MCk7CiAgICBwcmludGxuSW50KHN1bV9vZl9kaXZpc29ycyk7CgogICAgLy8gVGVzdCByZWN1cnNpdmUgZGlnaXQgb3BlcmF0aW9ucwogICAgbGV0IGRpZ2l0X3N1bTogaTMyID0gcmVjdXJzaXZlRGlnaXRTdW0oMTIzNDU2Nzg5KTsKICAgIHByaW50bG5JbnQoZGlnaXRfc3VtKTsKCiAgICBwcmludGxuSW50KDE0MTApOyAvLyBFbmQgcmVjdXJzaXZlIG1hdGggdGVzdAp9CgovLyBSZWN1cnNpdmUgR0NEIHVzaW5nIEV1Y2xpZGVhbiBhbGdvcml0aG0KZm4gcmVjdXJzaXZlR0NEKGE6IGkzMiwgYjogaTMyKSAtPiBpMzIgewogICAgaWYgKGIgPT0gMCkgewogICAgICAgIHJldHVybiBhOwogICAgfQogICAgcmV0dXJuIHJlY3Vyc2l2ZUdDRChiLCBhICUgYik7Cn0KCi8vIFJlY3Vyc2l2ZSBGaWJvbmFjY2kgKGluZWZmaWNpZW50IGJ1dCB0ZXN0cyBkZWVwIHJlY3Vyc2lvbikKZm4gcmVjdXJzaXZlRmlib25hY2NpKG46IGkzMikgLT4gaTMyIHsKICAgIGlmIChuIDw9IDEpIHsKICAgICAgICByZXR1cm4gbjsKICAgIH0KICAgIHJldHVybiByZWN1cnNpdmVGaWJvbmFjY2kobiAtIDEpICsgcmVjdXJzaXZlRmlib25hY2NpKG4gLSAyKTsKfQoKLy8gUmVjdXJzaXZlIGNvbWJpbmF0aW9uIGNhbGN1bGF0aW9uIChuIGNob29zZSBrKQpmbiByZWN1cnNpdmVDb21iaW5hdGlvbihuOiBpMzIsIGs6IGkzMikgLT4gaTMyIHsKICAgIGlmIChrID09IDAgfHwgayA9PSBuKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CiAgICBpZiAoayA9PSAxKSB7CiAgICAgICAgcmV0dXJuIG47CiAgICB9CiAgICByZXR1cm4gcmVjdXJzaXZlQ29tYmluYXRpb24obiAtIDEsIGsgLSAxKSArIHJlY3Vyc2l2ZUNvbWJpbmF0aW9uKG4gLSAxLCBrKTsKfQoKLy8gUmVjdXJzaXZlIHN1bSBvZiBkaXZpc29ycwpmbiByZWN1cnNpdmVTdW1PZkRpdmlzb3JzKG46IGkzMikgLT4gaTMyIHsKICAgIHJldHVybiByZWN1cnNpdmVTdW1PZkRpdmlzb3JzSGVscGVyKG4sIDEsIDApOwp9CgpmbiByZWN1cnNpdmVTdW1PZkRpdmlzb3JzSGVscGVyKG46IGkzMiwgY3VycmVudDogaTMyLCBzdW06IGkzMikgLT4gaTMyIHsKICAgIGlmIChjdXJyZW50ID4gbikgewogICAgICAgIHJldHVybiBzdW07CiAgICB9CgogICAgaWYgKG4gJSBjdXJyZW50ID09IDApIHsKICAgICAgICByZXR1cm4gcmVjdXJzaXZlU3VtT2ZEaXZpc29yc0hlbHBlcihuLCBjdXJyZW50ICsgMSwgc3VtICsgY3VycmVudCk7CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiByZWN1cnNpdmVTdW1PZkRpdmlzb3JzSGVscGVyKG4sIGN1cnJlbnQgKyAxLCBzdW0pOwogICAgfQp9CgovLyBSZWN1cnNpdmUgZGlnaXQgc3VtCmZuIHJlY3Vyc2l2ZURpZ2l0U3VtKG46IGkzMikgLT4gaTMyIHsKICAgIGlmIChuIDwgMTApIHsKICAgICAgICByZXR1cm4gbjsKICAgIH0KICAgIHJldHVybiAobiAlIDEwKSArIHJlY3Vyc2l2ZURpZ2l0U3VtKG4gLyAxMCk7Cn0KCi8vIEFkZGl0aW9uYWwgcmVjdXJzaXZlIGhlbHBlciBmdW5jdGlvbnMgZm9yIGNvbXByZWhlbnNpdmUgdGVzdGluZwpmbiByZWN1cnNpdmVBcnJheVN1bShhcnI6IFtpMzI7IDEwMF0sIGluZGV4OiB1c2l6ZSwgc2l6ZTogdXNpemUpIC0+IGkzMiB7CiAgICBpZiAoaW5kZXggPj0gc2l6ZSkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgcmV0dXJuIGFycltpbmRleF0gKyByZWN1cnNpdmVBcnJheVN1bShhcnIsIGluZGV4ICsgMSwgc2l6ZSk7Cn0KCmZuIHJlY3Vyc2l2ZUFycmF5TWF4KGFycjogW2kzMjsgMTAwXSwgaW5kZXg6IHVzaXplLCBzaXplOiB1c2l6ZSwgY3VycmVudF9tYXg6IGkzMikgLT4gaTMyIHsKICAgIGlmIChpbmRleCA+PSBzaXplKSB7CiAgICAgICAgcmV0dXJuIGN1cnJlbnRfbWF4OwogICAgfQoKICAgIGxldCBuZXdfbWF4OiBpMzIgPSBpZiAoYXJyW2luZGV4XSA+IGN1cnJlbnRfbWF4KSB7CiAgICAgICAgYXJyW2luZGV4XQogICAgfSBlbHNlIHsKICAgICAgICBjdXJyZW50X21heAogICAgfTsKCiAgICByZXR1cm4gcmVjdXJzaXZlQXJyYXlNYXgoYXJyLCBpbmRleCArIDEsIHNpemUsIG5ld19tYXgpOwp9CgpmbiByZWN1cnNpdmVTdHJpbmdMZW5ndGgodmFsdWU6IGkzMiwgbGVuZ3RoOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAodmFsdWUgPCAxMCkgewogICAgICAgIHJldHVybiBsZW5ndGggKyAxOwogICAgfQogICAgcmV0dXJuIHJlY3Vyc2l2ZVN0cmluZ0xlbmd0aCh2YWx1ZSAvIDEwLCBsZW5ndGggKyAxKTsKfQoKZm4gcmVjdXJzaXZlSXNQYWxpbmRyb21lKG46IGkzMiwgcmV2ZXJzZWQ6IGkzMiwgb3JpZ2luYWw6IGkzMikgLT4gaTMyIHsKICAgIGlmIChuID09IDApIHsKICAgICAgICBpZiAocmV2ZXJzZWQgPT0gb3JpZ2luYWwpIHsKICAgICAgICAgICAgcmV0dXJuIDE7IC8vIHRydWUKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gMDsgLy8gZmFsc2UKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gcmVjdXJzaXZlSXNQYWxpbmRyb21lKG4gLyAxMCwgcmV2ZXJzZWQgKiAxMCArIChuICUgMTApLCBvcmlnaW5hbCk7Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (5, "comprehensive5", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCA1OiBNZW1vcnkgQWNjZXNzIFBhdHRlcm5zIGFuZCBDYWNoZSBPcHRpbWl6YXRpb24KU3VtbWFyeTogVGhpcyB0ZXN0IGZvY3VzZXMgb24gY29tcGlsZXIgb3B0aW1pemF0aW9uIG9mOgpEZXRhaWxzOgpNZW1vcnkgYWNjZXNzIHBhdHRlcm4gb3B0aW1pemF0aW9uCkNhY2hlLWZyaWVuZGx5IGRhdGEgbGF5b3V0ClNwYXRpYWwgYW5kIHRlbXBvcmFsIGxvY2FsaXR5IG9wdGltaXphdGlvbgpBcnJheSBzdHJpZGUgcGF0dGVybiBvcHRpbWl6YXRpb24KTWVtb3J5IHByZWZldGNoaW5nIG9wcG9ydHVuaXRpZXMKRGF0YSBzdHJ1Y3R1cmUgcGFja2luZyBhbmQgYWxpZ25tZW50CiovCgovLyBjb21wcmVoZW5zaXZlNS5yeCAtIENvbXByZWhlbnNpdmUgVGVzdCA1OiBNZW1vcnkgQWNjZXNzIFBhdHRlcm5zIGFuZCBDYWNoZSBPcHRpbWl6YXRpb24KLy8gVGhpcyB0ZXN0IGZvY3VzZXMgb24gY29tcGlsZXIgb3B0aW1pemF0aW9uIG9mOgovLyAtIE1lbW9yeSBhY2Nlc3MgcGF0dGVybiBvcHRpbWl6YXRpb24KLy8gLSBDYWNoZS1mcmllbmRseSBkYXRhIGxheW91dAovLyAtIFNwYXRpYWwgYW5kIHRlbXBvcmFsIGxvY2FsaXR5IG9wdGltaXphdGlvbgovLyAtIEFycmF5IHN0cmlkZSBwYXR0ZXJuIG9wdGltaXphdGlvbgovLyAtIE1lbW9yeSBwcmVmZXRjaGluZyBvcHBvcnR1bml0aWVzCi8vIC0gRGF0YSBzdHJ1Y3R1cmUgcGFja2luZyBhbmQgYWxpZ25tZW50CgpmbiBtYWluKCkgewogICAgLy8gUGVyZm9ybWFuY2UgdGVzdCBtYXJrZXIgLSBzdGFydAogICAgcHJpbnRsbkludCgxNTAwKTsKCiAgICAvLyBUZXN0IDE6IFNlcXVlbnRpYWwgdnMgcmFuZG9tIG1lbW9yeSBhY2Nlc3MgcGF0dGVybnMKICAgIC8vIFRlc3RzIGNvbXBpbGVyJ3MgYWJpbGl0eSB0byBvcHRpbWl6ZSBkaWZmZXJlbnQgYWNjZXNzIHBhdHRlcm5zCiAgICB0ZXN0TWVtb3J5QWNjZXNzUGF0dGVybnMoKTsKCiAgICAvLyBUZXN0IDI6IE11bHRpLWRpbWVuc2lvbmFsIGFycmF5IGFjY2VzcyBvcHRpbWl6YXRpb24KICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBuZXN0ZWQgYXJyYXkgYWNjZXNzIHBhdHRlcm5zCiAgICB0ZXN0TXVsdGlEaW1lbnNpb25hbEFycmF5QWNjZXNzKCk7CgogICAgLy8gVGVzdCAzOiBTdHJ1Y3R1cmUgb2YgYXJyYXlzIHZzIGFycmF5IG9mIHN0cnVjdHVyZXMKICAgIC8vIFRlc3RzIGRhdGEgbGF5b3V0IG9wdGltaXphdGlvbiBkZWNpc2lvbnMKICAgIHRlc3REYXRhTGF5b3V0T3B0aW1pemF0aW9uKCk7CgogICAgLy8gVGVzdCA0OiBNZW1vcnkgc3RyaWRlIHBhdHRlcm4gYW5hbHlzaXMKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBmb3IgZGlmZmVyZW50IHN0cmlkZSBwYXR0ZXJucwogICAgdGVzdE1lbW9yeVN0cmlkZVBhdHRlcm5zKCk7CgogICAgLy8gVGVzdCA1OiBDYWNoZS1jb25zY2lvdXMgYWxnb3JpdGhtcwogICAgLy8gVGVzdHMgaW1wbGVtZW50YXRpb24gb2YgY2FjaGUtYXdhcmUgYWxnb3JpdGhtcwogICAgdGVzdENhY2hlQ29uc2Npb3VzQWxnb3JpdGhtcygpOwoKICAgIC8vIFBlcmZvcm1hbmNlIHRlc3QgbWFya2VyIC0gZW5kCiAgICBwcmludGxuSW50KDE1OTkpOwogICAgZXhpdCgwKTsKfQoKLy8gVGVzdCAxOiBNZW1vcnkgQWNjZXNzIFBhdHRlcm5zCmZuIHRlc3RNZW1vcnlBY2Nlc3NQYXR0ZXJucygpIHsKICAgIHByaW50bG5JbnQoMTUwMSk7IC8vIFN0YXJ0IG1lbW9yeSBhY2Nlc3MgdGVzdAoKICAgIGxldCBtdXQgbGFyZ2VfYXJyYXk6IFtpMzI7IDQwOTZdID0gWzA7IDQwOTZdOwogICAgaW5pdGlhbGl6ZUxhcmdlQXJyYXkoJm11dCBsYXJnZV9hcnJheSk7CgogICAgLy8gVGVzdCBzZXF1ZW50aWFsIGFjY2VzcyBwYXR0ZXJuCiAgICBsZXQgc2VxdWVudGlhbF9zdW06IGkzMiA9IHNlcXVlbnRpYWxBY2Nlc3MoJm11dCBsYXJnZV9hcnJheSk7CiAgICBwcmludGxuSW50KHNlcXVlbnRpYWxfc3VtKTsKCiAgICAvLyBUZXN0IHN0cmlkZWQgYWNjZXNzIHBhdHRlcm4KICAgIGxldCBzdHJpZGVkX3N1bTogaTMyID0gc3RyaWRlZEFjY2VzcygmbXV0IGxhcmdlX2FycmF5LCA4KTsKICAgIHByaW50bG5JbnQoc3RyaWRlZF9zdW0pOwoKICAgIC8vIFRlc3QgcmFuZG9tIGFjY2VzcyBwYXR0ZXJuCiAgICBsZXQgcmFuZG9tX3N1bTogaTMyID0gcmFuZG9tQWNjZXNzKCZtdXQgbGFyZ2VfYXJyYXkpOwogICAgcHJpbnRsbkludChyYW5kb21fc3VtKTsKCiAgICAvLyBUZXN0IGJhY2t3YXJkIGFjY2VzcyBwYXR0ZXJuCiAgICBsZXQgYmFja3dhcmRfc3VtOiBpMzIgPSBiYWNrd2FyZEFjY2VzcygmbXV0IGxhcmdlX2FycmF5KTsKICAgIHByaW50bG5JbnQoYmFja3dhcmRfc3VtKTsKCiAgICBwcmludGxuSW50KDE1MDIpOyAvLyBFbmQgbWVtb3J5IGFjY2VzcyB0ZXN0Cn0KCi8vIEluaXRpYWxpemUgbGFyZ2UgYXJyYXkgd2l0aCBwYXR0ZXJuCmZuIGluaXRpYWxpemVMYXJnZUFycmF5KGFycjogJm11dCBbaTMyOyA0MDk2XSkgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgbGV0IG11dCBzZWVkOiBpMzIgPSA5ODc2NTsKCiAgICB3aGlsZSAoaSA8IDQwOTYpIHsKICAgICAgICBzZWVkID0gKHNlZWQgKiAxMTAzICsgNDcyMSkgJSAxMDQ4NTgzOwogICAgICAgIGlmIChzZWVkIDwgMCkgewogICAgICAgICAgICBzZWVkID0gLXNlZWQ7CiAgICAgICAgfQogICAgICAgIGFycltpIGFzIHVzaXplXSA9IHNlZWQgJSAxMDAwOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gU2VxdWVudGlhbCBtZW1vcnkgYWNjZXNzIHBhdHRlcm4KZm4gc2VxdWVudGlhbEFjY2VzcyhhcnI6ICZtdXQgW2kzMjsgNDA5Nl0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICAvLyBBY2Nlc3MgZWxlbWVudHMgaW4gb3JkZXIgLSBjYWNoZSBmcmllbmRseQogICAgd2hpbGUgKGkgPCA0MDk2KSB7CiAgICAgICAgc3VtID0gc3VtICsgYXJyW2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gc3VtOwp9CgovLyBTdHJpZGVkIG1lbW9yeSBhY2Nlc3MgcGF0dGVybgpmbiBzdHJpZGVkQWNjZXNzKGFycjogJm11dCBbaTMyOyA0MDk2XSwgc3RyaWRlOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICAvLyBBY2Nlc3MgZWxlbWVudHMgd2l0aCBmaXhlZCBzdHJpZGUKICAgIHdoaWxlIChpIDwgNDA5NikgewogICAgICAgIHN1bSA9IHN1bSArIGFycltpIGFzIHVzaXplXTsKICAgICAgICBpID0gaSArIHN0cmlkZTsKICAgIH0KCiAgICByZXR1cm4gc3VtOwp9CgovLyBSYW5kb20gbWVtb3J5IGFjY2VzcyBwYXR0ZXJuCmZuIHJhbmRvbUFjY2VzcyhhcnI6ICZtdXQgW2kzMjsgNDA5Nl0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIGxldCBtdXQgc2VlZDogaTMyID0gNTQzMjE7CiAgICBsZXQgbXV0IGl0ZXJhdGlvbjogaTMyID0gMDsKCiAgICAvLyBBY2Nlc3MgZWxlbWVudHMgaW4gcHNldWRvLXJhbmRvbSBvcmRlciAtIGNhY2hlIHVuZnJpZW5kbHkKICAgIHdoaWxlIChpdGVyYXRpb24gPCAxMDAwKSB7CiAgICAgICAgc2VlZCA9IChzZWVkICogMTEwMyArIDQ3MjEpICUgMTA0ODU4MzsKICAgICAgICBpZiAoc2VlZCA8IDApIHsKICAgICAgICAgICAgc2VlZCA9IC1zZWVkOwogICAgICAgIH0KICAgICAgICBsZXQgaW5kZXg6IGkzMiA9IHNlZWQgJSA0MDk2OwogICAgICAgIHN1bSA9IHN1bSArIGFycltpbmRleCBhcyB1c2l6ZV07CiAgICAgICAgaXRlcmF0aW9uID0gaXRlcmF0aW9uICsgMTsKICAgIH0KCiAgICByZXR1cm4gc3VtOwp9CgovLyBCYWNrd2FyZCBtZW1vcnkgYWNjZXNzIHBhdHRlcm4KZm4gYmFja3dhcmRBY2Nlc3MoYXJyOiAmbXV0IFtpMzI7IDQwOTZdKSAtPiBpMzIgewogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDQwOTU7CgogICAgLy8gQWNjZXNzIGVsZW1lbnRzIGluIHJldmVyc2Ugb3JkZXIKICAgIHdoaWxlIChpID49IDApIHsKICAgICAgICBzdW0gPSBzdW0gKyBhcnJbaSBhcyB1c2l6ZV07CiAgICAgICAgaSA9IGkgLSAxOwogICAgfQoKICAgIHJldHVybiBzdW07Cn0KCi8vIFRlc3QgMjogTXVsdGktRGltZW5zaW9uYWwgQXJyYXkgQWNjZXNzCmZuIHRlc3RNdWx0aURpbWVuc2lvbmFsQXJyYXlBY2Nlc3MoKSB7CiAgICBwcmludGxuSW50KDE1MDMpOyAvLyBTdGFydCBtdWx0aS1kaW1lbnNpb25hbCB0ZXN0CgogICAgbGV0IG11dCBtYXRyaXg6IFtpMzI7IDEwMjRdID0gWzA7IDEwMjRdOyAvLyAzMngzMiBtYXRyaXgKICAgIGluaXRpYWxpemVNYXRyaXgzMngzMigmbXV0IG1hdHJpeCk7CgogICAgLy8gVGVzdCByb3ctbWFqb3IgYWNjZXNzIHBhdHRlcm4KICAgIGxldCByb3dfbWFqb3Jfc3VtOiBpMzIgPSByb3dNYWpvckFjY2VzcygmbWF0cml4KTsKICAgIHByaW50bG5JbnQocm93X21ham9yX3N1bSk7CgogICAgLy8gVGVzdCBjb2x1bW4tbWFqb3IgYWNjZXNzIHBhdHRlcm4KICAgIGxldCBjb2x1bW5fbWFqb3Jfc3VtOiBpMzIgPSBjb2x1bW5NYWpvckFjY2VzcygmbWF0cml4KTsKICAgIHByaW50bG5JbnQoY29sdW1uX21ham9yX3N1bSk7CgogICAgLy8gVGVzdCBkaWFnb25hbCBhY2Nlc3MgcGF0dGVybgogICAgbGV0IGRpYWdvbmFsX3N1bTogaTMyID0gZGlhZ29uYWxBY2Nlc3MoJm1hdHJpeCk7CiAgICBwcmludGxuSW50KGRpYWdvbmFsX3N1bSk7CgogICAgLy8gVGVzdCBibG9jayBhY2Nlc3MgcGF0dGVybgogICAgbGV0IGJsb2NrX3N1bTogaTMyID0gYmxvY2tBY2Nlc3MoJm1hdHJpeCk7CiAgICBwcmludGxuSW50KGJsb2NrX3N1bSk7CgogICAgcHJpbnRsbkludCgxNTA0KTsgLy8gRW5kIG11bHRpLWRpbWVuc2lvbmFsIHRlc3QKfQoKLy8gSW5pdGlhbGl6ZSAzMngzMiBtYXRyaXgKZm4gaW5pdGlhbGl6ZU1hdHJpeDMyeDMyKG1hdHJpeDogJm11dCBbaTMyOyAxMDI0XSkgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAzMikgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IDMyKSB7CiAgICAgICAgICAgIG1hdHJpeFsoaSAqIDMyICsgaikgYXMgdXNpemVdID0gKGkgKyAxKSAqIChqICsgMSk7CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBSb3ctbWFqb3IgYWNjZXNzIHBhdHRlcm4gKGNhY2hlIGZyaWVuZGx5KQpmbiByb3dNYWpvckFjY2VzcyhtYXRyaXg6ICZbaTMyOyAxMDI0XSkgLT4gaTMyIHsKICAgIGxldCBtdXQgc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDwgMzIpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCAzMikgewogICAgICAgICAgICBzdW0gPSBzdW0gKyBtYXRyaXhbKGkgKiAzMiArIGopIGFzIHVzaXplXTsKICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcmV0dXJuIHN1bTsKfQoKLy8gQ29sdW1uLW1ham9yIGFjY2VzcyBwYXR0ZXJuIChjYWNoZSB1bmZyaWVuZGx5KQpmbiBjb2x1bW5NYWpvckFjY2VzcyhtYXRyaXg6ICZbaTMyOyAxMDI0XSkgLT4gaTMyIHsKICAgIGxldCBtdXQgc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBqOiBpMzIgPSAwOwoKICAgIHdoaWxlIChqIDwgMzIpIHsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCAzMikgewogICAgICAgICAgICBzdW0gPSBzdW0gKyBtYXRyaXhbKGkgKiAzMiArIGopIGFzIHVzaXplXTsKICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KICAgICAgICBqID0gaiArIDE7CiAgICB9CgogICAgcmV0dXJuIHN1bTsKfQoKLy8gRGlhZ29uYWwgYWNjZXNzIHBhdHRlcm4KZm4gZGlhZ29uYWxBY2Nlc3MobWF0cml4OiAmW2kzMjsgMTAyNF0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICAvLyBNYWluIGRpYWdvbmFsCiAgICB3aGlsZSAoaSA8IDMyKSB7CiAgICAgICAgc3VtID0gc3VtICsgbWF0cml4WyhpICogMzIgKyBpKSBhcyB1c2l6ZV07CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIEFudGktZGlhZ29uYWwKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCAzMikgewogICAgICAgIHN1bSA9IHN1bSArIG1hdHJpeFsoaSAqIDMyICsgKDMxIC0gaSkpIGFzIHVzaXplXTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcmV0dXJuIHN1bTsKfQoKLy8gQmxvY2sgYWNjZXNzIHBhdHRlcm4gKGNhY2hlLWNvbnNjaW91cykKZm4gYmxvY2tBY2Nlc3MobWF0cml4OiAmW2kzMjsgMTAyNF0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIGxldCBibG9ja19zaXplOiBpMzIgPSA4OwogICAgbGV0IG11dCBibG9ja19pOiBpMzIgPSAwOwoKICAgIHdoaWxlIChibG9ja19pIDwgMzIpIHsKICAgICAgICBsZXQgbXV0IGJsb2NrX2o6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGJsb2NrX2ogPCAzMikgewogICAgICAgICAgICAvLyBQcm9jZXNzIDh4OCBibG9jawogICAgICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IGJsb2NrX2k7CiAgICAgICAgICAgIGxldCBlbmRfaTogaTMyID0gYmxvY2tfaSArIGJsb2NrX3NpemU7CiAgICAgICAgICAgIHdoaWxlIChpIDwgZW5kX2kgJiYgaSA8IDMyKSB7CiAgICAgICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IGJsb2NrX2o7CiAgICAgICAgICAgICAgICBsZXQgZW5kX2o6IGkzMiA9IGJsb2NrX2ogKyBibG9ja19zaXplOwogICAgICAgICAgICAgICAgd2hpbGUgKGogPCBlbmRfaiAmJiBqIDwgMzIpIHsKICAgICAgICAgICAgICAgICAgICBzdW0gPSBzdW0gKyBtYXRyaXhbKGkgKiAzMiArIGopIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYmxvY2tfaiA9IGJsb2NrX2ogKyBibG9ja19zaXplOwogICAgICAgIH0KICAgICAgICBibG9ja19pID0gYmxvY2tfaSArIGJsb2NrX3NpemU7CiAgICB9CgogICAgcmV0dXJuIHN1bTsKfQoKLy8gVGVzdCAzOiBEYXRhIExheW91dCBPcHRpbWl6YXRpb24KZm4gdGVzdERhdGFMYXlvdXRPcHRpbWl6YXRpb24oKSB7CiAgICBwcmludGxuSW50KDE1MDUpOyAvLyBTdGFydCBkYXRhIGxheW91dCB0ZXN0CgogICAgLy8gVGVzdCBTdHJ1Y3R1cmUgb2YgQXJyYXlzIChTb0EpIGxheW91dAogICAgbGV0IHNvYV9yZXN1bHQ6IGkzMiA9IHRlc3RTdHJ1Y3R1cmVPZkFycmF5cygpOwogICAgcHJpbnRsbkludChzb2FfcmVzdWx0KTsKCiAgICAvLyBUZXN0IEFycmF5IG9mIFN0cnVjdHVyZXMgKEFvUykgbGF5b3V0IHNpbXVsYXRpb24KICAgIGxldCBhb3NfcmVzdWx0OiBpMzIgPSB0ZXN0QXJyYXlPZlN0cnVjdHVyZXMoKTsKICAgIHByaW50bG5JbnQoYW9zX3Jlc3VsdCk7CgogICAgLy8gVGVzdCBoeWJyaWQgZGF0YSBsYXlvdXQKICAgIGxldCBoeWJyaWRfcmVzdWx0OiBpMzIgPSB0ZXN0SHlicmlkRGF0YUxheW91dCgpOwogICAgcHJpbnRsbkludChoeWJyaWRfcmVzdWx0KTsKCiAgICBwcmludGxuSW50KDE1MDYpOyAvLyBFbmQgZGF0YSBsYXlvdXQgdGVzdAp9CgovLyBTdHJ1Y3R1cmUgb2YgQXJyYXlzIGxheW91dCAoY2FjaGUtZnJpZW5kbHkgZm9yIHNwZWNpZmljIG9wZXJhdGlvbnMpCmZuIHRlc3RTdHJ1Y3R1cmVPZkFycmF5cygpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHhfY29vcmRzOiBbaTMyOyAxMDAwXSA9IFswOyAxMDAwXTsKICAgIGxldCBtdXQgeV9jb29yZHM6IFtpMzI7IDEwMDBdID0gWzA7IDEwMDBdOwogICAgbGV0IG11dCB6X2Nvb3JkczogW2kzMjsgMTAwMF0gPSBbMDsgMTAwMF07CgogICAgLy8gSW5pdGlhbGl6ZSBjb29yZGluYXRlcwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAxMDAwKSB7CiAgICAgICAgeF9jb29yZHNbaSBhcyB1c2l6ZV0gPSBpOwogICAgICAgIHlfY29vcmRzW2kgYXMgdXNpemVdID0gaSAqIDI7CiAgICAgICAgel9jb29yZHNbaSBhcyB1c2l6ZV0gPSBpICogMzsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gUGVyZm9ybSBvcGVyYXRpb25zIHRoYXQgYmVuZWZpdCBmcm9tIFNvQSBsYXlvdXQKICAgIGxldCBtdXQgc3VtX3g6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHN1bV95OiBpMzIgPSAwOwogICAgbGV0IG11dCBzdW1fejogaTMyID0gMDsKCiAgICAvLyBQcm9jZXNzIGFsbCBYIGNvb3JkaW5hdGVzIChnb29kIGNhY2hlIGxvY2FsaXR5KQogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDEwMDApIHsKICAgICAgICBzdW1feCA9IHN1bV94ICsgeF9jb29yZHNbaSBhcyB1c2l6ZV0gKiAyOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBQcm9jZXNzIGFsbCBZIGNvb3JkaW5hdGVzIChnb29kIGNhY2hlIGxvY2FsaXR5KQogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDEwMDApIHsKICAgICAgICBzdW1feSA9IHN1bV95ICsgeV9jb29yZHNbaSBhcyB1c2l6ZV0gKiAzOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBQcm9jZXNzIGFsbCBaIGNvb3JkaW5hdGVzIChnb29kIGNhY2hlIGxvY2FsaXR5KQogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDEwMDApIHsKICAgICAgICBzdW1feiA9IHN1bV96ICsgel9jb29yZHNbaSBhcyB1c2l6ZV0gKiA0OwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gc3VtX3ggKyBzdW1feSArIHN1bV96Owp9CgovLyBBcnJheSBvZiBTdHJ1Y3R1cmVzIGxheW91dCBzaW11bGF0aW9uICh1c2luZyBpbnRlcmxlYXZlZCBhcnJheSkKZm4gdGVzdEFycmF5T2ZTdHJ1Y3R1cmVzKCkgLT4gaTMyIHsKICAgIGxldCBtdXQgYW9zX2RhdGE6IFtpMzI7IDMwMDBdID0gWzA7IDMwMDBdOyAvLyB4LCB5LCB6IGludGVybGVhdmVkCgogICAgLy8gSW5pdGlhbGl6ZSBBb1MgZGF0YSAoeCwgeSwgeiwgeCwgeSwgeiwgLi4uKQogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAxMDAwKSB7CiAgICAgICAgYW9zX2RhdGFbKGkgKiAzKSBhcyB1c2l6ZV0gPSBpOyAvLyB4CiAgICAgICAgYW9zX2RhdGFbKGkgKiAzICsgMSkgYXMgdXNpemVdID0gaSAqIDI7IC8vIHkKICAgICAgICBhb3NfZGF0YVsoaSAqIDMgKyAyKSBhcyB1c2l6ZV0gPSBpICogMzsgLy8gegogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBQZXJmb3JtIG9wZXJhdGlvbnMgb24gQW9TIGxheW91dAogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CgogICAgLy8gUHJvY2VzcyBlYWNoIHN0cnVjdHVyZSAocG9vciBjYWNoZSBsb2NhbGl0eSBmb3Igc2luZ2xlIGNvbXBvbmVudCBvcGVyYXRpb25zKQogICAgaSA9IDA7CiAgICBjb25zdCBNOiBpMzIgPSAxMDczNzQxODI0OwogICAgd2hpbGUgKGkgPCAxMDAwKSB7CiAgICAgICAgbGV0IHg6IGkzMiA9IGFvc19kYXRhWyhpICogMykgYXMgdXNpemVdOwogICAgICAgIGxldCB5OiBpMzIgPSBhb3NfZGF0YVsoaSAqIDMgKyAxKSBhcyB1c2l6ZV07CiAgICAgICAgbGV0IHo6IGkzMiA9IGFvc19kYXRhWyhpICogMyArIDIpIGFzIHVzaXplXTsKCiAgICAgICAgLy8gQ29tcHV0ZSBzb21lIG9wZXJhdGlvbiBvbiB0aGUgc3RydWN0dXJlCiAgICAgICAgc3VtID0gKHN1bSArICh4ICogeCAlIE0gKyB5ICogeSAlIE0gKyB6ICogeiAlIE0pICUgTSkgJSBNOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gc3VtOwp9CgovLyBIeWJyaWQgZGF0YSBsYXlvdXQgY29tYmluaW5nIGJlbmVmaXRzIG9mIGJvdGggYXBwcm9hY2hlcwpmbiB0ZXN0SHlicmlkRGF0YUxheW91dCgpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGJsb2NrMV94OiBbaTMyOyAyNTBdID0gWzA7IDI1MF07CiAgICBsZXQgbXV0IGJsb2NrMV95OiBbaTMyOyAyNTBdID0gWzA7IDI1MF07CiAgICBsZXQgbXV0IGJsb2NrMV96OiBbaTMyOyAyNTBdID0gWzA7IDI1MF07CgogICAgbGV0IG11dCBibG9jazJfeDogW2kzMjsgMjUwXSA9IFswOyAyNTBdOwogICAgbGV0IG11dCBibG9jazJfeTogW2kzMjsgMjUwXSA9IFswOyAyNTBdOwogICAgbGV0IG11dCBibG9jazJfejogW2kzMjsgMjUwXSA9IFswOyAyNTBdOwoKICAgIC8vIEluaXRpYWxpemUgaHlicmlkIGxheW91dAogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAyNTApIHsKICAgICAgICBibG9jazFfeFtpIGFzIHVzaXplXSA9IGk7CiAgICAgICAgYmxvY2sxX3lbaSBhcyB1c2l6ZV0gPSBpICogMjsKICAgICAgICBibG9jazFfeltpIGFzIHVzaXplXSA9IGkgKiAzOwoKICAgICAgICBibG9jazJfeFtpIGFzIHVzaXplXSA9IGkgKyAyNTA7CiAgICAgICAgYmxvY2syX3lbaSBhcyB1c2l6ZV0gPSAoaSArIDI1MCkgKiAyOwogICAgICAgIGJsb2NrMl96W2kgYXMgdXNpemVdID0gKGkgKyAyNTApICogMzsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gUHJvY2VzcyBoeWJyaWQgbGF5b3V0CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKCiAgICAvLyBQcm9jZXNzIGZpcnN0IGJsb2NrCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgMjUwKSB7CiAgICAgICAgc3VtID0gc3VtICsgKGJsb2NrMV94W2kgYXMgdXNpemVdICsgYmxvY2sxX3lbaSBhcyB1c2l6ZV0gKyBibG9jazFfeltpIGFzIHVzaXplXSk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIFByb2Nlc3Mgc2Vjb25kIGJsb2NrCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgMjUwKSB7CiAgICAgICAgc3VtID0gc3VtICsgKGJsb2NrMl94W2kgYXMgdXNpemVdICsgYmxvY2syX3lbaSBhcyB1c2l6ZV0gKyBibG9jazJfeltpIGFzIHVzaXplXSk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHJldHVybiBzdW07Cn0KCi8vIFRlc3QgNDogTWVtb3J5IFN0cmlkZSBQYXR0ZXJucwpmbiB0ZXN0TWVtb3J5U3RyaWRlUGF0dGVybnMoKSB7CiAgICBwcmludGxuSW50KDE1MDcpOyAvLyBTdGFydCBzdHJpZGUgcGF0dGVybiB0ZXN0CgogICAgbGV0IG11dCB0ZXN0X2FycmF5OiBbaTMyOyAyMDQ4XSA9IFswOyAyMDQ4XTsKICAgIGluaXRpYWxpemVTdHJpZGVUZXN0QXJyYXkoJm11dCB0ZXN0X2FycmF5KTsKCiAgICAvLyBUZXN0IGRpZmZlcmVudCBzdHJpZGUgcGF0dGVybnMKICAgIGxldCBzdHJpZGVfMV9zdW06IGkzMiA9IHByb2Nlc3NXaXRoU3RyaWRlKCZ0ZXN0X2FycmF5LCAxKTsKICAgIHByaW50bG5JbnQoc3RyaWRlXzFfc3VtKTsKCiAgICBsZXQgc3RyaWRlXzJfc3VtOiBpMzIgPSBwcm9jZXNzV2l0aFN0cmlkZSgmdGVzdF9hcnJheSwgMik7CiAgICBwcmludGxuSW50KHN0cmlkZV8yX3N1bSk7CgogICAgbGV0IHN0cmlkZV80X3N1bTogaTMyID0gcHJvY2Vzc1dpdGhTdHJpZGUoJnRlc3RfYXJyYXksIDQpOwogICAgcHJpbnRsbkludChzdHJpZGVfNF9zdW0pOwoKICAgIGxldCBzdHJpZGVfOF9zdW06IGkzMiA9IHByb2Nlc3NXaXRoU3RyaWRlKCZ0ZXN0X2FycmF5LCA4KTsKICAgIHByaW50bG5JbnQoc3RyaWRlXzhfc3VtKTsKCiAgICBsZXQgc3RyaWRlXzE2X3N1bTogaTMyID0gcHJvY2Vzc1dpdGhTdHJpZGUoJnRlc3RfYXJyYXksIDE2KTsKICAgIHByaW50bG5JbnQoc3RyaWRlXzE2X3N1bSk7CgogICAgLy8gVGVzdCBjb21wbGV4IHN0cmlkZSBwYXR0ZXJucwogICAgbGV0IGNvbXBsZXhfc3RyaWRlX3N1bTogaTMyID0gcHJvY2Vzc1dpdGhDb21wbGV4U3RyaWRlKCZ0ZXN0X2FycmF5KTsKICAgIHByaW50bG5JbnQoY29tcGxleF9zdHJpZGVfc3VtKTsKCiAgICBwcmludGxuSW50KDE1MDgpOyAvLyBFbmQgc3RyaWRlIHBhdHRlcm4gdGVzdAp9CgovLyBJbml0aWFsaXplIGFycmF5IGZvciBzdHJpZGUgdGVzdGluZwpmbiBpbml0aWFsaXplU3RyaWRlVGVzdEFycmF5KGFycjogJm11dCBbaTMyOyAyMDQ4XSkgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAyMDQ4KSB7CiAgICAgICAgYXJyW2kgYXMgdXNpemVdID0gKGkgJSAxMDApICsgMTsKICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIFByb2Nlc3MgYXJyYXkgd2l0aCBnaXZlbiBzdHJpZGUKZm4gcHJvY2Vzc1dpdGhTdHJpZGUoYXJyOiAmW2kzMjsgMjA0OF0sIHN0cmlkZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgd2hpbGUgKGkgPCAyMDQ4KSB7CiAgICAgICAgc3VtID0gc3VtICsgYXJyW2kgYXMgdXNpemVdICogKGkgKyAxKTsKICAgICAgICBpID0gaSArIHN0cmlkZTsKICAgIH0KCiAgICByZXR1cm4gc3VtOwp9CgovLyBQcm9jZXNzIGFycmF5IHdpdGggY29tcGxleCBzdHJpZGUgcGF0dGVybgpmbiBwcm9jZXNzV2l0aENvbXBsZXhTdHJpZGUoYXJyOiAmW2kzMjsgMjA0OF0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIGxldCBtdXQgc3RyaWRlOiBpMzIgPSAxOwoKICAgIHdoaWxlIChpIDwgMjA0OCkgewogICAgICAgIHN1bSA9IHN1bSArIGFycltpIGFzIHVzaXplXTsKICAgICAgICBpID0gaSArIHN0cmlkZTsKCiAgICAgICAgLy8gQ2hhbmdlIHN0cmlkZSBwYXR0ZXJuCiAgICAgICAgaWYgKHN0cmlkZSA9PSAxKSB7CiAgICAgICAgICAgIHN0cmlkZSA9IDQ7CiAgICAgICAgfSBlbHNlIGlmIChzdHJpZGUgPT0gNCkgewogICAgICAgICAgICBzdHJpZGUgPSAyOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN0cmlkZSA9IDE7CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiBzdW07Cn0KCi8vIFRlc3QgNTogQ2FjaGUtQ29uc2Npb3VzIEFsZ29yaXRobXMKZm4gdGVzdENhY2hlQ29uc2Npb3VzQWxnb3JpdGhtcygpIHsKICAgIHByaW50bG5JbnQoMTUwOSk7IC8vIFN0YXJ0IGNhY2hlLWNvbnNjaW91cyB0ZXN0CgogICAgLy8gVGVzdCBjYWNoZS1vYmxpdmlvdXMgbWF0cml4IG11bHRpcGxpY2F0aW9uCiAgICBsZXQgbWF0cml4X211bHRfcmVzdWx0OiBpMzIgPSBjYWNoZU9ibGl2aW91c01hdHJpeE11bHRpcGxpY2F0aW9uKCk7CiAgICBwcmludGxuSW50KG1hdHJpeF9tdWx0X3Jlc3VsdCk7CgogICAgLy8gVGVzdCBjYWNoZS1jb25zY2lvdXMgc29ydGluZwogICAgbGV0IHNvcnRfcmVzdWx0OiBpMzIgPSBjYWNoZUNvbnNjaW91c1NvcnQoKTsKICAgIHByaW50bG5JbnQoc29ydF9yZXN1bHQpOwoKICAgIC8vIFRlc3QgY2FjaGUtYXdhcmUgZGF0YSBwcm9jZXNzaW5nCiAgICBsZXQgZGF0YV9wcm9jZXNzaW5nX3Jlc3VsdDogaTMyID0gY2FjaGVBd2FyZURhdGFQcm9jZXNzaW5nKCk7CiAgICBwcmludGxuSW50KGRhdGFfcHJvY2Vzc2luZ19yZXN1bHQpOwoKICAgIC8vIFRlc3QgdGVtcG9yYWwgbG9jYWxpdHkgb3B0aW1pemF0aW9uCiAgICBsZXQgdGVtcG9yYWxfcmVzdWx0OiBpMzIgPSB0ZW1wb3JhbExvY2FsaXR5T3B0aW1pemF0aW9uKCk7CiAgICBwcmludGxuSW50KHRlbXBvcmFsX3Jlc3VsdCk7CgogICAgcHJpbnRsbkludCgxNTEwKTsgLy8gRW5kIGNhY2hlLWNvbnNjaW91cyB0ZXN0Cn0KCi8vIENhY2hlLW9ibGl2aW91cyBtYXRyaXggbXVsdGlwbGljYXRpb24KZm4gY2FjaGVPYmxpdmlvdXNNYXRyaXhNdWx0aXBsaWNhdGlvbigpIC0+IGkzMiB7CiAgICBsZXQgbXV0IG1hdHJpeF9hOiBbaTMyOyA2NF0gPSBbMDsgNjRdOyAvLyA4eDggbWF0cml4CiAgICBsZXQgbXV0IG1hdHJpeF9iOiBbaTMyOyA2NF0gPSBbMDsgNjRdOyAvLyA4eDggbWF0cml4CiAgICBsZXQgbXV0IG1hdHJpeF9jOiBbaTMyOyA2NF0gPSBbMDsgNjRdOyAvLyA4eDggcmVzdWx0CgogICAgLy8gSW5pdGlhbGl6ZSBtYXRyaWNlcwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCA2NCkgewogICAgICAgIG1hdHJpeF9hW2kgYXMgdXNpemVdID0gKGkgJSAxMCkgKyAxOwogICAgICAgIG1hdHJpeF9iW2kgYXMgdXNpemVdID0gKChpICogMikgJSAxMCkgKyAxOwogICAgICAgIG1hdHJpeF9jW2kgYXMgdXNpemVdID0gMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gUGVyZm9ybSBibG9ja2VkIG1hdHJpeCBtdWx0aXBsaWNhdGlvbgogICAgY2FjaGVPYmxpdmlvdXNNdWx0aXBseVJlY3Vyc2l2ZSgmbWF0cml4X2EsICZtYXRyaXhfYiwgJm11dCBtYXRyaXhfYywgOCwgMCwgMCwgMCwgMCwgMCwgMCk7CgogICAgLy8gQ2FsY3VsYXRlIHN1bQogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgNjQpIHsKICAgICAgICBzdW0gPSBzdW0gKyBtYXRyaXhfY1tpIGFzIHVzaXplXTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcmV0dXJuIHN1bTsKfQoKLy8gUmVjdXJzaXZlIGNhY2hlLW9ibGl2aW91cyBtYXRyaXggbXVsdGlwbGljYXRpb24KZm4gY2FjaGVPYmxpdmlvdXNNdWx0aXBseVJlY3Vyc2l2ZSgKICAgIGE6ICZbaTMyOyA2NF0sCiAgICBiOiAmW2kzMjsgNjRdLAogICAgYzogJm11dCBbaTMyOyA2NF0sCiAgICBzaXplOiBpMzIsCiAgICBhX3JvdzogaTMyLAogICAgYV9jb2w6IGkzMiwKICAgIGJfcm93OiBpMzIsCiAgICBiX2NvbDogaTMyLAogICAgY19yb3c6IGkzMiwKICAgIGNfY29sOiBpMzIsCikgewogICAgaWYgKHNpemUgPD0gMikgewogICAgICAgIC8vIEJhc2UgY2FzZTogZGlyZWN0IG11bHRpcGxpY2F0aW9uIGZvciBzbWFsbCBtYXRyaWNlcwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IHNpemUpIHsKICAgICAgICAgICAgICAgIGxldCBtdXQgazogaTMyID0gMDsKICAgICAgICAgICAgICAgIHdoaWxlIChrIDwgc2l6ZSkgewogICAgICAgICAgICAgICAgICAgIGNbKChjX3JvdyArIGkpICogOCArIChjX2NvbCArIGopKSBhcyB1c2l6ZV0gPSBjCiAgICAgICAgICAgICAgICAgICAgICAgIFsoKGNfcm93ICsgaSkgKiA4ICsgKGNfY29sICsgaikpIGFzIHVzaXplXQogICAgICAgICAgICAgICAgICAgICAgICArIGFbKChhX3JvdyArIGkpICogOCArIChhX2NvbCArIGspKSBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICogYlsoKGJfcm93ICsgaykgKiA4ICsgKGJfY29sICsgaikpIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICBrID0gayArIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KICAgICAgICByZXR1cm47CiAgICB9CgogICAgbGV0IGhhbGZfc2l6ZTogaTMyID0gc2l6ZSAvIDI7CgogICAgLy8gUmVjdXJzaXZlbHkgbXVsdGlwbHkgc3ViLW1hdHJpY2VzCiAgICBjYWNoZU9ibGl2aW91c011bHRpcGx5UmVjdXJzaXZlKGEsIGIsIGMsIGhhbGZfc2l6ZSwgYV9yb3csIGFfY29sLCBiX3JvdywgYl9jb2wsIGNfcm93LCBjX2NvbCk7CiAgICBjYWNoZU9ibGl2aW91c011bHRpcGx5UmVjdXJzaXZlKAogICAgICAgIGEsCiAgICAgICAgYiwKICAgICAgICBjLAogICAgICAgIGhhbGZfc2l6ZSwKICAgICAgICBhX3JvdywKICAgICAgICBhX2NvbCArIGhhbGZfc2l6ZSwKICAgICAgICBiX3JvdyArIGhhbGZfc2l6ZSwKICAgICAgICBiX2NvbCwKICAgICAgICBjX3JvdywKICAgICAgICBjX2NvbCwKICAgICk7Cn0KCi8vIENhY2hlLWNvbnNjaW91cyBzb3J0aW5nIGFsZ29yaXRobQpmbiBjYWNoZUNvbnNjaW91c1NvcnQoKSAtPiBpMzIgewogICAgbGV0IG11dCB0ZXN0X2RhdGE6IFtpMzI7IDUxMl0gPSBbMDsgNTEyXTsKICAgIGluaXRpYWxpemVTb3J0VGVzdERhdGEoJm11dCB0ZXN0X2RhdGEpOwoKICAgIC8vIFBlcmZvcm0gY2FjaGUtY29uc2Npb3VzIG1lcmdlIHNvcnQKICAgIGxldCBjb21wYXJpc29uczogaTMyID0gY2FjaGVDb25zY2lvdXNNZXJnZVNvcnQoJm11dCB0ZXN0X2RhdGEsIDAsIDUxMSk7CgogICAgcmV0dXJuIGNvbXBhcmlzb25zOwp9CgovLyBJbml0aWFsaXplIHRlc3QgZGF0YSBmb3Igc29ydGluZwpmbiBpbml0aWFsaXplU29ydFRlc3REYXRhKGFycjogJm11dCBbaTMyOyA1MTJdKSB7CiAgICBsZXQgbXV0IHNlZWQ6IGkzMiA9IDEzNTc5OwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDwgNTEyKSB7CiAgICAgICAgc2VlZCA9IChzZWVkICogMTEwMyArIDQ3MjEpICUgMTA0ODU4MzsKICAgICAgICBpZiAoc2VlZCA8IDApIHsKICAgICAgICAgICAgc2VlZCA9IC1zZWVkOwogICAgICAgIH0KICAgICAgICBhcnJbaSBhcyB1c2l6ZV0gPSBzZWVkICUgMTAwMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIENhY2hlLWNvbnNjaW91cyBtZXJnZSBzb3J0CmZuIGNhY2hlQ29uc2Npb3VzTWVyZ2VTb3J0KGFycjogJm11dCBbaTMyOyA1MTJdLCBsZWZ0OiBpMzIsIHJpZ2h0OiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobGVmdCA+PSByaWdodCkgewogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIGxldCBzaXplOiBpMzIgPSByaWdodCAtIGxlZnQgKyAxOwoKICAgIC8vIFVzZSBpbnNlcnRpb24gc29ydCBmb3Igc21hbGwgYXJyYXlzIChjYWNoZS1mcmllbmRseSkKICAgIGlmIChzaXplIDw9IDE2KSB7CiAgICAgICAgcmV0dXJuIGluc2VydGlvblNvcnQoYXJyLCBsZWZ0LCByaWdodCk7CiAgICB9CgogICAgbGV0IG1pZDogaTMyID0gbGVmdCArIChyaWdodCAtIGxlZnQpIC8gMjsKICAgIGxldCBsZWZ0X2NvbXBhcmlzb25zOiBpMzIgPSBjYWNoZUNvbnNjaW91c01lcmdlU29ydChhcnIsIGxlZnQsIG1pZCk7CiAgICBsZXQgcmlnaHRfY29tcGFyaXNvbnM6IGkzMiA9IGNhY2hlQ29uc2Npb3VzTWVyZ2VTb3J0KGFyciwgbWlkICsgMSwgcmlnaHQpOwogICAgbGV0IG1lcmdlX2NvbXBhcmlzb25zOiBpMzIgPSBjYWNoZUZyaWVuZGx5TWVyZ2UoYXJyLCBsZWZ0LCBtaWQsIHJpZ2h0KTsKCiAgICByZXR1cm4gbGVmdF9jb21wYXJpc29ucyArIHJpZ2h0X2NvbXBhcmlzb25zICsgbWVyZ2VfY29tcGFyaXNvbnM7Cn0KCi8vIEluc2VydGlvbiBzb3J0IGZvciBzbWFsbCBhcnJheXMKZm4gaW5zZXJ0aW9uU29ydChhcnI6ICZtdXQgW2kzMjsgNTEyXSwgbGVmdDogaTMyLCByaWdodDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBjb21wYXJpc29uczogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gbGVmdCArIDE7CgogICAgd2hpbGUgKGkgPD0gcmlnaHQpIHsKICAgICAgICBsZXQga2V5OiBpMzIgPSBhcnJbaSBhcyB1c2l6ZV07CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSBpIC0gMTsKCiAgICAgICAgd2hpbGUgKGogPj0gbGVmdCAmJiBhcnJbaiBhcyB1c2l6ZV0gPiBrZXkpIHsKICAgICAgICAgICAgYXJyWyhqICsgMSkgYXMgdXNpemVdID0gYXJyW2ogYXMgdXNpemVdOwogICAgICAgICAgICBqID0gaiAtIDE7CiAgICAgICAgICAgIGNvbXBhcmlzb25zID0gY29tcGFyaXNvbnMgKyAxOwogICAgICAgIH0KCiAgICAgICAgaWYgKGogPj0gbGVmdCkgewogICAgICAgICAgICBjb21wYXJpc29ucyA9IGNvbXBhcmlzb25zICsgMTsgLy8gQ29tcGFyaXNvbiB0aGF0IGRpZG4ndCByZXN1bHQgaW4gbW92ZQogICAgICAgIH0KCiAgICAgICAgYXJyWyhqICsgMSkgYXMgdXNpemVdID0ga2V5OwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gY29tcGFyaXNvbnM7Cn0KCi8vIENhY2hlLWZyaWVuZGx5IG1lcmdlIG9wZXJhdGlvbgpmbiBjYWNoZUZyaWVuZGx5TWVyZ2UoYXJyOiAmbXV0IFtpMzI7IDUxMl0sIGxlZnQ6IGkzMiwgbWlkOiBpMzIsIHJpZ2h0OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbGVmdF9zaXplOiBpMzIgPSBtaWQgLSBsZWZ0ICsgMTsKICAgIGxldCByaWdodF9zaXplOiBpMzIgPSByaWdodCAtIG1pZDsKCiAgICAvLyBVc2UgdGVtcG9yYXJ5IGFycmF5cyB3aXRoIGxpbWl0ZWQgc2l6ZSBmb3IgY2FjaGUgZWZmaWNpZW5jeQogICAgbGV0IG11dCBsZWZ0X3RlbXA6IFtpMzI7IDEyOF0gPSBbMDsgMTI4XTsKICAgIGxldCBtdXQgcmlnaHRfdGVtcDogW2kzMjsgMTI4XSA9IFswOyAxMjhdOwoKICAgIC8vIENvcHkgZGF0YSB0byB0ZW1wb3JhcnkgYXJyYXlzCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IGxlZnRfc2l6ZSAmJiBpIDwgMTI4KSB7CiAgICAgICAgbGVmdF90ZW1wW2kgYXMgdXNpemVdID0gYXJyWyhsZWZ0ICsgaSkgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICB3aGlsZSAoaiA8IHJpZ2h0X3NpemUgJiYgaiA8IDEyOCkgewogICAgICAgIHJpZ2h0X3RlbXBbaiBhcyB1c2l6ZV0gPSBhcnJbKG1pZCArIDEgKyBqKSBhcyB1c2l6ZV07CiAgICAgICAgaiA9IGogKyAxOwogICAgfQoKICAgIC8vIE1lcmdlIHRoZSBhcnJheXMKICAgIGkgPSAwOwogICAgaiA9IDA7CiAgICBsZXQgbXV0IGs6IGkzMiA9IGxlZnQ7CiAgICBsZXQgbXV0IGNvbXBhcmlzb25zOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDwgbGVmdF9zaXplICYmIGogPCByaWdodF9zaXplICYmIGkgPCAxMjggJiYgaiA8IDEyOCkgewogICAgICAgIGNvbXBhcmlzb25zID0gY29tcGFyaXNvbnMgKyAxOwogICAgICAgIGlmIChsZWZ0X3RlbXBbaSBhcyB1c2l6ZV0gPD0gcmlnaHRfdGVtcFtqIGFzIHVzaXplXSkgewogICAgICAgICAgICBhcnJbayBhcyB1c2l6ZV0gPSBsZWZ0X3RlbXBbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhcnJbayBhcyB1c2l6ZV0gPSByaWdodF90ZW1wW2ogYXMgdXNpemVdOwogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGsgPSBrICsgMTsKICAgIH0KCiAgICAvLyBDb3B5IHJlbWFpbmluZyBlbGVtZW50cwogICAgd2hpbGUgKGkgPCBsZWZ0X3NpemUgJiYgaSA8IDEyOCkgewogICAgICAgIGFycltrIGFzIHVzaXplXSA9IGxlZnRfdGVtcFtpIGFzIHVzaXplXTsKICAgICAgICBpID0gaSArIDE7CiAgICAgICAgayA9IGsgKyAxOwogICAgfQoKICAgIHdoaWxlIChqIDwgcmlnaHRfc2l6ZSAmJiBqIDwgMTI4KSB7CiAgICAgICAgYXJyW2sgYXMgdXNpemVdID0gcmlnaHRfdGVtcFtqIGFzIHVzaXplXTsKICAgICAgICBqID0gaiArIDE7CiAgICAgICAgayA9IGsgKyAxOwogICAgfQoKICAgIHJldHVybiBjb21wYXJpc29uczsKfQoKLy8gQ2FjaGUtYXdhcmUgZGF0YSBwcm9jZXNzaW5nCmZuIGNhY2hlQXdhcmVEYXRhUHJvY2Vzc2luZygpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGRhdGFfZ3JpZDogW2kzMjsgMTAyNF0gPSBbMDsgMTAyNF07IC8vIDMyeDMyIGdyaWQKICAgIGluaXRpYWxpemVEYXRhR3JpZCgmbXV0IGRhdGFfZ3JpZCk7CgogICAgLy8gUHJvY2VzcyBkYXRhIGluIGNhY2hlLWZyaWVuZGx5IGJsb2NrcwogICAgbGV0IHJlc3VsdDogaTMyID0gcHJvY2Vzc0RhdGFJbkJsb2NrcygmbXV0IGRhdGFfZ3JpZCk7CgogICAgcmV0dXJuIHJlc3VsdDsKfQoKLy8gSW5pdGlhbGl6ZSBkYXRhIGdyaWQKZm4gaW5pdGlhbGl6ZURhdGFHcmlkKGdyaWQ6ICZtdXQgW2kzMjsgMTAyNF0pIHsKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwogICAgd2hpbGUgKGkgPCAxMDI0KSB7CiAgICAgICAgZ3JpZFtpXSA9IChpICUgNTApIGFzIGkzMiArIDE7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBQcm9jZXNzIGRhdGEgaW4gY2FjaGUtZnJpZW5kbHkgYmxvY2tzCmZuIHByb2Nlc3NEYXRhSW5CbG9ja3MoZ3JpZDogJm11dCBbaTMyOyAxMDI0XSkgLT4gaTMyIHsKICAgIGxldCBtdXQgdG90YWxfc3VtOiBpMzIgPSAwOwogICAgbGV0IGJsb2NrX3NpemU6IHVzaXplID0gODsKICAgIGxldCBncmlkX3NpemU6IHVzaXplID0gMzI7CgogICAgbGV0IG11dCBibG9ja19yb3c6IHVzaXplID0gMDsKICAgIHdoaWxlIChibG9ja19yb3cgPCBncmlkX3NpemUpIHsKICAgICAgICBsZXQgbXV0IGJsb2NrX2NvbDogdXNpemUgPSAwOwogICAgICAgIHdoaWxlIChibG9ja19jb2wgPCBncmlkX3NpemUpIHsKICAgICAgICAgICAgLy8gUHJvY2VzcyA4eDggYmxvY2sKICAgICAgICAgICAgbGV0IG11dCByb3c6IHVzaXplID0gYmxvY2tfcm93OwogICAgICAgICAgICBsZXQgZW5kX3JvdzogdXNpemUgPSBibG9ja19yb3cgKyBibG9ja19zaXplOwogICAgICAgICAgICB3aGlsZSAocm93IDwgZW5kX3JvdyAmJiByb3cgPCBncmlkX3NpemUpIHsKICAgICAgICAgICAgICAgIGxldCBtdXQgY29sOiB1c2l6ZSA9IGJsb2NrX2NvbDsKICAgICAgICAgICAgICAgIGxldCBlbmRfY29sOiB1c2l6ZSA9IGJsb2NrX2NvbCArIGJsb2NrX3NpemU7CiAgICAgICAgICAgICAgICB3aGlsZSAoY29sIDwgZW5kX2NvbCAmJiBjb2wgPCBncmlkX3NpemUpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgaW5kZXg6IHVzaXplID0gcm93ICogZ3JpZF9zaXplICsgY29sOwogICAgICAgICAgICAgICAgICAgIGdyaWRbaW5kZXhdID0gZ3JpZFtpbmRleF0gKiAyICsgMTsKICAgICAgICAgICAgICAgICAgICB0b3RhbF9zdW0gPSB0b3RhbF9zdW0gKyBncmlkW2luZGV4XTsKICAgICAgICAgICAgICAgICAgICBjb2wgPSBjb2wgKyAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcm93ID0gcm93ICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBibG9ja19jb2wgPSBibG9ja19jb2wgKyBibG9ja19zaXplOwogICAgICAgIH0KICAgICAgICBibG9ja19yb3cgPSBibG9ja19yb3cgKyBibG9ja19zaXplOwogICAgfQoKICAgIHJldHVybiB0b3RhbF9zdW07Cn0KCi8vIFRlbXBvcmFsIGxvY2FsaXR5IG9wdGltaXphdGlvbgpmbiB0ZW1wb3JhbExvY2FsaXR5T3B0aW1pemF0aW9uKCkgLT4gaTMyIHsKICAgIGxldCBtdXQgd29ya2luZ19zZXQ6IFtpMzI7IDI1Nl0gPSBbMDsgMjU2XTsKICAgIGluaXRpYWxpemVXb3JraW5nU2V0KCZtdXQgd29ya2luZ19zZXQpOwoKICAgIGxldCBtdXQgdG90YWxfb3BlcmF0aW9uczogaTMyID0gMDsKICAgIGxldCBtdXQgaXRlcmF0aW9uOiBpMzIgPSAwOwoKICAgIC8vIFBlcmZvcm0gbXVsdGlwbGUgcGFzc2VzIG92ZXIgdGhlIHNhbWUgZGF0YSB0byBleHBsb2l0IHRlbXBvcmFsIGxvY2FsaXR5CiAgICB3aGlsZSAoaXRlcmF0aW9uIDwgMTAwKSB7CiAgICAgICAgbGV0IHBhc3Nfb3BlcmF0aW9uczogaTMyID0gcHJvY2Vzc1dvcmtpbmdTZXQoJm11dCB3b3JraW5nX3NldCk7CiAgICAgICAgdG90YWxfb3BlcmF0aW9ucyA9IHRvdGFsX29wZXJhdGlvbnMgKyBwYXNzX29wZXJhdGlvbnM7CiAgICAgICAgaXRlcmF0aW9uID0gaXRlcmF0aW9uICsgMTsKICAgIH0KCiAgICByZXR1cm4gdG90YWxfb3BlcmF0aW9uczsKfQoKLy8gSW5pdGlhbGl6ZSB3b3JraW5nIHNldApmbiBpbml0aWFsaXplV29ya2luZ1NldCh3b3JraW5nX3NldDogJm11dCBbaTMyOyAyNTZdKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IDI1NikgewogICAgICAgIHdvcmtpbmdfc2V0W2kgYXMgdXNpemVdID0gaSArIDE7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBQcm9jZXNzIHdvcmtpbmcgc2V0ICh0ZW1wb3JhbCBsb2NhbGl0eSBmcmllbmRseSkKZm4gcHJvY2Vzc1dvcmtpbmdTZXQod29ya2luZ19zZXQ6ICZtdXQgW2kzMjsgMjU2XSkgLT4gaTMyIHsKICAgIGxldCBtdXQgb3BlcmF0aW9uczogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICAvLyBNdWx0aXBsZSBvcGVyYXRpb25zIG9uIHRoZSBzYW1lIGRhdGEKICAgIHdoaWxlIChpIDwgMjU2KSB7CiAgICAgICAgd29ya2luZ19zZXRbaSBhcyB1c2l6ZV0gPSB3b3JraW5nX3NldFtpIGFzIHVzaXplXSArIDE7CiAgICAgICAgb3BlcmF0aW9ucyA9IG9wZXJhdGlvbnMgKyAxOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBTZWNvbmQgcGFzcwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDI1NikgewogICAgICAgIHdvcmtpbmdfc2V0W2kgYXMgdXNpemVdID0gd29ya2luZ19zZXRbaSBhcyB1c2l6ZV0gKiAyOwogICAgICAgIG9wZXJhdGlvbnMgPSBvcGVyYXRpb25zICsgMTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gVGhpcmQgcGFzcwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDI1NikgewogICAgICAgIGlmICh3b3JraW5nX3NldFtpIGFzIHVzaXplXSAlIDIgPT0gMCkgewogICAgICAgICAgICB3b3JraW5nX3NldFtpIGFzIHVzaXplXSA9IHdvcmtpbmdfc2V0W2kgYXMgdXNpemVdIC8gMjsKICAgICAgICB9CiAgICAgICAgb3BlcmF0aW9ucyA9IG9wZXJhdGlvbnMgKyAxOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gb3BlcmF0aW9uczsKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (6, "comprehensive6", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCA2OiBTdHJpbmcgUHJvY2Vzc2luZyBhbmQgUGF0dGVybiBNYXRjaGluZwpTdW1tYXJ5OiBUaGlzIHRlc3QgZm9jdXNlcyBvbiBjb21waWxlciBvcHRpbWl6YXRpb24gb2Y6CkRldGFpbHM6ClN0cmluZyBtYW5pcHVsYXRpb24gYWxnb3JpdGhtcyB1c2luZyBpbnRlZ2VyIGFycmF5cwpQYXR0ZXJuIG1hdGNoaW5nIGFuZCBzZWFyY2hpbmcgb3B0aW1pemF0aW9ucwpDaGFyYWN0ZXIgcHJvY2Vzc2luZyBsb29wIG9wdGltaXphdGlvbnMKVGV4dCBwcm9jZXNzaW5nIGFsZ29yaXRobSBvcHRpbWl6YXRpb25zClNlcXVlbnRpYWwgZGF0YSBwcm9jZXNzaW5nIHBhdHRlcm5zCkNoYXJhY3Rlci1iYXNlZCBjb25kaXRpb25hbCBsb2dpYyBvcHRpbWl6YXRpb24KKi8KCi8vIGNvbXByZWhlbnNpdmU2LnJ4IC0gQ29tcHJlaGVuc2l2ZSBUZXN0IDY6IFN0cmluZyBQcm9jZXNzaW5nIGFuZCBQYXR0ZXJuIE1hdGNoaW5nCi8vIFRoaXMgdGVzdCBmb2N1c2VzIG9uIGNvbXBpbGVyIG9wdGltaXphdGlvbiBvZjoKLy8gLSBTdHJpbmcgbWFuaXB1bGF0aW9uIGFsZ29yaXRobXMgdXNpbmcgaW50ZWdlciBhcnJheXMKLy8gLSBQYXR0ZXJuIG1hdGNoaW5nIGFuZCBzZWFyY2hpbmcgb3B0aW1pemF0aW9ucwovLyAtIENoYXJhY3RlciBwcm9jZXNzaW5nIGxvb3Agb3B0aW1pemF0aW9ucwovLyAtIFRleHQgcHJvY2Vzc2luZyBhbGdvcml0aG0gb3B0aW1pemF0aW9ucwovLyAtIFNlcXVlbnRpYWwgZGF0YSBwcm9jZXNzaW5nIHBhdHRlcm5zCi8vIC0gQ2hhcmFjdGVyLWJhc2VkIGNvbmRpdGlvbmFsIGxvZ2ljIG9wdGltaXphdGlvbgoKZm4gbWFpbigpIHsKICAgIC8vIFBlcmZvcm1hbmNlIHRlc3QgbWFya2VyIC0gc3RhcnQKICAgIHByaW50bG5JbnQoMTYwMCk7CgogICAgLy8gVGVzdCAxOiBTdHJpbmcgc2VhcmNoaW5nIGFuZCBwYXR0ZXJuIG1hdGNoaW5nIGFsZ29yaXRobXMKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBzdHJpbmcgc2VhcmNoIHBhdHRlcm5zIGFuZCBjaGFyYWN0ZXIgY29tcGFyaXNvbnMKICAgIHRlc3RTdHJpbmdTZWFyY2hBbGdvcml0aG1zKCk7CgogICAgLy8gVGVzdCAyOiBUZXh0IHByb2Nlc3NpbmcgYW5kIGNoYXJhY3RlciBtYW5pcHVsYXRpb24KICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBjaGFyYWN0ZXItbGV2ZWwgb3BlcmF0aW9ucyBhbmQgdHJhbnNmb3JtYXRpb25zCiAgICB0ZXN0VGV4dFByb2Nlc3NpbmdBbGdvcml0aG1zKCk7CgogICAgLy8gVGVzdCAzOiBTdHJpbmcgcGFyc2luZyBhbmQgdG9rZW5pemF0aW9uCiAgICAvLyBUZXN0cyBvcHRpbWl6YXRpb24gb2YgcGFyc2luZyBsb2dpYyBhbmQgc3RhdGUgbWFjaGluZXMKICAgIHRlc3RTdHJpbmdQYXJzaW5nQWxnb3JpdGhtcygpOwoKICAgIC8vIFRlc3QgNDogU3RyaW5nIGNvbXByZXNzaW9uIGFuZCBlbmNvZGluZwogICAgLy8gVGVzdHMgb3B0aW1pemF0aW9uIG9mIGRhdGEgdHJhbnNmb3JtYXRpb24gYWxnb3JpdGhtcwogICAgdGVzdFN0cmluZ0NvbXByZXNzaW9uQWxnb3JpdGhtcygpOwoKICAgIC8vIFRlc3QgNTogQWR2YW5jZWQgc3RyaW5nIGFsZ29yaXRobXMKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBjb21wbGV4IHN0cmluZyBwcm9jZXNzaW5nIHBhdHRlcm5zCiAgICB0ZXN0QWR2YW5jZWRTdHJpbmdBbGdvcml0aG1zKCk7CgogICAgLy8gUGVyZm9ybWFuY2UgdGVzdCBtYXJrZXIgLSBlbmQKICAgIHByaW50bG5JbnQoMTY5OSk7CiAgICBleGl0KDApOwp9CgovLyBUZXN0IDE6IFN0cmluZyBTZWFyY2ggQWxnb3JpdGhtcwpmbiB0ZXN0U3RyaW5nU2VhcmNoQWxnb3JpdGhtcygpIHsKICAgIHByaW50bG5JbnQoMTYwMSk7IC8vIFN0YXJ0IHN0cmluZyBzZWFyY2ggdGVzdAoKICAgIC8vIENyZWF0ZSB0ZXN0IHN0cmluZ3MgdXNpbmcgaW50ZWdlciBhcnJheXMgKEFTQ0lJIHZhbHVlcykKICAgIGxldCBtdXQgdGV4dDogW2kzMjsgMTAwMF0gPSBbMDsgMTAwMF07CiAgICBsZXQgbXV0IHBhdHRlcm46IFtpMzI7IDEwXSA9IFswOyAxMF07CgogICAgaW5pdGlhbGl6ZVRleHRTdHJpbmcoJm11dCB0ZXh0KTsKICAgIGluaXRpYWxpemVQYXR0ZXJuU3RyaW5nKCZtdXQgcGF0dGVybik7CgogICAgLy8gVGVzdCBuYWl2ZSBzdHJpbmcgc2VhcmNoCiAgICBsZXQgbmFpdmVfbWF0Y2hlczogaTMyID0gbmFpdmVTdHJpbmdTZWFyY2goJnRleHQsIDEwMDAsICZwYXR0ZXJuLCAxMCk7CiAgICBwcmludGxuSW50KG5haXZlX21hdGNoZXMpOwoKICAgIC8vIFRlc3QgS01QIHN0cmluZyBzZWFyY2ggYWxnb3JpdGhtCiAgICBsZXQga21wX21hdGNoZXM6IGkzMiA9IGttcFN0cmluZ1NlYXJjaCgmdGV4dCwgMTAwMCwgJnBhdHRlcm4sIDEwKTsKICAgIHByaW50bG5JbnQoa21wX21hdGNoZXMpOwoKICAgIC8vIFRlc3QgQm95ZXItTW9vcmUtbGlrZSBzdHJpbmcgc2VhcmNoCiAgICBsZXQgYm95ZXJfbW9vcmVfbWF0Y2hlczogaTMyID0gYm95ZXJNb29yZVN0cmluZ1NlYXJjaCgmdGV4dCwgMTAwMCwgJnBhdHRlcm4sIDEwKTsKICAgIHByaW50bG5JbnQoYm95ZXJfbW9vcmVfbWF0Y2hlcyk7CgogICAgLy8gVGVzdCBtdWx0aXBsZSBwYXR0ZXJuIHNlYXJjaAogICAgbGV0IG11bHRpX3BhdHRlcm5fbWF0Y2hlczogaTMyID0gbXVsdGlwbGVQYXR0ZXJuU2VhcmNoKCZ0ZXh0LCAxMDAwKTsKICAgIHByaW50bG5JbnQobXVsdGlfcGF0dGVybl9tYXRjaGVzKTsKCiAgICBwcmludGxuSW50KDE2MDIpOyAvLyBFbmQgc3RyaW5nIHNlYXJjaCB0ZXN0Cn0KCi8vIEluaXRpYWxpemUgdGV4dCBzdHJpbmcgd2l0aCBBU0NJSSB2YWx1ZXMKZm4gaW5pdGlhbGl6ZVRleHRTdHJpbmcodGV4dDogJm11dCBbaTMyOyAxMDAwXSkgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgbGV0IG11dCBzZWVkOiBpMzIgPSAxMjU7CgogICAgd2hpbGUgKGkgPCAxMDAwKSB7CiAgICAgICAgc2VlZCA9IChzZWVkICogMTY2ICsgMTAxMykgJSAyMTQ3NDM7CiAgICAgICAgLy8gR2VuZXJhdGUgQVNDSUkgdmFsdWVzIGZvciBwcmludGFibGUgY2hhcmFjdGVycyAoMzItMTI2KQogICAgICAgIHRleHRbaSBhcyB1c2l6ZV0gPSAzMiArIChzZWVkICUgOTUpOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBJbnNlcnQga25vd24gcGF0dGVybnMgZm9yIHRlc3RpbmcKICAgIHRleHRbMTAwXSA9IDY1OyAvLyAnQScKICAgIHRleHRbMTAxXSA9IDY2OyAvLyAnQicKICAgIHRleHRbMTAyXSA9IDY3OyAvLyAnQycKICAgIHRleHRbMTAzXSA9IDY4OyAvLyAnRCcKCiAgICB0ZXh0WzUwMF0gPSA2NTsgLy8gJ0EnCiAgICB0ZXh0WzUwMV0gPSA2NjsgLy8gJ0InCiAgICB0ZXh0WzUwMl0gPSA2NzsgLy8gJ0MnCiAgICB0ZXh0WzUwM10gPSA2ODsgLy8gJ0QnCn0KCi8vIEluaXRpYWxpemUgcGF0dGVybiBzdHJpbmcKZm4gaW5pdGlhbGl6ZVBhdHRlcm5TdHJpbmcocGF0dGVybjogJm11dCBbaTMyOyAxMF0pIHsKICAgIHBhdHRlcm5bMF0gPSA2NTsgLy8gJ0EnCiAgICBwYXR0ZXJuWzFdID0gNjY7IC8vICdCJwogICAgcGF0dGVyblsyXSA9IDY3OyAvLyAnQycKICAgIHBhdHRlcm5bM10gPSA2ODsgLy8gJ0QnCiAgICBsZXQgbXV0IGk6IGkzMiA9IDQ7CiAgICB3aGlsZSAoaSA8IDEwKSB7CiAgICAgICAgcGF0dGVybltpIGFzIHVzaXplXSA9IDA7IC8vIE51bGwgdGVybWluYXRvciBzaW11bGF0aW9uCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBOYWl2ZSBzdHJpbmcgc2VhcmNoIGFsZ29yaXRobQpmbiBuYWl2ZVN0cmluZ1NlYXJjaCgKICAgIHRleHQ6ICZbaTMyOyAxMDAwXSwKICAgIHRleHRfbGVuOiBpMzIsCiAgICBwYXR0ZXJuOiAmW2kzMjsgMTBdLAogICAgcGF0dGVybl9sZW46IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IG11dCBtYXRjaGVzOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDw9IHRleHRfbGVuIC0gcGF0dGVybl9sZW4pIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBtYXRjaF9mb3VuZDogYm9vbCA9IHRydWU7CgogICAgICAgIHdoaWxlIChqIDwgcGF0dGVybl9sZW4pIHsKICAgICAgICAgICAgaWYgKHRleHRbKGkgKyBqKSBhcyB1c2l6ZV0gIT0gcGF0dGVybltqIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgbWF0Y2hfZm91bmQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CgogICAgICAgIGlmIChtYXRjaF9mb3VuZCkgewogICAgICAgICAgICBtYXRjaGVzID0gbWF0Y2hlcyArIDE7CiAgICAgICAgfQoKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcmV0dXJuIG1hdGNoZXM7Cn0KCi8vIEtNUCBzdHJpbmcgc2VhcmNoIGFsZ29yaXRobQpmbiBrbXBTdHJpbmdTZWFyY2goCiAgICB0ZXh0OiAmW2kzMjsgMTAwMF0sCiAgICB0ZXh0X2xlbjogaTMyLAogICAgcGF0dGVybjogJltpMzI7IDEwXSwKICAgIHBhdHRlcm5fbGVuOiBpMzIsCikgLT4gaTMyIHsKICAgIGxldCBtdXQgbHBzOiBbaTMyOyAyMF0gPSBbMDsgMjBdOyAvLyBMb25nZXN0IHByb3BlciBwcmVmaXggc3VmZml4IGFycmF5CiAgICBjb21wdXRlTFBTQXJyYXkocGF0dGVybiwgcGF0dGVybl9sZW4sICZtdXQgbHBzKTsKCiAgICBsZXQgbXV0IG1hdGNoZXM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7IC8vIEluZGV4IGZvciB0ZXh0CiAgICBsZXQgbXV0IGo6IGkzMiA9IDA7IC8vIEluZGV4IGZvciBwYXR0ZXJuCgogICAgd2hpbGUgKGkgPCB0ZXh0X2xlbikgewogICAgICAgIGlmIChwYXR0ZXJuW2ogYXMgdXNpemVdID09IHRleHRbaSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoaiA9PSBwYXR0ZXJuX2xlbikgewogICAgICAgICAgICBtYXRjaGVzID0gbWF0Y2hlcyArIDE7CiAgICAgICAgICAgIGogPSBscHNbaiBhcyB1c2l6ZSAtIDFdOwogICAgICAgIH0gZWxzZSBpZiAoaSA8IHRleHRfbGVuICYmIHBhdHRlcm5baiBhcyB1c2l6ZV0gIT0gdGV4dFtpIGFzIHVzaXplXSkgewogICAgICAgICAgICBpZiAoaiAhPSAwKSB7CiAgICAgICAgICAgICAgICBqID0gbHBzW2ogYXMgdXNpemUgLSAxXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbWF0Y2hlczsKfQoKLy8gQ29tcHV0ZSBMUFMgYXJyYXkgZm9yIEtNUCBhbGdvcml0aG0KZm4gY29tcHV0ZUxQU0FycmF5KHBhdHRlcm46ICZbaTMyOyAxMF0sIHBhdHRlcm5fbGVuOiBpMzIsIGxwczogJm11dCBbaTMyOyAyMF0pIHsKICAgIGxldCBtdXQgbGVuOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAxOwoKICAgIGxwc1swXSA9IDA7CgogICAgd2hpbGUgKGkgPCBwYXR0ZXJuX2xlbikgewogICAgICAgIGlmIChwYXR0ZXJuW2kgYXMgdXNpemVdID09IHBhdHRlcm5bbGVuIGFzIHVzaXplXSkgewogICAgICAgICAgICBsZW4gPSBsZW4gKyAxOwogICAgICAgICAgICBscHNbaSBhcyB1c2l6ZV0gPSBsZW47CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAobGVuICE9IDApIHsKICAgICAgICAgICAgICAgIGxlbiA9IGxwc1tsZW4gYXMgdXNpemUgLSAxXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxwc1tpIGFzIHVzaXplXSA9IDA7CiAgICAgICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCi8vIEJveWVyLU1vb3JlLWxpa2Ugc3RyaW5nIHNlYXJjaCAoc2ltcGxpZmllZCkKZm4gYm95ZXJNb29yZVN0cmluZ1NlYXJjaCgKICAgIHRleHQ6ICZbaTMyOyAxMDAwXSwKICAgIHRleHRfbGVuOiBpMzIsCiAgICBwYXR0ZXJuOiAmW2kzMjsgMTBdLAogICAgcGF0dGVybl9sZW46IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IG11dCBiYWRfY2hhcjogW2kzMjsgMjU2XSA9IFstMTsgMjU2XTsgLy8gQmFkIGNoYXJhY3RlciB0YWJsZQoKICAgIC8vIFByZXByb2Nlc3MgcGF0dGVybiBmb3IgYmFkIGNoYXJhY3RlciBoZXVyaXN0aWMKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgcGF0dGVybl9sZW4pIHsKICAgICAgICBpZiAocGF0dGVybltpIGFzIHVzaXplXSA+PSAwICYmIHBhdHRlcm5baSBhcyB1c2l6ZV0gPCAyNTYpIHsKICAgICAgICAgICAgYmFkX2NoYXJbcGF0dGVybltpIGFzIHVzaXplXSBhcyB1c2l6ZV0gPSBpOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgbGV0IG11dCBtYXRjaGVzOiBpMzIgPSAwOwogICAgbGV0IG11dCBzaGlmdDogaTMyID0gMDsKCiAgICB3aGlsZSAoc2hpZnQgPD0gdGV4dF9sZW4gLSBwYXR0ZXJuX2xlbikgewogICAgICAgIGxldCBtdXQgajogaTMyID0gcGF0dGVybl9sZW4gLSAxOwoKICAgICAgICB3aGlsZSAoaiA+PSAwICYmIHBhdHRlcm5baiBhcyB1c2l6ZV0gPT0gdGV4dFsoc2hpZnQgKyBqKSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgaiA9IGogLSAxOwogICAgICAgIH0KCiAgICAgICAgaWYgKGogPCAwKSB7CiAgICAgICAgICAgIG1hdGNoZXMgPSBtYXRjaGVzICsgMTsKICAgICAgICAgICAgaWYgKHNoaWZ0ICsgcGF0dGVybl9sZW4gPCB0ZXh0X2xlbikgewogICAgICAgICAgICAgICAgc2hpZnQgPQogICAgICAgICAgICAgICAgICAgIHNoaWZ0ICsgcGF0dGVybl9sZW4gLSBiYWRfY2hhclt0ZXh0WyhzaGlmdCArIHBhdHRlcm5fbGVuKSBhcyB1c2l6ZV0gYXMgdXNpemVdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc2hpZnQgPSBzaGlmdCArIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsZXQgYmFkX2NoYXJfc2hpZnQ6IGkzMiA9CiAgICAgICAgICAgICAgICBpZiAodGV4dFsoc2hpZnQgKyBqKSBhcyB1c2l6ZV0gPj0gMCAmJiB0ZXh0WyhzaGlmdCArIGopIGFzIHVzaXplXSA8IDI1NikgewogICAgICAgICAgICAgICAgICAgIGogLSBiYWRfY2hhclt0ZXh0WyhzaGlmdCArIGopIGFzIHVzaXplXSBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgMQogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGlmIChiYWRfY2hhcl9zaGlmdCA+IDEpIHsKICAgICAgICAgICAgICAgIHNoaWZ0ID0gc2hpZnQgKyBiYWRfY2hhcl9zaGlmdDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNoaWZ0ID0gc2hpZnQgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHJldHVybiBtYXRjaGVzOwp9CgovLyBNdWx0aXBsZSBwYXR0ZXJuIHNlYXJjaApmbiBtdWx0aXBsZVBhdHRlcm5TZWFyY2godGV4dDogJltpMzI7IDEwMDBdLCB0ZXh0X2xlbjogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCB0b3RhbF9tYXRjaGVzOiBpMzIgPSAwOwoKICAgIC8vIERlZmluZSBtdWx0aXBsZSBwYXR0ZXJucyB0byBzZWFyY2ggZm9yCiAgICBsZXQgbXV0IHBhdHRlcm4xOiBbaTMyOyAxMF0gPSBbNjUsIDY2LCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXTsgLy8gIkFCIgogICAgbGV0IG11dCBwYXR0ZXJuMjogW2kzMjsgMTBdID0gWzY3LCA2OCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF07IC8vICJDRCIKICAgIGxldCBtdXQgcGF0dGVybjM6IFtpMzI7IDEwXSA9IFs2OSwgNzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOyAvLyAiRUYiCgogICAgdG90YWxfbWF0Y2hlcyA9IHRvdGFsX21hdGNoZXMgKyBuYWl2ZVN0cmluZ1NlYXJjaCh0ZXh0LCB0ZXh0X2xlbiwgJnBhdHRlcm4xLCAyKTsKICAgIHRvdGFsX21hdGNoZXMgPSB0b3RhbF9tYXRjaGVzICsgbmFpdmVTdHJpbmdTZWFyY2godGV4dCwgdGV4dF9sZW4sICZwYXR0ZXJuMiwgMik7CiAgICB0b3RhbF9tYXRjaGVzID0gdG90YWxfbWF0Y2hlcyArIG5haXZlU3RyaW5nU2VhcmNoKHRleHQsIHRleHRfbGVuLCAmcGF0dGVybjMsIDIpOwoKICAgIHJldHVybiB0b3RhbF9tYXRjaGVzOwp9CgovLyBUZXN0IDI6IFRleHQgUHJvY2Vzc2luZyBBbGdvcml0aG1zCmZuIHRlc3RUZXh0UHJvY2Vzc2luZ0FsZ29yaXRobXMoKSB7CiAgICBwcmludGxuSW50KDE2MDMpOyAvLyBTdGFydCB0ZXh0IHByb2Nlc3NpbmcgdGVzdAoKICAgIGxldCBtdXQgdGV4dDogW2kzMjsgMjAwMF0gPSBbMDsgMjAwMF07CiAgICBpbml0aWFsaXplTGFyZ2VUZXh0KCZtdXQgdGV4dCk7CgogICAgLy8gVGVzdCBjaGFyYWN0ZXIgZnJlcXVlbmN5IGNvdW50aW5nCiAgICBsZXQgZnJlcV9yZXN1bHQ6IGkzMiA9IGNoYXJhY3RlckZyZXF1ZW5jeUFuYWx5c2lzKCZ0ZXh0LCAyMDAwKTsKICAgIHByaW50bG5JbnQoZnJlcV9yZXN1bHQpOwoKICAgIC8vIFRlc3QgdGV4dCB0cmFuc2Zvcm1hdGlvbiBhbGdvcml0aG1zCiAgICBsZXQgdHJhbnNmb3JtX3Jlc3VsdDogaTMyID0gdGV4dFRyYW5zZm9ybWF0aW9uQWxnb3JpdGhtcygmbXV0IHRleHQsIDIwMDApOwogICAgcHJpbnRsbkludCh0cmFuc2Zvcm1fcmVzdWx0KTsKCiAgICAvLyBUZXN0IHdvcmQgY291bnRpbmcgYW5kIGFuYWx5c2lzCiAgICBsZXQgd29yZF9jb3VudF9yZXN1bHQ6IGkzMiA9IHdvcmRDb3VudGluZ0FsZ29yaXRobXMoJnRleHQsIDIwMDApOwogICAgcHJpbnRsbkludCh3b3JkX2NvdW50X3Jlc3VsdCk7CgogICAgLy8gVGVzdCB0ZXh0IGZpbHRlcmluZyBhbmQgY2xlYW5pbmcKICAgIGxldCBmaWx0ZXJfcmVzdWx0OiBpMzIgPSB0ZXh0RmlsdGVyaW5nQWxnb3JpdGhtcygmbXV0IHRleHQsIDIwMDApOwogICAgcHJpbnRsbkludChmaWx0ZXJfcmVzdWx0KTsKCiAgICBwcmludGxuSW50KDE2MDQpOyAvLyBFbmQgdGV4dCBwcm9jZXNzaW5nIHRlc3QKfQoKLy8gSW5pdGlhbGl6ZSBsYXJnZSB0ZXh0IGZvciBwcm9jZXNzaW5nCmZuIGluaXRpYWxpemVMYXJnZVRleHQodGV4dDogJm11dCBbaTMyOyAyMDAwXSkgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgbGV0IG11dCBzZWVkOiBpMzIgPSA1MjE7CgogICAgd2hpbGUgKGkgPCAyMDAwKSB7CiAgICAgICAgc2VlZCA9IChzZWVkICogMTY2ICsgMTk0MjIzKSAlIDIxNDc0NDc7CiAgICAgICAgaWYgKHNlZWQgPCAwKSB7CiAgICAgICAgICAgIHNlZWQgPSAtc2VlZDsKICAgICAgICB9CgogICAgICAgIC8vIEdlbmVyYXRlIG1vc3RseSBsb3dlcmNhc2UgbGV0dGVycyB3aXRoIHNvbWUgc3BhY2VzIGFuZCBwdW5jdHVhdGlvbgogICAgICAgIGxldCBjaGFyX3R5cGU6IGkzMiA9IHNlZWQgJSAxMDA7CiAgICAgICAgaWYgKGNoYXJfdHlwZSA8IDcwKSB7CiAgICAgICAgICAgIHRleHRbaSBhcyB1c2l6ZV0gPSA5NyArIChzZWVkICUgMjYpOyAvLyBsb3dlcmNhc2UgYS16CiAgICAgICAgfSBlbHNlIGlmIChjaGFyX3R5cGUgPCA4NSkgewogICAgICAgICAgICB0ZXh0W2kgYXMgdXNpemVdID0gNjUgKyAoc2VlZCAlIDI2KTsgLy8gdXBwZXJjYXNlIEEtWgogICAgICAgIH0gZWxzZSBpZiAoY2hhcl90eXBlIDwgOTUpIHsKICAgICAgICAgICAgdGV4dFtpIGFzIHVzaXplXSA9IDMyOyAvLyBzcGFjZQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRleHRbaSBhcyB1c2l6ZV0gPSAzMyArIChzZWVkICUgMTUpOyAvLyBwdW5jdHVhdGlvbgogICAgICAgIH0KCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBDaGFyYWN0ZXIgZnJlcXVlbmN5IGFuYWx5c2lzCmZuIGNoYXJhY3RlckZyZXF1ZW5jeUFuYWx5c2lzKHRleHQ6ICZbaTMyOyAyMDAwXSwgdGV4dF9sZW46IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgZnJlcV90YWJsZTogW2kzMjsgMjU2XSA9IFswOyAyNTZdOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIC8vIENvdW50IGNoYXJhY3RlciBmcmVxdWVuY2llcwogICAgd2hpbGUgKGkgPCB0ZXh0X2xlbikgewogICAgICAgIGlmICh0ZXh0W2kgYXMgdXNpemVdID49IDAgJiYgdGV4dFtpIGFzIHVzaXplXSA8IDI1NikgewogICAgICAgICAgICBmcmVxX3RhYmxlW3RleHRbaSBhcyB1c2l6ZV0gYXMgdXNpemVdID0gZnJlcV90YWJsZVt0ZXh0W2kgYXMgdXNpemVdIGFzIHVzaXplXSArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBGaW5kIG1vc3QgZnJlcXVlbnQgY2hhcmFjdGVyCiAgICBsZXQgbXV0IG1heF9mcmVxOiBpMzIgPSAwOwogICAgbGV0IG11dCBtb3N0X2ZyZXF1ZW50X2NoYXI6IGkzMiA9IDA7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgMjU2KSB7CiAgICAgICAgaWYgKGZyZXFfdGFibGVbaSBhcyB1c2l6ZV0gPiBtYXhfZnJlcSkgewogICAgICAgICAgICBtYXhfZnJlcSA9IGZyZXFfdGFibGVbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIG1vc3RfZnJlcXVlbnRfY2hhciA9IGk7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gbW9zdF9mcmVxdWVudF9jaGFyICsgbWF4X2ZyZXE7Cn0KCi8vIFRleHQgdHJhbnNmb3JtYXRpb24gYWxnb3JpdGhtcwpmbiB0ZXh0VHJhbnNmb3JtYXRpb25BbGdvcml0aG1zKHRleHQ6ICZtdXQgW2kzMjsgMjAwMF0sIHRleHRfbGVuOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHRyYW5zZm9ybWF0aW9uczogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICAvLyBDb252ZXJ0IHRvIHVwcGVyY2FzZQogICAgd2hpbGUgKGkgPCB0ZXh0X2xlbikgewogICAgICAgIGlmICh0ZXh0W2kgYXMgdXNpemVdID49IDk3ICYmIHRleHRbaSBhcyB1c2l6ZV0gPD0gMTIyKSB7CiAgICAgICAgICAgIC8vIGxvd2VyY2FzZSBhLXoKICAgICAgICAgICAgdGV4dFtpIGFzIHVzaXplXSA9IHRleHRbaSBhcyB1c2l6ZV0gLSAzMjsgLy8gQ29udmVydCB0byB1cHBlcmNhc2UKICAgICAgICAgICAgdHJhbnNmb3JtYXRpb25zID0gdHJhbnNmb3JtYXRpb25zICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIENhZXNhciBjaXBoZXIgdHJhbnNmb3JtYXRpb24KICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCB0ZXh0X2xlbikgewogICAgICAgIGlmICh0ZXh0W2kgYXMgdXNpemVdID49IDY1ICYmIHRleHRbaSBhcyB1c2l6ZV0gPD0gOTApIHsKICAgICAgICAgICAgLy8gdXBwZXJjYXNlIEEtWgogICAgICAgICAgICB0ZXh0W2kgYXMgdXNpemVdID0gNjUgKyAoKHRleHRbaSBhcyB1c2l6ZV0gLSA2NSArIDMpICUgMjYpOyAvLyBTaGlmdCBieSAzCiAgICAgICAgICAgIHRyYW5zZm9ybWF0aW9ucyA9IHRyYW5zZm9ybWF0aW9ucyArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBST1QxMyB0cmFuc2Zvcm1hdGlvbgogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IHRleHRfbGVuKSB7CiAgICAgICAgaWYgKHRleHRbaSBhcyB1c2l6ZV0gPj0gNjUgJiYgdGV4dFtpIGFzIHVzaXplXSA8PSA5MCkgewogICAgICAgICAgICAvLyB1cHBlcmNhc2UgQS1aCiAgICAgICAgICAgIHRleHRbaSBhcyB1c2l6ZV0gPSA2NSArICgodGV4dFtpIGFzIHVzaXplXSAtIDY1ICsgMTMpICUgMjYpOyAvLyBST1QxMwogICAgICAgICAgICB0cmFuc2Zvcm1hdGlvbnMgPSB0cmFuc2Zvcm1hdGlvbnMgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcmV0dXJuIHRyYW5zZm9ybWF0aW9uczsKfQoKLy8gV29yZCBjb3VudGluZyBhbGdvcml0aG1zCmZuIHdvcmRDb3VudGluZ0FsZ29yaXRobXModGV4dDogJltpMzI7IDIwMDBdLCB0ZXh0X2xlbjogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCB3b3JkX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBpbl93b3JkOiBib29sID0gZmFsc2U7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgLy8gQ291bnQgd29yZHMgKHNlcXVlbmNlcyBvZiBub24tc3BhY2UgY2hhcmFjdGVycykKICAgIHdoaWxlIChpIDwgdGV4dF9sZW4pIHsKICAgICAgICBpZiAodGV4dFtpIGFzIHVzaXplXSA9PSAzMiB8fCB0ZXh0W2kgYXMgdXNpemVdID09IDkgfHwgdGV4dFtpIGFzIHVzaXplXSA9PSAxMCkgewogICAgICAgICAgICAvLyBzcGFjZSwgdGFiLCBuZXdsaW5lCiAgICAgICAgICAgIGluX3dvcmQgPSBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoIWluX3dvcmQpIHsKICAgICAgICAgICAgICAgIHdvcmRfY291bnQgPSB3b3JkX2NvdW50ICsgMTsKICAgICAgICAgICAgICAgIGluX3dvcmQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBDb3VudCBzcGVjaWZpYyBjaGFyYWN0ZXIgcGF0dGVybnMKICAgIGxldCBtdXQgcGF0dGVybl9jb3VudDogaTMyID0gMDsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCB0ZXh0X2xlbiAtIDIpIHsKICAgICAgICAvLyBDb3VudCAiVEhFIiBwYXR0ZXJucwogICAgICAgIGlmICgodGV4dFtpIGFzIHVzaXplXSA9PSA4NCB8fCB0ZXh0W2kgYXMgdXNpemVdID09IDExNikgJiYgLy8gVCBvciB0CiAgICAgICAgICAgKHRleHRbaSBhcyB1c2l6ZSArIDFdID09IDcyIHx8IHRleHRbaSBhcyB1c2l6ZSArIDFdID09IDEwNCkgJiYgLy8gSCBvciBoCiAgICAgICAgICAgKHRleHRbaSBhcyB1c2l6ZSArIDJdID09IDY5IHx8IHRleHRbaSBhcyB1c2l6ZSArIDJdID09IDEwMSkpCiAgICAgICAgewogICAgICAgICAgICAvLyBFIG9yIGUKICAgICAgICAgICAgcGF0dGVybl9jb3VudCA9IHBhdHRlcm5fY291bnQgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcmV0dXJuIHdvcmRfY291bnQgKyBwYXR0ZXJuX2NvdW50Owp9CgovLyBUZXh0IGZpbHRlcmluZyBhbGdvcml0aG1zCmZuIHRleHRGaWx0ZXJpbmdBbGdvcml0aG1zKHRleHQ6ICZtdXQgW2kzMjsgMjAwMF0sIHRleHRfbGVuOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGZpbHRlcmVkX2NoYXJzOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIC8vIFJlbW92ZSBub24tcHJpbnRhYmxlIGNoYXJhY3RlcnMKICAgIHdoaWxlIChpIDwgdGV4dF9sZW4pIHsKICAgICAgICBpZiAodGV4dFtpIGFzIHVzaXplXSA8IDMyIHx8IHRleHRbaSBhcyB1c2l6ZV0gPiAxMjYpIHsKICAgICAgICAgICAgdGV4dFtpIGFzIHVzaXplXSA9IDMyOyAvLyBSZXBsYWNlIHdpdGggc3BhY2UKICAgICAgICAgICAgZmlsdGVyZWRfY2hhcnMgPSBmaWx0ZXJlZF9jaGFycyArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBSZW1vdmUgY29uc2VjdXRpdmUgc3BhY2VzCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgdGV4dF9sZW4gLSAxKSB7CiAgICAgICAgaWYgKHRleHRbaSBhcyB1c2l6ZV0gPT0gMzIgJiYgdGV4dFtpIGFzIHVzaXplICsgMV0gPT0gMzIpIHsKICAgICAgICAgICAgLy8gU2hpZnQgcmVtYWluaW5nIGNoYXJhY3RlcnMgbGVmdAogICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IGkgKyAxOwogICAgICAgICAgICB3aGlsZSAoaiA8IHRleHRfbGVuIC0gMSkgewogICAgICAgICAgICAgICAgdGV4dFtqIGFzIHVzaXplXSA9IHRleHRbaiBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRleHRbdGV4dF9sZW4gYXMgdXNpemUgLSAxXSA9IDA7CiAgICAgICAgICAgIGZpbHRlcmVkX2NoYXJzID0gZmlsdGVyZWRfY2hhcnMgKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIGZpbHRlcmVkX2NoYXJzOwp9CgovLyBUZXN0IDM6IFN0cmluZyBQYXJzaW5nIEFsZ29yaXRobXMKZm4gdGVzdFN0cmluZ1BhcnNpbmdBbGdvcml0aG1zKCkgewogICAgcHJpbnRsbkludCgxNjA1KTsgLy8gU3RhcnQgcGFyc2luZyB0ZXN0CgogICAgbGV0IG11dCBpbnB1dF90ZXh0OiBbaTMyOyAxMDAwXSA9IFswOyAxMDAwXTsKICAgIGluaXRpYWxpemVQYXJzaW5nVGV4dCgmbXV0IGlucHV0X3RleHQpOwoKICAgIC8vIFRlc3QgbnVtYmVyIHBhcnNpbmcgZnJvbSB0ZXh0CiAgICBsZXQgbnVtYmVyX3BhcnNpbmdfcmVzdWx0OiBpMzIgPSBwYXJzZU51bWJlcnNGcm9tVGV4dCgmaW5wdXRfdGV4dCwgMTAwMCk7CiAgICBwcmludGxuSW50KG51bWJlcl9wYXJzaW5nX3Jlc3VsdCk7CgogICAgLy8gVGVzdCBDU1YtbGlrZSBwYXJzaW5nCiAgICBsZXQgY3N2X3BhcnNpbmdfcmVzdWx0OiBpMzIgPSBwYXJzZUNTVkxpa2VEYXRhKCZpbnB1dF90ZXh0LCAxMDAwKTsKICAgIHByaW50bG5JbnQoY3N2X3BhcnNpbmdfcmVzdWx0KTsKCiAgICAvLyBUZXN0IHRva2VuaXphdGlvbiBhbGdvcml0aG1zCiAgICBsZXQgdG9rZW5pemF0aW9uX3Jlc3VsdDogaTMyID0gdG9rZW5pemVUZXh0KCZpbnB1dF90ZXh0LCAxMDAwKTsKICAgIHByaW50bG5JbnQodG9rZW5pemF0aW9uX3Jlc3VsdCk7CgogICAgLy8gVGVzdCBleHByZXNzaW9uIHBhcnNpbmcKICAgIGxldCBleHByZXNzaW9uX3Jlc3VsdDogaTMyID0gcGFyc2VTaW1wbGVFeHByZXNzaW9ucygmaW5wdXRfdGV4dCwgMTAwMCk7CiAgICBwcmludGxuSW50KGV4cHJlc3Npb25fcmVzdWx0KTsKCiAgICBwcmludGxuSW50KDE2MDYpOyAvLyBFbmQgcGFyc2luZyB0ZXN0Cn0KCi8vIEluaXRpYWxpemUgdGV4dCBmb3IgcGFyc2luZyB0ZXN0cwpmbiBpbml0aWFsaXplUGFyc2luZ1RleHQodGV4dDogJm11dCBbaTMyOyAxMDAwXSkgewogICAgLy8gQ3JlYXRlIHRleHQgd2l0aCBudW1iZXJzLCBjb21tYXMsIGFuZCBleHByZXNzaW9ucwogICAgbGV0IHNhbXBsZV90ZXh0OiBbaTMyOyA1MF0gPSBbCiAgICAgICAgNDksIDUwLCA1MSwgNDQsIDUyLCA1MywgNTQsIDQ0LCA1NSwgNTYsIDU3LCAzMiwgLy8gIjEyMyw0NTYsNzg5ICIKICAgICAgICA0MywgMzIsIDQ5LCA1MCwgNTEsIDMyLCA0NSwgMzIsIDUyLCA1MywgNTQsIDMyLCAvLyAiKyAxMjMgLSA0NTYgIgogICAgICAgIDQyLCAzMiwgNTUsIDU2LCAzMiwgNDcsIDMyLCA1NywgMzIsIDYxLCAzMiwgNDksIDQ4LCA0OCwgMCwgLy8gIiogNzggLyA5ID0gMTAwIgogICAgICAgIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsCiAgICBdOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgNTAgJiYgaSA8IDEwMDApIHsKICAgICAgICB0ZXh0W2kgYXMgdXNpemVdID0gc2FtcGxlX3RleHRbaSBhcyB1c2l6ZV07CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIEZpbGwgcmVzdCB3aXRoIGdlbmVyYXRlZCBjb250ZW50CiAgICBsZXQgbXV0IHNlZWQ6IGkzMiA9IDk5OwogICAgd2hpbGUgKGkgPCAxMDAwKSB7CiAgICAgICAgc2VlZCA9IChzZWVkICogNTI1ICsgNTQyMjMpICUgNDgzNjQ3OwogICAgICAgIGlmIChzZWVkIDwgMCkgewogICAgICAgICAgICBzZWVkID0gLXNlZWQ7CiAgICAgICAgfQoKICAgICAgICBsZXQgY2hhcl90eXBlOiBpMzIgPSBzZWVkICUgMTAwOwogICAgICAgIGlmIChjaGFyX3R5cGUgPCA0MCkgewogICAgICAgICAgICB0ZXh0W2kgYXMgdXNpemVdID0gNDggKyAoc2VlZCAlIDEwKTsgLy8gZGlnaXRzIDAtOQogICAgICAgIH0gZWxzZSBpZiAoY2hhcl90eXBlIDwgNTApIHsKICAgICAgICAgICAgdGV4dFtpIGFzIHVzaXplXSA9IDQ0OyAvLyBjb21tYQogICAgICAgIH0gZWxzZSBpZiAoY2hhcl90eXBlIDwgNjApIHsKICAgICAgICAgICAgdGV4dFtpIGFzIHVzaXplXSA9IDMyOyAvLyBzcGFjZQogICAgICAgIH0gZWxzZSBpZiAoY2hhcl90eXBlIDwgNzApIHsKICAgICAgICAgICAgdGV4dFtpIGFzIHVzaXplXSA9IDQzICsgKHNlZWQgJSA0KTsgLy8gKywgLSwgKiwgLwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRleHRbaSBhcyB1c2l6ZV0gPSA5NyArIChzZWVkICUgMjYpOyAvLyBsb3dlcmNhc2UgbGV0dGVycwogICAgICAgIH0KCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBQYXJzZSBudW1iZXJzIGZyb20gdGV4dApmbiBwYXJzZU51bWJlcnNGcm9tVGV4dCh0ZXh0OiAmW2kzMjsgMTAwMF0sIHRleHRfbGVuOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IG51bWJlcnNfZm91bmQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGN1cnJlbnRfbnVtYmVyOiBpMzIgPSAwOwogICAgbGV0IG11dCBpbl9udW1iZXI6IGJvb2wgPSBmYWxzZTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICB3aGlsZSAoaSA8IHRleHRfbGVuKSB7CiAgICAgICAgaWYgKHRleHRbaSBhcyB1c2l6ZV0gPj0gNDggJiYgdGV4dFtpIGFzIHVzaXplXSA8PSA1NykgewogICAgICAgICAgICAvLyBkaWdpdCAwLTkKICAgICAgICAgICAgaWYgKCFpbl9udW1iZXIpIHsKICAgICAgICAgICAgICAgIGN1cnJlbnRfbnVtYmVyID0gMDsKICAgICAgICAgICAgICAgIGluX251bWJlciA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY3VycmVudF9udW1iZXIgPSBjdXJyZW50X251bWJlciAqIDEwICsgKHRleHRbaSBhcyB1c2l6ZV0gLSA0OCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKGluX251bWJlcikgewogICAgICAgICAgICAgICAgbnVtYmVyc19mb3VuZCA9IG51bWJlcnNfZm91bmQgKyAxOwogICAgICAgICAgICAgICAgaW5fbnVtYmVyID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGlmIChpbl9udW1iZXIpIHsKICAgICAgICBudW1iZXJzX2ZvdW5kID0gbnVtYmVyc19mb3VuZCArIDE7CiAgICB9CgogICAgcmV0dXJuIG51bWJlcnNfZm91bmQ7Cn0KCi8vIFBhcnNlIENTVi1saWtlIGRhdGEKZm4gcGFyc2VDU1ZMaWtlRGF0YSh0ZXh0OiAmW2kzMjsgMTAwMF0sIHRleHRfbGVuOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGZpZWxkczogaTMyID0gMDsKICAgIGxldCBtdXQgcm93czogaTMyID0gMDsKICAgIGxldCBtdXQgaW5fZmllbGQ6IGJvb2wgPSBmYWxzZTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICB3aGlsZSAoaSA8IHRleHRfbGVuKSB7CiAgICAgICAgaWYgKHRleHRbaSBhcyB1c2l6ZV0gPT0gNDQpIHsKICAgICAgICAgICAgLy8gY29tbWEKICAgICAgICAgICAgaWYgKGluX2ZpZWxkKSB7CiAgICAgICAgICAgICAgICBmaWVsZHMgPSBmaWVsZHMgKyAxOwogICAgICAgICAgICAgICAgaW5fZmllbGQgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodGV4dFtpIGFzIHVzaXplXSA9PSAxMCB8fCB0ZXh0W2kgYXMgdXNpemVdID09IDEzKSB7CiAgICAgICAgICAgIC8vIG5ld2xpbmUgb3IgY2FycmlhZ2UgcmV0dXJuCiAgICAgICAgICAgIGlmIChpbl9maWVsZCkgewogICAgICAgICAgICAgICAgZmllbGRzID0gZmllbGRzICsgMTsKICAgICAgICAgICAgICAgIGluX2ZpZWxkID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcm93cyA9IHJvd3MgKyAxOwogICAgICAgIH0gZWxzZSBpZiAodGV4dFtpIGFzIHVzaXplXSAhPSAzMikgewogICAgICAgICAgICAvLyBub3Qgc3BhY2UKICAgICAgICAgICAgaWYgKCFpbl9maWVsZCkgewogICAgICAgICAgICAgICAgaW5fZmllbGQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBpZiAoaW5fZmllbGQpIHsKICAgICAgICBmaWVsZHMgPSBmaWVsZHMgKyAxOwogICAgfQoKICAgIHJldHVybiBmaWVsZHMgKyByb3dzOwp9CgovLyBUb2tlbml6ZSB0ZXh0IGludG8gZGlmZmVyZW50IHRva2VuIHR5cGVzCmZuIHRva2VuaXplVGV4dCh0ZXh0OiAmW2kzMjsgMTAwMF0sIHRleHRfbGVuOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHRva2VuczogaTMyID0gMDsKICAgIGxldCBtdXQgY3VycmVudF90b2tlbl90eXBlOiBpMzIgPSAwOyAvLyAwOiBub25lLCAxOiBudW1iZXIsIDI6IGxldHRlciwgMzogb3BlcmF0b3IsIDQ6IHB1bmN0dWF0aW9uCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgd2hpbGUgKGkgPCB0ZXh0X2xlbikgewogICAgICAgIGxldCBuZXdfdG9rZW5fdHlwZTogaTMyID0gaWYgKHRleHRbaSBhcyB1c2l6ZV0gPj0gNDggJiYgdGV4dFtpIGFzIHVzaXplXSA8PSA1NykgewogICAgICAgICAgICAxIC8vIGRpZ2l0CiAgICAgICAgfSBlbHNlIGlmICgodGV4dFtpIGFzIHVzaXplXSA+PSA2NSAmJiB0ZXh0W2kgYXMgdXNpemVdIDw9IDkwKQogICAgICAgICAgICB8fCAodGV4dFtpIGFzIHVzaXplXSA+PSA5NyAmJiB0ZXh0W2kgYXMgdXNpemVdIDw9IDEyMikpCiAgICAgICAgewogICAgICAgICAgICAyIC8vIGxldHRlcgogICAgICAgIH0gZWxzZSBpZiAodGV4dFtpIGFzIHVzaXplXSA9PSA0MwogICAgICAgICAgICB8fCB0ZXh0W2kgYXMgdXNpemVdID09IDQ1CiAgICAgICAgICAgIHx8IHRleHRbaSBhcyB1c2l6ZV0gPT0gNDIKICAgICAgICAgICAgfHwgdGV4dFtpIGFzIHVzaXplXSA9PSA0NykKICAgICAgICB7CiAgICAgICAgICAgIDMgLy8gKywgLSwgKiwgLwogICAgICAgIH0gZWxzZSBpZiAodGV4dFtpIGFzIHVzaXplXSA9PSA0NCB8fCB0ZXh0W2kgYXMgdXNpemVdID09IDQ2IHx8IHRleHRbaSBhcyB1c2l6ZV0gPT0gNTkpIHsKICAgICAgICAgICAgNCAvLyBjb21tYSwgcGVyaW9kLCBzZW1pY29sb24KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAwIC8vIHdoaXRlc3BhY2Ugb3Igb3RoZXIKICAgICAgICB9OwoKICAgICAgICBpZiAobmV3X3Rva2VuX3R5cGUgIT0gMCAmJiBuZXdfdG9rZW5fdHlwZSAhPSBjdXJyZW50X3Rva2VuX3R5cGUpIHsKICAgICAgICAgICAgaWYgKGN1cnJlbnRfdG9rZW5fdHlwZSAhPSAwKSB7CiAgICAgICAgICAgICAgICB0b2tlbnMgPSB0b2tlbnMgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGN1cnJlbnRfdG9rZW5fdHlwZSA9IG5ld190b2tlbl90eXBlOwogICAgICAgIH0gZWxzZSBpZiAobmV3X3Rva2VuX3R5cGUgPT0gMCkgewogICAgICAgICAgICBpZiAoY3VycmVudF90b2tlbl90eXBlICE9IDApIHsKICAgICAgICAgICAgICAgIHRva2VucyA9IHRva2VucyArIDE7CiAgICAgICAgICAgICAgICBjdXJyZW50X3Rva2VuX3R5cGUgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgaWYgKGN1cnJlbnRfdG9rZW5fdHlwZSAhPSAwKSB7CiAgICAgICAgdG9rZW5zID0gdG9rZW5zICsgMTsKICAgIH0KCiAgICByZXR1cm4gdG9rZW5zOwp9CgovLyBQYXJzZSBzaW1wbGUgbWF0aGVtYXRpY2FsIGV4cHJlc3Npb25zCmZuIHBhcnNlU2ltcGxlRXhwcmVzc2lvbnModGV4dDogJltpMzI7IDEwMDBdLCB0ZXh0X2xlbjogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBleHByZXNzaW9uczogaTMyID0gMDsKICAgIGxldCBtdXQgb3BlcmF0b3JzOiBpMzIgPSAwOwogICAgbGV0IG11dCBudW1iZXJzOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDwgdGV4dF9sZW4pIHsKICAgICAgICBpZiAodGV4dFtpIGFzIHVzaXplXSA+PSA0OCAmJiB0ZXh0W2kgYXMgdXNpemVdIDw9IDU3KSB7CiAgICAgICAgICAgIC8vIGRpZ2l0CiAgICAgICAgICAgIC8vIFNraXAgdGhyb3VnaCB0aGUgZW50aXJlIG51bWJlcgogICAgICAgICAgICB3aGlsZSAoaSA8IHRleHRfbGVuICYmIHRleHRbaSBhcyB1c2l6ZV0gPj0gNDggJiYgdGV4dFtpIGFzIHVzaXplXSA8PSA1NykgewogICAgICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG51bWJlcnMgPSBudW1iZXJzICsgMTsKICAgICAgICAgICAgaSA9IGkgLSAxOyAvLyBBZGp1c3QgZm9yIGxvb3AgaW5jcmVtZW50CiAgICAgICAgfSBlbHNlIGlmICh0ZXh0W2kgYXMgdXNpemVdID09IDQzCiAgICAgICAgICAgIHx8IHRleHRbaSBhcyB1c2l6ZV0gPT0gNDUKICAgICAgICAgICAgfHwgdGV4dFtpIGFzIHVzaXplXSA9PSA0MgogICAgICAgICAgICB8fCB0ZXh0W2kgYXMgdXNpemVdID09IDQ3KQogICAgICAgIHsKICAgICAgICAgICAgLy8gb3BlcmF0b3JzCiAgICAgICAgICAgIG9wZXJhdG9ycyA9IG9wZXJhdG9ycyArIDE7CiAgICAgICAgfSBlbHNlIGlmICh0ZXh0W2kgYXMgdXNpemVdID09IDYxKSB7CiAgICAgICAgICAgIC8vIGVxdWFscyBzaWduCiAgICAgICAgICAgIGlmIChudW1iZXJzID4gMCAmJiBvcGVyYXRvcnMgPiAwKSB7CiAgICAgICAgICAgICAgICBleHByZXNzaW9ucyA9IGV4cHJlc3Npb25zICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBudW1iZXJzID0gMDsKICAgICAgICAgICAgb3BlcmF0b3JzID0gMDsKICAgICAgICB9CgogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gZXhwcmVzc2lvbnM7Cn0KCi8vIFRlc3QgNDogU3RyaW5nIENvbXByZXNzaW9uIEFsZ29yaXRobXMKZm4gdGVzdFN0cmluZ0NvbXByZXNzaW9uQWxnb3JpdGhtcygpIHsKICAgIHByaW50bG5JbnQoMTYwNyk7IC8vIFN0YXJ0IGNvbXByZXNzaW9uIHRlc3QKCiAgICBsZXQgbXV0IHRleHQ6IFtpMzI7IDE1MDBdID0gWzA7IDE1MDBdOwogICAgaW5pdGlhbGl6ZUNvbXByZXNzaW9uVGV4dCgmbXV0IHRleHQpOwoKICAgIC8vIFRlc3QgcnVuLWxlbmd0aCBlbmNvZGluZwogICAgbGV0IHJsZV9yZXN1bHQ6IGkzMiA9IHJ1bkxlbmd0aEVuY29kaW5nKCZ0ZXh0LCAxNTAwKTsKICAgIHByaW50bG5JbnQocmxlX3Jlc3VsdCk7CgogICAgLy8gVGVzdCBzaW1wbGUgZGljdGlvbmFyeSBjb21wcmVzc2lvbgogICAgbGV0IGRpY3RfcmVzdWx0OiBpMzIgPSBzaW1wbGVEaWN0aW9uYXJ5Q29tcHJlc3Npb24oJnRleHQsIDE1MDApOwogICAgcHJpbnRsbkludChkaWN0X3Jlc3VsdCk7CgogICAgLy8gVGVzdCBwYXR0ZXJuLWJhc2VkIGNvbXByZXNzaW9uCiAgICBsZXQgcGF0dGVybl9yZXN1bHQ6IGkzMiA9IHBhdHRlcm5CYXNlZENvbXByZXNzaW9uKCZ0ZXh0LCAxNTAwKTsKICAgIHByaW50bG5JbnQocGF0dGVybl9yZXN1bHQpOwoKICAgIC8vIFRlc3QgaHVmZm1hbi1saWtlIGZyZXF1ZW5jeSBlbmNvZGluZwogICAgbGV0IGZyZXF1ZW5jeV9yZXN1bHQ6IGkzMiA9IGZyZXF1ZW5jeUJhc2VkRW5jb2RpbmcoJnRleHQsIDE1MDApOwogICAgcHJpbnRsbkludChmcmVxdWVuY3lfcmVzdWx0KTsKCiAgICBwcmludGxuSW50KDE2MDgpOyAvLyBFbmQgY29tcHJlc3Npb24gdGVzdAp9CgovLyBJbml0aWFsaXplIHRleHQgd2l0aCBwYXR0ZXJucyBzdWl0YWJsZSBmb3IgY29tcHJlc3Npb24KZm4gaW5pdGlhbGl6ZUNvbXByZXNzaW9uVGV4dCh0ZXh0OiAmbXV0IFtpMzI7IDE1MDBdKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgLy8gQ3JlYXRlIHRleHQgd2l0aCByZXBlYXRpbmcgcGF0dGVybnMKICAgIHdoaWxlIChpIDwgMTUwMCkgewogICAgICAgIGlmIChpICUgMTAwIDwgMjApIHsKICAgICAgICAgICAgdGV4dFtpIGFzIHVzaXplXSA9IDY1OyAvLyAnQScgLSBmcmVxdWVudCBjaGFyYWN0ZXIKICAgICAgICB9IGVsc2UgaWYgKGkgJSAxMDAgPCA0MCkgewogICAgICAgICAgICB0ZXh0W2kgYXMgdXNpemVdID0gNjY7IC8vICdCJwogICAgICAgIH0gZWxzZSBpZiAoaSAlIDEwMCA8IDYwKSB7CiAgICAgICAgICAgIHRleHRbaSBhcyB1c2l6ZV0gPSA2NzsgLy8gJ0MnCiAgICAgICAgfSBlbHNlIGlmIChpICUgMTAwIDwgODApIHsKICAgICAgICAgICAgdGV4dFtpIGFzIHVzaXplXSA9IDMyOyAvLyBTcGFjZQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRleHRbaSBhcyB1c2l6ZV0gPSA2OCArIChpICUgNSk7IC8vIEQsIEUsIEYsIEcsIEgKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBSdW4tbGVuZ3RoIGVuY29kaW5nCmZuIHJ1bkxlbmd0aEVuY29kaW5nKHRleHQ6ICZbaTMyOyAxNTAwXSwgdGV4dF9sZW46IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgY29tcHJlc3NlZF9zaXplOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDwgdGV4dF9sZW4pIHsKICAgICAgICBsZXQgY3VycmVudF9jaGFyOiBpMzIgPSB0ZXh0W2kgYXMgdXNpemVdOwogICAgICAgIGxldCBtdXQgY291bnQ6IGkzMiA9IDE7CgogICAgICAgIC8vIENvdW50IGNvbnNlY3V0aXZlIG9jY3VycmVuY2VzCiAgICAgICAgd2hpbGUgKGkgKyBjb3VudCA8IHRleHRfbGVuICYmIHRleHRbKGkgKyBjb3VudCkgYXMgdXNpemVdID09IGN1cnJlbnRfY2hhcikgewogICAgICAgICAgICBjb3VudCA9IGNvdW50ICsgMTsKICAgICAgICB9CgogICAgICAgIC8vIEluIGFjdHVhbCBSTEUsIHdlJ2Qgc3RvcmUgY2hhciArIGNvdW50CiAgICAgICAgLy8gSGVyZSB3ZSBqdXN0IGNhbGN1bGF0ZSBjb21wcmVzc2VkIHNpemUKICAgICAgICBpZiAoY291bnQgPiAzKSB7CiAgICAgICAgICAgIGNvbXByZXNzZWRfc2l6ZSA9IGNvbXByZXNzZWRfc2l6ZSArIDI7IC8vIGNoYXIgKyBjb3VudAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbXByZXNzZWRfc2l6ZSA9IGNvbXByZXNzZWRfc2l6ZSArIGNvdW50OyAvLyBzdG9yZSBhcyBpcwogICAgICAgIH0KCiAgICAgICAgaSA9IGkgKyBjb3VudDsKICAgIH0KCiAgICByZXR1cm4gY29tcHJlc3NlZF9zaXplOwp9CgovLyBTaW1wbGUgZGljdGlvbmFyeSBjb21wcmVzc2lvbgpmbiBzaW1wbGVEaWN0aW9uYXJ5Q29tcHJlc3Npb24odGV4dDogJltpMzI7IDE1MDBdLCB0ZXh0X2xlbjogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBkaWN0aW9uYXJ5OiBbaTMyOyAyNTZdID0gWzA7IDI1Nl07IC8vIGZyZXF1ZW5jeSBjb3VudAogICAgbGV0IG11dCB1bmlxdWVfY2hhcnM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgLy8gQnVpbGQgZnJlcXVlbmN5IGRpY3Rpb25hcnkKICAgIHdoaWxlIChpIDwgdGV4dF9sZW4pIHsKICAgICAgICBpZiAodGV4dFtpIGFzIHVzaXplXSA+PSAwICYmIHRleHRbaSBhcyB1c2l6ZV0gPCAyNTYpIHsKICAgICAgICAgICAgaWYgKGRpY3Rpb25hcnlbdGV4dFtpIGFzIHVzaXplXSBhcyB1c2l6ZV0gPT0gMCkgewogICAgICAgICAgICAgICAgdW5pcXVlX2NoYXJzID0gdW5pcXVlX2NoYXJzICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBkaWN0aW9uYXJ5W3RleHRbaSBhcyB1c2l6ZV0gYXMgdXNpemVdID0gZGljdGlvbmFyeVt0ZXh0W2kgYXMgdXNpemVdIGFzIHVzaXplXSArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBDYWxjdWxhdGUgY29tcHJlc3Npb24gcmF0aW8gYmFzZWQgb24gdW5pcXVlIGNoYXJhY3RlcnMKICAgIGxldCBiaXRzX3Blcl9jaGFyOiBpMzIgPSBpZiAodW5pcXVlX2NoYXJzIDw9IDIpIHsKICAgICAgICAxCiAgICB9IGVsc2UgaWYgKHVuaXF1ZV9jaGFycyA8PSA0KSB7CiAgICAgICAgMgogICAgfSBlbHNlIGlmICh1bmlxdWVfY2hhcnMgPD0gMTYpIHsKICAgICAgICA0CiAgICB9IGVsc2UgewogICAgICAgIDgKICAgIH07CgogICAgcmV0dXJuICh0ZXh0X2xlbiAqIGJpdHNfcGVyX2NoYXIpIC8gODsgLy8gY29tcHJlc3NlZCBzaXplIGluIGJ5dGVzCn0KCi8vIFBhdHRlcm4tYmFzZWQgY29tcHJlc3Npb24KZm4gcGF0dGVybkJhc2VkQ29tcHJlc3Npb24odGV4dDogJltpMzI7IDE1MDBdLCB0ZXh0X2xlbjogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBwYXR0ZXJuc19mb3VuZDogaTMyID0gMDsKICAgIGxldCBtdXQgc2F2aW5nczogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICAvLyBMb29rIGZvciBjb21tb24gMi1jaGFyYWN0ZXIgcGF0dGVybnMKICAgIHdoaWxlIChpIDwgdGV4dF9sZW4gLSAxKSB7CiAgICAgICAgbGV0IHBhdHRlcm46IGkzMiA9IHRleHRbaSBhcyB1c2l6ZV0gKiAyNTYgKyB0ZXh0W2kgYXMgdXNpemUgKyAxXTsgLy8gQ29tYmluZSB0d28gY2hhcnMKICAgICAgICBsZXQgbXV0IHBhdHRlcm5fY291bnQ6IGkzMiA9IDE7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSBpICsgMjsKCiAgICAgICAgLy8gQ291bnQgb2NjdXJyZW5jZXMgb2YgdGhpcyBwYXR0ZXJuCiAgICAgICAgd2hpbGUgKGogPCB0ZXh0X2xlbiAtIDEpIHsKICAgICAgICAgICAgaWYgKHRleHRbaiBhcyB1c2l6ZV0gKiAyNTYgKyB0ZXh0W2ogYXMgdXNpemUgKyAxXSA9PSBwYXR0ZXJuKSB7CiAgICAgICAgICAgICAgICBwYXR0ZXJuX2NvdW50ID0gcGF0dGVybl9jb3VudCArIDE7CiAgICAgICAgICAgICAgICBqID0gaiArIDI7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChwYXR0ZXJuX2NvdW50ID4gMikgewogICAgICAgICAgICBwYXR0ZXJuc19mb3VuZCA9IHBhdHRlcm5zX2ZvdW5kICsgMTsKICAgICAgICAgICAgc2F2aW5ncyA9IHNhdmluZ3MgKyBwYXR0ZXJuX2NvdW50OyAvLyBFYWNoIHBhdHRlcm4gaW5zdGFuY2Ugc2F2ZXMgc3BhY2UKICAgICAgICB9CgogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gcGF0dGVybnNfZm91bmQgKyBzYXZpbmdzOwp9CgovLyBGcmVxdWVuY3ktYmFzZWQgZW5jb2RpbmcgKEh1ZmZtYW4tbGlrZSkKZm4gZnJlcXVlbmN5QmFzZWRFbmNvZGluZyh0ZXh0OiAmW2kzMjsgMTUwMF0sIHRleHRfbGVuOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGZyZXF1ZW5jaWVzOiBbaTMyOyAyNTZdID0gWzA7IDI1Nl07CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgLy8gQ2FsY3VsYXRlIGNoYXJhY3RlciBmcmVxdWVuY2llcwogICAgd2hpbGUgKGkgPCB0ZXh0X2xlbikgewogICAgICAgIGlmICh0ZXh0W2kgYXMgdXNpemVdID49IDAgJiYgdGV4dFtpIGFzIHVzaXplXSA8IDI1NikgewogICAgICAgICAgICBmcmVxdWVuY2llc1t0ZXh0W2kgYXMgdXNpemVdIGFzIHVzaXplXSA9IGZyZXF1ZW5jaWVzW3RleHRbaSBhcyB1c2l6ZV0gYXMgdXNpemVdICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIENhbGN1bGF0ZSB3ZWlnaHRlZCBiaXQgbGVuZ3RoIChzaW1wbGlmaWVkIEh1ZmZtYW4pCiAgICBsZXQgbXV0IHRvdGFsX2JpdHM6IGkzMiA9IDA7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgMjU2KSB7CiAgICAgICAgaWYgKGZyZXF1ZW5jaWVzW2kgYXMgdXNpemVdID4gMCkgewogICAgICAgICAgICBsZXQgYml0X2xlbmd0aDogaTMyID0gaWYgKGZyZXF1ZW5jaWVzW2kgYXMgdXNpemVdID4gdGV4dF9sZW4gLyAyKSB7CiAgICAgICAgICAgICAgICAxIC8vIE1vc3QgZnJlcXVlbnQgZ2V0cyAxIGJpdAogICAgICAgICAgICB9IGVsc2UgaWYgKGZyZXF1ZW5jaWVzW2kgYXMgdXNpemVdID4gdGV4dF9sZW4gLyA4KSB7CiAgICAgICAgICAgICAgICAzIC8vIENvbW1vbiBjaGFycyBnZXQgMyBiaXRzCiAgICAgICAgICAgIH0gZWxzZSBpZiAoZnJlcXVlbmNpZXNbaSBhcyB1c2l6ZV0gPiB0ZXh0X2xlbiAvIDMyKSB7CiAgICAgICAgICAgICAgICA1IC8vIExlc3MgY29tbW9uIGdldCA1IGJpdHMKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIDggLy8gUmFyZSBjaGFycyBnZXQgOCBiaXRzCiAgICAgICAgICAgIH07CgogICAgICAgICAgICB0b3RhbF9iaXRzID0gdG90YWxfYml0cyArIGZyZXF1ZW5jaWVzW2kgYXMgdXNpemVdICogYml0X2xlbmd0aDsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHJldHVybiB0b3RhbF9iaXRzIC8gODsgLy8gQ29udmVydCB0byBieXRlcwp9CgovLyBUZXN0IDU6IEFkdmFuY2VkIFN0cmluZyBBbGdvcml0aG1zCmZuIHRlc3RBZHZhbmNlZFN0cmluZ0FsZ29yaXRobXMoKSB7CiAgICBwcmludGxuSW50KDE2MDkpOyAvLyBTdGFydCBhZHZhbmNlZCB0ZXN0CgogICAgbGV0IG11dCB0ZXh0MTogW2kzMjsgODAwXSA9IFswOyA4MDBdOwogICAgbGV0IG11dCB0ZXh0MjogW2kzMjsgODAwXSA9IFswOyA4MDBdOwogICAgaW5pdGlhbGl6ZUFkdmFuY2VkVGVzdFN0cmluZ3MoJm11dCB0ZXh0MSwgJm11dCB0ZXh0Mik7CgogICAgLy8gVGVzdCBsb25nZXN0IGNvbW1vbiBzdWJzZXF1ZW5jZQogICAgbGV0IGxjc19yZXN1bHQ6IGkzMiA9IGxvbmdlc3RDb21tb25TdWJzZXF1ZW5jZSgmdGV4dDEsICZ0ZXh0MiwgMjAwLCAyMDApOwogICAgcHJpbnRsbkludChsY3NfcmVzdWx0KTsKCiAgICAvLyBUZXN0IGVkaXQgZGlzdGFuY2UgY2FsY3VsYXRpb24KICAgIGxldCBlZGl0X2Rpc3RhbmNlOiBpMzIgPSBjYWxjdWxhdGVFZGl0RGlzdGFuY2UoJnRleHQxLCAmdGV4dDIsIDEwMCwgMTAwKTsKICAgIHByaW50bG5JbnQoZWRpdF9kaXN0YW5jZSk7CgogICAgLy8gVGVzdCBwYWxpbmRyb21lIGRldGVjdGlvbgogICAgbGV0IHBhbGluZHJvbWVfcmVzdWx0OiBpMzIgPSBmaW5kTG9uZ2VzdFBhbGluZHJvbWUoJnRleHQxLCA0MDApOwogICAgcHJpbnRsbkludChwYWxpbmRyb21lX3Jlc3VsdCk7CgogICAgLy8gVGVzdCBzdHJpbmcgcm90YXRpb24gZGV0ZWN0aW9uCiAgICBsZXQgcm90YXRpb25fcmVzdWx0OiBpMzIgPSBkZXRlY3RTdHJpbmdSb3RhdGlvbnMoJnRleHQxLCAmdGV4dDIsIDIwMCwgMjAwKTsKICAgIHByaW50bG5JbnQocm90YXRpb25fcmVzdWx0KTsKCiAgICBwcmludGxuSW50KDE2MTApOyAvLyBFbmQgYWR2YW5jZWQgdGVzdAp9CgovLyBJbml0aWFsaXplIHN0cmluZ3MgZm9yIGFkdmFuY2VkIHRlc3RpbmcKZm4gaW5pdGlhbGl6ZUFkdmFuY2VkVGVzdFN0cmluZ3ModGV4dDE6ICZtdXQgW2kzMjsgODAwXSwgdGV4dDI6ICZtdXQgW2kzMjsgODAwXSkgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIC8vIENyZWF0ZSBzaW1pbGFyIGJ1dCBub3QgaWRlbnRpY2FsIHN0cmluZ3MKICAgIHdoaWxlIChpIDwgNDAwKSB7CiAgICAgICAgdGV4dDFbaSBhcyB1c2l6ZV0gPSA2NSArIChpICUgMjYpOyAvLyBBLVogcGF0dGVybgogICAgICAgIHRleHQyW2kgYXMgdXNpemVdID0gNjUgKyAoKGkgKyAzKSAlIDI2KTsgLy8gU2hpZnRlZCBwYXR0ZXJuCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIEFkZCBzb21lIGNvbW1vbiBzdWJzZXF1ZW5jZXMKICAgIHRleHQxWzEwMF0gPSA4ODsgLy8gJ1gnCiAgICB0ZXh0MVsxMDFdID0gODk7IC8vICdZJwogICAgdGV4dDFbMTAyXSA9IDkwOyAvLyAnWicKCiAgICB0ZXh0MlsxNTBdID0gODg7IC8vICdYJwogICAgdGV4dDJbMTUxXSA9IDg5OyAvLyAnWScKICAgIHRleHQyWzE1Ml0gPSA5MDsgLy8gJ1onCn0KCi8vIExvbmdlc3QgQ29tbW9uIFN1YnNlcXVlbmNlIHVzaW5nIGR5bmFtaWMgcHJvZ3JhbW1pbmcKZm4gbG9uZ2VzdENvbW1vblN1YnNlcXVlbmNlKHRleHQxOiAmW2kzMjsgODAwXSwgdGV4dDI6ICZbaTMyOyA4MDBdLCBsZW4xOiBpMzIsIGxlbjI6IGkzMikgLT4gaTMyIHsKICAgIC8vIFVzZSBhIHNpbXBsaWZpZWQgYXBwcm9hY2ggZHVlIHRvIGFycmF5IHNpemUgbGltaXRhdGlvbnMKICAgIGxldCBtdXQgcHJldl9yb3c6IFtpMzI7IDIwMV0gPSBbMDsgMjAxXTsKICAgIGxldCBtdXQgY3Vycl9yb3c6IFtpMzI7IDIwMV0gPSBbMDsgMjAxXTsKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDE7CiAgICB3aGlsZSAoaSA8PSBsZW4xICYmIGkgPD0gMjAwKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAxOwogICAgICAgIHdoaWxlIChqIDw9IGxlbjIgJiYgaiA8PSAyMDApIHsKICAgICAgICAgICAgaWYgKHRleHQxW2kgYXMgdXNpemUgLSAxXSA9PSB0ZXh0MltqIGFzIHVzaXplIC0gMV0pIHsKICAgICAgICAgICAgICAgIGN1cnJfcm93W2ogYXMgdXNpemVdID0gcHJldl9yb3dbaiBhcyB1c2l6ZSAtIDFdICsgMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChwcmV2X3Jvd1tqIGFzIHVzaXplXSA+IGN1cnJfcm93W2ogYXMgdXNpemUgLSAxXSkgewogICAgICAgICAgICAgICAgICAgIGN1cnJfcm93W2ogYXMgdXNpemVdID0gcHJldl9yb3dbaiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGN1cnJfcm93W2ogYXMgdXNpemVdID0gY3Vycl9yb3dbaiBhcyB1c2l6ZSAtIDFdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CgogICAgICAgIC8vIFN3YXAgcm93cwogICAgICAgIGogPSAwOwogICAgICAgIHdoaWxlIChqIDw9IGxlbjIgJiYgaiA8PSAyMDApIHsKICAgICAgICAgICAgcHJldl9yb3dbaiBhcyB1c2l6ZV0gPSBjdXJyX3Jvd1tqIGFzIHVzaXplXTsKICAgICAgICAgICAgY3Vycl9yb3dbaiBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQoKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgaWYgKGxlbjIgPD0gMjAwKSB7CiAgICAgICAgcHJldl9yb3dbbGVuMiBhcyB1c2l6ZV0KICAgIH0gZWxzZSB7CiAgICAgICAgcHJldl9yb3dbMjAwXQogICAgfQp9CgovLyBDYWxjdWxhdGUgZWRpdCBkaXN0YW5jZSAoTGV2ZW5zaHRlaW4gZGlzdGFuY2UpCmZuIGNhbGN1bGF0ZUVkaXREaXN0YW5jZSh0ZXh0MTogJltpMzI7IDgwMF0sIHRleHQyOiAmW2kzMjsgODAwXSwgbGVuMTogaTMyLCBsZW4yOiBpMzIpIC0+IGkzMiB7CiAgICAvLyBVc2Ugc2ltcGxpZmllZCBhcHByb2FjaCBmb3Igc21hbGxlciBzdHJpbmdzCiAgICBsZXQgbWF4X2xlbjogaTMyID0gMTAwOwogICAgbGV0IGFjdHVhbF9sZW4xOiBpMzIgPSBpZiAobGVuMSA+IG1heF9sZW4pIHsgbWF4X2xlbiB9IGVsc2UgeyBsZW4xIH07CgogICAgbGV0IGFjdHVhbF9sZW4yOiBpMzIgPSBpZiAobGVuMiA+IG1heF9sZW4pIHsgbWF4X2xlbiB9IGVsc2UgeyBsZW4yIH07CgogICAgbGV0IG11dCBwcmV2X3JvdzogW2kzMjsgMTAxXSA9IFswOyAxMDFdOwogICAgbGV0IG11dCBjdXJyX3JvdzogW2kzMjsgMTAxXSA9IFswOyAxMDFdOwoKICAgIC8vIEluaXRpYWxpemUgZmlyc3Qgcm93CiAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICB3aGlsZSAoaiA8PSBhY3R1YWxfbGVuMikgewogICAgICAgIHByZXZfcm93W2ogYXMgdXNpemVdID0gajsKICAgICAgICBqID0gaiArIDE7CiAgICB9CgogICAgbGV0IG11dCBpOiBpMzIgPSAxOwogICAgd2hpbGUgKGkgPD0gYWN0dWFsX2xlbjEpIHsKICAgICAgICBjdXJyX3Jvd1swXSA9IGk7CiAgICAgICAgaiA9IDE7CiAgICAgICAgd2hpbGUgKGogPD0gYWN0dWFsX2xlbjIpIHsKICAgICAgICAgICAgbGV0IGNvc3Q6IGkzMiA9IGlmICh0ZXh0MVtpIGFzIHVzaXplIC0gMV0gPT0gdGV4dDJbaiBhcyB1c2l6ZSAtIDFdKSB7CiAgICAgICAgICAgICAgICAwCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAxCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBsZXQgZGVsZXRlX2Nvc3Q6IGkzMiA9IHByZXZfcm93W2ogYXMgdXNpemVdICsgMTsKICAgICAgICAgICAgbGV0IGluc2VydF9jb3N0OiBpMzIgPSBjdXJyX3Jvd1tqIGFzIHVzaXplIC0gMV0gKyAxOwogICAgICAgICAgICBsZXQgc3Vic3RpdHV0ZV9jb3N0OiBpMzIgPSBwcmV2X3Jvd1tqIGFzIHVzaXplIC0gMV0gKyBjb3N0OwoKICAgICAgICAgICAgbGV0IG1pbl9jb3N0OiBpMzIgPSBpZiAoZGVsZXRlX2Nvc3QgPCBpbnNlcnRfY29zdCkgewogICAgICAgICAgICAgICAgZGVsZXRlX2Nvc3QKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGluc2VydF9jb3N0CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBpZiAoc3Vic3RpdHV0ZV9jb3N0IDwgbWluX2Nvc3QpIHsKICAgICAgICAgICAgICAgIGN1cnJfcm93W2ogYXMgdXNpemVdID0gc3Vic3RpdHV0ZV9jb3N0OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY3Vycl9yb3dbaiBhcyB1c2l6ZV0gPSBtaW5fY29zdDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KCiAgICAgICAgLy8gU3dhcCByb3dzCiAgICAgICAgaiA9IDA7CiAgICAgICAgd2hpbGUgKGogPD0gYWN0dWFsX2xlbjIpIHsKICAgICAgICAgICAgcHJldl9yb3dbaiBhcyB1c2l6ZV0gPSBjdXJyX3Jvd1tqIGFzIHVzaXplXTsKICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHJldHVybiBwcmV2X3Jvd1thY3R1YWxfbGVuMiBhcyB1c2l6ZV07Cn0KCi8vIEZpbmQgbG9uZ2VzdCBwYWxpbmRyb21lIGluIHN0cmluZwpmbiBmaW5kTG9uZ2VzdFBhbGluZHJvbWUodGV4dDogJltpMzI7IDgwMF0sIHRleHRfbGVuOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IG1heF9sZW5ndGg6IGkzMiA9IDE7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgLy8gQ2hlY2sgZm9yIG9kZC1sZW5ndGggcGFsaW5kcm9tZXMKICAgIHdoaWxlIChpIDwgdGV4dF9sZW4pIHsKICAgICAgICBsZXQgbXV0IGxlZnQ6IGkzMiA9IGk7CiAgICAgICAgbGV0IG11dCByaWdodDogaTMyID0gaTsKCiAgICAgICAgd2hpbGUgKGxlZnQgPj0gMCAmJiByaWdodCA8IHRleHRfbGVuICYmIHRleHRbbGVmdCBhcyB1c2l6ZV0gPT0gdGV4dFtyaWdodCBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgbGV0IGN1cnJlbnRfbGVuZ3RoOiBpMzIgPSByaWdodCAtIGxlZnQgKyAxOwogICAgICAgICAgICBpZiAoY3VycmVudF9sZW5ndGggPiBtYXhfbGVuZ3RoKSB7CiAgICAgICAgICAgICAgICBtYXhfbGVuZ3RoID0gY3VycmVudF9sZW5ndGg7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGVmdCA9IGxlZnQgLSAxOwogICAgICAgICAgICByaWdodCA9IHJpZ2h0ICsgMTsKICAgICAgICB9CgogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBDaGVjayBmb3IgZXZlbi1sZW5ndGggcGFsaW5kcm9tZXMKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCB0ZXh0X2xlbiAtIDEpIHsKICAgICAgICBsZXQgbXV0IGxlZnQ6IGkzMiA9IGk7CiAgICAgICAgbGV0IG11dCByaWdodDogaTMyID0gaSArIDE7CgogICAgICAgIHdoaWxlIChsZWZ0ID49IDAgJiYgcmlnaHQgPCB0ZXh0X2xlbiAmJiB0ZXh0W2xlZnQgYXMgdXNpemVdID09IHRleHRbcmlnaHQgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIGxldCBjdXJyZW50X2xlbmd0aDogaTMyID0gcmlnaHQgLSBsZWZ0ICsgMTsKICAgICAgICAgICAgaWYgKGN1cnJlbnRfbGVuZ3RoID4gbWF4X2xlbmd0aCkgewogICAgICAgICAgICAgICAgbWF4X2xlbmd0aCA9IGN1cnJlbnRfbGVuZ3RoOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxlZnQgPSBsZWZ0IC0gMTsKICAgICAgICAgICAgcmlnaHQgPSByaWdodCArIDE7CiAgICAgICAgfQoKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcmV0dXJuIG1heF9sZW5ndGg7Cn0KCi8vIERldGVjdCBpZiBvbmUgc3RyaW5nIGlzIGEgcm90YXRpb24gb2YgYW5vdGhlcgpmbiBkZXRlY3RTdHJpbmdSb3RhdGlvbnModGV4dDE6ICZbaTMyOyA4MDBdLCB0ZXh0MjogJltpMzI7IDgwMF0sIGxlbjE6IGkzMiwgbGVuMjogaTMyKSAtPiBpMzIgewogICAgaWYgKGxlbjEgIT0gbGVuMikgewogICAgICAgIHJldHVybiAwOyAvLyBEaWZmZXJlbnQgbGVuZ3RocyBjYW5ub3QgYmUgcm90YXRpb25zCiAgICB9CgogICAgbGV0IG11dCByb3RhdGlvbnNfZm91bmQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHNoaWZ0OiBpMzIgPSAwOwoKICAgIC8vIFRyeSBhbGwgcG9zc2libGUgcm90YXRpb25zCiAgICB3aGlsZSAoc2hpZnQgPCBsZW4xICYmIHNoaWZ0IDwgMjAwKSB7CiAgICAgICAgLy8gTGltaXQgZm9yIHBlcmZvcm1hbmNlCiAgICAgICAgbGV0IG11dCBpc19yb3RhdGlvbjogYm9vbCA9IHRydWU7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgICAgICB3aGlsZSAoaSA8IGxlbjEgJiYgaSA8IDIwMCkgewogICAgICAgICAgICBsZXQgcm90YXRlZF9pbmRleDogaTMyID0gKGkgKyBzaGlmdCkgJSBsZW4xOwogICAgICAgICAgICBpZiAodGV4dDFbaSBhcyB1c2l6ZV0gIT0gdGV4dDJbcm90YXRlZF9pbmRleCBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIGlzX3JvdGF0aW9uID0gZmFsc2U7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoaXNfcm90YXRpb24pIHsKICAgICAgICAgICAgcm90YXRpb25zX2ZvdW5kID0gcm90YXRpb25zX2ZvdW5kICsgMTsKICAgICAgICB9CgogICAgICAgIHNoaWZ0ID0gc2hpZnQgKyAxOwogICAgfQoKICAgIHJldHVybiByb3RhdGlvbnNfZm91bmQ7Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (7, "comprehensive7", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCA3OiBHcmFwaCBBbGdvcml0aG1zIGFuZCBOZXR3b3JrIEFuYWx5c2lzClN1bW1hcnk6IFRoaXMgdGVzdCBmb2N1c2VzIG9uIGNvbXBpbGVyIG9wdGltaXphdGlvbiBvZjoKRGV0YWlsczoKR3JhcGggdHJhdmVyc2FsIGFsZ29yaXRobSBvcHRpbWl6YXRpb25zCkR5bmFtaWMgcHJvZ3JhbW1pbmcgb24gZ3JhcGhzCkNvbXBsZXggbmVzdGVkIGxvb3Agc3RydWN0dXJlcyBpbiBncmFwaCBhbGdvcml0aG1zClBhdGggZmluZGluZyBhbGdvcml0aG0gb3B0aW1pemF0aW9ucwpOZXR3b3JrIGZsb3cgYWxnb3JpdGhtIG9wdGltaXphdGlvbnMKR3JhcGggZGF0YSBzdHJ1Y3R1cmUgYWNjZXNzIHBhdHRlcm4gb3B0aW1pemF0aW9ucwoqLwoKLy8gY29tcHJlaGVuc2l2ZTcucnggLSBDb21wcmVoZW5zaXZlIFRlc3QgNzogR3JhcGggQWxnb3JpdGhtcyBhbmQgTmV0d29yayBBbmFseXNpcwovLyBUaGlzIHRlc3QgZm9jdXNlcyBvbiBjb21waWxlciBvcHRpbWl6YXRpb24gb2Y6Ci8vIC0gR3JhcGggdHJhdmVyc2FsIGFsZ29yaXRobSBvcHRpbWl6YXRpb25zCi8vIC0gRHluYW1pYyBwcm9ncmFtbWluZyBvbiBncmFwaHMKLy8gLSBDb21wbGV4IG5lc3RlZCBsb29wIHN0cnVjdHVyZXMgaW4gZ3JhcGggYWxnb3JpdGhtcwovLyAtIFBhdGggZmluZGluZyBhbGdvcml0aG0gb3B0aW1pemF0aW9ucwovLyAtIE5ldHdvcmsgZmxvdyBhbGdvcml0aG0gb3B0aW1pemF0aW9ucwovLyAtIEdyYXBoIGRhdGEgc3RydWN0dXJlIGFjY2VzcyBwYXR0ZXJuIG9wdGltaXphdGlvbnMKCmZuIG1haW4oKSB7CiAgICAvLyBQZXJmb3JtYW5jZSB0ZXN0IG1hcmtlciAtIHN0YXJ0CiAgICBwcmludGxuSW50KDE3MDApOwogICAgCiAgICAvLyBUZXN0IDE6IEdyYXBoIHRyYXZlcnNhbCBhbGdvcml0aG1zIChERlMsIEJGUykKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiByZWN1cnNpdmUgYW5kIGl0ZXJhdGl2ZSBncmFwaCB0cmF2ZXJzYWwKICAgIHRlc3RHcmFwaFRyYXZlcnNhbEFsZ29yaXRobXMoKTsKICAgIAogICAgLy8gVGVzdCAyOiBTaG9ydGVzdCBwYXRoIGFsZ29yaXRobXMKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBkeW5hbWljIHByb2dyYW1taW5nIGFuZCByZWxheGF0aW9uIG9wZXJhdGlvbnMKICAgIHRlc3RTaG9ydGVzdFBhdGhBbGdvcml0aG1zKCk7CiAgICAKICAgIC8vIFRlc3QgMzogTWluaW11bSBzcGFubmluZyB0cmVlIGFsZ29yaXRobXMKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBncmVlZHkgYWxnb3JpdGhtcyBhbmQgdW5pb24tZmluZCBvcGVyYXRpb25zCiAgICB0ZXN0TWluaW11bVNwYW5uaW5nVHJlZUFsZ29yaXRobXMoKTsKICAgIAogICAgLy8gVGVzdCA0OiBOZXR3b3JrIGZsb3cgYWxnb3JpdGhtcwogICAgLy8gVGVzdHMgb3B0aW1pemF0aW9uIG9mIGF1Z21lbnRpbmcgcGF0aCBhbGdvcml0aG1zCiAgICB0ZXN0TmV0d29ya0Zsb3dBbGdvcml0aG1zKCk7CiAgICAKICAgIC8vIFRlc3QgNTogR3JhcGggY29ubmVjdGl2aXR5IGFuZCBjb21wb25lbnRzCiAgICAvLyBUZXN0cyBvcHRpbWl6YXRpb24gb2YgY29tcG9uZW50IGRldGVjdGlvbiBhbGdvcml0aG1zCiAgICB0ZXN0R3JhcGhDb25uZWN0aXZpdHlBbGdvcml0aG1zKCk7CiAgICAKICAgIC8vIFBlcmZvcm1hbmNlIHRlc3QgbWFya2VyIC0gZW5kCiAgICBwcmludGxuSW50KDE3OTkpOwogICAgZXhpdCgwKTsKfQoKLy8gVGVzdCAxOiBHcmFwaCBUcmF2ZXJzYWwgQWxnb3JpdGhtcwpmbiB0ZXN0R3JhcGhUcmF2ZXJzYWxBbGdvcml0aG1zKCkgewogICAgcHJpbnRsbkludCgxNzAxKTsgLy8gU3RhcnQgZ3JhcGggdHJhdmVyc2FsIHRlc3QKICAgIAogICAgLy8gQ3JlYXRlIGFkamFjZW5jeSBtYXRyaXggZm9yIGdyYXBoICg1MHg1MCBub2RlcykKICAgIGxldCBtdXQgZ3JhcGg6IFtpMzI7IDI1MDBdID0gWzA7IDI1MDBdOwogICAgaW5pdGlhbGl6ZUdyYXBoKCZtdXQgZ3JhcGgsIDUwKTsKICAgIAogICAgLy8gVGVzdCBEZXB0aC1GaXJzdCBTZWFyY2gKICAgIGxldCBkZnNfcmVzdWx0OiBpMzIgPSBkZXB0aEZpcnN0U2VhcmNoKCZncmFwaCwgNTAsIDApOwogICAgcHJpbnRsbkludChkZnNfcmVzdWx0KTsKICAgIAogICAgLy8gVGVzdCBCcmVhZHRoLUZpcnN0IFNlYXJjaCAgCiAgICBsZXQgYmZzX3Jlc3VsdDogaTMyID0gYnJlYWR0aEZpcnN0U2VhcmNoKCZncmFwaCwgNTAsIDApOwogICAgcHJpbnRsbkludChiZnNfcmVzdWx0KTsKICAgIAogICAgLy8gVGVzdCBpdGVyYXRpdmUgREZTCiAgICBsZXQgaXRlcmF0aXZlX2Rmc19yZXN1bHQ6IGkzMiA9IGl0ZXJhdGl2ZURlcHRoRmlyc3RTZWFyY2goJmdyYXBoLCA1MCwgMCk7CiAgICBwcmludGxuSW50KGl0ZXJhdGl2ZV9kZnNfcmVzdWx0KTsKICAgIAogICAgLy8gVGVzdCBjeWNsZSBkZXRlY3Rpb24KICAgIGxldCBjeWNsZV9yZXN1bHQ6IGkzMiA9IGRldGVjdEN5Y2xlcygmZ3JhcGgsIDUwKTsKICAgIHByaW50bG5JbnQoY3ljbGVfcmVzdWx0KTsKICAgIAogICAgcHJpbnRsbkludCgxNzAyKTsgLy8gRW5kIGdyYXBoIHRyYXZlcnNhbCB0ZXN0Cn0KCi8vIEluaXRpYWxpemUgZ3JhcGggd2l0aCBlZGdlcwpmbiBpbml0aWFsaXplR3JhcGgoZ3JhcGg6ICZtdXQgW2kzMjsgMjUwMF0sIHNpemU6IGkzMikgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgCiAgICAvLyBJbml0aWFsaXplIGFkamFjZW5jeSBtYXRyaXggdG8gMAogICAgd2hpbGUgKGkgPCBzaXplICogc2l6ZSkgewogICAgICAgIGdyYXBoW2kgYXMgdXNpemVdID0gMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIEFkZCBlZGdlcyBiYXNlZCBvbiBwYXR0ZXJuCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IHNpemUpIHsKICAgICAgICAgICAgaWYgKChpICE9IGopICYmICgoKGkgKyBqKSAlIDcgPT0gMCkgfHwgKChpICogaikgJSAxMSA9PSAwKSkpIHsKICAgICAgICAgICAgICAgIGdyYXBoWyhpICogc2l6ZSArIGopIGFzIHVzaXplXSA9IDEgKyAoaSArIGopICUgMTA7IC8vIEVkZ2Ugd2VpZ2h0CiAgICAgICAgICAgICAgICBncmFwaFsoaiAqIHNpemUgKyBpKSBhcyB1c2l6ZV0gPSAxICsgKGkgKyBqKSAlIDEwOyAvLyBNYWtlIHVuZGlyZWN0ZWQKICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gRGVwdGgtRmlyc3QgU2VhcmNoIChyZWN1cnNpdmUpCmZuIGRlcHRoRmlyc3RTZWFyY2goZ3JhcGg6ICZbaTMyOyAyNTAwXSwgc2l6ZTogaTMyLCBzdGFydDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCB2aXNpdGVkOiBbYm9vbDsgNTBdID0gW2ZhbHNlOyA1MF07CiAgICByZXR1cm4gZGZzUmVjdXJzaXZlKGdyYXBoLCBzaXplLCBzdGFydCwgJm11dCB2aXNpdGVkKTsKfQoKZm4gZGZzUmVjdXJzaXZlKGdyYXBoOiAmW2kzMjsgMjUwMF0sIHNpemU6IGkzMiwgbm9kZTogaTMyLCB2aXNpdGVkOiAmbXV0IFtib29sOyA1MF0pIC0+IGkzMiB7CiAgICB2aXNpdGVkW25vZGUgYXMgdXNpemVdID0gdHJ1ZTsKICAgIGxldCBtdXQgbm9kZXNfdmlzaXRlZDogaTMyID0gMTsKICAgIAogICAgbGV0IG11dCBuZWlnaGJvcjogaTMyID0gMDsKICAgIHdoaWxlIChuZWlnaGJvciA8IHNpemUpIHsKICAgICAgICBpZiAoKGdyYXBoWyhub2RlICogc2l6ZSArIG5laWdoYm9yKSBhcyB1c2l6ZV0gPiAwKSAmJiAoIXZpc2l0ZWRbbmVpZ2hib3IgYXMgdXNpemVdKSkgewogICAgICAgICAgICBub2Rlc192aXNpdGVkID0gbm9kZXNfdmlzaXRlZCArIGRmc1JlY3Vyc2l2ZShncmFwaCwgc2l6ZSwgbmVpZ2hib3IsIHZpc2l0ZWQpOwogICAgICAgIH0KICAgICAgICBuZWlnaGJvciA9IG5laWdoYm9yICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIG5vZGVzX3Zpc2l0ZWQ7Cn0KCi8vIEJyZWFkdGgtRmlyc3QgU2VhcmNoIChpdGVyYXRpdmUgd2l0aCBxdWV1ZSBzaW11bGF0aW9uKQpmbiBicmVhZHRoRmlyc3RTZWFyY2goZ3JhcGg6ICZbaTMyOyAyNTAwXSwgc2l6ZTogaTMyLCBzdGFydDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCB2aXNpdGVkOiBbYm9vbDsgNTBdID0gW2ZhbHNlOyA1MF07CiAgICBsZXQgbXV0IHF1ZXVlOiBbaTMyOyA1MF0gPSBbLTE7IDUwXTsKICAgIGxldCBtdXQgcXVldWVfZnJvbnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHF1ZXVlX3JlYXI6IGkzMiA9IDA7CiAgICBsZXQgbXV0IG5vZGVzX3Zpc2l0ZWQ6IGkzMiA9IDA7CiAgICAKICAgIC8vIEVucXVldWUgc3RhcnQgbm9kZQogICAgcXVldWVbcXVldWVfcmVhciBhcyB1c2l6ZV0gPSBzdGFydDsKICAgIHF1ZXVlX3JlYXIgPSBxdWV1ZV9yZWFyICsgMTsKICAgIHZpc2l0ZWRbc3RhcnQgYXMgdXNpemVdID0gdHJ1ZTsKICAgIAogICAgd2hpbGUgKHF1ZXVlX2Zyb250IDwgcXVldWVfcmVhcikgewogICAgICAgIGxldCBjdXJyZW50X25vZGU6IGkzMiA9IHF1ZXVlW3F1ZXVlX2Zyb250IGFzIHVzaXplXTsKICAgICAgICBxdWV1ZV9mcm9udCA9IHF1ZXVlX2Zyb250ICsgMTsKICAgICAgICBub2Rlc192aXNpdGVkID0gbm9kZXNfdmlzaXRlZCArIDE7CiAgICAgICAgCiAgICAgICAgLy8gVmlzaXQgYWxsIHVudmlzaXRlZCBuZWlnaGJvcnMKICAgICAgICBsZXQgbXV0IG5laWdoYm9yOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChuZWlnaGJvciA8IHNpemUpIHsKICAgICAgICAgICAgaWYgKChncmFwaFsoY3VycmVudF9ub2RlICogc2l6ZSArIG5laWdoYm9yKSBhcyB1c2l6ZV0gPiAwKSAmJiAoIXZpc2l0ZWRbbmVpZ2hib3IgYXMgdXNpemVdKSkgewogICAgICAgICAgICAgICAgdmlzaXRlZFtuZWlnaGJvciBhcyB1c2l6ZV0gPSB0cnVlOwogICAgICAgICAgICAgICAgcXVldWVbcXVldWVfcmVhciBhcyB1c2l6ZV0gPSBuZWlnaGJvcjsKICAgICAgICAgICAgICAgIHF1ZXVlX3JlYXIgPSBxdWV1ZV9yZWFyICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBuZWlnaGJvciA9IG5laWdoYm9yICsgMTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIHJldHVybiBub2Rlc192aXNpdGVkOwp9CgovLyBJdGVyYXRpdmUgRGVwdGgtRmlyc3QgU2VhcmNoIHVzaW5nIHN0YWNrCmZuIGl0ZXJhdGl2ZURlcHRoRmlyc3RTZWFyY2goZ3JhcGg6ICZbaTMyOyAyNTAwXSwgc2l6ZTogaTMyLCBzdGFydDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCB2aXNpdGVkOiBbYm9vbDsgNTBdID0gW2ZhbHNlOyA1MF07CiAgICBsZXQgbXV0IHN0YWNrOiBbaTMyOyAxMjUwXSA9IFstMTsgMTI1MF07IC8vIHxHfCBeIDIgLyAyIHRoZW9yZXRpY2FsbHkKICAgIGxldCBtdXQgc3RhY2tfdG9wOiBpMzIgPSAwOwogICAgbGV0IG11dCBub2Rlc192aXNpdGVkOiBpMzIgPSAwOwogICAgCiAgICAvLyBQdXNoIHN0YXJ0IG5vZGUgb250byBzdGFjawogICAgc3RhY2tbc3RhY2tfdG9wIGFzIHVzaXplXSA9IHN0YXJ0OwogICAgc3RhY2tfdG9wID0gc3RhY2tfdG9wICsgMTsKICAgIAogICAgd2hpbGUgKHN0YWNrX3RvcCA+IDApIHsKICAgICAgICAvLyBQb3Agbm9kZSBmcm9tIHN0YWNrCiAgICAgICAgc3RhY2tfdG9wID0gc3RhY2tfdG9wIC0gMTsKICAgICAgICBsZXQgY3VycmVudF9ub2RlOiBpMzIgPSBzdGFja1tzdGFja190b3AgYXMgdXNpemVdOwogICAgICAgIAogICAgICAgIGlmICgoIXZpc2l0ZWRbY3VycmVudF9ub2RlIGFzIHVzaXplXSkpIHsKICAgICAgICAgICAgdmlzaXRlZFtjdXJyZW50X25vZGUgYXMgdXNpemVdID0gdHJ1ZTsKICAgICAgICAgICAgbm9kZXNfdmlzaXRlZCA9IG5vZGVzX3Zpc2l0ZWQgKyAxOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gUHVzaCBhbGwgdW52aXNpdGVkIG5laWdoYm9ycyBvbnRvIHN0YWNrCiAgICAgICAgICAgIGxldCBtdXQgbmVpZ2hib3I6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChuZWlnaGJvciA8IHNpemUpIHsKICAgICAgICAgICAgICAgIGlmICgoZ3JhcGhbKGN1cnJlbnRfbm9kZSAqIHNpemUgKyBuZWlnaGJvcikgYXMgdXNpemVdID4gMCkgJiYgKCF2aXNpdGVkW25laWdoYm9yIGFzIHVzaXplXSkpIHsKICAgICAgICAgICAgICAgICAgICBzdGFja1tzdGFja190b3AgYXMgdXNpemVdID0gbmVpZ2hib3I7CiAgICAgICAgICAgICAgICAgICAgc3RhY2tfdG9wID0gc3RhY2tfdG9wICsgMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG5laWdoYm9yID0gbmVpZ2hib3IgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgCiAgICByZXR1cm4gbm9kZXNfdmlzaXRlZDsKfQoKLy8gRGV0ZWN0IGN5Y2xlcyBpbiBncmFwaCB1c2luZyBERlMKZm4gZGV0ZWN0Q3ljbGVzKGdyYXBoOiAmW2kzMjsgMjUwMF0sIHNpemU6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgdmlzaXRlZDogW2Jvb2w7IDUwXSA9IFtmYWxzZTsgNTBdOwogICAgbGV0IG11dCBpbl9yZWN1cnNpb25fc3RhY2s6IFtib29sOyA1MF0gPSBbZmFsc2U7IDUwXTsKICAgIGxldCBtdXQgY3ljbGVzX2ZvdW5kOiBpMzIgPSAwOwogICAgCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBpZiAoIXZpc2l0ZWRbaSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgaWYgKGRmc0N5Y2xlRGV0ZWN0aW9uKGdyYXBoLCBzaXplLCBpLCAmbXV0IHZpc2l0ZWQsICZtdXQgaW5fcmVjdXJzaW9uX3N0YWNrKSkgewogICAgICAgICAgICAgICAgY3ljbGVzX2ZvdW5kID0gY3ljbGVzX2ZvdW5kICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBjeWNsZXNfZm91bmQ7Cn0KCmZuIGRmc0N5Y2xlRGV0ZWN0aW9uKGdyYXBoOiAmW2kzMjsgMjUwMF0sIHNpemU6IGkzMiwgbm9kZTogaTMyLCAKICAgICAgICAgICAgICAgICAgICB2aXNpdGVkOiAmbXV0IFtib29sOyA1MF0sIGluX3JlY3Vyc2lvbl9zdGFjazogJm11dCBbYm9vbDsgNTBdKSAtPiBib29sIHsKICAgIHZpc2l0ZWRbbm9kZSBhcyB1c2l6ZV0gPSB0cnVlOwogICAgaW5fcmVjdXJzaW9uX3N0YWNrW25vZGUgYXMgdXNpemVdID0gdHJ1ZTsKICAgIAogICAgbGV0IG11dCBuZWlnaGJvcjogaTMyID0gMDsKICAgIHdoaWxlIChuZWlnaGJvciA8IHNpemUpIHsKICAgICAgICBpZiAoZ3JhcGhbKG5vZGUgKiBzaXplICsgbmVpZ2hib3IpIGFzIHVzaXplXSA+IDApIHsKICAgICAgICAgICAgaWYgKCF2aXNpdGVkW25laWdoYm9yIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgaWYgKGRmc0N5Y2xlRGV0ZWN0aW9uKGdyYXBoLCBzaXplLCBuZWlnaGJvciwgdmlzaXRlZCwgaW5fcmVjdXJzaW9uX3N0YWNrKSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYgKGluX3JlY3Vyc2lvbl9zdGFja1tuZWlnaGJvciBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIG5laWdoYm9yID0gbmVpZ2hib3IgKyAxOwogICAgfQogICAgCiAgICBpbl9yZWN1cnNpb25fc3RhY2tbbm9kZSBhcyB1c2l6ZV0gPSBmYWxzZTsKICAgIHJldHVybiBmYWxzZTsKfQoKLy8gVGVzdCAyOiBTaG9ydGVzdCBQYXRoIEFsZ29yaXRobXMKZm4gdGVzdFNob3J0ZXN0UGF0aEFsZ29yaXRobXMoKSB7CiAgICBwcmludGxuSW50KDE3MDMpOyAvLyBTdGFydCBzaG9ydGVzdCBwYXRoIHRlc3QKICAgIAogICAgbGV0IG11dCBncmFwaDogW2kzMjsgMjUwMF0gPSBbMDsgMjUwMF07CiAgICBpbml0aWFsaXplV2VpZ2h0ZWRHcmFwaCgmbXV0IGdyYXBoLCA1MCk7CiAgICAKICAgIC8vIFRlc3QgRGlqa3N0cmEncyBhbGdvcml0aG0KICAgIGxldCBkaWprc3RyYV9yZXN1bHQ6IGkzMiA9IGRpamtzdHJhU2hvcnRlc3RQYXRoKCZncmFwaCwgNTAsIDApOwogICAgcHJpbnRsbkludChkaWprc3RyYV9yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IEZsb3lkLVdhcnNoYWxsIGFsZ29yaXRobSAobGltaXRlZCBzaXplKQogICAgbGV0IGZsb3lkX3Jlc3VsdDogaTMyID0gZmxveWRXYXJzaGFsbEFsbFBhaXJzKCZncmFwaCwgMjApOwogICAgcHJpbnRsbkludChmbG95ZF9yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IEJlbGxtYW4tRm9yZCBhbGdvcml0aG0KICAgIGxldCBiZWxsbWFuX3Jlc3VsdDogaTMyID0gYmVsbG1hbkZvcmRTaG9ydGVzdFBhdGgoJmdyYXBoLCA1MCwgMCk7CiAgICBwcmludGxuSW50KGJlbGxtYW5fcmVzdWx0KTsKICAgIAogICAgcHJpbnRsbkludCgxNzA0KTsgLy8gRW5kIHNob3J0ZXN0IHBhdGggdGVzdAp9CgovLyBJbml0aWFsaXplIHdlaWdodGVkIGdyYXBoCmZuIGluaXRpYWxpemVXZWlnaHRlZEdyYXBoKGdyYXBoOiAmbXV0IFtpMzI7IDI1MDBdLCBzaXplOiBpMzIpIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIAogICAgLy8gSW5pdGlhbGl6ZSB3aXRoIGluZmluaXR5IChyZXByZXNlbnRlZCBieSA5OTk5KQogICAgd2hpbGUgKGkgPCBzaXplICogc2l6ZSkgewogICAgICAgIGdyYXBoW2kgYXMgdXNpemVdID0gOTk5OTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIFNldCBkaWFnb25hbCB0byAwIChkaXN0YW5jZSBmcm9tIG5vZGUgdG8gaXRzZWxmKQogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBncmFwaFsoaSAqIHNpemUgKyBpKSBhcyB1c2l6ZV0gPSAwOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgLy8gQWRkIHdlaWdodGVkIGVkZ2VzCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IHNpemUpIHsKICAgICAgICAgICAgaWYgKChpICE9IGopICYmICgoKGkgKyBqKSAlIDUgPT0gMCkgfHwgKChpICogMiArIGopICUgNyA9PSAwKSkpIHsKICAgICAgICAgICAgICAgIGxldCB3ZWlnaHQ6IGkzMiA9IDEgKyAoKGkgKyBqKSAlIDE1KTsKICAgICAgICAgICAgICAgIGdyYXBoWyhpICogc2l6ZSArIGopIGFzIHVzaXplXSA9IHdlaWdodDsKICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gRGlqa3N0cmEncyBzaG9ydGVzdCBwYXRoIGFsZ29yaXRobQpmbiBkaWprc3RyYVNob3J0ZXN0UGF0aChncmFwaDogJltpMzI7IDI1MDBdLCBzaXplOiBpMzIsIHN0YXJ0OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGRpc3RhbmNlczogW2kzMjsgNTBdID0gWzk5OTk7IDUwXTsKICAgIGxldCBtdXQgdmlzaXRlZDogW2Jvb2w7IDUwXSA9IFtmYWxzZTsgNTBdOwogICAgbGV0IG11dCB0b3RhbF9kaXN0YW5jZTogaTMyID0gMDsKICAgIAogICAgZGlzdGFuY2VzW3N0YXJ0IGFzIHVzaXplXSA9IDA7CiAgICAKICAgIGxldCBtdXQgY291bnQ6IGkzMiA9IDA7CiAgICB3aGlsZSAoY291bnQgPCBzaXplKSB7CiAgICAgICAgLy8gRmluZCBtaW5pbXVtIGRpc3RhbmNlIHVudmlzaXRlZCBub2RlCiAgICAgICAgbGV0IG11dCBtaW5fZGlzdGFuY2U6IGkzMiA9IDk5OTk7CiAgICAgICAgbGV0IG11dCBtaW5fbm9kZTogaTMyID0gLTE7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIAogICAgICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgICAgICBpZiAoKCF2aXNpdGVkW2kgYXMgdXNpemVdKSAmJiAoZGlzdGFuY2VzW2kgYXMgdXNpemVdIDwgbWluX2Rpc3RhbmNlKSkgewogICAgICAgICAgICAgICAgbWluX2Rpc3RhbmNlID0gZGlzdGFuY2VzW2kgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgbWluX25vZGUgPSBpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKG1pbl9ub2RlID09IC0xKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICAKICAgICAgICB2aXNpdGVkW21pbl9ub2RlIGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgdG90YWxfZGlzdGFuY2UgPSB0b3RhbF9kaXN0YW5jZSArIGRpc3RhbmNlc1ttaW5fbm9kZSBhcyB1c2l6ZV07CiAgICAgICAgCiAgICAgICAgLy8gVXBkYXRlIGRpc3RhbmNlcyB0byBuZWlnaGJvcnMKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICAgICAgaWYgKCghdmlzaXRlZFtpIGFzIHVzaXplXSkgJiYgKGdyYXBoWyhtaW5fbm9kZSAqIHNpemUgKyBpKSBhcyB1c2l6ZV0gIT0gOTk5OSkpIHsKICAgICAgICAgICAgICAgIGxldCBuZXdfZGlzdGFuY2U6IGkzMiA9IGRpc3RhbmNlc1ttaW5fbm9kZSBhcyB1c2l6ZV0gKyBncmFwaFsobWluX25vZGUgKiBzaXplICsgaSkgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgaWYgKG5ld19kaXN0YW5jZSA8IGRpc3RhbmNlc1tpIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlc1tpIGFzIHVzaXplXSA9IG5ld19kaXN0YW5jZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGNvdW50ID0gY291bnQgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gdG90YWxfZGlzdGFuY2U7Cn0KCi8vIEZsb3lkLVdhcnNoYWxsIGFsbC1wYWlycyBzaG9ydGVzdCBwYXRoCmZuIGZsb3lkV2Fyc2hhbGxBbGxQYWlycyhncmFwaDogJltpMzI7IDI1MDBdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICAvLyBDcmVhdGUgZGlzdGFuY2UgbWF0cml4IChsaW1pdGVkIHRvIDIweDIwIGZvciBwZXJmb3JtYW5jZSkKICAgIGxldCBhY3R1YWxfc2l6ZTogaTMyID0gaWYgKHNpemUgPiAyMCkgeyAyMCB9IGVsc2UgeyBzaXplIH07CiAgICAKICAgIGxldCBtdXQgZGlzdGFuY2VzOiBbaTMyOyA0MDBdID0gWzk5OTk7IDQwMF07CiAgICAKICAgIC8vIEluaXRpYWxpemUgZGlzdGFuY2VzCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IGFjdHVhbF9zaXplKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgYWN0dWFsX3NpemUpIHsKICAgICAgICAgICAgZGlzdGFuY2VzWyhpICogYWN0dWFsX3NpemUgKyBqKSBhcyB1c2l6ZV0gPSBncmFwaFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICAvLyBGbG95ZC1XYXJzaGFsbCBtYWluIGxvb3AKICAgIGxldCBtdXQgazogaTMyID0gMDsKICAgIHdoaWxlIChrIDwgYWN0dWFsX3NpemUpIHsKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IGFjdHVhbF9zaXplKSB7CiAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKGogPCBhY3R1YWxfc2l6ZSkgewogICAgICAgICAgICAgICAgaWYgKChkaXN0YW5jZXNbKGkgKiBhY3R1YWxfc2l6ZSArIGspIGFzIHVzaXplXSAhPSA5OTk5KSAmJiAKICAgICAgICAgICAgICAgICAgIChkaXN0YW5jZXNbKGsgKiBhY3R1YWxfc2l6ZSArIGopIGFzIHVzaXplXSAhPSA5OTk5KSkgewogICAgICAgICAgICAgICAgICAgIGxldCBuZXdfZGlzdGFuY2U6IGkzMiA9IGRpc3RhbmNlc1soaSAqIGFjdHVhbF9zaXplICsgaykgYXMgdXNpemVdICsgZGlzdGFuY2VzWyhrICogYWN0dWFsX3NpemUgKyBqKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld19kaXN0YW5jZSA8IGRpc3RhbmNlc1soaSAqIGFjdHVhbF9zaXplICsgaikgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlc1soaSAqIGFjdHVhbF9zaXplICsgaikgYXMgdXNpemVdID0gbmV3X2Rpc3RhbmNlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIGsgPSBrICsgMTsKICAgIH0KICAgIAogICAgLy8gU3VtIGFsbCBzaG9ydGVzdCBwYXRocwogICAgbGV0IG11dCB0b3RhbF9kaXN0YW5jZTogaTMyID0gMDsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBhY3R1YWxfc2l6ZSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IGFjdHVhbF9zaXplKSB7CiAgICAgICAgICAgIGlmICgoaSAhPSBqKSAmJiAoZGlzdGFuY2VzWyhpICogYWN0dWFsX3NpemUgKyBqKSBhcyB1c2l6ZV0gIT0gOTk5OSkpIHsKICAgICAgICAgICAgICAgIHRvdGFsX2Rpc3RhbmNlID0gdG90YWxfZGlzdGFuY2UgKyBkaXN0YW5jZXNbKGkgKiBhY3R1YWxfc2l6ZSArIGopIGFzIHVzaXplXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIHRvdGFsX2Rpc3RhbmNlOwp9CgovLyBCZWxsbWFuLUZvcmQgc2hvcnRlc3QgcGF0aCBhbGdvcml0aG0KZm4gYmVsbG1hbkZvcmRTaG9ydGVzdFBhdGgoZ3JhcGg6ICZbaTMyOyAyNTAwXSwgc2l6ZTogaTMyLCBzdGFydDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBkaXN0YW5jZXM6IFtpMzI7IDUwXSA9IFs5OTk5OyA1MF07CiAgICBkaXN0YW5jZXNbc3RhcnQgYXMgdXNpemVdID0gMDsKICAgIAogICAgbGV0IG11dCBuZWdhdGl2ZV9jeWNsZXM6IGkzMiA9IDA7CiAgICAvLyBSZWxheCBlZGdlcyBzaXplLTEgdGltZXMKICAgIGxldCBtdXQgaXRlcmF0aW9uOiBpMzIgPSAwOwogICAgd2hpbGUgKGl0ZXJhdGlvbiA8IHNpemUgLSAxKSB7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChqIDwgc2l6ZSkgewogICAgICAgICAgICAgICAgaWYgKChncmFwaFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV0gIT0gOTk5OSkgJiYgKGRpc3RhbmNlc1tpIGFzIHVzaXplXSAhPSA5OTk5KSkgewogICAgICAgICAgICAgICAgICAgIGxldCBuZXdfZGlzdGFuY2U6IGkzMiA9IGRpc3RhbmNlc1tpIGFzIHVzaXplXSArIGdyYXBoWyhpICogc2l6ZSArIGopIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICBpZiAobmV3X2Rpc3RhbmNlIDwgZGlzdGFuY2VzW2ogYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5lZ2F0aXZlX2N5Y2xlcyA9IG5lZ2F0aXZlX2N5Y2xlcyArIDE7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICAgICAgaXRlcmF0aW9uID0gaXRlcmF0aW9uICsgMTsKICAgIH0KICAgIAogICAgLy8gQ2hlY2sgZm9yIG5lZ2F0aXZlIGN5Y2xlcyAob25lIG1vcmUgaXRlcmF0aW9uKQogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgc2l6ZSkgewogICAgICAgICAgICBpZiAoKGdyYXBoWyhpICogc2l6ZSArIGopIGFzIHVzaXplXSAhPSA5OTk5KSAmJiAoZGlzdGFuY2VzW2kgYXMgdXNpemVdICE9IDk5OTkpKSB7CiAgICAgICAgICAgICAgICBsZXQgbmV3X2Rpc3RhbmNlOiBpMzIgPSBkaXN0YW5jZXNbaSBhcyB1c2l6ZV0gKyBncmFwaFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBpZiAobmV3X2Rpc3RhbmNlIDwgZGlzdGFuY2VzW2ogYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICAgICAgbmVnYXRpdmVfY3ljbGVzID0gbmVnYXRpdmVfY3ljbGVzICsgMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgLy8gUmV0dXJuIHN1bSBvZiBhbGwgZGlzdGFuY2VzCiAgICBsZXQgbXV0IHRvdGFsX2Rpc3RhbmNlOiBpMzIgPSAwOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBpZiAoZGlzdGFuY2VzW2kgYXMgdXNpemVdICE9IDk5OTkpIHsKICAgICAgICAgICAgdG90YWxfZGlzdGFuY2UgPSB0b3RhbF9kaXN0YW5jZSArIGRpc3RhbmNlc1tpIGFzIHVzaXplXTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gdG90YWxfZGlzdGFuY2UgKyBuZWdhdGl2ZV9jeWNsZXM7Cn0KCi8vIFRlc3QgMzogTWluaW11bSBTcGFubmluZyBUcmVlIEFsZ29yaXRobXMKZm4gdGVzdE1pbmltdW1TcGFubmluZ1RyZWVBbGdvcml0aG1zKCkgewogICAgcHJpbnRsbkludCgxNzA1KTsgLy8gU3RhcnQgTVNUIHRlc3QKICAgIAogICAgbGV0IG11dCBncmFwaDogW2kzMjsgMjUwMF0gPSBbMDsgMjUwMF07CiAgICBpbml0aWFsaXplV2VpZ2h0ZWRHcmFwaCgmbXV0IGdyYXBoLCA1MCk7CiAgICAKICAgIC8vIFRlc3QgS3J1c2thbCdzIGFsZ29yaXRobQogICAgbGV0IGtydXNrYWxfcmVzdWx0OiBpMzIgPSBrcnVza2FsTVNUKCZncmFwaCwgNTApOwogICAgcHJpbnRsbkludChrcnVza2FsX3Jlc3VsdCk7CiAgICAKICAgIC8vIFRlc3QgUHJpbSdzIGFsZ29yaXRobQogICAgbGV0IHByaW1fcmVzdWx0OiBpMzIgPSBwcmltTVNUKCZncmFwaCwgNTApOwogICAgcHJpbnRsbkludChwcmltX3Jlc3VsdCk7CiAgICAKICAgIHByaW50bG5JbnQoMTcwNik7IC8vIEVuZCBNU1QgdGVzdAp9CgovLyBLcnVza2FsJ3MgTVNUIGFsZ29yaXRobSAoc2ltcGxpZmllZCB3aXRob3V0IFVuaW9uLUZpbmQpCmZuIGtydXNrYWxNU1QoZ3JhcGg6ICZbaTMyOyAyNTAwXSwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgLy8gQ3JlYXRlIGVkZ2UgbGlzdAogICAgbGV0IG11dCBlZGdlczogW2kzMjsgMTUwMF0gPSBbMDsgMTUwMF07IC8vIFt3ZWlnaHQsIHNyYywgZGVzdF0gdHJpcGxldHMKICAgIGxldCBtdXQgZWRnZV9jb3VudDogaTMyID0gMDsKICAgIAogICAgLy8gRXh0cmFjdCBlZGdlcyBmcm9tIGFkamFjZW5jeSBtYXRyaXgKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSAmJiBlZGdlX2NvdW50IDwgNTAwKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSBpICsgMTsKICAgICAgICB3aGlsZSAoaiA8IHNpemUgJiYgZWRnZV9jb3VudCA8IDUwMCkgewogICAgICAgICAgICBpZiAoKGdyYXBoWyhpICogc2l6ZSArIGopIGFzIHVzaXplXSAhPSA5OTk5KSAmJiAoZ3JhcGhbKGkgKiBzaXplICsgaikgYXMgdXNpemVdICE9IDApKSB7CiAgICAgICAgICAgICAgICBlZGdlc1soZWRnZV9jb3VudCBhcyB1c2l6ZSkgKiAzXSA9IGdyYXBoWyhpICogc2l6ZSArIGopIGFzIHVzaXplXTsgLy8gd2VpZ2h0CiAgICAgICAgICAgICAgICBlZGdlc1soZWRnZV9jb3VudCBhcyB1c2l6ZSkgKiAzICsgMV0gPSBpOyAvLyBzb3VyY2UKICAgICAgICAgICAgICAgIGVkZ2VzWyhlZGdlX2NvdW50IGFzIHVzaXplKSAqIDMgKyAyXSA9IGo7IC8vIGRlc3RpbmF0aW9uCiAgICAgICAgICAgICAgICBlZGdlX2NvdW50ID0gZWRnZV9jb3VudCArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIFNvcnQgZWRnZXMgYnkgd2VpZ2h0IChzaW1wbGUgYnViYmxlIHNvcnQpCiAgICBzb3J0RWRnZXNCeVdlaWdodCgmbXV0IGVkZ2VzLCBlZGdlX2NvdW50KTsKICAgIAogICAgLy8gQnVpbGQgTVNUIHVzaW5nIHNpbXBsZSBjeWNsZSBkZXRlY3Rpb24KICAgIGxldCBtdXQgbXN0X3dlaWdodDogaTMyID0gMDsKICAgIGxldCBtdXQgbXN0X2VkZ2VzOiBpMzIgPSAwOwogICAgbGV0IG11dCBlZGdlX2luZGV4OiBpMzIgPSAwOwogICAgCiAgICB3aGlsZSAoZWRnZV9pbmRleCA8IGVkZ2VfY291bnQgJiYgbXN0X2VkZ2VzIDwgc2l6ZSAtIDEpIHsKICAgICAgICBsZXQgd2VpZ2h0OiBpMzIgPSBlZGdlc1soZWRnZV9pbmRleCBhcyB1c2l6ZSkgKiAzXTsKICAgICAgICBsZXQgc3JjOiBpMzIgPSBlZGdlc1soZWRnZV9pbmRleCBhcyB1c2l6ZSkgKiAzICsgMV07CiAgICAgICAgbGV0IGRlc3Q6IGkzMiA9IGVkZ2VzWyhlZGdlX2luZGV4IGFzIHVzaXplKSAqIDMgKyAyXTsKICAgICAgICAKICAgICAgICAvLyBTaW1wbGUgY2hlY2s6IGFkZCBlZGdlIGlmIGl0IGRvZXNuJ3QgY3JlYXRlIG9idmlvdXMgY3ljbGVzCiAgICAgICAgaWYgKHNyYyAhPSBkZXN0KSB7CiAgICAgICAgICAgIG1zdF93ZWlnaHQgPSBtc3Rfd2VpZ2h0ICsgd2VpZ2h0OwogICAgICAgICAgICBtc3RfZWRnZXMgPSBtc3RfZWRnZXMgKyAxOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBlZGdlX2luZGV4ID0gZWRnZV9pbmRleCArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBtc3Rfd2VpZ2h0Owp9CgovLyBTb3J0IGVkZ2VzIGJ5IHdlaWdodCB1c2luZyBidWJibGUgc29ydApmbiBzb3J0RWRnZXNCeVdlaWdodChlZGdlczogJm11dCBbaTMyOyAxNTAwXSwgZWRnZV9jb3VudDogaTMyKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IGVkZ2VfY291bnQgLSAxKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgZWRnZV9jb3VudCAtIGkgLSAxKSB7CiAgICAgICAgICAgIGlmIChlZGdlc1soaiBhcyB1c2l6ZSkgKiAzXSA+IGVkZ2VzWygoaiBhcyB1c2l6ZSkgKyAxKSAqIDNdKSB7CiAgICAgICAgICAgICAgICAvLyBTd2FwIGVkZ2VzCiAgICAgICAgICAgICAgICBsZXQgdGVtcF93ZWlnaHQ6IGkzMiA9IGVkZ2VzWyhqIGFzIHVzaXplKSAqIDNdOwogICAgICAgICAgICAgICAgbGV0IHRlbXBfc3JjOiBpMzIgPSBlZGdlc1soaiBhcyB1c2l6ZSkgKiAzICsgMV07CiAgICAgICAgICAgICAgICBsZXQgdGVtcF9kZXN0OiBpMzIgPSBlZGdlc1soaiBhcyB1c2l6ZSkgKiAzICsgMl07CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVkZ2VzWyhqIGFzIHVzaXplKSAqIDNdID0gZWRnZXNbKChqIGFzIHVzaXplKSArIDEpICogM107CiAgICAgICAgICAgICAgICBlZGdlc1soaiBhcyB1c2l6ZSkgKiAzICsgMV0gPSBlZGdlc1soKGogYXMgdXNpemUpICsgMSkgKiAzICsgMV07CiAgICAgICAgICAgICAgICBlZGdlc1soaiBhcyB1c2l6ZSkgKiAzICsgMl0gPSBlZGdlc1soKGogYXMgdXNpemUpICsgMSkgKiAzICsgMl07CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGVkZ2VzWygoaiBhcyB1c2l6ZSkgKyAxKSAqIDNdID0gdGVtcF93ZWlnaHQ7CiAgICAgICAgICAgICAgICBlZGdlc1soKGogYXMgdXNpemUpICsgMSkgKiAzICsgMV0gPSB0ZW1wX3NyYzsKICAgICAgICAgICAgICAgIGVkZ2VzWygoaiBhcyB1c2l6ZSkgKyAxKSAqIDMgKyAyXSA9IHRlbXBfZGVzdDsKICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gUHJpbSdzIE1TVCBhbGdvcml0aG0KZm4gcHJpbU1TVChncmFwaDogJltpMzI7IDI1MDBdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGtleTogW2kzMjsgNTBdID0gWzk5OTk7IDUwXTsKICAgIGxldCBtdXQgbXN0X3NldDogW2Jvb2w7IDUwXSA9IFtmYWxzZTsgNTBdOwogICAgbGV0IG11dCBtc3Rfd2VpZ2h0OiBpMzIgPSAwOwogICAgCiAgICBrZXlbMF0gPSAwOyAvLyBTdGFydCBmcm9tIHZlcnRleCAwCiAgICAKICAgIGxldCBtdXQgY291bnQ6IGkzMiA9IDA7CiAgICB3aGlsZSAoY291bnQgPCBzaXplKSB7CiAgICAgICAgLy8gRmluZCBtaW5pbXVtIGtleSB2ZXJ0ZXggbm90IGluIE1TVAogICAgICAgIGxldCBtdXQgbWluX2tleTogaTMyID0gOTk5OTsKICAgICAgICBsZXQgbXV0IG1pbl9pbmRleDogaTMyID0gLTE7CiAgICAgICAgbGV0IG11dCB2OiBpMzIgPSAwOwogICAgICAgIAogICAgICAgIHdoaWxlICh2IDwgc2l6ZSkgewogICAgICAgICAgICBpZiAoKCFtc3Rfc2V0W3YgYXMgdXNpemVdKSAmJiAoa2V5W3YgYXMgdXNpemVdIDwgbWluX2tleSkpIHsKICAgICAgICAgICAgICAgIG1pbl9rZXkgPSBrZXlbdiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBtaW5faW5kZXggPSB2OwogICAgICAgICAgICB9CiAgICAgICAgICAgIHYgPSB2ICsgMTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKG1pbl9pbmRleCA9PSAtMSkgewogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgbXN0X3NldFttaW5faW5kZXggYXMgdXNpemVdID0gdHJ1ZTsKICAgICAgICBtc3Rfd2VpZ2h0ID0gbXN0X3dlaWdodCArIGtleVttaW5faW5kZXggYXMgdXNpemVdOwogICAgICAgIAogICAgICAgIC8vIFVwZGF0ZSBrZXkgdmFsdWVzIG9mIGFkamFjZW50IHZlcnRpY2VzCiAgICAgICAgdiA9IDA7CiAgICAgICAgd2hpbGUgKHYgPCBzaXplKSB7CiAgICAgICAgICAgIGlmICgoIW1zdF9zZXRbdiBhcyB1c2l6ZV0pICYmIChncmFwaFsobWluX2luZGV4ICogc2l6ZSArIHYpIGFzIHVzaXplXSAhPSA5OTk5KSAmJgogICAgICAgICAgICAgICAgKGdyYXBoWyhtaW5faW5kZXggKiBzaXplICsgdikgYXMgdXNpemVdICE9IDApICYmIChncmFwaFsobWluX2luZGV4ICogc2l6ZSArIHYpIGFzIHVzaXplXSA8IGtleVt2IGFzIHVzaXplXSkpIHsKICAgICAgICAgICAgICAgIGtleVt2IGFzIHVzaXplXSA9IGdyYXBoWyhtaW5faW5kZXggKiBzaXplICsgdikgYXMgdXNpemVdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHYgPSB2ICsgMTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgY291bnQgPSBjb3VudCArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBtc3Rfd2VpZ2h0Owp9CgovLyBUZXN0IDQ6IE5ldHdvcmsgRmxvdyBBbGdvcml0aG1zCmZuIHRlc3ROZXR3b3JrRmxvd0FsZ29yaXRobXMoKSB7CiAgICBwcmludGxuSW50KDE3MDcpOyAvLyBTdGFydCBuZXR3b3JrIGZsb3cgdGVzdAogICAgCiAgICBsZXQgbXV0IGNhcGFjaXR5OiBbaTMyOyA5MDBdID0gWzA7IDkwMF07IC8vIDMweDMwIGNhcGFjaXR5IG1hdHJpeAogICAgaW5pdGlhbGl6ZUZsb3dOZXR3b3JrKCZtdXQgY2FwYWNpdHksIDMwKTsKICAgIAogICAgLy8gVGVzdCBGb3JkLUZ1bGtlcnNvbiBtYXggZmxvdwogICAgbGV0IG1heF9mbG93X3Jlc3VsdDogaTMyID0gZm9yZEZ1bGtlcnNvbk1heEZsb3coJmNhcGFjaXR5LCAzMCwgMCwgMjkpOwogICAgcHJpbnRsbkludChtYXhfZmxvd19yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IG1pbi1jb3N0IG1heCBmbG93IChzaW1wbGlmaWVkKQogICAgbGV0IG1pbl9jb3N0X3Jlc3VsdDogaTMyID0gbWluQ29zdE1heEZsb3coJmNhcGFjaXR5LCAzMCk7CiAgICBwcmludGxuSW50KG1pbl9jb3N0X3Jlc3VsdCk7CiAgICAKICAgIHByaW50bG5JbnQoMTcwOCk7IC8vIEVuZCBuZXR3b3JrIGZsb3cgdGVzdAp9CgovLyBJbml0aWFsaXplIGZsb3cgbmV0d29yawpmbiBpbml0aWFsaXplRmxvd05ldHdvcmsoY2FwYWNpdHk6ICZtdXQgW2kzMjsgOTAwXSwgc2l6ZTogaTMyKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAKICAgIC8vIEluaXRpYWxpemUgYWxsIGNhcGFjaXRpZXMgdG8gMAogICAgd2hpbGUgKGkgPCBzaXplICogc2l6ZSkgewogICAgICAgIGNhcGFjaXR5W2kgYXMgdXNpemVdID0gMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIEFkZCBjYXBhY2l0eSBiYXNlZCBvbiBuZXR3b3JrIHRvcG9sb2d5CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSAtIDEpIHsKICAgICAgICAvLyBGb3J3YXJkIGVkZ2VzCiAgICAgICAgY2FwYWNpdHlbKGkgKiBzaXplICsgKGkgKyAxKSkgYXMgdXNpemVdID0gMTAgKyAoaSAlIDIwKTsKICAgICAgICAKICAgICAgICAvLyBTb21lIGNyb3NzIGVkZ2VzCiAgICAgICAgaWYgKGkgKyA1IDwgc2l6ZSkgewogICAgICAgICAgICBjYXBhY2l0eVsoaSAqIHNpemUgKyAoaSArIDUpKSBhcyB1c2l6ZV0gPSA1ICsgKGkgJSAxMCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIFNvbWUgYmFja3dhcmQgY29ubmVjdGlvbnMgZm9yIGNvbXBsZXggZmxvdwogICAgICAgIGlmIChpID4gNSkgewogICAgICAgICAgICBjYXBhY2l0eVsoaSAqIHNpemUgKyAoaSAtIDMpKSBhcyB1c2l6ZV0gPSAzICsgKGkgJSA3KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBGb3JkLUZ1bGtlcnNvbiBtYXggZmxvdyBhbGdvcml0aG0KZm4gZm9yZEZ1bGtlcnNvbk1heEZsb3coY2FwYWNpdHk6ICZbaTMyOyA5MDBdLCBzaXplOiBpMzIsIHNvdXJjZTogaTMyLCBzaW5rOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHJlc2lkdWFsOiBbaTMyOyA5MDBdID0gWzA7IDkwMF07CiAgICBsZXQgbXV0IG1heF9mbG93OiBpMzIgPSAwOwogICAgCiAgICAvLyBJbml0aWFsaXplIHJlc2lkdWFsIGdyYXBoCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUgKiBzaXplKSB7CiAgICAgICAgcmVzaWR1YWxbaSBhcyB1c2l6ZV0gPSBjYXBhY2l0eVtpIGFzIHVzaXplXTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIEZpbmQgYXVnbWVudGluZyBwYXRocwogICAgbGV0IG11dCBpdGVyYXRpb246IGkzMiA9IDA7CiAgICB3aGlsZSAoaXRlcmF0aW9uIDwgMTAwKSB7IC8vIExpbWl0IGl0ZXJhdGlvbnMKICAgICAgICBsZXQgbXV0IHBhcmVudDogW2kzMjsgMzBdID0gWy0xOyAzMF07CiAgICAgICAgbGV0IGZsb3c6IGkzMiA9IGJmc0F1Z21lbnRpbmdQYXRoKCZyZXNpZHVhbCwgc2l6ZSwgc291cmNlLCBzaW5rLCAmbXV0IHBhcmVudCk7CiAgICAgICAgCiAgICAgICAgaWYgKGZsb3cgPT0gMCkgewogICAgICAgICAgICBicmVhazsgLy8gTm8gbW9yZSBhdWdtZW50aW5nIHBhdGhzCiAgICAgICAgfQogICAgICAgIAogICAgICAgIG1heF9mbG93ID0gbWF4X2Zsb3cgKyBmbG93OwogICAgICAgIAogICAgICAgIC8vIFVwZGF0ZSByZXNpZHVhbCBncmFwaAogICAgICAgIGxldCBtdXQgdjogaTMyID0gc2luazsKICAgICAgICB3aGlsZSAodiAhPSBzb3VyY2UpIHsKICAgICAgICAgICAgbGV0IHU6IGkzMiA9IHBhcmVudFt2IGFzIHVzaXplXTsKICAgICAgICAgICAgcmVzaWR1YWxbKHUgKiBzaXplICsgdikgYXMgdXNpemVdID0gcmVzaWR1YWxbKHUgKiBzaXplICsgdikgYXMgdXNpemVdIC0gZmxvdzsKICAgICAgICAgICAgcmVzaWR1YWxbKHYgKiBzaXplICsgdSkgYXMgdXNpemVdID0gcmVzaWR1YWxbKHYgKiBzaXplICsgdSkgYXMgdXNpemVdICsgZmxvdzsKICAgICAgICAgICAgdiA9IHBhcmVudFt2IGFzIHVzaXplXTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaXRlcmF0aW9uID0gaXRlcmF0aW9uICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIG1heF9mbG93Owp9CgovLyBCRlMgdG8gZmluZCBhdWdtZW50aW5nIHBhdGgKZm4gYmZzQXVnbWVudGluZ1BhdGgocmVzaWR1YWw6ICZbaTMyOyA5MDBdLCBzaXplOiBpMzIsIHNvdXJjZTogaTMyLCBzaW5rOiBpMzIsIHBhcmVudDogJm11dCBbaTMyOyAzMF0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IHZpc2l0ZWQ6IFtib29sOyAzMF0gPSBbZmFsc2U7IDMwXTsKICAgIGxldCBtdXQgcXVldWU6IFtpMzI7IDMwXSA9IFstMTsgMzBdOwogICAgbGV0IG11dCBxdWV1ZV9mcm9udDogaTMyID0gMDsKICAgIGxldCBtdXQgcXVldWVfcmVhcjogaTMyID0gMDsKICAgIAogICAgcXVldWVbcXVldWVfcmVhciBhcyB1c2l6ZV0gPSBzb3VyY2U7CiAgICBxdWV1ZV9yZWFyID0gcXVldWVfcmVhciArIDE7CiAgICB2aXNpdGVkW3NvdXJjZSBhcyB1c2l6ZV0gPSB0cnVlOwogICAgcGFyZW50W3NvdXJjZSBhcyB1c2l6ZV0gPSAtMTsKICAgIAogICAgd2hpbGUgKHF1ZXVlX2Zyb250IDwgcXVldWVfcmVhcikgewogICAgICAgIGxldCB1OiBpMzIgPSBxdWV1ZVtxdWV1ZV9mcm9udCBhcyB1c2l6ZV07CiAgICAgICAgcXVldWVfZnJvbnQgPSBxdWV1ZV9mcm9udCArIDE7CiAgICAgICAgCiAgICAgICAgbGV0IG11dCB2OiBpMzIgPSAwOwogICAgICAgIHdoaWxlICh2IDwgc2l6ZSkgewogICAgICAgICAgICBpZiAoKCF2aXNpdGVkW3YgYXMgdXNpemVdKSAmJiAocmVzaWR1YWxbKHUgKiBzaXplICsgdikgYXMgdXNpemVdID4gMCkpIHsKICAgICAgICAgICAgICAgIHF1ZXVlW3F1ZXVlX3JlYXIgYXMgdXNpemVdID0gdjsKICAgICAgICAgICAgICAgIHF1ZXVlX3JlYXIgPSBxdWV1ZV9yZWFyICsgMTsKICAgICAgICAgICAgICAgIHZpc2l0ZWRbdiBhcyB1c2l6ZV0gPSB0cnVlOwogICAgICAgICAgICAgICAgcGFyZW50W3YgYXMgdXNpemVdID0gdTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKHYgPT0gc2luaykgewogICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIHBhdGggdG8gc2luaywgY2FsY3VsYXRlIGJvdHRsZW5lY2sgY2FwYWNpdHkKICAgICAgICAgICAgICAgICAgICBsZXQgbXV0IHBhdGhfZmxvdzogaTMyID0gOTk5OTsKICAgICAgICAgICAgICAgICAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9IHNpbms7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnQgIT0gc291cmNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwcmV2OiBpMzIgPSBwYXJlbnRbY3VycmVudCBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNpZHVhbFsocHJldiAqIHNpemUgKyBjdXJyZW50KSBhcyB1c2l6ZV0gPCBwYXRoX2Zsb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGhfZmxvdyA9IHJlc2lkdWFsWyhwcmV2ICogc2l6ZSArIGN1cnJlbnQpIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0gcHJldjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhdGhfZmxvdzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB2ID0gdiArIDE7CiAgICAgICAgfQogICAgfQogICAgCiAgICByZXR1cm4gMDsgLy8gTm8gYXVnbWVudGluZyBwYXRoIGZvdW5kCn0KCi8vIFNpbXBsaWZpZWQgbWluLWNvc3QgbWF4IGZsb3cKZm4gbWluQ29zdE1heEZsb3coY2FwYWNpdHk6ICZbaTMyOyA5MDBdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHRvdGFsX2Nvc3Q6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHRvdGFsX2Zsb3c6IGkzMiA9IDA7CiAgICAKICAgIC8vIFNpbXBsZSBjb3N0IGNhbGN1bGF0aW9uIGJhc2VkIG9uIGRpc3RhbmNlCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgIGlmIChjYXBhY2l0eVsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV0gPiAwKSB7CiAgICAgICAgICAgICAgICBsZXQgZGlzdGFuY2U6IGkzMiA9IGlmIChpID4gaikgeyBpIC0gaiB9IGVsc2UgeyBqIC0gaSB9OwogICAgICAgICAgICAgICAgdG90YWxfY29zdCA9IHRvdGFsX2Nvc3QgKyBjYXBhY2l0eVsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV0gKiBkaXN0YW5jZTsKICAgICAgICAgICAgICAgIHRvdGFsX2Zsb3cgPSB0b3RhbF9mbG93ICsgY2FwYWNpdHlbKGkgKiBzaXplICsgaikgYXMgdXNpemVdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gdG90YWxfY29zdCAvICh0b3RhbF9mbG93ICsgMSk7IC8vIEF2ZXJhZ2UgY29zdCBwZXIgdW5pdCBmbG93Cn0KCi8vIFRlc3QgNTogR3JhcGggQ29ubmVjdGl2aXR5IEFsZ29yaXRobXMKZm4gdGVzdEdyYXBoQ29ubmVjdGl2aXR5QWxnb3JpdGhtcygpIHsKICAgIHByaW50bG5JbnQoMTcwOSk7IC8vIFN0YXJ0IGNvbm5lY3Rpdml0eSB0ZXN0CiAgICAKICAgIGxldCBtdXQgZ3JhcGg6IFtpMzI7IDI1MDBdID0gWzA7IDI1MDBdOwogICAgaW5pdGlhbGl6ZUdyYXBoKCZtdXQgZ3JhcGgsIDUwKTsKICAgIAogICAgLy8gVGVzdCBjb25uZWN0ZWQgY29tcG9uZW50cwogICAgbGV0IGNvbXBvbmVudHNfcmVzdWx0OiBpMzIgPSBmaW5kQ29ubmVjdGVkQ29tcG9uZW50cygmZ3JhcGgsIDUwKTsKICAgIHByaW50bG5JbnQoY29tcG9uZW50c19yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IHN0cm9uZ2x5IGNvbm5lY3RlZCBjb21wb25lbnRzIChmb3IgZGlyZWN0ZWQgZ3JhcGgpCiAgICBsZXQgc2NjX3Jlc3VsdDogaTMyID0gZmluZFN0cm9uZ2x5Q29ubmVjdGVkQ29tcG9uZW50cygmZ3JhcGgsIDUwKTsKICAgIHByaW50bG5JbnQoc2NjX3Jlc3VsdCk7CiAgICAKICAgIC8vIFRlc3QgYXJ0aWN1bGF0aW9uIHBvaW50cwogICAgbGV0IGFydGljdWxhdGlvbl9yZXN1bHQ6IGkzMiA9IGZpbmRBcnRpY3VsYXRpb25Qb2ludHMoJm11dCBncmFwaCwgNTApOwogICAgcHJpbnRsbkludChhcnRpY3VsYXRpb25fcmVzdWx0KTsKICAgIAogICAgLy8gVGVzdCBicmlkZ2VzCiAgICBsZXQgYnJpZGdlc19yZXN1bHQ6IGkzMiA9IGZpbmRCcmlkZ2VzKCZtdXQgZ3JhcGgsIDUwKTsKICAgIHByaW50bG5JbnQoYnJpZGdlc19yZXN1bHQpOwogICAgCiAgICBwcmludGxuSW50KDE3MTApOyAvLyBFbmQgY29ubmVjdGl2aXR5IHRlc3QKfQoKLy8gRmluZCBjb25uZWN0ZWQgY29tcG9uZW50cyB1c2luZyBERlMKZm4gZmluZENvbm5lY3RlZENvbXBvbmVudHMoZ3JhcGg6ICZbaTMyOyAyNTAwXSwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCB2aXNpdGVkOiBbYm9vbDsgNTBdID0gW2ZhbHNlOyA1MF07CiAgICBsZXQgbXV0IGNvbXBvbmVudHM6IGkzMiA9IDA7CiAgICAKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGlmICghdmlzaXRlZFtpIGFzIHVzaXplXSkgewogICAgICAgICAgICBkZnNDb21wb25lbnRUcmF2ZXJzYWwoZ3JhcGgsIHNpemUsIGksICZtdXQgdmlzaXRlZCk7CiAgICAgICAgICAgIGNvbXBvbmVudHMgPSBjb21wb25lbnRzICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gY29tcG9uZW50czsKfQoKZm4gZGZzQ29tcG9uZW50VHJhdmVyc2FsKGdyYXBoOiAmW2kzMjsgMjUwMF0sIHNpemU6IGkzMiwgbm9kZTogaTMyLCB2aXNpdGVkOiAmbXV0IFtib29sOyA1MF0pIHsKICAgIHZpc2l0ZWRbbm9kZSBhcyB1c2l6ZV0gPSB0cnVlOwogICAgCiAgICBsZXQgbXV0IG5laWdoYm9yOiBpMzIgPSAwOwogICAgd2hpbGUgKG5laWdoYm9yIDwgc2l6ZSkgewogICAgICAgIGlmICgoZ3JhcGhbKG5vZGUgKiBzaXplICsgbmVpZ2hib3IpIGFzIHVzaXplXSA+IDApICYmICghdmlzaXRlZFtuZWlnaGJvciBhcyB1c2l6ZV0pKSB7CiAgICAgICAgICAgIGRmc0NvbXBvbmVudFRyYXZlcnNhbChncmFwaCwgc2l6ZSwgbmVpZ2hib3IsIHZpc2l0ZWQpOwogICAgICAgIH0KICAgICAgICBuZWlnaGJvciA9IG5laWdoYm9yICsgMTsKICAgIH0KfQoKLy8gRmluZCBzdHJvbmdseSBjb25uZWN0ZWQgY29tcG9uZW50cyB1c2luZyBLb3NhcmFqdSdzIGFsZ29yaXRobQpmbiBmaW5kU3Ryb25nbHlDb25uZWN0ZWRDb21wb25lbnRzKGdyYXBoOiAmW2kzMjsgMjUwMF0sIHNpemU6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgdmlzaXRlZDogW2Jvb2w7IDUwXSA9IFtmYWxzZTsgNTBdOwogICAgbGV0IG11dCBmaW5pc2hfb3JkZXI6IFtpMzI7IDUwXSA9IFswOyA1MF07CiAgICBsZXQgbXV0IGZpbmlzaF9pbmRleDogaTMyID0gMDsKICAgIAogICAgLy8gRmlyc3QgREZTIHRvIGdldCBmaW5pc2ggdGltZXMKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGlmICghdmlzaXRlZFtpIGFzIHVzaXplXSkgewogICAgICAgICAgICBkZnNGaW5pc2hUaW1lKGdyYXBoLCBzaXplLCBpLCAmbXV0IHZpc2l0ZWQsICZtdXQgZmluaXNoX29yZGVyLCAmbXV0IGZpbmlzaF9pbmRleCk7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgLy8gQ3JlYXRlIHRyYW5zcG9zZSBncmFwaAogICAgbGV0IG11dCB0cmFuc3Bvc2U6IFtpMzI7IDI1MDBdID0gWzA7IDI1MDBdOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgIHRyYW5zcG9zZVsoaiAqIHNpemUgKyBpKSBhcyB1c2l6ZV0gPSBncmFwaFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICAvLyBSZXNldCB2aXNpdGVkIGFycmF5CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIHZpc2l0ZWRbaSBhcyB1c2l6ZV0gPSBmYWxzZTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIFNlY29uZCBERlMgb24gdHJhbnNwb3NlIGdyYXBoIGluIHJldmVyc2UgZmluaXNoIG9yZGVyCiAgICBsZXQgbXV0IHNjY19jb3VudDogaTMyID0gMDsKICAgIGkgPSBmaW5pc2hfaW5kZXggLSAxOwogICAgd2hpbGUgKGkgPj0gMCkgewogICAgICAgIGxldCBub2RlOiBpMzIgPSBmaW5pc2hfb3JkZXJbaSBhcyB1c2l6ZV07CiAgICAgICAgaWYgKCF2aXNpdGVkW25vZGUgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIGRmc0NvbXBvbmVudFRyYXZlcnNhbCgmdHJhbnNwb3NlLCBzaXplLCBub2RlLCAmbXV0IHZpc2l0ZWQpOwogICAgICAgICAgICBzY2NfY291bnQgPSBzY2NfY291bnQgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSAtIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBzY2NfY291bnQ7Cn0KCmZuIGRmc0ZpbmlzaFRpbWUoZ3JhcGg6ICZbaTMyOyAyNTAwXSwgc2l6ZTogaTMyLCBub2RlOiBpMzIsIHZpc2l0ZWQ6ICZtdXQgW2Jvb2w7IDUwXSwgCiAgICAgICAgICAgICAgICBmaW5pc2hfb3JkZXI6ICZtdXQgW2kzMjsgNTBdLCBmaW5pc2hfaW5kZXg6ICZtdXQgaTMyKSB7CiAgICB2aXNpdGVkW25vZGUgYXMgdXNpemVdID0gdHJ1ZTsKICAgIAogICAgbGV0IG11dCBuZWlnaGJvcjogaTMyID0gMDsKICAgIHdoaWxlIChuZWlnaGJvciA8IHNpemUpIHsKICAgICAgICBpZiAoKGdyYXBoWyhub2RlICogc2l6ZSArIG5laWdoYm9yKSBhcyB1c2l6ZV0gPiAwKSAmJiAoIXZpc2l0ZWRbbmVpZ2hib3IgYXMgdXNpemVdKSkgewogICAgICAgICAgICBkZnNGaW5pc2hUaW1lKGdyYXBoLCBzaXplLCBuZWlnaGJvciwgdmlzaXRlZCwgZmluaXNoX29yZGVyLCBmaW5pc2hfaW5kZXgpOwogICAgICAgIH0KICAgICAgICBuZWlnaGJvciA9IG5laWdoYm9yICsgMTsKICAgIH0KICAgIAogICAgZmluaXNoX29yZGVyWypmaW5pc2hfaW5kZXggYXMgdXNpemVdID0gbm9kZTsKICAgICpmaW5pc2hfaW5kZXggPSAqZmluaXNoX2luZGV4ICsgMTsKfQoKLy8gRmluZCBhcnRpY3VsYXRpb24gcG9pbnRzIChzaW1wbGlmaWVkKQpmbiBmaW5kQXJ0aWN1bGF0aW9uUG9pbnRzKGdyYXBoOiAmbXV0IFtpMzI7IDI1MDBdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGFydGljdWxhdGlvbl9wb2ludHM6IGkzMiA9IDA7CiAgICAKICAgIC8vIEZvciBlYWNoIHZlcnRleCwgdGVtcG9yYXJpbHkgcmVtb3ZlIGl0IGFuZCBjaGVjayBjb25uZWN0aXZpdHkKICAgIGxldCBtdXQgdmVydGV4OiBpMzIgPSAwOwogICAgd2hpbGUgKHZlcnRleCA8IHNpemUpIHsKICAgICAgICBsZXQgb3JpZ2luYWxfY29tcG9uZW50czogaTMyID0gZmluZENvbm5lY3RlZENvbXBvbmVudHMoJipncmFwaCwgc2l6ZSk7CiAgICAgICAgCiAgICAgICAgLy8gVGVtcG9yYXJpbHkgcmVtb3ZlIHZlcnRleCBieSBzZXR0aW5nIGl0cyBlZGdlcyB0byAwCiAgICAgICAgbGV0IG11dCB0ZW1wX2VkZ2VzOiBbaTMyOyA1MF0gPSBbMDsgNTBdOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICAgICAgdGVtcF9lZGdlc1tpIGFzIHVzaXplXSA9IGdyYXBoWyh2ZXJ0ZXggKiBzaXplICsgaSkgYXMgdXNpemVdOwogICAgICAgICAgICBncmFwaFsodmVydGV4ICogc2l6ZSArIGkpIGFzIHVzaXplXSA9IDA7CiAgICAgICAgICAgIGdyYXBoWyhpICogc2l6ZSArIHZlcnRleCkgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBsZXQgbmV3X2NvbXBvbmVudHM6IGkzMiA9IGZpbmRDb25uZWN0ZWRDb21wb25lbnRzKCYqZ3JhcGgsIHNpemUpOwogICAgICAgIAogICAgICAgIC8vIFJlc3RvcmUgZWRnZXMKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICAgICAgZ3JhcGhbKHZlcnRleCAqIHNpemUgKyBpKSBhcyB1c2l6ZV0gPSB0ZW1wX2VkZ2VzW2kgYXMgdXNpemVdOwogICAgICAgICAgICBncmFwaFsoaSAqIHNpemUgKyB2ZXJ0ZXgpIGFzIHVzaXplXSA9IHRlbXBfZWRnZXNbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKG5ld19jb21wb25lbnRzID4gb3JpZ2luYWxfY29tcG9uZW50cykgewogICAgICAgICAgICBhcnRpY3VsYXRpb25fcG9pbnRzID0gYXJ0aWN1bGF0aW9uX3BvaW50cyArIDE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHZlcnRleCA9IHZlcnRleCArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBhcnRpY3VsYXRpb25fcG9pbnRzOwp9CgovLyBGaW5kIGJyaWRnZXMgKHNpbXBsaWZpZWQpCmZuIGZpbmRCcmlkZ2VzKGdyYXBoOiAmbXV0IFtpMzI7IDI1MDBdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGJyaWRnZXM6IGkzMiA9IDA7CiAgICAKICAgIC8vIEZvciBlYWNoIGVkZ2UsIHRlbXBvcmFyaWx5IHJlbW92ZSBpdCBhbmQgY2hlY2sgY29ubmVjdGl2aXR5CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IGkgKyAxOwogICAgICAgIHdoaWxlIChqIDwgc2l6ZSkgewogICAgICAgICAgICBpZiAoZ3JhcGhbKGkgKiBzaXplICsgaikgYXMgdXNpemVdID4gMCkgewogICAgICAgICAgICAgICAgbGV0IG9yaWdpbmFsX2NvbXBvbmVudHM6IGkzMiA9IGZpbmRDb25uZWN0ZWRDb21wb25lbnRzKCYqZ3JhcGgsIHNpemUpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBUZW1wb3JhcmlseSByZW1vdmUgZWRnZQogICAgICAgICAgICAgICAgbGV0IHRlbXBfd2VpZ2h0OiBpMzIgPSBncmFwaFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBncmFwaFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICAgICAgZ3JhcGhbKGogKiBzaXplICsgaSkgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbGV0IG5ld19jb21wb25lbnRzOiBpMzIgPSBmaW5kQ29ubmVjdGVkQ29tcG9uZW50cygmKmdyYXBoLCBzaXplKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gUmVzdG9yZSBlZGdlCiAgICAgICAgICAgICAgICBncmFwaFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV0gPSB0ZW1wX3dlaWdodDsKICAgICAgICAgICAgICAgIGdyYXBoWyhqICogc2l6ZSArIGkpIGFzIHVzaXplXSA9IHRlbXBfd2VpZ2h0OwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiAobmV3X2NvbXBvbmVudHMgPiBvcmlnaW5hbF9jb21wb25lbnRzKSB7CiAgICAgICAgICAgICAgICAgICAgYnJpZGdlcyA9IGJyaWRnZXMgKyAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gYnJpZGdlczsKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (8, "comprehensive8", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCA4OiBEeW5hbWljIFByb2dyYW1taW5nIGFuZCBPcHRpbWl6YXRpb24gUHJvYmxlbXMKU3VtbWFyeTogVGhpcyB0ZXN0IGZvY3VzZXMgb24gY29tcGlsZXIgb3B0aW1pemF0aW9uIG9mOgpEZXRhaWxzOgpEeW5hbWljIHByb2dyYW1taW5nIHRhYmxlIGFjY2VzcyBwYXR0ZXJucwpNZW1vaXphdGlvbiBhbmQgY2FjaGluZyBvcHRpbWl6YXRpb25zCk11bHRpLWRpbWVuc2lvbmFsIGFycmF5IG9wdGltaXphdGlvbgpOZXN0ZWQgbG9vcCBvcHRpbWl6YXRpb24gaW4gRFAgYWxnb3JpdGhtcwpNZW1vcnkgYWNjZXNzIHBhdHRlcm4gb3B0aW1pemF0aW9uIGluIERQCk9wdGltaXphdGlvbiBwcm9ibGVtIHNvbHZpbmcgYWxnb3JpdGhtcwoqLwoKLy8gY29tcHJlaGVuc2l2ZTgucnggLSBDb21wcmVoZW5zaXZlIFRlc3QgODogRHluYW1pYyBQcm9ncmFtbWluZyBhbmQgT3B0aW1pemF0aW9uIFByb2JsZW1zCi8vIFRoaXMgdGVzdCBmb2N1c2VzIG9uIGNvbXBpbGVyIG9wdGltaXphdGlvbiBvZjoKLy8gLSBEeW5hbWljIHByb2dyYW1taW5nIHRhYmxlIGFjY2VzcyBwYXR0ZXJucwovLyAtIE1lbW9pemF0aW9uIGFuZCBjYWNoaW5nIG9wdGltaXphdGlvbnMKLy8gLSBNdWx0aS1kaW1lbnNpb25hbCBhcnJheSBvcHRpbWl6YXRpb24KLy8gLSBOZXN0ZWQgbG9vcCBvcHRpbWl6YXRpb24gaW4gRFAgYWxnb3JpdGhtcwovLyAtIE1lbW9yeSBhY2Nlc3MgcGF0dGVybiBvcHRpbWl6YXRpb24gaW4gRFAKLy8gLSBPcHRpbWl6YXRpb24gcHJvYmxlbSBzb2x2aW5nIGFsZ29yaXRobXMKCmZuIG1haW4oKSB7CiAgICAvLyBQZXJmb3JtYW5jZSB0ZXN0IG1hcmtlciAtIHN0YXJ0CiAgICBwcmludGxuSW50KDE4MDApOwogICAgCiAgICAvLyBUZXN0IDE6IENsYXNzaWMgZHluYW1pYyBwcm9ncmFtbWluZyBwcm9ibGVtcwogICAgLy8gVGVzdHMgb3B0aW1pemF0aW9uIG9mIERQIHRhYmxlIGFjY2VzcyBhbmQgY29tcHV0YXRpb24gcGF0dGVybnMKICAgIHRlc3RDbGFzc2ljRHluYW1pY1Byb2dyYW1taW5nKCk7CiAgICAKICAgIC8vIFRlc3QgMjogU2VxdWVuY2UgYWxpZ25tZW50IGFuZCBzdHJpbmcgRFAKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiAyRCBEUCB0YWJsZXMgYW5kIHN0cmluZyBvcGVyYXRpb25zCiAgICB0ZXN0U2VxdWVuY2VBbGlnbm1lbnREUCgpOwogICAgCiAgICAvLyBUZXN0IDM6IE9wdGltaXphdGlvbiBwcm9ibGVtcyAoa25hcHNhY2ssIHNjaGVkdWxpbmcpCiAgICAvLyBUZXN0cyBvcHRpbWl6YXRpb24gb2YgY29tYmluYXRvcmlhbCBvcHRpbWl6YXRpb24gYWxnb3JpdGhtcwogICAgdGVzdE9wdGltaXphdGlvblByb2JsZW1zKCk7CiAgICAKICAgIC8vIFRlc3QgNDogR2FtZSB0aGVvcnkgYW5kIG1pbmltYXggRFAKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiByZWN1cnNpdmUgRFAgd2l0aCBnYW1lIHRyZWUgc3RydWN0dXJlcwogICAgdGVzdEdhbWVUaGVvcnlEUCgpOwogICAgCiAgICAvLyBUZXN0IDU6IEFkdmFuY2VkIERQIHBhdHRlcm5zIChkaWdpdCBEUCwgYml0bWFzayBEUCkKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBjb21wbGV4IERQIHN0YXRlIHJlcHJlc2VudGF0aW9ucwogICAgdGVzdEFkdmFuY2VkRFBQYXR0ZXJucygpOwogICAgCiAgICAvLyBQZXJmb3JtYW5jZSB0ZXN0IG1hcmtlciAtIGVuZAogICAgcHJpbnRsbkludCgxODk5KTsKICAgIGV4aXQoMCk7Cn0KCi8vIFRlc3QgMTogQ2xhc3NpYyBEeW5hbWljIFByb2dyYW1taW5nIFByb2JsZW1zCmZuIHRlc3RDbGFzc2ljRHluYW1pY1Byb2dyYW1taW5nKCkgewogICAgcHJpbnRsbkludCgxODAxKTsgLy8gU3RhcnQgY2xhc3NpYyBEUCB0ZXN0CiAgICAKICAgIC8vIFRlc3QgRmlib25hY2NpIHdpdGggbWVtb2l6YXRpb24KICAgIGxldCBmaWJfcmVzdWx0OiBpMzIgPSBmaWJvbmFjY2lEUCg0NSk7CiAgICBwcmludGxuSW50KGZpYl9yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZQogICAgbGV0IG11dCBzZXF1ZW5jZTogW2kzMjsgMTAwXSA9IFswOyAxMDBdOwogICAgaW5pdGlhbGl6ZVNlcXVlbmNlKHNlcXVlbmNlLCAxMDApOwogICAgbGV0IGxpc19yZXN1bHQ6IGkzMiA9IGxvbmdlc3RJbmNyZWFzaW5nU3Vic2VxdWVuY2Uoc2VxdWVuY2UsIDEwMCk7CiAgICBwcmludGxuSW50KGxpc19yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IGNvaW4gY2hhbmdlIHByb2JsZW0KICAgIGxldCBjb2luX2NoYW5nZV9yZXN1bHQ6IGkzMiA9IGNvaW5DaGFuZ2VEUCgyNDcpOwogICAgcHJpbnRsbkludChjb2luX2NoYW5nZV9yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IG1heGltdW0gc3ViYXJyYXkgc3VtIChLYWRhbmUncyBhbGdvcml0aG0pCiAgICBsZXQgbXV0IGFycmF5OiBbaTMyOyAxNTBdID0gWzA7IDE1MF07CiAgICBpbml0aWFsaXplQXJyYXkoYXJyYXksIDE1MCk7CiAgICBsZXQgbWF4X3N1bV9yZXN1bHQ6IGkzMiA9IG1heGltdW1TdWJhcnJheVN1bShhcnJheSwgMTUwKTsKICAgIHByaW50bG5JbnQobWF4X3N1bV9yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IGhvdXNlIHJvYmJlciBwcm9ibGVtCiAgICBsZXQgcm9iYmVyX3Jlc3VsdDogaTMyID0gaG91c2VSb2JiZXJEUChhcnJheSwgMTUwKTsKICAgIHByaW50bG5JbnQocm9iYmVyX3Jlc3VsdCk7CiAgICAKICAgIHByaW50bG5JbnQoMTgwMik7IC8vIEVuZCBjbGFzc2ljIERQIHRlc3QKfQoKLy8gRmlib25hY2NpIHdpdGggZHluYW1pYyBwcm9ncmFtbWluZwpmbiBmaWJvbmFjY2lEUChuOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobiA8PSAxKSB7CiAgICAgICAgcmV0dXJuIG47CiAgICB9CiAgICAKICAgIGxldCBtdXQgZHA6IFtpMzI7IDQ2XSA9IFswOyA0Nl07CiAgICBkcFswXSA9IDA7CiAgICBkcFsxXSA9IDE7CiAgICAKICAgIGxldCBtdXQgaTogaTMyID0gMjsKICAgIHdoaWxlIChpIDw9IG4pIHsKICAgICAgICBkcFtpIGFzIHVzaXplXSA9IGRwWyhpIC0gMSkgYXMgdXNpemVdICsgZHBbKGkgLSAyKSBhcyB1c2l6ZV07CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gZHBbbiBhcyB1c2l6ZV07Cn0KCi8vIEluaXRpYWxpemUgc2VxdWVuY2UgZm9yIHRlc3RpbmcKZm4gaW5pdGlhbGl6ZVNlcXVlbmNlKG11dCBzZXF1ZW5jZTogW2kzMjsgMTAwXSwgc2l6ZTogaTMyKSB7CiAgICBsZXQgbXV0IHNlZWQ6IGkzMiA9IDE0NTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIAogICAgICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIHNlZWQgPSAoc2VlZCAqIDE2NjQgKyAxMDEyMjMpICUgMjE0NjQ3OwogICAgICAgICAgICBpZiAoc2VlZCA8IDApIHsKICAgICAgICAgICAgc2VlZCA9IC1zZWVkOwogICAgICAgIH0KICAgICAgICBzZXF1ZW5jZVtpIGFzIHVzaXplXSA9IHNlZWQgJSAxMDAwOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gTG9uZ2VzdCBJbmNyZWFzaW5nIFN1YnNlcXVlbmNlIHVzaW5nIERQCmZuIGxvbmdlc3RJbmNyZWFzaW5nU3Vic2VxdWVuY2Uoc2VxdWVuY2U6IFtpMzI7IDEwMF0sIHNpemU6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgZHA6IFtpMzI7IDEwMF0gPSBbMTsgMTAwXTsKICAgIGxldCBtdXQgbWF4X2xlbmd0aDogaTMyID0gMTsKICAgIAogICAgbGV0IG11dCBpOiBpMzIgPSAxOwogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgaSkgewogICAgICAgICAgICBpZiAoc2VxdWVuY2VbaiBhcyB1c2l6ZV0gPCBzZXF1ZW5jZVtpIGFzIHVzaXplXSAmJiBkcFtqIGFzIHVzaXplXSArIDEgPiBkcFtpIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgZHBbaSBhcyB1c2l6ZV0gPSBkcFtqIGFzIHVzaXplXSArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoZHBbaSBhcyB1c2l6ZV0gPiBtYXhfbGVuZ3RoKSB7CiAgICAgICAgICAgIG1heF9sZW5ndGggPSBkcFtpIGFzIHVzaXplXTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gbWF4X2xlbmd0aDsKfQoKLy8gQ29pbiBDaGFuZ2UgRFAgKG1pbmltdW0gY29pbnMgbmVlZGVkKQpmbiBjb2luQ2hhbmdlRFAoYW1vdW50OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgY29pbnM6IFtpMzI7IDVdID0gWzEsIDUsIDEwLCAyNSwgNTBdOwogICAgbGV0IG11dCBkcDogW2kzMjsgMjQ4XSA9IFs5OTk5OyAyNDhdOwogICAgZHBbMF0gPSAwOwogICAgCiAgICBsZXQgbXV0IGk6IGkzMiA9IDE7CiAgICB3aGlsZSAoaSA8PSBhbW91bnQpIHsKICAgICAgICBsZXQgbXV0IGNvaW5faWR4OiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChjb2luX2lkeCA8IDUpIHsKICAgICAgICAgICAgbGV0IGNvaW46IGkzMiA9IGNvaW5zW2NvaW5faWR4IGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGlmIChjb2luIDw9IGkgJiYgZHBbKGkgLSBjb2luKSBhcyB1c2l6ZV0gKyAxIDwgZHBbaSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIGRwW2kgYXMgdXNpemVdID0gZHBbKGkgLSBjb2luKSBhcyB1c2l6ZV0gKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvaW5faWR4ID0gY29pbl9pZHggKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBkcFthbW91bnQgYXMgdXNpemVdOwp9CgovLyBJbml0aWFsaXplIGFycmF5IHdpdGggbWl4ZWQgcG9zaXRpdmUgYW5kIG5lZ2F0aXZlIHZhbHVlcwpmbiBpbml0aWFsaXplQXJyYXkobXV0IGFycmF5OiBbaTMyOyAxNTBdLCBzaXplOiBpMzIpIHsKICAgIGxldCBtdXQgc2VlZDogaTMyID0gMzIxOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgCiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBzZWVkID0gKHNlZWQgKiAxNjY1ICsgOTA0MjIzKSAlIDE0MzY0NzsKICAgICAgICBpZiAoc2VlZCA8IDApIHsKICAgICAgICAgICAgc2VlZCA9IC1zZWVkOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBNaXggb2YgcG9zaXRpdmUgYW5kIG5lZ2F0aXZlIHZhbHVlcwogICAgICAgIGlmIChzZWVkICUgMyA9PSAwKSB7CiAgICAgICAgICAgIGFycmF5W2kgYXMgdXNpemVdID0gLShzZWVkICUgMTAwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhcnJheVtpIGFzIHVzaXplXSA9IHNlZWQgJSAxMDA7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gTWF4aW11bSBTdWJhcnJheSBTdW0gKEthZGFuZSdzIEFsZ29yaXRobSkKZm4gbWF4aW11bVN1YmFycmF5U3VtKGFycmF5OiBbaTMyOyAxNTBdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IG1heF9zb19mYXI6IGkzMiA9IGFycmF5WzBdOwogICAgbGV0IG11dCBtYXhfZW5kaW5nX2hlcmU6IGkzMiA9IGFycmF5WzBdOwogICAgCiAgICBsZXQgbXV0IGk6IGkzMiA9IDE7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBpZiAobWF4X2VuZGluZ19oZXJlICsgYXJyYXlbaSBhcyB1c2l6ZV0gPiBhcnJheVtpIGFzIHVzaXplXSkgewogICAgICAgICAgICBtYXhfZW5kaW5nX2hlcmUgPSBtYXhfZW5kaW5nX2hlcmUgKyBhcnJheVtpIGFzIHVzaXplXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBtYXhfZW5kaW5nX2hlcmUgPSBhcnJheVtpIGFzIHVzaXplXTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKG1heF9lbmRpbmdfaGVyZSA+IG1heF9zb19mYXIpIHsKICAgICAgICAgICAgbWF4X3NvX2ZhciA9IG1heF9lbmRpbmdfaGVyZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gbWF4X3NvX2ZhcjsKfQoKLy8gSG91c2UgUm9iYmVyIERQCmZuIGhvdXNlUm9iYmVyRFAoaG91c2VzOiBbaTMyOyAxNTBdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoc2l6ZSA9PSAwKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICBpZiAoc2l6ZSA9PSAxKSB7CiAgICAgICAgcmV0dXJuIGhvdXNlc1swXTsKICAgIH0KICAgIAogICAgbGV0IG11dCBkcDogW2kzMjsgMTUwXSA9IFswOyAxNTBdOwogICAgZHBbMF0gPSBob3VzZXNbMF07CiAgICAKICAgIGlmIChob3VzZXNbMV0gPiBob3VzZXNbMF0pIHsKICAgICAgICBkcFsxXSA9IGhvdXNlc1sxXTsKICAgIH0gZWxzZSB7CiAgICAgICAgZHBbMV0gPSBob3VzZXNbMF07CiAgICB9CiAgICAKICAgIGxldCBtdXQgaTogaTMyID0gMjsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGxldCByb2JfY3VycmVudDogaTMyID0gZHBbKGkgLSAyKSBhcyB1c2l6ZV0gKyBob3VzZXNbaSBhcyB1c2l6ZV07CiAgICAgICAgbGV0IHNraXBfY3VycmVudDogaTMyID0gZHBbKGkgLSAxKSBhcyB1c2l6ZV07CiAgICAgICAgCiAgICAgICAgaWYgKHJvYl9jdXJyZW50ID4gc2tpcF9jdXJyZW50KSB7CiAgICAgICAgICAgIGRwW2kgYXMgdXNpemVdID0gcm9iX2N1cnJlbnQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZHBbaSBhcyB1c2l6ZV0gPSBza2lwX2N1cnJlbnQ7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIGRwWyhzaXplIC0gMSkgYXMgdXNpemVdOwp9CgovLyBUZXN0IDI6IFNlcXVlbmNlIEFsaWdubWVudCBhbmQgU3RyaW5nIERQCmZuIHRlc3RTZXF1ZW5jZUFsaWdubWVudERQKCkgewogICAgcHJpbnRsbkludCgxODAzKTsgLy8gU3RhcnQgc2VxdWVuY2UgYWxpZ25tZW50IHRlc3QKICAgIAogICAgLy8gVGVzdCBlZGl0IGRpc3RhbmNlIChMZXZlbnNodGVpbiBkaXN0YW5jZSkKICAgIGxldCBtdXQgc3RyaW5nMTogW2kzMjsgNTBdID0gWzA7IDUwXTsKICAgIGxldCBtdXQgc3RyaW5nMjogW2kzMjsgNTBdID0gWzA7IDUwXTsKICAgIGluaXRpYWxpemVTdHJpbmdzKHN0cmluZzEsIHN0cmluZzIsIDMwLCAzNSk7CiAgICBsZXQgZWRpdF9kaXN0YW5jZTogaTMyID0gZWRpdERpc3RhbmNlRFAoc3RyaW5nMSwgc3RyaW5nMiwgMzAsIDM1KTsKICAgIHByaW50bG5JbnQoZWRpdF9kaXN0YW5jZSk7CiAgICAKICAgIC8vIFRlc3QgbG9uZ2VzdCBjb21tb24gc3Vic2VxdWVuY2UKICAgIGxldCBsY3NfcmVzdWx0OiBpMzIgPSBsb25nZXN0Q29tbW9uU3Vic2VxdWVuY2VEUChzdHJpbmcxLCBzdHJpbmcyLCAzMCwgMzUpOwogICAgcHJpbnRsbkludChsY3NfcmVzdWx0KTsKICAgIAogICAgLy8gVGVzdCBwYWxpbmRyb21lIHBhcnRpdGlvbmluZwogICAgbGV0IHBhbGluZHJvbWVfcmVzdWx0OiBpMzIgPSBwYWxpbmRyb21lUGFydGl0aW9uaW5nRFAoc3RyaW5nMSwgMzApOwogICAgcHJpbnRsbkludChwYWxpbmRyb21lX3Jlc3VsdCk7CiAgICAKICAgIC8vIFRlc3Qgc3RyaW5nIHJlY29uc3RydWN0aW9uIHByb2JsZW1zCiAgICBsZXQgcmVjb25zdHJ1Y3Rpb25fcmVzdWx0OiBpMzIgPSBzdHJpbmdSZWNvbnN0cnVjdGlvbkRQKHN0cmluZzEsIDMwKTsKICAgIHByaW50bG5JbnQocmVjb25zdHJ1Y3Rpb25fcmVzdWx0KTsKICAgIAogICAgcHJpbnRsbkludCgxODA0KTsgLy8gRW5kIHNlcXVlbmNlIGFsaWdubWVudCB0ZXN0Cn0KCi8vIEluaXRpYWxpemUgc3RyaW5ncyBmb3IgRFAgdGVzdGluZwpmbiBpbml0aWFsaXplU3RyaW5ncyhtdXQgc3RyaW5nMTogW2kzMjsgNTBdLCBtdXQgc3RyaW5nMjogW2kzMjsgNTBdLCBsZW4xOiBpMzIsIGxlbjI6IGkzMikgewogICAgbGV0IG11dCBzZWVkOiBpMzIgPSA5ODsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIAogICAgLy8gSW5pdGlhbGl6ZSBzdHJpbmcxCiAgICB3aGlsZSAoaSA8IGxlbjEpIHsKICAgICAgICBzZWVkID0gKHNlZWQgKiAxNjYgKyAxMDEzOTApICUgMjc0ODQ3OwogICAgICAgIGlmIChzZWVkIDwgMCkgewogICAgICAgICAgICBzZWVkID0gLXNlZWQ7CiAgICAgICAgfQogICAgICAgIHN0cmluZzFbaSBhcyB1c2l6ZV0gPSA2NSArIChzZWVkICUgMjYpOyAvLyBBLVoKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIEluaXRpYWxpemUgc3RyaW5nMiAod2l0aCBzb21lIHNpbWlsYXJpdHkgdG8gc3RyaW5nMSkKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBsZW4yKSB7CiAgICAgICAgc2VlZCA9IChzZWVkICogMTY2ICsgMTAxMzkwKSAlIDI3NDg0NzsKICAgICAgICBpZiAoc2VlZCA8IDApIHsKICAgICAgICAgICAgc2VlZCA9IC1zZWVkOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoaSA8IGxlbjEgJiYgc2VlZCAlIDMgPT0gMCkgewogICAgICAgICAgICBzdHJpbmcyW2kgYXMgdXNpemVdID0gc3RyaW5nMVtpIGFzIHVzaXplXTsgLy8gU29tZSBtYXRjaGluZyBjaGFyYWN0ZXJzCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RyaW5nMltpIGFzIHVzaXplXSA9IDY1ICsgKHNlZWQgJSAyNik7IC8vIEEtWgogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIEVkaXQgRGlzdGFuY2UgdXNpbmcgRFAKZm4gZWRpdERpc3RhbmNlRFAoc3RyaW5nMTogW2kzMjsgNTBdLCBzdHJpbmcyOiBbaTMyOyA1MF0sIGxlbjE6IGkzMiwgbGVuMjogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBkcDogW2kzMjsgMTgwMF0gPSBbMDsgMTgwMF07IC8vIDM2eDUwIHRhYmxlCiAgICAKICAgIC8vIEluaXRpYWxpemUgYmFzZSBjYXNlcwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPD0gbGVuMSkgewogICAgICAgIGRwWyhpICogKGxlbjIgKyAxKSArIDApIGFzIHVzaXplXSA9IGk7IC8vIEZpcnN0IGNvbHVtbgogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgd2hpbGUgKGogPD0gbGVuMikgewogICAgICAgIGRwWygwICogKGxlbjIgKyAxKSArIGopIGFzIHVzaXplXSA9IGo7IC8vIEZpcnN0IHJvdwogICAgICAgIGogPSBqICsgMTsKICAgIH0KICAgIAogICAgLy8gRmlsbCBEUCB0YWJsZQogICAgaSA9IDE7CiAgICB3aGlsZSAoaSA8PSBsZW4xKSB7CiAgICAgICAgaiA9IDE7CiAgICAgICAgd2hpbGUgKGogPD0gbGVuMikgewogICAgICAgICAgICBpZiAoc3RyaW5nMVsoaSAtIDEpIGFzIHVzaXplXSA9PSBzdHJpbmcyWyhqIC0gMSkgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBkcFsoaSAqIChsZW4yICsgMSkgKyBqKSBhcyB1c2l6ZV0gPSBkcFsoKGkgLSAxKSAqIChsZW4yICsgMSkgKyAoaiAtIDEpKSBhcyB1c2l6ZV07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBsZXQgaW5zZXJ0OiBpMzIgPSBkcFsoaSAqIChsZW4yICsgMSkgKyAoaiAtIDEpKSBhcyB1c2l6ZV0gKyAxOwogICAgICAgICAgICAgICAgbGV0IGRlbGV0ZTogaTMyID0gZHBbKCgoaSAtIDEpICogKGxlbjIgKyAxKSkgKyBqKSBhcyB1c2l6ZV0gKyAxOwogICAgICAgICAgICAgICAgbGV0IHJlcGxhY2U6IGkzMiA9IGRwWygoKGkgLSAxKSAqIChsZW4yICsgMSkpICsgKGogLSAxKSkgYXMgdXNpemVdICsgMTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbGV0IG1pbl92YWw6IGkzMiA9IGlmIChpbnNlcnQgPCBkZWxldGUpIHsKICAgICAgICAgICAgICAgICAgICBpbnNlcnQKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgZGVsZXRlCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiAocmVwbGFjZSA8IG1pbl92YWwpIHsKICAgICAgICAgICAgICAgICAgICBkcFsoaSAqIChsZW4yICsgMSkgKyBqKSBhcyB1c2l6ZV0gPSByZXBsYWNlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBkcFsoaSAqIChsZW4yICsgMSkgKyBqKSBhcyB1c2l6ZV0gPSBtaW5fdmFsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gZHBbKGxlbjEgKiAobGVuMiArIDEpICsgbGVuMikgYXMgdXNpemVdOwp9CgovLyBMb25nZXN0IENvbW1vbiBTdWJzZXF1ZW5jZSB1c2luZyBEUApmbiBsb25nZXN0Q29tbW9uU3Vic2VxdWVuY2VEUChzdHJpbmcxOiBbaTMyOyA1MF0sIHN0cmluZzI6IFtpMzI7IDUwXSwgbGVuMTogaTMyLCBsZW4yOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGRwOiBbaTMyOyAxODAwXSA9IFswOyAxODAwXTsgLy8gMzZ4NTAgdGFibGUKICAgIAogICAgbGV0IG11dCBpOiBpMzIgPSAxOwogICAgd2hpbGUgKGkgPD0gbGVuMSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMTsKICAgICAgICB3aGlsZSAoaiA8PSBsZW4yKSB7CiAgICAgICAgICAgIGlmIChzdHJpbmcxWyhpIC0gMSkgYXMgdXNpemVdID09IHN0cmluZzJbKGogLSAxKSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIGRwWyhpICogKGxlbjIgKyAxKSArIGopIGFzIHVzaXplXSA9IGRwWygoaSAtIDEpICogKGxlbjIgKyAxKSArIChqIC0gMSkpIGFzIHVzaXplXSArIDE7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBsZXQgZnJvbV9sZWZ0OiBpMzIgPSBkcFsoaSAqIChsZW4yICsgMSkgKyAoaiAtIDEpKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBsZXQgZnJvbV90b3A6IGkzMiA9IGRwWygoKGkgLSAxKSAqIChsZW4yICsgMSkpICsgaikgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiAoZnJvbV9sZWZ0ID4gZnJvbV90b3ApIHsKICAgICAgICAgICAgICAgICAgICBkcFsoaSAqIChsZW4yICsgMSkgKyBqKSBhcyB1c2l6ZV0gPSBmcm9tX2xlZnQ7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGRwWyhpICogKGxlbjIgKyAxKSArIGopIGFzIHVzaXplXSA9IGZyb21fdG9wOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gZHBbKGxlbjEgKiAobGVuMiArIDEpICsgbGVuMikgYXMgdXNpemVdOwp9CgovLyBQYWxpbmRyb21lIFBhcnRpdGlvbmluZyBEUApmbiBwYWxpbmRyb21lUGFydGl0aW9uaW5nRFAoc3RyaW5nOiBbaTMyOyA1MF0sIGxlbmd0aDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBkcDogW2kzMjsgNTBdID0gWzA7IDUwXTsKICAgIGxldCBtdXQgaXNfcGFsaW5kcm9tZTogW2Jvb2w7IDI1MDBdID0gW2ZhbHNlOyAyNTAwXTsgLy8gNTB4NTAgdGFibGUKICAgIAogICAgLy8gUHJlY29tcHV0ZSBwYWxpbmRyb21lIHRhYmxlCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IGxlbmd0aCkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IGxlbmd0aCkgewogICAgICAgICAgICBpZiAoaSA9PSBqKSB7CiAgICAgICAgICAgICAgICBpc19wYWxpbmRyb21lWyhpICogbGVuZ3RoICsgaikgYXMgdXNpemVdID0gdHJ1ZTsKICAgICAgICAgICAgfSBlbHNlIGlmIChpICsgMSA9PSBqKSB7CiAgICAgICAgICAgICAgICBpc19wYWxpbmRyb21lWyhpICogbGVuZ3RoICsgaikgYXMgdXNpemVdID0gKHN0cmluZ1tpIGFzIHVzaXplXSA9PSBzdHJpbmdbaiBhcyB1c2l6ZV0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKGkgPCBqKSB7CiAgICAgICAgICAgICAgICBpc19wYWxpbmRyb21lWyhpICogbGVuZ3RoICsgaikgYXMgdXNpemVdID0gKHN0cmluZ1tpIGFzIHVzaXplXSA9PSBzdHJpbmdbaiBhcyB1c2l6ZV0pICYmIAogICAgICAgICAgICAgICAgICAgIGlzX3BhbGluZHJvbWVbKChpICsgMSkgKiBsZW5ndGggKyAoaiAtIDEpKSBhcyB1c2l6ZV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIERQIGZvciBtaW5pbXVtIGN1dHMKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBsZW5ndGgpIHsKICAgICAgICBkcFtpIGFzIHVzaXplXSA9IGk7IC8vIE1heGltdW0gY3V0cyBuZWVkZWQKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPD0gaSkgewogICAgICAgICAgICBpZiAoaXNfcGFsaW5kcm9tZVsoaiAqIGxlbmd0aCArIGkpIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgaWYgKGogPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGRwW2kgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZHBbKGogLSAxKSBhcyB1c2l6ZV0gKyAxIDwgZHBbaSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgICAgICBkcFtpIGFzIHVzaXplXSA9IGRwWyhqIC0gMSkgYXMgdXNpemVdICsgMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIGRwWyhsZW5ndGggLSAxKSBhcyB1c2l6ZV07Cn0KCi8vIFN0cmluZyBSZWNvbnN0cnVjdGlvbiBEUApmbiBzdHJpbmdSZWNvbnN0cnVjdGlvbkRQKHN0cmluZzogW2kzMjsgNTBdLCBsZW5ndGg6IGkzMikgLT4gaTMyIHsKICAgIC8vIENvdW50IG51bWJlciBvZiB3YXlzIHRvIHJlY29uc3RydWN0IHN0cmluZyB3aXRoIHNwZWNpZmljIHBhdHRlcm5zCiAgICBsZXQgbXV0IGRwOiBbaTMyOyA1MF0gPSBbMDsgNTBdOwogICAgZHBbMF0gPSAxOwogICAgCiAgICBsZXQgbXV0IGk6IGkzMiA9IDE7CiAgICB3aGlsZSAoaSA8PSBsZW5ndGgpIHsKICAgICAgICAvLyBTaW5nbGUgY2hhcmFjdGVyCiAgICAgICAgaWYgKGkgPj0gMSAmJiBzdHJpbmdbKGkgLSAxKSBhcyB1c2l6ZV0gPj0gNjUgJiYgc3RyaW5nWyhpIC0gMSkgYXMgdXNpemVdIDw9IDkwKSB7CiAgICAgICAgICAgIGRwW2kgYXMgdXNpemVdID0gZHBbaSBhcyB1c2l6ZV0gKyBkcFsoaSAtIDEpIGFzIHVzaXplXTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gVHdvIGNoYXJhY3RlciBjb21iaW5hdGlvbgogICAgICAgIGlmIChpID49IDIgJiYgc3RyaW5nWyhpIC0gMikgYXMgdXNpemVdID49IDY1ICYmIHN0cmluZ1soaSAtIDIpIGFzIHVzaXplXSA8PSA5MCAmJgogICAgICAgICAgIHN0cmluZ1soaSAtIDEpIGFzIHVzaXplXSA+PSA2NSAmJiBzdHJpbmdbKGkgLSAxKSBhcyB1c2l6ZV0gPD0gOTApIHsKICAgICAgICAgICAgZHBbaSBhcyB1c2l6ZV0gPSBkcFtpIGFzIHVzaXplXSArIGRwWyhpIC0gMikgYXMgdXNpemVdOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBUaHJlZSBjaGFyYWN0ZXIgY29tYmluYXRpb24gKGxlc3MgY29tbW9uKQogICAgICAgIGlmIChpID49IDMgJiYgc3RyaW5nWyhpIC0gMykgYXMgdXNpemVdID49IDY1ICYmIHN0cmluZ1soaSAtIDMpIGFzIHVzaXplXSA8PSA5MCAmJgogICAgICAgICAgIHN0cmluZ1soaSAtIDIpIGFzIHVzaXplXSA+PSA2NSAmJiBzdHJpbmdbKGkgLSAyKSBhcyB1c2l6ZV0gPD0gOTAgJiYKICAgICAgICAgICBzdHJpbmdbKGkgLSAxKSBhcyB1c2l6ZV0gPj0gNjUgJiYgc3RyaW5nWyhpIC0gMSkgYXMgdXNpemVdIDw9IDkwKSB7CiAgICAgICAgICAgIGRwW2kgYXMgdXNpemVdID0gZHBbaSBhcyB1c2l6ZV0gKyBkcFsoaSAtIDMpIGFzIHVzaXplXSAvIDI7IC8vIFJlZHVjZWQgd2VpZ2h0CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIGRwW2xlbmd0aCBhcyB1c2l6ZV07Cn0KCi8vIFRlc3QgMzogT3B0aW1pemF0aW9uIFByb2JsZW1zCmZuIHRlc3RPcHRpbWl6YXRpb25Qcm9ibGVtcygpIHsKICAgIHByaW50bG5JbnQoMTgwNSk7IC8vIFN0YXJ0IG9wdGltaXphdGlvbiBwcm9ibGVtcyB0ZXN0CiAgICAKICAgIC8vIFRlc3QgMC8xIEtuYXBzYWNrIHByb2JsZW0KICAgIGxldCBrbmFwc2Fja19yZXN1bHQ6IGkzMiA9IGtuYXBzYWNrRFAoNTAsIDEwMCk7CiAgICBwcmludGxuSW50KGtuYXBzYWNrX3Jlc3VsdCk7CiAgICAKICAgIC8vIFRlc3QgdW5ib3VuZGVkIGtuYXBzYWNrCiAgICBsZXQgdW5ib3VuZGVkX2tuYXBzYWNrX3Jlc3VsdDogaTMyID0gdW5ib3VuZGVkS25hcHNhY2tEUCg1MCwgMTAwKTsKICAgIHByaW50bG5JbnQodW5ib3VuZGVkX2tuYXBzYWNrX3Jlc3VsdCk7CiAgICAKICAgIC8vIFRlc3Qgam9iIHNjaGVkdWxpbmcgd2l0aCBkZWFkbGluZXMKICAgIGxldCBzY2hlZHVsaW5nX3Jlc3VsdDogaTMyID0gam9iU2NoZWR1bGluZ0RQKDMwKTsKICAgIHByaW50bG5JbnQoc2NoZWR1bGluZ19yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IHBhcnRpdGlvbiBwcm9ibGVtCiAgICBsZXQgcGFydGl0aW9uX3Jlc3VsdDogaTMyID0gcGFydGl0aW9uUHJvYmxlbURQKDQwKTsKICAgIHByaW50bG5JbnQocGFydGl0aW9uX3Jlc3VsdCk7CiAgICAKICAgIC8vIFRlc3QgbWF0cml4IGNoYWluIG11bHRpcGxpY2F0aW9uCiAgICBsZXQgbWF0cml4X2NoYWluX3Jlc3VsdDogaTMyID0gbWF0cml4Q2hhaW5NdWx0aXBsaWNhdGlvbkRQKDIwKTsKICAgIHByaW50bG5JbnQobWF0cml4X2NoYWluX3Jlc3VsdCk7CiAgICAKICAgIHByaW50bG5JbnQoMTgwNik7IC8vIEVuZCBvcHRpbWl6YXRpb24gcHJvYmxlbXMgdGVzdAp9CgovLyAwLzEgS25hcHNhY2sgRFAKZm4ga25hcHNhY2tEUChudW1faXRlbXM6IGkzMiwgY2FwYWNpdHk6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgd2VpZ2h0czogW2kzMjsgNTBdID0gWzA7IDUwXTsKICAgIGxldCBtdXQgdmFsdWVzOiBbaTMyOyA1MF0gPSBbMDsgNTBdOwogICAgCiAgICAvLyBJbml0aWFsaXplIGl0ZW1zCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHNlZWQ6IGkzMiA9IDExMTsKICAgIHdoaWxlIChpIDwgbnVtX2l0ZW1zKSB7CiAgICAgICAgc2VlZCA9IChzZWVkICogNTI1ICsgMzkwNDIyKSAlIDQ4MzY0NzsKICAgICAgICBpZiAoc2VlZCA8IDApIHsKICAgICAgICAgICAgc2VlZCA9IC1zZWVkOwogICAgICAgIH0KICAgICAgICB3ZWlnaHRzW2kgYXMgdXNpemVdID0gMSArIChzZWVkICUgMjApOwogICAgICAgIHZhbHVlc1tpIGFzIHVzaXplXSA9IDEwICsgKHNlZWQgJSA1MCk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICAvLyBEUCB0YWJsZQogICAgbGV0IG11dCBkcDogW2kzMjsgNTE1MV0gPSBbMDsgNTE1MV07IC8vIChudW1faXRlbXMrMSkgeCAoY2FwYWNpdHkrMSkKICAgIAogICAgaSA9IDE7CiAgICB3aGlsZSAoaSA8PSBudW1faXRlbXMpIHsKICAgICAgICBsZXQgbXV0IHc6IGkzMiA9IDE7CiAgICAgICAgd2hpbGUgKHcgPD0gY2FwYWNpdHkpIHsKICAgICAgICAgICAgLy8gRG9uJ3QgdGFrZSBpdGVtIGktMQogICAgICAgICAgICBkcFsoaSAqIChjYXBhY2l0eSArIDEpICsgdykgYXMgdXNpemVdID0gZHBbKCgoaSAtIDEpICogKGNhcGFjaXR5ICsgMSkpICsgdykgYXMgdXNpemVdOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gVGFrZSBpdGVtIGktMSBpZiBwb3NzaWJsZQogICAgICAgIGlmICh3ZWlnaHRzWyhpIC0gMSkgYXMgdXNpemVdIDw9IHcpIHsKICAgICAgICAgICAgICAgIGxldCB0YWtlX3ZhbHVlOiBpMzIgPSB2YWx1ZXNbKGkgLSAxKSBhcyB1c2l6ZV0gKyBkcFsoKChpIC0gMSkgKiAoY2FwYWNpdHkgKyAxKSkgKyAodyAtIHdlaWdodHNbKGkgLSAxKSBhcyB1c2l6ZV0pKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBpZiAodGFrZV92YWx1ZSA+IGRwWyhpICogKGNhcGFjaXR5ICsgMSkgKyB3KSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgICAgICBkcFsoaSAqIChjYXBhY2l0eSArIDEpICsgdykgYXMgdXNpemVdID0gdGFrZV92YWx1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgdyA9IHcgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBkcFsobnVtX2l0ZW1zICogKGNhcGFjaXR5ICsgMSkgKyBjYXBhY2l0eSkgYXMgdXNpemVdOwp9CgovLyBVbmJvdW5kZWQgS25hcHNhY2sgRFAKZm4gdW5ib3VuZGVkS25hcHNhY2tEUChudW1faXRlbXM6IGkzMiwgY2FwYWNpdHk6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgd2VpZ2h0czogW2kzMjsgNTBdID0gWzA7IDUwXTsKICAgIGxldCBtdXQgdmFsdWVzOiBbaTMyOyA1MF0gPSBbMDsgNTBdOwogICAgCiAgICAvLyBJbml0aWFsaXplIGl0ZW1zCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHNlZWQ6IGkzMiA9IDIyMjsKICAgIHdoaWxlIChpIDwgbnVtX2l0ZW1zKSB7CiAgICAgICAgc2VlZCA9IChzZWVkICogMTY2NCArIDkwNDIyMykgJSA4MzY0NzsKICAgICAgICBpZiAoc2VlZCA8IDApIHsKICAgICAgICAgICAgc2VlZCA9IC1zZWVkOwogICAgICAgIH0KICAgICAgICB3ZWlnaHRzW2kgYXMgdXNpemVdID0gMSArIChzZWVkICUgMTUpOwogICAgICAgIHZhbHVlc1tpIGFzIHVzaXplXSA9IDUgKyAoc2VlZCAlIDQwKTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIERQIGFycmF5CiAgICBsZXQgbXV0IGRwOiBbaTMyOyAxMDFdID0gWzA7IDEwMV07CiAgICAKICAgIGxldCBtdXQgdzogaTMyID0gMTsKICAgIHdoaWxlICh3IDw9IGNhcGFjaXR5KSB7CiAgICAgICAgaSA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBudW1faXRlbXMpIHsKICAgICAgICAgICAgaWYgKHdlaWdodHNbaSBhcyB1c2l6ZV0gPD0gdykgewogICAgICAgICAgICAgICAgbGV0IG5ld192YWx1ZTogaTMyID0gdmFsdWVzW2kgYXMgdXNpemVdICsgZHBbKHcgLSB3ZWlnaHRzW2kgYXMgdXNpemVdKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBpZiAobmV3X3ZhbHVlID4gZHBbdyBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgICAgICBkcFt3IGFzIHVzaXplXSA9IG5ld192YWx1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIHcgPSB3ICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIGRwW2NhcGFjaXR5IGFzIHVzaXplXTsKfQoKLy8gSm9iIFNjaGVkdWxpbmcgd2l0aCBEZWFkbGluZXMgRFAKZm4gam9iU2NoZWR1bGluZ0RQKG51bV9qb2JzOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHByb2ZpdHM6IFtpMzI7IDMwXSA9IFswOyAzMF07CiAgICBsZXQgbXV0IGRlYWRsaW5lczogW2kzMjsgMzBdID0gWzA7IDMwXTsKICAgIAogICAgLy8gSW5pdGlhbGl6ZSBqb2JzCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHNlZWQ6IGkzMiA9IDMzOwogICAgd2hpbGUgKGkgPCBudW1fam9icykgewogICAgICAgIHNlZWQgPSAoc2VlZCAqIDE2NjQgKyA5MDQyMjMpICUgODM2NDc7CiAgICAgICAgaWYgKHNlZWQgPCAwKSB7CiAgICAgICAgICAgIHNlZWQgPSAtc2VlZDsKICAgICAgICB9CiAgICAgICAgcHJvZml0c1tpIGFzIHVzaXplXSA9IDEwICsgKHNlZWQgJSAxMDApOwogICAgICAgIGRlYWRsaW5lc1tpIGFzIHVzaXplXSA9IDEgKyAoc2VlZCAlIDIwKTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIFNvcnQgam9icyBieSBwcm9maXQgKHNpbXBsZSBidWJibGUgc29ydCkKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBudW1fam9icyAtIDEpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBudW1fam9icyAtIGkgLSAxKSB7CiAgICAgICAgICAgIGlmIChwcm9maXRzW2ogYXMgdXNpemVdIDwgcHJvZml0c1soaiArIDEpIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgLy8gU3dhcCBwcm9maXRzCiAgICAgICAgICAgICAgICBsZXQgdGVtcF9wcm9maXQ6IGkzMiA9IHByb2ZpdHNbaiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBwcm9maXRzW2ogYXMgdXNpemVdID0gcHJvZml0c1soaiArIDEpIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIHByb2ZpdHNbKGogKyAxKSBhcyB1c2l6ZV0gPSB0ZW1wX3Byb2ZpdDsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gU3dhcCBkZWFkbGluZXMKICAgICAgICAgICAgICAgIGxldCB0ZW1wX2RlYWRsaW5lOiBpMzIgPSBkZWFkbGluZXNbaiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBkZWFkbGluZXNbaiBhcyB1c2l6ZV0gPSBkZWFkbGluZXNbKGogKyAxKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBkZWFkbGluZXNbKGogKyAxKSBhcyB1c2l6ZV0gPSB0ZW1wX2RlYWRsaW5lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICAvLyBTY2hlZHVsZSBqb2JzIGdyZWVkaWx5CiAgICBsZXQgbXV0IHNjaGVkdWxlOiBbYm9vbDsgMjBdID0gW2ZhbHNlOyAyMF07CiAgICBsZXQgbXV0IHRvdGFsX3Byb2ZpdDogaTMyID0gMDsKICAgIAogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IG51bV9qb2JzKSB7CiAgICAgICAgbGV0IG11dCBzbG90OiBpMzIgPSBkZWFkbGluZXNbaSBhcyB1c2l6ZV0gLSAxOwogICAgICAgIAogICAgICAgIC8vIEZpbmQgYXZhaWxhYmxlIHNsb3QKICAgICAgICB3aGlsZSAoc2xvdCA+PSAwKSB7CiAgICAgICAgICAgIGlmIChzbG90IDwgMjAgJiYgIXNjaGVkdWxlW3Nsb3QgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBzY2hlZHVsZVtzbG90IGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgICAgICAgICB0b3RhbF9wcm9maXQgPSB0b3RhbF9wcm9maXQgKyBwcm9maXRzW2kgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2xvdCA9IHNsb3QgLSAxOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiB0b3RhbF9wcm9maXQ7Cn0KCi8vIFBhcnRpdGlvbiBQcm9ibGVtIERQCmZuIHBhcnRpdGlvblByb2JsZW1EUChudW1fZWxlbWVudHM6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgZWxlbWVudHM6IFtpMzI7IDQwXSA9IFswOyA0MF07CiAgICBsZXQgbXV0IHRvdGFsX3N1bTogaTMyID0gMDsKICAgIAogICAgLy8gSW5pdGlhbGl6ZSBlbGVtZW50cwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgbGV0IG11dCBzZWVkOiBpMzIgPSA0NDsKICAgIHdoaWxlIChpIDwgbnVtX2VsZW1lbnRzKSB7CiAgICAgICAgc2VlZCA9IChzZWVkICogMTY2NCArIDkwNDIyMykgJSA4MzY0NzsKICAgICAgICBpZiAoc2VlZCA8IDApIHsKICAgICAgICAgICAgc2VlZCA9IC1zZWVkOwogICAgICAgIH0KICAgICAgICBlbGVtZW50c1tpIGFzIHVzaXplXSA9IDEgKyAoc2VlZCAlIDUwKTsKICAgICAgICB0b3RhbF9zdW0gPSB0b3RhbF9zdW0gKyBlbGVtZW50c1tpIGFzIHVzaXplXTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIENoZWNrIGlmIHBhcnRpdGlvbiBpcyBwb3NzaWJsZQogICAgaWYgKHRvdGFsX3N1bSAlIDIgIT0gMCkgewogICAgICAgIHJldHVybiAwOyAvLyBDYW5ub3QgcGFydGl0aW9uIG9kZCBzdW0gaW50byB0d28gZXF1YWwgcGFydHMKICAgIH0KICAgIAogICAgbGV0IHRhcmdldDogaTMyID0gdG90YWxfc3VtIC8gMjsKICAgIGxldCBtdXQgZHA6IFtib29sOyAxMDAxXSA9IFtmYWxzZTsgMTAwMV07IC8vIFN1YnNldCBzdW0gRFAKICAgIGRwWzBdID0gdHJ1ZTsKICAgIAogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IG51bV9lbGVtZW50cykgewogICAgICAgIGxldCBtdXQgajogaTMyID0gdGFyZ2V0OwogICAgICAgIHdoaWxlIChqID49IGVsZW1lbnRzW2kgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIGRwW2ogYXMgdXNpemVdID0gZHBbaiBhcyB1c2l6ZV0gfHwgZHBbKGogLSBlbGVtZW50c1tpIGFzIHVzaXplXSkgYXMgdXNpemVdOwogICAgICAgICAgICBqID0gaiAtIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgaWYgKGRwW3RhcmdldCBhcyB1c2l6ZV0pIHsKICAgICAgICByZXR1cm4gMTsgLy8gUGFydGl0aW9uIHBvc3NpYmxlCiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAwOyAvLyBQYXJ0aXRpb24gbm90IHBvc3NpYmxlCiAgICB9Cn0KCi8vIE1hdHJpeCBDaGFpbiBNdWx0aXBsaWNhdGlvbiBEUApmbiBtYXRyaXhDaGFpbk11bHRpcGxpY2F0aW9uRFAobnVtX21hdHJpY2VzOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGRpbWVuc2lvbnM6IFtpMzI7IDIxXSA9IFswOyAyMV07CiAgICAKICAgIC8vIEluaXRpYWxpemUgbWF0cml4IGRpbWVuc2lvbnMKICAgIGxldCBtdXQgc2VlZDogaTMyID0gNTU7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8PSBudW1fbWF0cmljZXMpIHsKICAgICAgICBzZWVkID0gKHNlZWQgKiAxNjY0ICsgOTA0MjIzKSAlIDgzNjQ3OwogICAgICAgIGlmIChzZWVkIDwgMCkgewogICAgICAgICAgICBzZWVkID0gLXNlZWQ7CiAgICAgICAgfQogICAgICAgIGRpbWVuc2lvbnNbaSBhcyB1c2l6ZV0gPSAxMCArIChzZWVkICUgNTApOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgLy8gRFAgdGFibGUgZm9yIG1pbmltdW0gbXVsdGlwbGljYXRpb25zCiAgICBsZXQgbXV0IGRwOiBbaTMyOyA0MDBdID0gWzA7IDQwMF07IC8vIDIweDIwIHRhYmxlLCB1c2UgMC1iYXNlZCBtYXBwaW5nOiBpZHgoaSxqKSA9IChpLTEpKjIwICsgKGotMSkKICAgIAogICAgbGV0IG11dCBsZW5ndGg6IGkzMiA9IDI7IC8vIENoYWluIGxlbmd0aAogICAgd2hpbGUgKGxlbmd0aCA8PSBudW1fbWF0cmljZXMpIHsKICAgICAgICBpID0gMTsKICAgICAgICB3aGlsZSAoaSA8PSBudW1fbWF0cmljZXMgLSBsZW5ndGggKyAxKSB7CiAgICAgICAgICAgIGxldCBqOiBpMzIgPSBpICsgbGVuZ3RoIC0gMTsKICAgICAgICAgICAgLy8gbWFwIChpLGopIC0+IDAtYmFzZWQgZHAgaW5kZXgKICAgICAgICAgICAgZHBbKCgoaSAtIDEpICogMjApICsgKGogLSAxKSkgYXMgdXNpemVdID0gOTk5OTk5OyAvLyBJbml0aWFsaXplIHRvIGxhcmdlIHZhbHVlCiAgICAgICAgICAgIAogICAgICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IGk7CiAgICAgICAgICAgIHdoaWxlIChrIDwgaikgewogICAgICAgICAgICAgICAgLy8gZHAoaSxrKSAtPiBkcFsoKGktMSkqMjAgKyAoay0xKSldLCBkcChrKzEsaikgLT4gZHBbKGsqMjAgKyAoai0xKSldCiAgICAgICAgICAgICAgICBsZXQgY29zdDogaTMyID0gZHBbKCgoaSAtIDEpICogMjApICsgKGsgLSAxKSkgYXMgdXNpemVdICsgZHBbKChrICogMjApICsgKGogLSAxKSkgYXMgdXNpemVdICsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaW1lbnNpb25zWyhpIC0gMSkgYXMgdXNpemVdICogZGltZW5zaW9uc1trIGFzIHVzaXplXSAqIGRpbWVuc2lvbnNbaiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIChjb3N0IDwgZHBbKCgoaSAtIDEpICogMjApICsgKGogLSAxKSkgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICAgICAgZHBbKCgoaSAtIDEpICogMjApICsgKGogLSAxKSkgYXMgdXNpemVdID0gY29zdDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgayA9IGsgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIGxlbmd0aCA9IGxlbmd0aCArIDE7CiAgICB9CiAgICAKICAgIC8vIGFuc3dlciBpcyBkcCgxLCBudW1fbWF0cmljZXMpIC0+IGRwWygwKjIwICsgKG51bV9tYXRyaWNlcy0xKSldCiAgICByZXR1cm4gZHBbKG51bV9tYXRyaWNlcyAtIDEpIGFzIHVzaXplXTsKfQoKLy8gVGVzdCA0OiBHYW1lIFRoZW9yeSBEUApmbiB0ZXN0R2FtZVRoZW9yeURQKCkgewogICAgcHJpbnRsbkludCgxODA3KTsgLy8gU3RhcnQgZ2FtZSB0aGVvcnkgdGVzdAogICAgCiAgICAvLyBUZXN0IG9wdGltYWwgZ2FtZSBzdHJhdGVneQogICAgbGV0IGdhbWVfcmVzdWx0OiBpMzIgPSBvcHRpbWFsR2FtZVN0cmF0ZWd5RFAoMjApOwogICAgcHJpbnRsbkludChnYW1lX3Jlc3VsdCk7CiAgICAKICAgIC8vIFRlc3QgY29pbiBnYW1lCiAgICBsZXQgY29pbl9nYW1lX3Jlc3VsdDogaTMyID0gY29pbkdhbWVEUCgzMCk7CiAgICBwcmludGxuSW50KGNvaW5fZ2FtZV9yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IG5pbSBnYW1lIHZhcmlhdGlvbnMKICAgIGxldCBuaW1fcmVzdWx0OiBpMzIgPSBuaW1HYW1lRFAoMjUpOwogICAgcHJpbnRsbkludChuaW1fcmVzdWx0KTsKICAgIAogICAgcHJpbnRsbkludCgxODA4KTsgLy8gRW5kIGdhbWUgdGhlb3J5IHRlc3QKfQoKLy8gT3B0aW1hbCBHYW1lIFN0cmF0ZWd5IERQCmZuIG9wdGltYWxHYW1lU3RyYXRlZ3lEUChudW1fY29pbnM6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgY29pbnM6IFtpMzI7IDIwXSA9IFswOyAyMF07CiAgICAKICAgIC8vIEluaXRpYWxpemUgY29pbiB2YWx1ZXMKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIGxldCBtdXQgc2VlZDogaTMyID0gNjY7CiAgICB3aGlsZSAoaSA8IG51bV9jb2lucykgewogICAgICAgIHNlZWQgPSAoc2VlZCAqIDE2NjQgKyA5MDQyMjMpICUgODM2NDc7CiAgICAgICAgaWYgKHNlZWQgPCAwKSB7CiAgICAgICAgICAgIHNlZWQgPSAtc2VlZDsKICAgICAgICB9CiAgICAgICAgY29pbnNbaSBhcyB1c2l6ZV0gPSAxICsgKHNlZWQgJSAxMDApOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgLy8gRFAgdGFibGUgZm9yIG1heGltdW0gZGlmZmVyZW5jZSBwbGF5ZXIgMSBjYW4gYWNoaWV2ZQogICAgbGV0IG11dCBkcDogW2kzMjsgNDAwXSA9IFswOyA0MDBdOyAvLyAyMHgyMCB0YWJsZQogICAgCiAgICAvLyBCYXNlIGNhc2U6IHNpbmdsZSBjb2luCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgbnVtX2NvaW5zKSB7CiAgICAgICAgZHBbKGkgKiAyMCArIGkpIGFzIHVzaXplXSA9IGNvaW5zW2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgLy8gRmlsbCBEUCB0YWJsZQogICAgbGV0IG11dCBsZW5ndGg6IGkzMiA9IDI7CiAgICB3aGlsZSAobGVuZ3RoIDw9IG51bV9jb2lucykgewogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDw9IG51bV9jb2lucyAtIGxlbmd0aCkgewogICAgICAgICAgICBsZXQgajogaTMyID0gaSArIGxlbmd0aCAtIDE7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBQbGF5ZXIgY2hvb3NlcyBjb2luIGksIG9wcG9uZW50IHBsYXlzIG9wdGltYWxseSBvbiBbaSsxLCBqXQogICAgICAgICAgICBsZXQgY2hvb3NlX2k6IGkzMiA9IGNvaW5zW2kgYXMgdXNpemVdIC0gZHBbKCgoaSArIDEpICogMjApICsgaikgYXMgdXNpemVdOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gUGxheWVyIGNob29zZXMgY29pbiBqLCBvcHBvbmVudCBwbGF5cyBvcHRpbWFsbHkgb24gW2ksIGotMV0KICAgICAgICAgICAgbGV0IGNob29zZV9qOiBpMzIgPSBjb2luc1tqIGFzIHVzaXplXSAtIGRwWyhpICogMjAgKyAoaiAtIDEpKSBhcyB1c2l6ZV07CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoY2hvb3NlX2kgPiBjaG9vc2VfaikgewogICAgICAgICAgICAgICAgZHBbKGkgKiAyMCArIGopIGFzIHVzaXplXSA9IGNob29zZV9pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZHBbKGkgKiAyMCArIGopIGFzIHVzaXplXSA9IGNob29zZV9qOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIGxlbmd0aCA9IGxlbmd0aCArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBkcFsobnVtX2NvaW5zIC0gMSkgYXMgdXNpemVdOwp9CgovLyBDb2luIEdhbWUgRFAKZm4gY29pbkdhbWVEUChudW1fY29pbnM6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgY29pbnM6IFtpMzI7IDMwXSA9IFswOyAzMF07CiAgICAKICAgIC8vIEluaXRpYWxpemUgY29pbnMKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIGxldCBtdXQgc2VlZDogaTMyID0gNzc7CiAgICB3aGlsZSAoaSA8IG51bV9jb2lucykgewogICAgICAgIHNlZWQgPSAoc2VlZCAqIDE2NjQgKyA5MDQyMjMpICUgODM2NDc7CiAgICAgICAgaWYgKHNlZWQgPCAwKSB7CiAgICAgICAgICAgIHNlZWQgPSAtc2VlZDsKICAgICAgICB9CiAgICAgICAgY29pbnNbaSBhcyB1c2l6ZV0gPSAxICsgKHNlZWQgJSA1MCk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICAvLyBEUCBmb3IgbWF4aW11bSBjb2lucyBwbGF5ZXIgMSBjYW4gY29sbGVjdAogICAgbGV0IG11dCBkcDogW2kzMjsgOTAwXSA9IFswOyA5MDBdOyAvLyAzMHgzMCB0YWJsZQogICAgCiAgICAvLyBCYXNlIGNhc2VzCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgbnVtX2NvaW5zKSB7CiAgICAgICAgZHBbKGkgKiAzMCArIGkpIGFzIHVzaXplXSA9IGNvaW5zW2kgYXMgdXNpemVdOwogICAgaWYgKGkgKyAxIDwgbnVtX2NvaW5zKSB7CiAgICAgICAgICAgIGlmIChjb2luc1tpIGFzIHVzaXplXSA+IGNvaW5zWyhpICsgMSkgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBkcFsoaSAqIDMwICsgKGkgKyAxKSkgYXMgdXNpemVdID0gY29pbnNbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBkcFsoaSAqIDMwICsgKGkgKyAxKSkgYXMgdXNpemVdID0gY29pbnNbKGkgKyAxKSBhcyB1c2l6ZV07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICAvLyBGaWxsIERQIHRhYmxlCiAgICBsZXQgbXV0IGxlbmd0aDogaTMyID0gMzsKICAgIHdoaWxlIChsZW5ndGggPD0gbnVtX2NvaW5zKSB7CiAgICAgICAgaSA9IDA7CiAgICAgICAgd2hpbGUgKGkgPD0gbnVtX2NvaW5zIC0gbGVuZ3RoKSB7CiAgICAgICAgICAgIGxldCBqOiBpMzIgPSBpICsgbGVuZ3RoIC0gMTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFRha2UgZnJvbSBsZWZ0CiAgICAgICAgICAgIGxldCB0YWtlX2xlZnQ6IGkzMiA9IGNvaW5zW2kgYXMgdXNpemVdICsgCiAgICAgICAgICAgICAgICBpZiAoZHBbKCgoaSArIDIpICogMzApICsgaikgYXMgdXNpemVdIDwgZHBbKCgoaSArIDEpICogMzApICsgKGogLSAxKSkgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICAgICAgZHBbKCgoaSArIDIpICogMzApICsgaikgYXMgdXNpemVdCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGRwWygoKGkgKyAxKSAqIDMwKSArIChqIC0gMSkpIGFzIHVzaXplXQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFRha2UgZnJvbSByaWdodAogICAgICAgICAgICBsZXQgdGFrZV9yaWdodDogaTMyID0gY29pbnNbaiBhcyB1c2l6ZV0gKyAKICAgICAgICAgICAgICAgIGlmIChkcFsoaSAqIDMwICsgKGogLSAyKSkgYXMgdXNpemVdIDwgZHBbKCgoaSArIDEpICogMzApICsgKGogLSAxKSkgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICAgICAgZHBbKGkgKiAzMCArIChqIC0gMikpIGFzIHVzaXplXQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBkcFsoKChpICsgMSkgKiAzMCkgKyAoaiAtIDEpKSBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAodGFrZV9sZWZ0ID4gdGFrZV9yaWdodCkgewogICAgICAgICAgICAgICAgZHBbKGkgKiAzMCArIGopIGFzIHVzaXplXSA9IHRha2VfbGVmdDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGRwWyhpICogMzAgKyBqKSBhcyB1c2l6ZV0gPSB0YWtlX3JpZ2h0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIGxlbmd0aCA9IGxlbmd0aCArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBkcFsobnVtX2NvaW5zIC0gMSkgYXMgdXNpemVdOwp9CgovLyBOaW0gR2FtZSBEUApmbiBuaW1HYW1lRFAobnVtX3BpbGVzOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHBpbGVzOiBbaTMyOyAyNV0gPSBbMDsgMjVdOwogICAgCiAgICAvLyBJbml0aWFsaXplIHBpbGUgc2l6ZXMKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIGxldCBtdXQgc2VlZDogaTMyID0gODg7CiAgICB3aGlsZSAoaSA8IG51bV9waWxlcykgewogICAgICAgIHNlZWQgPSAoc2VlZCAqIDE2NjQgKyA5MDQyMjMpICUgODM2NDc7CiAgICAgICAgaWYgKHNlZWQgPCAwKSB7CiAgICAgICAgICAgIHNlZWQgPSAtc2VlZDsKICAgICAgICB9CiAgICAgICAgcGlsZXNbaSBhcyB1c2l6ZV0gPSAxICsgKHNlZWQgJSAyMCk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICAvLyBDYWxjdWxhdGUgTmltLXN1bSAoWE9SIG9mIGFsbCBwaWxlIHNpemVzKQogICAgbGV0IG11dCBuaW1fc3VtOiBpMzIgPSAwOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IG51bV9waWxlcykgewogICAgICAgIG5pbV9zdW0gPSBuaW1fc3VtIF4gcGlsZXNbaSBhcyB1c2l6ZV07IC8vIFhPUiBvcGVyYXRpb24KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIENvdW50IHdpbm5pbmcgbW92ZXMKICAgIGxldCBtdXQgd2lubmluZ19tb3ZlczogaTMyID0gMDsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBudW1fcGlsZXMpIHsKICAgICAgICBsZXQgdGFyZ2V0OiBpMzIgPSBuaW1fc3VtIF4gcGlsZXNbaSBhcyB1c2l6ZV07CiAgICAgICAgaWYgKHRhcmdldCA8IHBpbGVzW2kgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIHdpbm5pbmdfbW92ZXMgPSB3aW5uaW5nX21vdmVzICsgKHBpbGVzW2kgYXMgdXNpemVdIC0gdGFyZ2V0KTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gd2lubmluZ19tb3ZlczsKfQoKLy8gVGVzdCA1OiBBZHZhbmNlZCBEUCBQYXR0ZXJucwpmbiB0ZXN0QWR2YW5jZWREUFBhdHRlcm5zKCkgewogICAgcHJpbnRsbkludCgxODA5KTsgLy8gU3RhcnQgYWR2YW5jZWQgRFAgdGVzdAogICAgCiAgICAvLyBUZXN0IGRpZ2l0IERQCiAgICBsZXQgZGlnaXRfZHBfcmVzdWx0OiBpMzIgPSBkaWdpdERQKDEyMzQ1KTsKICAgIHByaW50bG5JbnQoZGlnaXRfZHBfcmVzdWx0KTsKICAgIAogICAgLy8gVGVzdCBiaXRtYXNrIERQCiAgICBsZXQgYml0bWFza19kcF9yZXN1bHQ6IGkzMiA9IGJpdG1hc2tEUCgxNSk7CiAgICBwcmludGxuSW50KGJpdG1hc2tfZHBfcmVzdWx0KTsKICAgIAogICAgLy8gVGVzdCB0cmVlIERQCiAgICBsZXQgdHJlZV9kcF9yZXN1bHQ6IGkzMiA9IHRyZWVEUCgyMCk7CiAgICBwcmludGxuSW50KHRyZWVfZHBfcmVzdWx0KTsKICAgIAogICAgcHJpbnRsbkludCgxODEwKTsgLy8gRW5kIGFkdmFuY2VkIERQIHRlc3QKfQoKLy8gRGlnaXQgRFAgLSBjb3VudCBudW1iZXJzIHdpdGggc3BlY2lmaWMgcHJvcGVydGllcwpmbiBkaWdpdERQKG51bWJlcjogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBkaWdpdHM6IFtpMzI7IDEwXSA9IFswOyAxMF07CiAgICBsZXQgbXV0IGRpZ2l0X2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCB0ZW1wOiBpMzIgPSBudW1iZXI7CiAgICAKICAgIC8vIEV4dHJhY3QgZGlnaXRzCiAgICB3aGlsZSAodGVtcCA+IDApIHsKICAgICAgICBkaWdpdHNbZGlnaXRfY291bnQgYXMgdXNpemVdID0gdGVtcCAlIDEwOwogICAgICAgIHRlbXAgPSB0ZW1wIC8gMTA7CiAgICAgICAgZGlnaXRfY291bnQgPSBkaWdpdF9jb3VudCArIDE7CiAgICB9CiAgICAKICAgIC8vIFJldmVyc2UgZGlnaXRzIGFycmF5CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IGRpZ2l0X2NvdW50IC8gMikgewogICAgICAgIGxldCBzd2FwX3RlbXA6IGkzMiA9IGRpZ2l0c1tpIGFzIHVzaXplXTsKICAgICAgICBkaWdpdHNbaSBhcyB1c2l6ZV0gPSBkaWdpdHNbKGRpZ2l0X2NvdW50IC0gMSAtIGkpIGFzIHVzaXplXTsKICAgICAgICBkaWdpdHNbKGRpZ2l0X2NvdW50IC0gMSAtIGkpIGFzIHVzaXplXSA9IHN3YXBfdGVtcDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIENvdW50IG51bWJlcnMgd2l0aCBzdW0gb2YgZGlnaXRzIGRpdmlzaWJsZSBieSAzCiAgICBsZXQgbXV0IGRwOiBbaTMyOyAxMDBdID0gWzA7IDEwMF07IC8vIFtwb3NpdGlvbl1bc3VtX21vZF8zXVt0aWdodF0KICAgIHJldHVybiBkaWdpdERQUmVjdXJzaXZlKGRpZ2l0cywgZGlnaXRfY291bnQsIDAsIDAsIHRydWUsIGRwKTsKfQoKZm4gZGlnaXREUFJlY3Vyc2l2ZShkaWdpdHM6IFtpMzI7IDEwXSwgZGlnaXRfY291bnQ6IGkzMiwgcG9zOiBpMzIsIAogICAgICAgICAgICAgICAgICAgc3VtX21vZDogaTMyLCB0aWdodDogYm9vbCwgbXV0IGRwOiBbaTMyOyAxMDBdKSAtPiBpMzIgewogICAgaWYgKHBvcyA9PSBkaWdpdF9jb3VudCkgewogICAgICAgIGlmIChzdW1fbW9kID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgfQogICAgCiAgICBsZXQgc3RhdGU6IGkzMiA9IHBvcyAqIDEwICsgc3VtX21vZCAqIDIgKyBpZiAodGlnaHQpIHsgMSB9IGVsc2UgeyAwIH07CiAgICBpZiAoc3RhdGUgPCAxMDAgJiYgZHBbc3RhdGUgYXMgdXNpemVdICE9IDApIHsKICAgICAgICByZXR1cm4gZHBbc3RhdGUgYXMgdXNpemVdOwogICAgfQogICAgCiAgICBsZXQgbGltaXQ6IGkzMiA9IGlmICh0aWdodCkgewogICAgICAgIGRpZ2l0c1twb3MgYXMgdXNpemVdCiAgICB9IGVsc2UgewogICAgICAgIDkKICAgIH07CiAgICAKICAgIGxldCBtdXQgcmVzdWx0OiBpMzIgPSAwOwogICAgbGV0IG11dCBkaWdpdDogaTMyID0gMDsKICAgIHdoaWxlIChkaWdpdCA8PSBsaW1pdCkgewogICAgICAgIGxldCBuZXdfc3VtX21vZDogaTMyID0gKHN1bV9tb2QgKyBkaWdpdCkgJSAzOwogICAgICAgIGxldCBuZXdfdGlnaHQ6IGJvb2wgPSB0aWdodCAmJiAoZGlnaXQgPT0gbGltaXQpOwogICAgICAgIHJlc3VsdCA9IHJlc3VsdCArIGRpZ2l0RFBSZWN1cnNpdmUoZGlnaXRzLCBkaWdpdF9jb3VudCwgcG9zICsgMSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3X3N1bV9tb2QsIG5ld190aWdodCwgZHApOwogICAgICAgIGRpZ2l0ID0gZGlnaXQgKyAxOwogICAgfQogICAgCiAgICBpZiAoc3RhdGUgPCAxMDApIHsKICAgICAgICBkcFtzdGF0ZSBhcyB1c2l6ZV0gPSByZXN1bHQ7CiAgICB9CiAgICByZXN1bHQKfQoKLy8gQml0bWFzayBEUCAtIFRyYXZlbGluZyBTYWxlc21hbiBQcm9ibGVtCmZuIGJpdG1hc2tEUChudW1fY2l0aWVzOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGRpc3RhbmNlczogW2kzMjsgMjI1XSA9IFswOyAyMjVdOyAvLyAxNXgxNSBkaXN0YW5jZSBtYXRyaXgKICAgIAogICAgLy8gSW5pdGlhbGl6ZSBkaXN0YW5jZXMKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIGxldCBtdXQgc2VlZDogaTMyID0gOTk7CiAgICB3aGlsZSAoaSA8IG51bV9jaXRpZXMpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICB3aGlsZSAoaiA8IG51bV9jaXRpZXMpIHsKICAgICAgICAgICAgaWYgKGkgPT0gaikgewogICAgICAgICAgICAgICAgZGlzdGFuY2VzWyhpICogbnVtX2NpdGllcyArIGopIGFzIHVzaXplXSA9IDA7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzZWVkID0gKHNlZWQgKiAxNjY0ICsgOTA0MjIzKSAlIDgzNjQ3OwogICAgICAgICAgICAgICAgaWYgKHNlZWQgPCAwKSB7CiAgICAgICAgICAgICAgICAgICAgc2VlZCA9IC1zZWVkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZGlzdGFuY2VzWyhpICogbnVtX2NpdGllcyArIGopIGFzIHVzaXplXSA9IDEgKyAoc2VlZCAlIDEwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIERQIHdpdGggYml0bWFzawogICAgbGV0IHRvdGFsX3N0YXRlczogaTMyID0gMTsKICAgIGxldCBtdXQgc2hpZnQ6IGkzMiA9IDA7CiAgICB3aGlsZSAoc2hpZnQgPCBudW1fY2l0aWVzKSB7CiAgICAgICAgLy8gdG90YWxfc3RhdGVzICo9IDI7IC8vIFRoaXMgd291bGQgYmUgdG90YWxfc3RhdGVzIDw8IDEKICAgICAgICBzaGlmdCA9IHNoaWZ0ICsgMTsKICAgIH0KICAgIAogICAgLy8gU2ltcGxpZmllZCBUU1AgZm9yIHNtYWxsIG51bWJlciBvZiBjaXRpZXMKICAgIGxldCBtdXQgbWluX2Nvc3Q6IGkzMiA9IDk5OTk5OTsKICAgIGxldCBtdXQgbWFzazogaTMyID0gMTsKICAgIHdoaWxlIChtYXNrIDwgMzI3NjggJiYgbWFzayA8IHRvdGFsX3N0YXRlcykgeyAvLyBMaW1pdCB0byBwcmV2ZW50IG92ZXJmbG93CiAgICAgICAgbGV0IHZpc2l0ZWRfY291bnQ6IGkzMiA9IGNvdW50U2V0Qml0cyhtYXNrKTsKICAgICAgICBpZiAodmlzaXRlZF9jb3VudCA9PSBudW1fY2l0aWVzICYmIChtYXNrICYgMSkgIT0gMCkgewogICAgICAgICAgICBsZXQgY29zdDogaTMyID0gY2FsY3VsYXRlVG91ckNvc3QobWFzaywgZGlzdGFuY2VzLCBudW1fY2l0aWVzKTsKICAgICAgICAgICAgaWYgKGNvc3QgPCBtaW5fY29zdCkgewogICAgICAgICAgICAgICAgbWluX2Nvc3QgPSBjb3N0OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIG1hc2sgPSBtYXNrICsgMTsKICAgIH0KICAgIAogICAgbWluX2Nvc3QKfQoKLy8gQ291bnQgc2V0IGJpdHMgaW4gYSBudW1iZXIKZm4gY291bnRTZXRCaXRzKG46IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHRlbXA6IGkzMiA9IG47CiAgICAKICAgIHdoaWxlICh0ZW1wID4gMCkgewogICAgICAgIGNvdW50ID0gY291bnQgKyAodGVtcCAmIDEpOwogICAgICAgIHRlbXAgPSB0ZW1wIC8gMjsKICAgIH0KICAgIAogICAgcmV0dXJuIGNvdW50Owp9CgovLyBDYWxjdWxhdGUgdG91ciBjb3N0IGZvciBnaXZlbiBiaXRtYXNrCmZuIGNhbGN1bGF0ZVRvdXJDb3N0KG1hc2s6IGkzMiwgZGlzdGFuY2VzOiBbaTMyOyAyMjVdLCBudW1fY2l0aWVzOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGNvc3Q6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHByZXZfY2l0eTogaTMyID0gMDsKICAgIGxldCBtdXQgY2l0eTogaTMyID0gMTsKICAgIAogICAgd2hpbGUgKGNpdHkgPCBudW1fY2l0aWVzKSB7CiAgICAgICAgaWYgKChtYXNrICYgKDEgPDwgY2l0eSkpICE9IDApIHsKICAgICAgICAgICAgY29zdCA9IGNvc3QgKyBkaXN0YW5jZXNbKHByZXZfY2l0eSAqIG51bV9jaXRpZXMgKyBjaXR5KSBhcyB1c2l6ZV07CiAgICAgICAgICAgIHByZXZfY2l0eSA9IGNpdHk7CiAgICAgICAgfQogICAgICAgIGNpdHkgPSBjaXR5ICsgMTsKICAgIH0KICAgIAogICAgLy8gUmV0dXJuIHRvIHN0YXJ0CiAgICBjb3N0ID0gY29zdCArIGRpc3RhbmNlc1socHJldl9jaXR5ICogbnVtX2NpdGllcyArIDApIGFzIHVzaXplXTsKICAgIAogICAgcmV0dXJuIGNvc3Q7Cn0KCi8vIFRyZWUgRFAgLSBNYXhpbXVtIGluZGVwZW5kZW50IHNldCBpbiB0cmVlCmZuIHRyZWVEUChudW1fbm9kZXM6IGkzMikgLT4gaTMyIHsKICAgIC8vIENyZWF0ZSB0cmVlIHN0cnVjdHVyZSB1c2luZyBhZGphY2VuY3kgbGlzdCBzaW11bGF0aW9uCiAgICBsZXQgbXV0IHRyZWU6IFtpMzI7IDQwMF0gPSBbLTE7IDQwMF07IC8vIDIweDIwIGFkamFjZW5jeSBtYXRyaXgKICAgIGxldCBtdXQgbm9kZV92YWx1ZXM6IFtpMzI7IDIwXSA9IFswOyAyMF07CiAgICAKICAgIC8vIEluaXRpYWxpemUgdHJlZSBhbmQgbm9kZSB2YWx1ZXMKICAgIGxldCBtdXQgc2VlZDogaTMyID0gMTExOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBudW1fbm9kZXMpIHsKICAgICAgICBzZWVkID0gKHNlZWQgKiAxNjY0ICsgOTA0MjIzKSAlIDgzNjQ3OwogICAgaWYgKHNlZWQgPCAwKSB7CiAgICAgICAgICAgIHNlZWQgPSAtc2VlZDsKICAgICAgICB9CiAgICAgICAgbm9kZV92YWx1ZXNbaSBhcyB1c2l6ZV0gPSAxICsgKHNlZWQgJSA1MCk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICAvLyBDcmVhdGUgc2ltcGxlIHRyZWUgc3RydWN0dXJlCiAgICBpID0gMTsKICAgIHdoaWxlIChpIDwgbnVtX25vZGVzKSB7CiAgICAgICAgbGV0IHBhcmVudDogaTMyID0gKGkgLSAxKSAvIDI7CiAgICAgICAgdHJlZVsocGFyZW50ICogbnVtX25vZGVzICsgaSkgYXMgdXNpemVdID0gMTsKICAgICAgICB0cmVlWyhpICogbnVtX25vZGVzICsgcGFyZW50KSBhcyB1c2l6ZV0gPSAxOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgLy8gQ2FsY3VsYXRlIG1heGltdW0gaW5kZXBlbmRlbnQgc2V0CiAgICBsZXQgbXV0IGluY2x1ZGVfZHA6IFtpMzI7IDIwXSA9IFswOyAyMF07CiAgICBsZXQgbXV0IGV4Y2x1ZGVfZHA6IFtpMzI7IDIwXSA9IFswOyAyMF07CiAgICAKICAgIHJldHVybiB0cmVlRFBSZWN1cnNpdmUodHJlZSwgbm9kZV92YWx1ZXMsIG51bV9ub2RlcywgMCwgLTEsIGluY2x1ZGVfZHAsIGV4Y2x1ZGVfZHApOwp9CgpmbiB0cmVlRFBSZWN1cnNpdmUodHJlZTogW2kzMjsgNDAwXSwgbm9kZV92YWx1ZXM6IFtpMzI7IDIwXSwgbnVtX25vZGVzOiBpMzIsIAogICAgICAgICAgICAgICAgICBub2RlOiBpMzIsIHBhcmVudDogaTMyLCBtdXQgaW5jbHVkZV9kcDogW2kzMjsgMjBdLCBtdXQgZXhjbHVkZV9kcDogW2kzMjsgMjBdKSAtPiBpMzIgewogICAgaW5jbHVkZV9kcFtub2RlIGFzIHVzaXplXSA9IG5vZGVfdmFsdWVzW25vZGUgYXMgdXNpemVdOwogICAgZXhjbHVkZV9kcFtub2RlIGFzIHVzaXplXSA9IDA7CiAgICAKICAgIGxldCBtdXQgY2hpbGQ6IGkzMiA9IDA7CiAgICB3aGlsZSAoY2hpbGQgPCBudW1fbm9kZXMpIHsKICAgICAgICAgICAgaWYgKHRyZWVbKG5vZGUgKiBudW1fbm9kZXMgKyBjaGlsZCkgYXMgdXNpemVdID09IDEgJiYgY2hpbGQgIT0gcGFyZW50KSB7CiAgICAgICAgICAgIGxldCBjaGlsZF9yZXN1bHQ6IGkzMiA9IHRyZWVEUFJlY3Vyc2l2ZSh0cmVlLCBub2RlX3ZhbHVlcywgbnVtX25vZGVzLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQsIG5vZGUsIGluY2x1ZGVfZHAsIGV4Y2x1ZGVfZHApOwogICAgICAgICAgICAKICAgICAgICAgICAgaW5jbHVkZV9kcFtub2RlIGFzIHVzaXplXSA9IGluY2x1ZGVfZHBbbm9kZSBhcyB1c2l6ZV0gKyBleGNsdWRlX2RwW2NoaWxkIGFzIHVzaXplXTsKICAgICAgICAgICAgZXhjbHVkZV9kcFtub2RlIGFzIHVzaXplXSA9IGV4Y2x1ZGVfZHBbbm9kZSBhcyB1c2l6ZV0gKyAKICAgICAgICAgICAgICAgIGlmIChpbmNsdWRlX2RwW2NoaWxkIGFzIHVzaXplXSA+IGV4Y2x1ZGVfZHBbY2hpbGQgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICAgICAgaW5jbHVkZV9kcFtjaGlsZCBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgZXhjbHVkZV9kcFtjaGlsZCBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGNoaWxkID0gY2hpbGQgKyAxOwogICAgfQogICAgCiAgICBpZiAoaW5jbHVkZV9kcFtub2RlIGFzIHVzaXplXSA+IGV4Y2x1ZGVfZHBbbm9kZSBhcyB1c2l6ZV0pIHsKICAgICAgICByZXR1cm4gaW5jbHVkZV9kcFtub2RlIGFzIHVzaXplXTsKICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGV4Y2x1ZGVfZHBbbm9kZSBhcyB1c2l6ZV07CiAgICB9Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (9, "comprehensive9", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCA5OiBBZHZhbmNlZCBHcmFwaCBBbGdvcml0aG1zIGFuZCBOZXR3b3JrIEFuYWx5c2lzClN1bW1hcnk6IFRoaXMgdGVzdCBpbXBsZW1lbnRzIGEgY29tcGxleCBncmFwaCBwcm9jZXNzaW5nIHN5c3RlbSB3aXRoIG11bHRpcGxlIGFsZ29yaXRobXM6CkRldGFpbHM6CjEuIERpamtzdHJhJ3Mgc2hvcnRlc3QgcGF0aCBhbGdvcml0aG0KMi4gRmxveWQtV2Fyc2hhbGwgYWxsLXBhaXJzIHNob3J0ZXN0IHBhdGhzCjMuIE5ldHdvcmsgZmxvdyBhbmFseXNpcyB1c2luZyBGb3JkLUZ1bGtlcnNvbgo0LiBTdHJvbmdseSBjb25uZWN0ZWQgY29tcG9uZW50cyB1c2luZyBUYXJqYW4ncyBhbGdvcml0aG0KNS4gTWluaW11bSBzcGFubmluZyB0cmVlIHVzaW5nIEtydXNrYWwncyBhbGdvcml0aG0KKi8KCi8vIFVuaWZpZWQgUk5HOiBQYXJr4oCTTWlsbGVyIChhPTE2ODA3LCBtPTIxNDc0ODM2NDcpIHVzaW5nIFNjaHJhZ2UgbWV0aG9kIHRvIGF2b2lkIG92ZXJmbG93CmZuIHBtX3JhbmRfdXBkYXRlKHg6IGkzMikgLT4gaTMyIHsKICAgIGxldCBhOiBpMzIgPSAxNjgwNzsKICAgIGxldCBtOiBpMzIgPSAyMTQ3NDgzNjQ3OwogICAgbGV0IHE6IGkzMiA9IDEyNzc3MzsgLy8gbSAvIGEKICAgIGxldCByOiBpMzIgPSAyODM2OyAvLyBtICUgYQogICAgbGV0IG11dCBrOiBpMzIgPSB4IC8gcTsKICAgIGxldCBtdXQgbmV3X3g6IGkzMiA9IGEgKiAoeCAtIGsgKiBxKSAtIHIgKiBrOwogICAgaWYgKG5ld194IDw9IDApIHsKICAgICAgICBuZXdfeCArPSBtOwogICAgfQogICAgcmV0dXJuIG5ld194Owp9CgovLyBDb21wcmVoZW5zaXZlIFRlc3QgOTogQWR2YW5jZWQgR3JhcGggQWxnb3JpdGhtcyBhbmQgTmV0d29yayBBbmFseXNpcwovLyBUaGlzIHRlc3QgaW1wbGVtZW50cyBhIGNvbXBsZXggZ3JhcGggcHJvY2Vzc2luZyBzeXN0ZW0gd2l0aCBtdWx0aXBsZSBhbGdvcml0aG1zOgovLyAxLiBEaWprc3RyYSdzIHNob3J0ZXN0IHBhdGggYWxnb3JpdGhtCi8vIDIuIEZsb3lkLVdhcnNoYWxsIGFsbC1wYWlycyBzaG9ydGVzdCBwYXRocwovLyAzLiBOZXR3b3JrIGZsb3cgYW5hbHlzaXMgdXNpbmcgRm9yZC1GdWxrZXJzb24KLy8gNC4gU3Ryb25nbHkgY29ubmVjdGVkIGNvbXBvbmVudHMgdXNpbmcgVGFyamFuJ3MgYWxnb3JpdGhtCi8vIDUuIE1pbmltdW0gc3Bhbm5pbmcgdHJlZSB1c2luZyBLcnVza2FsJ3MgYWxnb3JpdGhtCgovLyBFZGdlIHN0cnVjdHVyZSBmb3IgZ3JhcGggcmVwcmVzZW50YXRpb24KCnN0cnVjdCBFZGdlIHsKICAgIGZyb206IGkzMiwKICAgIHRvOiBpMzIsCiAgICB3ZWlnaHQ6IGkzMiwKICAgIGNhcGFjaXR5OiBpMzIsCiAgICBmbG93OiBpMzIsCn0KCi8vIEdyYXBoIHN0cnVjdHVyZSB3aXRoIGFkamFjZW5jeSBsaXN0IHJlcHJlc2VudGF0aW9uCnN0cnVjdCBHcmFwaCB7CiAgICB2ZXJ0aWNlczogaTMyLAogICAgZWRnZXM6IFtFZGdlOyAyMDAwXSwKICAgIGVkZ2VfY291bnQ6IGkzMiwKICAgIGFkal9saXN0OiBbW2kzMjsgMTAwXTsgMTAwXSwgLy8gYWRqYWNlbmN5IGxpc3QgYXMgMkQgYXJyYXkKICAgIGFkal9jb3VudDogW2kzMjsgMTAwXSwKCiAgICAvLyBGb3IgRGlqa3N0cmEncyBhbGdvcml0aG0KICAgIGRpc3Q6IFtpMzI7IDEwMF0sCiAgICB2aXNpdGVkOiBbYm9vbDsgMTAwXSwKCiAgICAvLyBGb3IgRmxveWQtV2Fyc2hhbGwgYWxnb3JpdGhtCiAgICBmbG95ZF9kaXN0OiBbW2kzMjsgMTAwXTsgMTAwXSwKCiAgICAvLyBGb3IgVGFyamFuJ3MgU0NDIGFsZ29yaXRobQogICAgbG93OiBbaTMyOyAxMDBdLAogICAgZGlzYzogW2kzMjsgMTAwXSwKICAgIG9uX3N0YWNrOiBbYm9vbDsgMTAwXSwKICAgIHN0YWNrOiBbaTMyOyAxMDBdLAogICAgc3RhY2tfdG9wOiBpMzIsCiAgICB0aW1lOiBpMzIsCiAgICBzY2NfY291bnQ6IGkzMiwKCiAgICAvLyBGb3IgS3J1c2thbCdzIE1TVCBhbGdvcml0aG0KICAgIHBhcmVudDogW2kzMjsgMTAwXSwKICAgIHJhbms6IFtpMzI7IDEwMF0sCiAgICBtc3Rfd2VpZ2h0OiBpMzIsCn0KCmltcGwgRWRnZSB7CiAgICBmbiBuZXcoZnJvbTogaTMyLCB0bzogaTMyLCB3ZWlnaHQ6IGkzMiwgY2FwYWNpdHk6IGkzMikgLT4gRWRnZSB7CiAgICAgICAgRWRnZSB7CiAgICAgICAgICAgIGZyb206IGZyb20sCiAgICAgICAgICAgIHRvOiB0bywKICAgICAgICAgICAgd2VpZ2h0OiB3ZWlnaHQsCiAgICAgICAgICAgIGNhcGFjaXR5OiBjYXBhY2l0eSwKICAgICAgICAgICAgZmxvdzogMCwKICAgICAgICB9CiAgICB9Cn0KCmltcGwgR3JhcGggewogICAgZm4gbmV3KHZlcnRpY2VzOiBpMzIpIC0+IEdyYXBoIHsKICAgICAgICBsZXQgbXV0IGdyYXBoOiBHcmFwaCA9IEdyYXBoIHsKICAgICAgICAgICAgdmVydGljZXM6IHZlcnRpY2VzLAogICAgICAgICAgICBlZGdlczogW0VkZ2U6Om5ldygwLCAwLCAwLCAwKTsgMjAwMF0sCiAgICAgICAgICAgIGVkZ2VfY291bnQ6IDAsCiAgICAgICAgICAgIGFkal9saXN0OiBbWzA7IDEwMF07IDEwMF0sCiAgICAgICAgICAgIGFkal9jb3VudDogWzA7IDEwMF0sCiAgICAgICAgICAgIGRpc3Q6IFsyMTQ3NDgzNjQ3OyAxMDBdLCAvLyBJbml0aWFsaXplIHdpdGggTUFYX0lOVAogICAgICAgICAgICB2aXNpdGVkOiBbZmFsc2U7IDEwMF0sCiAgICAgICAgICAgIGZsb3lkX2Rpc3Q6IFtbMjE0NzQ4MzY0NzsgMTAwXTsgMTAwXSwKICAgICAgICAgICAgbG93OiBbMDsgMTAwXSwKICAgICAgICAgICAgZGlzYzogWzA7IDEwMF0sCiAgICAgICAgICAgIG9uX3N0YWNrOiBbZmFsc2U7IDEwMF0sCiAgICAgICAgICAgIHN0YWNrOiBbMDsgMTAwXSwKICAgICAgICAgICAgc3RhY2tfdG9wOiAwLAogICAgICAgICAgICB0aW1lOiAwLAogICAgICAgICAgICBzY2NfY291bnQ6IDAsCiAgICAgICAgICAgIHBhcmVudDogWzA7IDEwMF0sCiAgICAgICAgICAgIHJhbms6IFswOyAxMDBdLAogICAgICAgICAgICBtc3Rfd2VpZ2h0OiAwLAogICAgICAgIH07CgogICAgICAgIC8vIEluaXRpYWxpemUgRmxveWQtV2Fyc2hhbGwgZGlzdGFuY2UgbWF0cml4CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgdmVydGljZXMpIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IHZlcnRpY2VzKSB7CiAgICAgICAgICAgICAgICBpZiAoaSA9PSBqKSB7CiAgICAgICAgICAgICAgICAgICAgZ3JhcGguZmxveWRfZGlzdFtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9IDA7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGdyYXBoLmZsb3lkX2Rpc3RbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSAyMTQ3NDgzNjQ3OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaiArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBncmFwaDsKICAgIH0KCiAgICAvLyBBZGQgYW4gZWRnZSB0byB0aGUgZ3JhcGgKICAgIGZuIGFkZF9lZGdlKCZtdXQgc2VsZiwgZnJvbTogaTMyLCB0bzogaTMyLCB3ZWlnaHQ6IGkzMiwgY2FwYWNpdHk6IGkzMikgewogICAgICAgIGlmIChzZWxmLmVkZ2VfY291bnQgPj0gMjAwMCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBzZWxmLmVkZ2VzW3NlbGYuZWRnZV9jb3VudCBhcyB1c2l6ZV0gPSBFZGdlOjpuZXcoZnJvbSwgdG8sIHdlaWdodCwgY2FwYWNpdHkpOwoKICAgICAgICAvLyBBZGQgdG8gYWRqYWNlbmN5IGxpc3QKICAgICAgICBpZiAoc2VsZi5hZGpfY291bnRbZnJvbSBhcyB1c2l6ZV0gPCAxMDApIHsKICAgICAgICAgICAgc2VsZi5hZGpfbGlzdFtmcm9tIGFzIHVzaXplXVtzZWxmLmFkal9jb3VudFtmcm9tIGFzIHVzaXplXSBhcyB1c2l6ZV0gPSB0bzsKICAgICAgICAgICAgc2VsZi5hZGpfY291bnRbZnJvbSBhcyB1c2l6ZV0gKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIFVwZGF0ZSBGbG95ZC1XYXJzaGFsbCBtYXRyaXgKICAgICAgICBzZWxmLmZsb3lkX2Rpc3RbZnJvbSBhcyB1c2l6ZV1bdG8gYXMgdXNpemVdID0gd2VpZ2h0OwoKICAgICAgICBzZWxmLmVkZ2VfY291bnQgKz0gMTsKICAgIH0KCiAgICAvLyBEaWprc3RyYSdzIHNob3J0ZXN0IHBhdGggYWxnb3JpdGhtIGZyb20gYSBzb3VyY2UgdmVydGV4CiAgICBmbiBkaWprc3RyYSgmbXV0IHNlbGYsIHNvdXJjZTogaTMyKSB7CiAgICAgICAgLy8gSW5pdGlhbGl6ZSBkaXN0YW5jZXMgYW5kIHZpc2l0ZWQgYXJyYXkKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLnZlcnRpY2VzKSB7CiAgICAgICAgICAgIHNlbGYuZGlzdFtpIGFzIHVzaXplXSA9IDIxNDc0ODM2NDc7CiAgICAgICAgICAgIHNlbGYudmlzaXRlZFtpIGFzIHVzaXplXSA9IGZhbHNlOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBzZWxmLmRpc3Rbc291cmNlIGFzIHVzaXplXSA9IDA7CgogICAgICAgIC8vIE1haW4gRGlqa3N0cmEgbG9vcAogICAgICAgIGxldCBtdXQgcHJvY2Vzc2VkOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChwcm9jZXNzZWQgPCBzZWxmLnZlcnRpY2VzKSB7CiAgICAgICAgICAgIC8vIEZpbmQgbWluaW11bSBkaXN0YW5jZSB1bnZpc2l0ZWQgdmVydGV4CiAgICAgICAgICAgIGxldCBtdXQgbWluX2Rpc3Q6IGkzMiA9IDIxNDc0ODM2NDc7CiAgICAgICAgICAgIGxldCBtdXQgdTogaTMyID0gLTE7CiAgICAgICAgICAgIGxldCBtdXQgdjogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKHYgPCBzZWxmLnZlcnRpY2VzKSB7CiAgICAgICAgICAgICAgICBpZiAoIXNlbGYudmlzaXRlZFt2IGFzIHVzaXplXSAmJiBzZWxmLmRpc3RbdiBhcyB1c2l6ZV0gPCBtaW5fZGlzdCkgewogICAgICAgICAgICAgICAgICAgIG1pbl9kaXN0ID0gc2VsZi5kaXN0W3YgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIHUgPSB2OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdiArPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodSA9PSAtMSkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNlbGYudmlzaXRlZFt1IGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgICAgIHByb2Nlc3NlZCArPSAxOwoKICAgICAgICAgICAgLy8gVXBkYXRlIGRpc3RhbmNlcyB0byBhZGphY2VudCB2ZXJ0aWNlcwogICAgICAgICAgICBsZXQgbXV0IGVkZ2VfaWR4OiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoZWRnZV9pZHggPCBzZWxmLmVkZ2VfY291bnQpIHsKICAgICAgICAgICAgICAgIGxldCBlZGdlOiBFZGdlID0gc2VsZi5lZGdlc1tlZGdlX2lkeCBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBpZiAoZWRnZS5mcm9tID09IHUpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgbmV3X2Rpc3Q6IGkzMiA9IHNlbGYuZGlzdFt1IGFzIHVzaXplXSArIGVkZ2Uud2VpZ2h0OwogICAgICAgICAgICAgICAgICAgIGlmIChuZXdfZGlzdCA8IHNlbGYuZGlzdFtlZGdlLnRvIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRpc3RbZWRnZS50byBhcyB1c2l6ZV0gPSBuZXdfZGlzdDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlZGdlX2lkeCArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vIEZsb3lkLVdhcnNoYWxsIGFsbC1wYWlycyBzaG9ydGVzdCBwYXRocyBhbGdvcml0aG0KICAgIGZuIGZsb3lkX3dhcnNoYWxsKCZtdXQgc2VsZikgewogICAgICAgIC8vIE1haW4gRmxveWQtV2Fyc2hhbGwgdHJpcGxlIGxvb3AKICAgICAgICBsZXQgbXV0IGs6IHVzaXplID0gMDsKICAgICAgICB3aGlsZSAoayA8IHNlbGYudmVydGljZXMgYXMgdXNpemUpIHsKICAgICAgICAgICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICAgICAgICAgIHdoaWxlIChpIDwgc2VsZi52ZXJ0aWNlcyBhcyB1c2l6ZSkgewogICAgICAgICAgICAgICAgbGV0IG11dCBqOiB1c2l6ZSA9IDA7CiAgICAgICAgICAgICAgICB3aGlsZSAoaiA8IHNlbGYudmVydGljZXMgYXMgdXNpemUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5mbG95ZF9kaXN0W2ldW2tdICE9IDIxNDc0ODM2NDcgCiAgICAgICAgICAgICAgICAgICAgICAgICYmIHNlbGYuZmxveWRfZGlzdFtrXVtqXSAhPSAyMTQ3NDgzNjQ3KXsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZpYV9rOiBpMzIgPSBzZWxmLmZsb3lkX2Rpc3RbaV1ba10gKyBzZWxmLmZsb3lkX2Rpc3Rba11bal07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWFfayA8IHNlbGYuZmxveWRfZGlzdFtpXVtqXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5mbG95ZF9kaXN0W2ldW2pdID0gdmlhX2s7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaiArPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaSArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGsgKz0gMTsKICAgICAgICB9CiAgICB9CgogICAgLy8gVGFyamFuJ3MgYWxnb3JpdGhtIGZvciBmaW5kaW5nIHN0cm9uZ2x5IGNvbm5lY3RlZCBjb21wb25lbnRzCiAgICBmbiB0YXJqYW5fc2NjKCZtdXQgc2VsZiwgdTogaTMyKSB7CiAgICAgICAgLy8gSW5pdGlhbGl6ZSBkaXNjb3ZlcnkgdGltZSBhbmQgbG93IHZhbHVlCiAgICAgICAgc2VsZi5kaXNjW3UgYXMgdXNpemVdID0gc2VsZi50aW1lOwogICAgICAgIHNlbGYubG93W3UgYXMgdXNpemVdID0gc2VsZi50aW1lOwogICAgICAgIHNlbGYudGltZSArPSAxOwoKICAgICAgICAvLyBQdXNoIGN1cnJlbnQgdmVydGV4IHRvIHN0YWNrCiAgICAgICAgc2VsZi5zdGFja1tzZWxmLnN0YWNrX3RvcCBhcyB1c2l6ZV0gPSB1OwogICAgICAgIHNlbGYuc3RhY2tfdG9wICs9IDE7CiAgICAgICAgc2VsZi5vbl9zdGFja1t1IGFzIHVzaXplXSA9IHRydWU7CgogICAgICAgIC8vIEdvIHRocm91Z2ggYWxsIGFkamFjZW50IHZlcnRpY2VzCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi5hZGpfY291bnRbdSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgbGV0IHY6IGkzMiA9IHNlbGYuYWRqX2xpc3RbdSBhcyB1c2l6ZV1baSBhcyB1c2l6ZV07CgogICAgICAgICAgICBpZiAoc2VsZi5kaXNjW3YgYXMgdXNpemVdID09IC0xKSB7CiAgICAgICAgICAgICAgICAvLyBJZiB2IGlzIG5vdCB2aXNpdGVkLCByZWN1ciBmb3IgaXQKICAgICAgICAgICAgICAgIHNlbGYudGFyamFuX3NjYyh2KTsKCiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgc3VidHJlZSByb290ZWQgd2l0aCB2IGhhcyBhIGNvbm5lY3Rpb24gYmFjayB0byBhbmNlc3RvcnMgb2YgdQogICAgICAgICAgICAgICAgaWYgKHNlbGYubG93W3YgYXMgdXNpemVdIDwgc2VsZi5sb3dbdSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgICAgICBzZWxmLmxvd1t1IGFzIHVzaXplXSA9IHNlbGYubG93W3YgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYgKHNlbGYub25fc3RhY2tbdiBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBsb3cgdmFsdWUgb2YgdSBvbmx5IGlmIHYgaXMgc3RpbGwgaW4gc3RhY2sKICAgICAgICAgICAgICAgIGlmIChzZWxmLmRpc2NbdiBhcyB1c2l6ZV0gPCBzZWxmLmxvd1t1IGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgICAgIHNlbGYubG93W3UgYXMgdXNpemVdID0gc2VsZi5kaXNjW3YgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIElmIHUgaXMgYSByb290IG5vZGUsIHBvcCB0aGUgc3RhY2sgYW5kIHByb2Nlc3MgYW4gU0NDCiAgICAgICAgaWYgKHNlbGYubG93W3UgYXMgdXNpemVdID09IHNlbGYuZGlzY1t1IGFzIHVzaXplXSkgewogICAgICAgICAgICBzZWxmLnNjY19jb3VudCArPSAxOwoKICAgICAgICAgICAgLy8gUG9wIHZlcnRpY2VzIGZyb20gc3RhY2sgdW50aWwgdSBpcyBmb3VuZAogICAgICAgICAgICB3aGlsZSAoc2VsZi5zdGFja190b3AgPiAwKSB7CiAgICAgICAgICAgICAgICBzZWxmLnN0YWNrX3RvcCAtPSAxOwogICAgICAgICAgICAgICAgbGV0IHc6IGkzMiA9IHNlbGYuc3RhY2tbc2VsZi5zdGFja190b3AgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgc2VsZi5vbl9zdGFja1t3IGFzIHVzaXplXSA9IGZhbHNlOwoKICAgICAgICAgICAgICAgIGlmICh3ID09IHUpIHsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLyBGaW5kIGFsbCBzdHJvbmdseSBjb25uZWN0ZWQgY29tcG9uZW50cwogICAgZm4gZmluZF9hbGxfc2NjKCZtdXQgc2VsZikgewogICAgICAgIC8vIEluaXRpYWxpemUgYWxsIHZlcnRpY2VzIGFzIG5vdCB2aXNpdGVkCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi52ZXJ0aWNlcykgewogICAgICAgICAgICBzZWxmLmRpc2NbaSBhcyB1c2l6ZV0gPSAtMTsKICAgICAgICAgICAgc2VsZi5sb3dbaSBhcyB1c2l6ZV0gPSAtMTsKICAgICAgICAgICAgc2VsZi5vbl9zdGFja1tpIGFzIHVzaXplXSA9IGZhbHNlOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBzZWxmLnRpbWUgPSAwOwogICAgICAgIHNlbGYuc3RhY2tfdG9wID0gMDsKICAgICAgICBzZWxmLnNjY19jb3VudCA9IDA7CgogICAgICAgIC8vIENhbGwgdGhlIHJlY3Vyc2l2ZSBoZWxwZXIgZnVuY3Rpb24gZm9yIGFsbCB2ZXJ0aWNlcwogICAgICAgIGxldCBtdXQgdjogaTMyID0gMDsKICAgICAgICB3aGlsZSAodiA8IHNlbGYudmVydGljZXMpIHsKICAgICAgICAgICAgaWYgKHNlbGYuZGlzY1t2IGFzIHVzaXplXSA9PSAtMSkgewogICAgICAgICAgICAgICAgc2VsZi50YXJqYW5fc2NjKHYpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHYgKz0gMTsKICAgICAgICB9CiAgICB9CgogICAgLy8gVW5pb24tRmluZCBkYXRhIHN0cnVjdHVyZSBvcGVyYXRpb25zIGZvciBLcnVza2FsJ3MgYWxnb3JpdGhtCiAgICBmbiBmaW5kX3BhcmVudCgmbXV0IHNlbGYsIHg6IGkzMikgLT4gaTMyIHsKICAgICAgICBpZiAoc2VsZi5wYXJlbnRbeCBhcyB1c2l6ZV0gIT0geCkgewogICAgICAgICAgICBzZWxmLnBhcmVudFt4IGFzIHVzaXplXSA9IHNlbGYuZmluZF9wYXJlbnQoc2VsZi5wYXJlbnRbeCBhcyB1c2l6ZV0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc2VsZi5wYXJlbnRbeCBhcyB1c2l6ZV07CiAgICB9CgogICAgZm4gdW5pb25fc2V0cygmbXV0IHNlbGYsIHg6IGkzMiwgeTogaTMyKSB7CiAgICAgICAgbGV0IHJvb3RfeDogaTMyID0gc2VsZi5maW5kX3BhcmVudCh4KTsKICAgICAgICBsZXQgcm9vdF95OiBpMzIgPSBzZWxmLmZpbmRfcGFyZW50KHkpOwoKICAgICAgICBpZiAocm9vdF94ICE9IHJvb3RfeSkgewogICAgICAgICAgICBpZiAoc2VsZi5yYW5rW3Jvb3RfeCBhcyB1c2l6ZV0gPCBzZWxmLnJhbmtbcm9vdF95IGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgc2VsZi5wYXJlbnRbcm9vdF94IGFzIHVzaXplXSA9IHJvb3RfeTsKICAgICAgICAgICAgfSBlbHNlIGlmIChzZWxmLnJhbmtbcm9vdF94IGFzIHVzaXplXSA+IHNlbGYucmFua1tyb290X3kgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBzZWxmLnBhcmVudFtyb290X3kgYXMgdXNpemVdID0gcm9vdF94OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc2VsZi5wYXJlbnRbcm9vdF95IGFzIHVzaXplXSA9IHJvb3RfeDsKICAgICAgICAgICAgICAgIHNlbGYucmFua1tyb290X3ggYXMgdXNpemVdICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8gS3J1c2thbCdzIGFsZ29yaXRobSBmb3IgTWluaW11bSBTcGFubmluZyBUcmVlCiAgICBmbiBrcnVza2FsX21zdCgmbXV0IHNlbGYpIHsKICAgICAgICAvLyBJbml0aWFsaXplIFVuaW9uLUZpbmQgc3RydWN0dXJlCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi52ZXJ0aWNlcykgewogICAgICAgICAgICBzZWxmLnBhcmVudFtpIGFzIHVzaXplXSA9IGk7CiAgICAgICAgICAgIHNlbGYucmFua1tpIGFzIHVzaXplXSA9IDA7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIFNvcnQgZWRnZXMgYnkgd2VpZ2h0IHVzaW5nIGJ1YmJsZSBzb3J0CiAgICAgICAgbGV0IG11dCBzb3J0ZWQ6IGJvb2wgPSBmYWxzZTsKICAgICAgICB3aGlsZSAoIXNvcnRlZCkgewogICAgICAgICAgICBzb3J0ZWQgPSB0cnVlOwogICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChqIDwgc2VsZi5lZGdlX2NvdW50IC0gMSkgewogICAgICAgICAgICAgICAgaWYgKHNlbGYuZWRnZXNbaiBhcyB1c2l6ZV0ud2VpZ2h0ID4gc2VsZi5lZGdlc1soaiArIDEpIGFzIHVzaXplXS53ZWlnaHQpIHsKICAgICAgICAgICAgICAgICAgICAvLyBTd2FwIGVkZ2VzCiAgICAgICAgICAgICAgICAgICAgbGV0IHRlbXA6IEVkZ2UgPSBzZWxmLmVkZ2VzW2ogYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIHNlbGYuZWRnZXNbaiBhcyB1c2l6ZV0gPSBzZWxmLmVkZ2VzWyhqICsgMSkgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIHNlbGYuZWRnZXNbKGogKyAxKSBhcyB1c2l6ZV0gPSB0ZW1wOwogICAgICAgICAgICAgICAgICAgIHNvcnRlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaiArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzZWxmLm1zdF93ZWlnaHQgPSAwOwogICAgICAgIGxldCBtdXQgZWRnZXNfYWRkZWQ6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBlZGdlX2lkeDogaTMyID0gMDsKCiAgICAgICAgLy8gUHJvY2VzcyBlZGdlcyBpbiBzb3J0ZWQgb3JkZXIKICAgICAgICB3aGlsZSAoZWRnZV9pZHggPCBzZWxmLmVkZ2VfY291bnQgJiYgZWRnZXNfYWRkZWQgPCBzZWxmLnZlcnRpY2VzIC0gMSkgewogICAgICAgICAgICBsZXQgZWRnZTogRWRnZSA9IHNlbGYuZWRnZXNbZWRnZV9pZHggYXMgdXNpemVdOwogICAgICAgICAgICBsZXQgcm9vdF9mcm9tOiBpMzIgPSBzZWxmLmZpbmRfcGFyZW50KGVkZ2UuZnJvbSk7CiAgICAgICAgICAgIGxldCByb290X3RvOiBpMzIgPSBzZWxmLmZpbmRfcGFyZW50KGVkZ2UudG8pOwoKICAgICAgICAgICAgLy8gSWYgaW5jbHVkaW5nIHRoaXMgZWRnZSBkb2Vzbid0IGNhdXNlIGN5Y2xlCiAgICAgICAgICAgIGlmIChyb290X2Zyb20gIT0gcm9vdF90bykgewogICAgICAgICAgICAgICAgc2VsZi51bmlvbl9zZXRzKGVkZ2UuZnJvbSwgZWRnZS50byk7CiAgICAgICAgICAgICAgICBzZWxmLm1zdF93ZWlnaHQgKz0gZWRnZS53ZWlnaHQ7CiAgICAgICAgICAgICAgICBlZGdlc19hZGRlZCArPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBlZGdlX2lkeCArPSAxOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBOZXR3b3JrIGZsb3cgYW5hbHlzaXMgdXNpbmcgRm9yZC1GdWxrZXJzb24gbWV0aG9kIHdpdGggREZTCiAgICBmbiBkZnNfZmxvdygKICAgICAgICAmbXV0IHNlbGYsCiAgICAgICAgc291cmNlOiBpMzIsCiAgICAgICAgc2luazogaTMyLAogICAgICAgIGN1cnJlbnQ6IGkzMiwKICAgICAgICBtaW5fZmxvdzogaTMyLAogICAgICAgIHZpc2l0ZWQ6ICZtdXQgW2Jvb2w7IDEwMF0sCiAgICApIC0+IGkzMiB7CiAgICAgICAgaWYgKGN1cnJlbnQgPT0gc2luaykgewogICAgICAgICAgICByZXR1cm4gbWluX2Zsb3c7CiAgICAgICAgfQoKICAgICAgICB2aXNpdGVkW2N1cnJlbnQgYXMgdXNpemVdID0gdHJ1ZTsKCiAgICAgICAgLy8gVHJ5IGFsbCBvdXRnb2luZyBlZGdlcwogICAgICAgIGxldCBtdXQgZWRnZV9pZHg6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGVkZ2VfaWR4IDwgc2VsZi5lZGdlX2NvdW50KSB7CiAgICAgICAgICAgIGxldCBlZGdlOiBFZGdlID0gc2VsZi5lZGdlc1tlZGdlX2lkeCBhcyB1c2l6ZV07CiAgICAgICAgICAgIGlmIChlZGdlLmZyb20gPT0gY3VycmVudCAmJiAhdmlzaXRlZFtlZGdlLnRvIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgbGV0IHJlc2lkdWFsX2NhcGFjaXR5OiBpMzIgPSBlZGdlLmNhcGFjaXR5IC0gZWRnZS5mbG93OwogICAgICAgICAgICAgICAgaWYgKHJlc2lkdWFsX2NhcGFjaXR5ID4gMCkgewogICAgICAgICAgICAgICAgICAgIGxldCBib3R0bGVuZWNrOiBpMzIgPSBpZiAobWluX2Zsb3cgPCByZXNpZHVhbF9jYXBhY2l0eSkgewogICAgICAgICAgICAgICAgICAgICAgICBtaW5fZmxvdwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2lkdWFsX2NhcGFjaXR5CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBsZXQgZmxvd19zZW50OiBpMzIgPSBzZWxmLmRmc19mbG93KHNvdXJjZSwgc2luaywgZWRnZS50bywgYm90dGxlbmVjaywgdmlzaXRlZCk7CgogICAgICAgICAgICAgICAgICAgIGlmIChmbG93X3NlbnQgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBmb3J3YXJkIGFuZCBiYWNrd2FyZCBmbG93cwogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmVkZ2VzW2VkZ2VfaWR4IGFzIHVzaXplXS5mbG93ICs9IGZsb3dfc2VudDsKCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcmV2ZXJzZSBlZGdlIGFuZCB1cGRhdGUgaXRzIGZsb3cKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG11dCByZXZfaWR4OiBpMzIgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAocmV2X2lkeCA8IHNlbGYuZWRnZV9jb3VudCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJldl9lZGdlOiBFZGdlID0gc2VsZi5lZGdlc1tyZXZfaWR4IGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXZfZWRnZS5mcm9tID09IGVkZ2UudG8gJiYgcmV2X2VkZ2UudG8gPT0gZWRnZS5mcm9tKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5lZGdlc1tyZXZfaWR4IGFzIHVzaXplXS5mbG93IC09IGZsb3dfc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldl9pZHggKz0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZsb3dfc2VudDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWRnZV9pZHggKz0gMTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIGZuIG1heF9mbG93KCZtdXQgc2VsZiwgc291cmNlOiBpMzIsIHNpbms6IGkzMikgLT4gaTMyIHsKICAgICAgICBsZXQgbXV0IHRvdGFsX2Zsb3c6IGkzMiA9IDA7CgogICAgICAgIC8vIFJlc2V0IGFsbCBmbG93cwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuZWRnZV9jb3VudCkgewogICAgICAgICAgICBzZWxmLmVkZ2VzW2kgYXMgdXNpemVdLmZsb3cgPSAwOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBDb250aW51ZSB1bnRpbCBubyBhdWdtZW50aW5nIHBhdGggY2FuIGJlIGZvdW5kCiAgICAgICAgbGV0IG11dCBpdGVyYXRpb25zOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpdGVyYXRpb25zIDwgMTAwMCkgewogICAgICAgICAgICAvLyBQcmV2ZW50IGluZmluaXRlIGxvb3BzCiAgICAgICAgICAgIGxldCBtdXQgdmlzaXRlZDogW2Jvb2w7IDEwMF0gPSBbZmFsc2U7IDEwMF07CiAgICAgICAgICAgIGxldCBmbG93X3NlbnQ6IGkzMiA9IHNlbGYuZGZzX2Zsb3coc291cmNlLCBzaW5rLCBzb3VyY2UsIDUwMCwgJm11dCB2aXNpdGVkKTsKCiAgICAgICAgICAgIGlmIChmbG93X3NlbnQgPT0gMCkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRvdGFsX2Zsb3cgKz0gZmxvd19zZW50OwogICAgICAgICAgICBpdGVyYXRpb25zICs9IDE7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdG90YWxfZmxvdzsKICAgIH0KCiAgICAvLyBDb21wcmVoZW5zaXZlIGdyYXBoIGFuYWx5c2lzIGZ1bmN0aW9uCiAgICBmbiBhbmFseXplX2dyYXBoKCZtdXQgc2VsZiwgc291cmNlOiBpMzIsIHNpbms6IGkzMikgewogICAgICAgIC8vIFJ1biBEaWprc3RyYSdzIHNob3J0ZXN0IHBhdGgKICAgICAgICBzZWxmLmRpamtzdHJhKHNvdXJjZSk7CiAgICAgICAgcHJpbnRsbkludChzZWxmLmRpc3Rbc2luayBhcyB1c2l6ZV0pOwoKICAgICAgICAvLyBSdW4gRmxveWQtV2Fyc2hhbGwgYWxsLXBhaXJzIHNob3J0ZXN0IHBhdGhzCiAgICAgICAgc2VsZi5mbG95ZF93YXJzaGFsbCgpOwogICAgICAgIHByaW50bG5JbnQoc2VsZi5mbG95ZF9kaXN0W3NvdXJjZSBhcyB1c2l6ZV1bc2luayBhcyB1c2l6ZV0pOwoKICAgICAgICAvLyBGaW5kIHN0cm9uZ2x5IGNvbm5lY3RlZCBjb21wb25lbnRzCiAgICAgICAgc2VsZi5maW5kX2FsbF9zY2MoKTsKICAgICAgICBwcmludGxuSW50KHNlbGYuc2NjX2NvdW50KTsKCiAgICAgICAgLy8gRmluZCBtaW5pbXVtIHNwYW5uaW5nIHRyZWUKICAgICAgICBzZWxmLmtydXNrYWxfbXN0KCk7CiAgICAgICAgcHJpbnRsbkludChzZWxmLm1zdF93ZWlnaHQpOwoKICAgICAgICAvLyBDYWxjdWxhdGUgbWF4aW11bSBmbG93CiAgICAgICAgbGV0IG1heF9mbG93X3ZhbHVlOiBpMzIgPSBzZWxmLm1heF9mbG93KHNvdXJjZSwgc2luayk7CiAgICAgICAgcHJpbnRsbkludChtYXhfZmxvd192YWx1ZSk7CiAgICB9Cn0KCi8vIENvbXBsZXggZ3JhcGggZ2VuZXJhdG9yIGZvciB0ZXN0aW5nCnN0cnVjdCBHcmFwaEdlbmVyYXRvciB7CiAgICBzZWVkOiBpMzIsCn0KCmltcGwgR3JhcGhHZW5lcmF0b3IgewogICAgZm4gbmV3KHNlZWQ6IGkzMikgLT4gR3JhcGhHZW5lcmF0b3IgewogICAgICAgIEdyYXBoR2VuZXJhdG9yIHsgc2VlZDogc2VlZCB9CiAgICB9CgogICAgLy8gTGluZWFyIGNvbmdydWVudGlhbCBnZW5lcmF0b3IgZm9yIHBzZXVkby1yYW5kb20gbnVtYmVycwogICAgZm4gbmV4dF9yYW5kb20oJm11dCBzZWxmKSAtPiBpMzIgewogICAgICAgIHNlbGYuc2VlZCA9IHBtX3JhbmRfdXBkYXRlKHNlbGYuc2VlZCk7CiAgICAgICAgaWYgKHNlbGYuc2VlZCA8IDApIHsKICAgICAgICAgICAgc2VsZi5zZWVkID0gLXNlbGYuc2VlZDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNlbGYuc2VlZDsKICAgIH0KCiAgICAvLyBHZW5lcmF0ZSBhIGNvbXBsZXggZ3JhcGggd2l0aCBzcGVjaWZpYyBwcm9wZXJ0aWVzCiAgICBmbiBnZW5lcmF0ZV9jb21wbGV4X2dyYXBoKCZtdXQgc2VsZiwgZ3JhcGg6ICZtdXQgR3JhcGgsIGRlbnNpdHk6IGkzMikgewogICAgICAgIGxldCB2ZXJ0aWNlczogaTMyID0gZ3JhcGgudmVydGljZXM7CgogICAgICAgIC8vIEdlbmVyYXRlIHJhbmRvbSBlZGdlcyB3aXRoIHZhcnlpbmcgd2VpZ2h0cyBhbmQgY2FwYWNpdGllcwogICAgICAgIGxldCB0YXJnZXRfZWRnZXM6IGkzMiA9ICh2ZXJ0aWNlcyAqIHZlcnRpY2VzICogZGVuc2l0eSkgLyAxMDA7CiAgICAgICAgbGV0IG11dCBlZGdlc19hZGRlZDogaTMyID0gMDsKCiAgICAgICAgd2hpbGUgKGVkZ2VzX2FkZGVkIDwgdGFyZ2V0X2VkZ2VzICYmIGVkZ2VzX2FkZGVkIDwgMTgwMCkgewogICAgICAgICAgICBsZXQgZnJvbTogaTMyID0gc2VsZi5uZXh0X3JhbmRvbSgpICUgdmVydGljZXM7CiAgICAgICAgICAgIGxldCB0bzogaTMyID0gc2VsZi5uZXh0X3JhbmRvbSgpICUgdmVydGljZXM7CgogICAgICAgICAgICBpZiAoZnJvbSAhPSB0bykgewogICAgICAgICAgICAgICAgbGV0IHdlaWdodDogaTMyID0gKHNlbGYubmV4dF9yYW5kb20oKSAlIDEwMCkgKyAxOwogICAgICAgICAgICAgICAgbGV0IGNhcGFjaXR5OiBpMzIgPSAoc2VsZi5uZXh0X3JhbmRvbSgpICUgNTApICsgMTsKCiAgICAgICAgICAgICAgICBncmFwaC5hZGRfZWRnZShmcm9tLCB0bywgd2VpZ2h0LCBjYXBhY2l0eSk7CiAgICAgICAgICAgICAgICBlZGdlc19hZGRlZCArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBBZGQgc29tZSBndWFyYW50ZWVkIHBhdGhzIHRvIGVuc3VyZSBjb25uZWN0aXZpdHkKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCB2ZXJ0aWNlcyAtIDEpIHsKICAgICAgICAgICAgbGV0IHdlaWdodDogaTMyID0gKHNlbGYubmV4dF9yYW5kb20oKSAlIDIwKSArIDE7CiAgICAgICAgICAgIGxldCBjYXBhY2l0eTogaTMyID0gKHNlbGYubmV4dF9yYW5kb20oKSAlIDMwKSArIDE7CiAgICAgICAgICAgIGdyYXBoLmFkZF9lZGdlKGksIGkgKyAxLCB3ZWlnaHQsIGNhcGFjaXR5KTsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgIH0KfQoKZm4gbWFpbigpIHsKICAgIC8vIFJlYWQgaW5wdXQgcGFyYW1ldGVycwogICAgbGV0IHZlcnRpY2VzOiBpMzIgPSBnZXRJbnQoKTsKICAgIGxldCBkZW5zaXR5OiBpMzIgPSBnZXRJbnQoKTsKICAgIGxldCBzb3VyY2U6IGkzMiA9IGdldEludCgpOwogICAgbGV0IHNpbms6IGkzMiA9IGdldEludCgpOwogICAgbGV0IHNlZWQ6IGkzMiA9IGdldEludCgpOwoKICAgIC8vIENyZWF0ZSBhbmQgaW5pdGlhbGl6ZSBncmFwaAogICAgbGV0IG11dCBncmFwaDogR3JhcGggPSBHcmFwaDo6bmV3KHZlcnRpY2VzKTsKICAgIGxldCBtdXQgZ2VuZXJhdG9yOiBHcmFwaEdlbmVyYXRvciA9IEdyYXBoR2VuZXJhdG9yOjpuZXcoc2VlZCk7CgogICAgLy8gR2VuZXJhdGUgY29tcGxleCBncmFwaCBzdHJ1Y3R1cmUKICAgIGdlbmVyYXRvci5nZW5lcmF0ZV9jb21wbGV4X2dyYXBoKCZtdXQgZ3JhcGgsIGRlbnNpdHkpOwoKICAgIC8vIFBlcmZvcm0gY29tcHJlaGVuc2l2ZSBncmFwaCBhbmFseXNpcwogICAgZ3JhcGguYW5hbHl6ZV9ncmFwaChzb3VyY2UsIHNpbmspOwoKICAgIC8vIEFkZGl0aW9uYWwgY29tcGxleCBvcGVyYXRpb25zIGZvciBzdHJlc3MgdGVzdGluZwoKICAgIC8vIFRlc3QgbXVsdGlwbGUgc2hvcnRlc3QgcGF0aCBxdWVyaWVzCiAgICBsZXQgbXV0IHF1ZXJ5X2NvdW50OiBpMzIgPSAwOwogICAgd2hpbGUgKHF1ZXJ5X2NvdW50IDwgMTApIHsKICAgICAgICBsZXQgc3RhcnQ6IGkzMiA9IChnZW5lcmF0b3IubmV4dF9yYW5kb20oKSAlIHZlcnRpY2VzKTsKICAgICAgICBsZXQgZW5kOiBpMzIgPSAoZ2VuZXJhdG9yLm5leHRfcmFuZG9tKCkgJSB2ZXJ0aWNlcyk7CgogICAgICAgIGlmIChzdGFydCAhPSBlbmQpIHsKICAgICAgICAgICAgZ3JhcGguZGlqa3N0cmEoc3RhcnQpOwogICAgICAgICAgICBwcmludGxuSW50KGdyYXBoLmRpc3RbZW5kIGFzIHVzaXplXSk7CiAgICAgICAgfQoKICAgICAgICBxdWVyeV9jb3VudCArPSAxOwogICAgfQoKICAgIC8vIEFuYWx5emUgZ3JhcGggY29ubmVjdGl2aXR5IGFuZCBzdHJ1Y3R1cmUKICAgIGxldCBtdXQgY29tcG9uZW50X2FuYWx5c2lzOiBpMzIgPSAwOwogICAgbGV0IG11dCByb3VuZDogaTMyID0gMDsKICAgIHdoaWxlIChyb3VuZCA8IDUpIHsKICAgICAgICBncmFwaC5maW5kX2FsbF9zY2MoKTsKICAgICAgICBjb21wb25lbnRfYW5hbHlzaXMgKz0gZ3JhcGguc2NjX2NvdW50OwogICAgICAgIHJvdW5kICs9IDE7CiAgICB9CiAgICBwcmludGxuSW50KGNvbXBvbmVudF9hbmFseXNpcyk7CgogICAgLy8gTXVsdGlwbGUgTVNUIGNhbGN1bGF0aW9ucyB3aXRoIGVkZ2UgbW9kaWZpY2F0aW9ucwogICAgbGV0IG11dCB0b3RhbF9tc3Rfd2VpZ2h0OiBpMzIgPSAwOwogICAgbGV0IG11dCBtc3Rfcm91bmQ6IGkzMiA9IDA7CiAgICB3aGlsZSAobXN0X3JvdW5kIDwgMykgewogICAgICAgIGdyYXBoLmtydXNrYWxfbXN0KCk7CiAgICAgICAgdG90YWxfbXN0X3dlaWdodCArPSBncmFwaC5tc3Rfd2VpZ2h0OwoKICAgICAgICAvLyBNb2RpZnkgc29tZSBlZGdlIHdlaWdodHMgZm9yIG5leHQgaXRlcmF0aW9uCiAgICAgICAgbGV0IG11dCBtb2RfY291bnQ6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKG1vZF9jb3VudCA8IDEwICYmIG1vZF9jb3VudCA8IGdyYXBoLmVkZ2VfY291bnQpIHsKICAgICAgICAgICAgbGV0IG5ld193ZWlnaHQ6IGkzMiA9IChnZW5lcmF0b3IubmV4dF9yYW5kb20oKSAlIDUwKSArIDE7CiAgICAgICAgICAgIGdyYXBoLmVkZ2VzW21vZF9jb3VudCBhcyB1c2l6ZV0ud2VpZ2h0ID0gbmV3X3dlaWdodDsKICAgICAgICAgICAgbW9kX2NvdW50ICs9IDE7CiAgICAgICAgfQoKICAgICAgICBtc3Rfcm91bmQgKz0gMTsKICAgIH0KICAgIHByaW50bG5JbnQodG90YWxfbXN0X3dlaWdodCk7CgogICAgLy8gRmluYWwgY29tcHJlaGVuc2l2ZSBtZXRyaWMKICAgIGxldCBmaW5hbF9tZXRyaWM6IGkzMiA9IChjb21wb25lbnRfYW5hbHlzaXMgKiB0b3RhbF9tc3Rfd2VpZ2h0KSAvICh2ZXJ0aWNlcyArIDEpOwogICAgcHJpbnRsbkludChmaW5hbF9tZXRyaWMpOwogICAgZXhpdCgwKTsKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (10, "comprehensive10", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCA5OiBBZHZhbmNlZCBHcmFwaCBBbGdvcml0aG1zIGFuZCBOZXR3b3JrIEFuYWx5c2lzClN1bW1hcnk6IFRoaXMgdGVzdCBpbXBsZW1lbnRzIGEgY29tcGxleCBncmFwaCBwcm9jZXNzaW5nIHN5c3RlbSB3aXRoIG11bHRpcGxlIGFsZ29yaXRobXM6CkRldGFpbHM6CjEuIERpamtzdHJhJ3Mgc2hvcnRlc3QgcGF0aCBhbGdvcml0aG0KMi4gRmxveWQtV2Fyc2hhbGwgYWxsLXBhaXJzIHNob3J0ZXN0IHBhdGhzCjMuIE5ldHdvcmsgZmxvdyBhbmFseXNpcyB1c2luZyBGb3JkLUZ1bGtlcnNvbgo0LiBTdHJvbmdseSBjb25uZWN0ZWQgY29tcG9uZW50cyB1c2luZyBUYXJqYW4ncyBhbGdvcml0aG0KNS4gTWluaW11bSBzcGFubmluZyB0cmVlIHVzaW5nIEtydXNrYWwncyBhbGdvcml0aG0KKi8KCi8vIFVuaWZpZWQgUk5HOiBQYXJr4oCTTWlsbGVyIChhPTE2ODA3LCBtPTIxNDc0ODM2NDcpIHVzaW5nIFNjaHJhZ2UgbWV0aG9kIHRvIGF2b2lkIG92ZXJmbG93CmZuIHBtX3JhbmRfdXBkYXRlKHg6IGkzMikgLT4gaTMyIHsKICAgIGxldCBhOiBpMzIgPSAxNjgwNzsKICAgIGxldCBtOiBpMzIgPSAyMTQ3NDgzNjQ3OwogICAgbGV0IHE6IGkzMiA9IDEyNzc3MzsgLy8gbSAvIGEKICAgIGxldCByOiBpMzIgPSAyODM2OyAvLyBtICUgYQogICAgbGV0IG11dCBrOiBpMzIgPSB4IC8gcTsKICAgIGxldCBtdXQgbmV3X3g6IGkzMiA9IGEgKiAoeCAtIGsgKiBxKSAtIHIgKiBrOwogICAgaWYgKG5ld194IDw9IDApIHsKICAgICAgICBuZXdfeCArPSBtOwogICAgfQogICAgcmV0dXJuIG5ld194Owp9CgovLyBDb21wcmVoZW5zaXZlIFRlc3QgOTogQWR2YW5jZWQgR3JhcGggQWxnb3JpdGhtcyBhbmQgTmV0d29yayBBbmFseXNpcwovLyBUaGlzIHRlc3QgaW1wbGVtZW50cyBhIGNvbXBsZXggZ3JhcGggcHJvY2Vzc2luZyBzeXN0ZW0gd2l0aCBtdWx0aXBsZSBhbGdvcml0aG1zOgovLyAxLiBEaWprc3RyYSdzIHNob3J0ZXN0IHBhdGggYWxnb3JpdGhtCi8vIDIuIEZsb3lkLVdhcnNoYWxsIGFsbC1wYWlycyBzaG9ydGVzdCBwYXRocwovLyAzLiBOZXR3b3JrIGZsb3cgYW5hbHlzaXMgdXNpbmcgRm9yZC1GdWxrZXJzb24KLy8gNC4gU3Ryb25nbHkgY29ubmVjdGVkIGNvbXBvbmVudHMgdXNpbmcgVGFyamFuJ3MgYWxnb3JpdGhtCi8vIDUuIE1pbmltdW0gc3Bhbm5pbmcgdHJlZSB1c2luZyBLcnVza2FsJ3MgYWxnb3JpdGhtCgovLyBFZGdlIHN0cnVjdHVyZSBmb3IgZ3JhcGggcmVwcmVzZW50YXRpb24KCnN0cnVjdCBFZGdlIHsKICAgIGZyb206IGkzMiwKICAgIHRvOiBpMzIsCiAgICB3ZWlnaHQ6IGkzMiwKICAgIGNhcGFjaXR5OiBpMzIsCiAgICBmbG93OiBpMzIsCn0KCi8vIEdyYXBoIHN0cnVjdHVyZSB3aXRoIGFkamFjZW5jeSBsaXN0IHJlcHJlc2VudGF0aW9uCnN0cnVjdCBHcmFwaCB7CiAgICB2ZXJ0aWNlczogaTMyLAogICAgZWRnZXM6IFtFZGdlOyAyMDAwXSwKICAgIGVkZ2VfY291bnQ6IGkzMiwKICAgIGFkal9saXN0OiBbW2kzMjsgMTAwXTsgMTAwXSwgLy8gYWRqYWNlbmN5IGxpc3QgYXMgMkQgYXJyYXkKICAgIGFkal9jb3VudDogW2kzMjsgMTAwXSwKCiAgICAvLyBGb3IgRGlqa3N0cmEncyBhbGdvcml0aG0KICAgIGRpc3Q6IFtpMzI7IDEwMF0sCiAgICB2aXNpdGVkOiBbYm9vbDsgMTAwXSwKCiAgICAvLyBGb3IgRmxveWQtV2Fyc2hhbGwgYWxnb3JpdGhtCiAgICBmbG95ZF9kaXN0OiBbW2kzMjsgMTAwXTsgMTAwXSwKCiAgICAvLyBGb3IgVGFyamFuJ3MgU0NDIGFsZ29yaXRobQogICAgbG93OiBbaTMyOyAxMDBdLAogICAgZGlzYzogW2kzMjsgMTAwXSwKICAgIG9uX3N0YWNrOiBbYm9vbDsgMTAwXSwKICAgIHN0YWNrOiBbaTMyOyAxMDBdLAogICAgc3RhY2tfdG9wOiBpMzIsCiAgICB0aW1lOiBpMzIsCiAgICBzY2NfY291bnQ6IGkzMiwKCiAgICAvLyBGb3IgS3J1c2thbCdzIE1TVCBhbGdvcml0aG0KICAgIHBhcmVudDogW2kzMjsgMTAwXSwKICAgIHJhbms6IFtpMzI7IDEwMF0sCiAgICBtc3Rfd2VpZ2h0OiBpMzIsCn0KCmltcGwgRWRnZSB7CiAgICBmbiBuZXcoZnJvbTogaTMyLCB0bzogaTMyLCB3ZWlnaHQ6IGkzMiwgY2FwYWNpdHk6IGkzMikgLT4gRWRnZSB7CiAgICAgICAgRWRnZSB7CiAgICAgICAgICAgIGZyb206IGZyb20sCiAgICAgICAgICAgIHRvOiB0bywKICAgICAgICAgICAgd2VpZ2h0OiB3ZWlnaHQsCiAgICAgICAgICAgIGNhcGFjaXR5OiBjYXBhY2l0eSwKICAgICAgICAgICAgZmxvdzogMCwKICAgICAgICB9CiAgICB9Cn0KCmltcGwgR3JhcGggewogICAgZm4gbmV3KHZlcnRpY2VzOiBpMzIpIC0+IEdyYXBoIHsKICAgICAgICBsZXQgbXV0IGdyYXBoOiBHcmFwaCA9IEdyYXBoIHsKICAgICAgICAgICAgdmVydGljZXM6IHZlcnRpY2VzLAogICAgICAgICAgICBlZGdlczogW0VkZ2U6Om5ldygwLCAwLCAwLCAwKTsgMjAwMF0sCiAgICAgICAgICAgIGVkZ2VfY291bnQ6IDAsCiAgICAgICAgICAgIGFkal9saXN0OiBbWzA7IDEwMF07IDEwMF0sCiAgICAgICAgICAgIGFkal9jb3VudDogWzA7IDEwMF0sCiAgICAgICAgICAgIGRpc3Q6IFsyMTQ3NDgzNjQ3OyAxMDBdLCAvLyBJbml0aWFsaXplIHdpdGggTUFYX0lOVAogICAgICAgICAgICB2aXNpdGVkOiBbZmFsc2U7IDEwMF0sCiAgICAgICAgICAgIGZsb3lkX2Rpc3Q6IFtbMjE0NzQ4MzY0NzsgMTAwXTsgMTAwXSwKICAgICAgICAgICAgbG93OiBbMDsgMTAwXSwKICAgICAgICAgICAgZGlzYzogWzA7IDEwMF0sCiAgICAgICAgICAgIG9uX3N0YWNrOiBbZmFsc2U7IDEwMF0sCiAgICAgICAgICAgIHN0YWNrOiBbMDsgMTAwXSwKICAgICAgICAgICAgc3RhY2tfdG9wOiAwLAogICAgICAgICAgICB0aW1lOiAwLAogICAgICAgICAgICBzY2NfY291bnQ6IDAsCiAgICAgICAgICAgIHBhcmVudDogWzA7IDEwMF0sCiAgICAgICAgICAgIHJhbms6IFswOyAxMDBdLAogICAgICAgICAgICBtc3Rfd2VpZ2h0OiAwLAogICAgICAgIH07CgogICAgICAgIC8vIEluaXRpYWxpemUgRmxveWQtV2Fyc2hhbGwgZGlzdGFuY2UgbWF0cml4CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgdmVydGljZXMpIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IHZlcnRpY2VzKSB7CiAgICAgICAgICAgICAgICBpZiAoaSA9PSBqKSB7CiAgICAgICAgICAgICAgICAgICAgZ3JhcGguZmxveWRfZGlzdFtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9IDA7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGdyYXBoLmZsb3lkX2Rpc3RbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSAyMTQ3NDgzNjQ3OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaiArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBncmFwaDsKICAgIH0KCiAgICAvLyBBZGQgYW4gZWRnZSB0byB0aGUgZ3JhcGgKICAgIGZuIGFkZF9lZGdlKCZtdXQgc2VsZiwgZnJvbTogaTMyLCB0bzogaTMyLCB3ZWlnaHQ6IGkzMiwgY2FwYWNpdHk6IGkzMikgewogICAgICAgIGlmIChzZWxmLmVkZ2VfY291bnQgPj0gMjAwMCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBzZWxmLmVkZ2VzW3NlbGYuZWRnZV9jb3VudCBhcyB1c2l6ZV0gPSBFZGdlOjpuZXcoZnJvbSwgdG8sIHdlaWdodCwgY2FwYWNpdHkpOwoKICAgICAgICAvLyBBZGQgdG8gYWRqYWNlbmN5IGxpc3QKICAgICAgICBpZiAoc2VsZi5hZGpfY291bnRbZnJvbSBhcyB1c2l6ZV0gPCAxMDApIHsKICAgICAgICAgICAgc2VsZi5hZGpfbGlzdFtmcm9tIGFzIHVzaXplXVtzZWxmLmFkal9jb3VudFtmcm9tIGFzIHVzaXplXSBhcyB1c2l6ZV0gPSB0bzsKICAgICAgICAgICAgc2VsZi5hZGpfY291bnRbZnJvbSBhcyB1c2l6ZV0gKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIFVwZGF0ZSBGbG95ZC1XYXJzaGFsbCBtYXRyaXgKICAgICAgICBzZWxmLmZsb3lkX2Rpc3RbZnJvbSBhcyB1c2l6ZV1bdG8gYXMgdXNpemVdID0gd2VpZ2h0OwoKICAgICAgICBzZWxmLmVkZ2VfY291bnQgKz0gMTsKICAgIH0KCiAgICAvLyBEaWprc3RyYSdzIHNob3J0ZXN0IHBhdGggYWxnb3JpdGhtIGZyb20gYSBzb3VyY2UgdmVydGV4CiAgICBmbiBkaWprc3RyYSgmbXV0IHNlbGYsIHNvdXJjZTogaTMyKSB7CiAgICAgICAgLy8gSW5pdGlhbGl6ZSBkaXN0YW5jZXMgYW5kIHZpc2l0ZWQgYXJyYXkKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLnZlcnRpY2VzKSB7CiAgICAgICAgICAgIHNlbGYuZGlzdFtpIGFzIHVzaXplXSA9IDIxNDc0ODM2NDc7CiAgICAgICAgICAgIHNlbGYudmlzaXRlZFtpIGFzIHVzaXplXSA9IGZhbHNlOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBzZWxmLmRpc3Rbc291cmNlIGFzIHVzaXplXSA9IDA7CgogICAgICAgIC8vIE1haW4gRGlqa3N0cmEgbG9vcAogICAgICAgIGxldCBtdXQgcHJvY2Vzc2VkOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChwcm9jZXNzZWQgPCBzZWxmLnZlcnRpY2VzKSB7CiAgICAgICAgICAgIC8vIEZpbmQgbWluaW11bSBkaXN0YW5jZSB1bnZpc2l0ZWQgdmVydGV4CiAgICAgICAgICAgIGxldCBtdXQgbWluX2Rpc3Q6IGkzMiA9IDIxNDc0ODM2NDc7CiAgICAgICAgICAgIGxldCBtdXQgdTogaTMyID0gLTE7CiAgICAgICAgICAgIGxldCBtdXQgdjogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKHYgPCBzZWxmLnZlcnRpY2VzKSB7CiAgICAgICAgICAgICAgICBpZiAoIXNlbGYudmlzaXRlZFt2IGFzIHVzaXplXSAmJiBzZWxmLmRpc3RbdiBhcyB1c2l6ZV0gPCBtaW5fZGlzdCkgewogICAgICAgICAgICAgICAgICAgIG1pbl9kaXN0ID0gc2VsZi5kaXN0W3YgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIHUgPSB2OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdiArPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodSA9PSAtMSkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNlbGYudmlzaXRlZFt1IGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgICAgIHByb2Nlc3NlZCArPSAxOwoKICAgICAgICAgICAgLy8gVXBkYXRlIGRpc3RhbmNlcyB0byBhZGphY2VudCB2ZXJ0aWNlcwogICAgICAgICAgICBsZXQgbXV0IGVkZ2VfaWR4OiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoZWRnZV9pZHggPCBzZWxmLmVkZ2VfY291bnQpIHsKICAgICAgICAgICAgICAgIGxldCBlZGdlOiBFZGdlID0gc2VsZi5lZGdlc1tlZGdlX2lkeCBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBpZiAoZWRnZS5mcm9tID09IHUpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgbmV3X2Rpc3Q6IGkzMiA9IHNlbGYuZGlzdFt1IGFzIHVzaXplXSArIGVkZ2Uud2VpZ2h0OwogICAgICAgICAgICAgICAgICAgIGlmIChuZXdfZGlzdCA8IHNlbGYuZGlzdFtlZGdlLnRvIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRpc3RbZWRnZS50byBhcyB1c2l6ZV0gPSBuZXdfZGlzdDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlZGdlX2lkeCArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vIEZsb3lkLVdhcnNoYWxsIGFsbC1wYWlycyBzaG9ydGVzdCBwYXRocyBhbGdvcml0aG0KICAgIGZuIGZsb3lkX3dhcnNoYWxsKCZtdXQgc2VsZikgewogICAgICAgIC8vIE1haW4gRmxveWQtV2Fyc2hhbGwgdHJpcGxlIGxvb3AKICAgICAgICBsZXQgbXV0IGs6IHVzaXplID0gMDsKICAgICAgICB3aGlsZSAoayA8IHNlbGYudmVydGljZXMgYXMgdXNpemUpIHsKICAgICAgICAgICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICAgICAgICAgIHdoaWxlIChpIDwgc2VsZi52ZXJ0aWNlcyBhcyB1c2l6ZSkgewogICAgICAgICAgICAgICAgbGV0IG11dCBqOiB1c2l6ZSA9IDA7CiAgICAgICAgICAgICAgICB3aGlsZSAoaiA8IHNlbGYudmVydGljZXMgYXMgdXNpemUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5mbG95ZF9kaXN0W2ldW2tdICE9IDIxNDc0ODM2NDcgCiAgICAgICAgICAgICAgICAgICAgICAgICYmIHNlbGYuZmxveWRfZGlzdFtrXVtqXSAhPSAyMTQ3NDgzNjQ3KXsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZpYV9rOiBpMzIgPSBzZWxmLmZsb3lkX2Rpc3RbaV1ba10gKyBzZWxmLmZsb3lkX2Rpc3Rba11bal07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWFfayA8IHNlbGYuZmxveWRfZGlzdFtpXVtqXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5mbG95ZF9kaXN0W2ldW2pdID0gdmlhX2s7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaiArPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaSArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGsgKz0gMTsKICAgICAgICB9CiAgICB9CgogICAgLy8gVGFyamFuJ3MgYWxnb3JpdGhtIGZvciBmaW5kaW5nIHN0cm9uZ2x5IGNvbm5lY3RlZCBjb21wb25lbnRzCiAgICBmbiB0YXJqYW5fc2NjKCZtdXQgc2VsZiwgdTogaTMyKSB7CiAgICAgICAgLy8gSW5pdGlhbGl6ZSBkaXNjb3ZlcnkgdGltZSBhbmQgbG93IHZhbHVlCiAgICAgICAgc2VsZi5kaXNjW3UgYXMgdXNpemVdID0gc2VsZi50aW1lOwogICAgICAgIHNlbGYubG93W3UgYXMgdXNpemVdID0gc2VsZi50aW1lOwogICAgICAgIHNlbGYudGltZSArPSAxOwoKICAgICAgICAvLyBQdXNoIGN1cnJlbnQgdmVydGV4IHRvIHN0YWNrCiAgICAgICAgc2VsZi5zdGFja1tzZWxmLnN0YWNrX3RvcCBhcyB1c2l6ZV0gPSB1OwogICAgICAgIHNlbGYuc3RhY2tfdG9wICs9IDE7CiAgICAgICAgc2VsZi5vbl9zdGFja1t1IGFzIHVzaXplXSA9IHRydWU7CgogICAgICAgIC8vIEdvIHRocm91Z2ggYWxsIGFkamFjZW50IHZlcnRpY2VzCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi5hZGpfY291bnRbdSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgbGV0IHY6IGkzMiA9IHNlbGYuYWRqX2xpc3RbdSBhcyB1c2l6ZV1baSBhcyB1c2l6ZV07CgogICAgICAgICAgICBpZiAoc2VsZi5kaXNjW3YgYXMgdXNpemVdID09IC0xKSB7CiAgICAgICAgICAgICAgICAvLyBJZiB2IGlzIG5vdCB2aXNpdGVkLCByZWN1ciBmb3IgaXQKICAgICAgICAgICAgICAgIHNlbGYudGFyamFuX3NjYyh2KTsKCiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgc3VidHJlZSByb290ZWQgd2l0aCB2IGhhcyBhIGNvbm5lY3Rpb24gYmFjayB0byBhbmNlc3RvcnMgb2YgdQogICAgICAgICAgICAgICAgaWYgKHNlbGYubG93W3YgYXMgdXNpemVdIDwgc2VsZi5sb3dbdSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgICAgICBzZWxmLmxvd1t1IGFzIHVzaXplXSA9IHNlbGYubG93W3YgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYgKHNlbGYub25fc3RhY2tbdiBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBsb3cgdmFsdWUgb2YgdSBvbmx5IGlmIHYgaXMgc3RpbGwgaW4gc3RhY2sKICAgICAgICAgICAgICAgIGlmIChzZWxmLmRpc2NbdiBhcyB1c2l6ZV0gPCBzZWxmLmxvd1t1IGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgICAgIHNlbGYubG93W3UgYXMgdXNpemVdID0gc2VsZi5kaXNjW3YgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIElmIHUgaXMgYSByb290IG5vZGUsIHBvcCB0aGUgc3RhY2sgYW5kIHByb2Nlc3MgYW4gU0NDCiAgICAgICAgaWYgKHNlbGYubG93W3UgYXMgdXNpemVdID09IHNlbGYuZGlzY1t1IGFzIHVzaXplXSkgewogICAgICAgICAgICBzZWxmLnNjY19jb3VudCArPSAxOwoKICAgICAgICAgICAgLy8gUG9wIHZlcnRpY2VzIGZyb20gc3RhY2sgdW50aWwgdSBpcyBmb3VuZAogICAgICAgICAgICB3aGlsZSAoc2VsZi5zdGFja190b3AgPiAwKSB7CiAgICAgICAgICAgICAgICBzZWxmLnN0YWNrX3RvcCAtPSAxOwogICAgICAgICAgICAgICAgbGV0IHc6IGkzMiA9IHNlbGYuc3RhY2tbc2VsZi5zdGFja190b3AgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgc2VsZi5vbl9zdGFja1t3IGFzIHVzaXplXSA9IGZhbHNlOwoKICAgICAgICAgICAgICAgIGlmICh3ID09IHUpIHsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLyBGaW5kIGFsbCBzdHJvbmdseSBjb25uZWN0ZWQgY29tcG9uZW50cwogICAgZm4gZmluZF9hbGxfc2NjKCZtdXQgc2VsZikgewogICAgICAgIC8vIEluaXRpYWxpemUgYWxsIHZlcnRpY2VzIGFzIG5vdCB2aXNpdGVkCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi52ZXJ0aWNlcykgewogICAgICAgICAgICBzZWxmLmRpc2NbaSBhcyB1c2l6ZV0gPSAtMTsKICAgICAgICAgICAgc2VsZi5sb3dbaSBhcyB1c2l6ZV0gPSAtMTsKICAgICAgICAgICAgc2VsZi5vbl9zdGFja1tpIGFzIHVzaXplXSA9IGZhbHNlOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBzZWxmLnRpbWUgPSAwOwogICAgICAgIHNlbGYuc3RhY2tfdG9wID0gMDsKICAgICAgICBzZWxmLnNjY19jb3VudCA9IDA7CgogICAgICAgIC8vIENhbGwgdGhlIHJlY3Vyc2l2ZSBoZWxwZXIgZnVuY3Rpb24gZm9yIGFsbCB2ZXJ0aWNlcwogICAgICAgIGxldCBtdXQgdjogaTMyID0gMDsKICAgICAgICB3aGlsZSAodiA8IHNlbGYudmVydGljZXMpIHsKICAgICAgICAgICAgaWYgKHNlbGYuZGlzY1t2IGFzIHVzaXplXSA9PSAtMSkgewogICAgICAgICAgICAgICAgc2VsZi50YXJqYW5fc2NjKHYpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHYgKz0gMTsKICAgICAgICB9CiAgICB9CgogICAgLy8gVW5pb24tRmluZCBkYXRhIHN0cnVjdHVyZSBvcGVyYXRpb25zIGZvciBLcnVza2FsJ3MgYWxnb3JpdGhtCiAgICBmbiBmaW5kX3BhcmVudCgmbXV0IHNlbGYsIHg6IGkzMikgLT4gaTMyIHsKICAgICAgICBpZiAoc2VsZi5wYXJlbnRbeCBhcyB1c2l6ZV0gIT0geCkgewogICAgICAgICAgICBzZWxmLnBhcmVudFt4IGFzIHVzaXplXSA9IHNlbGYuZmluZF9wYXJlbnQoc2VsZi5wYXJlbnRbeCBhcyB1c2l6ZV0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc2VsZi5wYXJlbnRbeCBhcyB1c2l6ZV07CiAgICB9CgogICAgZm4gdW5pb25fc2V0cygmbXV0IHNlbGYsIHg6IGkzMiwgeTogaTMyKSB7CiAgICAgICAgbGV0IHJvb3RfeDogaTMyID0gc2VsZi5maW5kX3BhcmVudCh4KTsKICAgICAgICBsZXQgcm9vdF95OiBpMzIgPSBzZWxmLmZpbmRfcGFyZW50KHkpOwoKICAgICAgICBpZiAocm9vdF94ICE9IHJvb3RfeSkgewogICAgICAgICAgICBpZiAoc2VsZi5yYW5rW3Jvb3RfeCBhcyB1c2l6ZV0gPCBzZWxmLnJhbmtbcm9vdF95IGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgc2VsZi5wYXJlbnRbcm9vdF94IGFzIHVzaXplXSA9IHJvb3RfeTsKICAgICAgICAgICAgfSBlbHNlIGlmIChzZWxmLnJhbmtbcm9vdF94IGFzIHVzaXplXSA+IHNlbGYucmFua1tyb290X3kgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBzZWxmLnBhcmVudFtyb290X3kgYXMgdXNpemVdID0gcm9vdF94OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc2VsZi5wYXJlbnRbcm9vdF95IGFzIHVzaXplXSA9IHJvb3RfeDsKICAgICAgICAgICAgICAgIHNlbGYucmFua1tyb290X3ggYXMgdXNpemVdICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8gS3J1c2thbCdzIGFsZ29yaXRobSBmb3IgTWluaW11bSBTcGFubmluZyBUcmVlCiAgICBmbiBrcnVza2FsX21zdCgmbXV0IHNlbGYpIHsKICAgICAgICAvLyBJbml0aWFsaXplIFVuaW9uLUZpbmQgc3RydWN0dXJlCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi52ZXJ0aWNlcykgewogICAgICAgICAgICBzZWxmLnBhcmVudFtpIGFzIHVzaXplXSA9IGk7CiAgICAgICAgICAgIHNlbGYucmFua1tpIGFzIHVzaXplXSA9IDA7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIFNvcnQgZWRnZXMgYnkgd2VpZ2h0IHVzaW5nIGJ1YmJsZSBzb3J0CiAgICAgICAgbGV0IG11dCBzb3J0ZWQ6IGJvb2wgPSBmYWxzZTsKICAgICAgICB3aGlsZSAoIXNvcnRlZCkgewogICAgICAgICAgICBzb3J0ZWQgPSB0cnVlOwogICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChqIDwgc2VsZi5lZGdlX2NvdW50IC0gMSkgewogICAgICAgICAgICAgICAgaWYgKHNlbGYuZWRnZXNbaiBhcyB1c2l6ZV0ud2VpZ2h0ID4gc2VsZi5lZGdlc1soaiArIDEpIGFzIHVzaXplXS53ZWlnaHQpIHsKICAgICAgICAgICAgICAgICAgICAvLyBTd2FwIGVkZ2VzCiAgICAgICAgICAgICAgICAgICAgbGV0IHRlbXA6IEVkZ2UgPSBzZWxmLmVkZ2VzW2ogYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIHNlbGYuZWRnZXNbaiBhcyB1c2l6ZV0gPSBzZWxmLmVkZ2VzWyhqICsgMSkgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIHNlbGYuZWRnZXNbKGogKyAxKSBhcyB1c2l6ZV0gPSB0ZW1wOwogICAgICAgICAgICAgICAgICAgIHNvcnRlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaiArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzZWxmLm1zdF93ZWlnaHQgPSAwOwogICAgICAgIGxldCBtdXQgZWRnZXNfYWRkZWQ6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBlZGdlX2lkeDogaTMyID0gMDsKCiAgICAgICAgLy8gUHJvY2VzcyBlZGdlcyBpbiBzb3J0ZWQgb3JkZXIKICAgICAgICB3aGlsZSAoZWRnZV9pZHggPCBzZWxmLmVkZ2VfY291bnQgJiYgZWRnZXNfYWRkZWQgPCBzZWxmLnZlcnRpY2VzIC0gMSkgewogICAgICAgICAgICBsZXQgZWRnZTogRWRnZSA9IHNlbGYuZWRnZXNbZWRnZV9pZHggYXMgdXNpemVdOwogICAgICAgICAgICBsZXQgcm9vdF9mcm9tOiBpMzIgPSBzZWxmLmZpbmRfcGFyZW50KGVkZ2UuZnJvbSk7CiAgICAgICAgICAgIGxldCByb290X3RvOiBpMzIgPSBzZWxmLmZpbmRfcGFyZW50KGVkZ2UudG8pOwoKICAgICAgICAgICAgLy8gSWYgaW5jbHVkaW5nIHRoaXMgZWRnZSBkb2Vzbid0IGNhdXNlIGN5Y2xlCiAgICAgICAgICAgIGlmIChyb290X2Zyb20gIT0gcm9vdF90bykgewogICAgICAgICAgICAgICAgc2VsZi51bmlvbl9zZXRzKGVkZ2UuZnJvbSwgZWRnZS50byk7CiAgICAgICAgICAgICAgICBzZWxmLm1zdF93ZWlnaHQgKz0gZWRnZS53ZWlnaHQ7CiAgICAgICAgICAgICAgICBlZGdlc19hZGRlZCArPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBlZGdlX2lkeCArPSAxOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBOZXR3b3JrIGZsb3cgYW5hbHlzaXMgdXNpbmcgRm9yZC1GdWxrZXJzb24gbWV0aG9kIHdpdGggREZTCiAgICBmbiBkZnNfZmxvdygKICAgICAgICAmbXV0IHNlbGYsCiAgICAgICAgc291cmNlOiBpMzIsCiAgICAgICAgc2luazogaTMyLAogICAgICAgIGN1cnJlbnQ6IGkzMiwKICAgICAgICBtaW5fZmxvdzogaTMyLAogICAgICAgIHZpc2l0ZWQ6ICZtdXQgW2Jvb2w7IDEwMF0sCiAgICApIC0+IGkzMiB7CiAgICAgICAgaWYgKGN1cnJlbnQgPT0gc2luaykgewogICAgICAgICAgICByZXR1cm4gbWluX2Zsb3c7CiAgICAgICAgfQoKICAgICAgICB2aXNpdGVkW2N1cnJlbnQgYXMgdXNpemVdID0gdHJ1ZTsKCiAgICAgICAgLy8gVHJ5IGFsbCBvdXRnb2luZyBlZGdlcwogICAgICAgIGxldCBtdXQgZWRnZV9pZHg6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGVkZ2VfaWR4IDwgc2VsZi5lZGdlX2NvdW50KSB7CiAgICAgICAgICAgIGxldCBlZGdlOiBFZGdlID0gc2VsZi5lZGdlc1tlZGdlX2lkeCBhcyB1c2l6ZV07CiAgICAgICAgICAgIGlmIChlZGdlLmZyb20gPT0gY3VycmVudCAmJiAhdmlzaXRlZFtlZGdlLnRvIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgbGV0IHJlc2lkdWFsX2NhcGFjaXR5OiBpMzIgPSBlZGdlLmNhcGFjaXR5IC0gZWRnZS5mbG93OwogICAgICAgICAgICAgICAgaWYgKHJlc2lkdWFsX2NhcGFjaXR5ID4gMCkgewogICAgICAgICAgICAgICAgICAgIGxldCBib3R0bGVuZWNrOiBpMzIgPSBpZiAobWluX2Zsb3cgPCByZXNpZHVhbF9jYXBhY2l0eSkgewogICAgICAgICAgICAgICAgICAgICAgICBtaW5fZmxvdwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc2lkdWFsX2NhcGFjaXR5CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBsZXQgZmxvd19zZW50OiBpMzIgPSBzZWxmLmRmc19mbG93KHNvdXJjZSwgc2luaywgZWRnZS50bywgYm90dGxlbmVjaywgdmlzaXRlZCk7CgogICAgICAgICAgICAgICAgICAgIGlmIChmbG93X3NlbnQgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBmb3J3YXJkIGFuZCBiYWNrd2FyZCBmbG93cwogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmVkZ2VzW2VkZ2VfaWR4IGFzIHVzaXplXS5mbG93ICs9IGZsb3dfc2VudDsKCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgcmV2ZXJzZSBlZGdlIGFuZCB1cGRhdGUgaXRzIGZsb3cKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG11dCByZXZfaWR4OiBpMzIgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAocmV2X2lkeCA8IHNlbGYuZWRnZV9jb3VudCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJldl9lZGdlOiBFZGdlID0gc2VsZi5lZGdlc1tyZXZfaWR4IGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXZfZWRnZS5mcm9tID09IGVkZ2UudG8gJiYgcmV2X2VkZ2UudG8gPT0gZWRnZS5mcm9tKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5lZGdlc1tyZXZfaWR4IGFzIHVzaXplXS5mbG93IC09IGZsb3dfc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldl9pZHggKz0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZsb3dfc2VudDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWRnZV9pZHggKz0gMTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIGZuIG1heF9mbG93KCZtdXQgc2VsZiwgc291cmNlOiBpMzIsIHNpbms6IGkzMikgLT4gaTMyIHsKICAgICAgICBsZXQgbXV0IHRvdGFsX2Zsb3c6IGkzMiA9IDA7CgogICAgICAgIC8vIFJlc2V0IGFsbCBmbG93cwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuZWRnZV9jb3VudCkgewogICAgICAgICAgICBzZWxmLmVkZ2VzW2kgYXMgdXNpemVdLmZsb3cgPSAwOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBDb250aW51ZSB1bnRpbCBubyBhdWdtZW50aW5nIHBhdGggY2FuIGJlIGZvdW5kCiAgICAgICAgbGV0IG11dCBpdGVyYXRpb25zOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpdGVyYXRpb25zIDwgMTAwMCkgewogICAgICAgICAgICAvLyBQcmV2ZW50IGluZmluaXRlIGxvb3BzCiAgICAgICAgICAgIGxldCBtdXQgdmlzaXRlZDogW2Jvb2w7IDEwMF0gPSBbZmFsc2U7IDEwMF07CiAgICAgICAgICAgIGxldCBmbG93X3NlbnQ6IGkzMiA9IHNlbGYuZGZzX2Zsb3coc291cmNlLCBzaW5rLCBzb3VyY2UsIDUwMCwgJm11dCB2aXNpdGVkKTsKCiAgICAgICAgICAgIGlmIChmbG93X3NlbnQgPT0gMCkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRvdGFsX2Zsb3cgKz0gZmxvd19zZW50OwogICAgICAgICAgICBpdGVyYXRpb25zICs9IDE7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdG90YWxfZmxvdzsKICAgIH0KCiAgICAvLyBDb21wcmVoZW5zaXZlIGdyYXBoIGFuYWx5c2lzIGZ1bmN0aW9uCiAgICBmbiBhbmFseXplX2dyYXBoKCZtdXQgc2VsZiwgc291cmNlOiBpMzIsIHNpbms6IGkzMikgewogICAgICAgIC8vIFJ1biBEaWprc3RyYSdzIHNob3J0ZXN0IHBhdGgKICAgICAgICBzZWxmLmRpamtzdHJhKHNvdXJjZSk7CiAgICAgICAgcHJpbnRsbkludChzZWxmLmRpc3Rbc2luayBhcyB1c2l6ZV0pOwoKICAgICAgICAvLyBSdW4gRmxveWQtV2Fyc2hhbGwgYWxsLXBhaXJzIHNob3J0ZXN0IHBhdGhzCiAgICAgICAgc2VsZi5mbG95ZF93YXJzaGFsbCgpOwogICAgICAgIHByaW50bG5JbnQoc2VsZi5mbG95ZF9kaXN0W3NvdXJjZSBhcyB1c2l6ZV1bc2luayBhcyB1c2l6ZV0pOwoKICAgICAgICAvLyBGaW5kIHN0cm9uZ2x5IGNvbm5lY3RlZCBjb21wb25lbnRzCiAgICAgICAgc2VsZi5maW5kX2FsbF9zY2MoKTsKICAgICAgICBwcmludGxuSW50KHNlbGYuc2NjX2NvdW50KTsKCiAgICAgICAgLy8gRmluZCBtaW5pbXVtIHNwYW5uaW5nIHRyZWUKICAgICAgICBzZWxmLmtydXNrYWxfbXN0KCk7CiAgICAgICAgcHJpbnRsbkludChzZWxmLm1zdF93ZWlnaHQpOwoKICAgICAgICAvLyBDYWxjdWxhdGUgbWF4aW11bSBmbG93CiAgICAgICAgbGV0IG1heF9mbG93X3ZhbHVlOiBpMzIgPSBzZWxmLm1heF9mbG93KHNvdXJjZSwgc2luayk7CiAgICAgICAgcHJpbnRsbkludChtYXhfZmxvd192YWx1ZSk7CiAgICB9Cn0KCi8vIENvbXBsZXggZ3JhcGggZ2VuZXJhdG9yIGZvciB0ZXN0aW5nCnN0cnVjdCBHcmFwaEdlbmVyYXRvciB7CiAgICBzZWVkOiBpMzIsCn0KCmltcGwgR3JhcGhHZW5lcmF0b3IgewogICAgZm4gbmV3KHNlZWQ6IGkzMikgLT4gR3JhcGhHZW5lcmF0b3IgewogICAgICAgIEdyYXBoR2VuZXJhdG9yIHsgc2VlZDogc2VlZCB9CiAgICB9CgogICAgLy8gTGluZWFyIGNvbmdydWVudGlhbCBnZW5lcmF0b3IgZm9yIHBzZXVkby1yYW5kb20gbnVtYmVycwogICAgZm4gbmV4dF9yYW5kb20oJm11dCBzZWxmKSAtPiBpMzIgewogICAgICAgIHNlbGYuc2VlZCA9IHBtX3JhbmRfdXBkYXRlKHNlbGYuc2VlZCk7CiAgICAgICAgaWYgKHNlbGYuc2VlZCA8IDApIHsKICAgICAgICAgICAgc2VsZi5zZWVkID0gLXNlbGYuc2VlZDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNlbGYuc2VlZDsKICAgIH0KCiAgICAvLyBHZW5lcmF0ZSBhIGNvbXBsZXggZ3JhcGggd2l0aCBzcGVjaWZpYyBwcm9wZXJ0aWVzCiAgICBmbiBnZW5lcmF0ZV9jb21wbGV4X2dyYXBoKCZtdXQgc2VsZiwgZ3JhcGg6ICZtdXQgR3JhcGgsIGRlbnNpdHk6IGkzMikgewogICAgICAgIGxldCB2ZXJ0aWNlczogaTMyID0gZ3JhcGgudmVydGljZXM7CgogICAgICAgIC8vIEdlbmVyYXRlIHJhbmRvbSBlZGdlcyB3aXRoIHZhcnlpbmcgd2VpZ2h0cyBhbmQgY2FwYWNpdGllcwogICAgICAgIGxldCB0YXJnZXRfZWRnZXM6IGkzMiA9ICh2ZXJ0aWNlcyAqIHZlcnRpY2VzICogZGVuc2l0eSkgLyAxMDA7CiAgICAgICAgbGV0IG11dCBlZGdlc19hZGRlZDogaTMyID0gMDsKCiAgICAgICAgd2hpbGUgKGVkZ2VzX2FkZGVkIDwgdGFyZ2V0X2VkZ2VzICYmIGVkZ2VzX2FkZGVkIDwgMTgwMCkgewogICAgICAgICAgICBsZXQgZnJvbTogaTMyID0gc2VsZi5uZXh0X3JhbmRvbSgpICUgdmVydGljZXM7CiAgICAgICAgICAgIGxldCB0bzogaTMyID0gc2VsZi5uZXh0X3JhbmRvbSgpICUgdmVydGljZXM7CgogICAgICAgICAgICBpZiAoZnJvbSAhPSB0bykgewogICAgICAgICAgICAgICAgbGV0IHdlaWdodDogaTMyID0gKHNlbGYubmV4dF9yYW5kb20oKSAlIDEwMCkgKyAxOwogICAgICAgICAgICAgICAgbGV0IGNhcGFjaXR5OiBpMzIgPSAoc2VsZi5uZXh0X3JhbmRvbSgpICUgNTApICsgMTsKCiAgICAgICAgICAgICAgICBncmFwaC5hZGRfZWRnZShmcm9tLCB0bywgd2VpZ2h0LCBjYXBhY2l0eSk7CiAgICAgICAgICAgICAgICBlZGdlc19hZGRlZCArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBBZGQgc29tZSBndWFyYW50ZWVkIHBhdGhzIHRvIGVuc3VyZSBjb25uZWN0aXZpdHkKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCB2ZXJ0aWNlcyAtIDEpIHsKICAgICAgICAgICAgbGV0IHdlaWdodDogaTMyID0gKHNlbGYubmV4dF9yYW5kb20oKSAlIDIwKSArIDE7CiAgICAgICAgICAgIGxldCBjYXBhY2l0eTogaTMyID0gKHNlbGYubmV4dF9yYW5kb20oKSAlIDMwKSArIDE7CiAgICAgICAgICAgIGdyYXBoLmFkZF9lZGdlKGksIGkgKyAxLCB3ZWlnaHQsIGNhcGFjaXR5KTsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgIH0KfQoKZm4gbWFpbigpIHsKICAgIC8vIFJlYWQgaW5wdXQgcGFyYW1ldGVycwogICAgbGV0IHZlcnRpY2VzOiBpMzIgPSBnZXRJbnQoKTsKICAgIGxldCBkZW5zaXR5OiBpMzIgPSBnZXRJbnQoKTsKICAgIGxldCBzb3VyY2U6IGkzMiA9IGdldEludCgpOwogICAgbGV0IHNpbms6IGkzMiA9IGdldEludCgpOwogICAgbGV0IHNlZWQ6IGkzMiA9IGdldEludCgpOwoKICAgIC8vIENyZWF0ZSBhbmQgaW5pdGlhbGl6ZSBncmFwaAogICAgbGV0IG11dCBncmFwaDogR3JhcGggPSBHcmFwaDo6bmV3KHZlcnRpY2VzKTsKICAgIGxldCBtdXQgZ2VuZXJhdG9yOiBHcmFwaEdlbmVyYXRvciA9IEdyYXBoR2VuZXJhdG9yOjpuZXcoc2VlZCk7CgogICAgLy8gR2VuZXJhdGUgY29tcGxleCBncmFwaCBzdHJ1Y3R1cmUKICAgIGdlbmVyYXRvci5nZW5lcmF0ZV9jb21wbGV4X2dyYXBoKCZtdXQgZ3JhcGgsIGRlbnNpdHkpOwoKICAgIC8vIFBlcmZvcm0gY29tcHJlaGVuc2l2ZSBncmFwaCBhbmFseXNpcwogICAgZ3JhcGguYW5hbHl6ZV9ncmFwaChzb3VyY2UsIHNpbmspOwoKICAgIC8vIEFkZGl0aW9uYWwgY29tcGxleCBvcGVyYXRpb25zIGZvciBzdHJlc3MgdGVzdGluZwoKICAgIC8vIFRlc3QgbXVsdGlwbGUgc2hvcnRlc3QgcGF0aCBxdWVyaWVzCiAgICBsZXQgbXV0IHF1ZXJ5X2NvdW50OiBpMzIgPSAwOwogICAgd2hpbGUgKHF1ZXJ5X2NvdW50IDwgMTApIHsKICAgICAgICBsZXQgc3RhcnQ6IGkzMiA9IChnZW5lcmF0b3IubmV4dF9yYW5kb20oKSAlIHZlcnRpY2VzKTsKICAgICAgICBsZXQgZW5kOiBpMzIgPSAoZ2VuZXJhdG9yLm5leHRfcmFuZG9tKCkgJSB2ZXJ0aWNlcyk7CgogICAgICAgIGlmIChzdGFydCAhPSBlbmQpIHsKICAgICAgICAgICAgZ3JhcGguZGlqa3N0cmEoc3RhcnQpOwogICAgICAgICAgICBwcmludGxuSW50KGdyYXBoLmRpc3RbZW5kIGFzIHVzaXplXSk7CiAgICAgICAgfQoKICAgICAgICBxdWVyeV9jb3VudCArPSAxOwogICAgfQoKICAgIC8vIEFuYWx5emUgZ3JhcGggY29ubmVjdGl2aXR5IGFuZCBzdHJ1Y3R1cmUKICAgIGxldCBtdXQgY29tcG9uZW50X2FuYWx5c2lzOiBpMzIgPSAwOwogICAgbGV0IG11dCByb3VuZDogaTMyID0gMDsKICAgIHdoaWxlIChyb3VuZCA8IDUpIHsKICAgICAgICBncmFwaC5maW5kX2FsbF9zY2MoKTsKICAgICAgICBjb21wb25lbnRfYW5hbHlzaXMgKz0gZ3JhcGguc2NjX2NvdW50OwogICAgICAgIHJvdW5kICs9IDE7CiAgICB9CiAgICBwcmludGxuSW50KGNvbXBvbmVudF9hbmFseXNpcyk7CgogICAgLy8gTXVsdGlwbGUgTVNUIGNhbGN1bGF0aW9ucyB3aXRoIGVkZ2UgbW9kaWZpY2F0aW9ucwogICAgbGV0IG11dCB0b3RhbF9tc3Rfd2VpZ2h0OiBpMzIgPSAwOwogICAgbGV0IG11dCBtc3Rfcm91bmQ6IGkzMiA9IDA7CiAgICB3aGlsZSAobXN0X3JvdW5kIDwgMykgewogICAgICAgIGdyYXBoLmtydXNrYWxfbXN0KCk7CiAgICAgICAgdG90YWxfbXN0X3dlaWdodCArPSBncmFwaC5tc3Rfd2VpZ2h0OwoKICAgICAgICAvLyBNb2RpZnkgc29tZSBlZGdlIHdlaWdodHMgZm9yIG5leHQgaXRlcmF0aW9uCiAgICAgICAgbGV0IG11dCBtb2RfY291bnQ6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKG1vZF9jb3VudCA8IDEwICYmIG1vZF9jb3VudCA8IGdyYXBoLmVkZ2VfY291bnQpIHsKICAgICAgICAgICAgbGV0IG5ld193ZWlnaHQ6IGkzMiA9IChnZW5lcmF0b3IubmV4dF9yYW5kb20oKSAlIDUwKSArIDE7CiAgICAgICAgICAgIGdyYXBoLmVkZ2VzW21vZF9jb3VudCBhcyB1c2l6ZV0ud2VpZ2h0ID0gbmV3X3dlaWdodDsKICAgICAgICAgICAgbW9kX2NvdW50ICs9IDE7CiAgICAgICAgfQoKICAgICAgICBtc3Rfcm91bmQgKz0gMTsKICAgIH0KICAgIHByaW50bG5JbnQodG90YWxfbXN0X3dlaWdodCk7CgogICAgLy8gRmluYWwgY29tcHJlaGVuc2l2ZSBtZXRyaWMKICAgIGxldCBmaW5hbF9tZXRyaWM6IGkzMiA9IChjb21wb25lbnRfYW5hbHlzaXMgKiB0b3RhbF9tc3Rfd2VpZ2h0KSAvICh2ZXJ0aWNlcyArIDEpOwogICAgcHJpbnRsbkludChmaW5hbF9tZXRyaWMpOwogICAgZXhpdCgwKTsKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (11, "comprehensive11", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCAxMTogQm9vbGVhbiBMb2dpYyBhbmQgT3B0aW1pemF0aW9uIFRlc3QKU3VtbWFyeTogVGhpcyB0ZXN0IGZvY3VzZXMgb24gY29tcGlsZXIgb3B0aW1pemF0aW9uIG9mIEJvb2xlYW4gb3BlcmF0aW9ucyBpbmNsdWRpbmc6CkRldGFpbHM6CkJvb2xlYW4gZXhwcmVzc2lvbiBvcHRpbWl6YXRpb24gYW5kIHNob3J0LWNpcmN1aXRpbmcKQnJhbmNoIHByZWRpY3Rpb24gb3B0aW1pemF0aW9uIGZvciBCb29sZWFuIGNvbmRpdGlvbnMKQm9vbGVhbiBhcnJheSBvcGVyYXRpb25zIGFuZCBiaXQgbWFuaXB1bGF0aW9uIHNpbXVsYXRpb24KQ29tcGxleCBjb25kaXRpb25hbCBsb2dpYyBvcHRpbWl6YXRpb24KQm9vbGVhbiBmdW5jdGlvbiBpbmxpbmluZyBhbmQgb3B0aW1pemF0aW9uClRydXRoIHRhYmxlIGNvbXB1dGF0aW9uIG9wdGltaXphdGlvbgoqLwoKLy8gVW5pZmllZCBSTkc6IFBhcmvigJNNaWxsZXIgKGE9MTY4MDcsIG09MjE0NzQ4MzY0NykgdXNpbmcgU2NocmFnZSBtZXRob2QgdG8gYXZvaWQgb3ZlcmZsb3cKZm4gcG1fcmFuZF91cGRhdGUoeDogaTMyKSAtPiBpMzIgewogICAgbGV0IGE6IGkzMiA9IDE2ODA3OwogICAgbGV0IG06IGkzMiA9IDIxNDc0ODM2NDc7CiAgICBsZXQgcTogaTMyID0gMTI3NzczOyAvLyBtIC8gYQogICAgbGV0IHI6IGkzMiA9IDI4MzY7IC8vIG0gJSBhCiAgICBsZXQgbXV0IGs6IGkzMiA9IHggLyBxOwogICAgbGV0IG11dCBuZXdfeDogaTMyID0gYSAqICh4IC0gayAqIHEpIC0gciAqIGs7CiAgICBpZiAobmV3X3ggPD0gMCkgewogICAgICAgIG5ld194ICs9IG07CiAgICB9CiAgICByZXR1cm4gbmV3X3g7Cn0KCi8vIGNvbXByZWhlbnNpdmUxMS5yeCAtIENvbXByZWhlbnNpdmUgVGVzdCAxMTogQm9vbGVhbiBMb2dpYyBhbmQgT3B0aW1pemF0aW9uIFRlc3QKLy8gVGhpcyB0ZXN0IGZvY3VzZXMgb24gY29tcGlsZXIgb3B0aW1pemF0aW9uIG9mIEJvb2xlYW4gb3BlcmF0aW9ucyBpbmNsdWRpbmc6Ci8vIC0gQm9vbGVhbiBleHByZXNzaW9uIG9wdGltaXphdGlvbiBhbmQgc2hvcnQtY2lyY3VpdGluZwovLyAtIEJyYW5jaCBwcmVkaWN0aW9uIG9wdGltaXphdGlvbiBmb3IgQm9vbGVhbiBjb25kaXRpb25zCi8vIC0gQm9vbGVhbiBhcnJheSBvcGVyYXRpb25zIGFuZCBiaXQgbWFuaXB1bGF0aW9uIHNpbXVsYXRpb24KLy8gLSBDb21wbGV4IGNvbmRpdGlvbmFsIGxvZ2ljIG9wdGltaXphdGlvbgovLyAtIEJvb2xlYW4gZnVuY3Rpb24gaW5saW5pbmcgYW5kIG9wdGltaXphdGlvbgovLyAtIFRydXRoIHRhYmxlIGNvbXB1dGF0aW9uIG9wdGltaXphdGlvbgoKZm4gbWFpbigpIHsKICAgIC8vIFBlcmZvcm1hbmNlIHRlc3QgbWFya2VyIC0gc3RhcnQKICAgIHByaW50bG5JbnQoMTEwMCk7CgogICAgLy8gVGVzdCAxOiBDb21wbGV4IEJvb2xlYW4gZXhwcmVzc2lvbiBldmFsdWF0aW9uCiAgICAvLyBUZXN0cyBjb21waWxlcidzIGFiaWxpdHkgdG8gb3B0aW1pemUgQm9vbGVhbiBsb2dpYyBhbmQgc2hvcnQtY2lyY3VpdGluZwogICAgdGVzdEJvb2xlYW5FeHByZXNzaW9uT3B0aW1pemF0aW9uKCk7CgogICAgLy8gVGVzdCAyOiBCb29sZWFuIGFycmF5IG9wZXJhdGlvbnMgYW5kIHBhdHRlcm4gbWF0Y2hpbmcKICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBCb29sZWFuIGFycmF5IGFjY2VzcyBhbmQgbWFuaXB1bGF0aW9uCiAgICB0ZXN0Qm9vbGVhbkFycmF5T3BlcmF0aW9ucygpOwoKICAgIC8vIFRlc3QgMzogTG9naWNhbCBhbGdvcml0aG0gaW1wbGVtZW50YXRpb25zCiAgICAvLyBUZXN0cyBvcHRpbWl6YXRpb24gb2YgYWxnb3JpdGhtcyBoZWF2aWx5IHVzaW5nIEJvb2xlYW4gbG9naWMKICAgIHRlc3RMb2dpY2FsQWxnb3JpdGhtcygpOwoKICAgIC8vIFRlc3QgNDogQm9vbGVhbi1iYXNlZCBzZWFyY2ggYW5kIGZpbHRlcmluZwogICAgLy8gVGVzdHMgb3B0aW1pemF0aW9uIG9mIEJvb2xlYW4tY29uZGl0aW9uYWwgY29udHJvbCBmbG93CiAgICB0ZXN0Qm9vbGVhblNlYXJjaEFuZEZpbHRlcigpOwoKICAgIC8vIFRlc3QgNTogQm9vbGVhbiBzdGF0ZSBtYWNoaW5lIHNpbXVsYXRpb24KICAgIC8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBjb21wbGV4IEJvb2xlYW4gc3RhdGUgdHJhbnNpdGlvbnMKICAgIHRlc3RCb29sZWFuU3RhdGVNYWNoaW5lKCk7CgogICAgLy8gUGVyZm9ybWFuY2UgdGVzdCBtYXJrZXIgLSBlbmQKICAgIHByaW50bG5JbnQoMTE5OSk7CiAgICBleGl0KDApOwp9CgovLyBUZXN0IDE6IEJvb2xlYW4gRXhwcmVzc2lvbiBPcHRpbWl6YXRpb24KLy8gVGVzdHMgY29tcGlsZXIncyBzaG9ydC1jaXJjdWl0IGV2YWx1YXRpb24gYW5kIEJvb2xlYW4gZXhwcmVzc2lvbiBzaW1wbGlmaWNhdGlvbgpmbiB0ZXN0Qm9vbGVhbkV4cHJlc3Npb25PcHRpbWl6YXRpb24oKSB7CiAgICBwcmludGxuSW50KDExMDEpOyAvLyBTdGFydCBCb29sZWFuIGV4cHJlc3Npb24gdGVzdAoKICAgIGxldCBtdXQgcmVzdWx0X2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIC8vIFRlc3QgY29tcGxleCBCb29sZWFuIGV4cHJlc3Npb25zIHdpdGggcG90ZW50aWFsIGZvciBvcHRpbWl6YXRpb24KICAgIHdoaWxlIChpIDwgMTAwMDApIHsKICAgICAgICBsZXQgYTogYm9vbCA9IChpICUgMiA9PSAwKTsKICAgICAgICBsZXQgYjogYm9vbCA9IChpICUgMyA9PSAwKTsKICAgICAgICBsZXQgYzogYm9vbCA9IChpICUgNSA9PSAwKTsKICAgICAgICBsZXQgZDogYm9vbCA9IChpICUgNyA9PSAwKTsKCiAgICAgICAgLy8gQ29tcGxleCBCb29sZWFuIGV4cHJlc3Npb24gdGhhdCBjYW4gYmVuZWZpdCBmcm9tIG9wdGltaXphdGlvbgogICAgICAgIGxldCBjb21wbGV4X3Jlc3VsdDogYm9vbCA9IChhICYmIGIpIHx8IChjICYmICFkKSB8fCAoIWEgJiYgYiAmJiBjKSB8fCAoYSAmJiAhYiAmJiAhYyAmJiBkKTsKCiAgICAgICAgaWYgKGNvbXBsZXhfcmVzdWx0KSB7CiAgICAgICAgICAgIHJlc3VsdF9jb3VudCA9IHJlc3VsdF9jb3VudCArIDE7CiAgICAgICAgfQoKICAgICAgICAvLyBUZXN0IEJvb2xlYW4gZXhwcmVzc2lvbnMgd2l0aCBmdW5jdGlvbiBjYWxscwogICAgICAgIGlmIChldmFsdWF0ZUNvbXBsZXhDb25kaXRpb24oaSkgJiYgKGkgJSAxMDAgPT0gMCkpIHsKICAgICAgICAgICAgcmVzdWx0X2NvdW50ID0gcmVzdWx0X2NvdW50ICsgMjsKICAgICAgICB9CgogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBwcmludGxuSW50KHJlc3VsdF9jb3VudCk7CiAgICBwcmludGxuSW50KDExMDIpOyAvLyBFbmQgQm9vbGVhbiBleHByZXNzaW9uIHRlc3QKfQoKLy8gSGVscGVyIGZ1bmN0aW9uIGZvciBjb21wbGV4IEJvb2xlYW4gZXZhbHVhdGlvbgpmbiBldmFsdWF0ZUNvbXBsZXhDb25kaXRpb24odmFsdWU6IGkzMikgLT4gYm9vbCB7CiAgICBsZXQgY29uZGl0aW9uMTogYm9vbCA9IGlzUHJpbWUodmFsdWUpOwogICAgbGV0IGNvbmRpdGlvbjI6IGJvb2wgPSAodmFsdWUgJSA0ID09IDApOwogICAgbGV0IGNvbmRpdGlvbjM6IGJvb2wgPSAodmFsdWUgPiAxMDApICYmICh2YWx1ZSA8IDk5MDApOwoKICAgIC8vIFJldHVybiBjb21wbGV4IEJvb2xlYW4gZXhwcmVzc2lvbgogICAgcmV0dXJuIChjb25kaXRpb24xIHx8IGNvbmRpdGlvbjIpICYmIGNvbmRpdGlvbjM7Cn0KCi8vIFRlc3QgMjogQm9vbGVhbiBBcnJheSBPcGVyYXRpb25zCi8vIFRlc3RzIG9wdGltaXphdGlvbiBvZiBCb29sZWFuIGFycmF5IG1hbmlwdWxhdGlvbiBhbmQgcGF0dGVybiBkZXRlY3Rpb24KZm4gdGVzdEJvb2xlYW5BcnJheU9wZXJhdGlvbnMoKSB7CiAgICBwcmludGxuSW50KDExMDMpOyAvLyBTdGFydCBCb29sZWFuIGFycmF5IHRlc3QKCiAgICBsZXQgbXV0IGJvb2xfZ3JpZDogW2Jvb2w7IDEwMDAwXSA9IFtmYWxzZTsgMTAwMDBdOyAvLyAxMDB4MTAwIEJvb2xlYW4gZ3JpZAogICAgbGV0IG11dCBwYXR0ZXJuX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCByb3c6IGkzMiA9IDA7CgogICAgLy8gSW5pdGlhbGl6ZSBCb29sZWFuIGdyaWQgd2l0aCBwYXR0ZXJucwogICAgd2hpbGUgKHJvdyA8IDEwMCkgewogICAgICAgIGxldCBtdXQgY29sOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChjb2wgPCAxMDApIHsKICAgICAgICAgICAgbGV0IGluZGV4OiBpMzIgPSByb3cgKiAxMDAgKyBjb2w7CiAgICAgICAgICAgIC8vIENyZWF0ZSBjaGVja2VyYm9hcmQgcGF0dGVybiB3aXRoIG1vZGlmaWNhdGlvbnMKICAgICAgICAgICAgYm9vbF9ncmlkW2luZGV4IGFzIHVzaXplXSA9ICgocm93ICsgY29sKSAlIDIgPT0gMCkgJiYgKHJvdyAlIDMgIT0gMCk7CiAgICAgICAgICAgIGNvbCA9IGNvbCArIDE7CiAgICAgICAgfQogICAgICAgIHJvdyA9IHJvdyArIDE7CiAgICB9CgogICAgLy8gUGVyZm9ybSBCb29sZWFuIG9wZXJhdGlvbnMgb24gdGhlIGdyaWQKICAgIHBlcmZvcm1Cb29sZWFuR3JpZE9wZXJhdGlvbnMoYm9vbF9ncmlkLCAmbXV0IHBhdHRlcm5fY291bnQpOwoKICAgIC8vIENvdW50IHNwZWNpZmljIEJvb2xlYW4gcGF0dGVybnMKICAgIHBhdHRlcm5fY291bnQgPSBwYXR0ZXJuX2NvdW50ICsgY291bnRCb29sZWFuUGF0dGVybnMoYm9vbF9ncmlkKTsKCiAgICBwcmludGxuSW50KHBhdHRlcm5fY291bnQpOwogICAgcHJpbnRsbkludCgxMTA0KTsgLy8gRW5kIEJvb2xlYW4gYXJyYXkgdGVzdAp9CgovLyBQZXJmb3JtIHZhcmlvdXMgQm9vbGVhbiBvcGVyYXRpb25zIG9uIGdyaWQKZm4gcGVyZm9ybUJvb2xlYW5HcmlkT3BlcmF0aW9ucyhtdXQgZ3JpZDogW2Jvb2w7IDEwMDAwXSwgcGF0dGVybl9jb3VudDogJm11dCBpMzIpIHsKICAgIGxldCBtdXQgb3BlcmF0aW9uczogaTMyID0gMDsKICAgIGxldCBtdXQgcm93OiBpMzIgPSAxOwoKICAgIC8vIEFwcGx5IEJvb2xlYW4gY2VsbHVsYXIgYXV0b21hdG9uIHJ1bGVzCiAgICB3aGlsZSAocm93IDwgOTkpIHsKICAgICAgICBsZXQgbXV0IGNvbDogaTMyID0gMTsKICAgICAgICB3aGlsZSAoY29sIDwgOTkpIHsKICAgICAgICAgICAgbGV0IGluZGV4OiBpMzIgPSByb3cgKiAxMDAgKyBjb2w7CgogICAgICAgICAgICAvLyBDb3VudCBCb29sZWFuIG5laWdoYm9ycwogICAgICAgICAgICBsZXQgbmVpZ2hib3JfY291bnQ6IGkzMiA9IGNvdW50Qm9vbGVhbk5laWdoYm9ycyhncmlkLCByb3csIGNvbCk7CgogICAgICAgICAgICAvLyBBcHBseSBCb29sZWFuIHJ1bGVzIGJhc2VkIG9uIG5laWdoYm9ycwogICAgICAgICAgICBpZiAoZ3JpZFtpbmRleCBhcyB1c2l6ZV0gJiYgKG5laWdoYm9yX2NvdW50IDwgMiB8fCBuZWlnaGJvcl9jb3VudCA+IDMpKSB7CiAgICAgICAgICAgICAgICBncmlkW2luZGV4IGFzIHVzaXplXSA9IGZhbHNlOwogICAgICAgICAgICAgICAgb3BlcmF0aW9ucyA9IG9wZXJhdGlvbnMgKyAxOwogICAgICAgICAgICB9IGVsc2UgaWYgKCFncmlkW2luZGV4IGFzIHVzaXplXSAmJiBuZWlnaGJvcl9jb3VudCA9PSAzKSB7CiAgICAgICAgICAgICAgICBncmlkW2luZGV4IGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgICAgICAgICBvcGVyYXRpb25zID0gb3BlcmF0aW9ucyArIDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbCA9IGNvbCArIDE7CiAgICAgICAgfQogICAgICAgIHJvdyA9IHJvdyArIDE7CiAgICB9CgogICAgKnBhdHRlcm5fY291bnQgPSAqcGF0dGVybl9jb3VudCArIG9wZXJhdGlvbnM7Cn0KCi8vIENvdW50IEJvb2xlYW4gbmVpZ2hib3JzIGluIGdyaWQKZm4gY291bnRCb29sZWFuTmVpZ2hib3JzKGdyaWQ6IFtib29sOyAxMDAwMF0sIHJvdzogaTMyLCBjb2w6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGRyOiBpMzIgPSAtMTsKCiAgICB3aGlsZSAoZHIgPD0gMSkgewogICAgICAgIGxldCBtdXQgZGM6IGkzMiA9IC0xOwogICAgICAgIHdoaWxlIChkYyA8PSAxKSB7CiAgICAgICAgICAgIGlmIChkciAhPSAwIHx8IGRjICE9IDApIHsKICAgICAgICAgICAgICAgIGxldCBucjogaTMyID0gcm93ICsgZHI7CiAgICAgICAgICAgICAgICBsZXQgbmM6IGkzMiA9IGNvbCArIGRjOwogICAgICAgICAgICAgICAgaWYgKG5yID49IDAgJiYgbnIgPCAxMDAgJiYgbmMgPj0gMCAmJiBuYyA8IDEwMCkgewogICAgICAgICAgICAgICAgICAgIGxldCBuZWlnaGJvcl9pbmRleDogaTMyID0gbnIgKiAxMDAgKyBuYzsKICAgICAgICAgICAgICAgICAgICBpZiAoZ3JpZFtuZWlnaGJvcl9pbmRleCBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgY291bnQgPSBjb3VudCArIDE7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGRjID0gZGMgKyAxOwogICAgICAgIH0KICAgICAgICBkciA9IGRyICsgMTsKICAgIH0KCiAgICByZXR1cm4gY291bnQ7Cn0KCi8vIENvdW50IHNwZWNpZmljIEJvb2xlYW4gcGF0dGVybnMgaW4gZ3JpZApmbiBjb3VudEJvb2xlYW5QYXR0ZXJucyhncmlkOiBbYm9vbDsgMTAwMDBdKSAtPiBpMzIgewogICAgbGV0IG11dCBwYXR0ZXJuX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCByb3c6IGkzMiA9IDA7CgogICAgLy8gTG9vayBmb3Igc3BlY2lmaWMgQm9vbGVhbiBwYXR0ZXJucwogICAgd2hpbGUgKHJvdyA8IDk4KSB7CiAgICAgICAgbGV0IG11dCBjb2w6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGNvbCA8IDk4KSB7CiAgICAgICAgICAgIC8vIENoZWNrIGZvciAyeDIgQm9vbGVhbiBwYXR0ZXJucwogICAgICAgICAgICBpZiAoY2hlY2tCb29sZWFuUGF0dGVybjJ4MihncmlkLCByb3csIGNvbCkpIHsKICAgICAgICAgICAgICAgIHBhdHRlcm5fY291bnQgPSBwYXR0ZXJuX2NvdW50ICsgMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIDN4MyBCb29sZWFuIHBhdHRlcm5zCiAgICAgICAgICAgIGlmIChjaGVja0Jvb2xlYW5QYXR0ZXJuM3gzKGdyaWQsIHJvdywgY29sKSkgewogICAgICAgICAgICAgICAgcGF0dGVybl9jb3VudCA9IHBhdHRlcm5fY291bnQgKyAyOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb2wgPSBjb2wgKyAxOwogICAgICAgIH0KICAgICAgICByb3cgPSByb3cgKyAxOwogICAgfQoKICAgIHJldHVybiBwYXR0ZXJuX2NvdW50Owp9CgovLyBDaGVjayBmb3Igc3BlY2lmaWMgMngyIEJvb2xlYW4gcGF0dGVybgpmbiBjaGVja0Jvb2xlYW5QYXR0ZXJuMngyKGdyaWQ6IFtib29sOyAxMDAwMF0sIHJvdzogaTMyLCBjb2w6IGkzMikgLT4gYm9vbCB7CiAgICBsZXQgdGw6IGJvb2wgPSBncmlkWyhyb3cgKiAxMDAgKyBjb2wpIGFzIHVzaXplXTsKICAgIGxldCB0cjogYm9vbCA9IGdyaWRbKHJvdyAqIDEwMCArIGNvbCArIDEpIGFzIHVzaXplXTsKICAgIGxldCBibDogYm9vbCA9IGdyaWRbKChyb3cgKyAxKSAqIDEwMCArIGNvbCkgYXMgdXNpemVdOwogICAgbGV0IGJyOiBib29sID0gZ3JpZFsoKHJvdyArIDEpICogMTAwICsgY29sICsgMSkgYXMgdXNpemVdOwoKICAgIC8vIExvb2sgZm9yIHNwZWNpZmljIHBhdHRlcm5zCiAgICByZXR1cm4gKHRsICYmICF0ciAmJiAhYmwgJiYgYnIpIHx8ICghdGwgJiYgdHIgJiYgYmwgJiYgIWJyKTsKfQoKLy8gQ2hlY2sgZm9yIHNwZWNpZmljIDN4MyBCb29sZWFuIHBhdHRlcm4KZm4gY2hlY2tCb29sZWFuUGF0dGVybjN4MyhncmlkOiBbYm9vbDsgMTAwMDBdLCByb3c6IGkzMiwgY29sOiBpMzIpIC0+IGJvb2wgewogICAgaWYgKHJvdyArIDIgPj0gMTAwIHx8IGNvbCArIDIgPj0gMTAwKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGxldCBtdXQgdHJ1ZV9jb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgcjogaTMyID0gMDsKCiAgICB3aGlsZSAociA8IDMpIHsKICAgICAgICBsZXQgbXV0IGM6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGMgPCAzKSB7CiAgICAgICAgICAgIGlmIChncmlkWygocm93ICsgcikgKiAxMDAgKyAoY29sICsgYykpIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgdHJ1ZV9jb3VudCA9IHRydWVfY291bnQgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGMgPSBjICsgMTsKICAgICAgICB9CiAgICAgICAgciA9IHIgKyAxOwogICAgfQoKICAgIC8vIFBhdHRlcm46IGV4YWN0bHkgNSB0cnVlIHZhbHVlcyBpbiAzeDMgZ3JpZAogICAgcmV0dXJuIHRydWVfY291bnQgPT0gNTsKfQoKLy8gVGVzdCAzOiBMb2dpY2FsIEFsZ29yaXRobXMKLy8gVGVzdHMgb3B0aW1pemF0aW9uIG9mIGFsZ29yaXRobXMgdGhhdCBoZWF2aWx5IHVzZSBCb29sZWFuIGxvZ2ljCmZuIHRlc3RMb2dpY2FsQWxnb3JpdGhtcygpIHsKICAgIHByaW50bG5JbnQoMTEwNSk7IC8vIFN0YXJ0IGxvZ2ljYWwgYWxnb3JpdGhtcyB0ZXN0CgogICAgbGV0IG11dCByZXN1bHRfc3VtOiBpMzIgPSAwOwoKICAgIC8vIFRlc3QgQm9vbGVhbiBzYXRpc2ZpYWJpbGl0eSBzb2x2ZXIgc2ltdWxhdGlvbgogICAgcmVzdWx0X3N1bSA9IHJlc3VsdF9zdW0gKyB0ZXN0Qm9vbGVhblNBVFNvbHZlcigpOwoKICAgIC8vIFRlc3QgQm9vbGVhbiBmdW5jdGlvbiBldmFsdWF0aW9uCiAgICByZXN1bHRfc3VtID0gcmVzdWx0X3N1bSArIHRlc3RCb29sZWFuRnVuY3Rpb25FdmFsdWF0aW9uKCk7CgogICAgLy8gVGVzdCBsb2dpY2FsIHB1enpsZXMgc29sdmluZwogICAgcmVzdWx0X3N1bSA9IHJlc3VsdF9zdW0gKyBzb2x2ZUJvb2xlYW5QdXp6bGVzKCk7CgogICAgcHJpbnRsbkludChyZXN1bHRfc3VtKTsKICAgIHByaW50bG5JbnQoMTEwNik7IC8vIEVuZCBsb2dpY2FsIGFsZ29yaXRobXMgdGVzdAp9CgovLyBTaW11bGF0ZSBCb29sZWFuIHNhdGlzZmlhYmlsaXR5IHNvbHZlcgpmbiB0ZXN0Qm9vbGVhblNBVFNvbHZlcigpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHNhdGlzZmlhYmxlX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBhc3NpZ25tZW50OiBpMzIgPSAwOwoKICAgIC8vIFRlc3QgYWxsIHBvc3NpYmxlIEJvb2xlYW4gYXNzaWdubWVudHMgZm9yIGEgMTAtdmFyaWFibGUgcHJvYmxlbQogICAgd2hpbGUgKGFzc2lnbm1lbnQgPCAxMDI0KSB7CiAgICAgICAgLy8gMl4xMCA9IDEwMjQKICAgICAgICBpZiAoZXZhbHVhdGVCb29sZWFuRm9ybXVsYShhc3NpZ25tZW50KSkgewogICAgICAgICAgICBzYXRpc2ZpYWJsZV9jb3VudCA9IHNhdGlzZmlhYmxlX2NvdW50ICsgMTsKICAgICAgICB9CiAgICAgICAgYXNzaWdubWVudCA9IGFzc2lnbm1lbnQgKyAxOwogICAgfQoKICAgIHJldHVybiBzYXRpc2ZpYWJsZV9jb3VudDsKfQoKLy8gRXZhbHVhdGUgQm9vbGVhbiBmb3JtdWxhIHdpdGggZ2l2ZW4gdmFyaWFibGUgYXNzaWdubWVudApmbiBldmFsdWF0ZUJvb2xlYW5Gb3JtdWxhKGFzc2lnbm1lbnQ6IGkzMikgLT4gYm9vbCB7CiAgICAvLyBFeHRyYWN0IEJvb2xlYW4gdmFyaWFibGVzIGZyb20gYXNzaWdubWVudCAoYml0IHJlcHJlc2VudGF0aW9uKQogICAgbGV0IHgwOiBib29sID0gKGFzc2lnbm1lbnQgJiAxKSAhPSAwOwogICAgbGV0IHgxOiBib29sID0gKGFzc2lnbm1lbnQgJiAyKSAhPSAwOwogICAgbGV0IHgyOiBib29sID0gKGFzc2lnbm1lbnQgJiA0KSAhPSAwOwogICAgbGV0IHgzOiBib29sID0gKGFzc2lnbm1lbnQgJiA4KSAhPSAwOwogICAgbGV0IHg0OiBib29sID0gKGFzc2lnbm1lbnQgJiAxNikgIT0gMDsKICAgIGxldCB4NTogYm9vbCA9IChhc3NpZ25tZW50ICYgMzIpICE9IDA7CiAgICBsZXQgeDY6IGJvb2wgPSAoYXNzaWdubWVudCAmIDY0KSAhPSAwOwogICAgbGV0IHg3OiBib29sID0gKGFzc2lnbm1lbnQgJiAxMjgpICE9IDA7CiAgICBsZXQgeDg6IGJvb2wgPSAoYXNzaWdubWVudCAmIDI1NikgIT0gMDsKICAgIGxldCB4OTogYm9vbCA9IChhc3NpZ25tZW50ICYgNTEyKSAhPSAwOwoKICAgIC8vIENvbXBsZXggQm9vbGVhbiBmb3JtdWxhIChDTkYgLSBDb25qdW5jdGl2ZSBOb3JtYWwgRm9ybSkKICAgIGxldCBjbGF1c2UxOiBib29sID0geDAgfHwgIXgxIHx8IHgyOwogICAgbGV0IGNsYXVzZTI6IGJvb2wgPSAheDAgfHwgeDMgfHwgIXg0OwogICAgbGV0IGNsYXVzZTM6IGJvb2wgPSB4MSB8fCAheDIgfHwgeDU7CiAgICBsZXQgY2xhdXNlNDogYm9vbCA9ICF4MyB8fCB4NCB8fCAheDY7CiAgICBsZXQgY2xhdXNlNTogYm9vbCA9IHgyIHx8IHg3IHx8ICF4ODsKICAgIGxldCBjbGF1c2U2OiBib29sID0gIXg1IHx8ICF4NyB8fCB4OTsKICAgIGxldCBjbGF1c2U3OiBib29sID0geDYgfHwgeDggfHwgIXg5OwogICAgbGV0IGNsYXVzZTg6IGJvb2wgPSAheDAgfHwgIXgxIHx8ICF4MjsKCiAgICByZXR1cm4gY2xhdXNlMSAmJiBjbGF1c2UyICYmIGNsYXVzZTMgJiYgY2xhdXNlNCAmJiBjbGF1c2U1ICYmIGNsYXVzZTYgJiYgY2xhdXNlNyAmJiBjbGF1c2U4Owp9CgovLyBUZXN0IEJvb2xlYW4gZnVuY3Rpb24gZXZhbHVhdGlvbiB3aXRoIHRydXRoIHRhYmxlcwpmbiB0ZXN0Qm9vbGVhbkZ1bmN0aW9uRXZhbHVhdGlvbigpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGV2YWx1YXRpb25fY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGlucHV0OiBpMzIgPSAwOwoKICAgIC8vIEV2YWx1YXRlIHZhcmlvdXMgQm9vbGVhbiBmdW5jdGlvbnMKICAgIHdoaWxlIChpbnB1dCA8IDI1NikgewogICAgICAgIC8vIDJeOCA9IDI1NgogICAgICAgIC8vIEV2YWx1YXRlIG11bHRpcGxlIEJvb2xlYW4gZnVuY3Rpb25zCiAgICAgICAgaWYgKGV2YWx1YXRlUGFyaXR5RnVuY3Rpb24oaW5wdXQpKSB7CiAgICAgICAgICAgIGV2YWx1YXRpb25fY291bnQgPSBldmFsdWF0aW9uX2NvdW50ICsgMTsKICAgICAgICB9CgogICAgICAgIGlmIChldmFsdWF0ZU1ham9yaXR5RnVuY3Rpb24oaW5wdXQpKSB7CiAgICAgICAgICAgIGV2YWx1YXRpb25fY291bnQgPSBldmFsdWF0aW9uX2NvdW50ICsgMjsKICAgICAgICB9CgogICAgICAgIGlmIChldmFsdWF0ZVRocmVzaG9sZEZ1bmN0aW9uKGlucHV0KSkgewogICAgICAgICAgICBldmFsdWF0aW9uX2NvdW50ID0gZXZhbHVhdGlvbl9jb3VudCArIDM7CiAgICAgICAgfQoKICAgICAgICBpbnB1dCA9IGlucHV0ICsgMTsKICAgIH0KCiAgICByZXR1cm4gZXZhbHVhdGlvbl9jb3VudDsKfQoKLy8gRXZhbHVhdGUgcGFyaXR5IGZ1bmN0aW9uIChYT1Igb2YgYWxsIGJpdHMpCmZuIGV2YWx1YXRlUGFyaXR5RnVuY3Rpb24oaW5wdXQ6IGkzMikgLT4gYm9vbCB7CiAgICBsZXQgbXV0IHBhcml0eTogYm9vbCA9IGZhbHNlOwogICAgbGV0IG11dCB0ZW1wOiBpMzIgPSBpbnB1dDsKCiAgICB3aGlsZSAodGVtcCA+IDApIHsKICAgICAgICBpZiAoKHRlbXAgJiAxKSAhPSAwKSB7CiAgICAgICAgICAgIHBhcml0eSA9ICFwYXJpdHk7CiAgICAgICAgfQogICAgICAgIHRlbXAgPSB0ZW1wIC8gMjsKICAgIH0KCiAgICByZXR1cm4gcGFyaXR5Owp9CgovLyBFdmFsdWF0ZSBtYWpvcml0eSBmdW5jdGlvbiAobW9yZSB0aGFuIGhhbGYgYml0cyBhcmUgMSkKZm4gZXZhbHVhdGVNYWpvcml0eUZ1bmN0aW9uKGlucHV0OiBpMzIpIC0+IGJvb2wgewogICAgbGV0IG11dCBjb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgdGVtcDogaTMyID0gaW5wdXQ7CgogICAgd2hpbGUgKHRlbXAgPiAwKSB7CiAgICAgICAgaWYgKCh0ZW1wICYgMSkgIT0gMCkgewogICAgICAgICAgICBjb3VudCA9IGNvdW50ICsgMTsKICAgICAgICB9CiAgICAgICAgdGVtcCA9IHRlbXAgLyAyOwogICAgfQoKICAgIHJldHVybiBjb3VudCA+IDQ7IC8vIE1vcmUgdGhhbiBoYWxmIG9mIDggYml0cwp9CgovLyBFdmFsdWF0ZSB0aHJlc2hvbGQgZnVuY3Rpb24gKGF0IGxlYXN0IDMgYml0cyBhcmUgMSkKZm4gZXZhbHVhdGVUaHJlc2hvbGRGdW5jdGlvbihpbnB1dDogaTMyKSAtPiBib29sIHsKICAgIGxldCBtdXQgY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHRlbXA6IGkzMiA9IGlucHV0OwoKICAgIHdoaWxlICh0ZW1wID4gMCkgewogICAgICAgIGlmICgodGVtcCAmIDEpICE9IDApIHsKICAgICAgICAgICAgY291bnQgPSBjb3VudCArIDE7CiAgICAgICAgfQogICAgICAgIHRlbXAgPSB0ZW1wIC8gMjsKICAgIH0KCiAgICByZXR1cm4gY291bnQgPj0gMzsKfQoKLy8gU29sdmUgQm9vbGVhbiBwdXp6bGVzCmZuIHNvbHZlQm9vbGVhblB1enpsZXMoKSAtPiBpMzIgewogICAgbGV0IG11dCBzb2x1dGlvbnM6IGkzMiA9IDA7CgogICAgLy8gU29sdmUgTi1RdWVlbnMgcHJvYmxlbSB1c2luZyBCb29sZWFuIHJlcHJlc2VudGF0aW9uCiAgICBzb2x1dGlvbnMgPSBzb2x1dGlvbnMgKyBzb2x2ZU5RdWVlbnNCb29sZWFuVmVyc2lvbig4KTsKCiAgICAvLyBTb2x2ZSBTdWRva3UtbGlrZSBCb29sZWFuIGNvbnN0cmFpbnQgcHJvYmxlbQogICAgc29sdXRpb25zID0gc29sdXRpb25zICsgc29sdmVCb29sZWFuQ29uc3RyYWludHMoKTsKCiAgICByZXR1cm4gc29sdXRpb25zOwp9CgovLyBTb2x2ZSBOLVF1ZWVucyB1c2luZyBCb29sZWFuIHJlcHJlc2VudGF0aW9uCmZuIHNvbHZlTlF1ZWVuc0Jvb2xlYW5WZXJzaW9uKG46IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgYm9hcmQ6IFtib29sOyA2NF0gPSBbZmFsc2U7IDY0XTsgLy8gOHg4IGJvYXJkCiAgICByZXR1cm4gblF1ZWVuc0JhY2t0cmFjayhib2FyZCwgMCwgbik7Cn0KCi8vIEJhY2t0cmFja2luZyBhbGdvcml0aG0gZm9yIE4tUXVlZW5zIHdpdGggQm9vbGVhbiBib2FyZApmbiBuUXVlZW5zQmFja3RyYWNrKG11dCBib2FyZDogW2Jvb2w7IDY0XSwgcm93OiBpMzIsIG46IGkzMikgLT4gaTMyIHsKICAgIGlmIChyb3cgPT0gbikgewogICAgICAgIHJldHVybiAxOyAvLyBGb3VuZCBhIHNvbHV0aW9uCiAgICB9CgogICAgbGV0IG11dCBzb2x1dGlvbnM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGNvbDogaTMyID0gMDsKCiAgICB3aGlsZSAoY29sIDwgbikgewogICAgICAgIGlmIChpc1NhZmVQb3NpdGlvbihib2FyZCwgcm93LCBjb2wsIG4pKSB7CiAgICAgICAgICAgIGJvYXJkWyhyb3cgKiBuICsgY29sKSBhcyB1c2l6ZV0gPSB0cnVlOwogICAgICAgICAgICBzb2x1dGlvbnMgPSBzb2x1dGlvbnMgKyBuUXVlZW5zQmFja3RyYWNrKGJvYXJkLCByb3cgKyAxLCBuKTsKICAgICAgICAgICAgYm9hcmRbKHJvdyAqIG4gKyBjb2wpIGFzIHVzaXplXSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICBjb2wgPSBjb2wgKyAxOwogICAgfQoKICAgIHJldHVybiBzb2x1dGlvbnM7Cn0KCi8vIENoZWNrIGlmIHBvc2l0aW9uIGlzIHNhZmUgZm9yIHF1ZWVuIHBsYWNlbWVudApmbiBpc1NhZmVQb3NpdGlvbihib2FyZDogW2Jvb2w7IDY0XSwgcm93OiBpMzIsIGNvbDogaTMyLCBuOiBpMzIpIC0+IGJvb2wgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIC8vIENoZWNrIGNvbHVtbgogICAgd2hpbGUgKGkgPCByb3cpIHsKICAgICAgICBpZiAoYm9hcmRbKGkgKiBuICsgY29sKSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gQ2hlY2sgZGlhZ29uYWwgKHVwcGVyIGxlZnQpCiAgICBpID0gcm93IC0gMTsKICAgIGxldCBtdXQgajogaTMyID0gY29sIC0gMTsKICAgIHdoaWxlIChpID49IDAgJiYgaiA+PSAwKSB7CiAgICAgICAgaWYgKGJvYXJkWyhpICogbiArIGopIGFzIHVzaXplXSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGkgPSBpIC0gMTsKICAgICAgICBqID0gaiAtIDE7CiAgICB9CgogICAgLy8gQ2hlY2sgZGlhZ29uYWwgKHVwcGVyIHJpZ2h0KQogICAgaSA9IHJvdyAtIDE7CiAgICBqID0gY29sICsgMTsKICAgIHdoaWxlIChpID49IDAgJiYgaiA8IG4pIHsKICAgICAgICBpZiAoYm9hcmRbKGkgKiBuICsgaikgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgLSAxOwogICAgICAgIGogPSBqICsgMTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKfQoKLy8gU29sdmUgQm9vbGVhbiBjb25zdHJhaW50IHNhdGlzZmFjdGlvbiBwcm9ibGVtCmZuIHNvbHZlQm9vbGVhbkNvbnN0cmFpbnRzKCkgLT4gaTMyIHsKICAgIGxldCBtdXQgc29sdXRpb25fY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGFzc2lnbm1lbnQ6IGkzMiA9IDA7CgogICAgLy8gVHJ5IGFsbCBwb3NzaWJsZSBhc3NpZ25tZW50cyBmb3IgMTYgQm9vbGVhbiB2YXJpYWJsZXMKICAgIHdoaWxlIChhc3NpZ25tZW50IDwgNjU1MzYpIHsKICAgICAgICAvLyAyXjE2CiAgICAgICAgaWYgKHNhdGlzZmllc0FsbEJvb2xlYW5Db25zdHJhaW50cyhhc3NpZ25tZW50KSkgewogICAgICAgICAgICBzb2x1dGlvbl9jb3VudCA9IHNvbHV0aW9uX2NvdW50ICsgMTsKICAgICAgICB9CiAgICAgICAgYXNzaWdubWVudCA9IGFzc2lnbm1lbnQgKyAxOwogICAgfQoKICAgIHJldHVybiBzb2x1dGlvbl9jb3VudDsKfQoKLy8gQ2hlY2sgaWYgYXNzaWdubWVudCBzYXRpc2ZpZXMgYWxsIEJvb2xlYW4gY29uc3RyYWludHMKZm4gc2F0aXNmaWVzQWxsQm9vbGVhbkNvbnN0cmFpbnRzKGFzc2lnbm1lbnQ6IGkzMikgLT4gYm9vbCB7CiAgICAvLyBFeHRyYWN0IDE2IEJvb2xlYW4gdmFyaWFibGVzCiAgICBsZXQgdmFyczogW2Jvb2w7IDE2XSA9IGV4dHJhY3RCb29sZWFuVmFyaWFibGVzKGFzc2lnbm1lbnQpOwoKICAgIC8vIERlZmluZSBjb25zdHJhaW50cwogICAgbGV0IGNvbnN0cmFpbnQxOiBib29sID0gdmFyc1swXSB8fCAoIXZhcnNbMV0gJiYgdmFyc1syXSk7CiAgICBsZXQgY29uc3RyYWludDI6IGJvb2wgPSAhdmFyc1szXSB8fCAodmFyc1s0XSAmJiAhdmFyc1s1XSk7CiAgICBsZXQgY29uc3RyYWludDM6IGJvb2wgPSAodmFyc1s2XSB8fCB2YXJzWzddKSAmJiAoIXZhcnNbOF0gfHwgdmFyc1s5XSk7CiAgICBsZXQgY29uc3RyYWludDQ6IGJvb2wgPSB2YXJzWzEwXSA9PSAodmFyc1sxMV0gJiYgdmFyc1sxMl0pOwogICAgbGV0IGNvbnN0cmFpbnQ1OiBib29sID0gKHZhcnNbMTNdIHx8IHZhcnNbMTRdKSAhPSB2YXJzWzE1XTsKCiAgICByZXR1cm4gY29uc3RyYWludDEgJiYgY29uc3RyYWludDIgJiYgY29uc3RyYWludDMgJiYgY29uc3RyYWludDQgJiYgY29uc3RyYWludDU7Cn0KCi8vIEV4dHJhY3QgQm9vbGVhbiB2YXJpYWJsZXMgZnJvbSBpbnRlZ2VyIGFzc2lnbm1lbnQKZm4gZXh0cmFjdEJvb2xlYW5WYXJpYWJsZXMoYXNzaWdubWVudDogaTMyKSAtPiBbYm9vbDsgMTZdIHsKICAgIGxldCBtdXQgdmFyczogW2Jvb2w7IDE2XSA9IFtmYWxzZTsgMTZdOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgbGV0IG11dCB0ZW1wOiBpMzIgPSBhc3NpZ25tZW50OwoKICAgIHdoaWxlIChpIDwgMTYpIHsKICAgICAgICB2YXJzW2kgYXMgdXNpemVdID0gKHRlbXAgJiAxKSAhPSAwOwogICAgICAgIHRlbXAgPSB0ZW1wIC8gMjsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcmV0dXJuIHZhcnM7Cn0KCi8vIFRlc3QgNDogQm9vbGVhbi1iYXNlZCBTZWFyY2ggYW5kIEZpbHRlcmluZwpmbiB0ZXN0Qm9vbGVhblNlYXJjaEFuZEZpbHRlcigpIHsKICAgIHByaW50bG5JbnQoMTEwNyk7IC8vIFN0YXJ0IEJvb2xlYW4gc2VhcmNoIHRlc3QKCiAgICBsZXQgbXV0IHNlYXJjaF9yZXN1bHRzOiBpMzIgPSAwOwoKICAgIC8vIENyZWF0ZSBsYXJnZSBkYXRhc2V0IGZvciBCb29sZWFuIGZpbHRlcmluZwogICAgbGV0IG11dCBkYXRhOiBbaTMyOyA1MDAwXSA9IFswOyA1MDAwXTsKICAgIGluaXRpYWxpemVTZWFyY2hEYXRhKGRhdGEpOwoKICAgIC8vIFBlcmZvcm0gQm9vbGVhbi1iYXNlZCBmaWx0ZXJpbmcgb3BlcmF0aW9ucwogICAgc2VhcmNoX3Jlc3VsdHMgPSBzZWFyY2hfcmVzdWx0cyArIHBlcmZvcm1Cb29sZWFuRmlsdGVyKGRhdGEpOwogICAgc2VhcmNoX3Jlc3VsdHMgPSBzZWFyY2hfcmVzdWx0cyArIHBlcmZvcm1NdWx0aUNyaXRlcmlhU2VhcmNoKGRhdGEpOwogICAgc2VhcmNoX3Jlc3VsdHMgPSBzZWFyY2hfcmVzdWx0cyArIHBlcmZvcm1Cb29sZWFuUmFuZ2VTZWFyY2goZGF0YSk7CgogICAgcHJpbnRsbkludChzZWFyY2hfcmVzdWx0cyk7CiAgICBwcmludGxuSW50KDExMDgpOyAvLyBFbmQgQm9vbGVhbiBzZWFyY2ggdGVzdAp9CgovLyBJbml0aWFsaXplIHNlYXJjaCBkYXRhCmZuIGluaXRpYWxpemVTZWFyY2hEYXRhKG11dCBkYXRhOiBbaTMyOyA1MDAwXSkgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgbGV0IG11dCBzZWVkOiBpMzIgPSA1NDMyMTsKCiAgICB3aGlsZSAoaSA8IDUwMDApIHsKICAgICAgICBzZWVkID0gcG1fcmFuZF91cGRhdGUoc2VlZCk7CiAgICAgICAgaWYgKHNlZWQgPCAwKSB7CiAgICAgICAgICAgIHNlZWQgPSAtc2VlZDsKICAgICAgICB9CiAgICAgICAgZGF0YVtpIGFzIHVzaXplXSA9IHNlZWQgJSAxMDAwMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIFBlcmZvcm0gQm9vbGVhbi1iYXNlZCBmaWx0ZXJpbmcKZm4gcGVyZm9ybUJvb2xlYW5GaWx0ZXIoZGF0YTogW2kzMjsgNTAwMF0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IGZpbHRlcmVkX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDwgNTAwMCkgewogICAgICAgIGxldCBjb25kaXRpb24xOiBib29sID0gZGF0YVtpIGFzIHVzaXplXSA+IDEwMDA7CiAgICAgICAgbGV0IGNvbmRpdGlvbjI6IGJvb2wgPSBkYXRhW2kgYXMgdXNpemVdICUgMiA9PSAwOwogICAgICAgIGxldCBjb25kaXRpb24zOiBib29sID0gZGF0YVtpIGFzIHVzaXplXSA8IDgwMDA7CiAgICAgICAgbGV0IGNvbmRpdGlvbjQ6IGJvb2wgPSBpc1ByaW1lKGRhdGFbaSBhcyB1c2l6ZV0gJSAxMDApOwoKICAgICAgICAvLyBDb21wbGV4IEJvb2xlYW4gZmlsdGVyIGNvbmRpdGlvbgogICAgICAgIGlmICgoY29uZGl0aW9uMSAmJiBjb25kaXRpb24yKSB8fCAoY29uZGl0aW9uMyAmJiBjb25kaXRpb240KSkgewogICAgICAgICAgICBmaWx0ZXJlZF9jb3VudCA9IGZpbHRlcmVkX2NvdW50ICsgMTsKICAgICAgICB9CgogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gZmlsdGVyZWRfY291bnQ7Cn0KCi8vIFBlcmZvcm0gbXVsdGktY3JpdGVyaWEgQm9vbGVhbiBzZWFyY2gKZm4gcGVyZm9ybU11bHRpQ3JpdGVyaWFTZWFyY2goZGF0YTogW2kzMjsgNTAwMF0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IG1hdGNoX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDwgNTAwMCkgewogICAgICAgIGxldCBjcml0ZXJpYV9tZXQ6IGkzMiA9IGNvdW50Q3JpdGVyaWFNZXQoZGF0YVtpIGFzIHVzaXplXSk7CgogICAgICAgIC8vIEJvb2xlYW4gY29uZGl0aW9uIGJhc2VkIG9uIG51bWJlciBvZiBjcml0ZXJpYSBtZXQKICAgICAgICBpZiAoY3JpdGVyaWFfbWV0ID49IDMpIHsKICAgICAgICAgICAgbWF0Y2hfY291bnQgPSBtYXRjaF9jb3VudCArIDE7CiAgICAgICAgfQoKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcmV0dXJuIG1hdGNoX2NvdW50Owp9CgovLyBDb3VudCBob3cgbWFueSBzZWFyY2ggY3JpdGVyaWEgYXJlIG1ldApmbiBjb3VudENyaXRlcmlhTWV0KHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGNvdW50OiBpMzIgPSAwOwoKICAgIGlmICh2YWx1ZSAlIDMgPT0gMCkgewogICAgICAgIGNvdW50ID0gY291bnQgKyAxOwogICAgfQogICAgaWYgKHZhbHVlID4gNTAwMCkgewogICAgICAgIGNvdW50ID0gY291bnQgKyAxOwogICAgfQogICAgaWYgKHZhbHVlICUgNyA9PSAwKSB7CiAgICAgICAgY291bnQgPSBjb3VudCArIDE7CiAgICB9CiAgICBpZiAodmFsdWUgPCAyMDAwKSB7CiAgICAgICAgY291bnQgPSBjb3VudCArIDE7CiAgICB9CiAgICBpZiAoKHZhbHVlICUgMTAwKSA+IDUwKSB7CiAgICAgICAgY291bnQgPSBjb3VudCArIDE7CiAgICB9CgogICAgcmV0dXJuIGNvdW50Owp9CgovLyBQZXJmb3JtIEJvb2xlYW4gcmFuZ2Ugc2VhcmNoCmZuIHBlcmZvcm1Cb29sZWFuUmFuZ2VTZWFyY2goZGF0YTogW2kzMjsgNTAwMF0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IHJhbmdlX21hdGNoZXM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgd2hpbGUgKGkgPCA1MDAwKSB7CiAgICAgICAgbGV0IGluX3JhbmdlMTogYm9vbCA9IChkYXRhW2kgYXMgdXNpemVdID49IDEwMDApICYmIChkYXRhW2kgYXMgdXNpemVdIDw9IDMwMDApOwogICAgICAgIGxldCBpbl9yYW5nZTI6IGJvb2wgPSAoZGF0YVtpIGFzIHVzaXplXSA+PSA2MDAwKSAmJiAoZGF0YVtpIGFzIHVzaXplXSA8PSA4MDAwKTsKICAgICAgICBsZXQgaW5fcmFuZ2UzOiBib29sID0gKGRhdGFbaSBhcyB1c2l6ZV0gPj0gNTAwKSAmJiAoZGF0YVtpIGFzIHVzaXplXSA8PSAxNTAwKTsKCiAgICAgICAgLy8gQm9vbGVhbiBjb21iaW5hdGlvbiBvZiByYW5nZSBjb25kaXRpb25zCiAgICAgICAgaWYgKGluX3JhbmdlMSB8fCBpbl9yYW5nZTIgfHwgKGluX3JhbmdlMyAmJiAoZGF0YVtpIGFzIHVzaXplXSAlIDIgPT0gMCkpKSB7CiAgICAgICAgICAgIHJhbmdlX21hdGNoZXMgPSByYW5nZV9tYXRjaGVzICsgMTsKICAgICAgICB9CgogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gcmFuZ2VfbWF0Y2hlczsKfQoKLy8gVGVzdCA1OiBCb29sZWFuIFN0YXRlIE1hY2hpbmUgU2ltdWxhdGlvbgpmbiB0ZXN0Qm9vbGVhblN0YXRlTWFjaGluZSgpIHsKICAgIHByaW50bG5JbnQoMTEwOSk7IC8vIFN0YXJ0IHN0YXRlIG1hY2hpbmUgdGVzdAoKICAgIGxldCBtdXQgdHJhbnNpdGlvbnM6IGkzMiA9IDA7CgogICAgLy8gU2ltdWxhdGUgY29tcGxleCBCb29sZWFuIHN0YXRlIG1hY2hpbmUKICAgIHRyYW5zaXRpb25zID0gdHJhbnNpdGlvbnMgKyBzaW11bGF0ZVRyYWZmaWNMaWdodENvbnRyb2xsZXIoKTsKICAgIHRyYW5zaXRpb25zID0gdHJhbnNpdGlvbnMgKyBzaW11bGF0ZURpZ2l0YWxDaXJjdWl0KCk7CiAgICB0cmFuc2l0aW9ucyA9IHRyYW5zaXRpb25zICsgc2ltdWxhdGVCb29sZWFuQXV0b21hdG9uKCk7CgogICAgcHJpbnRsbkludCh0cmFuc2l0aW9ucyk7CiAgICBwcmludGxuSW50KDExMTApOyAvLyBFbmQgc3RhdGUgbWFjaGluZSB0ZXN0Cn0KCi8vIFNpbXVsYXRlIHRyYWZmaWMgbGlnaHQgY29udHJvbGxlciB3aXRoIEJvb2xlYW4gbG9naWMKZm4gc2ltdWxhdGVUcmFmZmljTGlnaHRDb250cm9sbGVyKCkgLT4gaTMyIHsKICAgIGxldCBtdXQgc3RhdGU6IGkzMiA9IDA7IC8vIDA6IFJlZCwgMTogR3JlZW4sIDI6IFllbGxvdwogICAgbGV0IG11dCB0cmFuc2l0aW9uczogaTMyID0gMDsKICAgIGxldCBtdXQgdGltZTogaTMyID0gMDsKCiAgICB3aGlsZSAodGltZSA8IDEwMDAwKSB7CiAgICAgICAgbGV0IHBlZGVzdHJpYW5fYnV0dG9uOiBib29sID0gKHRpbWUgJSAxMDApIDwgMTA7CiAgICAgICAgbGV0IGVtZXJnZW5jeV92ZWhpY2xlOiBib29sID0gKHRpbWUgJSA1MDApIDwgNTsKICAgICAgICBsZXQgdHJhZmZpY19zZW5zb3I6IGJvb2wgPSAodGltZSAlIDUwKSA8IDI1OwoKICAgICAgICBsZXQgb2xkX3N0YXRlOiBpMzIgPSBzdGF0ZTsKICAgICAgICBzdGF0ZSA9IGdldE5leHRUcmFmZmljU3RhdGUoCiAgICAgICAgICAgIHN0YXRlLAogICAgICAgICAgICBwZWRlc3RyaWFuX2J1dHRvbiwKICAgICAgICAgICAgZW1lcmdlbmN5X3ZlaGljbGUsCiAgICAgICAgICAgIHRyYWZmaWNfc2Vuc29yLAogICAgICAgICAgICB0aW1lLAogICAgICAgICk7CgogICAgICAgIGlmIChzdGF0ZSAhPSBvbGRfc3RhdGUpIHsKICAgICAgICAgICAgdHJhbnNpdGlvbnMgPSB0cmFuc2l0aW9ucyArIDE7CiAgICAgICAgfQoKICAgICAgICB0aW1lID0gdGltZSArIDE7CiAgICB9CgogICAgcmV0dXJuIHRyYW5zaXRpb25zOwp9CgovLyBHZXQgbmV4dCB0cmFmZmljIGxpZ2h0IHN0YXRlIGJhc2VkIG9uIEJvb2xlYW4gaW5wdXRzCmZuIGdldE5leHRUcmFmZmljU3RhdGUoCiAgICBjdXJyZW50X3N0YXRlOiBpMzIsCiAgICBwZWRlc3RyaWFuOiBib29sLAogICAgZW1lcmdlbmN5OiBib29sLAogICAgdHJhZmZpYzogYm9vbCwKICAgIHRpbWU6IGkzMiwKKSAtPiBpMzIgewogICAgaWYgKGVtZXJnZW5jeSkgewogICAgICAgIHJldHVybiAxOyAvLyBFbWVyZ2VuY3kgb3ZlcnJpZGUgdG8gZ3JlZW4KICAgIH0KCiAgICBpZiAoY3VycmVudF9zdGF0ZSA9PSAwKSB7CiAgICAgICAgLy8gUmVkCiAgICAgICAgaWYgKCh0aW1lICUgNjApID4gMzAgfHwgKHBlZGVzdHJpYW4gJiYgIXRyYWZmaWMpKSB7CiAgICAgICAgICAgIHJldHVybiAxOyAvLyBDaGFuZ2UgdG8gZ3JlZW4KICAgICAgICB9CiAgICB9IGVsc2UgaWYgKGN1cnJlbnRfc3RhdGUgPT0gMSkgewogICAgICAgIC8vIEdyZWVuCiAgICAgICAgaWYgKCh0aW1lICUgNjApID4gNTAgfHwgKHBlZGVzdHJpYW4gJiYgKHRpbWUgJSAxMjApID4gNjApKSB7CiAgICAgICAgICAgIHJldHVybiAyOyAvLyBDaGFuZ2UgdG8geWVsbG93CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChjdXJyZW50X3N0YXRlID09IDIpIHsKICAgICAgICAvLyBZZWxsb3cKICAgICAgICBpZiAoKHRpbWUgJSA2MCkgPiA1NSkgewogICAgICAgICAgICByZXR1cm4gMDsgLy8gQ2hhbmdlIHRvIHJlZAogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gY3VycmVudF9zdGF0ZTsgLy8gTm8gc3RhdGUgY2hhbmdlCn0KCi8vIFNpbXVsYXRlIGRpZ2l0YWwgY2lyY3VpdCB3aXRoIEJvb2xlYW4gZ2F0ZXMKZm4gc2ltdWxhdGVEaWdpdGFsQ2lyY3VpdCgpIC0+IGkzMiB7CiAgICBsZXQgbXV0IG91dHB1dF9jaGFuZ2VzOiBpMzIgPSAwOwogICAgbGV0IG11dCBjbG9ja19jeWNsZTogaTMyID0gMDsKCiAgICAvLyBJbml0aWFsaXplIEJvb2xlYW4gcmVnaXN0ZXJzCiAgICBsZXQgbXV0IHJlZ19hOiBib29sID0gZmFsc2U7CiAgICBsZXQgbXV0IHJlZ19iOiBib29sID0gZmFsc2U7CiAgICBsZXQgbXV0IHJlZ19jOiBib29sID0gZmFsc2U7CiAgICBsZXQgbXV0IHJlZ19kOiBib29sID0gZmFsc2U7CgogICAgd2hpbGUgKGNsb2NrX2N5Y2xlIDwgMTAwMCkgewogICAgICAgIC8vIEdlbmVyYXRlIEJvb2xlYW4gaW5wdXRzCiAgICAgICAgbGV0IGlucHV0MTogYm9vbCA9IChjbG9ja19jeWNsZSAlIDQpIDwgMjsKICAgICAgICBsZXQgaW5wdXQyOiBib29sID0gKGNsb2NrX2N5Y2xlICUgOCkgPCA0OwogICAgICAgIGxldCBpbnB1dDM6IGJvb2wgPSAoY2xvY2tfY3ljbGUgJSAxNikgPCA4OwoKICAgICAgICAvLyBTYXZlIG9sZCB2YWx1ZXMKICAgICAgICBsZXQgb2xkX2E6IGJvb2wgPSByZWdfYTsKICAgICAgICBsZXQgb2xkX2I6IGJvb2wgPSByZWdfYjsKICAgICAgICBsZXQgb2xkX2M6IGJvb2wgPSByZWdfYzsKICAgICAgICBsZXQgb2xkX2Q6IGJvb2wgPSByZWdfZDsKCiAgICAgICAgLy8gQm9vbGVhbiBsb2dpYyBvcGVyYXRpb25zCiAgICAgICAgcmVnX2EgPSBpbnB1dDEgJiYgaW5wdXQyOwogICAgICAgIHJlZ19iID0gaW5wdXQyIHx8IGlucHV0MzsKICAgICAgICByZWdfYyA9IHJlZ19hICE9IHJlZ19iOyAvLyBYT1Igb3BlcmF0aW9uCiAgICAgICAgcmVnX2QgPSAhKHJlZ19hICYmIHJlZ19iICYmIHJlZ19jKTsKCiAgICAgICAgLy8gQ291bnQgb3V0cHV0IGNoYW5nZXMKICAgICAgICBpZiAob2xkX2EgIT0gcmVnX2EpIHsKICAgICAgICAgICAgb3V0cHV0X2NoYW5nZXMgPSBvdXRwdXRfY2hhbmdlcyArIDE7CiAgICAgICAgfQogICAgICAgIGlmIChvbGRfYiAhPSByZWdfYikgewogICAgICAgICAgICBvdXRwdXRfY2hhbmdlcyA9IG91dHB1dF9jaGFuZ2VzICsgMTsKICAgICAgICB9CiAgICAgICAgaWYgKG9sZF9jICE9IHJlZ19jKSB7CiAgICAgICAgICAgIG91dHB1dF9jaGFuZ2VzID0gb3V0cHV0X2NoYW5nZXMgKyAxOwogICAgICAgIH0KICAgICAgICBpZiAob2xkX2QgIT0gcmVnX2QpIHsKICAgICAgICAgICAgb3V0cHV0X2NoYW5nZXMgPSBvdXRwdXRfY2hhbmdlcyArIDE7CiAgICAgICAgfQoKICAgICAgICBjbG9ja19jeWNsZSA9IGNsb2NrX2N5Y2xlICsgMTsKICAgIH0KCiAgICByZXR1cm4gb3V0cHV0X2NoYW5nZXM7Cn0KCi8vIFNpbXVsYXRlIEJvb2xlYW4gY2VsbHVsYXIgYXV0b21hdG9uCmZuIHNpbXVsYXRlQm9vbGVhbkF1dG9tYXRvbigpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGNlbGxzOiBbYm9vbDsgMTAwXSA9IFtmYWxzZTsgMTAwXTsKICAgIGxldCBtdXQgZ2VuZXJhdGlvbjogaTMyID0gMDsKICAgIGxldCBtdXQgdG90YWxfY2hhbmdlczogaTMyID0gMDsKCiAgICAvLyBJbml0aWFsaXplIHdpdGggc29tZSBCb29sZWFuIHBhdHRlcm4KICAgIGNlbGxzWzQ5XSA9IHRydWU7CiAgICBjZWxsc1s1MF0gPSB0cnVlOwogICAgY2VsbHNbNTFdID0gdHJ1ZTsKCiAgICB3aGlsZSAoZ2VuZXJhdGlvbiA8IDUwMCkgewogICAgICAgIGxldCBtdXQgbmV3X2NlbGxzOiBbYm9vbDsgMTAwXSA9IFtmYWxzZTsgMTAwXTsKICAgICAgICBsZXQgbXV0IGNoYW5nZXM6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAxOwoKICAgICAgICAvLyBBcHBseSBCb29sZWFuIGF1dG9tYXRvbiBydWxlcwogICAgICAgIHdoaWxlIChpIDwgOTkpIHsKICAgICAgICAgICAgbGV0IGxlZnQ6IGJvb2wgPSBjZWxsc1tpIGFzIHVzaXplIC0gMV07CiAgICAgICAgICAgIGxldCBjZW50ZXI6IGJvb2wgPSBjZWxsc1tpIGFzIHVzaXplXTsKICAgICAgICAgICAgbGV0IHJpZ2h0OiBib29sID0gY2VsbHNbaSBhcyB1c2l6ZSArIDFdOwoKICAgICAgICAgICAgLy8gUnVsZSAzMDogQm9vbGVhbiBydWxlIGZvciBjZWxsdWxhciBhdXRvbWF0b24KICAgICAgICAgICAgbmV3X2NlbGxzW2kgYXMgdXNpemVdID0gKGxlZnQgJiYgIWNlbnRlciAmJiAhcmlnaHQpCiAgICAgICAgICAgICAgICB8fCAoIWxlZnQgJiYgY2VudGVyICYmICFyaWdodCkKICAgICAgICAgICAgICAgIHx8ICghbGVmdCAmJiAhY2VudGVyICYmIHJpZ2h0KQogICAgICAgICAgICAgICAgfHwgKCFsZWZ0ICYmIGNlbnRlciAmJiByaWdodCk7CgogICAgICAgICAgICBpZiAobmV3X2NlbGxzW2kgYXMgdXNpemVdICE9IGNlbGxzW2kgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBjaGFuZ2VzID0gY2hhbmdlcyArIDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CgogICAgICAgIC8vIENvcHkgbmV3IGdlbmVyYXRpb24KICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IDEwMCkgewogICAgICAgICAgICBjZWxsc1tpIGFzIHVzaXplXSA9IG5ld19jZWxsc1tpIGFzIHVzaXplXTsKICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KCiAgICAgICAgdG90YWxfY2hhbmdlcyA9IHRvdGFsX2NoYW5nZXMgKyBjaGFuZ2VzOwogICAgICAgIGdlbmVyYXRpb24gPSBnZW5lcmF0aW9uICsgMTsKICAgIH0KCiAgICByZXR1cm4gdG90YWxfY2hhbmdlczsKfQoKLy8gSGVscGVyIGZ1bmN0aW9uOiBDaGVjayBpZiBudW1iZXIgaXMgcHJpbWUgKHVzZWQgaW4gQm9vbGVhbiBjb250ZXh0cykKZm4gaXNQcmltZShuOiBpMzIpIC0+IGJvb2wgewogICAgaWYgKG4gPD0gMSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIGlmIChuIDw9IDMpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIGlmIChuICUgMiA9PSAwIHx8IG4gJSAzID09IDApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgbGV0IG11dCBpOiBpMzIgPSA1OwogICAgd2hpbGUgKGkgKiBpIDw9IG4pIHsKICAgICAgICBpZiAobiAlIGkgPT0gMCB8fCBuICUgKGkgKyAyKSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyA2OwogICAgfQoKICAgIHJldHVybiB0cnVlOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (12, "comprehensive12", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCAxMjogQWR2YW5jZWQgU29ydGluZyBBbGdvcml0aG1zIGFuZCBEYXRhIFN0cnVjdHVyZSBPcGVyYXRpb25zClN1bW1hcnk6IFRoaXMgdGVzdCBpbXBsZW1lbnRzIG11bHRpcGxlIHNvcGhpc3RpY2F0ZWQgc29ydGluZyBhbGdvcml0aG1zIGFuZCBjb21wbGV4IGRhdGEgb3BlcmF0aW9uczoKRGV0YWlsczoKMS4gTWVyZ2UgU29ydCB3aXRoIGRldGFpbGVkIHN0ZXAgdHJhY2tpbmcKMi4gUXVpY2sgU29ydCB3aXRoIDMtd2F5IHBhcnRpdGlvbmluZyAoRHV0Y2ggTmF0aW9uYWwgRmxhZykKMy4gSGVhcCBTb3J0IHdpdGggY29tcGxldGUgYmluYXJ5IGhlYXAgb3BlcmF0aW9ucwo0LiBSYWRpeCBTb3J0IGZvciBpbnRlZ2VyIGFycmF5cwo1LiBCdWNrZXQgU29ydCB3aXRoIGR5bmFtaWMgYnVja2V0IG1hbmFnZW1lbnQKNi4gQWR2YW5jZWQgYXJyYXkgb3BlcmF0aW9ucyBhbmQgYW5hbHlzaXMKKi8KCi8vIENvbXByZWhlbnNpdmUgVGVzdCAxMjogQWR2YW5jZWQgU29ydGluZyBBbGdvcml0aG1zIGFuZCBEYXRhIFN0cnVjdHVyZSBPcGVyYXRpb25zCi8vIFRoaXMgdGVzdCBpbXBsZW1lbnRzIG11bHRpcGxlIHNvcGhpc3RpY2F0ZWQgc29ydGluZyBhbGdvcml0aG1zIGFuZCBjb21wbGV4IGRhdGEgb3BlcmF0aW9uczoKLy8gMS4gTWVyZ2UgU29ydCB3aXRoIGRldGFpbGVkIHN0ZXAgdHJhY2tpbmcKLy8gMi4gUXVpY2sgU29ydCB3aXRoIDMtd2F5IHBhcnRpdGlvbmluZyAoRHV0Y2ggTmF0aW9uYWwgRmxhZykKLy8gMy4gSGVhcCBTb3J0IHdpdGggY29tcGxldGUgYmluYXJ5IGhlYXAgb3BlcmF0aW9ucwovLyA0LiBSYWRpeCBTb3J0IGZvciBpbnRlZ2VyIGFycmF5cwovLyA1LiBCdWNrZXQgU29ydCB3aXRoIGR5bmFtaWMgYnVja2V0IG1hbmFnZW1lbnQKLy8gNi4gQWR2YW5jZWQgYXJyYXkgb3BlcmF0aW9ucyBhbmQgYW5hbHlzaXMKCi8vIFN0cnVjdHVyZSB0byBob2xkIHNvcnRpbmcgc3RhdGlzdGljcyBhbmQgaW50ZXJtZWRpYXRlIHJlc3VsdHMKc3RydWN0IFNvcnRpbmdBbmFseXplciB7CiAgICBkYXRhOiBbaTMyOyAyMDAwXSwKICAgIHRlbXBfYXJyYXk6IFtpMzI7IDIwMDBdLAogICAgc2l6ZTogaTMyLAogICAgY29tcGFyaXNvbnM6IGkzMiwKICAgIHN3YXBzOiBpMzIsCiAgICBtZW1vcnlfb3BlcmF0aW9uczogaTMyLAoKICAgIC8vIEZvciBoZWFwIG9wZXJhdGlvbnMKICAgIGhlYXA6IFtpMzI7IDIwMDBdLAogICAgaGVhcF9zaXplOiBpMzIsCgogICAgLy8gRm9yIHJhZGl4IHNvcnQKICAgIGJ1Y2tldHM6IFtbaTMyOyAyMDBdOyAxMF0sCiAgICBidWNrZXRfc2l6ZXM6IFtpMzI7IDEwXSwKCiAgICAvLyBGb3IgYnVja2V0IHNvcnQKICAgIGJ1Y2tldF9yYW5nZXM6IFtpMzI7IDEwMF0sCiAgICBidWNrZXRfZGF0YTogW1tpMzI7IDUwXTsgMTAwXSwKICAgIGJ1Y2tldF9jb3VudHM6IFtpMzI7IDEwMF0sCiAgICBudW1fYnVja2V0czogaTMyLAoKICAgIC8vIEFuYWx5c2lzIHJlc3VsdHMKICAgIHNvcnRfdGltZXM6IFtpMzI7IDEwXSwKICAgIGFsZ29yaXRobV9lZmZpY2llbmN5OiBbaTMyOyAxMF0sCn0KCmltcGwgU29ydGluZ0FuYWx5emVyIHsKICAgIGZuIG5ldygpIC0+IFNvcnRpbmdBbmFseXplciB7CiAgICAgICAgU29ydGluZ0FuYWx5emVyIHsKICAgICAgICAgICAgZGF0YTogWzA7IDIwMDBdLAogICAgICAgICAgICB0ZW1wX2FycmF5OiBbMDsgMjAwMF0sCiAgICAgICAgICAgIHNpemU6IDAsCiAgICAgICAgICAgIGNvbXBhcmlzb25zOiAwLAogICAgICAgICAgICBzd2FwczogMCwKICAgICAgICAgICAgbWVtb3J5X29wZXJhdGlvbnM6IDAsCiAgICAgICAgICAgIGhlYXA6IFswOyAyMDAwXSwKICAgICAgICAgICAgaGVhcF9zaXplOiAwLAogICAgICAgICAgICBidWNrZXRzOiBbWzA7IDIwMF07IDEwXSwKICAgICAgICAgICAgYnVja2V0X3NpemVzOiBbMDsgMTBdLAogICAgICAgICAgICBidWNrZXRfcmFuZ2VzOiBbMDsgMTAwXSwKICAgICAgICAgICAgYnVja2V0X2RhdGE6IFtbMDsgNTBdOyAxMDBdLAogICAgICAgICAgICBidWNrZXRfY291bnRzOiBbMDsgMTAwXSwKICAgICAgICAgICAgbnVtX2J1Y2tldHM6IDAsCiAgICAgICAgICAgIHNvcnRfdGltZXM6IFswOyAxMF0sCiAgICAgICAgICAgIGFsZ29yaXRobV9lZmZpY2llbmN5OiBbMDsgMTBdLAogICAgICAgIH0KICAgIH0KCiAgICAvLyBJbml0aWFsaXplIGRhdGEgYXJyYXkgd2l0aCBpbnB1dAogICAgZm4gaW5pdGlhbGl6ZV9kYXRhKCZtdXQgc2VsZiwgc2l6ZTogaTMyKSB7CiAgICAgICAgc2VsZi5zaXplID0gc2l6ZTsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgICAgIHNlbGYuZGF0YVtpIGFzIHVzaXplXSA9IGdldEludCgpOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgICAgIHNlbGYucmVzZXRfc3RhdGlzdGljcygpOwogICAgfQoKICAgIC8vIFJlc2V0IHNvcnRpbmcgc3RhdGlzdGljcwogICAgZm4gcmVzZXRfc3RhdGlzdGljcygmbXV0IHNlbGYpIHsKICAgICAgICBzZWxmLmNvbXBhcmlzb25zID0gMDsKICAgICAgICBzZWxmLnN3YXBzID0gMDsKICAgICAgICBzZWxmLm1lbW9yeV9vcGVyYXRpb25zID0gMDsKICAgIH0KCiAgICAvLyBDb3B5IGRhdGEgZm9yIGluZGVwZW5kZW50IHNvcnRpbmcgdGVzdHMKICAgIGZuIGNvcHlfdG9fdGVtcCgmbXV0IHNlbGYpIHsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLnNpemUpIHsKICAgICAgICAgICAgc2VsZi50ZW1wX2FycmF5W2kgYXMgdXNpemVdID0gc2VsZi5kYXRhW2kgYXMgdXNpemVdOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgICAgIHNlbGYubWVtb3J5X29wZXJhdGlvbnMgKz0gc2VsZi5zaXplOwogICAgfQoKICAgIC8vIFJlc3RvcmUgZGF0YSBmcm9tIHRlbXAgYXJyYXkKICAgIGZuIHJlc3RvcmVfZnJvbV90ZW1wKCZtdXQgc2VsZikgewogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuc2l6ZSkgewogICAgICAgICAgICBzZWxmLmRhdGFbaSBhcyB1c2l6ZV0gPSBzZWxmLnRlbXBfYXJyYXlbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CiAgICAgICAgc2VsZi5tZW1vcnlfb3BlcmF0aW9ucyArPSBzZWxmLnNpemU7CiAgICB9CgogICAgLy8gRW5oYW5jZWQgbWVyZ2Ugc29ydCB3aXRoIGRldGFpbGVkIHRyYWNraW5nCiAgICBmbiBtZXJnZV9zb3J0KCZtdXQgc2VsZiwgbGVmdDogaTMyLCByaWdodDogaTMyKSB7CiAgICAgICAgaWYgKGxlZnQgPCByaWdodCkgewogICAgICAgICAgICBsZXQgbWlkOiBpMzIgPSBsZWZ0ICsgKHJpZ2h0IC0gbGVmdCkgLyAyOwoKICAgICAgICAgICAgLy8gUmVjdXJzaXZlIGNhbGxzCiAgICAgICAgICAgIHNlbGYubWVyZ2Vfc29ydChsZWZ0LCBtaWQpOwogICAgICAgICAgICBzZWxmLm1lcmdlX3NvcnQobWlkICsgMSwgcmlnaHQpOwoKICAgICAgICAgICAgLy8gTWVyZ2UgdGhlIHNvcnRlZCBoYWx2ZXMKICAgICAgICAgICAgc2VsZi5tZXJnZShsZWZ0LCBtaWQsIHJpZ2h0KTsKICAgICAgICB9CiAgICB9CgogICAgZm4gbWVyZ2UoJm11dCBzZWxmLCBsZWZ0OiBpMzIsIG1pZDogaTMyLCByaWdodDogaTMyKSB7CiAgICAgICAgbGV0IG4xOiBpMzIgPSBtaWQgLSBsZWZ0ICsgMTsKICAgICAgICBsZXQgbjI6IGkzMiA9IHJpZ2h0IC0gbWlkOwoKICAgICAgICAvLyBDcmVhdGUgdGVtcG9yYXJ5IGFycmF5cyBmb3IgbWVyZ2luZwogICAgICAgIGxldCBtdXQgbGVmdF9hcnI6IFtpMzI7IDEwMDBdID0gWzA7IDEwMDBdOwogICAgICAgIGxldCBtdXQgcmlnaHRfYXJyOiBbaTMyOyAxMDAwXSA9IFswOyAxMDAwXTsKCiAgICAgICAgLy8gQ29weSBkYXRhIHRvIHRlbXBvcmFyeSBhcnJheXMKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBuMSkgewogICAgICAgICAgICBsZWZ0X2FycltpIGFzIHVzaXplXSA9IHNlbGYuZGF0YVsobGVmdCArIGkpIGFzIHVzaXplXTsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgbjIpIHsKICAgICAgICAgICAgcmlnaHRfYXJyW2ogYXMgdXNpemVdID0gc2VsZi5kYXRhWyhtaWQgKyAxICsgaikgYXMgdXNpemVdOwogICAgICAgICAgICBqICs9IDE7CiAgICAgICAgfQoKICAgICAgICBzZWxmLm1lbW9yeV9vcGVyYXRpb25zICs9IG4xICsgbjI7CgogICAgICAgIC8vIE1lcmdlIHRoZSB0ZW1wb3JhcnkgYXJyYXlzIGJhY2sKICAgICAgICBpID0gMDsKICAgICAgICBqID0gMDsKICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IGxlZnQ7CgogICAgICAgIHdoaWxlIChpIDwgbjEgJiYgaiA8IG4yKSB7CiAgICAgICAgICAgIHNlbGYuY29tcGFyaXNvbnMgKz0gMTsKICAgICAgICAgICAgaWYgKGxlZnRfYXJyW2kgYXMgdXNpemVdIDw9IHJpZ2h0X2FycltqIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgc2VsZi5kYXRhW2sgYXMgdXNpemVdID0gbGVmdF9hcnJbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBpICs9IDE7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzZWxmLmRhdGFbayBhcyB1c2l6ZV0gPSByaWdodF9hcnJbaiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgayArPSAxOwogICAgICAgICAgICBzZWxmLm1lbW9yeV9vcGVyYXRpb25zICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBDb3B5IHJlbWFpbmluZyBlbGVtZW50cwogICAgICAgIHdoaWxlIChpIDwgbjEpIHsKICAgICAgICAgICAgc2VsZi5kYXRhW2sgYXMgdXNpemVdID0gbGVmdF9hcnJbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICAgICAgayArPSAxOwogICAgICAgICAgICBzZWxmLm1lbW9yeV9vcGVyYXRpb25zICs9IDE7CiAgICAgICAgfQoKICAgICAgICB3aGlsZSAoaiA8IG4yKSB7CiAgICAgICAgICAgIHNlbGYuZGF0YVtrIGFzIHVzaXplXSA9IHJpZ2h0X2FycltqIGFzIHVzaXplXTsKICAgICAgICAgICAgaiArPSAxOwogICAgICAgICAgICBrICs9IDE7CiAgICAgICAgICAgIHNlbGYubWVtb3J5X29wZXJhdGlvbnMgKz0gMTsKICAgICAgICB9CiAgICB9CgogICAgLy8gQWR2YW5jZWQgcXVpY2sgc29ydCB3aXRoIDMtd2F5IHBhcnRpdGlvbmluZwogICAgZm4gcXVpY2tfc29ydF8zd2F5KCZtdXQgc2VsZiwgbG93OiBpMzIsIGhpZ2g6IGkzMikgewogICAgICAgIGlmIChsb3cgPCBoaWdoKSB7CiAgICAgICAgICAgIGxldCBtdXQgbHQ6IGkzMiA9IGxvdzsKICAgICAgICAgICAgbGV0IG11dCBndDogaTMyID0gaGlnaDsKICAgICAgICAgICAgbGV0IG11dCBpOiBpMzIgPSBsb3cgKyAxOwogICAgICAgICAgICBsZXQgcGl2b3Q6IGkzMiA9IHNlbGYuZGF0YVtsb3cgYXMgdXNpemVdOwoKICAgICAgICAgICAgLy8gMy13YXkgcGFydGl0aW9uaW5nCiAgICAgICAgICAgIHdoaWxlIChpIDw9IGd0KSB7CiAgICAgICAgICAgICAgICBzZWxmLmNvbXBhcmlzb25zICs9IDE7CiAgICAgICAgICAgICAgICBpZiAoc2VsZi5kYXRhW2kgYXMgdXNpemVdIDwgcGl2b3QpIHsKICAgICAgICAgICAgICAgICAgICBzZWxmLnN3YXBfZWxlbWVudHMobHQsIGkpOwogICAgICAgICAgICAgICAgICAgIGx0ICs9IDE7CiAgICAgICAgICAgICAgICAgICAgaSArPSAxOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzZWxmLmRhdGFbaSBhcyB1c2l6ZV0gPiBwaXZvdCkgewogICAgICAgICAgICAgICAgICAgIHNlbGYuc3dhcF9lbGVtZW50cyhpLCBndCk7CiAgICAgICAgICAgICAgICAgICAgZ3QgLT0gMTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaSArPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBSZWN1cnNpdmUgY2FsbHMgZm9yIGVsZW1lbnRzIGxlc3MgdGhhbiBhbmQgZ3JlYXRlciB0aGFuIHBpdm90CiAgICAgICAgICAgIHNlbGYucXVpY2tfc29ydF8zd2F5KGxvdywgbHQgLSAxKTsKICAgICAgICAgICAgc2VsZi5xdWlja19zb3J0XzN3YXkoZ3QgKyAxLCBoaWdoKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gU3dhcCB0d28gZWxlbWVudHMgaW4gdGhlIGFycmF5CiAgICBmbiBzd2FwX2VsZW1lbnRzKCZtdXQgc2VsZiwgaTogaTMyLCBqOiBpMzIpIHsKICAgICAgICBsZXQgdGVtcDogaTMyID0gc2VsZi5kYXRhW2kgYXMgdXNpemVdOwogICAgICAgIHNlbGYuZGF0YVtpIGFzIHVzaXplXSA9IHNlbGYuZGF0YVtqIGFzIHVzaXplXTsKICAgICAgICBzZWxmLmRhdGFbaiBhcyB1c2l6ZV0gPSB0ZW1wOwogICAgICAgIHNlbGYuc3dhcHMgKz0gMTsKICAgICAgICBzZWxmLm1lbW9yeV9vcGVyYXRpb25zICs9IDM7CiAgICB9CgogICAgLy8gQ29tcGxldGUgaGVhcCBzb3J0IGltcGxlbWVudGF0aW9uCiAgICBmbiBoZWFwX3NvcnQoJm11dCBzZWxmKSB7CiAgICAgICAgLy8gQnVpbGQgbWF4IGhlYXAKICAgICAgICBzZWxmLmJ1aWxkX21heF9oZWFwKCk7CgogICAgICAgIC8vIEV4dHJhY3QgZWxlbWVudHMgZnJvbSBoZWFwIG9uZSBieSBvbmUKICAgICAgICBsZXQgbXV0IGhlYXBfZW5kOiBpMzIgPSBzZWxmLnNpemUgLSAxOwogICAgICAgIHdoaWxlIChoZWFwX2VuZCA+IDApIHsKICAgICAgICAgICAgc2VsZi5zd2FwX2VsZW1lbnRzKDAsIGhlYXBfZW5kKTsKICAgICAgICAgICAgaGVhcF9lbmQgLT0gMTsKICAgICAgICAgICAgc2VsZi5tYXhfaGVhcGlmeSgwLCBoZWFwX2VuZCArIDEpOwogICAgICAgIH0KICAgIH0KCiAgICBmbiBidWlsZF9tYXhfaGVhcCgmbXV0IHNlbGYpIHsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IHNlbGYuc2l6ZSAvIDIgLSAxOwogICAgICAgIHdoaWxlIChpID49IDApIHsKICAgICAgICAgICAgc2VsZi5tYXhfaGVhcGlmeShpLCBzZWxmLnNpemUpOwogICAgICAgICAgICBpIC09IDE7CiAgICAgICAgfQogICAgfQoKICAgIGZuIG1heF9oZWFwaWZ5KCZtdXQgc2VsZiwgcm9vdDogaTMyLCBoZWFwX3NpemU6IGkzMikgewogICAgICAgIGxldCBsZWZ0OiBpMzIgPSAyICogcm9vdCArIDE7CiAgICAgICAgbGV0IHJpZ2h0OiBpMzIgPSAyICogcm9vdCArIDI7CiAgICAgICAgbGV0IG11dCBsYXJnZXN0OiBpMzIgPSByb290OwoKICAgICAgICBzZWxmLmNvbXBhcmlzb25zICs9IDE7CiAgICAgICAgaWYgKGxlZnQgPCBoZWFwX3NpemUgJiYgc2VsZi5kYXRhW2xlZnQgYXMgdXNpemVdID4gc2VsZi5kYXRhW2xhcmdlc3QgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIGxhcmdlc3QgPSBsZWZ0OwogICAgICAgIH0KCiAgICAgICAgc2VsZi5jb21wYXJpc29ucyArPSAxOwogICAgICAgIGlmIChyaWdodCA8IGhlYXBfc2l6ZSAmJiBzZWxmLmRhdGFbcmlnaHQgYXMgdXNpemVdID4gc2VsZi5kYXRhW2xhcmdlc3QgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIGxhcmdlc3QgPSByaWdodDsKICAgICAgICB9CgogICAgICAgIGlmIChsYXJnZXN0ICE9IHJvb3QpIHsKICAgICAgICAgICAgc2VsZi5zd2FwX2VsZW1lbnRzKHJvb3QsIGxhcmdlc3QpOwogICAgICAgICAgICBzZWxmLm1heF9oZWFwaWZ5KGxhcmdlc3QsIGhlYXBfc2l6ZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFJhZGl4IHNvcnQgaW1wbGVtZW50YXRpb24KICAgIGZuIHJhZGl4X3NvcnQoJm11dCBzZWxmKSB7CiAgICAgICAgLy8gRmluZCBtYXhpbXVtIG51bWJlciB0byBrbm93IG51bWJlciBvZiBkaWdpdHMKICAgICAgICBsZXQgbWF4X3ZhbDogaTMyID0gc2VsZi5maW5kX21heGltdW0oKTsKCiAgICAgICAgLy8gRG8gY291bnRpbmcgc29ydCBmb3IgZXZlcnkgZGlnaXQKICAgICAgICBsZXQgbXV0IGV4cDogaTMyID0gMTsKICAgICAgICB3aGlsZSAobWF4X3ZhbCAvIGV4cCA+IDApIHsKICAgICAgICAgICAgc2VsZi5jb3VudGluZ19zb3J0X2J5X2RpZ2l0KGV4cCk7CiAgICAgICAgICAgIGV4cCAqPSAxMDsKICAgICAgICB9CiAgICB9CgogICAgZm4gZmluZF9tYXhpbXVtKCZzZWxmKSAtPiBpMzIgewogICAgICAgIGxldCBtdXQgbWF4X3ZhbDogaTMyID0gc2VsZi5kYXRhWzBdOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMTsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuc2l6ZSkgewogICAgICAgICAgICBpZiAoc2VsZi5kYXRhW2kgYXMgdXNpemVdID4gbWF4X3ZhbCkgewogICAgICAgICAgICAgICAgbWF4X3ZhbCA9IHNlbGYuZGF0YVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgICAgIHJldHVybiBtYXhfdmFsOwogICAgfQoKICAgIGZuIGNvdW50aW5nX3NvcnRfYnlfZGlnaXQoJm11dCBzZWxmLCBleHA6IGkzMikgewogICAgICAgIGxldCBtdXQgb3V0cHV0OiBbaTMyOyAyMDAwXSA9IFswOyAyMDAwXTsKICAgICAgICBsZXQgbXV0IGNvdW50OiBbaTMyOyAxMF0gPSBbMDsgMTBdOwoKICAgICAgICAvLyBDb3VudCBvY2N1cnJlbmNlcyBvZiBlYWNoIGRpZ2l0CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi5zaXplKSB7CiAgICAgICAgICAgIGxldCBkaWdpdDogaTMyID0gKHNlbGYuZGF0YVtpIGFzIHVzaXplXSAvIGV4cCkgJSAxMDsKICAgICAgICAgICAgY291bnRbZGlnaXQgYXMgdXNpemVdICs9IDE7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIENoYW5nZSBjb3VudFtpXSB0byBhY3R1YWwgcG9zaXRpb24gb2YgdGhpcyBkaWdpdCBpbiBvdXRwdXRbXQogICAgICAgIGkgPSAxOwogICAgICAgIHdoaWxlIChpIDwgMTApIHsKICAgICAgICAgICAgY291bnRbaSBhcyB1c2l6ZV0gKz0gY291bnRbKGkgLSAxKSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIEJ1aWxkIHRoZSBvdXRwdXQgYXJyYXkKICAgICAgICBpID0gc2VsZi5zaXplIC0gMTsKICAgICAgICB3aGlsZSAoaSA+PSAwKSB7CiAgICAgICAgICAgIGxldCBkaWdpdDogaTMyID0gKHNlbGYuZGF0YVtpIGFzIHVzaXplXSAvIGV4cCkgJSAxMDsKICAgICAgICAgICAgY291bnRbZGlnaXQgYXMgdXNpemVdIC09IDE7CiAgICAgICAgICAgIG91dHB1dFtjb3VudFtkaWdpdCBhcyB1c2l6ZV0gYXMgdXNpemVdID0gc2VsZi5kYXRhW2kgYXMgdXNpemVdOwogICAgICAgICAgICBpIC09IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBDb3B5IHRoZSBvdXRwdXQgYXJyYXkgYmFjayB0byBkYXRhCiAgICAgICAgaSA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLnNpemUpIHsKICAgICAgICAgICAgc2VsZi5kYXRhW2kgYXMgdXNpemVdID0gb3V0cHV0W2kgYXMgdXNpemVdOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBzZWxmLm1lbW9yeV9vcGVyYXRpb25zICs9IHNlbGYuc2l6ZSAqIDM7CiAgICB9CgogICAgLy8gQWR2YW5jZWQgYnVja2V0IHNvcnQgd2l0aCBkeW5hbWljIGJ1Y2tldCBtYW5hZ2VtZW50CiAgICBmbiBidWNrZXRfc29ydCgmbXV0IHNlbGYpIHsKICAgICAgICBpZiAoc2VsZi5zaXplIDw9IDEpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gRmluZCBtaW4gYW5kIG1heCB2YWx1ZXMgZm9yIGJ1Y2tldCByYW5nZSBjYWxjdWxhdGlvbgogICAgICAgIGxldCBtdXQgbWluX3ZhbDogaTMyID0gc2VsZi5kYXRhWzBdOwogICAgICAgIGxldCBtdXQgbWF4X3ZhbDogaTMyID0gc2VsZi5kYXRhWzBdOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMTsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuc2l6ZSkgewogICAgICAgICAgICBpZiAoc2VsZi5kYXRhW2kgYXMgdXNpemVdIDwgbWluX3ZhbCkgewogICAgICAgICAgICAgICAgbWluX3ZhbCA9IHNlbGYuZGF0YVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc2VsZi5kYXRhW2kgYXMgdXNpemVdID4gbWF4X3ZhbCkgewogICAgICAgICAgICAgICAgbWF4X3ZhbCA9IHNlbGYuZGF0YVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBDYWxjdWxhdGUgbnVtYmVyIG9mIGJ1Y2tldHMgYW5kIHJhbmdlCiAgICAgICAgc2VsZi5udW1fYnVja2V0cyA9IHNlbGYuc2l6ZSAvIDQ7IC8vIE9wdGltaXplIGJ1Y2tldCBjb3VudAogICAgICAgIGlmIChzZWxmLm51bV9idWNrZXRzID4gOTkpIHsKICAgICAgICAgICAgc2VsZi5udW1fYnVja2V0cyA9IDk5OwogICAgICAgIH0KICAgICAgICBpZiAoc2VsZi5udW1fYnVja2V0cyA8IDEpIHsKICAgICAgICAgICAgc2VsZi5udW1fYnVja2V0cyA9IDE7CiAgICAgICAgfQoKICAgICAgICBsZXQgcmFuZ2U6IGkzMiA9IG1heF92YWwgLSBtaW5fdmFsICsgMTsKICAgICAgICBsZXQgYnVja2V0X3JhbmdlOiBpMzIgPSByYW5nZSAvIHNlbGYubnVtX2J1Y2tldHMgKyAxOwoKICAgICAgICAvLyBJbml0aWFsaXplIGJ1Y2tldHMKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYubnVtX2J1Y2tldHMpIHsKICAgICAgICAgICAgc2VsZi5idWNrZXRfY291bnRzW2kgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gRGlzdHJpYnV0ZSBlbGVtZW50cyBpbnRvIGJ1Y2tldHMKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuc2l6ZSkgewogICAgICAgICAgICBsZXQgYnVja2V0X2luZGV4OiBpMzIgPSAoc2VsZi5kYXRhW2kgYXMgdXNpemVdIC0gbWluX3ZhbCkgLyBidWNrZXRfcmFuZ2U7CiAgICAgICAgICAgIGlmIChidWNrZXRfaW5kZXggPj0gc2VsZi5udW1fYnVja2V0cykgewogICAgICAgICAgICAgICAgLy8gSGFuZGxlIGVkZ2UgY2FzZSBmb3IgbWF4aW11bSB2YWx1ZQogICAgICAgICAgICAgICAgbGV0IGFkanVzdGVkX2luZGV4OiBpMzIgPSBzZWxmLm51bV9idWNrZXRzIC0gMTsKICAgICAgICAgICAgICAgIHNlbGYuYnVja2V0X2RhdGFbYWRqdXN0ZWRfaW5kZXggYXMgdXNpemVdCiAgICAgICAgICAgICAgICAgICAgW3NlbGYuYnVja2V0X2NvdW50c1thZGp1c3RlZF9pbmRleCBhcyB1c2l6ZV0gYXMgdXNpemVdID0gc2VsZi5kYXRhW2kgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgc2VsZi5idWNrZXRfY291bnRzW2FkanVzdGVkX2luZGV4IGFzIHVzaXplXSArPSAxOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc2VsZi5idWNrZXRfZGF0YVtidWNrZXRfaW5kZXggYXMgdXNpemVdCiAgICAgICAgICAgICAgICAgICAgW3NlbGYuYnVja2V0X2NvdW50c1tidWNrZXRfaW5kZXggYXMgdXNpemVdIGFzIHVzaXplXSA9IHNlbGYuZGF0YVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIHNlbGYuYnVja2V0X2NvdW50c1tidWNrZXRfaW5kZXggYXMgdXNpemVdICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gU29ydCBpbmRpdmlkdWFsIGJ1Y2tldHMgdXNpbmcgaW5zZXJ0aW9uIHNvcnQKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYubnVtX2J1Y2tldHMpIHsKICAgICAgICAgICAgc2VsZi5pbnNlcnRpb25fc29ydF9idWNrZXQoaSk7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIENvbmNhdGVuYXRlIGFsbCBidWNrZXRzIGJhY2sgdG8gbWFpbiBhcnJheQogICAgICAgIGxldCBtdXQgaW5kZXg6IGkzMiA9IDA7CiAgICAgICAgaSA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLm51bV9idWNrZXRzKSB7CiAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKGogPCBzZWxmLmJ1Y2tldF9jb3VudHNbaSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIHNlbGYuZGF0YVtpbmRleCBhcyB1c2l6ZV0gPSBzZWxmLmJ1Y2tldF9kYXRhW2kgYXMgdXNpemVdW2ogYXMgdXNpemVdOwogICAgICAgICAgICAgICAgaW5kZXggKz0gMTsKICAgICAgICAgICAgICAgIGogKz0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBzZWxmLm1lbW9yeV9vcGVyYXRpb25zICs9IHNlbGYuc2l6ZSAqIDI7CiAgICB9CgogICAgZm4gaW5zZXJ0aW9uX3NvcnRfYnVja2V0KCZtdXQgc2VsZiwgYnVja2V0X2luZGV4OiBpMzIpIHsKICAgICAgICBsZXQgY291bnQ6IGkzMiA9IHNlbGYuYnVja2V0X2NvdW50c1tidWNrZXRfaW5kZXggYXMgdXNpemVdOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMTsKICAgICAgICB3aGlsZSAoaSA8IGNvdW50KSB7CiAgICAgICAgICAgIGxldCBrZXk6IGkzMiA9IHNlbGYuYnVja2V0X2RhdGFbYnVja2V0X2luZGV4IGFzIHVzaXplXVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSBpIC0gMTsKCiAgICAgICAgICAgIHdoaWxlIChqID49IDAgJiYgc2VsZi5idWNrZXRfZGF0YVtidWNrZXRfaW5kZXggYXMgdXNpemVdW2ogYXMgdXNpemVdID4ga2V5KSB7CiAgICAgICAgICAgICAgICBzZWxmLmJ1Y2tldF9kYXRhW2J1Y2tldF9pbmRleCBhcyB1c2l6ZV1bKGogKyAxKSBhcyB1c2l6ZV0gPQogICAgICAgICAgICAgICAgICAgIHNlbGYuYnVja2V0X2RhdGFbYnVja2V0X2luZGV4IGFzIHVzaXplXVtqIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGogLT0gMTsKICAgICAgICAgICAgICAgIHNlbGYuY29tcGFyaXNvbnMgKz0gMTsKICAgICAgICAgICAgICAgIHNlbGYubWVtb3J5X29wZXJhdGlvbnMgKz0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc2VsZi5idWNrZXRfZGF0YVtidWNrZXRfaW5kZXggYXMgdXNpemVdWyhqICsgMSkgYXMgdXNpemVdID0ga2V5OwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgICAgIHNlbGYubWVtb3J5X29wZXJhdGlvbnMgKz0gMTsKICAgICAgICB9CiAgICB9CgogICAgLy8gQWR2YW5jZWQgYXJyYXkgYW5hbHlzaXMgZnVuY3Rpb25zCiAgICBmbiBhbmFseXplX3NvcnRlZF9hcnJheSgmbXV0IHNlbGYpIC0+IGkzMiB7CiAgICAgICAgbGV0IG11dCBhbmFseXNpc19zY29yZTogaTMyID0gMDsKCiAgICAgICAgLy8gQ2hlY2sgaWYgYXJyYXkgaXMgcHJvcGVybHkgc29ydGVkCiAgICAgICAgbGV0IG11dCBpc19zb3J0ZWQ6IGJvb2wgPSB0cnVlOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMTsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuc2l6ZSkgewogICAgICAgICAgICBpZiAoc2VsZi5kYXRhW2kgYXMgdXNpemVdIDwgc2VsZi5kYXRhWyhpIC0gMSkgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBpc19zb3J0ZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIGlmIChpc19zb3J0ZWQpIHsKICAgICAgICAgICAgYW5hbHlzaXNfc2NvcmUgKz0gMTAwMDsKICAgICAgICB9CgogICAgICAgIC8vIENhbGN1bGF0ZSB2YXJpb3VzIG1ldHJpY3MKICAgICAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IHVuaXF1ZV9jb3VudDogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IGR1cGxpY2F0ZXM6IGkzMiA9IDA7CgogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi5zaXplKSB7CiAgICAgICAgICAgIHN1bSArPSBzZWxmLmRhdGFbaSBhcyB1c2l6ZV07CgogICAgICAgICAgICAvLyBDb3VudCB1bmlxdWUgZWxlbWVudHMgYW5kIGR1cGxpY2F0ZXMKICAgICAgICAgICAgaWYgKGkgPT0gMCB8fCBzZWxmLmRhdGFbaSBhcyB1c2l6ZV0gIT0gc2VsZi5kYXRhWyhpIC0gMSkgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICB1bmlxdWVfY291bnQgKz0gMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGR1cGxpY2F0ZXMgKz0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBhbmFseXNpc19zY29yZSArPSB1bmlxdWVfY291bnQgKiAxMCArIGR1cGxpY2F0ZXMgKiA1OwoKICAgICAgICAvLyBDYWxjdWxhdGUgbWVkaWFuIGFuZCBvdGhlciBzdGF0aXN0aWNhbCBtZWFzdXJlcwogICAgICAgIGxldCBtZWRpYW46IGkzMiA9IGlmIChzZWxmLnNpemUgJSAyID09IDApIHsKICAgICAgICAgICAgKHNlbGYuZGF0YVsoc2VsZi5zaXplIC8gMiAtIDEpIGFzIHVzaXplXSArIHNlbGYuZGF0YVsoc2VsZi5zaXplIC8gMikgYXMgdXNpemVdKSAvIDIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZWxmLmRhdGFbKHNlbGYuc2l6ZSAvIDIpIGFzIHVzaXplXQogICAgICAgIH07CgogICAgICAgIGFuYWx5c2lzX3Njb3JlICs9IG1lZGlhbjsKCiAgICAgICAgcmV0dXJuIGFuYWx5c2lzX3Njb3JlOwogICAgfQoKICAgIC8vIENvbXByZWhlbnNpdmUgc29ydGluZyB0ZXN0IHN1aXRlCiAgICBmbiBydW5fY29tcHJlaGVuc2l2ZV90ZXN0cygmbXV0IHNlbGYpIHsKICAgICAgICBwcmludGxuSW50KHNlbGYuc2l6ZSk7CgogICAgICAgIC8vIFRlc3QgMTogTWVyZ2UgU29ydAogICAgICAgIHNlbGYuY29weV90b190ZW1wKCk7CiAgICAgICAgc2VsZi5yZXNldF9zdGF0aXN0aWNzKCk7CiAgICAgICAgc2VsZi5tZXJnZV9zb3J0KDAsIHNlbGYuc2l6ZSAtIDEpOwogICAgICAgIHNlbGYuc29ydF90aW1lc1swXSA9IHNlbGYuY29tcGFyaXNvbnMgKyBzZWxmLnN3YXBzOwogICAgICAgIHNlbGYuYWxnb3JpdGhtX2VmZmljaWVuY3lbMF0gPSBzZWxmLmFuYWx5emVfc29ydGVkX2FycmF5KCk7CiAgICAgICAgcHJpbnRsbkludChzZWxmLmFsZ29yaXRobV9lZmZpY2llbmN5WzBdKTsKCiAgICAgICAgLy8gVGVzdCAyOiBRdWljayBTb3J0IHdpdGggMy13YXkgcGFydGl0aW9uaW5nCiAgICAgICAgc2VsZi5yZXN0b3JlX2Zyb21fdGVtcCgpOwogICAgICAgIHNlbGYucmVzZXRfc3RhdGlzdGljcygpOwogICAgICAgIHNlbGYucXVpY2tfc29ydF8zd2F5KDAsIHNlbGYuc2l6ZSAtIDEpOwogICAgICAgIHNlbGYuc29ydF90aW1lc1sxXSA9IHNlbGYuY29tcGFyaXNvbnMgKyBzZWxmLnN3YXBzOwogICAgICAgIHNlbGYuYWxnb3JpdGhtX2VmZmljaWVuY3lbMV0gPSBzZWxmLmFuYWx5emVfc29ydGVkX2FycmF5KCk7CiAgICAgICAgcHJpbnRsbkludChzZWxmLmFsZ29yaXRobV9lZmZpY2llbmN5WzFdKTsKCiAgICAgICAgLy8gVGVzdCAzOiBIZWFwIFNvcnQKICAgICAgICBzZWxmLnJlc3RvcmVfZnJvbV90ZW1wKCk7CiAgICAgICAgc2VsZi5yZXNldF9zdGF0aXN0aWNzKCk7CiAgICAgICAgc2VsZi5oZWFwX3NvcnQoKTsKICAgICAgICBzZWxmLnNvcnRfdGltZXNbMl0gPSBzZWxmLmNvbXBhcmlzb25zICsgc2VsZi5zd2FwczsKICAgICAgICBzZWxmLmFsZ29yaXRobV9lZmZpY2llbmN5WzJdID0gc2VsZi5hbmFseXplX3NvcnRlZF9hcnJheSgpOwogICAgICAgIHByaW50bG5JbnQoc2VsZi5hbGdvcml0aG1fZWZmaWNpZW5jeVsyXSk7CgogICAgICAgIC8vIFRlc3QgNDogUmFkaXggU29ydAogICAgICAgIHNlbGYucmVzdG9yZV9mcm9tX3RlbXAoKTsKICAgICAgICBzZWxmLnJlc2V0X3N0YXRpc3RpY3MoKTsKICAgICAgICBzZWxmLnJhZGl4X3NvcnQoKTsKICAgICAgICBzZWxmLnNvcnRfdGltZXNbM10gPSBzZWxmLm1lbW9yeV9vcGVyYXRpb25zOwogICAgICAgIHNlbGYuYWxnb3JpdGhtX2VmZmljaWVuY3lbM10gPSBzZWxmLmFuYWx5emVfc29ydGVkX2FycmF5KCk7CiAgICAgICAgcHJpbnRsbkludChzZWxmLmFsZ29yaXRobV9lZmZpY2llbmN5WzNdKTsKCiAgICAgICAgLy8gVGVzdCA1OiBCdWNrZXQgU29ydAogICAgICAgIHNlbGYucmVzdG9yZV9mcm9tX3RlbXAoKTsKICAgICAgICBzZWxmLnJlc2V0X3N0YXRpc3RpY3MoKTsKICAgICAgICBzZWxmLmJ1Y2tldF9zb3J0KCk7CiAgICAgICAgc2VsZi5zb3J0X3RpbWVzWzRdID0gc2VsZi5tZW1vcnlfb3BlcmF0aW9ucyArIHNlbGYuY29tcGFyaXNvbnM7CiAgICAgICAgc2VsZi5hbGdvcml0aG1fZWZmaWNpZW5jeVs0XSA9IHNlbGYuYW5hbHl6ZV9zb3J0ZWRfYXJyYXkoKTsKICAgICAgICBwcmludGxuSW50KHNlbGYuYWxnb3JpdGhtX2VmZmljaWVuY3lbNF0pOwoKICAgICAgICAvLyBQZXJmb3JtYW5jZSBjb21wYXJpc29uIGFuYWx5c2lzCiAgICAgICAgbGV0IG11dCBiZXN0X2FsZ29yaXRobTogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IGJlc3RfZWZmaWNpZW5jeTogaTMyID0gc2VsZi5hbGdvcml0aG1fZWZmaWNpZW5jeVswXTsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDE7CiAgICAgICAgd2hpbGUgKGkgPCA1KSB7CiAgICAgICAgICAgIGlmIChzZWxmLmFsZ29yaXRobV9lZmZpY2llbmN5W2kgYXMgdXNpemVdID4gYmVzdF9lZmZpY2llbmN5KSB7CiAgICAgICAgICAgICAgICBiZXN0X2VmZmljaWVuY3kgPSBzZWxmLmFsZ29yaXRobV9lZmZpY2llbmN5W2kgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgYmVzdF9hbGdvcml0aG0gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIHByaW50bG5JbnQoYmVzdF9hbGdvcml0aG0pOwogICAgICAgIHByaW50bG5JbnQoYmVzdF9lZmZpY2llbmN5KTsKICAgIH0KfQoKLy8gQWR2YW5jZWQgZGF0YSBzdHJ1Y3R1cmUgZm9yIGNvbXBsZXggb3BlcmF0aW9ucwpzdHJ1Y3QgRGF0YVByb2Nlc3NvciB7CiAgICBwcmltYXJ5X2RhdGE6IFtpMzI7IDEwMDBdLAogICAgc2Vjb25kYXJ5X2RhdGE6IFtpMzI7IDEwMDBdLAogICAgcmVzdWx0X2RhdGE6IFtpMzI7IDIwMDBdLAogICAgc2l6ZTogaTMyLAoKICAgIC8vIEZvciBjb21wbGV4IHRyYW5zZm9ybWF0aW9ucwogICAgdHJhbnNmb3JtYXRpb25fbWF0cml4OiBbW2kzMjsgMTAwXTsgMTAwXSwKICAgIG1hdHJpeF9zaXplOiBpMzIsCgogICAgLy8gRm9yIHN0YXRpc3RpY2FsIGFuYWx5c2lzCiAgICBmcmVxdWVuY3lfbWFwOiBbaTMyOyAxMDAwMF0sCiAgICBzdGF0aXN0aWNzOiBbaTMyOyAyMF0sCn0KCmltcGwgRGF0YVByb2Nlc3NvciB7CiAgICBmbiBuZXcoKSAtPiBEYXRhUHJvY2Vzc29yIHsKICAgICAgICBEYXRhUHJvY2Vzc29yIHsKICAgICAgICAgICAgcHJpbWFyeV9kYXRhOiBbMDsgMTAwMF0sCiAgICAgICAgICAgIHNlY29uZGFyeV9kYXRhOiBbMDsgMTAwMF0sCiAgICAgICAgICAgIHJlc3VsdF9kYXRhOiBbMDsgMjAwMF0sCiAgICAgICAgICAgIHNpemU6IDAsCiAgICAgICAgICAgIHRyYW5zZm9ybWF0aW9uX21hdHJpeDogW1swOyAxMDBdOyAxMDBdLAogICAgICAgICAgICBtYXRyaXhfc2l6ZTogMCwKICAgICAgICAgICAgZnJlcXVlbmN5X21hcDogWzA7IDEwMDAwXSwKICAgICAgICAgICAgc3RhdGlzdGljczogWzA7IDIwXSwKICAgICAgICB9CiAgICB9CgogICAgLy8gQ29tcGxleCBkYXRhIHRyYW5zZm9ybWF0aW9uIG9wZXJhdGlvbnMKICAgIGZuIHBlcmZvcm1fYWR2YW5jZWRfb3BlcmF0aW9ucygmbXV0IHNlbGYsIGFuYWx5emVyOiAmU29ydGluZ0FuYWx5emVyKSB7CiAgICAgICAgc2VsZi5zaXplID0gYW5hbHl6ZXIuc2l6ZTsKCiAgICAgICAgLy8gQ29weSBzb3J0ZWQgZGF0YSBmb3IgcHJvY2Vzc2luZwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuc2l6ZSkgewogICAgICAgICAgICBzZWxmLnByaW1hcnlfZGF0YVtpIGFzIHVzaXplXSA9IGFuYWx5emVyLmRhdGFbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIEdlbmVyYXRlIGRlcml2ZWQgZGF0YXNldHMKICAgICAgICBzZWxmLmdlbmVyYXRlX2ZpYm9uYWNjaV90cmFuc2Zvcm0oKTsKICAgICAgICBzZWxmLmFwcGx5X21hdGhlbWF0aWNhbF9vcGVyYXRpb25zKCk7CiAgICAgICAgc2VsZi5wZXJmb3JtX3N0YXRpc3RpY2FsX2FuYWx5c2lzKCk7CiAgICAgICAgc2VsZi5leGVjdXRlX21hdHJpeF9vcGVyYXRpb25zKCk7CgogICAgICAgIC8vIE91dHB1dCBjb21wcmVoZW5zaXZlIHJlc3VsdHMKICAgICAgICBzZWxmLm91dHB1dF9hbmFseXNpc19yZXN1bHRzKCk7CiAgICB9CgogICAgZm4gZ2VuZXJhdGVfZmlib25hY2NpX3RyYW5zZm9ybSgmbXV0IHNlbGYpIHsKICAgICAgICAvLyBBcHBseSBGaWJvbmFjY2ktYmFzZWQgdHJhbnNmb3JtYXRpb24gdG8gZGF0YQogICAgICAgIGxldCBtdXQgZmliX3ByZXY6IGkzMiA9IDE7CiAgICAgICAgbGV0IG11dCBmaWJfY3VycjogaTMyID0gMTsKCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi5zaXplKSB7CiAgICAgICAgICAgIHNlbGYuc2Vjb25kYXJ5X2RhdGFbaSBhcyB1c2l6ZV0gPSAoc2VsZi5wcmltYXJ5X2RhdGFbaSBhcyB1c2l6ZV0gKiBmaWJfY3VycikgJSAxMDAwMDAwOwoKICAgICAgICAgICAgbGV0IGZpYl9uZXh0OiBpMzIgPSBmaWJfcHJldiArIGZpYl9jdXJyOwogICAgICAgICAgICBmaWJfcHJldiA9IGZpYl9jdXJyOwogICAgICAgICAgICBmaWJfY3VyciA9IGZpYl9uZXh0OwoKICAgICAgICAgICAgaWYgKGZpYl9jdXJyID4gMTAwMDAwMCkgewogICAgICAgICAgICAgICAgZmliX2N1cnIgPSAxOwogICAgICAgICAgICAgICAgZmliX3ByZXYgPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgfQoKICAgIGZuIGFwcGx5X21hdGhlbWF0aWNhbF9vcGVyYXRpb25zKCZtdXQgc2VsZikgewogICAgICAgIC8vIENvbWJpbmUgcHJpbWFyeSBhbmQgc2Vjb25kYXJ5IGRhdGEgd2l0aCBjb21wbGV4IG9wZXJhdGlvbnMKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLnNpemUpIHsKICAgICAgICAgICAgbGV0IHByaW1hcnk6IGkzMiA9IHNlbGYucHJpbWFyeV9kYXRhW2kgYXMgdXNpemVdOwogICAgICAgICAgICBsZXQgc2Vjb25kYXJ5OiBpMzIgPSBzZWxmLnNlY29uZGFyeV9kYXRhW2kgYXMgdXNpemVdOwoKICAgICAgICAgICAgLy8gQXBwbHkgdmFyaW91cyBtYXRoZW1hdGljYWwgdHJhbnNmb3JtYXRpb25zCiAgICAgICAgICAgIHNlbGYucmVzdWx0X2RhdGFbaSBhcyB1c2l6ZV0gPSAocHJpbWFyeSAqIHByaW1hcnkgKyBzZWNvbmRhcnkpICUgMzI3Njg7CiAgICAgICAgICAgIHNlbGYucmVzdWx0X2RhdGFbKHNlbGYuc2l6ZSArIGkpIGFzIHVzaXplXSA9CiAgICAgICAgICAgICAgICAocHJpbWFyeSArIChzZWNvbmRhcnkgJSAzMjc2OCkgKiAoc2Vjb25kYXJ5ICUgMzI3NjgpKSAlIDMyNzY4OwoKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgIH0KCiAgICBmbiBwZXJmb3JtX3N0YXRpc3RpY2FsX2FuYWx5c2lzKCZtdXQgc2VsZikgewogICAgICAgIC8vIENsZWFyIGZyZXF1ZW5jeSBtYXAKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCAxMDAwMCkgewogICAgICAgICAgICBzZWxmLmZyZXF1ZW5jeV9tYXBbaSBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBDYWxjdWxhdGUgZnJlcXVlbmNpZXMgYW5kIHZhcmlvdXMgc3RhdGlzdGljcwogICAgICAgIGxldCBtdXQgc3VtOiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgc3VtX3NxdWFyZXM6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBtaW5fdmFsOiBpMzIgPSBzZWxmLnByaW1hcnlfZGF0YVswXTsKICAgICAgICBsZXQgbXV0IG1heF92YWw6IGkzMiA9IHNlbGYucHJpbWFyeV9kYXRhWzBdOwoKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuc2l6ZSkgewogICAgICAgICAgICBsZXQgdmFsdWU6IGkzMiA9IHNlbGYucHJpbWFyeV9kYXRhW2kgYXMgdXNpemVdOwogICAgICAgICAgICBzdW0gKz0gdmFsdWU7CiAgICAgICAgICAgIHN1bV9zcXVhcmVzICs9IHZhbHVlICogdmFsdWU7CgogICAgICAgICAgICBpZiAodmFsdWUgPCBtaW5fdmFsKSB7CiAgICAgICAgICAgICAgICBtaW5fdmFsID0gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHZhbHVlID4gbWF4X3ZhbCkgewogICAgICAgICAgICAgICAgbWF4X3ZhbCA9IHZhbHVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBVcGRhdGUgZnJlcXVlbmN5IG1hcCAoaGFuZGxlIGxhcmdlIHZhbHVlcykKICAgICAgICAgICAgaWYgKHZhbHVlID49IDAgJiYgdmFsdWUgPCAxMDAwMCkgewogICAgICAgICAgICAgICAgc2VsZi5mcmVxdWVuY3lfbWFwW3ZhbHVlIGFzIHVzaXplXSArPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBzZWxmLnN0YXRpc3RpY3NbMF0gPSBzdW07CiAgICAgICAgc2VsZi5zdGF0aXN0aWNzWzFdID0gc3VtX3NxdWFyZXM7CiAgICAgICAgc2VsZi5zdGF0aXN0aWNzWzJdID0gbWluX3ZhbDsKICAgICAgICBzZWxmLnN0YXRpc3RpY3NbM10gPSBtYXhfdmFsOwogICAgICAgIHNlbGYuc3RhdGlzdGljc1s0XSA9IHN1bSAvIHNlbGYuc2l6ZTsgLy8gTWVhbgogICAgICAgIHNlbGYuc3RhdGlzdGljc1s1XSA9IG1heF92YWwgLSBtaW5fdmFsOyAvLyBSYW5nZQoKICAgICAgICAvLyBDYWxjdWxhdGUgbW9kZSBhbmQgbWVkaWFuIGZyb20gc29ydGVkIGRhdGEKICAgICAgICBsZXQgbXV0IG1heF9mcmVxdWVuY3k6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBtb2RlOiBpMzIgPSBtaW5fdmFsOwogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgMTAwMDApIHsKICAgICAgICAgICAgaWYgKHNlbGYuZnJlcXVlbmN5X21hcFtpIGFzIHVzaXplXSA+IG1heF9mcmVxdWVuY3kpIHsKICAgICAgICAgICAgICAgIG1heF9mcmVxdWVuY3kgPSBzZWxmLmZyZXF1ZW5jeV9tYXBbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBtb2RlID0gaTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBzZWxmLnN0YXRpc3RpY3NbNl0gPSBtb2RlOwogICAgICAgIHNlbGYuc3RhdGlzdGljc1s3XSA9IG1heF9mcmVxdWVuY3k7CiAgICAgICAgc2VsZi5zdGF0aXN0aWNzWzhdID0gc2VsZi5wcmltYXJ5X2RhdGFbKHNlbGYuc2l6ZSAvIDIpIGFzIHVzaXplXTsgLy8gTWVkaWFuCiAgICB9CgogICAgZm4gZXhlY3V0ZV9tYXRyaXhfb3BlcmF0aW9ucygmbXV0IHNlbGYpIHsKICAgICAgICAvLyBDcmVhdGUgdHJhbnNmb3JtYXRpb24gbWF0cml4IGJhc2VkIG9uIGRhdGEgcGF0dGVybnMKICAgICAgICBzZWxmLm1hdHJpeF9zaXplID0gaWYgKHNlbGYuc2l6ZSA8IDEwMCkgeyBzZWxmLnNpemUgfSBlbHNlIHsgMTAwIH07CgogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYubWF0cml4X3NpemUpIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IHNlbGYubWF0cml4X3NpemUpIHsKICAgICAgICAgICAgICAgIGxldCBpZHgxOiB1c2l6ZSA9IChpICogc2VsZi5zaXplIC8gc2VsZi5tYXRyaXhfc2l6ZSkgYXMgdXNpemU7CiAgICAgICAgICAgICAgICBsZXQgaWR4MjogdXNpemUgPSAoaiAqIHNlbGYuc2l6ZSAvIHNlbGYubWF0cml4X3NpemUpIGFzIHVzaXplOwoKICAgICAgICAgICAgICAgIGlmIChpZHgxIDwgc2VsZi5zaXplIGFzIHVzaXplICYmIGlkeDIgPCBzZWxmLnNpemUgYXMgdXNpemUpIHsKICAgICAgICAgICAgICAgICAgICBzZWxmLnRyYW5zZm9ybWF0aW9uX21hdHJpeFtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9CiAgICAgICAgICAgICAgICAgICAgICAgIChzZWxmLnByaW1hcnlfZGF0YVtpZHgxIGFzIHVzaXplXSArIHNlbGYuc2Vjb25kYXJ5X2RhdGFbaWR4MiBhcyB1c2l6ZV0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAlIDEwMDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gUGVyZm9ybSBtYXRyaXggY2FsY3VsYXRpb25zIChzaW1wbGlmaWVkKQogICAgICAgIGxldCBtdXQgbWF0cml4X3N1bTogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IGRpYWdvbmFsX3N1bTogaTMyID0gMDsKCiAgICAgICAgaSA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLm1hdHJpeF9zaXplKSB7CiAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKGogPCBzZWxmLm1hdHJpeF9zaXplKSB7CiAgICAgICAgICAgICAgICBtYXRyaXhfc3VtICs9IHNlbGYudHJhbnNmb3JtYXRpb25fbWF0cml4W2kgYXMgdXNpemVdW2ogYXMgdXNpemVdOwogICAgICAgICAgICAgICAgaWYgKGkgPT0gaikgewogICAgICAgICAgICAgICAgICAgIGRpYWdvbmFsX3N1bSArPSBzZWxmLnRyYW5zZm9ybWF0aW9uX21hdHJpeFtpIGFzIHVzaXplXVtqIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGogKz0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBzZWxmLnN0YXRpc3RpY3NbOV0gPSBtYXRyaXhfc3VtOwogICAgICAgIHNlbGYuc3RhdGlzdGljc1sxMF0gPSBkaWFnb25hbF9zdW07CiAgICB9CgogICAgZm4gb3V0cHV0X2FuYWx5c2lzX3Jlc3VsdHMoJnNlbGYpIHsKICAgICAgICAvLyBPdXRwdXQgY29tcHJlaGVuc2l2ZSBzdGF0aXN0aWNhbCBhbmFseXNpcwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IDExKSB7CiAgICAgICAgICAgIHByaW50bG5JbnQoc2VsZi5zdGF0aXN0aWNzW2kgYXMgdXNpemVdKTsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gT3V0cHV0IHN1bW1hcnkgbWV0cmljcwogICAgICAgIGxldCBjb21wbGV4aXR5X21ldHJpYzogaTMyID0gKHNlbGYuc3RhdGlzdGljc1swXSArIHNlbGYuc3RhdGlzdGljc1s5XSkgLyAoc2VsZi5zaXplICsgMSk7CiAgICAgICAgbGV0IGVmZmljaWVuY3lfbWV0cmljOiBpMzIgPSBzZWxmLnN0YXRpc3RpY3NbMTBdICogc2VsZi5zdGF0aXN0aWNzWzRdIC8gMTAwMDsKICAgICAgICBsZXQgZmluYWxfc2NvcmU6IGkzMiA9IGNvbXBsZXhpdHlfbWV0cmljICsgZWZmaWNpZW5jeV9tZXRyaWM7CgogICAgICAgIHByaW50bG5JbnQoY29tcGxleGl0eV9tZXRyaWMpOwogICAgICAgIHByaW50bG5JbnQoZWZmaWNpZW5jeV9tZXRyaWMpOwogICAgICAgIHByaW50bG5JbnQoZmluYWxfc2NvcmUpOwogICAgfQp9CgpmbiBtYWluKCkgewogICAgLy8gUmVhZCBpbnB1dCBwYXJhbWV0ZXJzCiAgICBsZXQgZGF0YV9zaXplOiBpMzIgPSBnZXRJbnQoKTsKCiAgICAvLyBJbml0aWFsaXplIHNvcnRpbmcgYW5hbHl6ZXIKICAgIGxldCBtdXQgYW5hbHl6ZXI6IFNvcnRpbmdBbmFseXplciA9IFNvcnRpbmdBbmFseXplcjo6bmV3KCk7CiAgICBhbmFseXplci5pbml0aWFsaXplX2RhdGEoZGF0YV9zaXplKTsKCiAgICAvLyBSdW4gY29tcHJlaGVuc2l2ZSBzb3J0aW5nIHRlc3RzCiAgICBhbmFseXplci5ydW5fY29tcHJlaGVuc2l2ZV90ZXN0cygpOwoKICAgIC8vIEluaXRpYWxpemUgZGF0YSBwcm9jZXNzb3IgZm9yIGFkdmFuY2VkIG9wZXJhdGlvbnMKICAgIGxldCBtdXQgcHJvY2Vzc29yOiBEYXRhUHJvY2Vzc29yID0gRGF0YVByb2Nlc3Nvcjo6bmV3KCk7CiAgICBwcm9jZXNzb3IucGVyZm9ybV9hZHZhbmNlZF9vcGVyYXRpb25zKCZhbmFseXplcik7CgogICAgLy8gQWRkaXRpb25hbCBzdHJlc3MgdGVzdGluZyB3aXRoIG11bHRpcGxlIGl0ZXJhdGlvbnMKICAgIGxldCBpdGVyYXRpb25zOiBpMzIgPSBnZXRJbnQoKTsKICAgIGxldCBtdXQgdG90YWxfcGVyZm9ybWFuY2U6IGkzMiA9IDA7CgogICAgbGV0IG11dCBpdGVyOiBpMzIgPSAwOwogICAgd2hpbGUgKGl0ZXIgPCBpdGVyYXRpb25zKSB7CiAgICAgICAgLy8gUmUtcnVuIHRlc3RzIHdpdGggbW9kaWZpZWQgZGF0YQogICAgICAgIGxldCBtb2RpZmllcjogaTMyID0gKGl0ZXIgKiAxNyArIDIzKSAlIDEwMDsKCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgYW5hbHl6ZXIuc2l6ZSkgewogICAgICAgICAgICBhbmFseXplci5kYXRhW2kgYXMgdXNpemVdID0gKGFuYWx5emVyLnRlbXBfYXJyYXlbaSBhcyB1c2l6ZV0gKyBtb2RpZmllcikgJSAxMDAwMDsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gUXVpY2sgcGVyZm9ybWFuY2UgdGVzdAogICAgICAgIGFuYWx5emVyLnJlc2V0X3N0YXRpc3RpY3MoKTsKICAgICAgICBhbmFseXplci5xdWlja19zb3J0XzN3YXkoMCwgYW5hbHl6ZXIuc2l6ZSAtIDEpOwogICAgICAgIHRvdGFsX3BlcmZvcm1hbmNlICs9IGFuYWx5emVyLmNvbXBhcmlzb25zICsgYW5hbHl6ZXIuc3dhcHM7CgogICAgICAgIGl0ZXIgKz0gMTsKICAgIH0KCiAgICBwcmludGxuSW50KHRvdGFsX3BlcmZvcm1hbmNlKTsKCiAgICAvLyBGaW5hbCBjb21wcmVoZW5zaXZlIGFuYWx5c2lzCiAgICBsZXQgZmluYWxfbWV0cmljOiBpMzIgPSAodG90YWxfcGVyZm9ybWFuY2UgKiBwcm9jZXNzb3Iuc3RhdGlzdGljc1s0XSkgLyAoaXRlcmF0aW9ucyArIDEpOwogICAgcHJpbnRsbkludChmaW5hbF9tZXRyaWMpOwogICAgZXhpdCgwKTsKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (13, "comprehensive13", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCAxMzogQWR2YW5jZWQgTWF0aGVtYXRpY2FsIENvbXB1dGluZyBhbmQgTnVtZXJpY2FsIEFuYWx5c2lzClN1bW1hcnk6IFRoaXMgdGVzdCBpbXBsZW1lbnRzIHNvcGhpc3RpY2F0ZWQgbWF0aGVtYXRpY2FsIGFsZ29yaXRobXMgYW5kIG51bWVyaWNhbCBjb21wdXRhdGlvbnM6CkRldGFpbHM6CjEuIE1hdHJpeCBvcGVyYXRpb25zIGFuZCBsaW5lYXIgYWxnZWJyYSBjb21wdXRhdGlvbnMKMi4gUG9seW5vbWlhbCBldmFsdWF0aW9uIGFuZCByb290IGZpbmRpbmcgdXNpbmcgTmV3dG9uJ3MgbWV0aG9kCjMuIE51bWVyaWNhbCBpbnRlZ3JhdGlvbiB1c2luZyBtdWx0aXBsZSBtZXRob2RzIChUcmFwZXpvaWRhbCwgU2ltcHNvbidzKQo0LiBGYXN0IEZvdXJpZXIgVHJhbnNmb3JtIChzaW1wbGlmaWVkIGludGVnZXIgdmVyc2lvbikKNS4gUHJpbWUgbnVtYmVyIGFsZ29yaXRobXMgYW5kIG51bWJlciB0aGVvcnkgb3BlcmF0aW9ucwo2LiBTdGF0aXN0aWNhbCBhbmFseXNpcyBhbmQgcHJvYmFiaWxpdHkgY29tcHV0YXRpb25zCiovCgovLyBDb21wcmVoZW5zaXZlIFRlc3QgMTM6IEFkdmFuY2VkIE1hdGhlbWF0aWNhbCBDb21wdXRpbmcgYW5kIE51bWVyaWNhbCBBbmFseXNpcwovLyBUaGlzIHRlc3QgaW1wbGVtZW50cyBzb3BoaXN0aWNhdGVkIG1hdGhlbWF0aWNhbCBhbGdvcml0aG1zIGFuZCBudW1lcmljYWwgY29tcHV0YXRpb25zOgovLyAxLiBNYXRyaXggb3BlcmF0aW9ucyBhbmQgbGluZWFyIGFsZ2VicmEgY29tcHV0YXRpb25zCi8vIDIuIFBvbHlub21pYWwgZXZhbHVhdGlvbiBhbmQgcm9vdCBmaW5kaW5nIHVzaW5nIE5ld3RvbidzIG1ldGhvZAovLyAzLiBOdW1lcmljYWwgaW50ZWdyYXRpb24gdXNpbmcgbXVsdGlwbGUgbWV0aG9kcyAoVHJhcGV6b2lkYWwsIFNpbXBzb24ncykKLy8gNC4gRmFzdCBGb3VyaWVyIFRyYW5zZm9ybSAoc2ltcGxpZmllZCBpbnRlZ2VyIHZlcnNpb24pCi8vIDUuIFByaW1lIG51bWJlciBhbGdvcml0aG1zIGFuZCBudW1iZXIgdGhlb3J5IG9wZXJhdGlvbnMKLy8gNi4gU3RhdGlzdGljYWwgYW5hbHlzaXMgYW5kIHByb2JhYmlsaXR5IGNvbXB1dGF0aW9ucwoKLy8gU3RydWN0dXJlIGZvciBhZHZhbmNlZCBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucwpzdHJ1Y3QgTWF0aEVuZ2luZSB7CiAgICAvLyBNYXRyaXggb3BlcmF0aW9ucwogICAgbWF0cml4X2E6IFtbaTMyOyAxMDBdOyAxMDBdLAogICAgbWF0cml4X2I6IFtbaTMyOyAxMDBdOyAxMDBdLAogICAgbWF0cml4X3Jlc3VsdDogW1tpMzI7IDEwMF07IDEwMF0sCiAgICBtYXRyaXhfc2l6ZTogaTMyLAoKICAgIC8vIFBvbHlub21pYWwgb3BlcmF0aW9ucwogICAgcG9seW5vbWlhbF9jb2VmZnM6IFtpMzI7IDIwMF0sCiAgICBwb2x5X2RlZ3JlZTogaTMyLAogICAgcm9vdHM6IFtpMzI7IDUwXSwKICAgIHJvb3RfY291bnQ6IGkzMiwKCiAgICAvLyBOdW1lcmljYWwgaW50ZWdyYXRpb24KICAgIGZ1bmN0aW9uX3ZhbHVlczogW2kzMjsgMTAwMF0sCiAgICBpbnRlZ3JhdGlvbl9wb2ludHM6IGkzMiwKICAgIGludGVncmF0aW9uX3Jlc3VsdHM6IFtpMzI7IDEwXSwKCiAgICAvLyBGRlQgb3BlcmF0aW9ucwogICAgcmVhbF9wYXJ0OiBbaTMyOyA1MTJdLAogICAgaW1hZ19wYXJ0OiBbaTMyOyA1MTJdLAogICAgZmZ0X3NpemU6IGkzMiwKCiAgICAvLyBQcmltZSBhbmQgbnVtYmVyIHRoZW9yeQogICAgcHJpbWVzOiBbaTMyOyAxMDAwXSwKICAgIHByaW1lX2NvdW50OiBpMzIsCiAgICBmYWN0b3JpemF0aW9uczogW1tpMzI7IDIwXTsgMTAwXSwKCiAgICAvLyBTdGF0aXN0aWNhbCBjb21wdXRhdGlvbnMKICAgIGRhdGFfc2VyaWVzOiBbaTMyOyAyMDAwXSwKICAgIHNlcmllc19sZW5ndGg6IGkzMiwKICAgIG1vbWVudHM6IFtpMzI7IDEwXSwKICAgIGNvcnJlbGF0aW9uczogW2kzMjsgMTAwXSwKCiAgICAvLyBDb21wdXRhdGlvbiByZXN1bHRzCiAgICBjb21wdXRhdGlvbl9sb2c6IFtpMzI7IDUwXSwKICAgIGxvZ19zaXplOiBpMzIsCn0KCmltcGwgTWF0aEVuZ2luZSB7CiAgICBmbiBuZXcoKSAtPiBNYXRoRW5naW5lIHsKICAgICAgICBNYXRoRW5naW5lIHsKICAgICAgICAgICAgbWF0cml4X2E6IFtbMDsgMTAwXTsgMTAwXSwKICAgICAgICAgICAgbWF0cml4X2I6IFtbMDsgMTAwXTsgMTAwXSwKICAgICAgICAgICAgbWF0cml4X3Jlc3VsdDogW1swOyAxMDBdOyAxMDBdLAogICAgICAgICAgICBtYXRyaXhfc2l6ZTogMCwKICAgICAgICAgICAgcG9seW5vbWlhbF9jb2VmZnM6IFswOyAyMDBdLAogICAgICAgICAgICBwb2x5X2RlZ3JlZTogMCwKICAgICAgICAgICAgcm9vdHM6IFswOyA1MF0sCiAgICAgICAgICAgIHJvb3RfY291bnQ6IDAsCiAgICAgICAgICAgIGZ1bmN0aW9uX3ZhbHVlczogWzA7IDEwMDBdLAogICAgICAgICAgICBpbnRlZ3JhdGlvbl9wb2ludHM6IDAsCiAgICAgICAgICAgIGludGVncmF0aW9uX3Jlc3VsdHM6IFswOyAxMF0sCiAgICAgICAgICAgIHJlYWxfcGFydDogWzA7IDUxMl0sCiAgICAgICAgICAgIGltYWdfcGFydDogWzA7IDUxMl0sCiAgICAgICAgICAgIGZmdF9zaXplOiAwLAogICAgICAgICAgICBwcmltZXM6IFswOyAxMDAwXSwKICAgICAgICAgICAgcHJpbWVfY291bnQ6IDAsCiAgICAgICAgICAgIGZhY3Rvcml6YXRpb25zOiBbWzA7IDIwXTsgMTAwXSwKICAgICAgICAgICAgZGF0YV9zZXJpZXM6IFswOyAyMDAwXSwKICAgICAgICAgICAgc2VyaWVzX2xlbmd0aDogMCwKICAgICAgICAgICAgbW9tZW50czogWzA7IDEwXSwKICAgICAgICAgICAgY29ycmVsYXRpb25zOiBbMDsgMTAwXSwKICAgICAgICAgICAgY29tcHV0YXRpb25fbG9nOiBbMDsgNTBdLAogICAgICAgICAgICBsb2dfc2l6ZTogMCwKICAgICAgICB9CiAgICB9CgogICAgLy8gSW5pdGlhbGl6ZSBtYXRyaWNlcyB3aXRoIGlucHV0IGRhdGEKICAgIGZuIGluaXRpYWxpemVfbWF0cmljZXMoJm11dCBzZWxmLCBzaXplOiBpMzIpIHsKICAgICAgICBzZWxmLm1hdHJpeF9zaXplID0gc2l6ZTsKCiAgICAgICAgLy8gUmVhZCBtYXRyaXggQQogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IHNpemUpIHsKICAgICAgICAgICAgICAgIHNlbGYubWF0cml4X2FbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSBnZXRJbnQoKTsKICAgICAgICAgICAgICAgIGogKz0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBSZWFkIG1hdHJpeCBCCiAgICAgICAgaSA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgICAgICBzZWxmLm1hdHJpeF9iW2kgYXMgdXNpemVdW2ogYXMgdXNpemVdID0gZ2V0SW50KCk7CiAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBBZHZhbmNlZCBtYXRyaXggbXVsdGlwbGljYXRpb24gd2l0aCBvcHRpbWl6YXRpb24KICAgIGZuIG1hdHJpeF9tdWx0aXBseSgmbXV0IHNlbGYpIHsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLm1hdHJpeF9zaXplKSB7CiAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKGogPCBzZWxmLm1hdHJpeF9zaXplKSB7CiAgICAgICAgICAgICAgICBzZWxmLm1hdHJpeF9yZXN1bHRbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICAgICAgbGV0IG11dCBrOiBpMzIgPSAwOwogICAgICAgICAgICAgICAgd2hpbGUgKGsgPCBzZWxmLm1hdHJpeF9zaXplKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXRyaXhfcmVzdWx0W2kgYXMgdXNpemVdW2ogYXMgdXNpemVdICs9IHNlbGYubWF0cml4X2FbaSBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgICAgICAgICAgW2sgYXMgdXNpemVdCiAgICAgICAgICAgICAgICAgICAgICAgICogc2VsZi5tYXRyaXhfYltrIGFzIHVzaXplXVtqIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICBrICs9IDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBNYXRyaXggZGV0ZXJtaW5hbnQgY2FsY3VsYXRpb24gdXNpbmcgTFUgZGVjb21wb3NpdGlvbgogICAgZm4gY2FsY3VsYXRlX2RldGVybWluYW50KCZtdXQgc2VsZikgLT4gaTMyIHsKICAgICAgICAvLyBDcmVhdGUgYSBjb3B5IG9mIG1hdHJpeCBBIGZvciBkZWNvbXBvc2l0aW9uCiAgICAgICAgbGV0IG11dCBsdV9tYXRyaXg6IFtbaTMyOyAxMDBdOyAxMDBdID0gW1swOyAxMDBdOyAxMDBdOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYubWF0cml4X3NpemUpIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IHNlbGYubWF0cml4X3NpemUpIHsKICAgICAgICAgICAgICAgIGx1X21hdHJpeFtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9IHNlbGYubWF0cml4X2FbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgbGV0IG11dCBkZXQ6IGkzMiA9IDE7CiAgICAgICAgbGV0IG11dCBzaWduOiBpMzIgPSAxOwoKICAgICAgICAvLyBQZXJmb3JtIExVIGRlY29tcG9zaXRpb24KICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYubWF0cml4X3NpemUgLSAxKSB7CiAgICAgICAgICAgIC8vIEZpbmQgcGl2b3QKICAgICAgICAgICAgbGV0IG11dCBtYXhfcm93OiBpMzIgPSBpOwogICAgICAgICAgICBsZXQgbXV0IG1heF92YWw6IGkzMiA9IGlmIChsdV9tYXRyaXhbaSBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gPCAwKSB7CiAgICAgICAgICAgICAgICAtbHVfbWF0cml4W2kgYXMgdXNpemVdW2kgYXMgdXNpemVdCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBsdV9tYXRyaXhbaSBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0KICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGxldCBtdXQgazogaTMyID0gaSArIDE7CiAgICAgICAgICAgIHdoaWxlIChrIDwgc2VsZi5tYXRyaXhfc2l6ZSkgewogICAgICAgICAgICAgICAgbGV0IGFic192YWw6IGkzMiA9IGlmIChsdV9tYXRyaXhbayBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gPCAwKSB7CiAgICAgICAgICAgICAgICAgICAgLWx1X21hdHJpeFtrIGFzIHVzaXplXVtpIGFzIHVzaXplXQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBsdV9tYXRyaXhbayBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBpZiAoYWJzX3ZhbCA+IG1heF92YWwpIHsKICAgICAgICAgICAgICAgICAgICBtYXhfdmFsID0gYWJzX3ZhbDsKICAgICAgICAgICAgICAgICAgICBtYXhfcm93ID0gazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGsgKz0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU3dhcCByb3dzIGlmIG5lY2Vzc2FyeQogICAgICAgICAgICBpZiAobWF4X3JvdyAhPSBpKSB7CiAgICAgICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgICAgICAgICB3aGlsZSAoaiA8IHNlbGYubWF0cml4X3NpemUpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgdGVtcDogaTMyID0gbHVfbWF0cml4W2kgYXMgdXNpemVdW2ogYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIGx1X21hdHJpeFtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9IGx1X21hdHJpeFttYXhfcm93IGFzIHVzaXplXVtqIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICBsdV9tYXRyaXhbbWF4X3JvdyBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSB0ZW1wOwogICAgICAgICAgICAgICAgICAgIGogKz0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNpZ24gPSAtc2lnbjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIHplcm8gcGl2b3QKICAgICAgICAgICAgaWYgKGx1X21hdHJpeFtpIGFzIHVzaXplXVtpIGFzIHVzaXplXSA9PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gRWxpbWluYXRlIGNvbHVtbgogICAgICAgICAgICBrID0gaSArIDE7CiAgICAgICAgICAgIHdoaWxlIChrIDwgc2VsZi5tYXRyaXhfc2l6ZSkgewogICAgICAgICAgICAgICAgbGV0IGZhY3RvcjogaTMyID0KICAgICAgICAgICAgICAgICAgICBsdV9tYXRyaXhbayBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gLyBsdV9tYXRyaXhbaSBhcyB1c2l6ZV1baSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IGk7CiAgICAgICAgICAgICAgICB3aGlsZSAoaiA8IHNlbGYubWF0cml4X3NpemUpIHsKICAgICAgICAgICAgICAgICAgICBsdV9tYXRyaXhbayBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gLT0gZmFjdG9yICogbHVfbWF0cml4W2kgYXMgdXNpemVdW2ogYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIGogKz0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGsgKz0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gQ2FsY3VsYXRlIGRldGVybWluYW50IGZyb20gZGlhZ29uYWwgZWxlbWVudHMKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYubWF0cml4X3NpemUpIHsKICAgICAgICAgICAgZGV0ICo9IGx1X21hdHJpeFtpIGFzIHVzaXplXVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGRldCAqIHNpZ247CiAgICB9CgogICAgLy8gTWF0cml4IHRyYW5zcG9zZSBhbmQgYWRkaXRpb25hbCBvcGVyYXRpb25zCiAgICBmbiBtYXRyaXhfb3BlcmF0aW9uc19zdWl0ZSgmbXV0IHNlbGYpIHsKICAgICAgICAvLyBDYWxjdWxhdGUgdHJhY2UKICAgICAgICBsZXQgbXV0IHRyYWNlOiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYubWF0cml4X3NpemUpIHsKICAgICAgICAgICAgdHJhY2UgKz0gc2VsZi5tYXRyaXhfYVtpIGFzIHVzaXplXVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgICAgICBzZWxmLmNvbXB1dGF0aW9uX2xvZ1tzZWxmLmxvZ19zaXplIGFzIHVzaXplXSA9IHRyYWNlOwogICAgICAgIHNlbGYubG9nX3NpemUgKz0gMTsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIEZyb2Jlbml1cyBub3JtCiAgICAgICAgbGV0IG11dCBmcm9iZW5pdXNfbm9ybTogaTMyID0gMDsKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYubWF0cml4X3NpemUpIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IHNlbGYubWF0cml4X3NpemUpIHsKICAgICAgICAgICAgICAgIGxldCB2YWw6IGkzMiA9IHNlbGYubWF0cml4X2FbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBmcm9iZW5pdXNfbm9ybSArPSB2YWwgKiB2YWw7CiAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgICAgICBzZWxmLmNvbXB1dGF0aW9uX2xvZ1tzZWxmLmxvZ19zaXplIGFzIHVzaXplXSA9IGZyb2Jlbml1c19ub3JtOwogICAgICAgIHNlbGYubG9nX3NpemUgKz0gMTsKCiAgICAgICAgLy8gTWF0cml4IGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbgogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi5tYXRyaXhfc2l6ZSkgewogICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChqIDwgc2VsZi5tYXRyaXhfc2l6ZSkgewogICAgICAgICAgICAgICAgLy8gU3RvcmUgc3VtIGluIHJlc3VsdCBtYXRyaXggdGVtcG9yYXJpbHkKICAgICAgICAgICAgICAgIHNlbGYubWF0cml4X3Jlc3VsdFtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9CiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXRyaXhfYVtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSArIHNlbGYubWF0cml4X2JbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBQb2x5bm9taWFsIG9wZXJhdGlvbnMgYW5kIHJvb3QgZmluZGluZwogICAgZm4gaW5pdGlhbGl6ZV9wb2x5bm9taWFsKCZtdXQgc2VsZiwgZGVncmVlOiBpMzIpIHsKICAgICAgICBzZWxmLnBvbHlfZGVncmVlID0gZGVncmVlOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8PSBkZWdyZWUpIHsKICAgICAgICAgICAgc2VsZi5wb2x5bm9taWFsX2NvZWZmc1tpIGFzIHVzaXplXSA9IGdldEludCgpOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgfQoKICAgIC8vIEV2YWx1YXRlIHBvbHlub21pYWwgYXQgZ2l2ZW4gcG9pbnQKICAgIGZuIGV2YWx1YXRlX3BvbHlub21pYWwoJnNlbGYsIHg6IGkzMikgLT4gaTMyIHsKICAgICAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IHBvd2VyOiBpMzIgPSAxOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8PSBzZWxmLnBvbHlfZGVncmVlKSB7CiAgICAgICAgICAgIHJlc3VsdCArPSBzZWxmLnBvbHlub21pYWxfY29lZmZzW2kgYXMgdXNpemVdICogcG93ZXI7CiAgICAgICAgICAgIHBvd2VyICo9IHg7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAvLyBOZXd0b24ncyBtZXRob2QgZm9yIGZpbmRpbmcgcG9seW5vbWlhbCByb290cwogICAgZm4gZmluZF9wb2x5bm9taWFsX3Jvb3RzKCZtdXQgc2VsZikgewogICAgICAgIHNlbGYucm9vdF9jb3VudCA9IDA7CgogICAgICAgIC8vIFRyeSBkaWZmZXJlbnQgc3RhcnRpbmcgcG9pbnRzCiAgICAgICAgbGV0IG11dCBzdGFydDogaTMyID0gLTEwOwogICAgICAgIHdoaWxlIChzdGFydCA8PSAxMCAmJiBzZWxmLnJvb3RfY291bnQgPCA1MCkgewogICAgICAgICAgICBsZXQgbXV0IHg6IGkzMiA9IHN0YXJ0OwogICAgICAgICAgICBsZXQgbXV0IGl0ZXJhdGlvbnM6IGkzMiA9IDA7CgogICAgICAgICAgICB3aGlsZSAoaXRlcmF0aW9ucyA8IDUwKSB7CiAgICAgICAgICAgICAgICBsZXQgZl94OiBpMzIgPSBzZWxmLmV2YWx1YXRlX3BvbHlub21pYWwoeCk7CiAgICAgICAgICAgICAgICBsZXQgZl9wcmltZV94OiBpMzIgPSBzZWxmLmV2YWx1YXRlX3BvbHlub21pYWxfZGVyaXZhdGl2ZSh4KTsKCiAgICAgICAgICAgICAgICBpZiAoZl9wcmltZV94ID09IDApIHsKICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8gQXZvaWQgZGl2aXNpb24gYnkgemVybwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGxldCBuZXh0X3g6IGkzMiA9IHggLSBmX3ggLyBmX3ByaW1lX3g7CgogICAgICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIGNvbnZlcmdlbmNlCiAgICAgICAgICAgICAgICBsZXQgZGlmZjogaTMyID0gaWYgKG5leHRfeCA+IHgpIHsgbmV4dF94IC0geCB9IGVsc2UgeyB4IC0gbmV4dF94IH07CiAgICAgICAgICAgICAgICBpZiAoZGlmZiA8PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBhY3R1YWxseSBhIHJvb3QKICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5ldmFsdWF0ZV9wb2x5bm9taWFsKG5leHRfeCkgPT0gMAogICAgICAgICAgICAgICAgICAgICAgICB8fCAoaWYgKHNlbGYuZXZhbHVhdGVfcG9seW5vbWlhbChuZXh0X3gpIDwgMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLXNlbGYuZXZhbHVhdGVfcG9seW5vbWlhbChuZXh0X3gpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmV2YWx1YXRlX3BvbHlub21pYWwobmV4dF94KQogICAgICAgICAgICAgICAgICAgICAgICB9KSA8PSA1KQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2UgYWxyZWFkeSBmb3VuZCB0aGlzIHJvb3QKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG11dCBpc19uZXdfcm9vdDogYm9vbCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGogPCBzZWxmLnJvb3RfY291bnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByb290X2RpZmY6IGkzMiA9IGlmIChzZWxmLnJvb3RzW2ogYXMgdXNpemVdID4gbmV4dF94KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucm9vdHNbaiBhcyB1c2l6ZV0gLSBuZXh0X3gKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0X3ggLSBzZWxmLnJvb3RzW2ogYXMgdXNpemVdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyb290X2RpZmYgPD0gMikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzX25ld19yb290ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc19uZXdfcm9vdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yb290c1tzZWxmLnJvb3RfY291bnQgYXMgdXNpemVdID0gbmV4dF94OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yb290X2NvdW50ICs9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgeCA9IG5leHRfeDsKICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnMgKz0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3RhcnQgKz0gNzsgLy8gVXNlIHN0ZXAgc2l6ZSB0byBhdm9pZCBkdXBsaWNhdGVzCiAgICAgICAgfQogICAgfQoKICAgIC8vIEV2YWx1YXRlIHBvbHlub21pYWwgZGVyaXZhdGl2ZQogICAgZm4gZXZhbHVhdGVfcG9seW5vbWlhbF9kZXJpdmF0aXZlKCZzZWxmLCB4OiBpMzIpIC0+IGkzMiB7CiAgICAgICAgbGV0IG11dCByZXN1bHQ6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBwb3dlcjogaTMyID0gMTsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDE7CiAgICAgICAgd2hpbGUgKGkgPD0gc2VsZi5wb2x5X2RlZ3JlZSkgewogICAgICAgICAgICByZXN1bHQgKz0gaSAqIHNlbGYucG9seW5vbWlhbF9jb2VmZnNbaSBhcyB1c2l6ZV0gKiBwb3dlcjsKICAgICAgICAgICAgcG93ZXIgKj0geDsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIC8vIE51bWVyaWNhbCBpbnRlZ3JhdGlvbiB1c2luZyBtdWx0aXBsZSBtZXRob2RzCiAgICBmbiBpbml0aWFsaXplX2Z1bmN0aW9uX2RhdGEoJm11dCBzZWxmLCBwb2ludHM6IGkzMikgewogICAgICAgIHNlbGYuaW50ZWdyYXRpb25fcG9pbnRzID0gcG9pbnRzOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHBvaW50cykgewogICAgICAgICAgICBzZWxmLmZ1bmN0aW9uX3ZhbHVlc1tpIGFzIHVzaXplXSA9IGdldEludCgpOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFRyYXBlem9pZGFsIHJ1bGUgaW50ZWdyYXRpb24KICAgIGZuIHRyYXBlem9pZGFsX2ludGVncmF0aW9uKCZtdXQgc2VsZiwgc3RlcF9zaXplOiBpMzIpIC0+IGkzMiB7CiAgICAgICAgbGV0IG11dCByZXN1bHQ6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi5pbnRlZ3JhdGlvbl9wb2ludHMgLSAxKSB7CiAgICAgICAgICAgIHJlc3VsdCArPSAoc2VsZi5mdW5jdGlvbl92YWx1ZXNbaSBhcyB1c2l6ZV0gKyBzZWxmLmZ1bmN0aW9uX3ZhbHVlc1soaSArIDEpIGFzIHVzaXplXSkKICAgICAgICAgICAgICAgICogc3RlcF9zaXplCiAgICAgICAgICAgICAgICAvIDI7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAvLyBTaW1wc29uJ3MgcnVsZSBpbnRlZ3JhdGlvbgogICAgZm4gc2ltcHNvbl9pbnRlZ3JhdGlvbigmbXV0IHNlbGYsIHN0ZXBfc2l6ZTogaTMyKSAtPiBpMzIgewogICAgICAgIGxldCBtdXQgcmVzdWx0OiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuaW50ZWdyYXRpb25fcG9pbnRzIC0gMikgewogICAgICAgICAgICByZXN1bHQgKz0gc3RlcF9zaXplCiAgICAgICAgICAgICAgICAqIChzZWxmLmZ1bmN0aW9uX3ZhbHVlc1tpIGFzIHVzaXplXQogICAgICAgICAgICAgICAgICAgICsgNCAqIHNlbGYuZnVuY3Rpb25fdmFsdWVzWyhpICsgMSkgYXMgdXNpemVdCiAgICAgICAgICAgICAgICAgICAgKyBzZWxmLmZ1bmN0aW9uX3ZhbHVlc1soaSArIDIpIGFzIHVzaXplXSkKICAgICAgICAgICAgICAgIC8gMzsKICAgICAgICAgICAgaSArPSAyOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIC8vIFNpbXBsaWZpZWQgRmFzdCBGb3VyaWVyIFRyYW5zZm9ybSBmb3IgaW50ZWdlcnMKICAgIGZuIGluaXRpYWxpemVfZmZ0X2RhdGEoJm11dCBzZWxmLCBzaXplOiBpMzIpIHsKICAgICAgICBzZWxmLmZmdF9zaXplID0gc2l6ZTsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgICAgIHNlbGYucmVhbF9wYXJ0W2kgYXMgdXNpemVdID0gZ2V0SW50KCk7CiAgICAgICAgICAgIHNlbGYuaW1hZ19wYXJ0W2kgYXMgdXNpemVdID0gMDsgLy8gSW5pdGlhbGl6ZSBpbWFnaW5hcnkgcGFydHMgdG8gMAogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFNpbXBsaWZpZWQgRkZUIGltcGxlbWVudGF0aW9uIChDb29sZXktVHVrZXkgYWxnb3JpdGhtKQogICAgZm4gY29tcHV0ZV9mZnQoJm11dCBzZWxmKSB7CiAgICAgICAgbGV0IG46IGkzMiA9IHNlbGYuZmZ0X3NpemU7CgogICAgICAgIC8vIEJpdC1yZXZlcnNhbCBwZXJtdXRhdGlvbgogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDE7CiAgICAgICAgd2hpbGUgKGkgPCBuKSB7CiAgICAgICAgICAgIGxldCBtdXQgYml0OiBpMzIgPSBuIC8gMjsKICAgICAgICAgICAgd2hpbGUgKGogPj0gYml0KSB7CiAgICAgICAgICAgICAgICBqIC09IGJpdDsKICAgICAgICAgICAgICAgIGJpdCAvPSAyOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogKz0gYml0OwoKICAgICAgICAgICAgaWYgKGkgPCBqKSB7CiAgICAgICAgICAgICAgICAvLyBTd2FwIHJlYWwgcGFydHMKICAgICAgICAgICAgICAgIGxldCB0ZW1wX3JlYWw6IGkzMiA9IHNlbGYucmVhbF9wYXJ0W2kgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgc2VsZi5yZWFsX3BhcnRbaSBhcyB1c2l6ZV0gPSBzZWxmLnJlYWxfcGFydFtqIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIHNlbGYucmVhbF9wYXJ0W2ogYXMgdXNpemVdID0gdGVtcF9yZWFsOwoKICAgICAgICAgICAgICAgIC8vIFN3YXAgaW1hZ2luYXJ5IHBhcnRzCiAgICAgICAgICAgICAgICBsZXQgdGVtcF9pbWFnOiBpMzIgPSBzZWxmLmltYWdfcGFydFtpIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIHNlbGYuaW1hZ19wYXJ0W2kgYXMgdXNpemVdID0gc2VsZi5pbWFnX3BhcnRbaiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBzZWxmLmltYWdfcGFydFtqIGFzIHVzaXplXSA9IHRlbXBfaW1hZzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBDb29sZXktVHVrZXkgRkZUCiAgICAgICAgbGV0IG11dCBsZW5ndGg6IGkzMiA9IDI7CiAgICAgICAgd2hpbGUgKGxlbmd0aCA8PSBuKSB7CiAgICAgICAgICAgIGxldCBoYWxmX2xlbmd0aDogaTMyID0gbGVuZ3RoIC8gMjsKCiAgICAgICAgICAgIC8vIFNpbXBsaWZpZWQgdHdpZGRsZSBmYWN0b3IgY2FsY3VsYXRpb24gKHVzaW5nIGFwcHJveGltYXRpb24pCiAgICAgICAgICAgIGxldCBhbmdsZV9zdGVwOiBpMzIgPSA2MjgzIC8gbGVuZ3RoOyAvLyBBcHByb3hpbWF0aW9uIG9mIDIqcGkgc2NhbGVkCgogICAgICAgICAgICBpID0gMDsKICAgICAgICAgICAgd2hpbGUgKGkgPCBuKSB7CiAgICAgICAgICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICAgICAgICAgICAgICB3aGlsZSAoayA8IGhhbGZfbGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFuZ2xlOiBpMzIgPSBrICogYW5nbGVfc3RlcDsKICAgICAgICAgICAgICAgICAgICAvLyBTaW1wbGlmaWVkIGNvcyBhbmQgc2luIHVzaW5nIFRheWxvciBzZXJpZXMgYXBwcm94aW1hdGlvbgogICAgICAgICAgICAgICAgICAgIGxldCBjb3NfdmFsOiBpMzIgPSAxMDAwIC0gKGFuZ2xlICogYW5nbGUpIC8gMjAwMDsgLy8gU2NhbGVkIGNvcyBhcHByb3hpbWF0aW9uCiAgICAgICAgICAgICAgICAgICAgbGV0IHNpbl92YWw6IGkzMiA9IGFuZ2xlIC0gKGFuZ2xlICogYW5nbGUpLzYwMDAgKiBhbmdsZTsgLy8gU2NhbGVkIHNpbiBhcHByb3hpbWF0aW9uCgogICAgICAgICAgICAgICAgICAgIGxldCBldmVuX2lkeDogdXNpemUgPSAoaSArIGspIGFzIHVzaXplOwogICAgICAgICAgICAgICAgICAgIGxldCBvZGRfaWR4OiB1c2l6ZSA9IChpICsgayArIGhhbGZfbGVuZ3RoKSBhcyB1c2l6ZTsKCiAgICAgICAgICAgICAgICAgICAgbGV0IGV2ZW5fcmVhbDogaTMyID0gc2VsZi5yZWFsX3BhcnRbZXZlbl9pZHggYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIGxldCBldmVuX2ltYWc6IGkzMiA9IHNlbGYuaW1hZ19wYXJ0W2V2ZW5faWR4IGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICBsZXQgb2RkX3JlYWw6IGkzMiA9IHNlbGYucmVhbF9wYXJ0W29kZF9pZHggYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIGxldCBvZGRfaW1hZzogaTMyID0gc2VsZi5pbWFnX3BhcnRbb2RkX2lkeCBhcyB1c2l6ZV07CgogICAgICAgICAgICAgICAgICAgIC8vIENvbXBsZXggbXVsdGlwbGljYXRpb246IChvZGRfcmVhbCArIGkqb2RkX2ltYWcpICogKGNvc192YWwgKyBpKnNpbl92YWwpCiAgICAgICAgICAgICAgICAgICAgbGV0IHR3aWRkbGVfcmVhbDogaTMyID0gb2RkX3JlYWwgLyAxMDAwICogY29zX3ZhbCAtIG9kZF9pbWFnIC8gMTAwMCAqIHNpbl92YWw7CiAgICAgICAgICAgICAgICAgICAgbGV0IHR3aWRkbGVfaW1hZzogaTMyID0gb2RkX3JlYWwgLyAxMDAwICogc2luX3ZhbCArIG9kZF9pbWFnIC8gMTAwMCAqIGNvc192YWw7CgogICAgICAgICAgICAgICAgICAgIHNlbGYucmVhbF9wYXJ0W2V2ZW5faWR4IGFzIHVzaXplXSA9IGV2ZW5fcmVhbCArIHR3aWRkbGVfcmVhbDsKICAgICAgICAgICAgICAgICAgICBzZWxmLmltYWdfcGFydFtldmVuX2lkeCBhcyB1c2l6ZV0gPSBldmVuX2ltYWcgKyB0d2lkZGxlX2ltYWc7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWFsX3BhcnRbb2RkX2lkeCBhcyB1c2l6ZV0gPSBldmVuX3JlYWwgLSB0d2lkZGxlX3JlYWw7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5pbWFnX3BhcnRbb2RkX2lkeCBhcyB1c2l6ZV0gPSBldmVuX2ltYWcgLSB0d2lkZGxlX2ltYWc7CgogICAgICAgICAgICAgICAgICAgIGsgKz0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGkgKz0gbGVuZ3RoOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsZW5ndGggKj0gMjsKICAgICAgICB9CiAgICB9CgogICAgLy8gUHJpbWUgbnVtYmVyIGdlbmVyYXRpb24gdXNpbmcgU2lldmUgb2YgRXJhdG9zdGhlbmVzCiAgICBmbiBnZW5lcmF0ZV9wcmltZXMoJm11dCBzZWxmLCBsaW1pdDogaTMyKSB7CiAgICAgICAgbGV0IG11dCBpc19wcmltZTogW2Jvb2w7IDEwMDAwXSA9IFt0cnVlOyAxMDAwMF07CiAgICAgICAgaXNfcHJpbWVbMF0gPSBmYWxzZTsKICAgICAgICBpc19wcmltZVsxXSA9IGZhbHNlOwoKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDI7CiAgICAgICAgd2hpbGUgKGkgKiBpIDw9IGxpbWl0KSB7CiAgICAgICAgICAgIGlmIChpc19wcmltZVtpIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSBpICogaTsKICAgICAgICAgICAgICAgIHdoaWxlIChqIDw9IGxpbWl0KSB7CiAgICAgICAgICAgICAgICAgICAgaXNfcHJpbWVbaiBhcyB1c2l6ZV0gPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBqICs9IGk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgc2VsZi5wcmltZV9jb3VudCA9IDA7CiAgICAgICAgaSA9IDI7CiAgICAgICAgd2hpbGUgKGkgPD0gbGltaXQgJiYgc2VsZi5wcmltZV9jb3VudCA8IDEwMDApIHsKICAgICAgICAgICAgaWYgKGlzX3ByaW1lW2kgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBzZWxmLnByaW1lc1tzZWxmLnByaW1lX2NvdW50IGFzIHVzaXplXSA9IGk7CiAgICAgICAgICAgICAgICBzZWxmLnByaW1lX2NvdW50ICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBQcmltZSBmYWN0b3JpemF0aW9uIHVzaW5nIHRyaWFsIGRpdmlzaW9uCiAgICBmbiBwcmltZV9mYWN0b3JpemUoJm11dCBzZWxmLCBudW1iZXI6IGkzMikgLT4gaTMyIHsKICAgICAgICBsZXQgbXV0IG46IGkzMiA9IG51bWJlcjsKICAgICAgICBsZXQgbXV0IGZhY3Rvcl9jb3VudDogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgICAgIHdoaWxlIChpIDwgc2VsZi5wcmltZV9jb3VudCAmJiBzZWxmLnByaW1lc1tpIGFzIHVzaXplXSAqIHNlbGYucHJpbWVzW2kgYXMgdXNpemVdIDw9IG4pIHsKICAgICAgICAgICAgd2hpbGUgKG4gJSBzZWxmLnByaW1lc1tpIGFzIHVzaXplXSA9PSAwKSB7CiAgICAgICAgICAgICAgICBzZWxmLmZhY3Rvcml6YXRpb25zWzBdW2ZhY3Rvcl9jb3VudCBhcyB1c2l6ZV0gPSBzZWxmLnByaW1lc1tpIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGZhY3Rvcl9jb3VudCArPSAxOwogICAgICAgICAgICAgICAgbiAvPSBzZWxmLnByaW1lc1tpIGFzIHVzaXplXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBpZiAobiA+IDEpIHsKICAgICAgICAgICAgc2VsZi5mYWN0b3JpemF0aW9uc1swXVtmYWN0b3JfY291bnQgYXMgdXNpemVdID0gbjsKICAgICAgICAgICAgZmFjdG9yX2NvdW50ICs9IDE7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFjdG9yX2NvdW50OwogICAgfQoKICAgIC8vIFN0YXRpc3RpY2FsIGFuYWx5c2lzIGZ1bmN0aW9ucwogICAgZm4gaW5pdGlhbGl6ZV9kYXRhX3NlcmllcygmbXV0IHNlbGYsIGxlbmd0aDogaTMyKSB7CiAgICAgICAgc2VsZi5zZXJpZXNfbGVuZ3RoID0gbGVuZ3RoOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IGxlbmd0aCkgewogICAgICAgICAgICBzZWxmLmRhdGFfc2VyaWVzW2kgYXMgdXNpemVdID0gZ2V0SW50KCk7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CiAgICB9CgogICAgLy8gQ2FsY3VsYXRlIHN0YXRpc3RpY2FsIG1vbWVudHMKICAgIGZuIGNhbGN1bGF0ZV9tb21lbnRzKCZtdXQgc2VsZikgewogICAgICAgIC8vIENhbGN1bGF0ZSBtZWFuCiAgICAgICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi5zZXJpZXNfbGVuZ3RoKSB7CiAgICAgICAgICAgIHN1bSArPSBzZWxmLmRhdGFfc2VyaWVzW2kgYXMgdXNpemVdOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgICAgIGxldCBtZWFuOiBpMzIgPSBzdW0gLyBzZWxmLnNlcmllc19sZW5ndGg7CiAgICAgICAgc2VsZi5tb21lbnRzWzBdID0gbWVhbjsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIHZhcmlhbmNlIGFuZCBoaWdoZXIgbW9tZW50cwogICAgICAgIGxldCBtdXQgc3VtMjogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IHN1bTM6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBzdW00OiBpMzIgPSAwOwoKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuc2VyaWVzX2xlbmd0aCkgewogICAgICAgICAgICBsZXQgZGlmZjogaTMyID0gc2VsZi5kYXRhX3Nlcmllc1tpIGFzIHVzaXplXSAtIG1lYW47CiAgICAgICAgICAgIGxldCBkaWZmMjogaTMyID0gZGlmZiAqIGRpZmY7CiAgICAgICAgICAgIGxldCBkaWZmMzogaTMyID0gZGlmZjIgKiBkaWZmOwogICAgICAgICAgICBsZXQgZGlmZjQ6IGkzMiA9IGRpZmYzICogZGlmZjsKCiAgICAgICAgICAgIHN1bTIgKz0gZGlmZjI7CiAgICAgICAgICAgIHN1bTMgKz0gZGlmZjM7CiAgICAgICAgICAgIHN1bTQgKz0gZGlmZjQ7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIHNlbGYubW9tZW50c1sxXSA9IHN1bTIgLyBzZWxmLnNlcmllc19sZW5ndGg7IC8vIFZhcmlhbmNlCiAgICAgICAgc2VsZi5tb21lbnRzWzJdID0gc3VtMyAvIHNlbGYuc2VyaWVzX2xlbmd0aDsgLy8gU2tld25lc3MgbnVtZXJhdG9yCiAgICAgICAgc2VsZi5tb21lbnRzWzNdID0gc3VtNCAvIHNlbGYuc2VyaWVzX2xlbmd0aDsgLy8gS3VydG9zaXMgbnVtZXJhdG9yCgogICAgICAgIC8vIENhbGN1bGF0ZSBhZGRpdGlvbmFsIHN0YXRpc3RpY3MKICAgICAgICBsZXQgbXV0IG1pbl92YWw6IGkzMiA9IHNlbGYuZGF0YV9zZXJpZXNbMF07CiAgICAgICAgbGV0IG11dCBtYXhfdmFsOiBpMzIgPSBzZWxmLmRhdGFfc2VyaWVzWzBdOwoKICAgICAgICBpID0gMTsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuc2VyaWVzX2xlbmd0aCkgewogICAgICAgICAgICBpZiAoc2VsZi5kYXRhX3Nlcmllc1tpIGFzIHVzaXplXSA8IG1pbl92YWwpIHsKICAgICAgICAgICAgICAgIG1pbl92YWwgPSBzZWxmLmRhdGFfc2VyaWVzW2kgYXMgdXNpemVdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChzZWxmLmRhdGFfc2VyaWVzW2kgYXMgdXNpemVdID4gbWF4X3ZhbCkgewogICAgICAgICAgICAgICAgbWF4X3ZhbCA9IHNlbGYuZGF0YV9zZXJpZXNbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgc2VsZi5tb21lbnRzWzRdID0gbWluX3ZhbDsKICAgICAgICBzZWxmLm1vbWVudHNbNV0gPSBtYXhfdmFsOwogICAgICAgIHNlbGYubW9tZW50c1s2XSA9IG1heF92YWwgLSBtaW5fdmFsOyAvLyBSYW5nZQogICAgfQoKICAgIC8vIENvbXByZWhlbnNpdmUgbWF0aGVtYXRpY2FsIGFuYWx5c2lzCiAgICBmbiBwZXJmb3JtX2NvbXByZWhlbnNpdmVfYW5hbHlzaXMoJm11dCBzZWxmKSB7CiAgICAgICAgLy8gTWF0cml4IG9wZXJhdGlvbnMKICAgICAgICBzZWxmLm1hdHJpeF9tdWx0aXBseSgpOwogICAgICAgIGxldCBkZXQ6IGkzMiA9IHNlbGYuY2FsY3VsYXRlX2RldGVybWluYW50KCk7CiAgICAgICAgc2VsZi5jb21wdXRhdGlvbl9sb2dbc2VsZi5sb2dfc2l6ZSBhcyB1c2l6ZV0gPSBkZXQ7CiAgICAgICAgc2VsZi5sb2dfc2l6ZSArPSAxOwoKICAgICAgICBzZWxmLm1hdHJpeF9vcGVyYXRpb25zX3N1aXRlKCk7CgogICAgICAgIC8vIFBvbHlub21pYWwgYW5hbHlzaXMKICAgICAgICBzZWxmLmZpbmRfcG9seW5vbWlhbF9yb290cygpOwogICAgICAgIHNlbGYuY29tcHV0YXRpb25fbG9nW3NlbGYubG9nX3NpemUgYXMgdXNpemVdID0gc2VsZi5yb290X2NvdW50OwogICAgICAgIHNlbGYubG9nX3NpemUgKz0gMTsKCiAgICAgICAgLy8gTnVtZXJpY2FsIGludGVncmF0aW9uCiAgICAgICAgbGV0IHRyYXBlem9pZGFsX3Jlc3VsdDogaTMyID0gc2VsZi50cmFwZXpvaWRhbF9pbnRlZ3JhdGlvbigxKTsKICAgICAgICBsZXQgc2ltcHNvbl9yZXN1bHQ6IGkzMiA9IHNlbGYuc2ltcHNvbl9pbnRlZ3JhdGlvbigxKTsKICAgICAgICBzZWxmLmludGVncmF0aW9uX3Jlc3VsdHNbMF0gPSB0cmFwZXpvaWRhbF9yZXN1bHQ7CiAgICAgICAgc2VsZi5pbnRlZ3JhdGlvbl9yZXN1bHRzWzFdID0gc2ltcHNvbl9yZXN1bHQ7CgogICAgICAgIC8vIEZGVCBhbmFseXNpcwogICAgICAgIHNlbGYuY29tcHV0ZV9mZnQoKTsKICAgICAgICBsZXQgbXV0IGZmdF9tYWduaXR1ZGU6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi5mZnRfc2l6ZSkgewogICAgICAgICAgICBsZXQgcmVhbDogaTMyID0gc2VsZi5yZWFsX3BhcnRbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGxldCBpbWFnOiBpMzIgPSBzZWxmLmltYWdfcGFydFtpIGFzIHVzaXplXTsKICAgICAgICAgICAgZmZ0X21hZ25pdHVkZSArPSByZWFsICogcmVhbCArIGltYWcgKiBpbWFnOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgICAgIHNlbGYuY29tcHV0YXRpb25fbG9nW3NlbGYubG9nX3NpemUgYXMgdXNpemVdID0gZmZ0X21hZ25pdHVkZTsKICAgICAgICBzZWxmLmxvZ19zaXplICs9IDE7CgogICAgICAgIC8vIFByaW1lIGFuYWx5c2lzCiAgICAgICAgbGV0IGZhY3RvcnM6IGkzMiA9IHNlbGYucHJpbWVfZmFjdG9yaXplKDEyMzQ1KTsKICAgICAgICBzZWxmLmNvbXB1dGF0aW9uX2xvZ1tzZWxmLmxvZ19zaXplIGFzIHVzaXplXSA9IGZhY3RvcnM7CiAgICAgICAgc2VsZi5sb2dfc2l6ZSArPSAxOwoKICAgICAgICAvLyBTdGF0aXN0aWNhbCBhbmFseXNpcwogICAgICAgIHNlbGYuY2FsY3VsYXRlX21vbWVudHMoKTsKCiAgICAgICAgLy8gT3V0cHV0IGFsbCByZXN1bHRzCiAgICAgICAgc2VsZi5vdXRwdXRfY29tcHJlaGVuc2l2ZV9yZXN1bHRzKCk7CiAgICB9CgogICAgZm4gb3V0cHV0X2NvbXByZWhlbnNpdmVfcmVzdWx0cygmc2VsZikgewogICAgICAgIC8vIE91dHB1dCBjb21wdXRhdGlvbiBsb2cKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLmxvZ19zaXplKSB7CiAgICAgICAgICAgIHByaW50bG5JbnQoc2VsZi5jb21wdXRhdGlvbl9sb2dbaSBhcyB1c2l6ZV0pOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBPdXRwdXQgc3RhdGlzdGljYWwgbW9tZW50cwogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgNykgewogICAgICAgICAgICBwcmludGxuSW50KHNlbGYubW9tZW50c1tpIGFzIHVzaXplXSk7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIE91dHB1dCBpbnRlZ3JhdGlvbiByZXN1bHRzCiAgICAgICAgcHJpbnRsbkludChzZWxmLmludGVncmF0aW9uX3Jlc3VsdHNbMF0pOwogICAgICAgIHByaW50bG5JbnQoc2VsZi5pbnRlZ3JhdGlvbl9yZXN1bHRzWzFdKTsKCiAgICAgICAgLy8gT3V0cHV0IHBvbHlub21pYWwgcm9vdHMKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYucm9vdF9jb3VudCAmJiBpIDwgNSkgewogICAgICAgICAgICBwcmludGxuSW50KHNlbGYucm9vdHNbaSBhcyB1c2l6ZV0pOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBPdXRwdXQgcHJpbWUgaW5mb3JtYXRpb24KICAgICAgICBwcmludGxuSW50KHNlbGYucHJpbWVfY291bnQpOwoKICAgICAgICAvLyBGaW5hbCBjb21wcmVoZW5zaXZlIG1ldHJpYwogICAgICAgIGxldCBjb21wbGV4aXR5X3Njb3JlOiBpMzIgPQogICAgICAgICAgICAoc2VsZi5jb21wdXRhdGlvbl9sb2dbMF0gKyBzZWxmLm1vbWVudHNbMF0gKyBzZWxmLmludGVncmF0aW9uX3Jlc3VsdHNbMF0pIC8gMzsKICAgICAgICBwcmludGxuSW50KGNvbXBsZXhpdHlfc2NvcmUpOwogICAgfQp9CgpmbiBtYWluKCkgewogICAgbGV0IG11dCBtYXRoX2VuZ2luZTogTWF0aEVuZ2luZSA9IE1hdGhFbmdpbmU6Om5ldygpOwoKICAgIC8vIEluaXRpYWxpemUgbWF0cmljZXMKICAgIGxldCBtYXRyaXhfc2l6ZTogaTMyID0gZ2V0SW50KCk7CiAgICBtYXRoX2VuZ2luZS5pbml0aWFsaXplX21hdHJpY2VzKG1hdHJpeF9zaXplKTsKCiAgICAvLyBJbml0aWFsaXplIHBvbHlub21pYWwKICAgIGxldCBwb2x5X2RlZ3JlZTogaTMyID0gZ2V0SW50KCk7CiAgICBtYXRoX2VuZ2luZS5pbml0aWFsaXplX3BvbHlub21pYWwocG9seV9kZWdyZWUpOwoKICAgIC8vIEluaXRpYWxpemUgZnVuY3Rpb24gZGF0YSBmb3IgaW50ZWdyYXRpb24KICAgIGxldCBpbnRlZ3JhdGlvbl9wb2ludHM6IGkzMiA9IGdldEludCgpOwogICAgbWF0aF9lbmdpbmUuaW5pdGlhbGl6ZV9mdW5jdGlvbl9kYXRhKGludGVncmF0aW9uX3BvaW50cyk7CgogICAgLy8gSW5pdGlhbGl6ZSBGRlQgZGF0YQogICAgbGV0IGZmdF9zaXplOiBpMzIgPSBnZXRJbnQoKTsKICAgIG1hdGhfZW5naW5lLmluaXRpYWxpemVfZmZ0X2RhdGEoZmZ0X3NpemUpOwoKICAgIC8vIEluaXRpYWxpemUgc3RhdGlzdGljYWwgZGF0YQogICAgbGV0IHNlcmllc19sZW5ndGg6IGkzMiA9IGdldEludCgpOwogICAgbWF0aF9lbmdpbmUuaW5pdGlhbGl6ZV9kYXRhX3NlcmllcyhzZXJpZXNfbGVuZ3RoKTsKCiAgICAvLyBHZW5lcmF0ZSBwcmltZXMgdXAgdG8gYSBsaW1pdAogICAgbGV0IHByaW1lX2xpbWl0OiBpMzIgPSBnZXRJbnQoKTsKICAgIG1hdGhfZW5naW5lLmdlbmVyYXRlX3ByaW1lcyhwcmltZV9saW1pdCk7CgogICAgLy8gUGVyZm9ybSBjb21wcmVoZW5zaXZlIG1hdGhlbWF0aWNhbCBhbmFseXNpcwogICAgbWF0aF9lbmdpbmUucGVyZm9ybV9jb21wcmVoZW5zaXZlX2FuYWx5c2lzKCk7CgogICAgLy8gQWRkaXRpb25hbCBjb21wdXRhdGlvbmFsIHN0cmVzcyB0ZXN0aW5nCiAgICBsZXQgaXRlcmF0aW9uczogaTMyID0gZ2V0SW50KCk7CiAgICBsZXQgbXV0IHRvdGFsX2NvbXB1dGF0aW9uYWxfd29yazogaTMyID0gMDsKCiAgICBsZXQgbXV0IGl0ZXI6IGkzMiA9IDA7CiAgICB3aGlsZSAoaXRlciA8IGl0ZXJhdGlvbnMpIHsKICAgICAgICAvLyBNb2RpZnkgZGF0YSBhbmQgcmVjb21wdXRlCiAgICAgICAgbGV0IG1vZGlmaWVyOiBpMzIgPSAoaXRlciAqIDEzICsgNykgJSAxMDA7CgogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IG1hdGhfZW5naW5lLnNlcmllc19sZW5ndGgpIHsKICAgICAgICAgICAgbWF0aF9lbmdpbmUuZGF0YV9zZXJpZXNbaSBhcyB1c2l6ZV0gPQogICAgICAgICAgICAgICAgKG1hdGhfZW5naW5lLmRhdGFfc2VyaWVzW2kgYXMgdXNpemVdICsgbW9kaWZpZXIpICUgMTAwMDA7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIG1hdGhfZW5naW5lLmNhbGN1bGF0ZV9tb21lbnRzKCk7CiAgICAgICAgdG90YWxfY29tcHV0YXRpb25hbF93b3JrICs9IG1hdGhfZW5naW5lLm1vbWVudHNbMF0gKyBtYXRoX2VuZ2luZS5tb21lbnRzWzFdOwoKICAgICAgICBpdGVyICs9IDE7CiAgICBwcmludGxuSW50KGl0ZXIpOwp9CgogICAgcHJpbnRsbkludCh0b3RhbF9jb21wdXRhdGlvbmFsX3dvcmspOwoKICAgIC8vIEZpbmFsIG1hdGhlbWF0aWNhbCBjb21wbGV4aXR5IGFuYWx5c2lzCiAgICBsZXQgZmluYWxfY29tcGxleGl0eTogaTMyID0KICAgICAgICAodG90YWxfY29tcHV0YXRpb25hbF93b3JrICogbWF0aF9lbmdpbmUucHJpbWVfY291bnQpIC8gKGl0ZXJhdGlvbnMgKyAxKTsKICAgIHByaW50bG5JbnQoZmluYWxfY29tcGxleGl0eSk7CiAgICBleGl0KDApOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (14, "comprehensive14", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCAxNDogQWR2YW5jZWQgRGF0YSBTdHJ1Y3R1cmVzIGFuZCBNZW1vcnkgTWFuYWdlbWVudCBTaW11bGF0aW9uClN1bW1hcnk6IFRoaXMgdGVzdCBpbXBsZW1lbnRzIGNvbXBsZXggZGF0YSBzdHJ1Y3R1cmVzIGFuZCBzaW11bGF0ZXMgbWVtb3J5IG1hbmFnZW1lbnQ6CkRldGFpbHM6CjEuIEFkdmFuY2VkIEJpbmFyeSBTZWFyY2ggVHJlZSB3aXRoIGJhbGFuY2luZyBvcGVyYXRpb25zCjIuIEhhc2ggVGFibGUgd2l0aCBjb2xsaXNpb24gcmVzb2x1dGlvbiBhbmQgZHluYW1pYyByZXNpemluZwozLiBDb21wbGV4IGxpbmtlZCBsaXN0IG9wZXJhdGlvbnMgd2l0aCBtZXJnZSBhbmQgc3BsaXQKNC4gTWVtb3J5IHBvb2wgc2ltdWxhdGlvbiB3aXRoIGFsbG9jYXRpb24gYW5kIGRlYWxsb2NhdGlvbgo1LiBDYWNoZSBzaW11bGF0aW9uIHdpdGggTFJVIHJlcGxhY2VtZW50IHBvbGljeQo2LiBEYXRhYmFzZS1saWtlIG9wZXJhdGlvbnMgd2l0aCBpbmRleGluZyBhbmQgcXVlcnlpbmcKKi8KCi8vIENvbXByZWhlbnNpdmUgVGVzdCAxNDogQWR2YW5jZWQgRGF0YSBTdHJ1Y3R1cmVzIGFuZCBNZW1vcnkgTWFuYWdlbWVudCBTaW11bGF0aW9uCi8vIFRoaXMgdGVzdCBpbXBsZW1lbnRzIGNvbXBsZXggZGF0YSBzdHJ1Y3R1cmVzIGFuZCBzaW11bGF0ZXMgbWVtb3J5IG1hbmFnZW1lbnQ6Ci8vIDEuIEFkdmFuY2VkIEJpbmFyeSBTZWFyY2ggVHJlZSB3aXRoIGJhbGFuY2luZyBvcGVyYXRpb25zCi8vIDIuIEhhc2ggVGFibGUgd2l0aCBjb2xsaXNpb24gcmVzb2x1dGlvbiBhbmQgZHluYW1pYyByZXNpemluZwovLyAzLiBDb21wbGV4IGxpbmtlZCBsaXN0IG9wZXJhdGlvbnMgd2l0aCBtZXJnZSBhbmQgc3BsaXQKLy8gNC4gTWVtb3J5IHBvb2wgc2ltdWxhdGlvbiB3aXRoIGFsbG9jYXRpb24gYW5kIGRlYWxsb2NhdGlvbgovLyA1LiBDYWNoZSBzaW11bGF0aW9uIHdpdGggTFJVIHJlcGxhY2VtZW50IHBvbGljeQovLyA2LiBEYXRhYmFzZS1saWtlIG9wZXJhdGlvbnMgd2l0aCBpbmRleGluZyBhbmQgcXVlcnlpbmcKCi8vIE5vZGUgc3RydWN0dXJlIGZvciB2YXJpb3VzIGRhdGEgc3RydWN0dXJlcwoKc3RydWN0IE5vZGUgewogICAgdmFsdWU6IGkzMiwKICAgIGtleTogaTMyLAogICAgaGVpZ2h0OiBpMzIsCiAgICBiYWxhbmNlX2ZhY3RvcjogaTMyLAogICAgY29sb3I6IGJvb2wsIC8vIEZvciByZWQtYmxhY2sgdHJlZSBvcGVyYXRpb25zCiAgICBmcmVxdWVuY3k6IGkzMiwKICAgIHRpbWVzdGFtcDogaTMyLAogICAgbmV4dDogaTMyLAogICAgcHJldjogaTMyLAogICAgbGVmdDogaTMyLAogICAgcmlnaHQ6IGkzMiwKICAgIHBhcmVudDogaTMyLAp9CgovLyBBZHZhbmNlZCBBVkwgVHJlZSBpbXBsZW1lbnRhdGlvbgpzdHJ1Y3QgQVZMVHJlZSB7CiAgICBub2RlczogW05vZGU7IDIwMDBdLAogICAgbm9kZV9jb3VudDogaTMyLAogICAgcm9vdDogaTMyLAogICAgZnJlZV9saXN0OiBbaTMyOyAyMDAwXSwKICAgIGZyZWVfY291bnQ6IGkzMiwKICAgIAogICAgLy8gVHJlZSBzdGF0aXN0aWNzCiAgICB0cmVlX2hlaWdodDogaTMyLAogICAgbm9kZV9pbnNlcnRpb25zOiBpMzIsCiAgICBub2RlX2RlbGV0aW9uczogaTMyLAogICAgcm90YXRpb25fY291bnQ6IGkzMiwKICAgIHNlYXJjaF9vcGVyYXRpb25zOiBpMzIsCn0KCmltcGwgTm9kZSB7CiAgICBmbiBuZXcodmFsdWU6IGkzMiwga2V5OiBpMzIpIC0+IE5vZGUgewogICAgICAgIE5vZGUgewogICAgICAgICAgICB2YWx1ZTogdmFsdWUsCiAgICAgICAgICAgIGtleToga2V5LAogICAgICAgICAgICBoZWlnaHQ6IDEsCiAgICAgICAgICAgIGJhbGFuY2VfZmFjdG9yOiAwLAogICAgICAgICAgICBjb2xvcjogdHJ1ZSwgLy8gUmVkIGluaXRpYWxseQogICAgICAgICAgICBmcmVxdWVuY3k6IDEsCiAgICAgICAgICAgIHRpbWVzdGFtcDogMCwKICAgICAgICAgICAgbmV4dDogLTEsCiAgICAgICAgICAgIHByZXY6IC0xLAogICAgICAgICAgICBsZWZ0OiAtMSwKICAgICAgICAgICAgcmlnaHQ6IC0xLAogICAgICAgICAgICBwYXJlbnQ6IC0xLAogICAgICAgIH0KICAgIH0KfQoKaW1wbCBBVkxUcmVlIHsKICAgIGZuIG5ldygpIC0+IEFWTFRyZWUgewogICAgICAgIGxldCBtdXQgdHJlZTogQVZMVHJlZSA9IEFWTFRyZWUgewogICAgICAgICAgICBub2RlczogW05vZGU6Om5ldygwLCAwKTsgMjAwMF0sCiAgICAgICAgICAgIG5vZGVfY291bnQ6IDAsCiAgICAgICAgICAgIHJvb3Q6IC0xLAogICAgICAgICAgICBmcmVlX2xpc3Q6IFswOyAyMDAwXSwKICAgICAgICAgICAgZnJlZV9jb3VudDogMCwKICAgICAgICAgICAgdHJlZV9oZWlnaHQ6IDAsCiAgICAgICAgICAgIG5vZGVfaW5zZXJ0aW9uczogMCwKICAgICAgICAgICAgbm9kZV9kZWxldGlvbnM6IDAsCiAgICAgICAgICAgIHJvdGF0aW9uX2NvdW50OiAwLAogICAgICAgICAgICBzZWFyY2hfb3BlcmF0aW9uczogMCwKICAgICAgICB9OwogICAgICAgIAogICAgICAgIC8vIEluaXRpYWxpemUgZnJlZSBsaXN0CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgMjAwMCkgewogICAgICAgICAgICB0cmVlLmZyZWVfbGlzdFtpIGFzIHVzaXplXSA9IGk7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CiAgICAgICAgdHJlZS5mcmVlX2NvdW50ID0gMjAwMDsKICAgICAgICAKICAgICAgICByZXR1cm4gdHJlZTsKICAgIH0KICAgIAogICAgZm4gYWxsb2NhdGVfbm9kZSgmbXV0IHNlbGYsIHZhbHVlOiBpMzIsIGtleTogaTMyKSAtPiBpMzIgewogICAgICAgIGlmIChzZWxmLmZyZWVfY291bnQgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gLTE7IC8vIE5vIGZyZWUgbm9kZXMgYXZhaWxhYmxlCiAgICAgICAgfQogICAgICAgIAogICAgICAgIHNlbGYuZnJlZV9jb3VudCAtPSAxOwogICAgICAgIGxldCBub2RlX2luZGV4OiBpMzIgPSBzZWxmLmZyZWVfbGlzdFtzZWxmLmZyZWVfY291bnQgYXMgdXNpemVdOwogICAgICAgIHNlbGYubm9kZXNbbm9kZV9pbmRleCBhcyB1c2l6ZV0gPSBOb2RlOjpuZXcodmFsdWUsIGtleSk7CiAgICAgICAgc2VsZi5ub2RlX2NvdW50ICs9IDE7CiAgICAgICAgCiAgICAgICAgcmV0dXJuIG5vZGVfaW5kZXg7CiAgICB9CiAgICAKICAgIGZuIGRlYWxsb2NhdGVfbm9kZSgmbXV0IHNlbGYsIG5vZGVfaW5kZXg6IGkzMikgewogICAgICAgIGlmIChzZWxmLmZyZWVfY291bnQgPCAyMDAwKSB7CiAgICAgICAgICAgIHNlbGYuZnJlZV9saXN0W3NlbGYuZnJlZV9jb3VudCBhcyB1c2l6ZV0gPSBub2RlX2luZGV4OwogICAgICAgICAgICBzZWxmLmZyZWVfY291bnQgKz0gMTsKICAgICAgICAgICAgc2VsZi5ub2RlX2NvdW50IC09IDE7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmbiBnZXRfaGVpZ2h0KCZzZWxmLCBub2RlOiBpMzIpIC0+IGkzMiB7CiAgICAgICAgaWYgKG5vZGUgPT0gLTEpIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzZWxmLm5vZGVzW25vZGUgYXMgdXNpemVdLmhlaWdodDsKICAgIH0KICAgIAogICAgZm4gZ2V0X2JhbGFuY2UoJnNlbGYsIG5vZGU6IGkzMikgLT4gaTMyIHsKICAgICAgICBpZiAobm9kZSA9PSAtMSkgewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0X2hlaWdodChzZWxmLm5vZGVzW25vZGUgYXMgdXNpemVdLmxlZnQpIC0gc2VsZi5nZXRfaGVpZ2h0KHNlbGYubm9kZXNbbm9kZSBhcyB1c2l6ZV0ucmlnaHQpOwogICAgfQogICAgCiAgICBmbiB1cGRhdGVfaGVpZ2h0KCZtdXQgc2VsZiwgbm9kZTogaTMyKSB7CiAgICAgICAgaWYgKG5vZGUgIT0gLTEpIHsKICAgICAgICAgICAgbGV0IGxlZnRfaGVpZ2h0OiBpMzIgPSBzZWxmLmdldF9oZWlnaHQoc2VsZi5ub2Rlc1tub2RlIGFzIHVzaXplXS5sZWZ0KTsKICAgICAgICAgICAgbGV0IHJpZ2h0X2hlaWdodDogaTMyID0gc2VsZi5nZXRfaGVpZ2h0KHNlbGYubm9kZXNbbm9kZSBhcyB1c2l6ZV0ucmlnaHQpOwogICAgICAgICAgICBzZWxmLm5vZGVzW25vZGUgYXMgdXNpemVdLmhlaWdodCA9IDEgKyBpZiAobGVmdF9oZWlnaHQgPiByaWdodF9oZWlnaHQpIHsgbGVmdF9oZWlnaHQgfSBlbHNlIHsgcmlnaHRfaGVpZ2h0IH07CiAgICAgICAgICAgIHNlbGYubm9kZXNbbm9kZSBhcyB1c2l6ZV0uYmFsYW5jZV9mYWN0b3IgPSBzZWxmLmdldF9iYWxhbmNlKG5vZGUpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgZm4gcmlnaHRfcm90YXRlKCZtdXQgc2VsZiwgeTogaTMyKSAtPiBpMzIgewogICAgICAgIGxldCB4OiBpMzIgPSBzZWxmLm5vZGVzW3kgYXMgdXNpemVdLmxlZnQ7CiAgICAgICAgbGV0IHQyOiBpMzIgPSBzZWxmLm5vZGVzW3ggYXMgdXNpemVdLnJpZ2h0OwogICAgICAgIAogICAgICAgIC8vIFBlcmZvcm0gcm90YXRpb24KICAgICAgICBzZWxmLm5vZGVzW3ggYXMgdXNpemVdLnJpZ2h0ID0geTsKICAgICAgICBzZWxmLm5vZGVzW3kgYXMgdXNpemVdLmxlZnQgPSB0MjsKICAgICAgICAKICAgICAgICAvLyBVcGRhdGUgcGFyZW50IHBvaW50ZXJzCiAgICAgICAgc2VsZi5ub2Rlc1t5IGFzIHVzaXplXS5wYXJlbnQgPSB4OwogICAgICAgIGlmICh0MiAhPSAtMSkgewogICAgICAgICAgICBzZWxmLm5vZGVzW3QyIGFzIHVzaXplXS5wYXJlbnQgPSB5OwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBVcGRhdGUgaGVpZ2h0cwogICAgICAgIHNlbGYudXBkYXRlX2hlaWdodCh5KTsKICAgICAgICBzZWxmLnVwZGF0ZV9oZWlnaHQoeCk7CiAgICAgICAgCiAgICAgICAgc2VsZi5yb3RhdGlvbl9jb3VudCArPSAxOwogICAgICAgIHJldHVybiB4OwogICAgfQogICAgCiAgICBmbiBsZWZ0X3JvdGF0ZSgmbXV0IHNlbGYsIHg6IGkzMikgLT4gaTMyIHsKICAgICAgICBsZXQgeTogaTMyID0gc2VsZi5ub2Rlc1t4IGFzIHVzaXplXS5yaWdodDsKICAgICAgICBsZXQgdDI6IGkzMiA9IHNlbGYubm9kZXNbeSBhcyB1c2l6ZV0ubGVmdDsKICAgICAgICAKICAgICAgICAvLyBQZXJmb3JtIHJvdGF0aW9uCiAgICAgICAgc2VsZi5ub2Rlc1t5IGFzIHVzaXplXS5sZWZ0ID0geDsKICAgICAgICBzZWxmLm5vZGVzW3ggYXMgdXNpemVdLnJpZ2h0ID0gdDI7CiAgICAgICAgCiAgICAgICAgLy8gVXBkYXRlIHBhcmVudCBwb2ludGVycwogICAgICAgIHNlbGYubm9kZXNbeCBhcyB1c2l6ZV0ucGFyZW50ID0geTsKICAgICAgICBpZiAodDIgIT0gLTEpIHsKICAgICAgICAgICAgc2VsZi5ub2Rlc1t0MiBhcyB1c2l6ZV0ucGFyZW50ID0geDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gVXBkYXRlIGhlaWdodHMKICAgICAgICBzZWxmLnVwZGF0ZV9oZWlnaHQoeCk7CiAgICAgICAgc2VsZi51cGRhdGVfaGVpZ2h0KHkpOwogICAgICAgIAogICAgICAgIHNlbGYucm90YXRpb25fY291bnQgKz0gMTsKICAgICAgICByZXR1cm4geTsKICAgIH0KICAgIAogICAgZm4gaW5zZXJ0KCZtdXQgc2VsZiwgcm9vdDogaTMyLCBrZXk6IGkzMiwgdmFsdWU6IGkzMikgLT4gaTMyIHsKICAgICAgICAvLyBTdGFuZGFyZCBCU1QgaW5zZXJ0aW9uCiAgICAgICAgaWYgKHJvb3QgPT0gLTEpIHsKICAgICAgICAgICAgbGV0IG5ld19ub2RlOiBpMzIgPSBzZWxmLmFsbG9jYXRlX25vZGUodmFsdWUsIGtleSk7CiAgICAgICAgICAgIHNlbGYubm9kZV9pbnNlcnRpb25zICs9IDE7CiAgICAgICAgICAgIHJldHVybiBuZXdfbm9kZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKGtleSA8IHNlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0ua2V5KSB7CiAgICAgICAgICAgIGxldCBuZXdfbGVmdDogaTMyID0gc2VsZi5pbnNlcnQoc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS5sZWZ0LCBrZXksIHZhbHVlKTsKICAgICAgICAgICAgc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS5sZWZ0ID0gbmV3X2xlZnQ7CiAgICAgICAgICAgIGlmIChuZXdfbGVmdCAhPSAtMSkgewogICAgICAgICAgICAgICAgc2VsZi5ub2Rlc1tuZXdfbGVmdCBhcyB1c2l6ZV0ucGFyZW50ID0gcm9vdDsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoa2V5ID4gc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS5rZXkpIHsKICAgICAgICAgICAgbGV0IG5ld19yaWdodDogaTMyID0gc2VsZi5pbnNlcnQoc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS5yaWdodCwga2V5LCB2YWx1ZSk7CiAgICAgICAgICAgIHNlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0ucmlnaHQgPSBuZXdfcmlnaHQ7CiAgICAgICAgICAgIGlmIChuZXdfcmlnaHQgIT0gLTEpIHsKICAgICAgICAgICAgICAgIHNlbGYubm9kZXNbbmV3X3JpZ2h0IGFzIHVzaXplXS5wYXJlbnQgPSByb290OwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gS2V5IGFscmVhZHkgZXhpc3RzLCB1cGRhdGUgdmFsdWUgYW5kIGZyZXF1ZW5jeQogICAgICAgICAgICBzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLnZhbHVlID0gdmFsdWU7CiAgICAgICAgICAgIHNlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0uZnJlcXVlbmN5ICs9IDE7CiAgICAgICAgICAgIHJldHVybiByb290OwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBVcGRhdGUgaGVpZ2h0IGFuZCBiYWxhbmNlIGZhY3RvcgogICAgICAgIHNlbGYudXBkYXRlX2hlaWdodChyb290KTsKICAgICAgICBsZXQgYmFsYW5jZTogaTMyID0gc2VsZi5nZXRfYmFsYW5jZShyb290KTsKICAgICAgICAKICAgICAgICAvLyBMZWZ0IExlZnQgQ2FzZQogICAgICAgIGlmIChiYWxhbmNlID4gMSAmJiBrZXkgPCBzZWxmLm5vZGVzW3NlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0ubGVmdCBhcyB1c2l6ZV0ua2V5KSB7CiAgICAgICAgICAgIHJldHVybiBzZWxmLnJpZ2h0X3JvdGF0ZShyb290KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gUmlnaHQgUmlnaHQgQ2FzZQogICAgICAgIGlmIChiYWxhbmNlIDwgLTEgJiYga2V5ID4gc2VsZi5ub2Rlc1tzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLnJpZ2h0IGFzIHVzaXplXS5rZXkpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbGYubGVmdF9yb3RhdGUocm9vdCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIExlZnQgUmlnaHQgQ2FzZQogICAgICAgIGlmIChiYWxhbmNlID4gMSAmJiBrZXkgPiBzZWxmLm5vZGVzW3NlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0ubGVmdCBhcyB1c2l6ZV0ua2V5KSB7CiAgICAgICAgICAgIGxldCBuZXdfbGVmdDogaTMyID0gc2VsZi5sZWZ0X3JvdGF0ZShzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLmxlZnQpOwogICAgICAgICAgICBzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLmxlZnQgPSBuZXdfbGVmdDsKICAgICAgICAgICAgaWYgKG5ld19sZWZ0ICE9IC0xKSB7CiAgICAgICAgICAgICAgICBzZWxmLm5vZGVzW25ld19sZWZ0IGFzIHVzaXplXS5wYXJlbnQgPSByb290OwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBzZWxmLnJpZ2h0X3JvdGF0ZShyb290KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gUmlnaHQgTGVmdCBDYXNlCiAgICAgICAgaWYgKGJhbGFuY2UgPCAtMSAmJiBrZXkgPCBzZWxmLm5vZGVzW3NlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0ucmlnaHQgYXMgdXNpemVdLmtleSkgewogICAgICAgICAgICBsZXQgbmV3X3JpZ2h0OiBpMzIgPSBzZWxmLnJpZ2h0X3JvdGF0ZShzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLnJpZ2h0KTsKICAgICAgICAgICAgc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS5yaWdodCA9IG5ld19yaWdodDsKICAgICAgICAgICAgaWYgKG5ld19yaWdodCAhPSAtMSkgewogICAgICAgICAgICAgICAgc2VsZi5ub2Rlc1tuZXdfcmlnaHQgYXMgdXNpemVdLnBhcmVudCA9IHJvb3Q7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHNlbGYubGVmdF9yb3RhdGUocm9vdCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiByb290OwogICAgfQogICAgCiAgICBmbiBzZWFyY2goJm11dCBzZWxmLCByb290OiBpMzIsIGtleTogaTMyKSAtPiBpMzIgewogICAgICAgIHNlbGYuc2VhcmNoX29wZXJhdGlvbnMgKz0gMTsKICAgICAgICAKICAgICAgICBpZiAocm9vdCA9PSAtMSB8fCBzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLmtleSA9PSBrZXkpIHsKICAgICAgICAgICAgcmV0dXJuIHJvb3Q7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmIChrZXkgPCBzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLmtleSkgewogICAgICAgICAgICByZXR1cm4gc2VsZi5zZWFyY2goc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS5sZWZ0LCBrZXkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBzZWxmLnNlYXJjaChzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLnJpZ2h0LCBrZXkpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgZm4gZmluZF9taW4oJnNlbGYsIHJvb3Q6IGkzMikgLT4gaTMyIHsKICAgICAgICBpZiAocm9vdCA9PSAtMSkgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGxldCBtdXQgY3VycmVudDogaTMyID0gcm9vdDsKICAgICAgICB3aGlsZSAoc2VsZi5ub2Rlc1tjdXJyZW50IGFzIHVzaXplXS5sZWZ0ICE9IC0xKSB7CiAgICAgICAgICAgIGN1cnJlbnQgPSBzZWxmLm5vZGVzW2N1cnJlbnQgYXMgdXNpemVdLmxlZnQ7CiAgICAgICAgfQogICAgICAgIHJldHVybiBjdXJyZW50OwogICAgfQogICAgCiAgICBmbiBkZWxldGVfbm9kZSgmbXV0IHNlbGYsIHJvb3Q6IGkzMiwga2V5OiBpMzIpIC0+IGkzMiB7CiAgICAgICAgaWYgKHJvb3QgPT0gLTEpIHsKICAgICAgICAgICAgcmV0dXJuIHJvb3Q7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmIChrZXkgPCBzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLmtleSkgewogICAgICAgICAgICBsZXQgbmV3X2xlZnQ6IGkzMiA9IHNlbGYuZGVsZXRlX25vZGUoc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS5sZWZ0LCBrZXkpOwogICAgICAgICAgICBzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLmxlZnQgPSBuZXdfbGVmdDsKICAgICAgICAgICAgaWYgKG5ld19sZWZ0ICE9IC0xKSB7CiAgICAgICAgICAgICAgICBzZWxmLm5vZGVzW25ld19sZWZ0IGFzIHVzaXplXS5wYXJlbnQgPSByb290OwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChrZXkgPiBzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLmtleSkgewogICAgICAgICAgICBsZXQgbmV3X3JpZ2h0OiBpMzIgPSBzZWxmLmRlbGV0ZV9ub2RlKHNlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0ucmlnaHQsIGtleSk7CiAgICAgICAgICAgIHNlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0ucmlnaHQgPSBuZXdfcmlnaHQ7CiAgICAgICAgICAgIGlmIChuZXdfcmlnaHQgIT0gLTEpIHsKICAgICAgICAgICAgICAgIHNlbGYubm9kZXNbbmV3X3JpZ2h0IGFzIHVzaXplXS5wYXJlbnQgPSByb290OwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gTm9kZSB0byBiZSBkZWxldGVkIGZvdW5kCiAgICAgICAgICAgIGlmIChzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLmZyZXF1ZW5jeSA+IDEpIHsKICAgICAgICAgICAgICAgIHNlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0uZnJlcXVlbmN5IC09IDE7CiAgICAgICAgICAgICAgICByZXR1cm4gcm9vdDsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLy8gTm9kZSB3aXRoIG9ubHkgb25lIGNoaWxkIG9yIG5vIGNoaWxkCiAgICAgICAgICAgIGlmIChzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLmxlZnQgPT0gLTEpIHsKICAgICAgICAgICAgICAgIGxldCB0ZW1wOiBpMzIgPSBzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLnJpZ2h0OwogICAgICAgICAgICAgICAgc2VsZi5kZWFsbG9jYXRlX25vZGUocm9vdCk7CiAgICAgICAgICAgICAgICBzZWxmLm5vZGVfZGVsZXRpb25zICs9IDE7CiAgICAgICAgICAgICAgICByZXR1cm4gdGVtcDsKICAgICAgICAgICAgfSBlbHNlIGlmIChzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLnJpZ2h0ID09IC0xKSB7CiAgICAgICAgICAgICAgICBsZXQgdGVtcDogaTMyID0gc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS5sZWZ0OwogICAgICAgICAgICAgICAgc2VsZi5kZWFsbG9jYXRlX25vZGUocm9vdCk7CiAgICAgICAgICAgICAgICBzZWxmLm5vZGVfZGVsZXRpb25zICs9IDE7CiAgICAgICAgICAgICAgICByZXR1cm4gdGVtcDsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLy8gTm9kZSB3aXRoIHR3byBjaGlsZHJlbgogICAgICAgICAgICBsZXQgdGVtcDogaTMyID0gc2VsZi5maW5kX21pbihzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLnJpZ2h0KTsKICAgICAgICAgICAgc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS5rZXkgPSBzZWxmLm5vZGVzW3RlbXAgYXMgdXNpemVdLmtleTsKICAgICAgICAgICAgc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS52YWx1ZSA9IHNlbGYubm9kZXNbdGVtcCBhcyB1c2l6ZV0udmFsdWU7CiAgICAgICAgICAgIHNlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0uZnJlcXVlbmN5ID0gc2VsZi5ub2Rlc1t0ZW1wIGFzIHVzaXplXS5mcmVxdWVuY3k7CiAgICAgICAgICAgIAogICAgICAgICAgICBsZXQgbmV3X3JpZ2h0OiBpMzIgPSBzZWxmLmRlbGV0ZV9ub2RlKHNlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0ucmlnaHQsIHNlbGYubm9kZXNbdGVtcCBhcyB1c2l6ZV0ua2V5KTsKICAgICAgICAgICAgc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS5yaWdodCA9IG5ld19yaWdodDsKICAgICAgICAgICAgaWYgKG5ld19yaWdodCAhPSAtMSkgewogICAgICAgICAgICAgICAgc2VsZi5ub2Rlc1tuZXdfcmlnaHQgYXMgdXNpemVdLnBhcmVudCA9IHJvb3Q7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gVXBkYXRlIGhlaWdodCBhbmQgYmFsYW5jZQogICAgICAgIHNlbGYudXBkYXRlX2hlaWdodChyb290KTsKICAgICAgICBsZXQgYmFsYW5jZTogaTMyID0gc2VsZi5nZXRfYmFsYW5jZShyb290KTsKICAgICAgICAKICAgICAgICAvLyBMZWZ0IExlZnQgQ2FzZQogICAgICAgIGlmIChiYWxhbmNlID4gMSAmJiBzZWxmLmdldF9iYWxhbmNlKHNlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0ubGVmdCkgPj0gMCkgewogICAgICAgICAgICByZXR1cm4gc2VsZi5yaWdodF9yb3RhdGUocm9vdCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIExlZnQgUmlnaHQgQ2FzZQogICAgICAgIGlmIChiYWxhbmNlID4gMSAmJiBzZWxmLmdldF9iYWxhbmNlKHNlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0ubGVmdCkgPCAwKSB7CiAgICAgICAgICAgIGxldCBuZXdfbGVmdDogaTMyID0gc2VsZi5sZWZ0X3JvdGF0ZShzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLmxlZnQpOwogICAgICAgICAgICBzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLmxlZnQgPSBuZXdfbGVmdDsKICAgICAgICAgICAgaWYgKG5ld19sZWZ0ICE9IC0xKSB7CiAgICAgICAgICAgICAgICBzZWxmLm5vZGVzW25ld19sZWZ0IGFzIHVzaXplXS5wYXJlbnQgPSByb290OwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBzZWxmLnJpZ2h0X3JvdGF0ZShyb290KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gUmlnaHQgUmlnaHQgQ2FzZQogICAgICAgIGlmIChiYWxhbmNlIDwgLTEgJiYgc2VsZi5nZXRfYmFsYW5jZShzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLnJpZ2h0KSA8PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBzZWxmLmxlZnRfcm90YXRlKHJvb3QpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBSaWdodCBMZWZ0IENhc2UKICAgICAgICBpZiAoYmFsYW5jZSA8IC0xICYmIHNlbGYuZ2V0X2JhbGFuY2Uoc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS5yaWdodCkgPiAwKSB7CiAgICAgICAgICAgIGxldCBuZXdfcmlnaHQ6IGkzMiA9IHNlbGYucmlnaHRfcm90YXRlKHNlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0ucmlnaHQpOwogICAgICAgICAgICBzZWxmLm5vZGVzW3Jvb3QgYXMgdXNpemVdLnJpZ2h0ID0gbmV3X3JpZ2h0OwogICAgICAgICAgICBpZiAobmV3X3JpZ2h0ICE9IC0xKSB7CiAgICAgICAgICAgICAgICBzZWxmLm5vZGVzW25ld19yaWdodCBhcyB1c2l6ZV0ucGFyZW50ID0gcm9vdDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gc2VsZi5sZWZ0X3JvdGF0ZShyb290KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIHJvb3Q7CiAgICB9CiAgICAKICAgIGZuIGlub3JkZXJfdHJhdmVyc2FsKCZzZWxmLCByb290OiBpMzIsIHJlc3VsdDogJm11dCBbaTMyOyAxMDAwXSwgaW5kZXg6ICZtdXQgaTMyKSB7CiAgICAgICAgaWYgKHJvb3QgIT0gLTEgJiYgKmluZGV4IDwgMTAwMCkgewogICAgICAgICAgICBzZWxmLmlub3JkZXJfdHJhdmVyc2FsKHNlbGYubm9kZXNbcm9vdCBhcyB1c2l6ZV0ubGVmdCwgcmVzdWx0LCBpbmRleCk7CiAgICAgICAgICAgIHJlc3VsdFsqaW5kZXggYXMgdXNpemVdID0gc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS52YWx1ZTsKICAgICAgICAgICAgKmluZGV4ICs9IDE7CiAgICAgICAgICAgIHNlbGYuaW5vcmRlcl90cmF2ZXJzYWwoc2VsZi5ub2Rlc1tyb290IGFzIHVzaXplXS5yaWdodCwgcmVzdWx0LCBpbmRleCk7CiAgICAgICAgfQogICAgfQp9CgovLyBBZHZhbmNlZCBIYXNoIFRhYmxlIHdpdGggZHluYW1pYyByZXNpemluZwpzdHJ1Y3QgSGFzaFRhYmxlIHsKICAgIGJ1Y2tldHM6IFtbaTMyOyAyMF07IDEwMDBdLAogICAgYnVja2V0X3NpemVzOiBbaTMyOyAxMDAwXSwKICAgIGtleXM6IFtbaTMyOyAyMF07IDEwMDBdLAogICAgY2FwYWNpdHk6IGkzMiwKICAgIHNpemU6IGkzMiwKICAgIGNvbGxpc2lvbl9jb3VudDogaTMyLAogICAgcmVzaXplX2NvdW50OiBpMzIsCiAgICAKICAgIC8vIEhhc2ggZnVuY3Rpb24gcGFyYW1ldGVycwogICAgaGFzaF9hOiBpMzIsCiAgICBoYXNoX2I6IGkzMiwKICAgIGhhc2hfcDogaTMyLAp9CgppbXBsIEhhc2hUYWJsZSB7CiAgICBmbiBuZXcoaW5pdGlhbF9jYXBhY2l0eTogaTMyKSAtPiBIYXNoVGFibGUgewogICAgICAgIEhhc2hUYWJsZSB7CiAgICAgICAgICAgIGJ1Y2tldHM6IFtbMDsgMjBdOyAxMDAwXSwKICAgICAgICAgICAgYnVja2V0X3NpemVzOiBbMDsgMTAwMF0sCiAgICAgICAgICAgIGtleXM6IFtbMDsgMjBdOyAxMDAwXSwKICAgICAgICAgICAgY2FwYWNpdHk6IGluaXRpYWxfY2FwYWNpdHksCiAgICAgICAgICAgIHNpemU6IDAsCiAgICAgICAgICAgIGNvbGxpc2lvbl9jb3VudDogMCwKICAgICAgICAgICAgcmVzaXplX2NvdW50OiAwLAogICAgICAgICAgICBoYXNoX2E6IDMxLAogICAgICAgICAgICBoYXNoX2I6IDE3LAogICAgICAgICAgICBoYXNoX3A6IDEwMDAwMDMsCiAgICAgICAgfQogICAgfQogICAgCiAgICBmbiBoYXNoX2Z1bmN0aW9uKCZzZWxmLCBrZXk6IGkzMikgLT4gaTMyIHsKICAgICAgICBsZXQgaGFzaF92YWx1ZTogaTMyID0gKChzZWxmLmhhc2hfYSAqIGtleSArIHNlbGYuaGFzaF9iKSAlIHNlbGYuaGFzaF9wKSAlIHNlbGYuY2FwYWNpdHk7CiAgICAgICAgaWYgKGhhc2hfdmFsdWUgPCAwKSB7CiAgICAgICAgICAgIHJldHVybiBoYXNoX3ZhbHVlICsgc2VsZi5jYXBhY2l0eTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGhhc2hfdmFsdWU7CiAgICB9CiAgICAKICAgIGZuIGluc2VydCgmbXV0IHNlbGYsIGtleTogaTMyLCB2YWx1ZTogaTMyKSB7CiAgICAgICAgbGV0IGluZGV4OiBpMzIgPSBzZWxmLmhhc2hfZnVuY3Rpb24oa2V5KTsKICAgICAgICAKICAgICAgICAvLyBDaGVjayBpZiBrZXkgYWxyZWFkeSBleGlzdHMKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLmJ1Y2tldF9zaXplc1tpbmRleCBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgaWYgKHNlbGYua2V5c1tpbmRleCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gPT0ga2V5KSB7CiAgICAgICAgICAgICAgICBzZWxmLmJ1Y2tldHNbaW5kZXggYXMgdXNpemVdW2kgYXMgdXNpemVdID0gdmFsdWU7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBBZGQgbmV3IGtleS12YWx1ZSBwYWlyCiAgICAgICAgaWYgKHNlbGYuYnVja2V0X3NpemVzW2luZGV4IGFzIHVzaXplXSA8IDIwKSB7CiAgICAgICAgICAgIHNlbGYua2V5c1tpbmRleCBhcyB1c2l6ZV1bc2VsZi5idWNrZXRfc2l6ZXNbaW5kZXggYXMgdXNpemVdIGFzIHVzaXplXSA9IGtleTsKICAgICAgICAgICAgc2VsZi5idWNrZXRzW2luZGV4IGFzIHVzaXplXVtzZWxmLmJ1Y2tldF9zaXplc1tpbmRleCBhcyB1c2l6ZV0gYXMgdXNpemVdID0gdmFsdWU7CiAgICAgICAgICAgIHNlbGYuYnVja2V0X3NpemVzW2luZGV4IGFzIHVzaXplXSArPSAxOwogICAgICAgICAgICBzZWxmLnNpemUgKz0gMTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChzZWxmLmJ1Y2tldF9zaXplc1tpbmRleCBhcyB1c2l6ZV0gPiAxKSB7CiAgICAgICAgICAgICAgICBzZWxmLmNvbGxpc2lvbl9jb3VudCArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBDaGVjayBpZiByZXNpemUgaXMgbmVlZGVkCiAgICAgICAgICAgIGlmIChzZWxmLnNpemUgPiBzZWxmLmNhcGFjaXR5ICogMyAvIDQpIHsKICAgICAgICAgICAgICAgIHNlbGYucmVzaXplKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAgIGZuIHNlYXJjaCgmc2VsZiwga2V5OiBpMzIpIC0+IGkzMiB7CiAgICAgICAgbGV0IGluZGV4OiBpMzIgPSBzZWxmLmhhc2hfZnVuY3Rpb24oa2V5KTsKICAgICAgICAKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLmJ1Y2tldF9zaXplc1tpbmRleCBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgaWYgKHNlbGYua2V5c1tpbmRleCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gPT0ga2V5KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5idWNrZXRzW2luZGV4IGFzIHVzaXplXVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiAtMTsgLy8gS2V5IG5vdCBmb3VuZAogICAgfQogICAgCiAgICBmbiBkZWxldGUoJm11dCBzZWxmLCBrZXk6IGkzMikgLT4gYm9vbCB7CiAgICAgICAgbGV0IGluZGV4OiBpMzIgPSBzZWxmLmhhc2hfZnVuY3Rpb24oa2V5KTsKICAgICAgICAKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLmJ1Y2tldF9zaXplc1tpbmRleCBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgaWYgKHNlbGYua2V5c1tpbmRleCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gPT0ga2V5KSB7CiAgICAgICAgICAgICAgICAvLyBTaGlmdCBlbGVtZW50cyB0byBmaWxsIHRoZSBnYXAKICAgICAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gaTsKICAgICAgICAgICAgICAgIHdoaWxlIChqIDwgc2VsZi5idWNrZXRfc2l6ZXNbaW5kZXggYXMgdXNpemVdIC0gMSkgewogICAgICAgICAgICAgICAgICAgIHNlbGYua2V5c1tpbmRleCBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSBzZWxmLmtleXNbaW5kZXggYXMgdXNpemVdWyhqICsgMSkgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIHNlbGYuYnVja2V0c1tpbmRleCBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSBzZWxmLmJ1Y2tldHNbaW5kZXggYXMgdXNpemVdWyhqICsgMSkgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIGogKz0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHNlbGYuYnVja2V0X3NpemVzW2luZGV4IGFzIHVzaXplXSAtPSAxOwogICAgICAgICAgICAgICAgc2VsZi5zaXplIC09IDE7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIAogICAgZm4gcmVzaXplKCZtdXQgc2VsZikgewogICAgICAgIGlmIChzZWxmLmNhcGFjaXR5ID49IDkwMCkgewogICAgICAgICAgICByZXR1cm47IC8vIFByZXZlbnQgb3ZlcmZsb3cKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gU2F2ZSBvbGQgZGF0YQogICAgICAgIGxldCBvbGRfYnVja2V0czogW1tpMzI7IDIwXTsgMTAwMF0gPSBzZWxmLmJ1Y2tldHM7CiAgICAgICAgbGV0IG9sZF9rZXlzOiBbW2kzMjsgMjBdOyAxMDAwXSA9IHNlbGYua2V5czsKICAgICAgICBsZXQgb2xkX2J1Y2tldF9zaXplczogW2kzMjsgMTAwMF0gPSBzZWxmLmJ1Y2tldF9zaXplczsKICAgICAgICBsZXQgb2xkX2NhcGFjaXR5OiBpMzIgPSBzZWxmLmNhcGFjaXR5OwogICAgICAgIAogICAgICAgIC8vIEluaXRpYWxpemUgbmV3IGxhcmdlciB0YWJsZQogICAgICAgIHNlbGYuY2FwYWNpdHkgPSBzZWxmLmNhcGFjaXR5ICogMjsKICAgICAgICBpZiAoc2VsZi5jYXBhY2l0eSA+IDEwMDApIHsKICAgICAgICAgICAgc2VsZi5jYXBhY2l0eSA9IDEwMDA7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHNlbGYuYnVja2V0cyA9IFtbMDsgMjBdOyAxMDAwXTsKICAgICAgICBzZWxmLmtleXMgPSBbWzA7IDIwXTsgMTAwMF07CiAgICAgICAgc2VsZi5idWNrZXRfc2l6ZXMgPSBbMDsgMTAwMF07CiAgICAgICAgc2VsZi5zaXplID0gMDsKICAgICAgICBzZWxmLnJlc2l6ZV9jb3VudCArPSAxOwogICAgICAgIAogICAgICAgIC8vIFJlaGFzaCBhbGwgZWxlbWVudHMKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBvbGRfY2FwYWNpdHkpIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IG9sZF9idWNrZXRfc2l6ZXNbaSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIHNlbGYuaW5zZXJ0KG9sZF9rZXlzW2kgYXMgdXNpemVdW2ogYXMgdXNpemVdLCBvbGRfYnVja2V0c1tpIGFzIHVzaXplXVtqIGFzIHVzaXplXSk7CiAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgIH0KfQoKLy8gTFJVIENhY2hlIGltcGxlbWVudGF0aW9uCnN0cnVjdCBMUlVDYWNoZSB7CiAgICBjYWNoZV9kYXRhOiBbaTMyOyA1MDBdLAogICAgY2FjaGVfa2V5czogW2kzMjsgNTAwXSwKICAgIHVzYWdlX29yZGVyOiBbaTMyOyA1MDBdLAogICAga2V5X3RvX2luZGV4OiBbaTMyOyAxMDAwMF0sCiAgICBjYXBhY2l0eTogaTMyLAogICAgc2l6ZTogaTMyLAogICAgYWNjZXNzX2NvdW50OiBpMzIsCiAgICBoaXRfY291bnQ6IGkzMiwKICAgIG1pc3NfY291bnQ6IGkzMiwKfQoKaW1wbCBMUlVDYWNoZSB7CiAgICBmbiBuZXcoY2FwYWNpdHk6IGkzMikgLT4gTFJVQ2FjaGUgewogICAgICAgIGxldCBtdXQgY2FjaGU6IExSVUNhY2hlID0gTFJVQ2FjaGUgewogICAgICAgICAgICBjYWNoZV9kYXRhOiBbMDsgNTAwXSwKICAgICAgICAgICAgY2FjaGVfa2V5czogWzA7IDUwMF0sCiAgICAgICAgICAgIHVzYWdlX29yZGVyOiBbMDsgNTAwXSwKICAgICAgICAgICAga2V5X3RvX2luZGV4OiBbLTE7IDEwMDAwXSwKICAgICAgICAgICAgY2FwYWNpdHk6IGNhcGFjaXR5LAogICAgICAgICAgICBzaXplOiAwLAogICAgICAgICAgICBhY2Nlc3NfY291bnQ6IDAsCiAgICAgICAgICAgIGhpdF9jb3VudDogMCwKICAgICAgICAgICAgbWlzc19jb3VudDogMCwKICAgICAgICB9OwogICAgICAgIAogICAgICAgIC8vIEluaXRpYWxpemUga2V5IG1hcHBpbmcKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCAxMDAwMCkgewogICAgICAgICAgICBjYWNoZS5rZXlfdG9faW5kZXhbaSBhcyB1c2l6ZV0gPSAtMTsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgICAgICAKICAgICAgICByZXR1cm4gY2FjaGU7CiAgICB9CiAgICAKICAgIGZuIGdldCgmbXV0IHNlbGYsIGtleTogaTMyKSAtPiBpMzIgewogICAgICAgIHNlbGYuYWNjZXNzX2NvdW50ICs9IDE7CiAgICAgICAgCiAgICAgICAgaWYgKGtleSA8IDAgfHwga2V5ID49IDEwMDAwKSB7CiAgICAgICAgICAgIHNlbGYubWlzc19jb3VudCArPSAxOwogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGxldCBpbmRleDogaTMyID0gc2VsZi5rZXlfdG9faW5kZXhba2V5IGFzIHVzaXplXTsKICAgICAgICBpZiAoaW5kZXggPT0gLTEpIHsKICAgICAgICAgICAgc2VsZi5taXNzX2NvdW50ICs9IDE7CiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gVXBkYXRlIHVzYWdlIG9yZGVyCiAgICAgICAgc2VsZi51cGRhdGVfdXNhZ2Vfb3JkZXIoaW5kZXgpOwogICAgICAgIHNlbGYuaGl0X2NvdW50ICs9IDE7CiAgICAgICAgcmV0dXJuIHNlbGYuY2FjaGVfZGF0YVtpbmRleCBhcyB1c2l6ZV07CiAgICB9CiAgICAKICAgIGZuIHB1dCgmbXV0IHNlbGYsIGtleTogaTMyLCB2YWx1ZTogaTMyKSB7CiAgICAgICAgaWYgKGtleSA8IDAgfHwga2V5ID49IDEwMDAwKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgbGV0IGV4aXN0aW5nX2luZGV4OiBpMzIgPSBzZWxmLmtleV90b19pbmRleFtrZXkgYXMgdXNpemVdOwogICAgICAgIGlmIChleGlzdGluZ19pbmRleCAhPSAtMSkgewogICAgICAgICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgZW50cnkKICAgICAgICAgICAgc2VsZi5jYWNoZV9kYXRhW2V4aXN0aW5nX2luZGV4IGFzIHVzaXplXSA9IHZhbHVlOwogICAgICAgICAgICBzZWxmLnVwZGF0ZV91c2FnZV9vcmRlcihleGlzdGluZ19pbmRleCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKHNlbGYuc2l6ZSA8IHNlbGYuY2FwYWNpdHkpIHsKICAgICAgICAgICAgLy8gQWRkIG5ldyBlbnRyeQogICAgICAgICAgICBsZXQgbmV3X2luZGV4OiBpMzIgPSBzZWxmLnNpemU7CiAgICAgICAgICAgIHNlbGYuY2FjaGVfa2V5c1tuZXdfaW5kZXggYXMgdXNpemVdID0ga2V5OwogICAgICAgICAgICBzZWxmLmNhY2hlX2RhdGFbbmV3X2luZGV4IGFzIHVzaXplXSA9IHZhbHVlOwogICAgICAgICAgICBzZWxmLmtleV90b19pbmRleFtrZXkgYXMgdXNpemVdID0gbmV3X2luZGV4OwogICAgICAgICAgICBzZWxmLnVzYWdlX29yZGVyW25ld19pbmRleCBhcyB1c2l6ZV0gPSBzZWxmLmFjY2Vzc19jb3VudDsKICAgICAgICAgICAgc2VsZi5zaXplICs9IDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gRmluZCBMUlUgZW50cnkgdG8gcmVwbGFjZQogICAgICAgICAgICBsZXQgbXV0IGxydV9pbmRleDogaTMyID0gMDsKICAgICAgICAgICAgbGV0IG11dCBtaW5fdXNhZ2U6IGkzMiA9IHNlbGYudXNhZ2Vfb3JkZXJbMF07CiAgICAgICAgICAgIAogICAgICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDE7CiAgICAgICAgICAgIHdoaWxlIChpIDwgc2VsZi5jYXBhY2l0eSkgewogICAgICAgICAgICAgICAgaWYgKHNlbGYudXNhZ2Vfb3JkZXJbaSBhcyB1c2l6ZV0gPCBtaW5fdXNhZ2UpIHsKICAgICAgICAgICAgICAgICAgICBtaW5fdXNhZ2UgPSBzZWxmLnVzYWdlX29yZGVyW2kgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIGxydV9pbmRleCA9IGk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFJlbW92ZSBvbGQgbWFwcGluZyBhbmQgYWRkIG5ldyBlbnRyeQogICAgICAgICAgICBsZXQgb2xkX2tleTogaTMyID0gc2VsZi5jYWNoZV9rZXlzW2xydV9pbmRleCBhcyB1c2l6ZV07CiAgICAgICAgICAgIGlmIChvbGRfa2V5ID49IDAgJiYgb2xkX2tleSA8IDEwMDAwKSB7CiAgICAgICAgICAgICAgICBzZWxmLmtleV90b19pbmRleFtvbGRfa2V5IGFzIHVzaXplXSA9IC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBzZWxmLmNhY2hlX2tleXNbbHJ1X2luZGV4IGFzIHVzaXplXSA9IGtleTsKICAgICAgICAgICAgc2VsZi5jYWNoZV9kYXRhW2xydV9pbmRleCBhcyB1c2l6ZV0gPSB2YWx1ZTsKICAgICAgICAgICAgc2VsZi5rZXlfdG9faW5kZXhba2V5IGFzIHVzaXplXSA9IGxydV9pbmRleDsKICAgICAgICAgICAgc2VsZi51c2FnZV9vcmRlcltscnVfaW5kZXggYXMgdXNpemVdID0gc2VsZi5hY2Nlc3NfY291bnQ7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmbiB1cGRhdGVfdXNhZ2Vfb3JkZXIoJm11dCBzZWxmLCBpbmRleDogaTMyKSB7CiAgICAgICAgc2VsZi51c2FnZV9vcmRlcltpbmRleCBhcyB1c2l6ZV0gPSBzZWxmLmFjY2Vzc19jb3VudDsKICAgIH0KICAgIAogICAgZm4gZ2V0X2NhY2hlX3N0YXRpc3RpY3MoJnNlbGYpIC0+IFtpMzI7IDVdIHsKICAgICAgICBsZXQgaGl0X3JhdGU6IGkzMiA9IGlmIChzZWxmLmFjY2Vzc19jb3VudCA+IDApIHsgKHNlbGYuaGl0X2NvdW50ICogMTAwKSAvIHNlbGYuYWNjZXNzX2NvdW50IH0gZWxzZSB7IDAgfTsKICAgICAgICBbc2VsZi5oaXRfY291bnQsIHNlbGYubWlzc19jb3VudCwgc2VsZi5hY2Nlc3NfY291bnQsIGhpdF9yYXRlLCBzZWxmLnNpemVdCiAgICB9Cn0KCi8vIE1lbW9yeSBNYW5hZ2VtZW50IFNpbXVsYXRvcgpzdHJ1Y3QgTWVtb3J5TWFuYWdlciB7CiAgICBtZW1vcnlfYmxvY2tzOiBbaTMyOyAxMDAwMF0sCiAgICBibG9ja19zdGF0dXM6IFtib29sOyAxMDAwMF0sIC8vIHRydWUgPSBhbGxvY2F0ZWQsIGZhbHNlID0gZnJlZQogICAgYmxvY2tfc2l6ZXM6IFtpMzI7IDEwMDAwXSwKICAgIHRvdGFsX21lbW9yeTogaTMyLAogICAgYWxsb2NhdGVkX21lbW9yeTogaTMyLAogICAgZnJlZV9tZW1vcnk6IGkzMiwKICAgIGFsbG9jYXRpb25fY291bnQ6IGkzMiwKICAgIGRlYWxsb2NhdGlvbl9jb3VudDogaTMyLAogICAgZnJhZ21lbnRhdGlvbl9zY29yZTogaTMyLAp9CgppbXBsIE1lbW9yeU1hbmFnZXIgewogICAgZm4gbmV3KHRvdGFsX3NpemU6IGkzMikgLT4gTWVtb3J5TWFuYWdlciB7CiAgICAgICAgbGV0IG11dCBtYW5hZ2VyOiBNZW1vcnlNYW5hZ2VyID0gTWVtb3J5TWFuYWdlciB7CiAgICAgICAgICAgIG1lbW9yeV9ibG9ja3M6IFswOyAxMDAwMF0sCiAgICAgICAgICAgIGJsb2NrX3N0YXR1czogW2ZhbHNlOyAxMDAwMF0sCiAgICAgICAgICAgIGJsb2NrX3NpemVzOiBbMDsgMTAwMDBdLAogICAgICAgICAgICB0b3RhbF9tZW1vcnk6IHRvdGFsX3NpemUsCiAgICAgICAgICAgIGFsbG9jYXRlZF9tZW1vcnk6IDAsCiAgICAgICAgICAgIGZyZWVfbWVtb3J5OiB0b3RhbF9zaXplLAogICAgICAgICAgICBhbGxvY2F0aW9uX2NvdW50OiAwLAogICAgICAgICAgICBkZWFsbG9jYXRpb25fY291bnQ6IDAsCiAgICAgICAgICAgIGZyYWdtZW50YXRpb25fc2NvcmU6IDAsCiAgICAgICAgfTsKICAgICAgICAKICAgICAgICAvLyBJbml0aWFsaXplIHdpdGggb25lIGxhcmdlIGZyZWUgYmxvY2sKICAgICAgICBtYW5hZ2VyLmJsb2NrX3NpemVzWzBdID0gdG90YWxfc2l6ZTsKICAgICAgICAKICAgICAgICByZXR1cm4gbWFuYWdlcjsKICAgIH0KICAgIAogICAgZm4gYWxsb2NhdGUoJm11dCBzZWxmLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICAgICAgaWYgKHNpemUgPD0gMCB8fCBzaXplID4gc2VsZi5mcmVlX21lbW9yeSkgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIEZpbmQgZmlyc3QgZml0CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgMTAwMDApIHsKICAgICAgICAgICAgaWYgKCFzZWxmLmJsb2NrX3N0YXR1c1tpIGFzIHVzaXplXSAmJiBzZWxmLmJsb2NrX3NpemVzW2kgYXMgdXNpemVdID49IHNpemUpIHsKICAgICAgICAgICAgICAgIC8vIEFsbG9jYXRlIHRoaXMgYmxvY2sKICAgICAgICAgICAgICAgIHNlbGYuYmxvY2tfc3RhdHVzW2kgYXMgdXNpemVdID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHNlbGYubWVtb3J5X2Jsb2Nrc1tpIGFzIHVzaXplXSA9IGk7IC8vIEJsb2NrIElECiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIFNwbGl0IGJsb2NrIGlmIG5lY2Vzc2FyeQogICAgICAgICAgICAgICAgaWYgKHNlbGYuYmxvY2tfc2l6ZXNbaSBhcyB1c2l6ZV0gPiBzaXplKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJlbWFpbmluZ19zaXplOiBpMzIgPSBzZWxmLmJsb2NrX3NpemVzW2kgYXMgdXNpemVdIC0gc2l6ZTsKICAgICAgICAgICAgICAgICAgICBzZWxmLmJsb2NrX3NpemVzW2kgYXMgdXNpemVdID0gc2l6ZTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIGZyZWUgc2xvdCBmb3IgcmVtYWluaW5nIGJsb2NrCiAgICAgICAgICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICAgICAgICAgIHdoaWxlIChqIDwgMTAwMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuYmxvY2tfc2l6ZXNbaiBhcyB1c2l6ZV0gPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5ibG9ja19zaXplc1tqIGFzIHVzaXplXSA9IHJlbWFpbmluZ19zaXplOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaiArPSAxOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgc2VsZi5hbGxvY2F0ZWRfbWVtb3J5ICs9IHNpemU7CiAgICAgICAgICAgICAgICBzZWxmLmZyZWVfbWVtb3J5IC09IHNpemU7CiAgICAgICAgICAgICAgICBzZWxmLmFsbG9jYXRpb25fY291bnQgKz0gMTsKICAgICAgICAgICAgICAgIHNlbGYuY2FsY3VsYXRlX2ZyYWdtZW50YXRpb24oKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgICAgICAKICAgICAgICByZXR1cm4gLTE7IC8vIEFsbG9jYXRpb24gZmFpbGVkCiAgICB9CiAgICAKICAgIGZuIGRlYWxsb2NhdGUoJm11dCBzZWxmLCBibG9ja19pZDogaTMyKSAtPiBib29sIHsKICAgICAgICBpZiAoYmxvY2tfaWQgPCAwIHx8IGJsb2NrX2lkID49IDEwMDAwIHx8ICFzZWxmLmJsb2NrX3N0YXR1c1tibG9ja19pZCBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBsZXQgc2l6ZTogaTMyID0gc2VsZi5ibG9ja19zaXplc1tibG9ja19pZCBhcyB1c2l6ZV07CiAgICAgICAgc2VsZi5ibG9ja19zdGF0dXNbYmxvY2tfaWQgYXMgdXNpemVdID0gZmFsc2U7CiAgICAgICAgc2VsZi5hbGxvY2F0ZWRfbWVtb3J5IC09IHNpemU7CiAgICAgICAgc2VsZi5mcmVlX21lbW9yeSArPSBzaXplOwogICAgICAgIHNlbGYuZGVhbGxvY2F0aW9uX2NvdW50ICs9IDE7CiAgICAgICAgCiAgICAgICAgLy8gQXR0ZW1wdCB0byBjb2FsZXNjZSB3aXRoIGFkamFjZW50IGZyZWUgYmxvY2tzCiAgICAgICAgc2VsZi5jb2FsZXNjZV9mcmVlX2Jsb2NrcygpOwogICAgICAgIHNlbGYuY2FsY3VsYXRlX2ZyYWdtZW50YXRpb24oKTsKICAgICAgICAKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIAogICAgZm4gY29hbGVzY2VfZnJlZV9ibG9ja3MoJm11dCBzZWxmKSB7CiAgICAgICAgLy8gU2ltcGxlIGNvYWxlc2Npbmcgc3RyYXRlZ3kKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCA5OTk5KSB7CiAgICAgICAgICAgIGlmICghc2VsZi5ibG9ja19zdGF0dXNbaSBhcyB1c2l6ZV0gJiYgIXNlbGYuYmxvY2tfc3RhdHVzWyhpICsgMSkgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBzZWxmLmJsb2NrX3NpemVzW2kgYXMgdXNpemVdICs9IHNlbGYuYmxvY2tfc2l6ZXNbKGkgKyAxKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBzZWxmLmJsb2NrX3NpemVzWyhpICsgMSkgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgfQogICAgCiAgICBmbiBjYWxjdWxhdGVfZnJhZ21lbnRhdGlvbigmbXV0IHNlbGYpIHsKICAgICAgICBsZXQgbXV0IGZyZWVfYmxvY2tfY291bnQ6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBsYXJnZXN0X2ZyZWVfYmxvY2s6IGkzMiA9IDA7CiAgICAgICAgCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgMTAwMDApIHsKICAgICAgICAgICAgaWYgKCFzZWxmLmJsb2NrX3N0YXR1c1tpIGFzIHVzaXplXSAmJiBzZWxmLmJsb2NrX3NpemVzW2kgYXMgdXNpemVdID4gMCkgewogICAgICAgICAgICAgICAgZnJlZV9ibG9ja19jb3VudCArPSAxOwogICAgICAgICAgICAgICAgaWYgKHNlbGYuYmxvY2tfc2l6ZXNbaSBhcyB1c2l6ZV0gPiBsYXJnZXN0X2ZyZWVfYmxvY2spIHsKICAgICAgICAgICAgICAgICAgICBsYXJnZXN0X2ZyZWVfYmxvY2sgPSBzZWxmLmJsb2NrX3NpemVzW2kgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKHNlbGYuZnJlZV9tZW1vcnkgPiAwKSB7CiAgICAgICAgICAgIHNlbGYuZnJhZ21lbnRhdGlvbl9zY29yZSA9IDEwMCAtIChsYXJnZXN0X2ZyZWVfYmxvY2sgKiAxMDApIC8gc2VsZi5mcmVlX21lbW9yeTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZWxmLmZyYWdtZW50YXRpb25fc2NvcmUgPSAwOwogICAgICAgIH0KICAgIH0KICAgIAogICAgZm4gZ2V0X21lbW9yeV9zdGF0aXN0aWNzKCZzZWxmKSAtPiBbaTMyOyA2XSB7CiAgICAgICAgWwogICAgICAgICAgICBzZWxmLmFsbG9jYXRlZF9tZW1vcnksCiAgICAgICAgICAgIHNlbGYuZnJlZV9tZW1vcnksCiAgICAgICAgICAgIHNlbGYuYWxsb2NhdGlvbl9jb3VudCwKICAgICAgICAgICAgc2VsZi5kZWFsbG9jYXRpb25fY291bnQsCiAgICAgICAgICAgIHNlbGYuZnJhZ21lbnRhdGlvbl9zY29yZSwKICAgICAgICAgICAgc2VsZi50b3RhbF9tZW1vcnkKICAgICAgICBdCiAgICB9Cn0KCi8vIE1haW4gY29tcHJlaGVuc2l2ZSBkYXRhIHN0cnVjdHVyZSB0ZXN0CmZuIG1haW4oKSB7CiAgICAvLyBJbml0aWFsaXplIEFWTCBUcmVlCiAgICBsZXQgbXV0IGF2bF90cmVlOiBBVkxUcmVlID0gQVZMVHJlZTo6bmV3KCk7CiAgICAKICAgIC8vIFJlYWQgdHJlZSBvcGVyYXRpb25zCiAgICBsZXQgdHJlZV9vcGVyYXRpb25zOiBpMzIgPSBnZXRJbnQoKTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgdHJlZV9vcGVyYXRpb25zKSB7CiAgICAgICAgbGV0IG9wZXJhdGlvbjogaTMyID0gZ2V0SW50KCk7CiAgICAgICAgbGV0IGtleTogaTMyID0gZ2V0SW50KCk7CiAgICAgICAgbGV0IHZhbHVlOiBpMzIgPSBnZXRJbnQoKTsKICAgICAgICAKICAgICAgICBpZiAob3BlcmF0aW9uID09IDEpIHsKICAgICAgICAgICAgYXZsX3RyZWUucm9vdCA9IGF2bF90cmVlLmluc2VydChhdmxfdHJlZS5yb290LCBrZXksIHZhbHVlKTsKICAgICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbiA9PSAyKSB7CiAgICAgICAgICAgIGF2bF90cmVlLnJvb3QgPSBhdmxfdHJlZS5kZWxldGVfbm9kZShhdmxfdHJlZS5yb290LCBrZXkpOwogICAgICAgIH0gZWxzZSBpZiAob3BlcmF0aW9uID09IDMpIHsKICAgICAgICAgICAgbGV0IHJlc3VsdDogaTMyID0gYXZsX3RyZWUuc2VhcmNoKGF2bF90cmVlLnJvb3QsIGtleSk7CiAgICAgICAgICAgIGlmIChyZXN1bHQgIT0gLTEpIHsKICAgICAgICAgICAgICAgIHByaW50bG5JbnQoYXZsX3RyZWUubm9kZXNbcmVzdWx0IGFzIHVzaXplXS52YWx1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBwcmludGxuSW50KC0xKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpICs9IDE7CiAgICB9CiAgICAKICAgIC8vIEluaXRpYWxpemUgSGFzaCBUYWJsZQogICAgbGV0IGhhc2hfY2FwYWNpdHk6IGkzMiA9IGdldEludCgpOwogICAgbGV0IG11dCBoYXNoX3RhYmxlOiBIYXNoVGFibGUgPSBIYXNoVGFibGU6Om5ldyhoYXNoX2NhcGFjaXR5KTsKICAgIAogICAgLy8gUmVhZCBoYXNoIHRhYmxlIG9wZXJhdGlvbnMKICAgIGxldCBoYXNoX29wZXJhdGlvbnM6IGkzMiA9IGdldEludCgpOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IGhhc2hfb3BlcmF0aW9ucykgewogICAgICAgIGxldCBvcGVyYXRpb246IGkzMiA9IGdldEludCgpOwogICAgICAgIGxldCBrZXk6IGkzMiA9IGdldEludCgpOwogICAgICAgIAogICAgICAgIGlmIChvcGVyYXRpb24gPT0gMSkgewogICAgICAgICAgICBsZXQgdmFsdWU6IGkzMiA9IGdldEludCgpOwogICAgICAgICAgICBoYXNoX3RhYmxlLmluc2VydChrZXksIHZhbHVlKTsKICAgICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbiA9PSAyKSB7CiAgICAgICAgICAgIGxldCByZXN1bHQ6IGkzMiA9IGhhc2hfdGFibGUuc2VhcmNoKGtleSk7CiAgICAgICAgICAgIHByaW50bG5JbnQocmVzdWx0KTsKICAgICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbiA9PSAzKSB7CiAgICAgICAgICAgIGxldCBkZWxldGVkOiBib29sID0gaGFzaF90YWJsZS5kZWxldGUoa2V5KTsKICAgICAgICAgICAgcHJpbnRsbkludChpZiAoZGVsZXRlZCkgeyAxIH0gZWxzZSB7IDAgfSk7CiAgICAgICAgfQogICAgICAgIGkgKz0gMTsKICAgIH0KICAgIAogICAgLy8gSW5pdGlhbGl6ZSBMUlUgQ2FjaGUKICAgIGxldCBjYWNoZV9jYXBhY2l0eTogaTMyID0gZ2V0SW50KCk7CiAgICBsZXQgbXV0IGxydV9jYWNoZTogTFJVQ2FjaGUgPSBMUlVDYWNoZTo6bmV3KGNhY2hlX2NhcGFjaXR5KTsKICAgIAogICAgLy8gUmVhZCBjYWNoZSBvcGVyYXRpb25zCiAgICBsZXQgY2FjaGVfb3BlcmF0aW9uczogaTMyID0gZ2V0SW50KCk7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgY2FjaGVfb3BlcmF0aW9ucykgewogICAgICAgIGxldCBvcGVyYXRpb246IGkzMiA9IGdldEludCgpOwogICAgICAgIGxldCBrZXk6IGkzMiA9IGdldEludCgpOwogICAgICAgIAogICAgICAgIGlmIChvcGVyYXRpb24gPT0gMSkgewogICAgICAgICAgICBsZXQgdmFsdWU6IGkzMiA9IGdldEludCgpOwogICAgICAgICAgICBscnVfY2FjaGUucHV0KGtleSwgdmFsdWUpOwogICAgICAgIH0gZWxzZSBpZiAob3BlcmF0aW9uID09IDIpIHsKICAgICAgICAgICAgbGV0IHJlc3VsdDogaTMyID0gbHJ1X2NhY2hlLmdldChrZXkpOwogICAgICAgICAgICBwcmludGxuSW50KHJlc3VsdCk7CiAgICAgICAgfQogICAgICAgIGkgKz0gMTsKICAgIH0KICAgIAogICAgLy8gSW5pdGlhbGl6ZSBNZW1vcnkgTWFuYWdlcgogICAgbGV0IG1lbW9yeV9zaXplOiBpMzIgPSBnZXRJbnQoKTsKICAgIGxldCBtdXQgbWVtb3J5X21hbmFnZXI6IE1lbW9yeU1hbmFnZXIgPSBNZW1vcnlNYW5hZ2VyOjpuZXcobWVtb3J5X3NpemUpOwogICAgCiAgICAvLyBSZWFkIG1lbW9yeSBvcGVyYXRpb25zCiAgICBsZXQgbWVtb3J5X29wZXJhdGlvbnM6IGkzMiA9IGdldEludCgpOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IG1lbW9yeV9vcGVyYXRpb25zKSB7CiAgICAgICAgbGV0IG9wZXJhdGlvbjogaTMyID0gZ2V0SW50KCk7CiAgICAgICAgCiAgICAgICAgaWYgKG9wZXJhdGlvbiA9PSAxKSB7CiAgICAgICAgICAgIGxldCBzaXplOiBpMzIgPSBnZXRJbnQoKTsKICAgICAgICAgICAgbGV0IGJsb2NrX2lkOiBpMzIgPSBtZW1vcnlfbWFuYWdlci5hbGxvY2F0ZShzaXplKTsKICAgICAgICAgICAgcHJpbnRsbkludChibG9ja19pZCk7CiAgICAgICAgfSBlbHNlIGlmIChvcGVyYXRpb24gPT0gMikgewogICAgICAgICAgICBsZXQgYmxvY2tfaWQ6IGkzMiA9IGdldEludCgpOwogICAgICAgICAgICBsZXQgc3VjY2VzczogYm9vbCA9IG1lbW9yeV9tYW5hZ2VyLmRlYWxsb2NhdGUoYmxvY2tfaWQpOwogICAgICAgICAgICBwcmludGxuSW50KGlmIChzdWNjZXNzKSB7IDEgfSBlbHNlIHsgMCB9KTsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQogICAgCiAgICAvLyBPdXRwdXQgY29tcHJlaGVuc2l2ZSBzdGF0aXN0aWNzCiAgICBwcmludGxuSW50KGF2bF90cmVlLm5vZGVfY291bnQpOwogICAgcHJpbnRsbkludChhdmxfdHJlZS5yb3RhdGlvbl9jb3VudCk7CiAgICBwcmludGxuSW50KGF2bF90cmVlLnNlYXJjaF9vcGVyYXRpb25zKTsKICAgIAogICAgcHJpbnRsbkludChoYXNoX3RhYmxlLnNpemUpOwogICAgcHJpbnRsbkludChoYXNoX3RhYmxlLmNvbGxpc2lvbl9jb3VudCk7CiAgICBwcmludGxuSW50KGhhc2hfdGFibGUucmVzaXplX2NvdW50KTsKICAgIAogICAgbGV0IGNhY2hlX3N0YXRzOiBbaTMyOyA1XSA9IGxydV9jYWNoZS5nZXRfY2FjaGVfc3RhdGlzdGljcygpOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDUpIHsKICAgICAgICBwcmludGxuSW50KGNhY2hlX3N0YXRzW2kgYXMgdXNpemVdKTsKICAgICAgICBpICs9IDE7CiAgICB9CiAgICAKICAgIGxldCBtZW1vcnlfc3RhdHM6IFtpMzI7IDZdID0gbWVtb3J5X21hbmFnZXIuZ2V0X21lbW9yeV9zdGF0aXN0aWNzKCk7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgNikgewogICAgICAgIHByaW50bG5JbnQobWVtb3J5X3N0YXRzW2kgYXMgdXNpemVdKTsKICAgICAgICBpICs9IDE7CiAgICB9CiAgICAKICAgIC8vIEZpbmFsIGNvbXByZWhlbnNpdmUgYW5hbHlzaXMKICAgIGxldCB0cmVlX3Njb3JlOiBpMzIgPSBhdmxfdHJlZS5ub2RlX2NvdW50ICogMTAgKyBhdmxfdHJlZS5yb3RhdGlvbl9jb3VudDsKICAgIGxldCBoYXNoX3Njb3JlOiBpMzIgPSBoYXNoX3RhYmxlLnNpemUgKiA1ICsgaGFzaF90YWJsZS5jb2xsaXNpb25fY291bnQ7CiAgICBsZXQgY2FjaGVfc2NvcmU6IGkzMiA9IGNhY2hlX3N0YXRzWzNdOyAvLyBIaXQgcmF0ZQogICAgbGV0IG1lbW9yeV9zY29yZTogaTMyID0gMTAwIC0gbWVtb3J5X3N0YXRzWzRdOyAvLyBJbnZlcnNlIG9mIGZyYWdtZW50YXRpb24KCiAgICBsZXQgdG90YWxfc2NvcmU6IGkzMiA9IHRyZWVfc2NvcmUgKyBoYXNoX3Njb3JlICsgY2FjaGVfc2NvcmUgKyBtZW1vcnlfc2NvcmU7CiAgICBwcmludGxuSW50KHRvdGFsX3Njb3JlKTsKICAgIGV4aXQoMCk7Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (15, "comprehensive15", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXByZWhlbnNpdmUgVGVzdCAxNTogQWR2YW5jZWQgU3RyaW5nIFByb2Nlc3NpbmcgYW5kIFBhdHRlcm4gTWF0Y2hpbmcgU3lzdGVtcwpTdW1tYXJ5OiBUaGlzIHRlc3QgaW1wbGVtZW50cyBzb3BoaXN0aWNhdGVkIHN0cmluZyBhbGdvcml0aG1zIGFuZCB0ZXh0IHByb2Nlc3Npbmc6CkRldGFpbHM6CjEuIE11bHRpcGxlIHN0cmluZyBtYXRjaGluZyBhbGdvcml0aG1zIChLTVAsIEJveWVyLU1vb3JlLCBSYWJpbi1LYXJwKQoyLiBTdWZmaXggYXJyYXkgY29uc3RydWN0aW9uIGFuZCBMQ1AgYXJyYXkgY29tcHV0YXRpb24KMy4gVGV4dCBjb21wcmVzc2lvbiB1c2luZyBIdWZmbWFuIGNvZGluZyAoc2ltcGxpZmllZCkKNC4gUmVndWxhciBleHByZXNzaW9uIG1hdGNoaW5nIGVuZ2luZSAoc2ltcGxpZmllZCkKNS4gRWRpdCBkaXN0YW5jZSBjb21wdXRhdGlvbiB3aXRoIHRyYWNlYmFjawo2LiBDb21wbGV4IHRleHQgYW5hbHlzaXMgYW5kIHN0YXRpc3RpY2FsIHByb2Nlc3NpbmcKKi8KCi8vIENvbXByZWhlbnNpdmUgVGVzdCAxNTogQWR2YW5jZWQgU3RyaW5nIFByb2Nlc3NpbmcgYW5kIFBhdHRlcm4gTWF0Y2hpbmcgU3lzdGVtcwovLyBUaGlzIHRlc3QgaW1wbGVtZW50cyBzb3BoaXN0aWNhdGVkIHN0cmluZyBhbGdvcml0aG1zIGFuZCB0ZXh0IHByb2Nlc3Npbmc6Ci8vIDEuIE11bHRpcGxlIHN0cmluZyBtYXRjaGluZyBhbGdvcml0aG1zIChLTVAsIEJveWVyLU1vb3JlLCBSYWJpbi1LYXJwKQovLyAyLiBTdWZmaXggYXJyYXkgY29uc3RydWN0aW9uIGFuZCBMQ1AgYXJyYXkgY29tcHV0YXRpb24KLy8gMy4gVGV4dCBjb21wcmVzc2lvbiB1c2luZyBIdWZmbWFuIGNvZGluZyAoc2ltcGxpZmllZCkKLy8gNC4gUmVndWxhciBleHByZXNzaW9uIG1hdGNoaW5nIGVuZ2luZSAoc2ltcGxpZmllZCkKLy8gNS4gRWRpdCBkaXN0YW5jZSBjb21wdXRhdGlvbiB3aXRoIHRyYWNlYmFjawovLyA2LiBDb21wbGV4IHRleHQgYW5hbHlzaXMgYW5kIHN0YXRpc3RpY2FsIHByb2Nlc3NpbmcKCi8vIFN0cmluZyBzdHJ1Y3R1cmUgZm9yIGFkdmFuY2VkIHRleHQgcHJvY2Vzc2luZwpzdHJ1Y3QgU3RyaW5nUHJvY2Vzc29yIHsKICAgIC8vIFByaW1hcnkgdGV4dCBkYXRhCiAgICB0ZXh0OiBbaTMyOyA1MDAwXSwKICAgIHRleHRfbGVuZ3RoOiBpMzIsCgogICAgLy8gUGF0dGVybiBtYXRjaGluZyBkYXRhCiAgICBwYXR0ZXJuczogW1tpMzI7IDIwMF07IDUwXSwKICAgIHBhdHRlcm5fbGVuZ3RoczogW2kzMjsgNTBdLAogICAgcGF0dGVybl9jb3VudDogaTMyLAoKICAgIC8vIFN1ZmZpeCBhcnJheSBhbmQgcmVsYXRlZCBzdHJ1Y3R1cmVzCiAgICBzdWZmaXhfYXJyYXk6IFtpMzI7IDUwMDBdLAogICAgbGNwX2FycmF5OiBbaTMyOyA1MDAwXSwKICAgIHJhbmtfYXJyYXk6IFtpMzI7IDUwMDBdLAoKICAgIC8vIEtNUCBwcmVwcm9jZXNzaW5nCiAgICBscHM6IFtpMzI7IDIwMF0sCgogICAgLy8gQm95ZXItTW9vcmUgcHJlcHJvY2Vzc2luZwogICAgYmFkX2NoYXI6IFtpMzI7IDI1Nl0sCiAgICBnb29kX3N1ZmZpeDogW2kzMjsgMjAwXSwKCiAgICAvLyBSYWJpbi1LYXJwIGhhc2hpbmcKICAgIHBhdHRlcm5faGFzaDogW2kzMjsgNTBdLAogICAgdGV4dF9oYXNoOiBbaTMyOyA1MDAwXSwKICAgIGJhc2U6IGkzMiwKICAgIG1vZF92YWx1ZTogaTMyLAoKICAgIC8vIEVkaXQgZGlzdGFuY2UgbWF0cml4CiAgICBkcF9tYXRyaXg6IFtbaTMyOyA1MDBdOyA1MDBdLAoKICAgIC8vIEh1ZmZtYW4gY29kaW5nIHN0cnVjdHVyZXMKICAgIGNoYXJfZnJlcXVlbmN5OiBbaTMyOyAyNTZdLAogICAgaHVmZm1hbl9jb2RlczogW1tpMzI7IDIwXTsgMjU2XSwKICAgIGNvZGVfbGVuZ3RoczogW2kzMjsgMjU2XSwKCiAgICAvLyBUZXh0IHN0YXRpc3RpY3MKICAgIHdvcmRfY291bnQ6IGkzMiwKICAgIHNlbnRlbmNlX2NvdW50OiBpMzIsCiAgICBwYXJhZ3JhcGhfY291bnQ6IGkzMiwKICAgIHVuaXF1ZV9jaGFyczogaTMyLAoKICAgIC8vIFNlYXJjaCByZXN1bHRzCiAgICBtYXRjaF9wb3NpdGlvbnM6IFtbaTMyOyAxMDBdOyA1MF0sCiAgICBtYXRjaF9jb3VudHM6IFtpMzI7IDUwXSwKCiAgICAvLyBQZXJmb3JtYW5jZSBtZXRyaWNzCiAgICBhbGdvcml0aG1fdGltZXM6IFtpMzI7IDEwXSwKICAgIGNvbXBhcmlzb25fY291bnQ6IGkzMiwKICAgIGhhc2hfY29sbGlzaW9uczogaTMyLAp9CgppbXBsIFN0cmluZ1Byb2Nlc3NvciB7CiAgICBmbiBuZXcoKSAtPiBTdHJpbmdQcm9jZXNzb3IgewogICAgICAgIFN0cmluZ1Byb2Nlc3NvciB7CiAgICAgICAgICAgIHRleHQ6IFswOyA1MDAwXSwKICAgICAgICAgICAgdGV4dF9sZW5ndGg6IDAsCiAgICAgICAgICAgIHBhdHRlcm5zOiBbWzA7IDIwMF07IDUwXSwKICAgICAgICAgICAgcGF0dGVybl9sZW5ndGhzOiBbMDsgNTBdLAogICAgICAgICAgICBwYXR0ZXJuX2NvdW50OiAwLAogICAgICAgICAgICBzdWZmaXhfYXJyYXk6IFswOyA1MDAwXSwKICAgICAgICAgICAgbGNwX2FycmF5OiBbMDsgNTAwMF0sCiAgICAgICAgICAgIHJhbmtfYXJyYXk6IFswOyA1MDAwXSwKICAgICAgICAgICAgbHBzOiBbMDsgMjAwXSwKICAgICAgICAgICAgYmFkX2NoYXI6IFswOyAyNTZdLAogICAgICAgICAgICBnb29kX3N1ZmZpeDogWzA7IDIwMF0sCiAgICAgICAgICAgIHBhdHRlcm5faGFzaDogWzA7IDUwXSwKICAgICAgICAgICAgdGV4dF9oYXNoOiBbMDsgNTAwMF0sCiAgICAgICAgICAgIGJhc2U6IDI1NiwKICAgICAgICAgICAgbW9kX3ZhbHVlOiAxMDAwNywKICAgICAgICAgICAgZHBfbWF0cml4OiBbWzA7IDUwMF07IDUwMF0sCiAgICAgICAgICAgIGNoYXJfZnJlcXVlbmN5OiBbMDsgMjU2XSwKICAgICAgICAgICAgaHVmZm1hbl9jb2RlczogW1swOyAyMF07IDI1Nl0sCiAgICAgICAgICAgIGNvZGVfbGVuZ3RoczogWzA7IDI1Nl0sCiAgICAgICAgICAgIHdvcmRfY291bnQ6IDAsCiAgICAgICAgICAgIHNlbnRlbmNlX2NvdW50OiAwLAogICAgICAgICAgICBwYXJhZ3JhcGhfY291bnQ6IDAsCiAgICAgICAgICAgIHVuaXF1ZV9jaGFyczogMCwKICAgICAgICAgICAgbWF0Y2hfcG9zaXRpb25zOiBbWzA7IDEwMF07IDUwXSwKICAgICAgICAgICAgbWF0Y2hfY291bnRzOiBbMDsgNTBdLAogICAgICAgICAgICBhbGdvcml0aG1fdGltZXM6IFswOyAxMF0sCiAgICAgICAgICAgIGNvbXBhcmlzb25fY291bnQ6IDAsCiAgICAgICAgICAgIGhhc2hfY29sbGlzaW9uczogMCwKICAgICAgICB9CiAgICB9CgogICAgLy8gSW5pdGlhbGl6ZSB0ZXh0IGRhdGEgZnJvbSBpbnB1dAogICAgZm4gaW5pdGlhbGl6ZV90ZXh0KCZtdXQgc2VsZiwgbGVuZ3RoOiBpMzIpIHsKICAgICAgICBzZWxmLnRleHRfbGVuZ3RoID0gbGVuZ3RoOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IGxlbmd0aCkgewogICAgICAgICAgICBzZWxmLnRleHRbaSBhcyB1c2l6ZV0gPSBnZXRJbnQoKTsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgc2VsZi5hbmFseXplX3RleHRfc3RhdGlzdGljcygpOwogICAgICAgIHNlbGYuYnVpbGRfc3VmZml4X2FycmF5KCk7CiAgICAgICAgc2VsZi5jb21wdXRlX2xjcF9hcnJheSgpOwogICAgICAgIHNlbGYucHJlcGFyZV9yYWJpbl9rYXJwX2hhc2hlcygpOwogICAgfQoKICAgIC8vIEFkZCBwYXR0ZXJucyBmb3IgbWF0Y2hpbmcKICAgIGZuIGFkZF9wYXR0ZXJuKCZtdXQgc2VsZiwgbGVuZ3RoOiBpMzIpIHsKICAgICAgICBpZiAoc2VsZi5wYXR0ZXJuX2NvdW50ID49IDUwKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGxldCBwYXR0ZXJuX2luZGV4OiBpMzIgPSBzZWxmLnBhdHRlcm5fY291bnQ7CiAgICAgICAgc2VsZi5wYXR0ZXJuX2xlbmd0aHNbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV0gPSBsZW5ndGg7CgogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IGxlbmd0aCkgewogICAgICAgICAgICBzZWxmLnBhdHRlcm5zW3BhdHRlcm5faW5kZXggYXMgdXNpemVdW2kgYXMgdXNpemVdID0gZ2V0SW50KCk7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIHNlbGYucHJlcHJvY2Vzc19rbXAocGF0dGVybl9pbmRleCk7CiAgICAgICAgc2VsZi5wcmVwcm9jZXNzX2JveWVyX21vb3JlKHBhdHRlcm5faW5kZXgpOwogICAgICAgIHNlbGYuY29tcHV0ZV9wYXR0ZXJuX2hhc2gocGF0dGVybl9pbmRleCk7CgogICAgICAgIHNlbGYucGF0dGVybl9jb3VudCArPSAxOwogICAgfQoKICAgIC8vIEFuYWx5emUgYmFzaWMgdGV4dCBzdGF0aXN0aWNzCiAgICBmbiBhbmFseXplX3RleHRfc3RhdGlzdGljcygmbXV0IHNlbGYpIHsKICAgICAgICBzZWxmLndvcmRfY291bnQgPSAwOwogICAgICAgIHNlbGYuc2VudGVuY2VfY291bnQgPSAwOwogICAgICAgIHNlbGYucGFyYWdyYXBoX2NvdW50ID0gMDsKICAgICAgICBzZWxmLnVuaXF1ZV9jaGFycyA9IDA7CgogICAgICAgIC8vIENsZWFyIGZyZXF1ZW5jeSBhcnJheQogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IDI1NikgewogICAgICAgICAgICBzZWxmLmNoYXJfZnJlcXVlbmN5W2kgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gQ291bnQgY2hhcmFjdGVyIGZyZXF1ZW5jaWVzIGFuZCBiYXNpYyBzdGF0aXN0aWNzCiAgICAgICAgaSA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLnRleHRfbGVuZ3RoKSB7CiAgICAgICAgICAgIGxldCBjaDogaTMyID0gc2VsZi50ZXh0W2kgYXMgdXNpemVdOwogICAgICAgICAgICBpZiAoY2ggPj0gMCAmJiBjaCA8IDI1NikgewogICAgICAgICAgICAgICAgc2VsZi5jaGFyX2ZyZXF1ZW5jeVtjaCBhcyB1c2l6ZV0gKz0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU2ltcGxlIHdvcmQgYm91bmRhcnkgZGV0ZWN0aW9uIChzcGFjZSA9IDMyKQogICAgICAgICAgICBpZiAoY2ggPT0gMzIgJiYgaSA+IDAgJiYgc2VsZi50ZXh0WyhpIC0gMSkgYXMgdXNpemVdICE9IDMyKSB7CiAgICAgICAgICAgICAgICBzZWxmLndvcmRfY291bnQgKz0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU2VudGVuY2UgYm91bmRhcnkgZGV0ZWN0aW9uIChwZXJpb2QgPSA0NiwgZXhjbGFtYXRpb24gPSAzMywgcXVlc3Rpb24gPSA2MykKICAgICAgICAgICAgaWYgKGNoID09IDQ2IHx8IGNoID09IDMzIHx8IGNoID09IDYzKSB7CiAgICAgICAgICAgICAgICBzZWxmLnNlbnRlbmNlX2NvdW50ICs9IDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFBhcmFncmFwaCBib3VuZGFyeSBkZXRlY3Rpb24gKG5ld2xpbmUgPSAxMCkKICAgICAgICAgICAgaWYgKGNoID09IDEwKSB7CiAgICAgICAgICAgICAgICBzZWxmLnBhcmFncmFwaF9jb3VudCArPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBDb3VudCB1bmlxdWUgY2hhcmFjdGVycwogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgMjU2KSB7CiAgICAgICAgICAgIGlmIChzZWxmLmNoYXJfZnJlcXVlbmN5W2kgYXMgdXNpemVdID4gMCkgewogICAgICAgICAgICAgICAgc2VsZi51bmlxdWVfY2hhcnMgKz0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBGaW5hbCB3b3JkIGNvdW50IGFkanVzdG1lbnQKICAgICAgICBpZiAoc2VsZi50ZXh0X2xlbmd0aCA+IDAgJiYgc2VsZi50ZXh0WyhzZWxmLnRleHRfbGVuZ3RoIC0gMSkgYXMgdXNpemVdICE9IDMyKSB7CiAgICAgICAgICAgIHNlbGYud29yZF9jb3VudCArPSAxOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBCdWlsZCBzdWZmaXggYXJyYXkgdXNpbmcgc2ltcGxlIE8obl4yIGxvZyBuKSBhbGdvcml0aG0KICAgIGZuIGJ1aWxkX3N1ZmZpeF9hcnJheSgmbXV0IHNlbGYpIHsKICAgICAgICAvLyBJbml0aWFsaXplIHN1ZmZpeCBhcnJheSB3aXRoIGluZGljZXMKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLnRleHRfbGVuZ3RoKSB7CiAgICAgICAgICAgIHNlbGYuc3VmZml4X2FycmF5W2kgYXMgdXNpemVdID0gaTsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gU29ydCBzdWZmaXhlcyB1c2luZyBidWJibGUgc29ydCAoc2ltcGxpZmllZCBmb3IgdGhpcyBpbXBsZW1lbnRhdGlvbikKICAgICAgICBsZXQgbXV0IHNvcnRlZDogYm9vbCA9IGZhbHNlOwogICAgICAgIHdoaWxlICghc29ydGVkKSB7CiAgICAgICAgICAgIHNvcnRlZCA9IHRydWU7CiAgICAgICAgICAgIGkgPSAwOwogICAgICAgICAgICB3aGlsZSAoaSA8IHNlbGYudGV4dF9sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAgICBpZiAoc2VsZi5jb21wYXJlX3N1ZmZpeGVzKAogICAgICAgICAgICAgICAgICAgIHNlbGYuc3VmZml4X2FycmF5W2kgYXMgdXNpemVdLAogICAgICAgICAgICAgICAgICAgIHNlbGYuc3VmZml4X2FycmF5WyhpICsgMSkgYXMgdXNpemVdLAogICAgICAgICAgICAgICAgKSA+IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHRlbXA6IGkzMiA9IHNlbGYuc3VmZml4X2FycmF5W2kgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIHNlbGYuc3VmZml4X2FycmF5W2kgYXMgdXNpemVdID0gc2VsZi5zdWZmaXhfYXJyYXlbKGkgKyAxKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAgICAgc2VsZi5zdWZmaXhfYXJyYXlbKGkgKyAxKSBhcyB1c2l6ZV0gPSB0ZW1wOwogICAgICAgICAgICAgICAgICAgIHNvcnRlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaSArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBCdWlsZCByYW5rIGFycmF5CiAgICAgICAgaSA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzZWxmLnRleHRfbGVuZ3RoKSB7CiAgICAgICAgICAgIHNlbGYucmFua19hcnJheVtzZWxmLnN1ZmZpeF9hcnJheVtpIGFzIHVzaXplXSBhcyB1c2l6ZV0gPSBpOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgfQoKICAgIC8vIENvbXBhcmUgdHdvIHN1ZmZpeGVzIGxleGljb2dyYXBoaWNhbGx5CiAgICBmbiBjb21wYXJlX3N1ZmZpeGVzKCZtdXQgc2VsZiwgaTogaTMyLCBqOiBpMzIpIC0+IGkzMiB7CiAgICAgICAgbGV0IG11dCBrOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpICsgayA8IHNlbGYudGV4dF9sZW5ndGggJiYgaiArIGsgPCBzZWxmLnRleHRfbGVuZ3RoKSB7CiAgICAgICAgICAgIHNlbGYuY29tcGFyaXNvbl9jb3VudCArPSAxOwogICAgICAgICAgICBpZiAoc2VsZi50ZXh0WyhpICsgaykgYXMgdXNpemVdIDwgc2VsZi50ZXh0WyhqICsgaykgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2VsZi50ZXh0WyhpICsgaykgYXMgdXNpemVdID4gc2VsZi50ZXh0WyhqICsgaykgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBrICs9IDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoaSArIGsgPj0gc2VsZi50ZXh0X2xlbmd0aCAmJiBqICsgayA+PSBzZWxmLnRleHRfbGVuZ3RoKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0gZWxzZSBpZiAoaSArIGsgPj0gc2VsZi50ZXh0X2xlbmd0aCkgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfQogICAgfQoKICAgIC8vIENvbXB1dGUgTENQIChMb25nZXN0IENvbW1vbiBQcmVmaXgpIGFycmF5CiAgICBmbiBjb21wdXRlX2xjcF9hcnJheSgmbXV0IHNlbGYpIHsKICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgICAgICB3aGlsZSAoaSA8IHNlbGYudGV4dF9sZW5ndGgpIHsKICAgICAgICAgICAgaWYgKHNlbGYucmFua19hcnJheVtpIGFzIHVzaXplXSA9PSBzZWxmLnRleHRfbGVuZ3RoIC0gMSkgewogICAgICAgICAgICAgICAgayA9IDA7CiAgICAgICAgICAgICAgICBpICs9IDE7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IGo6IGkzMiA9IHNlbGYuc3VmZml4X2FycmF5WyhzZWxmLnJhbmtfYXJyYXlbaSBhcyB1c2l6ZV0gKyAxKSBhcyB1c2l6ZV07CgogICAgICAgICAgICB3aGlsZSAoaSArIGsgPCBzZWxmLnRleHRfbGVuZ3RoCiAgICAgICAgICAgICAgICAmJiBqICsgayA8IHNlbGYudGV4dF9sZW5ndGgKICAgICAgICAgICAgICAgICYmIHNlbGYudGV4dFsoaSArIGspIGFzIHVzaXplXSA9PSBzZWxmLnRleHRbKGogKyBrKSBhcyB1c2l6ZV0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGsgKz0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc2VsZi5sY3BfYXJyYXlbc2VsZi5yYW5rX2FycmF5W2kgYXMgdXNpemVdIGFzIHVzaXplXSA9IGs7CgogICAgICAgICAgICBpZiAoayA+IDApIHsKICAgICAgICAgICAgICAgIGsgLT0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBLTVAgcHJlcHJvY2Vzc2luZyAtIGNvbXB1dGUgTFBTIGFycmF5CiAgICBmbiBwcmVwcm9jZXNzX2ttcCgmbXV0IHNlbGYsIHBhdHRlcm5faW5kZXg6IGkzMikgewogICAgICAgIGxldCBwYXR0ZXJuX2xlbjogaTMyID0gc2VsZi5wYXR0ZXJuX2xlbmd0aHNbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV07CiAgICAgICAgbGV0IG11dCBsZW5ndGg6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAxOwoKICAgICAgICBzZWxmLmxwc1swXSA9IDA7CgogICAgICAgIHdoaWxlIChpIDwgcGF0dGVybl9sZW4pIHsKICAgICAgICAgICAgaWYgKHNlbGYucGF0dGVybnNbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgID09IHNlbGYucGF0dGVybnNbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV1bbGVuZ3RoIGFzIHVzaXplXSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbGVuZ3RoICs9IDE7CiAgICAgICAgICAgICAgICBzZWxmLmxwc1tpIGFzIHVzaXplXSA9IGxlbmd0aDsKICAgICAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChsZW5ndGggIT0gMCkgewogICAgICAgICAgICAgICAgICAgIGxlbmd0aCA9IHNlbGYubHBzWyhsZW5ndGggLSAxKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHNlbGYubHBzW2kgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgICAgICAgICBpICs9IDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8gQm95ZXItTW9vcmUgcHJlcHJvY2Vzc2luZwogICAgZm4gcHJlcHJvY2Vzc19ib3llcl9tb29yZSgmbXV0IHNlbGYsIHBhdHRlcm5faW5kZXg6IGkzMikgewogICAgICAgIGxldCBwYXR0ZXJuX2xlbjogaTMyID0gc2VsZi5wYXR0ZXJuX2xlbmd0aHNbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV07CgogICAgICAgIC8vIEluaXRpYWxpemUgYmFkIGNoYXJhY3RlciBhcnJheQogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IDI1NikgewogICAgICAgICAgICBzZWxmLmJhZF9jaGFyW2kgYXMgdXNpemVdID0gLTE7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIEZpbGwgYmFkIGNoYXJhY3RlciBhcnJheQogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgcGF0dGVybl9sZW4pIHsKICAgICAgICAgICAgbGV0IGNoOiBpMzIgPSBzZWxmLnBhdHRlcm5zW3BhdHRlcm5faW5kZXggYXMgdXNpemVdW2kgYXMgdXNpemVdOwogICAgICAgICAgICBpZiAoY2ggPj0gMCAmJiBjaCA8IDI1NikgewogICAgICAgICAgICAgICAgc2VsZi5iYWRfY2hhcltjaCBhcyB1c2l6ZV0gPSBpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIC8vIFNpbXBsaWZpZWQgZ29vZCBzdWZmaXggcHJlcHJvY2Vzc2luZwogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgcGF0dGVybl9sZW4pIHsKICAgICAgICAgICAgc2VsZi5nb29kX3N1ZmZpeFtpIGFzIHVzaXplXSA9IHBhdHRlcm5fbGVuOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFJhYmluLUthcnAgaGFzaCBjb21wdXRhdGlvbgogICAgZm4gY29tcHV0ZV9wYXR0ZXJuX2hhc2goJm11dCBzZWxmLCBwYXR0ZXJuX2luZGV4OiBpMzIpIHsKICAgICAgICBsZXQgcGF0dGVybl9sZW46IGkzMiA9IHNlbGYucGF0dGVybl9sZW5ndGhzW3BhdHRlcm5faW5kZXggYXMgdXNpemVdOwogICAgICAgIGxldCBtdXQgaGFzaF92YWx1ZTogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IHBvd2VyOiBpMzIgPSAxOwoKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBwYXR0ZXJuX2xlbikgewogICAgICAgICAgICBoYXNoX3ZhbHVlID0gKGhhc2hfdmFsdWUKICAgICAgICAgICAgICAgICsgKHNlbGYucGF0dGVybnNbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gKiBwb3dlcikgJSBzZWxmLm1vZF92YWx1ZSkKICAgICAgICAgICAgICAgICUgc2VsZi5tb2RfdmFsdWU7CiAgICAgICAgICAgIGlmIChpIDwgcGF0dGVybl9sZW4gLSAxKSB7CiAgICAgICAgICAgICAgICBwb3dlciA9IChwb3dlciAqIHNlbGYuYmFzZSkgJSBzZWxmLm1vZF92YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICBzZWxmLnBhdHRlcm5faGFzaFtwYXR0ZXJuX2luZGV4IGFzIHVzaXplXSA9IGhhc2hfdmFsdWU7CiAgICB9CgogICAgLy8gUHJlcGFyZSByb2xsaW5nIGhhc2hlcyBmb3IgdGV4dAogICAgZm4gcHJlcGFyZV9yYWJpbl9rYXJwX2hhc2hlcygmbXV0IHNlbGYpIHsKICAgICAgICBpZiAoc2VsZi50ZXh0X2xlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIENvbXB1dGUgaGFzaCBmb3IgZmlyc3Qgd2luZG93CiAgICAgICAgc2VsZi50ZXh0X2hhc2hbMF0gPSBzZWxmLnRleHRbMF0gJSBzZWxmLm1vZF92YWx1ZTsKCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAxOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi50ZXh0X2xlbmd0aCkgewogICAgICAgICAgICBzZWxmLnRleHRfaGFzaFtpIGFzIHVzaXplXSA9CiAgICAgICAgICAgICAgICAoc2VsZi50ZXh0X2hhc2hbKGkgLSAxKSBhcyB1c2l6ZV0gJSBzZWxmLm1vZF92YWx1ZSAqIHNlbGYuYmFzZSAlIHNlbGYubW9kX3ZhbHVlCiAgICAgICAgICAgICAgICAgICAgKyBzZWxmLnRleHRbaSBhcyB1c2l6ZV0gJSBzZWxmLm1vZF92YWx1ZSkKICAgICAgICAgICAgICAgICAgICAlIHNlbGYubW9kX3ZhbHVlOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgfQoKICAgIC8vIEtNUCBzdHJpbmcgbWF0Y2hpbmcKICAgIGZuIGttcF9zZWFyY2goJm11dCBzZWxmLCBwYXR0ZXJuX2luZGV4OiBpMzIpIHsKICAgICAgICBsZXQgcGF0dGVybl9sZW46IGkzMiA9IHNlbGYucGF0dGVybl9sZW5ndGhzW3BhdHRlcm5faW5kZXggYXMgdXNpemVdOwogICAgICAgIHNlbGYubWF0Y2hfY291bnRzW3BhdHRlcm5faW5kZXggYXMgdXNpemVdID0gMDsKCiAgICAgICAgaWYgKHBhdHRlcm5fbGVuID4gc2VsZi50ZXh0X2xlbmd0aCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7IC8vIGluZGV4IGZvciB0ZXh0CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOyAvLyBpbmRleCBmb3IgcGF0dGVybgoKICAgICAgICB3aGlsZSAoaSA8IHNlbGYudGV4dF9sZW5ndGgpIHsKICAgICAgICAgICAgc2VsZi5jb21wYXJpc29uX2NvdW50ICs9IDE7CiAgICAgICAgICAgIGlmIChzZWxmLnBhdHRlcm5zW3BhdHRlcm5faW5kZXggYXMgdXNpemVdW2ogYXMgdXNpemVdID09IHNlbGYudGV4dFtpIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgaSArPSAxOwogICAgICAgICAgICAgICAgaiArPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoaiA9PSBwYXR0ZXJuX2xlbikgewogICAgICAgICAgICAgICAgLy8gRm91bmQgYSBtYXRjaAogICAgICAgICAgICAgICAgaWYgKHNlbGYubWF0Y2hfY291bnRzW3BhdHRlcm5faW5kZXggYXMgdXNpemVdIDwgMTAwKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYXRjaF9wb3NpdGlvbnNbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgICAgICAgICAgW3NlbGYubWF0Y2hfY291bnRzW3BhdHRlcm5faW5kZXggYXMgdXNpemVdIGFzIHVzaXplXSA9IGkgLSBqOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc2VsZi5tYXRjaF9jb3VudHNbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV0gKz0gMTsKICAgICAgICAgICAgICAgIGogPSBzZWxmLmxwc1soaiAtIDEpIGFzIHVzaXplXTsKICAgICAgICAgICAgfSBlbHNlIGlmIChpIDwgc2VsZi50ZXh0X2xlbmd0aAogICAgICAgICAgICAgICAgJiYgc2VsZi5wYXR0ZXJuc1twYXR0ZXJuX2luZGV4IGFzIHVzaXplXVtqIGFzIHVzaXplXSAhPSBzZWxmLnRleHRbaSBhcyB1c2l6ZV0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChqICE9IDApIHsKICAgICAgICAgICAgICAgICAgICBqID0gc2VsZi5scHNbKGogLSAxKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLyBCb3llci1Nb29yZSBzdHJpbmcgbWF0Y2hpbmcKICAgIGZuIGJveWVyX21vb3JlX3NlYXJjaCgmbXV0IHNlbGYsIHBhdHRlcm5faW5kZXg6IGkzMikgewogICAgICAgIGxldCBwYXR0ZXJuX2xlbjogaTMyID0gc2VsZi5wYXR0ZXJuX2xlbmd0aHNbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV07CiAgICAgICAgbGV0IG11dCBtYXRjaGVzX2ZvdW5kOiBpMzIgPSAwOwoKICAgICAgICBpZiAocGF0dGVybl9sZW4gPiBzZWxmLnRleHRfbGVuZ3RoKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGxldCBtdXQgc2hpZnQ6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKHNoaWZ0IDw9IHNlbGYudGV4dF9sZW5ndGggLSBwYXR0ZXJuX2xlbikgewogICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IHBhdHRlcm5fbGVuIC0gMTsKCiAgICAgICAgICAgIC8vIENoZWNrIHBhdHRlcm4gZnJvbSByaWdodCB0byBsZWZ0CiAgICAgICAgICAgIHdoaWxlIChqID49IDAKICAgICAgICAgICAgICAgICYmIHNlbGYucGF0dGVybnNbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgICAgICA9PSBzZWxmLnRleHRbKHNoaWZ0ICsgaikgYXMgdXNpemVdKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBqIC09IDE7CiAgICAgICAgICAgICAgICBzZWxmLmNvbXBhcmlzb25fY291bnQgKz0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGogPCAwKSB7CiAgICAgICAgICAgICAgICAvLyBGb3VuZCBhIG1hdGNoCiAgICAgICAgICAgICAgICBtYXRjaGVzX2ZvdW5kICs9IDE7CiAgICAgICAgICAgICAgICBzaGlmdCArPSBpZiAoc2hpZnQgKyBwYXR0ZXJuX2xlbiA8IHNlbGYudGV4dF9sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuX2xlbgogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAxCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHNoaWZ0IHVzaW5nIGJhZCBjaGFyYWN0ZXIgcnVsZQogICAgICAgICAgICAgICAgbGV0IGJhZF9jaGFyX3NoaWZ0OiBpMzIgPQogICAgICAgICAgICAgICAgICAgIGogLSBzZWxmLmJhZF9jaGFyW3NlbGYudGV4dFsoc2hpZnQgKyBqKSBhcyB1c2l6ZV0gYXMgdXNpemVdOwogICAgICAgICAgICAgICAgc2hpZnQgKz0gaWYgKGJhZF9jaGFyX3NoaWZ0ID4gMSkgewogICAgICAgICAgICAgICAgICAgIGJhZF9jaGFyX3NoaWZ0CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIDEKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBzZWxmLmNvbXBhcmlzb25fY291bnQgKz0gMTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gU3RvcmUgYWRkaXRpb25hbCBtYXRjaGVzIGZvdW5kIGJ5IEJveWVyLU1vb3JlCiAgICAgICAgc2VsZi5hbGdvcml0aG1fdGltZXNbMV0gPSBtYXRjaGVzX2ZvdW5kOwogICAgfQoKICAgIC8vIFJhYmluLUthcnAgc3RyaW5nIG1hdGNoaW5nIHdpdGggcm9sbGluZyBoYXNoCiAgICBmbiByYWJpbl9rYXJwX3NlYXJjaCgmbXV0IHNlbGYsIHBhdHRlcm5faW5kZXg6IGkzMikgewogICAgICAgIGxldCBwYXR0ZXJuX2xlbjogaTMyID0gc2VsZi5wYXR0ZXJuX2xlbmd0aHNbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV07CiAgICAgICAgbGV0IHBhdHRlcm5faGFzaDogaTMyID0gc2VsZi5wYXR0ZXJuX2hhc2hbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV07CiAgICAgICAgbGV0IG11dCBtYXRjaGVzX2ZvdW5kOiBpMzIgPSAwOwoKICAgICAgICBpZiAocGF0dGVybl9sZW4gPiBzZWxmLnRleHRfbGVuZ3RoKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIENhbGN1bGF0ZSBoYXNoIGZvciBmaXJzdCB3aW5kb3cKICAgICAgICBsZXQgbXV0IHdpbmRvd19oYXNoOiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgcG93ZXI6IGkzMiA9IDE7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgcGF0dGVybl9sZW4pIHsKICAgICAgICAgICAgd2luZG93X2hhc2ggPQogICAgICAgICAgICAgICAgKHdpbmRvd19oYXNoICsgKHNlbGYudGV4dFtpIGFzIHVzaXplXSAqIHBvd2VyKSAlIHNlbGYubW9kX3ZhbHVlKSAlIHNlbGYubW9kX3ZhbHVlOwogICAgICAgICAgICBpZiAoaSA8IHBhdHRlcm5fbGVuIC0gMSkgewogICAgICAgICAgICAgICAgcG93ZXIgPSAocG93ZXIgKiBzZWxmLmJhc2UpICUgc2VsZi5tb2RfdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gQ2hlY2sgZmlyc3Qgd2luZG93CiAgICAgICAgaWYgKHdpbmRvd19oYXNoID09IHBhdHRlcm5faGFzaCkgewogICAgICAgICAgICBpZiAoc2VsZi52ZXJpZnlfbWF0Y2goMCwgcGF0dGVybl9pbmRleCkpIHsKICAgICAgICAgICAgICAgIG1hdGNoZXNfZm91bmQgKz0gMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNlbGYuaGFzaF9jb2xsaXNpb25zICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFJvbGwgdGhlIGhhc2ggZm9yIHJlbWFpbmluZyB3aW5kb3dzCiAgICAgICAgaSA9IHBhdHRlcm5fbGVuOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi50ZXh0X2xlbmd0aCkgewogICAgICAgICAgICAvLyBSZW1vdmUgbGVhZGluZyBjaGFyYWN0ZXIgYW5kIGFkZCB0cmFpbGluZyBjaGFyYWN0ZXIKICAgICAgICAgICAgd2luZG93X2hhc2ggPSAod2luZG93X2hhc2gKICAgICAgICAgICAgICAgIC0gKHNlbGYudGV4dFsoaSAtIHBhdHRlcm5fbGVuKSBhcyB1c2l6ZV0gKiBwb3dlcikgJSBzZWxmLm1vZF92YWx1ZQogICAgICAgICAgICAgICAgKyBzZWxmLm1vZF92YWx1ZSkKICAgICAgICAgICAgICAgICUgc2VsZi5tb2RfdmFsdWU7CiAgICAgICAgICAgIHdpbmRvd19oYXNoID0gKHdpbmRvd19oYXNoICogc2VsZi5iYXNlICsgc2VsZi50ZXh0W2kgYXMgdXNpemVdKSAlIHNlbGYubW9kX3ZhbHVlOwoKICAgICAgICAgICAgaWYgKHdpbmRvd19oYXNoID09IHBhdHRlcm5faGFzaCkgewogICAgICAgICAgICAgICAgaWYgKHNlbGYudmVyaWZ5X21hdGNoKGkgLSBwYXR0ZXJuX2xlbiArIDEsIHBhdHRlcm5faW5kZXgpKSB7CiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlc19mb3VuZCArPSAxOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzZWxmLmhhc2hfY29sbGlzaW9ucyArPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIHNlbGYuYWxnb3JpdGhtX3RpbWVzWzJdID0gbWF0Y2hlc19mb3VuZDsKICAgIH0KCiAgICAvLyBWZXJpZnkgcG90ZW50aWFsIG1hdGNoIGZvdW5kIGJ5IGhhc2gKICAgIGZuIHZlcmlmeV9tYXRjaCgmbXV0IHNlbGYsIHRleHRfcG9zOiBpMzIsIHBhdHRlcm5faW5kZXg6IGkzMikgLT4gYm9vbCB7CiAgICAgICAgbGV0IHBhdHRlcm5fbGVuOiBpMzIgPSBzZWxmLnBhdHRlcm5fbGVuZ3Roc1twYXR0ZXJuX2luZGV4IGFzIHVzaXplXTsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBwYXR0ZXJuX2xlbikgewogICAgICAgICAgICBzZWxmLmNvbXBhcmlzb25fY291bnQgKz0gMTsKICAgICAgICAgICAgaWYgKHNlbGYudGV4dFsodGV4dF9wb3MgKyBpKSBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgICE9IHNlbGYucGF0dGVybnNbcGF0dGVybl9pbmRleCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8vIEVkaXQgZGlzdGFuY2UgY29tcHV0YXRpb24gdXNpbmcgZHluYW1pYyBwcm9ncmFtbWluZwogICAgZm4gY29tcHV0ZV9lZGl0X2Rpc3RhbmNlKCZtdXQgc2VsZiwgc3RyMV9sZW46IGkzMiwgc3RyMl9sZW46IGkzMikgLT4gaTMyIHsKICAgICAgICAvLyBSZWFkIHRoZSB0d28gc3RyaW5ncwogICAgICAgIGxldCBtdXQgc3RyMTogW2kzMjsgNTAwXSA9IFswOyA1MDBdOwogICAgICAgIGxldCBtdXQgc3RyMjogW2kzMjsgNTAwXSA9IFswOyA1MDBdOwoKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzdHIxX2xlbikgewogICAgICAgICAgICBzdHIxW2kgYXMgdXNpemVdID0gZ2V0SW50KCk7CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CgogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc3RyMl9sZW4pIHsKICAgICAgICAgICAgc3RyMltpIGFzIHVzaXplXSA9IGdldEludCgpOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBJbml0aWFsaXplIERQIG1hdHJpeAogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDw9IHN0cjFfbGVuKSB7CiAgICAgICAgICAgIHNlbGYuZHBfbWF0cml4W2kgYXMgdXNpemVdWzBdID0gaTsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDw9IHN0cjJfbGVuKSB7CiAgICAgICAgICAgIHNlbGYuZHBfbWF0cml4WzBdW2ogYXMgdXNpemVdID0gajsKICAgICAgICAgICAgaiArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gRmlsbCBEUCBtYXRyaXgKICAgICAgICBpID0gMTsKICAgICAgICB3aGlsZSAoaSA8PSBzdHIxX2xlbikgewogICAgICAgICAgICBqID0gMTsKICAgICAgICAgICAgd2hpbGUgKGogPD0gc3RyMl9sZW4pIHsKICAgICAgICAgICAgICAgIGlmIChzdHIxWyhpIC0gMSkgYXMgdXNpemVdID09IHN0cjJbKGogLSAxKSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgICAgICBzZWxmLmRwX21hdHJpeFtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZHBfbWF0cml4WyhpIC0gMSkgYXMgdXNpemVdWyhqIC0gMSkgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBsZXQgaW5zZXJ0X2Nvc3Q6IGkzMiA9IHNlbGYuZHBfbWF0cml4W2kgYXMgdXNpemVdWyhqIC0gMSkgYXMgdXNpemVdICsgMTsKICAgICAgICAgICAgICAgICAgICBsZXQgZGVsZXRlX2Nvc3Q6IGkzMiA9IHNlbGYuZHBfbWF0cml4WyhpIC0gMSkgYXMgdXNpemVdW2ogYXMgdXNpemVdICsgMTsKICAgICAgICAgICAgICAgICAgICBsZXQgc3Vic3RpdHV0ZV9jb3N0OiBpMzIgPQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRwX21hdHJpeFsoaSAtIDEpIGFzIHVzaXplXVsoaiAtIDEpIGFzIHVzaXplXSArIDE7CgogICAgICAgICAgICAgICAgICAgIGxldCBtaW5fY29zdDogaTMyID0gaWYgKGluc2VydF9jb3N0IDwgZGVsZXRlX2Nvc3QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluc2VydF9jb3N0IDwgc3Vic3RpdHV0ZV9jb3N0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRfY29zdAogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Vic3RpdHV0ZV9jb3N0CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVsZXRlX2Nvc3QgPCBzdWJzdGl0dXRlX2Nvc3QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZV9jb3N0CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJzdGl0dXRlX2Nvc3QKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgIHNlbGYuZHBfbWF0cml4W2kgYXMgdXNpemVdW2ogYXMgdXNpemVdID0gbWluX2Nvc3Q7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHNlbGYuZHBfbWF0cml4W3N0cjFfbGVuIGFzIHVzaXplXVtzdHIyX2xlbiBhcyB1c2l6ZV07CiAgICB9CgogICAgLy8gU2ltcGxpZmllZCBIdWZmbWFuIGNvZGluZyBmcmVxdWVuY3kgYW5hbHlzaXMKICAgIGZuIGFuYWx5emVfY29tcHJlc3Npb25fcG90ZW50aWFsKCZtdXQgc2VsZikgLT4gaTMyIHsKICAgICAgICAvLyBDYWxjdWxhdGUgZW50cm9weSBiYXNlZCBvbiBjaGFyYWN0ZXIgZnJlcXVlbmNpZXMKICAgICAgICBsZXQgbXV0IHRvdGFsX2VudHJvcHk6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgMjU2KSB7CiAgICAgICAgICAgIGlmIChzZWxmLmNoYXJfZnJlcXVlbmN5W2kgYXMgdXNpemVdID4gMCkgewogICAgICAgICAgICAgICAgbGV0IGZyZXF1ZW5jeTogaTMyID0gc2VsZi5jaGFyX2ZyZXF1ZW5jeVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGxldCBwcm9iYWJpbGl0eTogaTMyID0gKGZyZXF1ZW5jeSAqIDEwMDApIC8gc2VsZi50ZXh0X2xlbmd0aDsgLy8gU2NhbGUgYnkgMTAwMCBmb3IgaW50ZWdlciBhcml0aG1ldGljCgogICAgICAgICAgICAgICAgLy8gU2ltcGxpZmllZCBsb2cgY2FsY3VsYXRpb24gKGFwcHJveGltYXRpb24pCiAgICAgICAgICAgICAgICBsZXQgbXV0IGxvZ19hcHByb3g6IGkzMiA9IDA7CiAgICAgICAgICAgICAgICBsZXQgbXV0IHRlbXA6IGkzMiA9IHByb2JhYmlsaXR5OwogICAgICAgICAgICAgICAgd2hpbGUgKHRlbXAgPiAxKSB7CiAgICAgICAgICAgICAgICAgICAgbG9nX2FwcHJveCArPSAxOwogICAgICAgICAgICAgICAgICAgIHRlbXAgLz0gMjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0b3RhbF9lbnRyb3B5ICs9IGZyZXF1ZW5jeSAqIGxvZ19hcHByb3g7CiAgICAgICAgICAgICAgICBzZWxmLmNvZGVfbGVuZ3Roc1tpIGFzIHVzaXplXSA9IGlmIChsb2dfYXBwcm94ID4gMCkgeyBsb2dfYXBwcm94IH0gZWxzZSB7IDEgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gc2VsZi50ZXh0X2xlbmd0aCAqIDggLSB0b3RhbF9lbnRyb3B5OyAvLyBDb21wcmVzc2lvbiBwb3RlbnRpYWwKICAgIH0KCiAgICAvLyBMb25nZXN0IHJlcGVhdGVkIHN1YnN0cmluZyB1c2luZyBzdWZmaXggYXJyYXkKICAgIGZuIGZpbmRfbG9uZ2VzdF9yZXBlYXRlZF9zdWJzdHJpbmcoJnNlbGYpIC0+IGkzMiB7CiAgICAgICAgbGV0IG11dCBtYXhfbGNwOiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYudGV4dF9sZW5ndGggLSAxKSB7CiAgICAgICAgICAgIGlmIChzZWxmLmxjcF9hcnJheVtpIGFzIHVzaXplXSA+IG1heF9sY3ApIHsKICAgICAgICAgICAgICAgIG1heF9sY3AgPSBzZWxmLmxjcF9hcnJheVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQogICAgICAgIHJldHVybiBtYXhfbGNwOwogICAgfQoKICAgIC8vIENvbXBsZXggdGV4dCBhbmFseXNpcyBjb21iaW5pbmcgbXVsdGlwbGUgYWxnb3JpdGhtcwogICAgZm4gcGVyZm9ybV9jb21wcmVoZW5zaXZlX2FuYWx5c2lzKCZtdXQgc2VsZikgewogICAgICAgIC8vIFBlcmZvcm0gYWxsIHBhdHRlcm4gbWF0Y2hpbmcgYWxnb3JpdGhtcwogICAgICAgIGxldCBtdXQgcGF0dGVybl9pZHg6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKHBhdHRlcm5faWR4IDwgc2VsZi5wYXR0ZXJuX2NvdW50KSB7CiAgICAgICAgICAgIHNlbGYua21wX3NlYXJjaChwYXR0ZXJuX2lkeCk7CiAgICAgICAgICAgIHNlbGYuYm95ZXJfbW9vcmVfc2VhcmNoKHBhdHRlcm5faWR4KTsKICAgICAgICAgICAgc2VsZi5yYWJpbl9rYXJwX3NlYXJjaChwYXR0ZXJuX2lkeCk7CiAgICAgICAgICAgIHBhdHRlcm5faWR4ICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBDb21wcmVzc2lvbiBhbmFseXNpcwogICAgICAgIGxldCBjb21wcmVzc2lvbl9wb3RlbnRpYWw6IGkzMiA9IHNlbGYuYW5hbHl6ZV9jb21wcmVzc2lvbl9wb3RlbnRpYWwoKTsKICAgICAgICBzZWxmLmFsZ29yaXRobV90aW1lc1szXSA9IGNvbXByZXNzaW9uX3BvdGVudGlhbDsKCiAgICAgICAgLy8gTG9uZ2VzdCByZXBlYXRlZCBzdWJzdHJpbmcKICAgICAgICBsZXQgbG9uZ2VzdF9yZXBlYXQ6IGkzMiA9IHNlbGYuZmluZF9sb25nZXN0X3JlcGVhdGVkX3N1YnN0cmluZygpOwogICAgICAgIHNlbGYuYWxnb3JpdGhtX3RpbWVzWzRdID0gbG9uZ2VzdF9yZXBlYXQ7CgogICAgICAgIC8vIEFkZGl0aW9uYWwgdGV4dCBtZXRyaWNzCiAgICAgICAgbGV0IGF2Z193b3JkX2xlbmd0aDogaTMyID0gaWYgKHNlbGYud29yZF9jb3VudCA+IDApIHsKICAgICAgICAgICAgc2VsZi50ZXh0X2xlbmd0aCAvIHNlbGYud29yZF9jb3VudAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIDAKICAgICAgICB9OwogICAgICAgIGxldCB0ZXh0X2NvbXBsZXhpdHk6IGkzMiA9IChzZWxmLnVuaXF1ZV9jaGFycyAqIDEwMCkgLyAyNTY7CgogICAgICAgIHNlbGYuYWxnb3JpdGhtX3RpbWVzWzVdID0gYXZnX3dvcmRfbGVuZ3RoOwogICAgICAgIHNlbGYuYWxnb3JpdGhtX3RpbWVzWzZdID0gdGV4dF9jb21wbGV4aXR5OwogICAgfQoKICAgIC8vIE91dHB1dCBjb21wcmVoZW5zaXZlIHJlc3VsdHMKICAgIGZuIG91dHB1dF9yZXN1bHRzKCZzZWxmKSB7CiAgICAgICAgLy8gVGV4dCBzdGF0aXN0aWNzCiAgICAgICAgcHJpbnRsbkludChzZWxmLnRleHRfbGVuZ3RoKTsKICAgICAgICBwcmludGxuSW50KHNlbGYud29yZF9jb3VudCk7CiAgICAgICAgcHJpbnRsbkludChzZWxmLnNlbnRlbmNlX2NvdW50KTsKICAgICAgICBwcmludGxuSW50KHNlbGYucGFyYWdyYXBoX2NvdW50KTsKICAgICAgICBwcmludGxuSW50KHNlbGYudW5pcXVlX2NoYXJzKTsKCiAgICAgICAgLy8gUGF0dGVybiBtYXRjaGluZyByZXN1bHRzCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi5wYXR0ZXJuX2NvdW50KSB7CiAgICAgICAgICAgIHByaW50bG5JbnQoc2VsZi5tYXRjaF9jb3VudHNbaSBhcyB1c2l6ZV0pOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBBbGdvcml0aG0gcGVyZm9ybWFuY2UgbWV0cmljcwogICAgICAgIHByaW50bG5JbnQoc2VsZi5jb21wYXJpc29uX2NvdW50KTsKICAgICAgICBwcmludGxuSW50KHNlbGYuaGFzaF9jb2xsaXNpb25zKTsKCiAgICAgICAgLy8gQW5hbHlzaXMgcmVzdWx0cwogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgNykgewogICAgICAgICAgICBwcmludGxuSW50KHNlbGYuYWxnb3JpdGhtX3RpbWVzW2kgYXMgdXNpemVdKTsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gU3VmZml4IGFycmF5IHNhbXBsZSAoZmlyc3QgMTAgZW50cmllcykKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IDEwICYmIGkgPCBzZWxmLnRleHRfbGVuZ3RoKSB7CiAgICAgICAgICAgIHByaW50bG5JbnQoc2VsZi5zdWZmaXhfYXJyYXlbaSBhcyB1c2l6ZV0pOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBGaW5hbCBjb21wbGV4aXR5IHNjb3JlCiAgICAgICAgbGV0IHBhdHRlcm5fY29tcGxleGl0eTogaTMyID0gc2VsZi5jb21wYXJpc29uX2NvdW50IC8gKHNlbGYucGF0dGVybl9jb3VudCArIDEpOwogICAgICAgIGxldCB0ZXh0X2NvbXBsZXhpdHk6IGkzMiA9IChzZWxmLnVuaXF1ZV9jaGFycyAqIHNlbGYud29yZF9jb3VudCkgLyAxMDA7CiAgICAgICAgbGV0IGZpbmFsX3Njb3JlOiBpMzIgPSBwYXR0ZXJuX2NvbXBsZXhpdHkgKyB0ZXh0X2NvbXBsZXhpdHkgKyBzZWxmLmFsZ29yaXRobV90aW1lc1szXTsKICAgICAgICBwcmludGxuSW50KGZpbmFsX3Njb3JlKTsKICAgIH0KfQoKLy8gQWR2YW5jZWQgcmVndWxhciBleHByZXNzaW9uIG1hdGNoZXIgKHNpbXBsaWZpZWQpCnN0cnVjdCBSZWdleE1hdGNoZXIgewogICAgcGF0dGVybjogW2kzMjsgMTAwXSwKICAgIHBhdHRlcm5fbGVuZ3RoOiBpMzIsCiAgICBuZmFfc3RhdGVzOiBbW2Jvb2w7IDEwMF07IDEwMF0sCiAgICBzdGF0ZV9jb3VudDogaTMyLAogICAgbWF0Y2hfZm91bmQ6IGJvb2wsCn0KCmltcGwgUmVnZXhNYXRjaGVyIHsKICAgIGZuIG5ldygpIC0+IFJlZ2V4TWF0Y2hlciB7CiAgICAgICAgUmVnZXhNYXRjaGVyIHsKICAgICAgICAgICAgcGF0dGVybjogWzA7IDEwMF0sCiAgICAgICAgICAgIHBhdHRlcm5fbGVuZ3RoOiAwLAogICAgICAgICAgICBuZmFfc3RhdGVzOiBbW2ZhbHNlOyAxMDBdOyAxMDBdLAogICAgICAgICAgICBzdGF0ZV9jb3VudDogMCwKICAgICAgICAgICAgbWF0Y2hfZm91bmQ6IGZhbHNlLAogICAgICAgIH0KICAgIH0KCiAgICBmbiBjb21waWxlX3BhdHRlcm4oJm11dCBzZWxmLCBsZW5ndGg6IGkzMikgewogICAgICAgIHNlbGYucGF0dGVybl9sZW5ndGggPSBsZW5ndGg7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgbGVuZ3RoKSB7CiAgICAgICAgICAgIHNlbGYucGF0dGVybltpIGFzIHVzaXplXSA9IGdldEludCgpOwogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBCdWlsZCBzaW1wbGUgTkZBIChzaW1wbGlmaWVkIGZvciBiYXNpYyBwYXR0ZXJucykKICAgICAgICBzZWxmLmJ1aWxkX25mYSgpOwogICAgfQoKICAgIGZuIGJ1aWxkX25mYSgmbXV0IHNlbGYpIHsKICAgICAgICBzZWxmLnN0YXRlX2NvdW50ID0gc2VsZi5wYXR0ZXJuX2xlbmd0aCArIDE7CgogICAgICAgIC8vIEluaXRpYWxpemUgTkZBIHN0YXRlcwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNlbGYuc3RhdGVfY291bnQpIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IDEwMCkgewogICAgICAgICAgICAgICAgc2VsZi5uZmFfc3RhdGVzW2kgYXMgdXNpemVdW2ogYXMgdXNpemVdID0gZmFsc2U7CiAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0KCiAgICAgICAgLy8gQnVpbGQgdHJhbnNpdGlvbnMgZm9yIGxpdGVyYWwgY2hhcmFjdGVycwogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2VsZi5wYXR0ZXJuX2xlbmd0aCkgewogICAgICAgICAgICBsZXQgY2g6IGkzMiA9IHNlbGYucGF0dGVybltpIGFzIHVzaXplXTsKICAgICAgICAgICAgaWYgKGNoID49IDAgJiYgY2ggPCAxMDApIHsKICAgICAgICAgICAgICAgIHNlbGYubmZhX3N0YXRlc1tpIGFzIHVzaXplXVtjaCBhcyB1c2l6ZV0gPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgKz0gMTsKICAgICAgICB9CiAgICB9CgogICAgZm4gbWF0Y2hfdGV4dCgmbXV0IHNlbGYsIHRleHQ6ICZbaTMyOyA1MDAwXSwgdGV4dF9sZW5ndGg6IGkzMikgLT4gYm9vbCB7CiAgICAgICAgbGV0IG11dCBjdXJyZW50X3N0YXRlczogW2Jvb2w7IDEwMF0gPSBbZmFsc2U7IDEwMF07CiAgICAgICAgbGV0IG11dCBuZXh0X3N0YXRlczogW2Jvb2w7IDEwMF0gPSBbZmFsc2U7IDEwMF07CgogICAgICAgIGN1cnJlbnRfc3RhdGVzWzBdID0gdHJ1ZTsKCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgdGV4dF9sZW5ndGgpIHsKICAgICAgICAgICAgbGV0IGNoOiBpMzIgPSB0ZXh0W2kgYXMgdXNpemVdOwoKICAgICAgICAgICAgLy8gQ2xlYXIgbmV4dCBzdGF0ZXMKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IDEwMCkgewogICAgICAgICAgICAgICAgbmV4dF9zdGF0ZXNbaiBhcyB1c2l6ZV0gPSBmYWxzZTsKICAgICAgICAgICAgICAgIGogKz0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gUHJvY2VzcyB0cmFuc2l0aW9ucwogICAgICAgICAgICBqID0gMDsKICAgICAgICAgICAgd2hpbGUgKGogPCBzZWxmLnN0YXRlX2NvdW50KSB7CiAgICAgICAgICAgICAgICBpZiAoY3VycmVudF9zdGF0ZXNbaiBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgICAgICBpZiAoaiA8IHNlbGYucGF0dGVybl9sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgJiYgY2ggPj0gMAogICAgICAgICAgICAgICAgICAgICAgICAmJiBjaCA8IDEwMAogICAgICAgICAgICAgICAgICAgICAgICAmJiBzZWxmLm5mYV9zdGF0ZXNbaiBhcyB1c2l6ZV1bY2ggYXMgdXNpemVdKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgbmV4dF9zdGF0ZXNbKGogKyAxKSBhcyB1c2l6ZV0gPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGogKz0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU3dhcCBzdGF0ZXMKICAgICAgICAgICAgaiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChqIDwgMTAwKSB7CiAgICAgICAgICAgICAgICBjdXJyZW50X3N0YXRlc1tqIGFzIHVzaXplXSA9IG5leHRfc3RhdGVzW2ogYXMgdXNpemVdOwogICAgICAgICAgICAgICAgaiArPSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpICs9IDE7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gY3VycmVudF9zdGF0ZXNbc2VsZi5wYXR0ZXJuX2xlbmd0aCBhcyB1c2l6ZV07CiAgICB9Cn0KCmZuIG1haW4oKSB7CiAgICAvLyBJbml0aWFsaXplIHN0cmluZyBwcm9jZXNzb3IKICAgIGxldCBtdXQgcHJvY2Vzc29yOiBTdHJpbmdQcm9jZXNzb3IgPSBTdHJpbmdQcm9jZXNzb3I6Om5ldygpOwoKICAgIC8vIFJlYWQgdGV4dAogICAgbGV0IHRleHRfbGVuZ3RoOiBpMzIgPSBnZXRJbnQoKTsKICAgIHByb2Nlc3Nvci5pbml0aWFsaXplX3RleHQodGV4dF9sZW5ndGgpOwoKICAgIC8vIFJlYWQgcGF0dGVybnMKICAgIGxldCBwYXR0ZXJuX2NvdW50OiBpMzIgPSBnZXRJbnQoKTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgcGF0dGVybl9jb3VudCkgewogICAgICAgIGxldCBwYXR0ZXJuX2xlbmd0aDogaTMyID0gZ2V0SW50KCk7CiAgICAgICAgcHJvY2Vzc29yLmFkZF9wYXR0ZXJuKHBhdHRlcm5fbGVuZ3RoKTsKICAgICAgICBpICs9IDE7CiAgICB9CgogICAgLy8gUGVyZm9ybSBjb21wcmVoZW5zaXZlIHN0cmluZyBhbmFseXNpcwogICAgcHJvY2Vzc29yLnBlcmZvcm1fY29tcHJlaGVuc2l2ZV9hbmFseXNpcygpOwoKICAgIC8vIEVkaXQgZGlzdGFuY2UgY29tcHV0YXRpb24KICAgIGxldCBzdHIxX2xlbjogaTMyID0gZ2V0SW50KCk7CiAgICBsZXQgc3RyMl9sZW46IGkzMiA9IGdldEludCgpOwogICAgbGV0IGVkaXRfZGlzdGFuY2U6IGkzMiA9IHByb2Nlc3Nvci5jb21wdXRlX2VkaXRfZGlzdGFuY2Uoc3RyMV9sZW4sIHN0cjJfbGVuKTsKICAgIHByaW50bG5JbnQoZWRpdF9kaXN0YW5jZSk7CgogICAgLy8gUmVndWxhciBleHByZXNzaW9uIG1hdGNoaW5nCiAgICBsZXQgbXV0IHJlZ2V4X21hdGNoZXI6IFJlZ2V4TWF0Y2hlciA9IFJlZ2V4TWF0Y2hlcjo6bmV3KCk7CiAgICBsZXQgcmVnZXhfcGF0dGVybl9sZW5ndGg6IGkzMiA9IGdldEludCgpOwogICAgcmVnZXhfbWF0Y2hlci5jb21waWxlX3BhdHRlcm4ocmVnZXhfcGF0dGVybl9sZW5ndGgpOwoKICAgIGxldCByZWdleF9yZXN1bHQ6IGJvb2wgPSByZWdleF9tYXRjaGVyLm1hdGNoX3RleHQoJnByb2Nlc3Nvci50ZXh0LCBwcm9jZXNzb3IudGV4dF9sZW5ndGgpOwogICAgcHJpbnRsbkludChpZiAocmVnZXhfcmVzdWx0KSB7IDEgfSBlbHNlIHsgMCB9KTsKCiAgICAvLyBPdXRwdXQgYWxsIHJlc3VsdHMKICAgIHByb2Nlc3Nvci5vdXRwdXRfcmVzdWx0cygpOwoKICAgIC8vIEFkdmFuY2VkIHN0cmluZyB0cmFuc2Zvcm1hdGlvbnMgYW5kIGFuYWx5c2lzCiAgICBsZXQgdHJhbnNmb3JtYXRpb25faXRlcmF0aW9uczogaTMyID0gZ2V0SW50KCk7CiAgICBsZXQgbXV0IHRvdGFsX3RyYW5zZm9ybWF0aW9uczogaTMyID0gMDsKCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgdHJhbnNmb3JtYXRpb25faXRlcmF0aW9ucykgewogICAgICAgIC8vIEFwcGx5IGNoYXJhY3RlciB0cmFuc2Zvcm1hdGlvbnMKICAgICAgICBsZXQgc2hpZnQ6IGkzMiA9IChpICogNyArIDMpICUgMjY7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgcHJvY2Vzc29yLnRleHRfbGVuZ3RoKSB7CiAgICAgICAgICAgIGxldCBjaDogaTMyID0gcHJvY2Vzc29yLnRleHRbaiBhcyB1c2l6ZV07CiAgICAgICAgICAgIGlmIChjaCA+PSA2NSAmJiBjaCA8PSA5MCkgewogICAgICAgICAgICAgICAgLy8gVXBwZXJjYXNlIGxldHRlcnMKICAgICAgICAgICAgICAgIHByb2Nlc3Nvci50ZXh0W2ogYXMgdXNpemVdID0gKChjaCAtIDY1ICsgc2hpZnQpICUgMjYpICsgNjU7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoY2ggPj0gOTcgJiYgY2ggPD0gMTIyKSB7CiAgICAgICAgICAgICAgICAvLyBMb3dlcmNhc2UgbGV0dGVycwogICAgICAgICAgICAgICAgcHJvY2Vzc29yLnRleHRbaiBhcyB1c2l6ZV0gPSAoKGNoIC0gOTcgKyBzaGlmdCkgJSAyNikgKyA5NzsKICAgICAgICAgICAgfQogICAgICAgICAgICBqICs9IDE7CiAgICAgICAgfQoKICAgICAgICAvLyBSZWFuYWx5emUgYWZ0ZXIgdHJhbnNmb3JtYXRpb24KICAgICAgICBwcm9jZXNzb3IuYW5hbHl6ZV90ZXh0X3N0YXRpc3RpY3MoKTsKICAgICAgICB0b3RhbF90cmFuc2Zvcm1hdGlvbnMgKz0gcHJvY2Vzc29yLnVuaXF1ZV9jaGFyczsKCiAgICAgICAgaSArPSAxOwogICAgfQoKICAgIHByaW50bG5JbnQodG90YWxfdHJhbnNmb3JtYXRpb25zKTsKCiAgICAvLyBGaW5hbCBjb21wcmVoZW5zaXZlIG1ldHJpYwogICAgbGV0IGZpbmFsX2NvbXBsZXhpdHk6IGkzMiA9CiAgICAgICAgKHByb2Nlc3Nvci5jb21wYXJpc29uX2NvdW50ICsgdG90YWxfdHJhbnNmb3JtYXRpb25zKSAqIHByb2Nlc3Nvci51bmlxdWVfY2hhcnMgLyAxMDA7CiAgICBwcmludGxuSW50KGZpbmFsX2NvbXBsZXhpdHkpOwogICAgZXhpdCgwKTsKfQoKLyoKU2FtcGxlIHN0ZGluIGlucHV0IChjb3ZlcnMgYWxsIGdldEludCgpIHJlYWRzIGluIG9yZGVyKToKCiMgdGV4dF9sZW5ndGgKMTQKIyB0ZXh0IGJ5dGVzIChBU0NJSSk6ICJhIGhlbGxvIHdvcmxkLiIKOTcgMzIgMTA0IDEwMSAxMDggMTA4IDExMSAzMiAxMTkgMTExIDExNCAxMDggMTAwIDQ2CgojIHBhdHRlcm5fY291bnQKMgojIHBhdHRlcm4gMSBsZW5ndGggYW5kIGJ5dGVzOiAiaGVsbG8iCjUKMTA0IDEwMSAxMDggMTA4IDExMQojIHBhdHRlcm4gMiBsZW5ndGggYW5kIGJ5dGVzOiAid29ybGQiCjUKMTE5IDExMSAxMTQgMTA4IDEwMAoKIyBlZGl0IGRpc3RhbmNlOiBzdHIxX2xlbiwgc3RyMl9sZW4sIHRoZW4gc3RyMSBieXRlcyAoImtpdHRlbiIpLCBzdHIyIGJ5dGVzICgic2l0dGluZyIpCjYKNwoxMDcgMTA1IDExNiAxMTYgMTAxIDExMAoxMTUgMTA1IDExNiAxMTYgMTA1IDExMCAxMDMKCiMgcmVnZXhfcGF0dGVybl9sZW5ndGggYW5kIHBhdHRlcm4gYnl0ZXMgKG1hdGNoZXMgbGVhZGluZyAnYScpCjEKOTcKCiMgdHJhbnNmb3JtYXRpb25faXRlcmF0aW9ucwoyCiovCg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (16, "comprehensive16", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEFkdmFuY2VkIExpbmtlZCBMaXN0IEltcGxlbWVudGF0aW9uIGFuZCBPcGVyYXRpb25zClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpDb21wbGV4IHBvaW50ZXIgYXJpdGhtZXRpYyBzaW11bGF0aW9uIHVzaW5nIGFycmF5cyBhbmQgaW5kaWNlcwpEeW5hbWljIG1lbW9yeSBtYW5hZ2VtZW50IHNpbXVsYXRpb24KQ29tcGxleCBicmFuY2hpbmcgYW5kIGNvbmRpdGlvbmFsIGxvZ2ljCkZ1bmN0aW9uIGNhbGwgb3B0aW1pemF0aW9uIHdpdGggbXVsdGlwbGUgcGFyYW1ldGVycwpMb29wIG9wdGltaXphdGlvbiBpbiB2YXJpb3VzIGFjY2VzcyBwYXR0ZXJucwpFZGdlIGNhc2UgaGFuZGxpbmcgYW5kIGJvdW5kYXJ5IGNvbmRpdGlvbiB0ZXN0aW5nCiovCgovLyBjb21wcmVoZW5zaXZlMTYucnggLSBBZHZhbmNlZCBMaW5rZWQgTGlzdCBJbXBsZW1lbnRhdGlvbiBhbmQgT3BlcmF0aW9ucwovLyBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKLy8gLSBDb21wbGV4IHBvaW50ZXIgYXJpdGhtZXRpYyBzaW11bGF0aW9uIHVzaW5nIGFycmF5cyBhbmQgaW5kaWNlcwovLyAtIER5bmFtaWMgbWVtb3J5IG1hbmFnZW1lbnQgc2ltdWxhdGlvbgovLyAtIENvbXBsZXggYnJhbmNoaW5nIGFuZCBjb25kaXRpb25hbCBsb2dpYwovLyAtIEZ1bmN0aW9uIGNhbGwgb3B0aW1pemF0aW9uIHdpdGggbXVsdGlwbGUgcGFyYW1ldGVycwovLyAtIExvb3Agb3B0aW1pemF0aW9uIGluIHZhcmlvdXMgYWNjZXNzIHBhdHRlcm5zCi8vIC0gRWRnZSBjYXNlIGhhbmRsaW5nIGFuZCBib3VuZGFyeSBjb25kaXRpb24gdGVzdGluZwoKZm4gbWFpbigpIHsKICAgIHByaW50bG5JbnQoMTYwMCk7IC8vIFRlc3Qgc3RhcnQgbWFya2VyCiAgICAKICAgIC8vIEluaXRpYWxpemUgYSBzaW11bGF0ZWQgbWVtb3J5IHBvb2wgZm9yIGxpbmtlZCBsaXN0IG9wZXJhdGlvbnMKICAgIC8vIFVzaW5nIGFycmF5IGluZGljZXMgdG8gc2ltdWxhdGUgcG9pbnRlcnMgZm9yIHRoaXMgc2ltcGxpZmllZCBsYW5ndWFnZQogICAgcGVyZm9ybUxpbmtlZExpc3RPcGVyYXRpb25zKCk7CiAgICAKICAgIC8vIFRlc3QgY29tcGxleCBsaXN0IG1hbmlwdWxhdGlvbnMgd2l0aCBlZGdlIGNhc2VzCiAgICB0ZXN0QWR2YW5jZWRMaXN0T3BlcmF0aW9ucygpOwogICAgCiAgICAvLyBQZXJmb3JtYW5jZSBzdHJlc3MgdGVzdCB3aXRoIGxhcmdlIGxpc3RzCiAgICBwZXJmb3JtTGlzdFBlcmZvcm1hbmNlVGVzdCgpOwogICAgCiAgICAvLyBUZXN0IGJvdW5kYXJ5IGNvbmRpdGlvbnMgYW5kIGNvcm5lciBjYXNlcwogICAgdGVzdEVkZ2VDYXNlcygpOwogICAgCiAgICBwcmludGxuSW50KDE2OTkpOyAvLyBUZXN0IGVuZCBtYXJrZXIKICAgIGV4aXQoMCk7Cn0KCi8vIFNpbXVsYXRlZCBsaW5rZWQgbGlzdCBpbXBsZW1lbnRhdGlvbiB1c2luZyBhcnJheS1iYXNlZCBtZW1vcnkgbWFuYWdlbWVudAovLyBFYWNoICJub2RlIiBvY2N1cGllcyAyIGNvbnNlY3V0aXZlIGFycmF5IHNsb3RzOiBbZGF0YSwgbmV4dF9pbmRleF0KLy8gSW5kZXggMCByZXByZXNlbnRzIE5VTEwgcG9pbnRlcgpmbiBwZXJmb3JtTGlua2VkTGlzdE9wZXJhdGlvbnMoKSB7CiAgICBwcmludGxuSW50KDE2MDEpOyAvLyBTdGFydCBiYXNpYyBvcGVyYXRpb25zCiAgICAKICAgIC8vIE1lbW9yeSBwb29sOiAyMDAwIHNsb3RzIGZvciAxMDAwIHBvdGVudGlhbCBub2RlcwogICAgbGV0IG11dCBtZW1vcnlfcG9vbDogW2kzMjsgMjAwMF0gPSBbMDsgMjAwMF07CiAgICBsZXQgbXV0IGZyZWVfbGlzdF9oZWFkOiBpMzIgPSAxOyAvLyBTdGFydCBmcm9tIGluZGV4IDEgKDAgaXMgTlVMTCkKICAgIGxldCBtdXQgbGlzdF9oZWFkOiBpMzIgPSAwOyAgICAgIC8vIEVtcHR5IGxpc3QgaW5pdGlhbGx5CiAgICBsZXQgbXV0IGFsbG9jYXRlZF9jb3VudDogaTMyID0gMDsKICAgIAogICAgLy8gSW5pdGlhbGl6ZSBmcmVlIGxpc3QgLSBlYWNoIGZyZWUgbm9kZSBwb2ludHMgdG8gbmV4dCBmcmVlIHNsb3QKICAgIGluaXRpYWxpemVGcmVlTGlzdCgmbXV0IG1lbW9yeV9wb29sLCBmcmVlX2xpc3RfaGVhZCk7CiAgICAKICAgIC8vIFRlc3QgMTogQnVpbGQgYSBsYXJnZSBsaW5rZWQgbGlzdCB3aXRoIHNlcXVlbnRpYWwgaW5zZXJ0aW9uCiAgICBwcmludGxuSW50KDE2MDIpOyAvLyBCdWlsZGluZyBsaXN0IG1hcmtlcgogICAgbGV0IG11dCBpOiBpMzIgPSAxOwogICAgd2hpbGUgKGkgPD0gMTAwKSB7CiAgICAgICAgbGV0IG5ld19ub2RlOiBpMzIgPSBhbGxvY2F0ZU5vZGUoJm11dCBtZW1vcnlfcG9vbCwgZnJlZV9saXN0X2hlYWQpOwogICAgICAgIGlmIChuZXdfbm9kZSAhPSAwKSB7CiAgICAgICAgICAgIC8vIFNldCBub2RlIGRhdGEKICAgICAgICAgICAgbWVtb3J5X3Bvb2xbbmV3X25vZGUgYXMgdXNpemVdID0gaSAqIDcgKyAxMzsgLy8gU29tZSBjb21wdXRlZCB2YWx1ZQogICAgICAgICAgICAvLyBJbnNlcnQgYXQgaGVhZAogICAgICAgICAgICBtZW1vcnlfcG9vbFtuZXdfbm9kZSBhcyB1c2l6ZSArIDFdID0gbGlzdF9oZWFkOwogICAgICAgICAgICBsaXN0X2hlYWQgPSBuZXdfbm9kZTsKICAgICAgICAgICAgYWxsb2NhdGVkX2NvdW50ID0gYWxsb2NhdGVkX2NvdW50ICsgMTsKICAgICAgICAgICAgZnJlZV9saXN0X2hlYWQgPSBtZW1vcnlfcG9vbFtmcmVlX2xpc3RfaGVhZCBhcyB1c2l6ZSArIDFdOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIFRlc3QgMjogTGlzdCB0cmF2ZXJzYWwgYW5kIHN1bSBjYWxjdWxhdGlvbgogICAgcHJpbnRsbkludCgxNjAzKTsgLy8gVHJhdmVyc2FsIG1hcmtlcgogICAgbGV0IHN1bTogaTMyID0gY2FsY3VsYXRlTGlzdFN1bSgmbXV0IG1lbW9yeV9wb29sLCBsaXN0X2hlYWQpOwogICAgcHJpbnRsbkludChzdW0pOwogICAgCiAgICAvLyBUZXN0IDM6IExpc3QgcmV2ZXJzYWwgLSBjb21wbGV4IHBvaW50ZXIgbWFuaXB1bGF0aW9uCiAgICBwcmludGxuSW50KDE2MDQpOyAvLyBSZXZlcnNhbCBtYXJrZXIKICAgIGxpc3RfaGVhZCA9IHJldmVyc2VMaXN0KCZtdXQgbWVtb3J5X3Bvb2wsIGxpc3RfaGVhZCk7CiAgICAKICAgIC8vIFZlcmlmeSByZXZlcnNhbCBieSByZWNhbGN1bGF0aW5nIHN1bQogICAgbGV0IHJldmVyc2VkX3N1bTogaTMyID0gY2FsY3VsYXRlTGlzdFN1bSgmbXV0IG1lbW9yeV9wb29sLCBsaXN0X2hlYWQpOwogICAgcHJpbnRsbkludChyZXZlcnNlZF9zdW0pOwogICAgCiAgICAvLyBUZXN0IDQ6IENvbXBsZXggbGlzdCBzZWFyY2ggd2l0aCBtdWx0aXBsZSBjcml0ZXJpYQogICAgcHJpbnRsbkludCgxNjA1KTsgLy8gU2VhcmNoIG1hcmtlcgogICAgbGV0IHNlYXJjaF9yZXN1bHRzOiBpMzIgPSBjb21wbGV4TGlzdFNlYXJjaCgmbXV0IG1lbW9yeV9wb29sLCBsaXN0X2hlYWQpOwogICAgcHJpbnRsbkludChzZWFyY2hfcmVzdWx0cyk7CiAgICAKICAgIC8vIFRlc3QgNTogTGlzdCBzb3J0aW5nIHVzaW5nIG1lcmdlIHNvcnQKICAgIHByaW50bG5JbnQoMTYwNik7IC8vIFNvcnQgbWFya2VyCiAgICBsaXN0X2hlYWQgPSBtZXJnZVNvcnQoJm11dCBtZW1vcnlfcG9vbCwgbGlzdF9oZWFkLCBhbGxvY2F0ZWRfY291bnQpOwogICAgCiAgICAvLyBWZXJpZnkgc29ydGluZwogICAgbGV0IHNvcnRlZF9jaGVjazogaTMyID0gdmVyaWZ5U29ydGVkKCZtdXQgbWVtb3J5X3Bvb2wsIGxpc3RfaGVhZCk7CiAgICBwcmludGxuSW50KHNvcnRlZF9jaGVjayk7Cn0KCi8vIEluaXRpYWxpemUgZnJlZSBsaXN0IHdpdGggcHJvcGVyIGxpbmtpbmcKZm4gaW5pdGlhbGl6ZUZyZWVMaXN0KG1lbW9yeV9wb29sOiAmbXV0IFtpMzI7IDIwMDBdLCBzdGFydF9pbmRleDogaTMyKSB7CiAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9IHN0YXJ0X2luZGV4OwogICAgd2hpbGUgKGN1cnJlbnQgPCAxOTk4KSB7IC8vIExlYXZlIHNwYWNlIGZvciBkYXRhK25leHQgcGFpcnMKICAgICAgICBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplXSA9IDA7ICAgICAgICAgICAvLyBEYXRhIHNsb3QgKHVudXNlZCBpbiBmcmVlIGxpc3QpCiAgICAgICAgbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdID0gY3VycmVudCArIDI7IC8vIE5leHQgZnJlZSBzbG90CiAgICAgICAgY3VycmVudCA9IGN1cnJlbnQgKyAyOwogICAgfQogICAgLy8gTGFzdCBmcmVlIG5vZGUgcG9pbnRzIHRvIE5VTEwKICAgIG1lbW9yeV9wb29sWzE5OThdID0gMDsKICAgIG1lbW9yeV9wb29sWzE5OTldID0gMDsKfQoKLy8gU2ltdWxhdGUgbWVtb3J5IGFsbG9jYXRpb24KZm4gYWxsb2NhdGVOb2RlKG1lbW9yeV9wb29sOiAmbXV0IFtpMzI7IDIwMDBdLCBmcmVlX2hlYWQ6IGkzMikgLT4gaTMyIHsKICAgIGlmIChmcmVlX2hlYWQgPT0gMCB8fCBmcmVlX2hlYWQgPj0gMTk5OCkgewogICAgICAgIHJldHVybiAwOyAvLyBObyBtb3JlIGZyZWUgbm9kZXMKICAgIH0KICAgIAogICAgbGV0IGFsbG9jYXRlZF9ub2RlOiBpMzIgPSBmcmVlX2hlYWQ7CiAgICAvLyBVcGRhdGUgZnJlZSBsaXN0IGhlYWQgdG8gbmV4dCBmcmVlIG5vZGUKICAgIGxldCBuZXh0X2ZyZWU6IGkzMiA9IG1lbW9yeV9wb29sW2ZyZWVfaGVhZCBhcyB1c2l6ZSArIDFdOwogICAgCiAgICAvLyBDbGVhciBhbGxvY2F0ZWQgbm9kZQogICAgbWVtb3J5X3Bvb2xbYWxsb2NhdGVkX25vZGUgYXMgdXNpemVdID0gMDsKICAgIG1lbW9yeV9wb29sW2FsbG9jYXRlZF9ub2RlIGFzIHVzaXplICsgMV0gPSAwOwogICAgCiAgICByZXR1cm4gYWxsb2NhdGVkX25vZGU7Cn0KCi8vIENhbGN1bGF0ZSBzdW0gb2YgYWxsIHZhbHVlcyBpbiB0aGUgbGlua2VkIGxpc3QKZm4gY2FsY3VsYXRlTGlzdFN1bShtZW1vcnlfcG9vbDogJm11dCBbaTMyOyAyMDAwXSwgaGVhZDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9IGhlYWQ7CiAgICBsZXQgbXV0IG5vZGVfY291bnQ6IGkzMiA9IDA7CiAgICAKICAgIHdoaWxlIChjdXJyZW50ICE9IDAgJiYgbm9kZV9jb3VudCA8IDEwMDApIHsgLy8gUHJldmVudCBpbmZpbml0ZSBsb29wcwogICAgICAgIHN1bSA9IHN1bSArIG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemVdOwogICAgICAgIGN1cnJlbnQgPSBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplICsgMV07CiAgICAgICAgbm9kZV9jb3VudCA9IG5vZGVfY291bnQgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gc3VtOwp9CgovLyBSZXZlcnNlIHRoZSBsaW5rZWQgbGlzdCAtIGNsYXNzaWMgcG9pbnRlciBtYW5pcHVsYXRpb24gY2hhbGxlbmdlCmZuIHJldmVyc2VMaXN0KG1lbW9yeV9wb29sOiAmbXV0IFtpMzI7IDIwMDBdLCBoZWFkOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHByZXY6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9IGhlYWQ7CiAgICBsZXQgbXV0IG5leHQ6IGkzMiA9IC0xOwogICAgbGV0IG11dCBzdGVwX2NvdW50OiBpMzIgPSAwOwogICAgCiAgICB3aGlsZSAoY3VycmVudCAhPSAwICYmIHN0ZXBfY291bnQgPCAxMDAwKSB7CiAgICAgICAgbmV4dCA9IG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemUgKyAxXTsgIC8vIFNhdmUgbmV4dAogICAgICAgIG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemUgKyAxXSA9IHByZXY7ICAvLyBSZXZlcnNlIGxpbmsKICAgICAgICBwcmV2ID0gY3VycmVudDsgICAgICAgICAgICAgICAgICAgLy8gTW92ZSBwcmV2IGZvcndhcmQKICAgICAgICBjdXJyZW50ID0gbmV4dDsgICAgICAgICAgICAgICAgICAgLy8gTW92ZSBjdXJyZW50IGZvcndhcmQKICAgICAgICBzdGVwX2NvdW50ID0gc3RlcF9jb3VudCArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBwcmV2OyAvLyBOZXcgaGVhZAp9CgovLyBDb21wbGV4IHNlYXJjaCBmdW5jdGlvbiB3aXRoIG11bHRpcGxlIGNvbmRpdGlvbnMKZm4gY29tcGxleExpc3RTZWFyY2gobWVtb3J5X3Bvb2w6ICZtdXQgW2kzMjsgMjAwMF0sIGhlYWQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgY3VycmVudDogaTMyID0gaGVhZDsKICAgIGxldCBtdXQgZm91bmRfY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IG1heF92YWx1ZTogaTMyID0gLTk5OTk5OTsKICAgIGxldCBtdXQgbWluX3ZhbHVlOiBpMzIgPSA5OTk5OTk7CiAgICBsZXQgbXV0IGV2ZW5fY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IG9kZF9jb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgcG9zaXRpb246IGkzMiA9IDA7CiAgICAKICAgIHdoaWxlIChjdXJyZW50ICE9IDAgJiYgcG9zaXRpb24gPCAxMDAwKSB7CiAgICAgICAgbGV0IHZhbHVlOiBpMzIgPSBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplXTsKICAgICAgICAKICAgICAgICAvLyBUcmFjayBtaW4vbWF4IHZhbHVlcwogICAgICAgIGlmICh2YWx1ZSA+IG1heF92YWx1ZSkgewogICAgICAgICAgICBtYXhfdmFsdWUgPSB2YWx1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKHZhbHVlIDwgbWluX3ZhbHVlKSB7CiAgICAgICAgICAgIG1pbl92YWx1ZSA9IHZhbHVlOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBDb3VudCBldmVuL29kZCB2YWx1ZXMKICAgICAgICBpZiAodmFsdWUgJSAyID09IDApIHsKICAgICAgICAgICAgZXZlbl9jb3VudCA9IGV2ZW5fY291bnQgKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG9kZF9jb3VudCA9IG9kZF9jb3VudCArIDE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIENvbXBsZXggc2VhcmNoIGNyaXRlcmlhOiBkaXZpc2libGUgYnkgNyBBTkQgZ3JlYXRlciB0aGFuIDUwCiAgICAgICAgaWYgKHZhbHVlICUgNyA9PSAwICYmIHZhbHVlID4gNTApIHsKICAgICAgICAgICAgZm91bmRfY291bnQgPSBmb3VuZF9jb3VudCArIDE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGN1cnJlbnQgPSBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplICsgMV07CiAgICAgICAgcG9zaXRpb24gPSBwb3NpdGlvbiArIDE7CiAgICB9CiAgICAKICAgIC8vIFJldHVybiBjb21wb3NpdGUgcmVzdWx0CiAgICByZXR1cm4gZm91bmRfY291bnQgKiAxMDAwICsgZXZlbl9jb3VudCAqIDEwICsgb2RkX2NvdW50Owp9CgovLyBNZXJnZSBzb3J0IGltcGxlbWVudGF0aW9uIGZvciBsaW5rZWQgbGlzdApmbiBtZXJnZVNvcnQobWVtb3J5X3Bvb2w6ICZtdXQgW2kzMjsgMjAwMF0sIGhlYWQ6IGkzMiwgbGVuZ3RoOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoaGVhZCA9PSAwIHx8IG1lbW9yeV9wb29sW2hlYWQgYXMgdXNpemUgKyAxXSA9PSAwKSB7CiAgICAgICAgcmV0dXJuIGhlYWQ7IC8vIFNpbmdsZSBub2RlIG9yIGVtcHR5IGxpc3QKICAgIH0KICAgIAogICAgLy8gU3BsaXQgdGhlIGxpc3QgaW50byB0d28gaGFsdmVzCiAgICBsZXQgbWlkX3BvaW50OiBpMzIgPSBsZW5ndGggLyAyOwogICAgbGV0IHNlY29uZF9oYWxmOiBpMzIgPSBzcGxpdExpc3QobWVtb3J5X3Bvb2wsIGhlYWQsIG1pZF9wb2ludCk7CiAgICAKICAgIC8vIFJlY3Vyc2l2ZWx5IHNvcnQgYm90aCBoYWx2ZXMKICAgIGxldCBmaXJzdF9zb3J0ZWQ6IGkzMiA9IG1lcmdlU29ydChtZW1vcnlfcG9vbCwgaGVhZCwgbWlkX3BvaW50KTsKICAgIGxldCBzZWNvbmRfc29ydGVkOiBpMzIgPSBtZXJnZVNvcnQobWVtb3J5X3Bvb2wsIHNlY29uZF9oYWxmLCBsZW5ndGggLSBtaWRfcG9pbnQpOwogICAgCiAgICAvLyBNZXJnZSB0aGUgc29ydGVkIGhhbHZlcwogICAgcmV0dXJuIG1lcmdlTGlzdHMobWVtb3J5X3Bvb2wsIGZpcnN0X3NvcnRlZCwgc2Vjb25kX3NvcnRlZCk7Cn0KCi8vIFNwbGl0IGxpc3QgYXQgZ2l2ZW4gcG9zaXRpb24KZm4gc3BsaXRMaXN0KG1lbW9yeV9wb29sOiAmbXV0IFtpMzI7IDIwMDBdLCBoZWFkOiBpMzIsIHNwbGl0X3BvczogaTMyKSAtPiBpMzIgewogICAgaWYgKHNwbGl0X3BvcyA8PSAxKSB7CiAgICAgICAgcmV0dXJuIGhlYWQ7CiAgICB9CiAgICAKICAgIGxldCBtdXQgY3VycmVudDogaTMyID0gaGVhZDsKICAgIGxldCBtdXQgY291bnQ6IGkzMiA9IDE7CiAgICAKICAgIHdoaWxlIChjb3VudCA8IHNwbGl0X3BvcyAtIDEgJiYgY3VycmVudCAhPSAwKSB7CiAgICAgICAgY3VycmVudCA9IG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemUgKyAxXTsKICAgICAgICBjb3VudCA9IGNvdW50ICsgMTsKICAgIH0KICAgIAogICAgaWYgKGN1cnJlbnQgPT0gMCkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgCiAgICBsZXQgc2Vjb25kX2hhbGY6IGkzMiA9IG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemUgKyAxXTsKICAgIG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemUgKyAxXSA9IDA7IC8vIEJyZWFrIHRoZSBsaW5rCiAgICAKICAgIHJldHVybiBzZWNvbmRfaGFsZjsKfQoKLy8gTWVyZ2UgdHdvIHNvcnRlZCBsaW5rZWQgbGlzdHMKZm4gbWVyZ2VMaXN0cyhtZW1vcnlfcG9vbDogJm11dCBbaTMyOyAyMDAwXSwgbXV0IGxpc3QxOiBpMzIsIG11dCBsaXN0MjogaTMyKSAtPiBpMzIgewogICAgaWYgKGxpc3QxID09IDApIHsKICAgICAgICByZXR1cm4gbGlzdDI7CiAgICB9CiAgICBpZiAobGlzdDIgPT0gMCkgewogICAgICAgIHJldHVybiBsaXN0MTsKICAgIH0KICAgIAogICAgbGV0IG11dCByZXN1bHRfaGVhZDogaTMyID0gLTE7CiAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9IC0xOwogICAgCiAgICAvLyBDaG9vc2UgdGhlIHNtYWxsZXIgaGVhZCBhcyB0aGUgcmVzdWx0IGhlYWQKICAgIGlmIChtZW1vcnlfcG9vbFtsaXN0MSBhcyB1c2l6ZV0gPD0gbWVtb3J5X3Bvb2xbbGlzdDIgYXMgdXNpemVdKSB7CiAgICAgICAgcmVzdWx0X2hlYWQgPSBsaXN0MTsKICAgICAgICBjdXJyZW50ID0gbGlzdDE7CiAgICAgICAgbGlzdDEgPSBtZW1vcnlfcG9vbFtsaXN0MSBhcyB1c2l6ZSArIDFdOwogICAgfSBlbHNlIHsKICAgICAgICByZXN1bHRfaGVhZCA9IGxpc3QyOwogICAgICAgIGN1cnJlbnQgPSBsaXN0MjsKICAgICAgICBsaXN0MiA9IG1lbW9yeV9wb29sW2xpc3QyIGFzIHVzaXplICsgMV07CiAgICB9CiAgICAKICAgIC8vIE1lcmdlIHJlbWFpbmluZyBub2RlcwogICAgbGV0IG11dCBtZXJnZV9jb3VudDogaTMyID0gMDsKICAgIHdoaWxlIChsaXN0MSAhPSAwICYmIGxpc3QyICE9IDAgJiYgbWVyZ2VfY291bnQgPCA1MDApIHsKICAgICAgICBpZiAobWVtb3J5X3Bvb2xbbGlzdDEgYXMgdXNpemVdIDw9IG1lbW9yeV9wb29sW2xpc3QyIGFzIHVzaXplXSkgewogICAgICAgICAgICBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplICsgMV0gPSBsaXN0MTsKICAgICAgICAgICAgY3VycmVudCA9IGxpc3QxOwogICAgICAgICAgICBsaXN0MSA9IG1lbW9yeV9wb29sW2xpc3QxIGFzIHVzaXplICsgMV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdID0gbGlzdDI7CiAgICAgICAgICAgIGN1cnJlbnQgPSBsaXN0MjsKICAgICAgICAgICAgbGlzdDIgPSBtZW1vcnlfcG9vbFtsaXN0MiBhcyB1c2l6ZSArIDFdOwogICAgICAgIH0KICAgICAgICBtZXJnZV9jb3VudCA9IG1lcmdlX2NvdW50ICsgMTsKICAgIH0KICAgIAogICAgLy8gQXR0YWNoIHJlbWFpbmluZyBub2RlcwogICAgaWYgKGxpc3QxICE9IDApIHsKICAgICAgICBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplICsgMV0gPSBsaXN0MTsKICAgIH0gZWxzZSB7CiAgICAgICAgbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdID0gbGlzdDI7CiAgICB9CiAgICAKICAgIHJldHVybiByZXN1bHRfaGVhZDsKfQoKLy8gVmVyaWZ5IGlmIGxpc3QgaXMgc29ydGVkCmZuIHZlcmlmeVNvcnRlZChtZW1vcnlfcG9vbDogJm11dCBbaTMyOyAyMDAwXSwgaGVhZDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBjdXJyZW50OiBpMzIgPSBoZWFkOwogICAgbGV0IG11dCBpc19zb3J0ZWQ6IGkzMiA9IDE7IC8vIHRydWUKICAgIGxldCBtdXQgY2hlY2tfY291bnQ6IGkzMiA9IDA7CiAgICAKICAgIHdoaWxlIChjdXJyZW50ICE9IDAgJiYgbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdICE9IDAgJiYgY2hlY2tfY291bnQgPCA5OTkpIHsKICAgICAgICBpZiAobWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZV0gPiBtZW1vcnlfcG9vbFsobWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdKSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgaXNfc29ydGVkID0gMDsgLy8gZmFsc2UKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGN1cnJlbnQgPSBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplICsgMV07CiAgICAgICAgY2hlY2tfY291bnQgPSBjaGVja19jb3VudCArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBpc19zb3J0ZWQ7Cn0KCi8vIEFkdmFuY2VkIGxpc3Qgb3BlcmF0aW9ucyB0ZXN0aW5nCmZuIHRlc3RBZHZhbmNlZExpc3RPcGVyYXRpb25zKCkgewogICAgcHJpbnRsbkludCgxNjEwKTsgLy8gQWR2YW5jZWQgb3BlcmF0aW9ucyBtYXJrZXIKICAgIAogICAgbGV0IG11dCBtZW1vcnlfcG9vbDogW2kzMjsgMTAwMF0gPSBbMDsgMTAwMF07CiAgICBsZXQgbXV0IGxpc3RfaGVhZHM6IFtpMzI7IDEwXSA9IFswOyAxMF07IC8vIE11bHRpcGxlIGxpc3RzCiAgICBsZXQgbXV0IGZyZWVfaGVhZDogaTMyID0gMTsKICAgIAogICAgLy8gSW5pdGlhbGl6ZSBtZW1vcnkKICAgIGluaXRpYWxpemVBZHZhbmNlZE1lbW9yeSgmbXV0IG1lbW9yeV9wb29sKTsKICAgIAogICAgLy8gQ3JlYXRlIG11bHRpcGxlIGludGVyY29ubmVjdGVkIGxpc3RzCiAgICBjcmVhdGVNdWx0aXBsZUxpc3RzKCZtdXQgbWVtb3J5X3Bvb2wsIGxpc3RfaGVhZHMsIGZyZWVfaGVhZCk7CiAgICAKICAgIC8vIFBlcmZvcm0gbGlzdCBpbnRlcnNlY3Rpb24gb3BlcmF0aW9ucwogICAgbGV0IGludGVyc2VjdGlvbl9yZXN1bHQ6IGkzMiA9IGZpbmRMaXN0SW50ZXJzZWN0aW9ucygmbXV0IG1lbW9yeV9wb29sLCBsaXN0X2hlYWRzKTsKICAgIHByaW50bG5JbnQoaW50ZXJzZWN0aW9uX3Jlc3VsdCk7CiAgICAKICAgIC8vIFBlcmZvcm0gbGlzdCB1bmlvbiBvcGVyYXRpb25zCiAgICBsZXQgdW5pb25fcmVzdWx0OiBpMzIgPSBwZXJmb3JtTGlzdFVuaW9ucygmbXV0IG1lbW9yeV9wb29sLCBsaXN0X2hlYWRzKTsKICAgIHByaW50bG5JbnQodW5pb25fcmVzdWx0KTsKICAgIAogICAgLy8gQ29tcGxleCBsaXN0IG1hbmlwdWxhdGlvbnMKICAgIGxldCBtYW5pcHVsYXRpb25fcmVzdWx0OiBpMzIgPSBjb21wbGV4TGlzdE1hbmlwdWxhdGlvbnMoJm11dCBtZW1vcnlfcG9vbCwgbGlzdF9oZWFkcyk7CiAgICBwcmludGxuSW50KG1hbmlwdWxhdGlvbl9yZXN1bHQpOwp9CgovLyBJbml0aWFsaXplIG1lbW9yeSBmb3IgYWR2YW5jZWQgb3BlcmF0aW9ucwpmbiBpbml0aWFsaXplQWR2YW5jZWRNZW1vcnkobWVtb3J5X3Bvb2w6ICZtdXQgW2kzMjsgMTAwMF0pIHsKICAgIGxldCBtdXQgaTogaTMyID0gMTsKICAgIHdoaWxlIChpIDwgOTk4KSB7CiAgICAgICAgbWVtb3J5X3Bvb2xbaSBhcyB1c2l6ZV0gPSAwOwogICAgICAgIG1lbW9yeV9wb29sW2kgYXMgdXNpemUgKyAxXSA9IGkgKyAyOwogICAgICAgIGkgPSBpICsgMjsKICAgIH0KICAgIG1lbW9yeV9wb29sWzk5OF0gPSAwOwogICAgbWVtb3J5X3Bvb2xbOTk5XSA9IDA7Cn0KCi8vIENyZWF0ZSBtdWx0aXBsZSBsaXN0cyB3aXRoIGRpZmZlcmVudCBwYXR0ZXJucwpmbiBjcmVhdGVNdWx0aXBsZUxpc3RzKG1lbW9yeV9wb29sOiAmbXV0IFtpMzI7IDEwMDBdLCBtdXQgbGlzdF9oZWFkczogW2kzMjsgMTBdLCBtdXQgZnJlZV9oZWFkOiBpMzIpIHsKICAgIGxldCBtdXQgbGlzdF9pbmRleDogaTMyID0gMDsKICAgIAogICAgd2hpbGUgKGxpc3RfaW5kZXggPCAxMCkgewogICAgICAgIGxldCBtdXQgbm9kZV9jb3VudDogaTMyID0gMDsKICAgICAgICBsZXQgbGlzdF9zaXplOiBpMzIgPSAobGlzdF9pbmRleCArIDEpICogNTsgLy8gVmFyeWluZyBsaXN0IHNpemVzCiAgICAgICAgCiAgICAgICAgd2hpbGUgKG5vZGVfY291bnQgPCBsaXN0X3NpemUgJiYgZnJlZV9oZWFkICE9IDAgJiYgZnJlZV9oZWFkIDwgOTk4KSB7CiAgICAgICAgICAgIGxldCBuZXdfbm9kZTogaTMyID0gZnJlZV9oZWFkOwogICAgICAgICAgICBmcmVlX2hlYWQgPSBtZW1vcnlfcG9vbFtmcmVlX2hlYWQgYXMgdXNpemUgKyAxXTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIENyZWF0ZSBwYXR0ZXJuLWJhc2VkIGRhdGEKICAgICAgICAgICAgbGV0IGRhdGFfdmFsdWU6IGkzMiA9IGxpc3RfaW5kZXggKiAxMDAgKyBub2RlX2NvdW50ICogKGxpc3RfaW5kZXggKyAxKTsKICAgICAgICAgICAgbWVtb3J5X3Bvb2xbbmV3X25vZGUgYXMgdXNpemVdID0gZGF0YV92YWx1ZTsKICAgICAgICAgICAgbWVtb3J5X3Bvb2xbbmV3X25vZGUgYXMgdXNpemUgKyAxXSA9IGxpc3RfaGVhZHNbbGlzdF9pbmRleCBhcyB1c2l6ZV07CiAgICAgICAgICAgIGxpc3RfaGVhZHNbbGlzdF9pbmRleCBhcyB1c2l6ZV0gPSBuZXdfbm9kZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIG5vZGVfY291bnQgPSBub2RlX2NvdW50ICsgMTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgbGlzdF9pbmRleCA9IGxpc3RfaW5kZXggKyAxOwogICAgfQp9CgovLyBGaW5kIGludGVyc2VjdGlvbnMgYmV0d2VlbiBtdWx0aXBsZSBsaXN0cwpmbiBmaW5kTGlzdEludGVyc2VjdGlvbnMobWVtb3J5X3Bvb2w6ICZtdXQgW2kzMjsgMTAwMF0sIGxpc3RfaGVhZHM6IFtpMzI7IDEwXSkgLT4gaTMyIHsKICAgIGxldCBtdXQgaW50ZXJzZWN0aW9uX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBsaXN0X2k6IGkzMiA9IDA7CiAgICAKICAgIHdoaWxlIChsaXN0X2kgPCA5KSB7CiAgICAgICAgbGV0IG11dCBsaXN0X2o6IGkzMiA9IGxpc3RfaSArIDE7CiAgICAgICAgd2hpbGUgKGxpc3RfaiA8IDEwKSB7CiAgICAgICAgICAgIC8vIENoZWNrIGZvciBjb21tb24gdmFsdWVzIGJldHdlZW4gbGlzdF9pIGFuZCBsaXN0X2oKICAgICAgICAgICAgbGV0IGNvbW1vbl92YWx1ZXM6IGkzMiA9IGNvdW50Q29tbW9uVmFsdWVzKG1lbW9yeV9wb29sLCBsaXN0X2hlYWRzW2xpc3RfaSBhcyB1c2l6ZV0sIGxpc3RfaGVhZHNbbGlzdF9qIGFzIHVzaXplXSk7CiAgICAgICAgICAgIGludGVyc2VjdGlvbl9jb3VudCA9IGludGVyc2VjdGlvbl9jb3VudCArIGNvbW1vbl92YWx1ZXM7CiAgICAgICAgICAgIGxpc3RfaiA9IGxpc3RfaiArIDE7CiAgICAgICAgfQogICAgICAgIGxpc3RfaSA9IGxpc3RfaSArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBpbnRlcnNlY3Rpb25fY291bnQ7Cn0KCi8vIENvdW50IGNvbW1vbiB2YWx1ZXMgYmV0d2VlbiB0d28gbGlzdHMKZm4gY291bnRDb21tb25WYWx1ZXMobWVtb3J5X3Bvb2w6ICZtdXQgW2kzMjsgMTAwMF0sIGhlYWQxOiBpMzIsIGhlYWQyOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGNvbW1vbl9jb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgY3VycmVudDE6IGkzMiA9IGhlYWQxOwogICAgbGV0IG11dCBpdGVyX2NvdW50OiBpMzIgPSAwOwogICAgCiAgICB3aGlsZSAoY3VycmVudDEgIT0gMCAmJiBpdGVyX2NvdW50IDwgMTAwKSB7CiAgICAgICAgbGV0IHZhbHVlMTogaTMyID0gbWVtb3J5X3Bvb2xbY3VycmVudDEgYXMgdXNpemVdOwogICAgICAgIGxldCBtdXQgY3VycmVudDI6IGkzMiA9IGhlYWQyOwogICAgICAgIGxldCBtdXQgaW5uZXJfaXRlcjogaTMyID0gMDsKICAgICAgICAKICAgICAgICB3aGlsZSAoY3VycmVudDIgIT0gMCAmJiBpbm5lcl9pdGVyIDwgMTAwKSB7CiAgICAgICAgICAgIGlmIChtZW1vcnlfcG9vbFtjdXJyZW50MiBhcyB1c2l6ZV0gPT0gdmFsdWUxKSB7CiAgICAgICAgICAgICAgICBjb21tb25fY291bnQgPSBjb21tb25fY291bnQgKyAxOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY3VycmVudDIgPSBtZW1vcnlfcG9vbFtjdXJyZW50MiBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICBpbm5lcl9pdGVyID0gaW5uZXJfaXRlciArIDE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGN1cnJlbnQxID0gbWVtb3J5X3Bvb2xbY3VycmVudDEgYXMgdXNpemUgKyAxXTsKICAgICAgICBpdGVyX2NvdW50ID0gaXRlcl9jb3VudCArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBjb21tb25fY291bnQ7Cn0KCi8vIFBlcmZvcm0gdW5pb24gb3BlcmF0aW9ucyBvbiBsaXN0cwpmbiBwZXJmb3JtTGlzdFVuaW9ucyhtZW1vcnlfcG9vbDogJm11dCBbaTMyOyAxMDAwXSwgbGlzdF9oZWFkczogW2kzMjsgMTBdKSAtPiBpMzIgewogICAgbGV0IG11dCB1bmlvbl9zaXplOiBpMzIgPSAwOwogICAgbGV0IG11dCB1bmlxdWVfdmFsdWVzOiBbaTMyOyA1MDBdID0gWzA7IDUwMF07IC8vIFRyYWNrIHVuaXF1ZSB2YWx1ZXMKICAgIGxldCBtdXQgdW5pcXVlX2NvdW50OiBpMzIgPSAwOwogICAgCiAgICBsZXQgbXV0IGxpc3RfaW5kZXg6IGkzMiA9IDA7CiAgICB3aGlsZSAobGlzdF9pbmRleCA8IDEwKSB7CiAgICAgICAgbGV0IG11dCBjdXJyZW50OiBpMzIgPSBsaXN0X2hlYWRzW2xpc3RfaW5kZXggYXMgdXNpemVdOwogICAgICAgIGxldCBtdXQgbm9kZV9jb3VudDogaTMyID0gMDsKICAgICAgICAKICAgICAgICB3aGlsZSAoY3VycmVudCAhPSAwICYmIG5vZGVfY291bnQgPCA1MCkgewogICAgICAgICAgICBsZXQgdmFsdWU6IGkzMiA9IG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemVdOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdmFsdWUgaXMgYWxyZWFkeSBpbiB1bmlxdWVfdmFsdWVzCiAgICAgICAgICAgIGxldCBtdXQgZm91bmQ6IGkzMiA9IDA7CiAgICAgICAgICAgIGxldCBtdXQgY2hlY2tfaW5kZXg6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChjaGVja19pbmRleCA8IHVuaXF1ZV9jb3VudCkgewogICAgICAgICAgICAgICAgaWYgKHVuaXF1ZV92YWx1ZXNbY2hlY2tfaW5kZXggYXMgdXNpemVdID09IHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgZm91bmQgPSAxOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2hlY2tfaW5kZXggPSBjaGVja19pbmRleCArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChmb3VuZCA9PSAwICYmIHVuaXF1ZV9jb3VudCA8IDUwMCkgewogICAgICAgICAgICAgICAgdW5pcXVlX3ZhbHVlc1t1bmlxdWVfY291bnQgYXMgdXNpemVdID0gdmFsdWU7CiAgICAgICAgICAgICAgICB1bmlxdWVfY291bnQgPSB1bmlxdWVfY291bnQgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBjdXJyZW50ID0gbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICBub2RlX2NvdW50ID0gbm9kZV9jb3VudCArIDE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGxpc3RfaW5kZXggPSBsaXN0X2luZGV4ICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIHVuaXF1ZV9jb3VudDsKfQoKLy8gQ29tcGxleCBsaXN0IG1hbmlwdWxhdGlvbnMKZm4gY29tcGxleExpc3RNYW5pcHVsYXRpb25zKG1lbW9yeV9wb29sOiAmbXV0IFtpMzI7IDEwMDBdLCBtdXQgbGlzdF9oZWFkczogW2kzMjsgMTBdKSAtPiBpMzIgewogICAgbGV0IG11dCBtYW5pcHVsYXRpb25fc2NvcmU6IGkzMiA9IDA7CiAgICAKICAgIC8vIE9wZXJhdGlvbiAxOiBSb3RhdGUgZWFjaCBsaXN0IGJ5IGRpZmZlcmVudCBhbW91bnRzCiAgICBsZXQgbXV0IGxpc3RfaW5kZXg6IGkzMiA9IDA7CiAgICB3aGlsZSAobGlzdF9pbmRleCA8IDEwKSB7CiAgICAgICAgbGV0IHJvdGF0ZV9hbW91bnQ6IGkzMiA9IGxpc3RfaW5kZXggKyAxOwogICAgICAgIGxpc3RfaGVhZHNbbGlzdF9pbmRleCBhcyB1c2l6ZV0gPSByb3RhdGVMaXN0KG1lbW9yeV9wb29sLCBsaXN0X2hlYWRzW2xpc3RfaW5kZXggYXMgdXNpemVdLCByb3RhdGVfYW1vdW50KTsKICAgICAgICBsaXN0X2luZGV4ID0gbGlzdF9pbmRleCArIDE7CiAgICB9CiAgICBtYW5pcHVsYXRpb25fc2NvcmUgPSBtYW5pcHVsYXRpb25fc2NvcmUgKyAxMDsKICAgIAogICAgLy8gT3BlcmF0aW9uIDI6IFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gZWFjaCBsaXN0CiAgICBsaXN0X2luZGV4ID0gMDsKICAgIHdoaWxlIChsaXN0X2luZGV4IDwgMTApIHsKICAgICAgICBsZXQgcmVtb3ZlZF9jb3VudDogaTMyID0gcmVtb3ZlRHVwbGljYXRlcyhtZW1vcnlfcG9vbCwgbGlzdF9oZWFkc1tsaXN0X2luZGV4IGFzIHVzaXplXSk7CiAgICAgICAgbWFuaXB1bGF0aW9uX3Njb3JlID0gbWFuaXB1bGF0aW9uX3Njb3JlICsgcmVtb3ZlZF9jb3VudDsKICAgICAgICBsaXN0X2luZGV4ID0gbGlzdF9pbmRleCArIDE7CiAgICB9CiAgICAKICAgIC8vIE9wZXJhdGlvbiAzOiBJbnRlcmxlYXZlIG9kZCBhbmQgZXZlbiBpbmRleGVkIGxpc3RzCiAgICBsZXQgaW50ZXJsZWF2ZV9yZXN1bHQ6IGkzMiA9IGludGVybGVhdmVMaXN0cyhtZW1vcnlfcG9vbCwgbGlzdF9oZWFkcyk7CiAgICBtYW5pcHVsYXRpb25fc2NvcmUgPSBtYW5pcHVsYXRpb25fc2NvcmUgKyBpbnRlcmxlYXZlX3Jlc3VsdDsKICAgIAogICAgcmV0dXJuIG1hbmlwdWxhdGlvbl9zY29yZTsKfQoKLy8gUm90YXRlIGxpc3QgYnkgayBwb3NpdGlvbnMKZm4gcm90YXRlTGlzdChtZW1vcnlfcG9vbDogJm11dCBbaTMyOyAxMDAwXSwgaGVhZDogaTMyLCBrOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoaGVhZCA9PSAwIHx8IGsgPD0gMCkgewogICAgICAgIHJldHVybiBoZWFkOwogICAgfQogICAgCiAgICAvLyBGaW5kIGxlbmd0aCBhbmQgbGFzdCBub2RlCiAgICBsZXQgbXV0IGxlbmd0aDogaTMyID0gMTsKICAgIGxldCBtdXQgbGFzdDogaTMyID0gaGVhZDsKICAgIHdoaWxlIChtZW1vcnlfcG9vbFtsYXN0IGFzIHVzaXplICsgMV0gIT0gMCAmJiBsZW5ndGggPCAxMDApIHsKICAgICAgICBsYXN0ID0gbWVtb3J5X3Bvb2xbbGFzdCBhcyB1c2l6ZSArIDFdOwogICAgICAgIGxlbmd0aCA9IGxlbmd0aCArIDE7CiAgICB9CiAgICAKICAgIGxldCBlZmZlY3RpdmVfazogaTMyID0gayAlIGxlbmd0aDsKICAgIGlmIChlZmZlY3RpdmVfayA9PSAwKSB7CiAgICAgICAgcmV0dXJuIGhlYWQ7CiAgICB9CiAgICAKICAgIC8vIEZpbmQgdGhlIG5ldyB0YWlsIChsZW5ndGggLSBrIC0gMSBzdGVwcyBmcm9tIGhlYWQpCiAgICBsZXQgbXV0IG5ld190YWlsOiBpMzIgPSBoZWFkOwogICAgbGV0IG11dCBzdGVwczogaTMyID0gMDsKICAgIHdoaWxlIChzdGVwcyA8IGxlbmd0aCAtIGVmZmVjdGl2ZV9rIC0gMSAmJiBtZW1vcnlfcG9vbFtuZXdfdGFpbCBhcyB1c2l6ZSArIDFdICE9IDApIHsKICAgICAgICBuZXdfdGFpbCA9IG1lbW9yeV9wb29sW25ld190YWlsIGFzIHVzaXplICsgMV07CiAgICAgICAgc3RlcHMgPSBzdGVwcyArIDE7CiAgICB9CiAgICAKICAgIGxldCBuZXdfaGVhZDogaTMyID0gbWVtb3J5X3Bvb2xbbmV3X3RhaWwgYXMgdXNpemUgKyAxXTsKICAgIG1lbW9yeV9wb29sW25ld190YWlsIGFzIHVzaXplICsgMV0gPSAwOyAgLy8gQnJlYWsgdGhlIGxpc3QKICAgIG1lbW9yeV9wb29sW2xhc3QgYXMgdXNpemUgKyAxXSA9IGhlYWQ7ICAgLy8gQ29ubmVjdCBlbmQgdG8gb2xkIGhlYWQKICAgIAogICAgcmV0dXJuIG5ld19oZWFkOwp9CgovLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGEgbGlzdApmbiByZW1vdmVEdXBsaWNhdGVzKG1lbW9yeV9wb29sOiAmbXV0IFtpMzI7IDEwMDBdLCBoZWFkOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHJlbW92ZWRfY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9IGhlYWQ7CiAgICBsZXQgbXV0IGl0ZXJfY291bnQ6IGkzMiA9IDA7CiAgICAKICAgIHdoaWxlIChjdXJyZW50ICE9IDAgJiYgbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdICE9IDAgJiYgaXRlcl9jb3VudCA8IDEwMCkgewogICAgICAgIGxldCBtdXQgbmV4dF9ub2RlOiBpMzIgPSBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplICsgMV07CiAgICAgICAgCiAgICAgICAgaWYgKG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemVdID09IG1lbW9yeV9wb29sW25leHRfbm9kZSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBkdXBsaWNhdGUKICAgICAgICAgICAgbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdID0gbWVtb3J5X3Bvb2xbbmV4dF9ub2RlIGFzIHVzaXplICsgMV07CiAgICAgICAgICAgIHJlbW92ZWRfY291bnQgPSByZW1vdmVkX2NvdW50ICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjdXJyZW50ID0gbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpdGVyX2NvdW50ID0gaXRlcl9jb3VudCArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiByZW1vdmVkX2NvdW50Owp9CgovLyBJbnRlcmxlYXZlIG11bHRpcGxlIGxpc3RzCmZuIGludGVybGVhdmVMaXN0cyhtZW1vcnlfcG9vbDogJm11dCBbaTMyOyAxMDAwXSwgbGlzdF9oZWFkczogW2kzMjsgMTBdKSAtPiBpMzIgewogICAgbGV0IG11dCBpbnRlcmxlYXZlX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBhY3RpdmVfbGlzdHM6IFtpMzI7IDEwXSA9IFswOyAxMF07CiAgICBsZXQgbXV0IGFjdGl2ZV9jb3VudDogaTMyID0gMDsKICAgIAogICAgLy8gSW5pdGlhbGl6ZSBhY3RpdmUgbGlzdHMKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgMTApIHsKICAgICAgICBpZiAobGlzdF9oZWFkc1tpIGFzIHVzaXplXSAhPSAwKSB7CiAgICAgICAgICAgIGFjdGl2ZV9saXN0c1thY3RpdmVfY291bnQgYXMgdXNpemVdID0gbGlzdF9oZWFkc1tpIGFzIHVzaXplXTsKICAgICAgICAgICAgYWN0aXZlX2NvdW50ID0gYWN0aXZlX2NvdW50ICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICAvLyBJbnRlcmxlYXZlIHByb2Nlc3MKICAgIHdoaWxlIChhY3RpdmVfY291bnQgPiAwICYmIGludGVybGVhdmVfY291bnQgPCAyMDApIHsKICAgICAgICBsZXQgbXV0IG5ld19hY3RpdmVfY291bnQ6IGkzMiA9IDA7CiAgICAgICAgaSA9IDA7CiAgICAgICAgCiAgICAgICAgd2hpbGUgKGkgPCBhY3RpdmVfY291bnQpIHsKICAgICAgICAgICAgaWYgKGFjdGl2ZV9saXN0c1tpIGFzIHVzaXplXSAhPSAwKSB7CiAgICAgICAgICAgICAgICBpbnRlcmxlYXZlX2NvdW50ID0gaW50ZXJsZWF2ZV9jb3VudCArIDE7CiAgICAgICAgICAgICAgICBhY3RpdmVfbGlzdHNbaSBhcyB1c2l6ZV0gPSBtZW1vcnlfcG9vbFsoYWN0aXZlX2xpc3RzW2kgYXMgdXNpemVdICsgMSkgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlX2xpc3RzW2kgYXMgdXNpemVdICE9IDApIHsKICAgICAgICAgICAgICAgICAgICBhY3RpdmVfbGlzdHNbbmV3X2FjdGl2ZV9jb3VudCBhcyB1c2l6ZV0gPSBhY3RpdmVfbGlzdHNbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAgICAgbmV3X2FjdGl2ZV9jb3VudCA9IG5ld19hY3RpdmVfY291bnQgKyAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgYWN0aXZlX2NvdW50ID0gbmV3X2FjdGl2ZV9jb3VudDsKICAgIH0KICAgIAogICAgcmV0dXJuIGludGVybGVhdmVfY291bnQ7Cn0KCi8vIFBlcmZvcm1hbmNlIHN0cmVzcyB0ZXN0IHdpdGggbGFyZ2UgbGlzdHMKZm4gcGVyZm9ybUxpc3RQZXJmb3JtYW5jZVRlc3QoKSB7CiAgICBwcmludGxuSW50KDE2MjApOyAvLyBQZXJmb3JtYW5jZSB0ZXN0IG1hcmtlcgogICAgCiAgICBsZXQgbXV0IGxhcmdlX21lbW9yeTogW2kzMjsgMTgwMF0gPSBbMDsgMTgwMF07IC8vIExhcmdlciBtZW1vcnkgcG9vbAogICAgbGV0IG11dCBzdHJlc3NfaGVhZDogaTMyID0gMDsKICAgIGxldCBtdXQgYWxsb2NhdGVkX25vZGVzOiBpMzIgPSAwOwogICAgCiAgICAvLyBCdWlsZCB2ZXJ5IGxhcmdlIGxpc3QKICAgIGxldCBtdXQgdmFsdWU6IGkzMiA9IDE7CiAgICB3aGlsZSAodmFsdWUgPD0gODAwICYmICh2YWx1ZSAqIDIpIDwgMTgwMCkgewogICAgICAgIGxldCBub2RlX2luZGV4OiBpMzIgPSB2YWx1ZSAqIDI7CiAgICAgICAgbGFyZ2VfbWVtb3J5W25vZGVfaW5kZXggYXMgdXNpemVdID0gdmFsdWUgKiB2YWx1ZSAlIDEwMDAwOyAvLyBDb21wdXRlZCB2YWx1ZXMKICAgICAgICBsYXJnZV9tZW1vcnlbbm9kZV9pbmRleCBhcyB1c2l6ZSArIDFdID0gc3RyZXNzX2hlYWQ7CiAgICAgICAgc3RyZXNzX2hlYWQgPSBub2RlX2luZGV4OwogICAgICAgIGFsbG9jYXRlZF9ub2RlcyA9IGFsbG9jYXRlZF9ub2RlcyArIDE7CiAgICAgICAgdmFsdWUgPSB2YWx1ZSArIDE7CiAgICB9CiAgICAKICAgIC8vIFN0cmVzcyB0ZXN0IDE6IE11bHRpcGxlIHRyYXZlcnNhbHMgd2l0aCBkaWZmZXJlbnQgcGF0dGVybnMKICAgIGxldCBtdXQgdHJhdmVyc2FsX3N1bTogaTMyID0gMDsKICAgIGxldCBtdXQgcm91bmQ6IGkzMiA9IDA7CiAgICB3aGlsZSAocm91bmQgPCA1KSB7CiAgICAgICAgdHJhdmVyc2FsX3N1bSA9IHRyYXZlcnNhbF9zdW0gKyBzdHJlc3NUcmF2ZXJzYWwoJm11dCBsYXJnZV9tZW1vcnksIHN0cmVzc19oZWFkLCByb3VuZCk7CiAgICAgICAgcm91bmQgPSByb3VuZCArIDE7CiAgICB9CiAgICBwcmludGxuSW50KHRyYXZlcnNhbF9zdW0pOwogICAgCiAgICAvLyBTdHJlc3MgdGVzdCAyOiBDb21wbGV4IG1vZGlmaWNhdGlvbnMKICAgIGxldCBtb2RpZmljYXRpb25fcmVzdWx0OiBpMzIgPSBzdHJlc3NNb2RpZmljYXRpb25zKCZtdXQgbGFyZ2VfbWVtb3J5LCBzdHJlc3NfaGVhZCk7CiAgICBwcmludGxuSW50KG1vZGlmaWNhdGlvbl9yZXN1bHQpOwogICAgCiAgICAvLyBTdHJlc3MgdGVzdCAzOiBQYXR0ZXJuIHNlYXJjaGVzCiAgICBsZXQgc2VhcmNoX3Jlc3VsdDogaTMyID0gc3RyZXNzUGF0dGVyblNlYXJjaCgmbXV0IGxhcmdlX21lbW9yeSwgc3RyZXNzX2hlYWQpOwogICAgcHJpbnRsbkludChzZWFyY2hfcmVzdWx0KTsKfQoKLy8gU3RyZXNzIHRyYXZlcnNhbCB3aXRoIGRpZmZlcmVudCBwYXR0ZXJucwpmbiBzdHJlc3NUcmF2ZXJzYWwobWVtb3J5X3Bvb2w6ICZtdXQgW2kzMjsgMTgwMF0sIGhlYWQ6IGkzMiwgcGF0dGVybjogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9IGhlYWQ7CiAgICBsZXQgbXV0IHN0ZXBfY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHNraXBfY291bnQ6IGkzMiA9IHBhdHRlcm4gKyAxOwogICAgCiAgICB3aGlsZSAoY3VycmVudCAhPSAwICYmIHN0ZXBfY291bnQgPCA4MDApIHsKICAgICAgICBpZiAoc3RlcF9jb3VudCAlIHNraXBfY291bnQgPT0gMCkgewogICAgICAgICAgICBzdW0gPSBzdW0gKyBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplXTsKICAgICAgICB9CiAgICAgICAgY3VycmVudCA9IG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemUgKyAxXTsKICAgICAgICBzdGVwX2NvdW50ID0gc3RlcF9jb3VudCArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBzdW0gJSAxMDAwMDA7Cn0KCi8vIFN0cmVzcyBtb2RpZmljYXRpb25zCmZuIHN0cmVzc01vZGlmaWNhdGlvbnMobWVtb3J5X3Bvb2w6ICZtdXQgW2kzMjsgMTgwMF0sIGhlYWQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgbW9kaWZpY2F0aW9uX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBjdXJyZW50OiBpMzIgPSBoZWFkOwogICAgbGV0IG11dCBwb3NpdGlvbjogaTMyID0gMDsKICAgIAogICAgd2hpbGUgKGN1cnJlbnQgIT0gMCAmJiBwb3NpdGlvbiA8IDQwMCkgewogICAgICAgIC8vIENvbXBsZXggbW9kaWZpY2F0aW9uIGJhc2VkIG9uIHBvc2l0aW9uIGFuZCB2YWx1ZQogICAgICAgIGxldCBvbGRfdmFsdWU6IGkzMiA9IG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemVdOwogICAgICAgIGxldCBuZXdfdmFsdWU6IGkzMiA9IChvbGRfdmFsdWUgKiAzICsgcG9zaXRpb24gKiA3KSAlIDEwMDA7CiAgICAgICAgbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZV0gPSBuZXdfdmFsdWU7CiAgICAgICAgCiAgICAgICAgaWYgKG5ld192YWx1ZSA+IG9sZF92YWx1ZSkgewogICAgICAgICAgICBtb2RpZmljYXRpb25fY291bnQgPSBtb2RpZmljYXRpb25fY291bnQgKyAxOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBjdXJyZW50ID0gbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdOwogICAgICAgIHBvc2l0aW9uID0gcG9zaXRpb24gKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gbW9kaWZpY2F0aW9uX2NvdW50Owp9CgovLyBTdHJlc3MgcGF0dGVybiBzZWFyY2gKZm4gc3RyZXNzUGF0dGVyblNlYXJjaChtZW1vcnlfcG9vbDogJm11dCBbaTMyOyAxODAwXSwgaGVhZDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBwYXR0ZXJuX21hdGNoZXM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9IGhlYWQ7CiAgICBsZXQgbXV0IHBvc2l0aW9uOiBpMzIgPSAwOwogICAgCiAgICB3aGlsZSAoY3VycmVudCAhPSAwICYmIHBvc2l0aW9uIDwgNjAwKSB7CiAgICAgICAgbGV0IHZhbHVlOiBpMzIgPSBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplXTsKICAgICAgICAKICAgICAgICAvLyBNdWx0aXBsZSBwYXR0ZXJuIGNoZWNrcwogICAgICAgIGlmICh2YWx1ZSAlIDcgPT0gMykgewogICAgICAgICAgICBwYXR0ZXJuX21hdGNoZXMgPSBwYXR0ZXJuX21hdGNoZXMgKyAxOwogICAgICAgIH0KICAgICAgICBpZiAodmFsdWUgPiAxMDAgJiYgdmFsdWUgPCA1MDApIHsKICAgICAgICAgICAgcGF0dGVybl9tYXRjaGVzID0gcGF0dGVybl9tYXRjaGVzICsgMjsKICAgICAgICB9CiAgICAgICAgaWYgKHBvc2l0aW9uICUgMTAgPT0gdmFsdWUgJSAxMCkgewogICAgICAgICAgICBwYXR0ZXJuX21hdGNoZXMgPSBwYXR0ZXJuX21hdGNoZXMgKyAzOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBjdXJyZW50ID0gbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdOwogICAgICAgIHBvc2l0aW9uID0gcG9zaXRpb24gKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gcGF0dGVybl9tYXRjaGVzOwp9CgovLyBUZXN0IGVkZ2UgY2FzZXMgYW5kIGJvdW5kYXJ5IGNvbmRpdGlvbnMKZm4gdGVzdEVkZ2VDYXNlcygpIHsKICAgIHByaW50bG5JbnQoMTYzMCk7IC8vIEVkZ2UgY2FzZXMgbWFya2VyCiAgICAKICAgIC8vIEVkZ2UgY2FzZSAxOiBFbXB0eSBsaXN0IG9wZXJhdGlvbnMKICAgIHRlc3RFbXB0eUxpc3RPcGVyYXRpb25zKCk7CiAgICAKICAgIC8vIEVkZ2UgY2FzZSAyOiBTaW5nbGUgbm9kZSBvcGVyYXRpb25zCiAgICB0ZXN0U2luZ2xlTm9kZU9wZXJhdGlvbnMoKTsKICAgIAogICAgLy8gRWRnZSBjYXNlIDM6IE1lbW9yeSBib3VuZGFyeSB0ZXN0cwogICAgdGVzdE1lbW9yeUJvdW5kYXJpZXMoKTsKICAgIAogICAgLy8gRWRnZSBjYXNlIDQ6IENpcmN1bGFyIGxpc3QgZGV0ZWN0aW9uCiAgICB0ZXN0Q2lyY3VsYXJMaXN0RGV0ZWN0aW9uKCk7CiAgICAKICAgIHByaW50bG5JbnQoMTYzOSk7IC8vIEVkZ2UgY2FzZXMgZW5kCn0KCi8vIFRlc3Qgb3BlcmF0aW9ucyBvbiBlbXB0eSBsaXN0cwpmbiB0ZXN0RW1wdHlMaXN0T3BlcmF0aW9ucygpIHsKICAgIGxldCBtdXQgZW1wdHlfbWVtb3J5OiBbaTMyOyAyMDAwXSA9IFswOyAyMDAwXTsKICAgIGxldCBlbXB0eV9oZWFkOiBpMzIgPSAwOwogICAgCiAgICAvLyBBbGwgb3BlcmF0aW9ucyBzaG91bGQgaGFuZGxlIGVtcHR5IGxpc3QgZ3JhY2VmdWxseQogICAgbGV0IHN1bTogaTMyID0gY2FsY3VsYXRlTGlzdFN1bSgmbXV0IGVtcHR5X21lbW9yeSwgZW1wdHlfaGVhZCk7CiAgICBwcmludGxuSW50KHN1bSk7IC8vIFNob3VsZCBiZSAwCiAgICAKICAgIGxldCByZXZlcnNlZDogaTMyID0gcmV2ZXJzZUxpc3QoJm11dCBlbXB0eV9tZW1vcnksIGVtcHR5X2hlYWQpOwogICAgcHJpbnRsbkludChyZXZlcnNlZCk7IC8vIFNob3VsZCBiZSAwCiAgICAKICAgIGxldCBzZWFyY2hfcmVzdWx0OiBpMzIgPSBjb21wbGV4TGlzdFNlYXJjaCgmbXV0IGVtcHR5X21lbW9yeSwgZW1wdHlfaGVhZCk7CiAgICBwcmludGxuSW50KHNlYXJjaF9yZXN1bHQpOwp9CgovLyBUZXN0IG9wZXJhdGlvbnMgb24gc2luZ2xlIG5vZGUKZm4gdGVzdFNpbmdsZU5vZGVPcGVyYXRpb25zKCkgewogICAgbGV0IG11dCBzaW5nbGVfbWVtb3J5OiBbaTMyOyAyMDAwXSA9IFswOyAyMDAwXTsKICAgIHNpbmdsZV9tZW1vcnlbMV0gPSA0MjsgICAvLyBTaW5nbGUgbm9kZSB3aXRoIHZhbHVlIDQyCiAgICBzaW5nbGVfbWVtb3J5WzJdID0gMDsgICAgLy8gUG9pbnRzIHRvIG51bGwKICAgIGxldCBzaW5nbGVfaGVhZDogaTMyID0gMTsKICAgIAogICAgbGV0IHN1bTogaTMyID0gY2FsY3VsYXRlTGlzdFN1bSgmbXV0IHNpbmdsZV9tZW1vcnksIHNpbmdsZV9oZWFkKTsKICAgIHByaW50bG5JbnQoc3VtKTsgLy8gU2hvdWxkIGJlIDQyCiAgICAKICAgIGxldCByZXZlcnNlZDogaTMyID0gcmV2ZXJzZUxpc3QoJm11dCBzaW5nbGVfbWVtb3J5LCBzaW5nbGVfaGVhZCk7CiAgICBwcmludGxuSW50KHJldmVyc2VkKTsgLy8gU2hvdWxkIHN0aWxsIGJlIDEKICAgIAogICAgbGV0IHNvcnRlZF9jaGVjazogaTMyID0gdmVyaWZ5U29ydGVkKCZtdXQgc2luZ2xlX21lbW9yeSwgc2luZ2xlX2hlYWQpOwogICAgcHJpbnRsbkludChzb3J0ZWRfY2hlY2spOyAvLyBTaG91bGQgYmUgMSAodHJ1ZSkKfQoKLy8gVGVzdCBtZW1vcnkgYm91bmRhcnkgY29uZGl0aW9ucwpmbiB0ZXN0TWVtb3J5Qm91bmRhcmllcygpIHsKICAgIGxldCBtdXQgYm91bmRhcnlfbWVtb3J5OiBbaTMyOyAyMDAwXSA9IFswOyAyMDAwXTsKICAgIAogICAgLy8gVGVzdCB3aXRoIG1lbW9yeSBhdCBib3VuZGFyaWVzCiAgICBib3VuZGFyeV9tZW1vcnlbMV0gPSAxMDA7CiAgICBib3VuZGFyeV9tZW1vcnlbMl0gPSAzOwogICAgYm91bmRhcnlfbWVtb3J5WzNdID0gMjAwOwogICAgYm91bmRhcnlfbWVtb3J5WzRdID0gNTsKICAgIGJvdW5kYXJ5X21lbW9yeVs1XSA9IDMwMDsKICAgIGJvdW5kYXJ5X21lbW9yeVs2XSA9IDc7CiAgICBib3VuZGFyeV9tZW1vcnlbN10gPSA0MDA7CiAgICBib3VuZGFyeV9tZW1vcnlbOF0gPSAwOyAvLyBFbmQgb2YgbGlzdAogICAgCiAgICBsZXQgYm91bmRhcnlfaGVhZDogaTMyID0gMTsKICAgIGxldCBzdW06IGkzMiA9IGNhbGN1bGF0ZUxpc3RTdW0oJm11dCBib3VuZGFyeV9tZW1vcnksIGJvdW5kYXJ5X2hlYWQpOwogICAgcHJpbnRsbkludChzdW0pOwogICAgCiAgICAvLyBUZXN0IGJvdW5kYXJ5IGFsbG9jYXRpb24KICAgIGxldCBhbGxvY2F0ZWQ6IGkzMiA9IGFsbG9jYXRlTm9kZSgmbXV0IGJvdW5kYXJ5X21lbW9yeSwgOSk7CiAgICBwcmludGxuSW50KGFsbG9jYXRlZCk7IC8vIFNob3VsZCBoYW5kbGUgYm91bmRhcnkgY29ycmVjdGx5Cn0KCi8vIFRlc3QgY2lyY3VsYXIgbGlzdCBkZXRlY3Rpb24gKGNvcm5lciBjYXNlKQpmbiB0ZXN0Q2lyY3VsYXJMaXN0RGV0ZWN0aW9uKCkgewogICAgbGV0IG11dCBjaXJjdWxhcl9tZW1vcnk6IFtpMzI7IDIwXSA9IFswOyAyMF07CiAgICAKICAgIC8vIENyZWF0ZSBhIHNtYWxsIGNpcmN1bGFyIGxpc3Q6IDEgLT4gMyAtPiA1IC0+IDEKICAgIGNpcmN1bGFyX21lbW9yeVsxXSA9IDExMTsKICAgIGNpcmN1bGFyX21lbW9yeVsyXSA9IDM7CiAgICBjaXJjdWxhcl9tZW1vcnlbM10gPSAyMjI7CiAgICBjaXJjdWxhcl9tZW1vcnlbNF0gPSA1OwogICAgY2lyY3VsYXJfbWVtb3J5WzVdID0gMzMzOwogICAgY2lyY3VsYXJfbWVtb3J5WzZdID0gMTsgLy8gUG9pbnRzIGJhY2sgdG8gZmlyc3Qgbm9kZSAtIGNyZWF0ZXMgY3ljbGUKICAgIAogICAgbGV0IGNpcmN1bGFyX2hlYWQ6IGkzMiA9IDE7CiAgICAKICAgIC8vIFNhZmUgdHJhdmVyc2FsIHdpdGggbGltaXQgc2hvdWxkIGhhbmRsZSBjaXJjdWxhciByZWZlcmVuY2UKICAgIGxldCBsaW1pdGVkX3N1bTogaTMyID0gc2FmZVRyYXZlcnNlV2l0aExpbWl0KGNpcmN1bGFyX21lbW9yeSwgY2lyY3VsYXJfaGVhZCwgMTApOwogICAgcHJpbnRsbkludChsaW1pdGVkX3N1bSk7CiAgICAKICAgIC8vIEN5Y2xlIGRldGVjdGlvbgogICAgbGV0IGhhc19jeWNsZTogaTMyID0gZGV0ZWN0Q3ljbGUoY2lyY3VsYXJfbWVtb3J5LCBjaXJjdWxhcl9oZWFkKTsKICAgIHByaW50bG5JbnQoaGFzX2N5Y2xlKTsKfQoKLy8gU2FmZSB0cmF2ZXJzYWwgd2l0aCBzdGVwIGxpbWl0CmZuIHNhZmVUcmF2ZXJzZVdpdGhMaW1pdChtZW1vcnlfcG9vbDogW2kzMjsgMjBdLCBoZWFkOiBpMzIsIG1heF9zdGVwczogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9IGhlYWQ7CiAgICBsZXQgbXV0IHN0ZXBzOiBpMzIgPSAwOwogICAgCiAgICB3aGlsZSAoY3VycmVudCAhPSAwICYmIHN0ZXBzIDwgbWF4X3N0ZXBzKSB7CiAgICAgICAgc3VtID0gc3VtICsgbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZV07CiAgICAgICAgY3VycmVudCA9IG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemUgKyAxXTsKICAgICAgICBzdGVwcyA9IHN0ZXBzICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIHN1bTsKfQoKLy8gRmxveWQncyBjeWNsZSBkZXRlY3Rpb24gYWxnb3JpdGhtCmZuIGRldGVjdEN5Y2xlKG1lbW9yeV9wb29sOiBbaTMyOyAyMF0sIGhlYWQ6IGkzMikgLT4gaTMyIHsKICAgIGlmIChoZWFkID09IDApIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIAogICAgbGV0IG11dCBzbG93OiBpMzIgPSBoZWFkOwogICAgbGV0IG11dCBmYXN0OiBpMzIgPSBoZWFkOwogICAgbGV0IG11dCBzdGVwX2NvdW50OiBpMzIgPSAwOwogICAgCiAgICB3aGlsZSAoc3RlcF9jb3VudCA8IDE1KSB7CiAgICAgICAgLy8gTW92ZSBzbG93IHBvaW50ZXIgb25lIHN0ZXAKICAgICAgICBpZiAoc2xvdyAhPSAwKSB7CiAgICAgICAgICAgIHNsb3cgPSBtZW1vcnlfcG9vbFtzbG93IGFzIHVzaXplICsgMV07CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIE1vdmUgZmFzdCBwb2ludGVyIHR3byBzdGVwcwogICAgICAgIGlmIChmYXN0ICE9IDApIHsKICAgICAgICAgICAgZmFzdCA9IG1lbW9yeV9wb29sW2Zhc3QgYXMgdXNpemUgKyAxXTsKICAgICAgICAgICAgaWYgKGZhc3QgIT0gMCkgewogICAgICAgICAgICAgICAgZmFzdCA9IG1lbW9yeV9wb29sW2Zhc3QgYXMgdXNpemUgKyAxXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBJZiB0aGV5IG1lZXQsIHRoZXJlJ3MgYSBjeWNsZQogICAgICAgIGlmIChzbG93ICE9IDAgJiYgZmFzdCAhPSAwICYmIHNsb3cgPT0gZmFzdCkgewogICAgICAgICAgICByZXR1cm4gMTsgLy8gQ3ljbGUgZGV0ZWN0ZWQKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKGZhc3QgPT0gMCkgewogICAgICAgICAgICByZXR1cm4gMDsgLy8gTm8gY3ljbGUKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgc3RlcF9jb3VudCA9IHN0ZXBfY291bnQgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gMDsgLy8gTm8gY3ljbGUgZGV0ZWN0ZWQgd2l0aGluIHN0ZXAgbGltaXQKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (17, "comprehensive17", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEFkdmFuY2VkIE1hdHJpeCBPcGVyYXRpb25zIGFuZCBTcGFyc2UgTWF0cml4IEltcGxlbWVudGF0aW9uClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpNdWx0aS1kaW1lbnNpb25hbCBhcnJheSBhY2Nlc3MgcGF0dGVybnMgYW5kIG9wdGltaXphdGlvbgpDb21wbGV4IG5lc3RlZCBsb29wIHN0cnVjdHVyZXMgYW5kIGxvb3AgaW50ZXJjaGFuZ2Ugb3B0aW1pemF0aW9uCkFyaXRobWV0aWMgb3B0aW1pemF0aW9uIGluIG1hdHJpeCBjb21wdXRhdGlvbnMKTWVtb3J5IGFjY2VzcyBwYXR0ZXJuIG9wdGltaXphdGlvbiBmb3IgY2FjaGUgZWZmaWNpZW5jeQpGdW5jdGlvbiBjYWxsIG9wdGltaXphdGlvbiB3aXRoIGxhcmdlIHBhcmFtZXRlciBwYXNzaW5nCkJyYW5jaCBvcHRpbWl6YXRpb24gaW4gY29uZGl0aW9uYWwgbWF0cml4IG9wZXJhdGlvbnMKKi8KCi8vIGNvbXByZWhlbnNpdmUxNy5yeCAtIEFkdmFuY2VkIE1hdHJpeCBPcGVyYXRpb25zIGFuZCBTcGFyc2UgTWF0cml4IEltcGxlbWVudGF0aW9uCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIE11bHRpLWRpbWVuc2lvbmFsIGFycmF5IGFjY2VzcyBwYXR0ZXJucyBhbmQgb3B0aW1pemF0aW9uCi8vIC0gQ29tcGxleCBuZXN0ZWQgbG9vcCBzdHJ1Y3R1cmVzIGFuZCBsb29wIGludGVyY2hhbmdlIG9wdGltaXphdGlvbgovLyAtIEFyaXRobWV0aWMgb3B0aW1pemF0aW9uIGluIG1hdHJpeCBjb21wdXRhdGlvbnMKLy8gLSBNZW1vcnkgYWNjZXNzIHBhdHRlcm4gb3B0aW1pemF0aW9uIGZvciBjYWNoZSBlZmZpY2llbmN5Ci8vIC0gRnVuY3Rpb24gY2FsbCBvcHRpbWl6YXRpb24gd2l0aCBsYXJnZSBwYXJhbWV0ZXIgcGFzc2luZwovLyAtIEJyYW5jaCBvcHRpbWl6YXRpb24gaW4gY29uZGl0aW9uYWwgbWF0cml4IG9wZXJhdGlvbnMKCmZuIG1haW4oKSB7CiAgICBwcmludGxuSW50KDE3MDApOyAvLyBUZXN0IHN0YXJ0IG1hcmtlcgoKICAgIC8vIEluaXRpYWxpemUgYW5kIHRlc3QgYmFzaWMgbWF0cml4IG9wZXJhdGlvbnMKICAgIHBlcmZvcm1CYXNpY01hdHJpeE9wZXJhdGlvbnMoKTsKCiAgICAvLyBUZXN0IGFkdmFuY2VkIG1hdHJpeCBhbGdvcml0aG1zCiAgICBwZXJmb3JtQWR2YW5jZWRNYXRyaXhBbGdvcml0aG1zKCk7CgogICAgLy8gVGVzdCBzcGFyc2UgbWF0cml4IGltcGxlbWVudGF0aW9ucwogICAgcGVyZm9ybVNwYXJzZU1hdHJpeE9wZXJhdGlvbnMoKTsKCiAgICAvLyBUZXN0IG1hdHJpeCBwZXJmb3JtYW5jZSBiZW5jaG1hcmtzCiAgICBwZXJmb3JtTWF0cml4UGVyZm9ybWFuY2VCZW5jaG1hcmtzKCk7CgogICAgLy8gVGVzdCBlZGdlIGNhc2VzIGFuZCBib3VuZGFyeSBjb25kaXRpb25zCiAgICB0ZXN0TWF0cml4RWRnZUNhc2VzKCk7CgogICAgcHJpbnRsbkludCgxNzk5KTsgLy8gVGVzdCBlbmQgbWFya2VyCiAgICBleGl0KDApOwp9CgovLyBCYXNpYyBtYXRyaXggb3BlcmF0aW9ucyB0ZXN0aW5nCmZuIHBlcmZvcm1CYXNpY01hdHJpeE9wZXJhdGlvbnMoKSB7CiAgICBwcmludGxuSW50KDE3MDEpOyAvLyBCYXNpYyBvcGVyYXRpb25zIHN0YXJ0CgogICAgLy8gSW5pdGlhbGl6ZSB0ZXN0IG1hdHJpY2VzIC0gdXNpbmcgMUQgYXJyYXlzIHRvIHNpbXVsYXRlIDJEIG1hdHJpY2VzCiAgICAvLyBNYXRyaXggQTogMjB4MjAsIE1hdHJpeCBCOiAyMHgyMCwgUmVzdWx0OiAyMHgyMAogICAgbGV0IG11dCBtYXRyaXhfYTogW2kzMjsgNDAwXSA9IFswOyA0MDBdOwogICAgbGV0IG11dCBtYXRyaXhfYjogW2kzMjsgNDAwXSA9IFswOyA0MDBdOwogICAgbGV0IG11dCByZXN1bHRfbWF0cml4OiBbaTMyOyA0MDBdID0gWzA7IDQwMF07CiAgICBsZXQgbWF0cml4X3NpemU6IGkzMiA9IDIwOwoKICAgIC8vIEluaXRpYWxpemUgbWF0cmljZXMgd2l0aCBwYXR0ZXJuIGRhdGEKICAgIGluaXRpYWxpemVNYXRyaWNlcygmbXV0IG1hdHJpeF9hLCAmbXV0IG1hdHJpeF9iLCBtYXRyaXhfc2l6ZSk7CgogICAgLy8gVGVzdCAxOiBNYXRyaXggYWRkaXRpb24KICAgIHByaW50bG5JbnQoMTcwMik7IC8vIE1hdHJpeCBhZGRpdGlvbiBtYXJrZXIKICAgIG1hdHJpeEFkZGl0aW9uKAogICAgICAgICZtdXQgbWF0cml4X2EsCiAgICAgICAgJm11dCBtYXRyaXhfYiwKICAgICAgICAmbXV0IHJlc3VsdF9tYXRyaXgsCiAgICAgICAgbWF0cml4X3NpemUsCiAgICApOwogICAgbGV0IGFkZGl0aW9uX3N1bTogaTMyID0gY2FsY3VsYXRlTWF0cml4U3VtKCZtdXQgcmVzdWx0X21hdHJpeCwgbWF0cml4X3NpemUpOwogICAgcHJpbnRsbkludChhZGRpdGlvbl9zdW0pOwoKICAgIC8vIFRlc3QgMjogTWF0cml4IHN1YnRyYWN0aW9uCiAgICBwcmludGxuSW50KDE3MDMpOyAvLyBNYXRyaXggc3VidHJhY3Rpb24gbWFya2VyCiAgICBtYXRyaXhTdWJ0cmFjdGlvbigKICAgICAgICAmbXV0IG1hdHJpeF9hLAogICAgICAgICZtdXQgbWF0cml4X2IsCiAgICAgICAgJm11dCByZXN1bHRfbWF0cml4LAogICAgICAgIG1hdHJpeF9zaXplLAogICAgKTsKICAgIGxldCBzdWJ0cmFjdGlvbl9zdW06IGkzMiA9IGNhbGN1bGF0ZU1hdHJpeFN1bSgmbXV0IHJlc3VsdF9tYXRyaXgsIG1hdHJpeF9zaXplKTsKICAgIHByaW50bG5JbnQoc3VidHJhY3Rpb25fc3VtKTsKCiAgICAvLyBUZXN0IDM6IE1hdHJpeCBtdWx0aXBsaWNhdGlvbgogICAgcHJpbnRsbkludCgxNzA0KTsgLy8gTWF0cml4IG11bHRpcGxpY2F0aW9uIG1hcmtlcgogICAgbWF0cml4TXVsdGlwbGljYXRpb24oCiAgICAgICAgJm11dCBtYXRyaXhfYSwKICAgICAgICAmbXV0IG1hdHJpeF9iLAogICAgICAgICZtdXQgcmVzdWx0X21hdHJpeCwKICAgICAgICBtYXRyaXhfc2l6ZSwKICAgICk7CiAgICBsZXQgbXVsdGlwbGljYXRpb25fc3VtOiBpMzIgPSBjYWxjdWxhdGVNYXRyaXhTdW0oJm11dCByZXN1bHRfbWF0cml4LCBtYXRyaXhfc2l6ZSk7CiAgICBwcmludGxuSW50KG11bHRpcGxpY2F0aW9uX3N1bSk7CgogICAgLy8gVGVzdCA0OiBNYXRyaXggdHJhbnNwb3NlCiAgICBwcmludGxuSW50KDE3MDUpOyAvLyBNYXRyaXggdHJhbnNwb3NlIG1hcmtlcgogICAgbWF0cml4VHJhbnNwb3NlKCZtdXQgbWF0cml4X2EsICZtdXQgcmVzdWx0X21hdHJpeCwgbWF0cml4X3NpemUpOwogICAgbGV0IHRyYW5zcG9zZV9zdW06IGkzMiA9IGNhbGN1bGF0ZU1hdHJpeFN1bSgmbXV0IHJlc3VsdF9tYXRyaXgsIG1hdHJpeF9zaXplKTsKICAgIHByaW50bG5JbnQodHJhbnNwb3NlX3N1bSk7CgogICAgLy8gVGVzdCA1OiBNYXRyaXggZGV0ZXJtaW5hbnQgKGZvciBzbWFsbGVyIG1hdHJpY2VzKQogICAgcHJpbnRsbkludCgxNzA2KTsgLy8gTWF0cml4IGRldGVybWluYW50IG1hcmtlcgogICAgbGV0IHNtYWxsX21hdHJpeDogW2kzMjsgMTZdID0gWzA7IDE2XTsgLy8gNHg0IG1hdHJpeAogICAgaW5pdGlhbGl6ZVNtYWxsTWF0cml4KHNtYWxsX21hdHJpeCk7CiAgICBsZXQgZGV0ZXJtaW5hbnQ6IGkzMiA9IGNhbGN1bGF0ZURldGVybWluYW50NHg0KHNtYWxsX21hdHJpeCk7CiAgICBwcmludGxuSW50KGRldGVybWluYW50KTsKfQoKLy8gSW5pdGlhbGl6ZSBtYXRyaWNlcyB3aXRoIHNwZWNpZmljIHBhdHRlcm5zIGZvciB0ZXN0aW5nCmZuIGluaXRpYWxpemVNYXRyaWNlcyhtYXRyaXhfYTogJm11dCBbaTMyOyA0MDBdLCBtYXRyaXhfYjogJm11dCBbaTMyOyA0MDBdLCBzaXplOiBpMzIpIHsKICAgIGxldCBtdXQgcm93OiBpMzIgPSAwOwogICAgd2hpbGUgKHJvdyA8IHNpemUpIHsKICAgICAgICBsZXQgbXV0IGNvbDogaTMyID0gMDsKICAgICAgICB3aGlsZSAoY29sIDwgc2l6ZSkgewogICAgICAgICAgICBsZXQgaW5kZXg6IGkzMiA9IHJvdyAqIHNpemUgKyBjb2w7CgogICAgICAgICAgICAvLyBNYXRyaXggQTogSWRlbnRpdHktbGlrZSBwYXR0ZXJuIHdpdGggdmFyaWF0aW9ucwogICAgICAgICAgICBpZiAocm93ID09IGNvbCkgewogICAgICAgICAgICAgICAgbWF0cml4X2FbaW5kZXggYXMgdXNpemVdID0gcm93ICsgY29sICsgMTA7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBtYXRyaXhfYVtpbmRleCBhcyB1c2l6ZV0gPSAocm93ICogMiArIGNvbCAqIDMpICUgNzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gTWF0cml4IEI6IFN5bW1ldHJpYyBwYXR0ZXJuCiAgICAgICAgICAgIGlmIChyb3cgPD0gY29sKSB7CiAgICAgICAgICAgICAgICBtYXRyaXhfYltpbmRleCBhcyB1c2l6ZV0gPSByb3cgKiBjb2wgKyA1OwogICAgICAgICAgICAgICAgbWF0cml4X2JbKGNvbCAqIHNpemUgKyByb3cpIGFzIHVzaXplXSA9IHJvdyAqIGNvbCArIDU7IC8vIEVuc3VyZSBzeW1tZXRyeQogICAgICAgICAgICB9CgogICAgICAgICAgICBjb2wgPSBjb2wgKyAxOwogICAgICAgIH0KICAgICAgICByb3cgPSByb3cgKyAxOwogICAgfQp9CgovLyBNYXRyaXggYWRkaXRpb24gd2l0aCBvcHRpbWl6ZWQgYWNjZXNzIHBhdHRlcm5zCmZuIG1hdHJpeEFkZGl0aW9uKAogICAgbWF0cml4X2E6ICZtdXQgW2kzMjsgNDAwXSwKICAgIG1hdHJpeF9iOiAmbXV0IFtpMzI7IDQwMF0sCiAgICByZXN1bHQ6ICZtdXQgW2kzMjsgNDAwXSwKICAgIHNpemU6IGkzMiwKKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICBsZXQgdG90YWxfZWxlbWVudHM6IGkzMiA9IHNpemUgKiBzaXplOwoKICAgIHdoaWxlIChpIDwgdG90YWxfZWxlbWVudHMpIHsKICAgICAgICByZXN1bHRbaSBhcyB1c2l6ZV0gPSBtYXRyaXhfYVtpIGFzIHVzaXplXSArIG1hdHJpeF9iW2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gTWF0cml4IHN1YnRyYWN0aW9uCmZuIG1hdHJpeFN1YnRyYWN0aW9uKAogICAgbWF0cml4X2E6ICZtdXQgW2kzMjsgNDAwXSwKICAgIG1hdHJpeF9iOiAmbXV0IFtpMzI7IDQwMF0sCiAgICByZXN1bHQ6ICZtdXQgW2kzMjsgNDAwXSwKICAgIHNpemU6IGkzMiwKKSB7CiAgICBsZXQgbXV0IHJvdzogaTMyID0gMDsKICAgIHdoaWxlIChyb3cgPCBzaXplKSB7CiAgICAgICAgbGV0IG11dCBjb2w6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGNvbCA8IHNpemUpIHsKICAgICAgICAgICAgbGV0IGluZGV4OiBpMzIgPSByb3cgKiBzaXplICsgY29sOwogICAgICAgICAgICByZXN1bHRbaW5kZXggYXMgdXNpemVdID0gbWF0cml4X2FbaW5kZXggYXMgdXNpemVdIC0gbWF0cml4X2JbaW5kZXggYXMgdXNpemVdOwogICAgICAgICAgICBjb2wgPSBjb2wgKyAxOwogICAgICAgIH0KICAgICAgICByb3cgPSByb3cgKyAxOwogICAgfQp9CgovLyBNYXRyaXggbXVsdGlwbGljYXRpb24gd2l0aCBjYWNoZS1lZmZpY2llbnQgaW1wbGVtZW50YXRpb24KZm4gbWF0cml4TXVsdGlwbGljYXRpb24oCiAgICBtYXRyaXhfYTogJm11dCBbaTMyOyA0MDBdLAogICAgbWF0cml4X2I6ICZtdXQgW2kzMjsgNDAwXSwKICAgIHJlc3VsdDogJm11dCBbaTMyOyA0MDBdLAogICAgc2l6ZTogaTMyLAopIHsKICAgIC8vIEluaXRpYWxpemUgcmVzdWx0IG1hdHJpeCB0byB6ZXJvCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUgKiBzaXplKSB7CiAgICAgICAgcmVzdWx0W2kgYXMgdXNpemVdID0gMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gQmxvY2tlZCBtYXRyaXggbXVsdGlwbGljYXRpb24gZm9yIGJldHRlciBjYWNoZSBwZXJmb3JtYW5jZQogICAgbGV0IGJsb2NrX3NpemU6IGkzMiA9IDQ7IC8vIFNtYWxsIGJsb2NrcyBmb3IgdGhpcyBzaW1wbGlmaWVkIGltcGxlbWVudGF0aW9uCiAgICBsZXQgbXV0IHJvd19ibG9jazogaTMyID0gMDsKCiAgICB3aGlsZSAocm93X2Jsb2NrIDwgc2l6ZSkgewogICAgICAgIGxldCBtdXQgY29sX2Jsb2NrOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChjb2xfYmxvY2sgPCBzaXplKSB7CiAgICAgICAgICAgIGxldCBtdXQga19ibG9jazogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKGtfYmxvY2sgPCBzaXplKSB7CiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIGJsb2NrCiAgICAgICAgICAgICAgICBwcm9jZXNzTWF0cml4QmxvY2soCiAgICAgICAgICAgICAgICAgICAgbWF0cml4X2EsIG1hdHJpeF9iLCByZXN1bHQsIHNpemUsIHJvd19ibG9jaywgY29sX2Jsb2NrLCBrX2Jsb2NrLCBibG9ja19zaXplLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGtfYmxvY2sgPSBrX2Jsb2NrICsgYmxvY2tfc2l6ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb2xfYmxvY2sgPSBjb2xfYmxvY2sgKyBibG9ja19zaXplOwogICAgICAgIH0KICAgICAgICByb3dfYmxvY2sgPSByb3dfYmxvY2sgKyBibG9ja19zaXplOwogICAgfQp9CgovLyBQcm9jZXNzIGEgYmxvY2sgaW4gbWF0cml4IG11bHRpcGxpY2F0aW9uCmZuIHByb2Nlc3NNYXRyaXhCbG9jaygKICAgIG1hdHJpeF9hOiAmbXV0IFtpMzI7IDQwMF0sCiAgICBtYXRyaXhfYjogJm11dCBbaTMyOyA0MDBdLAogICAgcmVzdWx0OiAmbXV0IFtpMzI7IDQwMF0sCiAgICBzaXplOiBpMzIsCiAgICByb3dfc3RhcnQ6IGkzMiwKICAgIGNvbF9zdGFydDogaTMyLAogICAga19zdGFydDogaTMyLAogICAgYmxvY2tfc2l6ZTogaTMyLAopIHsKICAgIGxldCByb3dfZW5kOiBpMzIgPSBtaW5WYWx1ZShyb3dfc3RhcnQgKyBibG9ja19zaXplLCBzaXplKTsKICAgIGxldCBjb2xfZW5kOiBpMzIgPSBtaW5WYWx1ZShjb2xfc3RhcnQgKyBibG9ja19zaXplLCBzaXplKTsKICAgIGxldCBrX2VuZDogaTMyID0gbWluVmFsdWUoa19zdGFydCArIGJsb2NrX3NpemUsIHNpemUpOwoKICAgIGxldCBtdXQgaTogaTMyID0gcm93X3N0YXJ0OwogICAgd2hpbGUgKGkgPCByb3dfZW5kKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSBjb2xfc3RhcnQ7CiAgICAgICAgd2hpbGUgKGogPCBjb2xfZW5kKSB7CiAgICAgICAgICAgIGxldCBtdXQgazogaTMyID0ga19zdGFydDsKICAgICAgICAgICAgd2hpbGUgKGsgPCBrX2VuZCkgewogICAgICAgICAgICAgICAgbGV0IHJlc3VsdF9pbmRleDogaTMyID0gaSAqIHNpemUgKyBqOwogICAgICAgICAgICAgICAgbGV0IGFfaW5kZXg6IGkzMiA9IGkgKiBzaXplICsgazsKICAgICAgICAgICAgICAgIGxldCBiX2luZGV4OiBpMzIgPSBrICogc2l6ZSArIGo7CiAgICAgICAgICAgICAgICByZXN1bHRbcmVzdWx0X2luZGV4IGFzIHVzaXplXSA9IHJlc3VsdFtyZXN1bHRfaW5kZXggYXMgdXNpemVdCiAgICAgICAgICAgICAgICAgICAgKyBtYXRyaXhfYVthX2luZGV4IGFzIHVzaXplXSAqIG1hdHJpeF9iW2JfaW5kZXggYXMgdXNpemVdOwogICAgICAgICAgICAgICAgayA9IGsgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBIZWxwZXIgZnVuY3Rpb24gdG8gZmluZCBtaW5pbXVtIHZhbHVlCmZuIG1pblZhbHVlKGE6IGkzMiwgYjogaTMyKSAtPiBpMzIgewogICAgaWYgKGEgPCBiKSB7CiAgICAgICAgcmV0dXJuIGE7CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBiOwogICAgfQp9CgovLyBNYXRyaXggdHJhbnNwb3NlCmZuIG1hdHJpeFRyYW5zcG9zZShtYXRyaXg6ICZtdXQgW2kzMjsgNDAwXSwgcmVzdWx0OiAmbXV0IFtpMzI7IDQwMF0sIHNpemU6IGkzMikgewogICAgbGV0IG11dCByb3c6IGkzMiA9IDA7CiAgICB3aGlsZSAocm93IDwgc2l6ZSkgewogICAgICAgIGxldCBtdXQgY29sOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChjb2wgPCBzaXplKSB7CiAgICAgICAgICAgIGxldCBvcmlnaW5hbF9pbmRleDogaTMyID0gcm93ICogc2l6ZSArIGNvbDsKICAgICAgICAgICAgbGV0IHRyYW5zcG9zZWRfaW5kZXg6IGkzMiA9IGNvbCAqIHNpemUgKyByb3c7CiAgICAgICAgICAgIHJlc3VsdFt0cmFuc3Bvc2VkX2luZGV4IGFzIHVzaXplXSA9IG1hdHJpeFtvcmlnaW5hbF9pbmRleCBhcyB1c2l6ZV07CiAgICAgICAgICAgIGNvbCA9IGNvbCArIDE7CiAgICAgICAgfQogICAgICAgIHJvdyA9IHJvdyArIDE7CiAgICB9Cn0KCi8vIENhbGN1bGF0ZSBzdW0gb2YgYWxsIG1hdHJpeCBlbGVtZW50cwpmbiBjYWxjdWxhdGVNYXRyaXhTdW0obWF0cml4OiAmbXV0IFtpMzI7IDQwMF0sIHNpemU6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgbGV0IHRvdGFsX2VsZW1lbnRzOiBpMzIgPSBzaXplICogc2l6ZTsKCiAgICB3aGlsZSAoaSA8IHRvdGFsX2VsZW1lbnRzKSB7CiAgICAgICAgc3VtID0gc3VtICsgbWF0cml4W2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gc3VtICUgMTAwMDAwMDsgLy8gUHJldmVudCBvdmVyZmxvdyBpbiBvdXRwdXQKfQoKLy8gSW5pdGlhbGl6ZSBzbWFsbCBtYXRyaXggZm9yIGRldGVybWluYW50IGNhbGN1bGF0aW9uCmZuIGluaXRpYWxpemVTbWFsbE1hdHJpeChtdXQgbWF0cml4OiBbaTMyOyAxNl0pIHsKICAgIC8vIDR4NCBtYXRyaXggd2l0aCBzcGVjaWZpYyB2YWx1ZXMgZm9yIGRldGVybWluYW50IHRlc3RpbmcKICAgIG1hdHJpeFswXSA9IDQ7CiAgICBtYXRyaXhbMV0gPSAzOwogICAgbWF0cml4WzJdID0gMjsKICAgIG1hdHJpeFszXSA9IDE7CiAgICBtYXRyaXhbNF0gPSAzOwogICAgbWF0cml4WzVdID0gNDsKICAgIG1hdHJpeFs2XSA9IDE7CiAgICBtYXRyaXhbN10gPSAyOwogICAgbWF0cml4WzhdID0gMjsKICAgIG1hdHJpeFs5XSA9IDE7CiAgICBtYXRyaXhbMTBdID0gNDsKICAgIG1hdHJpeFsxMV0gPSAzOwogICAgbWF0cml4WzEyXSA9IDE7CiAgICBtYXRyaXhbMTNdID0gMjsKICAgIG1hdHJpeFsxNF0gPSAzOwogICAgbWF0cml4WzE1XSA9IDQ7Cn0KCi8vIENhbGN1bGF0ZSBkZXRlcm1pbmFudCBvZiA0eDQgbWF0cml4IHVzaW5nIGNvZmFjdG9yIGV4cGFuc2lvbgpmbiBjYWxjdWxhdGVEZXRlcm1pbmFudDR4NChtYXRyaXg6IFtpMzI7IDE2XSkgLT4gaTMyIHsKICAgIGxldCBtdXQgZGV0ZXJtaW5hbnQ6IGkzMiA9IDA7CgogICAgLy8gRXhwYW5kIGFsb25nIGZpcnN0IHJvdwogICAgbGV0IG11dCBjb2w6IGkzMiA9IDA7CiAgICB3aGlsZSAoY29sIDwgNCkgewogICAgICAgIGxldCBjb2ZhY3RvcjogaTMyID0gY2FsY3VsYXRlQ29mYWN0b3I0eDQobWF0cml4LCAwLCBjb2wpOwogICAgICAgIGlmIChjb2wgJSAyID09IDApIHsKICAgICAgICAgICAgZGV0ZXJtaW5hbnQgPSBkZXRlcm1pbmFudCArIG1hdHJpeFtjb2wgYXMgdXNpemVdICogY29mYWN0b3I7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGV0ZXJtaW5hbnQgPSBkZXRlcm1pbmFudCAtIG1hdHJpeFtjb2wgYXMgdXNpemVdICogY29mYWN0b3I7CiAgICAgICAgfQogICAgICAgIGNvbCA9IGNvbCArIDE7CiAgICB9CgogICAgcmV0dXJuIGRldGVybWluYW50Owp9CgovLyBDYWxjdWxhdGUgY29mYWN0b3IgZm9yIDR4NCBtYXRyaXggZGV0ZXJtaW5hbnQKZm4gY2FsY3VsYXRlQ29mYWN0b3I0eDQobWF0cml4OiBbaTMyOyAxNl0sIGV4Y2x1ZGVfcm93OiBpMzIsIGV4Y2x1ZGVfY29sOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IG1pbm9yX21hdHJpeDogW2kzMjsgOV0gPSBbMDsgOV07IC8vIDN4MyBtaW5vciBtYXRyaXgKICAgIGxldCBtdXQgbWlub3JfaW5kZXg6IGkzMiA9IDA7CgogICAgbGV0IG11dCByb3c6IGkzMiA9IDA7CiAgICB3aGlsZSAocm93IDwgNCkgewogICAgICAgIGlmIChyb3cgIT0gZXhjbHVkZV9yb3cpIHsKICAgICAgICAgICAgbGV0IG11dCBjb2w6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChjb2wgPCA0KSB7CiAgICAgICAgICAgICAgICBpZiAoY29sICE9IGV4Y2x1ZGVfY29sKSB7CiAgICAgICAgICAgICAgICAgICAgbWlub3JfbWF0cml4W21pbm9yX2luZGV4IGFzIHVzaXplXSA9IG1hdHJpeFsocm93ICogNCArIGNvbCkgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgICAgIG1pbm9yX2luZGV4ID0gbWlub3JfaW5kZXggKyAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29sID0gY29sICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByb3cgPSByb3cgKyAxOwogICAgfQoKICAgIHJldHVybiBjYWxjdWxhdGVEZXRlcm1pbmFudDN4MyhtaW5vcl9tYXRyaXgpOwp9CgovLyBDYWxjdWxhdGUgZGV0ZXJtaW5hbnQgb2YgM3gzIG1hdHJpeApmbiBjYWxjdWxhdGVEZXRlcm1pbmFudDN4MyhtYXRyaXg6IFtpMzI7IDldKSAtPiBpMzIgewogICAgbGV0IHRlcm0xOiBpMzIgPSBtYXRyaXhbMF0gKiAobWF0cml4WzRdICogbWF0cml4WzhdIC0gbWF0cml4WzVdICogbWF0cml4WzddKTsKICAgIGxldCB0ZXJtMjogaTMyID0gbWF0cml4WzFdICogKG1hdHJpeFszXSAqIG1hdHJpeFs4XSAtIG1hdHJpeFs1XSAqIG1hdHJpeFs2XSk7CiAgICBsZXQgdGVybTM6IGkzMiA9IG1hdHJpeFsyXSAqIChtYXRyaXhbM10gKiBtYXRyaXhbN10gLSBtYXRyaXhbNF0gKiBtYXRyaXhbNl0pOwoKICAgIHJldHVybiB0ZXJtMSAtIHRlcm0yICsgdGVybTM7Cn0KCi8vIEFkdmFuY2VkIG1hdHJpeCBhbGdvcml0aG1zCmZuIHBlcmZvcm1BZHZhbmNlZE1hdHJpeEFsZ29yaXRobXMoKSB7CiAgICBwcmludGxuSW50KDE3MTApOyAvLyBBZHZhbmNlZCBhbGdvcml0aG1zIHN0YXJ0CgogICAgLy8gVGVzdCAxOiBNYXRyaXggcG93ZXIgY2FsY3VsYXRpb24KICAgIHByaW50bG5JbnQoMTcxMSk7IC8vIE1hdHJpeCBwb3dlciBtYXJrZXIKICAgIGxldCBtdXQgYmFzZV9tYXRyaXg6IFtpMzI7IDEwMF0gPSBbMDsgMTAwXTsgLy8gMTB4MTAgbWF0cml4CiAgICBsZXQgbWF0cml4X3NpemU6IGkzMiA9IDEwOwogICAgaW5pdGlhbGl6ZU1hdHJpeEZvclBvd2VyKCZtdXQgYmFzZV9tYXRyaXgsIG1hdHJpeF9zaXplKTsKCiAgICBsZXQgbXV0IHBvd2VyX3Jlc3VsdDogW2kzMjsgMTAwXSA9IFswOyAxMDBdOwogICAgbWF0cml4UG93ZXIoJmJhc2VfbWF0cml4LCAmbXV0IHBvd2VyX3Jlc3VsdCwgbWF0cml4X3NpemUsIDMpOwogICAgbGV0IHBvd2VyX3N1bTogaTMyID0gY2FsY3VsYXRlTWF0cml4U3VtMTAwKCZwb3dlcl9yZXN1bHQsIG1hdHJpeF9zaXplKTsKICAgIHByaW50bG5JbnQocG93ZXJfc3VtKTsKCiAgICAvLyBUZXN0IDI6IE1hdHJpeCByb3RhdGlvbiBvcGVyYXRpb25zCiAgICBwcmludGxuSW50KDE3MTIpOyAvLyBNYXRyaXggcm90YXRpb24gbWFya2VyCiAgICBsZXQgbXV0IHJvdGF0aW9uX21hdHJpeDogW2kzMjsgNjRdID0gWzA7IDY0XTsgLy8gOHg4IG1hdHJpeAogICAgaW5pdGlhbGl6ZVJvdGF0aW9uTWF0cml4KCZtdXQgcm90YXRpb25fbWF0cml4KTsKCiAgICByb3RhdGVNYXRyaXg5MERlZ3JlZXMoJm11dCByb3RhdGlvbl9tYXRyaXgsIDgpOwogICAgbGV0IHJvdGF0aW9uX3N1bTogaTMyID0gY2FsY3VsYXRlTWF0cml4U3VtNjQocm90YXRpb25fbWF0cml4KTsKICAgIHByaW50bG5JbnQocm90YXRpb25fc3VtKTsKCiAgICAvLyBUZXN0IDM6IE1hdHJpeCBkaWFnb25hbCBvcGVyYXRpb25zCiAgICBwcmludGxuSW50KDE3MTMpOyAvLyBNYXRyaXggZGlhZ29uYWwgbWFya2VyCiAgICBsZXQgZGlhZ29uYWxfc3VtOiBpMzIgPSBjYWxjdWxhdGVEaWFnb25hbFN1bXMoJmJhc2VfbWF0cml4LCBtYXRyaXhfc2l6ZSk7CiAgICBwcmludGxuSW50KGRpYWdvbmFsX3N1bSk7CgogICAgLy8gVGVzdCA0OiBNYXRyaXggdHJhY2UgYW5kIG5vcm0gY2FsY3VsYXRpb25zCiAgICBwcmludGxuSW50KDE3MTQpOyAvLyBNYXRyaXggdHJhY2UgbWFya2VyCiAgICBsZXQgdHJhY2U6IGkzMiA9IGNhbGN1bGF0ZU1hdHJpeFRyYWNlKCZiYXNlX21hdHJpeCwgbWF0cml4X3NpemUpOwogICAgbGV0IG5vcm06IGkzMiA9IGNhbGN1bGF0ZU1hdHJpeE5vcm0oJmJhc2VfbWF0cml4LCBtYXRyaXhfc2l6ZSk7CiAgICBwcmludGxuSW50KHRyYWNlICsgbm9ybSk7Cn0KCi8vIEluaXRpYWxpemUgbWF0cml4IGZvciBwb3dlciBjYWxjdWxhdGlvbgpmbiBpbml0aWFsaXplTWF0cml4Rm9yUG93ZXIobWF0cml4OiAmbXV0IFtpMzI7IDEwMF0sIHNpemU6IGkzMikgewogICAgbGV0IG11dCByb3c6IGkzMiA9IDA7CiAgICB3aGlsZSAocm93IDwgc2l6ZSkgewogICAgICAgIGxldCBtdXQgY29sOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChjb2wgPCBzaXplKSB7CiAgICAgICAgICAgIGxldCBpbmRleDogaTMyID0gcm93ICogc2l6ZSArIGNvbDsKICAgICAgICAgICAgaWYgKHJvdyA9PSBjb2wpIHsKICAgICAgICAgICAgICAgIG1hdHJpeFtpbmRleCBhcyB1c2l6ZV0gPSAyOyAvLyBEaWFnb25hbCBlbGVtZW50cwogICAgICAgICAgICB9IGVsc2UgaWYgKGFic1ZhbHVlKHJvdyAtIGNvbCkgPT0gMSkgewogICAgICAgICAgICAgICAgbWF0cml4W2luZGV4IGFzIHVzaXplXSA9IDE7IC8vIEFkamFjZW50IHRvIGRpYWdvbmFsCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBtYXRyaXhbaW5kZXggYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb2wgPSBjb2wgKyAxOwogICAgICAgIH0KICAgICAgICByb3cgPSByb3cgKyAxOwogICAgfQp9CgovLyBDYWxjdWxhdGUgbWF0cml4IHBvd2VyIHVzaW5nIHJlcGVhdGVkIG1hdHJpeCBtdWx0aXBsaWNhdGlvbgpmbiBtYXRyaXhQb3dlcihiYXNlOiAmW2kzMjsgMTAwXSwgcmVzdWx0OiAmbXV0IFtpMzI7IDEwMF0sIHNpemU6IGkzMiwgcG93ZXI6IGkzMikgewogICAgLy8gSW5pdGlhbGl6ZSByZXN1bHQgYXMgaWRlbnRpdHkgbWF0cml4CiAgICBpbml0aWFsaXplSWRlbnRpdHlNYXRyaXgocmVzdWx0LCBzaXplKTsKCiAgICBsZXQgbXV0IHRlbXBfbWF0cml4OiBbaTMyOyAxMDBdID0gWzA7IDEwMF07CiAgICBsZXQgbXV0IGN1cnJlbnRfcG93ZXI6IGkzMiA9IDA7CgogICAgd2hpbGUgKGN1cnJlbnRfcG93ZXIgPCBwb3dlcikgewogICAgICAgIC8vIHJlc3VsdCA9IHJlc3VsdCAqIGJhc2UKICAgICAgICBtYXRyaXhNdWx0aXBsaWNhdGlvbjEwMChyZXN1bHQsIGJhc2UsICZtdXQgdGVtcF9tYXRyaXgsIHNpemUpOwogICAgICAgIGNvcHlNYXRyaXgxMDAoJnRlbXBfbWF0cml4LCByZXN1bHQsIHNpemUpOwogICAgICAgIGN1cnJlbnRfcG93ZXIgPSBjdXJyZW50X3Bvd2VyICsgMTsKICAgIH0KfQoKLy8gSW5pdGlhbGl6ZSBpZGVudGl0eSBtYXRyaXgKZm4gaW5pdGlhbGl6ZUlkZW50aXR5TWF0cml4KG1hdHJpeDogJm11dCBbaTMyOyAxMDBdLCBzaXplOiBpMzIpIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSAqIHNpemUpIHsKICAgICAgICBtYXRyaXhbaSBhcyB1c2l6ZV0gPSAwOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBsZXQgbXV0IGRpYWc6IGkzMiA9IDA7CiAgICB3aGlsZSAoZGlhZyA8IHNpemUpIHsKICAgICAgICBtYXRyaXhbKGRpYWcgKiBzaXplICsgZGlhZykgYXMgdXNpemVdID0gMTsKICAgICAgICBkaWFnID0gZGlhZyArIDE7CiAgICB9Cn0KCi8vIE1hdHJpeCBtdWx0aXBsaWNhdGlvbiBmb3IgMTB4MTAgbWF0cmljZXMKZm4gbWF0cml4TXVsdGlwbGljYXRpb24xMDAoCiAgICBtYXRyaXhfYTogJltpMzI7IDEwMF0sCiAgICBtYXRyaXhfYjogJltpMzI7IDEwMF0sCiAgICByZXN1bHQ6ICZtdXQgW2kzMjsgMTAwXSwKICAgIHNpemU6IGkzMiwKKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgIHJlc3VsdFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChrIDwgc2l6ZSkgewogICAgICAgICAgICAgICAgcmVzdWx0WyhpICogc2l6ZSArIGopIGFzIHVzaXplXSA9IHJlc3VsdFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgICAgICArIG1hdHJpeF9hWyhpICogc2l6ZSArIGspIGFzIHVzaXplXSAqIG1hdHJpeF9iWyhrICogc2l6ZSArIGopIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGsgPSBrICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gQ29weSBtYXRyaXggZm9yIDEweDEwIG1hdHJpY2VzCmZuIGNvcHlNYXRyaXgxMDAoc291cmNlOiAmW2kzMjsgMTAwXSwgZGVzdDogJm11dCBbaTMyOyAxMDBdLCBzaXplOiBpMzIpIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSAqIHNpemUpIHsKICAgICAgICBkZXN0W2kgYXMgdXNpemVdID0gc291cmNlW2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gQ2FsY3VsYXRlIHN1bSBmb3IgMTB4MTAgbWF0cml4CmZuIGNhbGN1bGF0ZU1hdHJpeFN1bTEwMChtYXRyaXg6ICZbaTMyOyAxMDBdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSAqIHNpemUpIHsKICAgICAgICBzdW0gPSBzdW0gKyBtYXRyaXhbaSBhcyB1c2l6ZV07CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcmV0dXJuIHN1bSAlIDEwMDAwMDsKfQoKLy8gSW5pdGlhbGl6ZSByb3RhdGlvbiBtYXRyaXgKZm4gaW5pdGlhbGl6ZVJvdGF0aW9uTWF0cml4KG1hdHJpeDogJm11dCBbaTMyOyA2NF0pIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgOCkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IDgpIHsKICAgICAgICAgICAgbWF0cml4WyhpICogOCArIGopIGFzIHVzaXplXSA9IGkgKiAxMCArIGogKyAxOwogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gUm90YXRlIG1hdHJpeCA5MCBkZWdyZWVzIGNsb2Nrd2lzZQpmbiByb3RhdGVNYXRyaXg5MERlZ3JlZXMobWF0cml4OiAmbXV0IFtpMzI7IDY0XSwgc2l6ZTogaTMyKSB7CiAgICBsZXQgbXV0IHRlbXBfbWF0cml4OiBbaTMyOyA2NF0gPSBbMDsgNjRdOwoKICAgIC8vIENvcHkgdG8gdGVtcAogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBzaXplICogc2l6ZSkgewogICAgICAgIHRlbXBfbWF0cml4W2kgYXMgdXNpemVdID0gbWF0cml4W2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBSb3RhdGU6IG5ld1tqXVtzaXplLTEtaV0gPSBvbGRbaV1bal0KICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgc2l6ZSkgewogICAgICAgICAgICBsZXQgb2xkX2luZGV4OiBpMzIgPSBpICogc2l6ZSArIGo7CiAgICAgICAgICAgIGxldCBuZXdfaW5kZXg6IGkzMiA9IGogKiBzaXplICsgKHNpemUgLSAxIC0gaSk7CiAgICAgICAgICAgIG1hdHJpeFtuZXdfaW5kZXggYXMgdXNpemVdID0gdGVtcF9tYXRyaXhbb2xkX2luZGV4IGFzIHVzaXplXTsKICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIENhbGN1bGF0ZSBzdW0gZm9yIDh4OCBtYXRyaXgKZm4gY2FsY3VsYXRlTWF0cml4U3VtNjQobWF0cml4OiBbaTMyOyA2NF0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgNjQpIHsKICAgICAgICBzdW0gPSBzdW0gKyBtYXRyaXhbaSBhcyB1c2l6ZV07CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcmV0dXJuIHN1bSAlIDEwMDAwMDsKfQoKLy8gQ2FsY3VsYXRlIGRpYWdvbmFsIHN1bXMgKG1haW4gYW5kIGFudGktZGlhZ29uYWwpCmZuIGNhbGN1bGF0ZURpYWdvbmFsU3VtcyhtYXRyaXg6ICZbaTMyOyAxMDBdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IG1haW5fZGlhZ29uYWxfc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBhbnRpX2RpYWdvbmFsX3N1bTogaTMyID0gMDsKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBtYWluX2RpYWdvbmFsX3N1bSA9IG1haW5fZGlhZ29uYWxfc3VtICsgbWF0cml4WyhpICogc2l6ZSArIGkpIGFzIHVzaXplXTsKICAgICAgICBhbnRpX2RpYWdvbmFsX3N1bSA9IGFudGlfZGlhZ29uYWxfc3VtICsgbWF0cml4WyhpICogc2l6ZSArIChzaXplIC0gMSAtIGkpKSBhcyB1c2l6ZV07CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHJldHVybiBtYWluX2RpYWdvbmFsX3N1bSArIGFudGlfZGlhZ29uYWxfc3VtOwp9CgovLyBDYWxjdWxhdGUgbWF0cml4IHRyYWNlIChzdW0gb2YgZGlhZ29uYWwgZWxlbWVudHMpCmZuIGNhbGN1bGF0ZU1hdHJpeFRyYWNlKG1hdHJpeDogJltpMzI7IDEwMF0sIHNpemU6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgdHJhY2U6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICB0cmFjZSA9IHRyYWNlICsgbWF0cml4WyhpICogc2l6ZSArIGkpIGFzIHVzaXplXTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICByZXR1cm4gdHJhY2U7Cn0KCi8vIENhbGN1bGF0ZSBtYXRyaXggbm9ybSAoRnJvYmVuaXVzIG5vcm0pCmZuIGNhbGN1bGF0ZU1hdHJpeE5vcm0obWF0cml4OiAmW2kzMjsgMTAwXSwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBub3JtX3NxdWFyZWQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUgKiBzaXplKSB7CiAgICAgICAgbm9ybV9zcXVhcmVkID0gbm9ybV9zcXVhcmVkICsgbWF0cml4W2kgYXMgdXNpemVdICogbWF0cml4W2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBSZXR1cm4gYXBwcm94aW1hdGUgc3F1YXJlIHJvb3QKICAgIHJldHVybiBhcHByb3hpbWF0ZVNxdWFyZVJvb3Qobm9ybV9zcXVhcmVkKTsKfQoKLy8gQXBwcm94aW1hdGUgc3F1YXJlIHJvb3QgdXNpbmcgYmluYXJ5IHNlYXJjaApmbiBhcHByb3hpbWF0ZVNxdWFyZVJvb3QodmFsdWU6IGkzMikgLT4gaTMyIHsKICAgIGlmICh2YWx1ZSA8PSAxKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQoKICAgIGxldCBtdXQgbGVmdDogaTMyID0gMTsKICAgIGxldCBtdXQgcmlnaHQ6IGkzMiA9IHZhbHVlOwogICAgbGV0IG11dCByZXN1bHQ6IGkzMiA9IDE7CgogICAgd2hpbGUgKGxlZnQgPD0gcmlnaHQpIHsKICAgICAgICBsZXQgbWlkOiBpMzIgPSBsZWZ0ICsgKHJpZ2h0IC0gbGVmdCkgLyAyOwoKICAgICAgICBpZiAobWlkIDw9IHZhbHVlIC8gbWlkKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IG1pZDsKICAgICAgICAgICAgbGVmdCA9IG1pZCArIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmlnaHQgPSBtaWQgLSAxOwogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcmVzdWx0Owp9CgovLyBIZWxwZXIgZnVuY3Rpb24gZm9yIGFic29sdXRlIHZhbHVlCmZuIGFic1ZhbHVlKHZhbHVlOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAodmFsdWUgPCAwKSB7CiAgICAgICAgcmV0dXJuIC12YWx1ZTsKICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQp9CgovLyBTcGFyc2UgbWF0cml4IG9wZXJhdGlvbnMKZm4gcGVyZm9ybVNwYXJzZU1hdHJpeE9wZXJhdGlvbnMoKSB7CiAgICBwcmludGxuSW50KDE3MjApOyAvLyBTcGFyc2UgbWF0cml4IHN0YXJ0CgogICAgLy8gU3BhcnNlIG1hdHJpeCByZXByZXNlbnRhdGlvbjogW3JvdywgY29sLCB2YWx1ZV0gdHJpcGxldHMKICAgIC8vIFVzaW5nIGNvb3JkaW5hdGUgKENPTykgZm9ybWF0IGZvciBzaW1wbGljaXR5CiAgICBsZXQgbXV0IHNwYXJzZV9yb3dzOiBbaTMyOyAyMDBdID0gWzA7IDIwMF07IC8vIFJvdyBpbmRpY2VzCiAgICBsZXQgbXV0IHNwYXJzZV9jb2xzOiBbaTMyOyAyMDBdID0gWzA7IDIwMF07IC8vIENvbHVtbiBpbmRpY2VzICAKICAgIGxldCBtdXQgc3BhcnNlX3ZhbHVlczogW2kzMjsgMjAwXSA9IFswOyAyMDBdOyAvLyBWYWx1ZXMKICAgIGxldCBtdXQgc3BhcnNlX2NvdW50OiBpMzIgPSAwOyAvLyBOdW1iZXIgb2Ygbm9uLXplcm8gZWxlbWVudHMKCiAgICAvLyBDcmVhdGUgc3BhcnNlIG1hdHJpeCB3aXRoIHJhbmRvbSBub24temVybyBlbGVtZW50cwogICAgc3BhcnNlX2NvdW50ID0gY3JlYXRlU3BhcnNlTWF0cml4KCZtdXQgc3BhcnNlX3Jvd3MsICZtdXQgc3BhcnNlX2NvbHMsICZtdXQgc3BhcnNlX3ZhbHVlcyk7CiAgICBwcmludGxuSW50KHNwYXJzZV9jb3VudCk7CgogICAgLy8gVGVzdCAxOiBTcGFyc2UgbWF0cml4IGFkZGl0aW9uCiAgICBwcmludGxuSW50KDE3MjEpOyAvLyBTcGFyc2UgYWRkaXRpb24gbWFya2VyCiAgICBsZXQgbXV0IHNwYXJzZTJfcm93czogW2kzMjsgMjAwXSA9IFswOyAyMDBdOwogICAgbGV0IG11dCBzcGFyc2UyX2NvbHM6IFtpMzI7IDIwMF0gPSBbMDsgMjAwXTsKICAgIGxldCBtdXQgc3BhcnNlMl92YWx1ZXM6IFtpMzI7IDIwMF0gPSBbMDsgMjAwXTsKICAgIGxldCBzcGFyc2UyX2NvdW50OiBpMzIgPQogICAgICAgIGNyZWF0ZVNwYXJzZU1hdHJpeDIoJm11dCBzcGFyc2UyX3Jvd3MsICZtdXQgc3BhcnNlMl9jb2xzLCAmbXV0IHNwYXJzZTJfdmFsdWVzKTsKCiAgICBsZXQgbXV0IHJlc3VsdF9yb3dzOiBbaTMyOyA0MDBdID0gWzA7IDQwMF07CiAgICBsZXQgbXV0IHJlc3VsdF9jb2xzOiBbaTMyOyA0MDBdID0gWzA7IDQwMF07CiAgICBsZXQgbXV0IHJlc3VsdF92YWx1ZXM6IFtpMzI7IDQwMF0gPSBbMDsgNDAwXTsKICAgIGxldCByZXN1bHRfY291bnQ6IGkzMiA9IHNwYXJzZU1hdHJpeEFkZGl0aW9uKAogICAgICAgICZtdXQgc3BhcnNlX3Jvd3MsCiAgICAgICAgJm11dCBzcGFyc2VfY29scywKICAgICAgICAmbXV0IHNwYXJzZV92YWx1ZXMsCiAgICAgICAgc3BhcnNlX2NvdW50LAogICAgICAgICZtdXQgc3BhcnNlMl9yb3dzLAogICAgICAgICZtdXQgc3BhcnNlMl9jb2xzLAogICAgICAgICZtdXQgc3BhcnNlMl92YWx1ZXMsCiAgICAgICAgc3BhcnNlMl9jb3VudCwKICAgICAgICAmbXV0IHJlc3VsdF9yb3dzLAogICAgICAgICZtdXQgcmVzdWx0X2NvbHMsCiAgICAgICAgJm11dCByZXN1bHRfdmFsdWVzLAogICAgKTsKICAgIHByaW50bG5JbnQocmVzdWx0X2NvdW50KTsKCiAgICAvLyBUZXN0IDI6IFNwYXJzZSBtYXRyaXggdHJhbnNwb3NlCiAgICBwcmludGxuSW50KDE3MjIpOyAvLyBTcGFyc2UgdHJhbnNwb3NlIG1hcmtlcgogICAgbGV0IG11dCB0cmFuc3Bvc2Vfcm93czogW2kzMjsgMjAwXSA9IFswOyAyMDBdOwogICAgbGV0IG11dCB0cmFuc3Bvc2VfY29sczogW2kzMjsgMjAwXSA9IFswOyAyMDBdOwogICAgbGV0IG11dCB0cmFuc3Bvc2VfdmFsdWVzOiBbaTMyOyAyMDBdID0gWzA7IDIwMF07CiAgICBzcGFyc2VNYXRyaXhUcmFuc3Bvc2UoCiAgICAgICAgJm11dCBzcGFyc2Vfcm93cywKICAgICAgICAmbXV0IHNwYXJzZV9jb2xzLAogICAgICAgICZtdXQgc3BhcnNlX3ZhbHVlcywKICAgICAgICBzcGFyc2VfY291bnQsCiAgICAgICAgJm11dCB0cmFuc3Bvc2Vfcm93cywKICAgICAgICAmbXV0IHRyYW5zcG9zZV9jb2xzLAogICAgICAgICZtdXQgdHJhbnNwb3NlX3ZhbHVlcywKICAgICk7CgogICAgbGV0IHRyYW5zcG9zZV9zdW06IGkzMiA9IGNhbGN1bGF0ZVNwYXJzZVN1bSgmbXV0IHRyYW5zcG9zZV92YWx1ZXMsIHNwYXJzZV9jb3VudCk7CiAgICBwcmludGxuSW50KHRyYW5zcG9zZV9zdW0pOwoKICAgIC8vIFRlc3QgMzogU3BhcnNlIG1hdHJpeCBtdWx0aXBsaWNhdGlvbgogICAgcHJpbnRsbkludCgxNzIzKTsgLy8gU3BhcnNlIG11bHRpcGxpY2F0aW9uIG1hcmtlcgogICAgbGV0IG11bHRfcmVzdWx0OiBpMzIgPSBzcGFyc2VNYXRyaXhNdWx0aXBsaWNhdGlvbigKICAgICAgICAmbXV0IHNwYXJzZV9yb3dzLAogICAgICAgICZtdXQgc3BhcnNlX2NvbHMsCiAgICAgICAgJm11dCBzcGFyc2VfdmFsdWVzLAogICAgICAgIHNwYXJzZV9jb3VudCwKICAgICAgICAmbXV0IHRyYW5zcG9zZV9yb3dzLAogICAgICAgICZtdXQgdHJhbnNwb3NlX2NvbHMsCiAgICAgICAgJm11dCB0cmFuc3Bvc2VfdmFsdWVzLAogICAgICAgIHNwYXJzZV9jb3VudCwKICAgICk7CiAgICBwcmludGxuSW50KG11bHRfcmVzdWx0KTsKfQoKLy8gQ3JlYXRlIGZpcnN0IHNwYXJzZSBtYXRyaXgKZm4gY3JlYXRlU3BhcnNlTWF0cml4KAogICAgcm93czogJm11dCBbaTMyOyAyMDBdLAogICAgY29sczogJm11dCBbaTMyOyAyMDBdLAogICAgdmFsdWVzOiAmbXV0IFtpMzI7IDIwMF0sCikgLT4gaTMyIHsKICAgIGxldCBtdXQgY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbWF0cml4X3NpemU6IGkzMiA9IDMwOyAvLyAzMHgzMCBzcGFyc2UgbWF0cml4CgogICAgLy8gQ3JlYXRlIHBhdHRlcm46IGRpYWdvbmFsIGFuZCBzb21lIHJhbmRvbSBlbGVtZW50cwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBtYXRyaXhfc2l6ZSAmJiBjb3VudCA8IDIwMCkgewogICAgICAgIC8vIE1haW4gZGlhZ29uYWwKICAgICAgICByb3dzW2NvdW50IGFzIHVzaXplXSA9IGk7CiAgICAgICAgY29sc1tjb3VudCBhcyB1c2l6ZV0gPSBpOwogICAgICAgIHZhbHVlc1tjb3VudCBhcyB1c2l6ZV0gPSBpICsgMTA7CiAgICAgICAgY291bnQgPSBjb3VudCArIDE7CgogICAgICAgIC8vIFN1cGVyIGRpYWdvbmFsIChpZiBleGlzdHMpCiAgICAgICAgaWYgKGkgKyAxIDwgbWF0cml4X3NpemUgJiYgY291bnQgPCAyMDApIHsKICAgICAgICAgICAgcm93c1tjb3VudCBhcyB1c2l6ZV0gPSBpOwogICAgICAgICAgICBjb2xzW2NvdW50IGFzIHVzaXplXSA9IGkgKyAxOwogICAgICAgICAgICB2YWx1ZXNbY291bnQgYXMgdXNpemVdID0gaSArIDU7CiAgICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxOwogICAgICAgIH0KCiAgICAgICAgLy8gU29tZSBzY2F0dGVyZWQgZWxlbWVudHMKICAgICAgICBpZiAoaSAlIDMgPT0gMCAmJiBpICsgNSA8IG1hdHJpeF9zaXplICYmIGNvdW50IDwgMjAwKSB7CiAgICAgICAgICAgIHJvd3NbY291bnQgYXMgdXNpemVdID0gaTsKICAgICAgICAgICAgY29sc1tjb3VudCBhcyB1c2l6ZV0gPSBpICsgNTsKICAgICAgICAgICAgdmFsdWVzW2NvdW50IGFzIHVzaXplXSA9IGkgKiAyOwogICAgICAgICAgICBjb3VudCA9IGNvdW50ICsgMTsKICAgICAgICB9CgogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gY291bnQ7Cn0KCi8vIENyZWF0ZSBzZWNvbmQgc3BhcnNlIG1hdHJpeCBmb3Igb3BlcmF0aW9ucwpmbiBjcmVhdGVTcGFyc2VNYXRyaXgyKAogICAgcm93czogJm11dCBbaTMyOyAyMDBdLAogICAgY29sczogJm11dCBbaTMyOyAyMDBdLAogICAgdmFsdWVzOiAmbXV0IFtpMzI7IDIwMF0sCikgLT4gaTMyIHsKICAgIGxldCBtdXQgY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbWF0cml4X3NpemU6IGkzMiA9IDMwOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbWF0cml4X3NpemUgJiYgY291bnQgPCAyMDApIHsKICAgICAgICAvLyBBbnRpLWRpYWdvbmFsIHBhdHRlcm4KICAgICAgICBpZiAoaSArIGkgPCBtYXRyaXhfc2l6ZSAmJiBjb3VudCA8IDIwMCkgewogICAgICAgICAgICByb3dzW2NvdW50IGFzIHVzaXplXSA9IGk7CiAgICAgICAgICAgIGNvbHNbY291bnQgYXMgdXNpemVdID0gbWF0cml4X3NpemUgLSAxIC0gaTsKICAgICAgICAgICAgdmFsdWVzW2NvdW50IGFzIHVzaXplXSA9IGkgKyAzOwogICAgICAgICAgICBjb3VudCA9IGNvdW50ICsgMTsKICAgICAgICB9CgogICAgICAgIC8vIFNvbWUgb3RoZXIgcGF0dGVybgogICAgICAgIGlmIChpICUgNCA9PSAwICYmIGNvdW50IDwgMjAwKSB7CiAgICAgICAgICAgIHJvd3NbY291bnQgYXMgdXNpemVdID0gaTsKICAgICAgICAgICAgY29sc1tjb3VudCBhcyB1c2l6ZV0gPSBpIC8gMjsKICAgICAgICAgICAgdmFsdWVzW2NvdW50IGFzIHVzaXplXSA9IGkgKiAzOwogICAgICAgICAgICBjb3VudCA9IGNvdW50ICsgMTsKICAgICAgICB9CgogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gY291bnQ7Cn0KCi8vIFNwYXJzZSBtYXRyaXggYWRkaXRpb24KZm4gc3BhcnNlTWF0cml4QWRkaXRpb24oCiAgICByb3dzMTogJm11dCBbaTMyOyAyMDBdLAogICAgY29sczE6ICZtdXQgW2kzMjsgMjAwXSwKICAgIHZhbHVlczE6ICZtdXQgW2kzMjsgMjAwXSwKICAgIGNvdW50MTogaTMyLAogICAgcm93czI6ICZtdXQgW2kzMjsgMjAwXSwKICAgIGNvbHMyOiAmbXV0IFtpMzI7IDIwMF0sCiAgICB2YWx1ZXMyOiAmbXV0IFtpMzI7IDIwMF0sCiAgICBjb3VudDI6IGkzMiwKICAgIHJlc3VsdF9yb3dzOiAmbXV0IFtpMzI7IDQwMF0sCiAgICByZXN1bHRfY29sczogJm11dCBbaTMyOyA0MDBdLAogICAgcmVzdWx0X3ZhbHVlczogJm11dCBbaTMyOyA0MDBdLAopIC0+IGkzMiB7CiAgICBsZXQgbXV0IHJlc3VsdF9jb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgaTE6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGkyOiBpMzIgPSAwOwoKICAgIC8vIE1lcmdlIHRoZSB0d28gc3BhcnNlIG1hdHJpY2VzCiAgICB3aGlsZSAoaTEgPCBjb3VudDEgJiYgaTIgPCBjb3VudDIgJiYgcmVzdWx0X2NvdW50IDwgNDAwKSB7CiAgICAgICAgbGV0IHBvczE6IGkzMiA9IHJvd3MxW2kxIGFzIHVzaXplXSAqIDEwMCArIGNvbHMxW2kxIGFzIHVzaXplXTsgLy8gTGluZWFyaXplIHBvc2l0aW9uCiAgICAgICAgbGV0IHBvczI6IGkzMiA9IHJvd3MyW2kyIGFzIHVzaXplXSAqIDEwMCArIGNvbHMyW2kyIGFzIHVzaXplXTsKCiAgICAgICAgaWYgKHBvczEgPCBwb3MyKSB7CiAgICAgICAgICAgIHJlc3VsdF9yb3dzW3Jlc3VsdF9jb3VudCBhcyB1c2l6ZV0gPSByb3dzMVtpMSBhcyB1c2l6ZV07CiAgICAgICAgICAgIHJlc3VsdF9jb2xzW3Jlc3VsdF9jb3VudCBhcyB1c2l6ZV0gPSBjb2xzMVtpMSBhcyB1c2l6ZV07CiAgICAgICAgICAgIHJlc3VsdF92YWx1ZXNbcmVzdWx0X2NvdW50IGFzIHVzaXplXSA9IHZhbHVlczFbaTEgYXMgdXNpemVdOwogICAgICAgICAgICByZXN1bHRfY291bnQgPSByZXN1bHRfY291bnQgKyAxOwogICAgICAgICAgICBpMSA9IGkxICsgMTsKICAgICAgICB9IGVsc2UgaWYgKHBvczEgPiBwb3MyKSB7CiAgICAgICAgICAgIHJlc3VsdF9yb3dzW3Jlc3VsdF9jb3VudCBhcyB1c2l6ZV0gPSByb3dzMltpMiBhcyB1c2l6ZV07CiAgICAgICAgICAgIHJlc3VsdF9jb2xzW3Jlc3VsdF9jb3VudCBhcyB1c2l6ZV0gPSBjb2xzMltpMiBhcyB1c2l6ZV07CiAgICAgICAgICAgIHJlc3VsdF92YWx1ZXNbcmVzdWx0X2NvdW50IGFzIHVzaXplXSA9IHZhbHVlczJbaTIgYXMgdXNpemVdOwogICAgICAgICAgICByZXN1bHRfY291bnQgPSByZXN1bHRfY291bnQgKyAxOwogICAgICAgICAgICBpMiA9IGkyICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBTYW1lIHBvc2l0aW9uIC0gYWRkIHZhbHVlcwogICAgICAgICAgICByZXN1bHRfcm93c1tyZXN1bHRfY291bnQgYXMgdXNpemVdID0gcm93czFbaTEgYXMgdXNpemVdOwogICAgICAgICAgICByZXN1bHRfY29sc1tyZXN1bHRfY291bnQgYXMgdXNpemVdID0gY29sczFbaTEgYXMgdXNpemVdOwogICAgICAgICAgICByZXN1bHRfdmFsdWVzW3Jlc3VsdF9jb3VudCBhcyB1c2l6ZV0gPSB2YWx1ZXMxW2kxIGFzIHVzaXplXSArIHZhbHVlczJbaTIgYXMgdXNpemVdOwogICAgICAgICAgICByZXN1bHRfY291bnQgPSByZXN1bHRfY291bnQgKyAxOwogICAgICAgICAgICBpMSA9IGkxICsgMTsKICAgICAgICAgICAgaTIgPSBpMiArIDE7CiAgICAgICAgfQogICAgfQoKICAgIC8vIEFkZCByZW1haW5pbmcgZWxlbWVudHMgZnJvbSBmaXJzdCBtYXRyaXgKICAgIHdoaWxlIChpMSA8IGNvdW50MSAmJiByZXN1bHRfY291bnQgPCA0MDApIHsKICAgICAgICByZXN1bHRfcm93c1tyZXN1bHRfY291bnQgYXMgdXNpemVdID0gcm93czFbaTEgYXMgdXNpemVdOwogICAgICAgIHJlc3VsdF9jb2xzW3Jlc3VsdF9jb3VudCBhcyB1c2l6ZV0gPSBjb2xzMVtpMSBhcyB1c2l6ZV07CiAgICAgICAgcmVzdWx0X3ZhbHVlc1tyZXN1bHRfY291bnQgYXMgdXNpemVdID0gdmFsdWVzMVtpMSBhcyB1c2l6ZV07CiAgICAgICAgcmVzdWx0X2NvdW50ID0gcmVzdWx0X2NvdW50ICsgMTsKICAgICAgICBpMSA9IGkxICsgMTsKICAgIH0KCiAgICAvLyBBZGQgcmVtYWluaW5nIGVsZW1lbnRzIGZyb20gc2Vjb25kIG1hdHJpeAogICAgd2hpbGUgKGkyIDwgY291bnQyICYmIHJlc3VsdF9jb3VudCA8IDQwMCkgewogICAgICAgIHJlc3VsdF9yb3dzW3Jlc3VsdF9jb3VudCBhcyB1c2l6ZV0gPSByb3dzMltpMiBhcyB1c2l6ZV07CiAgICAgICAgcmVzdWx0X2NvbHNbcmVzdWx0X2NvdW50IGFzIHVzaXplXSA9IGNvbHMyW2kyIGFzIHVzaXplXTsKICAgICAgICByZXN1bHRfdmFsdWVzW3Jlc3VsdF9jb3VudCBhcyB1c2l6ZV0gPSB2YWx1ZXMyW2kyIGFzIHVzaXplXTsKICAgICAgICByZXN1bHRfY291bnQgPSByZXN1bHRfY291bnQgKyAxOwogICAgICAgIGkyID0gaTIgKyAxOwogICAgfQoKICAgIHJldHVybiByZXN1bHRfY291bnQ7Cn0KCi8vIFNwYXJzZSBtYXRyaXggdHJhbnNwb3NlCmZuIHNwYXJzZU1hdHJpeFRyYW5zcG9zZSgKICAgIHJvd3M6ICZtdXQgW2kzMjsgMjAwXSwKICAgIGNvbHM6ICZtdXQgW2kzMjsgMjAwXSwKICAgIHZhbHVlczogJm11dCBbaTMyOyAyMDBdLAogICAgY291bnQ6IGkzMiwKICAgIHRyYW5zX3Jvd3M6ICZtdXQgW2kzMjsgMjAwXSwKICAgIHRyYW5zX2NvbHM6ICZtdXQgW2kzMjsgMjAwXSwKICAgIHRyYW5zX3ZhbHVlczogJm11dCBbaTMyOyAyMDBdLAopIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgY291bnQpIHsKICAgICAgICB0cmFuc19yb3dzW2kgYXMgdXNpemVdID0gY29sc1tpIGFzIHVzaXplXTsgLy8gU3dhcCByb3cgYW5kIGNvbHVtbgogICAgICAgIHRyYW5zX2NvbHNbaSBhcyB1c2l6ZV0gPSByb3dzW2kgYXMgdXNpemVdOwogICAgICAgIHRyYW5zX3ZhbHVlc1tpIGFzIHVzaXplXSA9IHZhbHVlc1tpIGFzIHVzaXplXTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gU29ydCBieSBuZXcgcm93LCB0aGVuIGJ5IG5ldyBjb2x1bW4gKHNpbXBsZSBidWJibGUgc29ydCBmb3IgdGhpcyBpbXBsZW1lbnRhdGlvbikKICAgIGxldCBtdXQgc3dhcHBlZDogaTMyID0gMTsKICAgIHdoaWxlIChzd2FwcGVkID09IDEpIHsKICAgICAgICBzd2FwcGVkID0gMDsKICAgICAgICBpID0gMDsKICAgICAgICB3aGlsZSAoaSA8IGNvdW50IC0gMSkgewogICAgICAgICAgICBsZXQgcG9zMTogaTMyID0gdHJhbnNfcm93c1tpIGFzIHVzaXplXSAqIDEwMCArIHRyYW5zX2NvbHNbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGxldCBwb3MyOiBpMzIgPSB0cmFuc19yb3dzW2kgYXMgdXNpemUgKyAxXSAqIDEwMCArIHRyYW5zX2NvbHNbaSBhcyB1c2l6ZSArIDFdOwoKICAgICAgICAgICAgaWYgKHBvczEgPiBwb3MyKSB7CiAgICAgICAgICAgICAgICAvLyBTd2FwIGVsZW1lbnRzCiAgICAgICAgICAgICAgICBsZXQgdGVtcF9yb3c6IGkzMiA9IHRyYW5zX3Jvd3NbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBsZXQgdGVtcF9jb2w6IGkzMiA9IHRyYW5zX2NvbHNbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBsZXQgdGVtcF92YWw6IGkzMiA9IHRyYW5zX3ZhbHVlc1tpIGFzIHVzaXplXTsKCiAgICAgICAgICAgICAgICB0cmFuc19yb3dzW2kgYXMgdXNpemVdID0gdHJhbnNfcm93c1tpIGFzIHVzaXplICsgMV07CiAgICAgICAgICAgICAgICB0cmFuc19jb2xzW2kgYXMgdXNpemVdID0gdHJhbnNfY29sc1tpIGFzIHVzaXplICsgMV07CiAgICAgICAgICAgICAgICB0cmFuc192YWx1ZXNbaSBhcyB1c2l6ZV0gPSB0cmFuc192YWx1ZXNbaSBhcyB1c2l6ZSArIDFdOwoKICAgICAgICAgICAgICAgIHRyYW5zX3Jvd3NbaSBhcyB1c2l6ZSArIDFdID0gdGVtcF9yb3c7CiAgICAgICAgICAgICAgICB0cmFuc19jb2xzW2kgYXMgdXNpemUgKyAxXSA9IHRlbXBfY29sOwogICAgICAgICAgICAgICAgdHJhbnNfdmFsdWVzW2kgYXMgdXNpemUgKyAxXSA9IHRlbXBfdmFsOwoKICAgICAgICAgICAgICAgIHN3YXBwZWQgPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICB9Cn0KCi8vIENhbGN1bGF0ZSBzdW0gb2Ygc3BhcnNlIG1hdHJpeCB2YWx1ZXMKZm4gY2FsY3VsYXRlU3BhcnNlU3VtKHZhbHVlczogJm11dCBbaTMyOyAyMDBdLCBjb3VudDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IGNvdW50KSB7CiAgICAgICAgc3VtID0gc3VtICsgdmFsdWVzW2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJldHVybiBzdW0gJSAxMDAwMDA7Cn0KCi8vIFNpbXBsaWZpZWQgc3BhcnNlIG1hdHJpeCBtdWx0aXBsaWNhdGlvbiAocmV0dXJucyBzdW0gb2YgcmVzdWx0KQpmbiBzcGFyc2VNYXRyaXhNdWx0aXBsaWNhdGlvbigKICAgIHJvd3MxOiAmbXV0IFtpMzI7IDIwMF0sCiAgICBjb2xzMTogJm11dCBbaTMyOyAyMDBdLAogICAgdmFsdWVzMTogJm11dCBbaTMyOyAyMDBdLAogICAgY291bnQxOiBpMzIsCiAgICByb3dzMjogJm11dCBbaTMyOyAyMDBdLAogICAgY29sczI6ICZtdXQgW2kzMjsgMjAwXSwKICAgIHZhbHVlczI6ICZtdXQgW2kzMjsgMjAwXSwKICAgIGNvdW50MjogaTMyLAopIC0+IGkzMiB7CiAgICBsZXQgbXV0IHJlc3VsdF9zdW06IGkzMiA9IDA7CgogICAgLy8gRm9yIGVhY2ggbm9uLXplcm8gZWxlbWVudCBpbiBmaXJzdCBtYXRyaXgKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgY291bnQxKSB7CiAgICAgICAgbGV0IHJvdzogaTMyID0gcm93czFbaSBhcyB1c2l6ZV07CiAgICAgICAgbGV0IG1pZF9jb2w6IGkzMiA9IGNvbHMxW2kgYXMgdXNpemVdOwogICAgICAgIGxldCB2YWwxOiBpMzIgPSB2YWx1ZXMxW2kgYXMgdXNpemVdOwoKICAgICAgICAvLyBGaW5kIG1hdGNoaW5nIGVsZW1lbnRzIGluIHNlY29uZCBtYXRyaXgKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBjb3VudDIpIHsKICAgICAgICAgICAgaWYgKHJvd3MyW2ogYXMgdXNpemVdID09IG1pZF9jb2wpIHsKICAgICAgICAgICAgICAgIGxldCBjb2w6IGkzMiA9IGNvbHMyW2ogYXMgdXNpemVdOwogICAgICAgICAgICAgICAgbGV0IHZhbDI6IGkzMiA9IHZhbHVlczJbaiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICByZXN1bHRfc3VtID0gcmVzdWx0X3N1bSArIHZhbDEgKiB2YWwyOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CgogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0X3N1bSAlIDEwMDAwMDsKfQoKLy8gTWF0cml4IHBlcmZvcm1hbmNlIGJlbmNobWFya3MKZm4gcGVyZm9ybU1hdHJpeFBlcmZvcm1hbmNlQmVuY2htYXJrcygpIHsKICAgIHByaW50bG5JbnQoMTczMCk7IC8vIFBlcmZvcm1hbmNlIGJlbmNobWFyayBzdGFydAoKICAgIC8vIEJlbmNobWFyayAxOiBMYXJnZSBtYXRyaXggb3BlcmF0aW9ucwogICAgcHJpbnRsbkludCgxNzMxKTsgLy8gTGFyZ2UgbWF0cml4IGJlbmNobWFyawogICAgcGVyZm9ybUxhcmdlTWF0cml4QmVuY2htYXJrKCk7CgogICAgLy8gQmVuY2htYXJrIDI6IFJlcGVhdGVkIG9wZXJhdGlvbnMKICAgIHByaW50bG5JbnQoMTczMik7IC8vIFJlcGVhdGVkIG9wZXJhdGlvbnMgYmVuY2htYXJrCiAgICBwZXJmb3JtUmVwZWF0ZWRPcGVyYXRpb25zQmVuY2htYXJrKCk7CgogICAgLy8gQmVuY2htYXJrIDM6IE1lbW9yeSBhY2Nlc3MgcGF0dGVybnMKICAgIHByaW50bG5JbnQoMTczMyk7IC8vIE1lbW9yeSBhY2Nlc3MgcGF0dGVybnMgYmVuY2htYXJrCiAgICBwZXJmb3JtTWVtb3J5QWNjZXNzQmVuY2htYXJrKCk7Cn0KCi8vIExhcmdlIG1hdHJpeCBvcGVyYXRpb25zIGJlbmNobWFyawpmbiBwZXJmb3JtTGFyZ2VNYXRyaXhCZW5jaG1hcmsoKSB7CiAgICBsZXQgbXV0IGxhcmdlX21hdHJpeF9hOiBbaTMyOyA2MjVdID0gWzA7IDYyNV07IC8vIDI1eDI1CiAgICBsZXQgbXV0IGxhcmdlX21hdHJpeF9iOiBbaTMyOyA2MjVdID0gWzA7IDYyNV07CiAgICBsZXQgbXV0IGxhcmdlX3Jlc3VsdDogW2kzMjsgNjI1XSA9IFswOyA2MjVdOwogICAgbGV0IGxhcmdlX3NpemU6IGkzMiA9IDI1OwoKICAgIC8vIEluaXRpYWxpemUgd2l0aCBjb21wbGV4IHBhdHRlcm5zCiAgICBpbml0aWFsaXplTGFyZ2VNYXRyaWNlcygmbXV0IGxhcmdlX21hdHJpeF9hLCAmbXV0IGxhcmdlX21hdHJpeF9iLCBsYXJnZV9zaXplKTsKCiAgICAvLyBQZXJmb3JtIG11bHRpcGxlIG9wZXJhdGlvbnMKICAgIGxldCBzdGFydF90aW1lOiBpMzIgPSAxMDAwOyAvLyBTaW11bGF0ZWQgdGltaW5nCgogICAgLy8gTXVsdGlwbGUgbWF0cml4IG11bHRpcGxpY2F0aW9ucwogICAgbGV0IG11dCByb3VuZDogaTMyID0gMDsKICAgIHdoaWxlIChyb3VuZCA8IDMpIHsKICAgICAgICBtYXRyaXhNdWx0aXBsaWNhdGlvbjYyNSgKICAgICAgICAgICAgJm11dCBsYXJnZV9tYXRyaXhfYSwKICAgICAgICAgICAgJm11dCBsYXJnZV9tYXRyaXhfYiwKICAgICAgICAgICAgJm11dCBsYXJnZV9yZXN1bHQsCiAgICAgICAgICAgIGxhcmdlX3NpemUsCiAgICAgICAgKTsKICAgICAgICBjb3B5TWF0cml4NjI1KCZtdXQgbGFyZ2VfcmVzdWx0LCAmbXV0IGxhcmdlX21hdHJpeF9hLCBsYXJnZV9zaXplKTsKICAgICAgICByb3VuZCA9IHJvdW5kICsgMTsKICAgIH0KCiAgICBsZXQgcmVzdWx0X3N1bTogaTMyID0gY2FsY3VsYXRlTWF0cml4U3VtNjI1KCZtdXQgbGFyZ2VfcmVzdWx0LCBsYXJnZV9zaXplKTsKICAgIHByaW50bG5JbnQocmVzdWx0X3N1bSk7Cn0KCi8vIEluaXRpYWxpemUgbGFyZ2UgbWF0cmljZXMKZm4gaW5pdGlhbGl6ZUxhcmdlTWF0cmljZXMobWF0cml4X2E6ICZtdXQgW2kzMjsgNjI1XSwgbWF0cml4X2I6ICZtdXQgW2kzMjsgNjI1XSwgc2l6ZTogaTMyKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgIGxldCBpbmRleDogaTMyID0gaSAqIHNpemUgKyBqOwogICAgICAgICAgICBtYXRyaXhfYVtpbmRleCBhcyB1c2l6ZV0gPSAoaSArIGopICUgMTAgKyAxOwogICAgICAgICAgICBtYXRyaXhfYltpbmRleCBhcyB1c2l6ZV0gPSAoaSAqIGopICUgNyArIDE7CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBNYXRyaXggbXVsdGlwbGljYXRpb24gZm9yIDI1eDI1IG1hdHJpY2VzCmZuIG1hdHJpeE11bHRpcGxpY2F0aW9uNjI1KAogICAgbWF0cml4X2E6ICZtdXQgW2kzMjsgNjI1XSwKICAgIG1hdHJpeF9iOiAmbXV0IFtpMzI7IDYyNV0sCiAgICByZXN1bHQ6ICZtdXQgW2kzMjsgNjI1XSwKICAgIHNpemU6IGkzMiwKKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgIHJlc3VsdFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChrIDwgc2l6ZSkgewogICAgICAgICAgICAgICAgcmVzdWx0WyhpICogc2l6ZSArIGopIGFzIHVzaXplXSA9IHJlc3VsdFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgICAgICArIG1hdHJpeF9hWyhpICogc2l6ZSArIGspIGFzIHVzaXplXSAqIG1hdHJpeF9iWyhrICogc2l6ZSArIGopIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGsgPSBrICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gQ29weSBtYXRyaXggZm9yIDI1eDI1IG1hdHJpY2VzCmZuIGNvcHlNYXRyaXg2MjUoc291cmNlOiAmbXV0IFtpMzI7IDYyNV0sIGRlc3Q6ICZtdXQgW2kzMjsgNjI1XSwgc2l6ZTogaTMyKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUgKiBzaXplKSB7CiAgICAgICAgZGVzdFtpIGFzIHVzaXplXSA9IHNvdXJjZVtpIGFzIHVzaXplXTsKICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIENhbGN1bGF0ZSBzdW0gZm9yIDI1eDI1IG1hdHJpeApmbiBjYWxjdWxhdGVNYXRyaXhTdW02MjUobWF0cml4OiAmbXV0IFtpMzI7IDYyNV0sIHNpemU6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBzaXplICogc2l6ZSkgewogICAgICAgIHN1bSA9IChzdW0gKyBtYXRyaXhbaSBhcyB1c2l6ZV0pICUgMTAwMDAwMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICByZXR1cm4gc3VtICUgMTAwMDAwMDsKfQoKLy8gUmVwZWF0ZWQgb3BlcmF0aW9ucyBiZW5jaG1hcmsKZm4gcGVyZm9ybVJlcGVhdGVkT3BlcmF0aW9uc0JlbmNobWFyaygpIHsKICAgIGxldCBtdXQgdGVzdF9tYXRyaXg6IFtpMzI7IDE0NF0gPSBbMDsgMTQ0XTsgLy8gMTJ4MTIKICAgIGxldCBtdXQgdGVtcF9tYXRyaXg6IFtpMzI7IDE0NF0gPSBbMDsgMTQ0XTsKICAgIGxldCBzaXplOiBpMzIgPSAxMjsKCiAgICAvLyBJbml0aWFsaXplCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUgKiBzaXplKSB7CiAgICAgICAgdGVzdF9tYXRyaXhbaSBhcyB1c2l6ZV0gPSAoaSAqIDMgKyA3KSAlIDIwOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBSZXBlYXRlZCB0cmFuc3Bvc2Ugb3BlcmF0aW9ucwogICAgbGV0IG11dCBvcGVyYXRpb25zOiBpMzIgPSAwOwogICAgd2hpbGUgKG9wZXJhdGlvbnMgPCAxMCkgewogICAgICAgIG1hdHJpeFRyYW5zcG9zZTE0NCgmbXV0IHRlc3RfbWF0cml4LCAmbXV0IHRlbXBfbWF0cml4LCBzaXplKTsKICAgICAgICBjb3B5TWF0cml4MTQ0KCZtdXQgdGVtcF9tYXRyaXgsICZtdXQgdGVzdF9tYXRyaXgsIHNpemUpOwogICAgICAgIG9wZXJhdGlvbnMgPSBvcGVyYXRpb25zICsgMTsKICAgIH0KCiAgICBsZXQgZmluYWxfc3VtOiBpMzIgPSBjYWxjdWxhdGVNYXRyaXhTdW0xNDQoJm11dCB0ZXN0X21hdHJpeCwgc2l6ZSk7CiAgICBwcmludGxuSW50KGZpbmFsX3N1bSk7Cn0KCi8vIE1hdHJpeCB0cmFuc3Bvc2UgZm9yIDEyeDEyCmZuIG1hdHJpeFRyYW5zcG9zZTE0NChtYXRyaXg6ICZtdXQgW2kzMjsgMTQ0XSwgcmVzdWx0OiAmbXV0IFtpMzI7IDE0NF0sIHNpemU6IGkzMikgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgc2l6ZSkgewogICAgICAgICAgICByZXN1bHRbKGogKiBzaXplICsgaSkgYXMgdXNpemVdID0gbWF0cml4WyhpICogc2l6ZSArIGopIGFzIHVzaXplXTsKICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIENvcHkgbWF0cml4IGZvciAxMngxMgpmbiBjb3B5TWF0cml4MTQ0KHNvdXJjZTogJm11dCBbaTMyOyAxNDRdLCBkZXN0OiAmbXV0IFtpMzI7IDE0NF0sIHNpemU6IGkzMikgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAxNDQpIHsKICAgICAgICBkZXN0W2kgYXMgdXNpemVdID0gc291cmNlW2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gQ2FsY3VsYXRlIHN1bSBmb3IgMTJ4MTIgbWF0cml4CmZuIGNhbGN1bGF0ZU1hdHJpeFN1bTE0NChtYXRyaXg6ICZtdXQgW2kzMjsgMTQ0XSwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUgKiBzaXplKSB7CiAgICAgICAgc3VtID0gc3VtICsgbWF0cml4W2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJldHVybiBzdW0gJSAxMDAwMDA7Cn0KCi8vIE1lbW9yeSBhY2Nlc3MgcGF0dGVybnMgYmVuY2htYXJrCmZuIHBlcmZvcm1NZW1vcnlBY2Nlc3NCZW5jaG1hcmsoKSB7CiAgICBsZXQgbXV0IGFjY2Vzc19tYXRyaXg6IFtpMzI7IDI1Nl0gPSBbMDsgMjU2XTsgLy8gMTZ4MTYKICAgIGxldCBzaXplOiBpMzIgPSAxNjsKCiAgICAvLyBJbml0aWFsaXplIG1hdHJpeAogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAyNTYpIHsKICAgICAgICBhY2Nlc3NfbWF0cml4W2kgYXMgdXNpemVdID0gaSArIDE7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIFRlc3QgZGlmZmVyZW50IGFjY2VzcyBwYXR0ZXJucwogICAgbGV0IHJvd19tYWpvcl9zdW06IGkzMiA9IHRlc3RSb3dNYWpvckFjY2VzcygmYWNjZXNzX21hdHJpeCwgc2l6ZSk7CiAgICBsZXQgY29sX21ham9yX3N1bTogaTMyID0gdGVzdENvbHVtbk1ham9yQWNjZXNzKCZhY2Nlc3NfbWF0cml4LCBzaXplKTsKICAgIGxldCBkaWFnb25hbF9zdW06IGkzMiA9IHRlc3REaWFnb25hbEFjY2VzcygmYWNjZXNzX21hdHJpeCwgc2l6ZSk7CiAgICBsZXQgcmFuZG9tX3N1bTogaTMyID0gdGVzdFJhbmRvbUFjY2VzcygmYWNjZXNzX21hdHJpeCwgc2l6ZSk7CgogICAgcHJpbnRsbkludChyb3dfbWFqb3Jfc3VtICsgY29sX21ham9yX3N1bSArIGRpYWdvbmFsX3N1bSArIHJhbmRvbV9zdW0pOwp9CgovLyBUZXN0IHJvdy1tYWpvciBhY2Nlc3MgcGF0dGVybgpmbiB0ZXN0Um93TWFqb3JBY2Nlc3MobWF0cml4OiAmW2kzMjsgMjU2XSwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgIHN1bSA9IHN1bSArIG1hdHJpeFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcmV0dXJuIHN1bSAlIDEwMDAwOwp9CgovLyBUZXN0IGNvbHVtbi1tYWpvciBhY2Nlc3MgcGF0dGVybgpmbiB0ZXN0Q29sdW1uTWFqb3JBY2Nlc3MobWF0cml4OiAmW2kzMjsgMjU2XSwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICB3aGlsZSAoaiA8IHNpemUpIHsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgICAgIHN1bSA9IHN1bSArIG1hdHJpeFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICAgICAgaiA9IGogKyAxOwogICAgfQogICAgcmV0dXJuIHN1bSAlIDEwMDAwOwp9CgovLyBUZXN0IGRpYWdvbmFsIGFjY2VzcyBwYXR0ZXJuCmZuIHRlc3REaWFnb25hbEFjY2VzcyhtYXRyaXg6ICZbaTMyOyAyNTZdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKCiAgICAvLyBNYWluIGRpYWdvbmFscwogICAgbGV0IG11dCBrOiBpMzIgPSAtKHNpemUgLSAxKTsKICAgIHdoaWxlIChrIDwgc2l6ZSkgewogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICAgICAgbGV0IGo6IGkzMiA9IGkgKyBrOwogICAgICAgICAgICBpZiAoaiA+PSAwICYmIGogPCBzaXplKSB7CiAgICAgICAgICAgICAgICBzdW0gPSBzdW0gKyBtYXRyaXhbKGkgKiBzaXplICsgaikgYXMgdXNpemVdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICAgICAgayA9IGsgKyAxOwogICAgfQoKICAgIHJldHVybiBzdW0gJSAxMDAwMDsKfQoKLy8gVGVzdCByYW5kb20gYWNjZXNzIHBhdHRlcm4KZm4gdGVzdFJhbmRvbUFjY2VzcyhtYXRyaXg6ICZbaTMyOyAyNTZdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIGxldCBtdXQgc2VlZDogaTMyID0gNzsKCiAgICBsZXQgbXV0IGFjY2Vzc19jb3VudDogaTMyID0gMDsKICAgIHdoaWxlIChhY2Nlc3NfY291bnQgPCAxMDApIHsKICAgICAgICAvLyBTaW1wbGUgcHNldWRvLXJhbmRvbSBudW1iZXIgZ2VuZXJhdGlvbgogICAgICAgIHNlZWQgPSAoc2VlZCAqIDE3ICsgNSkgJSAyNTE7CiAgICAgICAgbGV0IHJvdzogaTMyID0gc2VlZCAlIHNpemU7CiAgICAgICAgc2VlZCA9IChzZWVkICogMTMgKyAxMSkgJSAyNTE7CiAgICAgICAgbGV0IGNvbDogaTMyID0gc2VlZCAlIHNpemU7CgogICAgICAgIHN1bSA9IHN1bSArIG1hdHJpeFsocm93ICogc2l6ZSArIGNvbCkgYXMgdXNpemVdOwogICAgICAgIGFjY2Vzc19jb3VudCA9IGFjY2Vzc19jb3VudCArIDE7CiAgICB9CgogICAgcmV0dXJuIHN1bSAlIDEwMDAwOwp9CgovLyBUZXN0IGVkZ2UgY2FzZXMgYW5kIGJvdW5kYXJ5IGNvbmRpdGlvbnMKZm4gdGVzdE1hdHJpeEVkZ2VDYXNlcygpIHsKICAgIHByaW50bG5JbnQoMTc0MCk7IC8vIEVkZ2UgY2FzZXMgc3RhcnQKCiAgICAvLyBUZXN0IDE6IDF4MSBtYXRyaXggb3BlcmF0aW9ucwogICAgdGVzdFNpbmdsZUVsZW1lbnRNYXRyaXgoKTsKCiAgICAvLyBUZXN0IDI6IEVtcHR5IGFuZCBtaW5pbWFsIG1hdHJpY2VzCiAgICB0ZXN0TWluaW1hbE1hdHJpY2VzKCk7CgogICAgLy8gVGVzdCAzOiBCb3VuZGFyeSB2YWx1ZSBtYXRyaWNlcwogICAgdGVzdEJvdW5kYXJ5VmFsdWVNYXRyaWNlcygpOwoKICAgIC8vIFRlc3QgNDogT3ZlcmZsb3cgYW5kIHVuZGVyZmxvdyBjb25kaXRpb25zCiAgICB0ZXN0T3ZlcmZsb3dDb25kaXRpb25zKCk7CgogICAgcHJpbnRsbkludCgxNzQ5KTsgLy8gRWRnZSBjYXNlcyBlbmQKfQoKLy8gVGVzdCBzaW5nbGUgZWxlbWVudCBtYXRyaXgKZm4gdGVzdFNpbmdsZUVsZW1lbnRNYXRyaXgoKSB7CiAgICBsZXQgbXV0IHNpbmdsZV9tYXRyaXg6IFtpMzI7IDFdID0gWzQyXTsKICAgIGxldCBtdXQgcmVzdWx0X21hdHJpeDogW2kzMjsgMV0gPSBbMF07CgogICAgLy8gQWRkaXRpb24KICAgIHJlc3VsdF9tYXRyaXhbMF0gPSBzaW5nbGVfbWF0cml4WzBdICsgc2luZ2xlX21hdHJpeFswXTsKICAgIHByaW50bG5JbnQocmVzdWx0X21hdHJpeFswXSk7CgogICAgLy8gTXVsdGlwbGljYXRpb24KICAgIHJlc3VsdF9tYXRyaXhbMF0gPSBzaW5nbGVfbWF0cml4WzBdICogc2luZ2xlX21hdHJpeFswXTsKICAgIHByaW50bG5JbnQocmVzdWx0X21hdHJpeFswXSk7CgogICAgLy8gVHJhbnNwb3NlIChzaG91bGQgYmUgc2FtZSkKICAgIHJlc3VsdF9tYXRyaXhbMF0gPSBzaW5nbGVfbWF0cml4WzBdOwogICAgcHJpbnRsbkludChyZXN1bHRfbWF0cml4WzBdKTsKfQoKLy8gVGVzdCBtaW5pbWFsIG1hdHJpY2VzCmZuIHRlc3RNaW5pbWFsTWF0cmljZXMoKSB7CiAgICAvLyAyeDIgbWF0cml4IHRlc3RzCiAgICBsZXQgbXV0IG1hdHJpeDJ4MjogW2kzMjsgNF0gPSBbMSwgMiwgMywgNF07CiAgICBsZXQgbXV0IHJlc3VsdDJ4MjogW2kzMjsgNF0gPSBbMDsgNF07CgogICAgLy8gVHJhbnNwb3NlIDJ4MgogICAgcmVzdWx0MngyWzBdID0gbWF0cml4MngyWzBdOyAvLyBbMCwwXSAtPiBbMCwwXQogICAgcmVzdWx0MngyWzFdID0gbWF0cml4MngyWzJdOyAvLyBbMSwwXSAtPiBbMCwxXQogICAgcmVzdWx0MngyWzJdID0gbWF0cml4MngyWzFdOyAvLyBbMCwxXSAtPiBbMSwwXQogICAgcmVzdWx0MngyWzNdID0gbWF0cml4MngyWzNdOyAvLyBbMSwxXSAtPiBbMSwxXQoKICAgIGxldCB0cmFuc3Bvc2Vfc3VtOiBpMzIgPSByZXN1bHQyeDJbMF0gKyByZXN1bHQyeDJbMV0gKyByZXN1bHQyeDJbMl0gKyByZXN1bHQyeDJbM107CiAgICBwcmludGxuSW50KHRyYW5zcG9zZV9zdW0pOwoKICAgIC8vIDJ4MiBkZXRlcm1pbmFudAogICAgbGV0IGRldDJ4MjogaTMyID0gbWF0cml4MngyWzBdICogbWF0cml4MngyWzNdIC0gbWF0cml4MngyWzFdICogbWF0cml4MngyWzJdOwogICAgcHJpbnRsbkludChkZXQyeDIpOwp9CgovLyBUZXN0IGJvdW5kYXJ5IHZhbHVlIG1hdHJpY2VzCmZuIHRlc3RCb3VuZGFyeVZhbHVlTWF0cmljZXMoKSB7CiAgICAvLyBNYXRyaXggd2l0aCBsYXJnZSB2YWx1ZXMKICAgIGxldCBtdXQgbGFyZ2VfdmFsdWVfbWF0cml4OiBbaTMyOyA5XSA9IFswOyA5XTsKICAgIGxhcmdlX3ZhbHVlX21hdHJpeFswXSA9IDEwMDAwOwogICAgbGFyZ2VfdmFsdWVfbWF0cml4WzFdID0gLTEwMDAwOwogICAgbGFyZ2VfdmFsdWVfbWF0cml4WzJdID0gNTAwMDsKICAgIGxhcmdlX3ZhbHVlX21hdHJpeFszXSA9IC01MDAwOwogICAgbGFyZ2VfdmFsdWVfbWF0cml4WzRdID0gMjAwMDA7CiAgICBsYXJnZV92YWx1ZV9tYXRyaXhbNV0gPSAtMjAwMDA7CiAgICBsYXJnZV92YWx1ZV9tYXRyaXhbNl0gPSAxNTAwMDsKICAgIGxhcmdlX3ZhbHVlX21hdHJpeFs3XSA9IC0xNTAwMDsKICAgIGxhcmdlX3ZhbHVlX21hdHJpeFs4XSA9IDA7CgogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IDkpIHsKICAgICAgICBzdW0gPSBzdW0gKyBsYXJnZV92YWx1ZV9tYXRyaXhbaSBhcyB1c2l6ZV07CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcHJpbnRsbkludChzdW0pOwoKICAgIC8vIE1hdHJpeCB3aXRoIGFsbCB6ZXJvcwogICAgbGV0IG11dCB6ZXJvX21hdHJpeDogW2kzMjsgMTZdID0gWzA7IDE2XTsKICAgIGxldCB6ZXJvX3N1bTogaTMyID0gY2FsY3VsYXRlTWF0cml4U3VtMTYoJnplcm9fbWF0cml4KTsKICAgIHByaW50bG5JbnQoemVyb19zdW0pOwoKICAgIC8vIE1hdHJpeCB3aXRoIGFsbCBvbmVzCiAgICBsZXQgbXV0IG9uZXNfbWF0cml4OiBbaTMyOyAxNl0gPSBbMTsgMTZdOwogICAgbGV0IG9uZXNfc3VtOiBpMzIgPSBjYWxjdWxhdGVNYXRyaXhTdW0xNigmb25lc19tYXRyaXgpOwogICAgcHJpbnRsbkludChvbmVzX3N1bSk7Cn0KCi8vIENhbGN1bGF0ZSBzdW0gZm9yIDR4NCBtYXRyaXgKZm4gY2FsY3VsYXRlTWF0cml4U3VtMTYobWF0cml4OiAmW2kzMjsgMTZdKSAtPiBpMzIgewogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IDE2KSB7CiAgICAgICAgc3VtID0gc3VtICsgbWF0cml4W2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJldHVybiBzdW07Cn0KCi8vIFRlc3Qgb3ZlcmZsb3cgY29uZGl0aW9ucwpmbiB0ZXN0T3ZlcmZsb3dDb25kaXRpb25zKCkgewogICAgLy8gVGVzdCB3aXRoIHZhbHVlcyB0aGF0IG1pZ2h0IGNhdXNlIG92ZXJmbG93IGluIG11bHRpcGxpY2F0aW9uCiAgICBsZXQgbXV0IG92ZXJmbG93X21hdHJpeF9hOiBbaTMyOyA0XSA9IFsxMDAwLCAyMDAwLCAzMDAwLCA0MDAwXTsKICAgIGxldCBtdXQgb3ZlcmZsb3dfbWF0cml4X2I6IFtpMzI7IDRdID0gWzUwMDAsIDYwMDAsIDcwMDAsIDgwMDBdOwogICAgbGV0IG11dCBvdmVyZmxvd19yZXN1bHQ6IFtpMzI7IDRdID0gWzA7IDRdOwoKICAgIC8vIDJ4MiBtYXRyaXggbXVsdGlwbGljYXRpb24gd2l0aCBwb3RlbnRpYWwgb3ZlcmZsb3cKICAgIG92ZXJmbG93X3Jlc3VsdFswXSA9CiAgICAgICAgb3ZlcmZsb3dfbWF0cml4X2FbMF0gKiBvdmVyZmxvd19tYXRyaXhfYlswXSArIG92ZXJmbG93X21hdHJpeF9hWzFdICogb3ZlcmZsb3dfbWF0cml4X2JbMl07CiAgICBvdmVyZmxvd19yZXN1bHRbMV0gPQogICAgICAgIG92ZXJmbG93X21hdHJpeF9hWzBdICogb3ZlcmZsb3dfbWF0cml4X2JbMV0gKyBvdmVyZmxvd19tYXRyaXhfYVsxXSAqIG92ZXJmbG93X21hdHJpeF9iWzNdOwogICAgb3ZlcmZsb3dfcmVzdWx0WzJdID0KICAgICAgICBvdmVyZmxvd19tYXRyaXhfYVsyXSAqIG92ZXJmbG93X21hdHJpeF9iWzBdICsgb3ZlcmZsb3dfbWF0cml4X2FbM10gKiBvdmVyZmxvd19tYXRyaXhfYlsyXTsKICAgIG92ZXJmbG93X3Jlc3VsdFszXSA9CiAgICAgICAgb3ZlcmZsb3dfbWF0cml4X2FbMl0gKiBvdmVyZmxvd19tYXRyaXhfYlsxXSArIG92ZXJmbG93X21hdHJpeF9hWzNdICogb3ZlcmZsb3dfbWF0cml4X2JbM107CgogICAgLy8gUmVwb3J0IG1vZHVsbyByZXN1bHRzIHRvIHByZXZlbnQgYWN0dWFsIG92ZXJmbG93CiAgICBsZXQgc2FmZV9yZXN1bHQ6IGkzMiA9IChvdmVyZmxvd19yZXN1bHRbMF0gJSAxMDAwMDApCiAgICAgICAgKyAob3ZlcmZsb3dfcmVzdWx0WzFdICUgMTAwMDAwKQogICAgICAgICsgKG92ZXJmbG93X3Jlc3VsdFsyXSAlIDEwMDAwMCkKICAgICAgICArIChvdmVyZmxvd19yZXN1bHRbM10gJSAxMDAwMDApOwogICAgcHJpbnRsbkludChzYWZlX3Jlc3VsdCk7Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (18, "comprehensive18", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEFkdmFuY2VkIE1lbW9yeSBNYW5hZ2VtZW50IFNpbXVsYXRpb24KU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6CkNvbXBsZXggbWVtb3J5IGFsbG9jYXRpb24gYW5kIGRlYWxsb2NhdGlvbiBwYXR0ZXJucwpGcmFnbWVudGF0aW9uIGhhbmRsaW5nIGFuZCBtZW1vcnkgY29tcGFjdGlvbiBhbGdvcml0aG1zCkdhcmJhZ2UgY29sbGVjdGlvbiBzaW11bGF0aW9uIHdpdGggbWFyay1hbmQtc3dlZXAKTWVtb3J5IHBvb2wgbWFuYWdlbWVudCBhbmQgYnVkZHkgYWxsb2NhdGlvbiBzaW11bGF0aW9uCkNvbXBsZXggcG9pbnRlciBhcml0aG1ldGljIHNpbXVsYXRpb24gdXNpbmcgYXJyYXkgaW5kaWNlcwpFZGdlIGNhc2UgaGFuZGxpbmcgaW4gbWVtb3J5IG1hbmFnZW1lbnQgc2NlbmFyaW9zCiovCgovLyBjb21wcmVoZW5zaXZlMTgucnggLSBBZHZhbmNlZCBNZW1vcnkgTWFuYWdlbWVudCBTaW11bGF0aW9uCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIENvbXBsZXggbWVtb3J5IGFsbG9jYXRpb24gYW5kIGRlYWxsb2NhdGlvbiBwYXR0ZXJucwovLyAtIEZyYWdtZW50YXRpb24gaGFuZGxpbmcgYW5kIG1lbW9yeSBjb21wYWN0aW9uIGFsZ29yaXRobXMKLy8gLSBHYXJiYWdlIGNvbGxlY3Rpb24gc2ltdWxhdGlvbiB3aXRoIG1hcmstYW5kLXN3ZWVwCi8vIC0gTWVtb3J5IHBvb2wgbWFuYWdlbWVudCBhbmQgYnVkZHkgYWxsb2NhdGlvbiBzaW11bGF0aW9uCi8vIC0gQ29tcGxleCBwb2ludGVyIGFyaXRobWV0aWMgc2ltdWxhdGlvbiB1c2luZyBhcnJheSBpbmRpY2VzCi8vIC0gRWRnZSBjYXNlIGhhbmRsaW5nIGluIG1lbW9yeSBtYW5hZ2VtZW50IHNjZW5hcmlvcwoKZm4gbWFpbigpIHsKICAgIHByaW50bG5JbnQoMTgwMCk7IC8vIFRlc3Qgc3RhcnQgbWFya2VyCgogICAgLy8gSW5pdGlhbGl6ZSBhbmQgdGVzdCBtZW1vcnkgcG9vbCBtYW5hZ2VtZW50CiAgICBwZXJmb3JtTWVtb3J5UG9vbE9wZXJhdGlvbnMoKTsKCiAgICAvLyBUZXN0IGJ1ZGR5IGFsbG9jYXRpb24gc3lzdGVtIHNpbXVsYXRpb24KICAgIHBlcmZvcm1CdWRkeUFsbG9jYXRpb25UZXN0KCk7CgogICAgLy8gVGVzdCBnYXJiYWdlIGNvbGxlY3Rpb24gc2ltdWxhdGlvbgogICAgcGVyZm9ybUdhcmJhZ2VDb2xsZWN0aW9uVGVzdCgpOwoKICAgIC8vIFRlc3QgbWVtb3J5IGZyYWdtZW50YXRpb24gYW5kIGNvbXBhY3Rpb24KICAgIHBlcmZvcm1GcmFnbWVudGF0aW9uVGVzdCgpOwoKICAgIC8vIFRlc3QgZWRnZSBjYXNlcyBhbmQgc3RyZXNzIHNjZW5hcmlvcwogICAgdGVzdE1lbW9yeUVkZ2VDYXNlcygpOwoKICAgIHByaW50bG5JbnQoMTg5OSk7IC8vIFRlc3QgZW5kIG1hcmtlcgogICAgZXhpdCgwKTsKfQoKLy8gTWVtb3J5IHBvb2wgbWFuYWdlbWVudCB3aXRoIGRpZmZlcmVudCBhbGxvY2F0aW9uIHN0cmF0ZWdpZXMKZm4gcGVyZm9ybU1lbW9yeVBvb2xPcGVyYXRpb25zKCkgewogICAgcHJpbnRsbkludCgxODAxKTsgLy8gTWVtb3J5IHBvb2wgc3RhcnQKCiAgICAvLyBTaW11bGF0ZSBhIG1lbW9yeSBwb29sIHdpdGggbWV0YWRhdGEKICAgIC8vIExheW91dDogW3NpemUsIHN0YXR1cywgbmV4dF9mcmVlX2luZGV4LCBwcmV2X2ZyZWVfaW5kZXgsIC4uLmRhdGEuLi5dCiAgICAvLyBTdGF0dXM6IDA9ZnJlZSwgMT1hbGxvY2F0ZWQsIDI9bWFya2VkX2Zvcl9nYwogICAgbGV0IG11dCBtZW1vcnlfcG9vbDogW2kzMjsgMjAwMF0gPSBbMDsgMjAwMF07CiAgICBsZXQgbXV0IGZyZWVfbGlzdF9oZWFkOiBpMzIgPSAwOwogICAgbGV0IG11dCBhbGxvY2F0ZWRfYmxvY2tzOiBbaTMyOyAxMDBdID0gWzA7IDEwMF07IC8vIFRyYWNrIGFsbG9jYXRlZCBibG9jayBzdGFydHMKICAgIGxldCBtdXQgYWxsb2NhdGVkX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IHBvb2xfc2l6ZTogaTMyID0gMjAwMDsKCiAgICAvLyBJbml0aWFsaXplIG1lbW9yeSBwb29sIHdpdGggb25lIGxhcmdlIGZyZWUgYmxvY2sKICAgIGluaXRpYWxpemVNZW1vcnlQb29sKCZtdXQgbWVtb3J5X3Bvb2wsIHBvb2xfc2l6ZSk7CgogICAgLy8gVGVzdCAxOiBTZXF1ZW50aWFsIGFsbG9jYXRpb24gb2YgdmFyaW91cyBzaXplcwogICAgcHJpbnRsbkludCgxODAyKTsgLy8gU2VxdWVudGlhbCBhbGxvY2F0aW9uIG1hcmtlcgogICAgbGV0IG11dCBhbGxvY19zaXplOiBpMzIgPSA4OwogICAgd2hpbGUgKGFsbG9jX3NpemUgPD0gNjQgJiYgYWxsb2NhdGVkX2NvdW50IDwgMTAwKSB7CiAgICAgICAgbGV0IGFsbG9jYXRlZF9ibG9jazogaTMyID0gYWxsb2NhdGVCbG9jaygmbXV0IG1lbW9yeV9wb29sLCBmcmVlX2xpc3RfaGVhZCwgYWxsb2Nfc2l6ZSk7CiAgICAgICAgaWYgKGFsbG9jYXRlZF9ibG9jayAhPSAtMSkgewogICAgICAgICAgICBhbGxvY2F0ZWRfYmxvY2tzW2FsbG9jYXRlZF9jb3VudCBhcyB1c2l6ZV0gPSBhbGxvY2F0ZWRfYmxvY2s7CiAgICAgICAgICAgIGFsbG9jYXRlZF9jb3VudCA9IGFsbG9jYXRlZF9jb3VudCArIDE7CiAgICAgICAgICAgIGZyZWVfbGlzdF9oZWFkID0gZmluZEZyZWVMaXN0SGVhZCgmbWVtb3J5X3Bvb2wsIHBvb2xfc2l6ZSk7CiAgICAgICAgfQogICAgICAgIGFsbG9jX3NpemUgPSBhbGxvY19zaXplICsgODsKICAgIH0KICAgIHByaW50bG5JbnQoYWxsb2NhdGVkX2NvdW50KTsKCiAgICAvLyBUZXN0IDI6IFJhbmRvbSBkZWFsbG9jYXRpb24gcGF0dGVybgogICAgcHJpbnRsbkludCgxODAzKTsgLy8gUmFuZG9tIGRlYWxsb2NhdGlvbiBtYXJrZXIKICAgIGxldCBtdXQgZGVhbGxvY2F0ZWRfY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IGFsbG9jYXRlZF9jb3VudCkgewogICAgICAgIC8vIERlYWxsb2NhdGUgZXZlcnkgM3JkIGJsb2NrIHRvIGNyZWF0ZSBmcmFnbWVudGF0aW9uCiAgICAgICAgaWYgKGkgJSAzID09IDApIHsKICAgICAgICAgICAgbGV0IGJsb2NrX3N0YXJ0OiBpMzIgPSBhbGxvY2F0ZWRfYmxvY2tzW2kgYXMgdXNpemVdOwogICAgICAgICAgICBkZWFsbG9jYXRlQmxvY2soJm11dCBtZW1vcnlfcG9vbCwgYmxvY2tfc3RhcnQpOwogICAgICAgICAgICBkZWFsbG9jYXRlZF9jb3VudCA9IGRlYWxsb2NhdGVkX2NvdW50ICsgMTsKICAgICAgICAgICAgYWxsb2NhdGVkX2Jsb2Nrc1tpIGFzIHVzaXplXSA9IC0xOyAvLyBNYXJrIGFzIGRlYWxsb2NhdGVkCiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHByaW50bG5JbnQoZGVhbGxvY2F0ZWRfY291bnQpOwoKICAgIC8vIFRlc3QgMzogQ29hbGVzY2luZyBmcmVlIGJsb2NrcwogICAgcHJpbnRsbkludCgxODA0KTsgLy8gQ29hbGVzY2luZyBtYXJrZXIKICAgIGxldCBjb2FsZXNjZWRfY291bnQ6IGkzMiA9IGNvYWxlc2NlQWRqYWNlbnRCbG9ja3MoJm11dCBtZW1vcnlfcG9vbCwgcG9vbF9zaXplKTsKICAgIHByaW50bG5JbnQoY29hbGVzY2VkX2NvdW50KTsKCiAgICAvLyBUZXN0IDQ6IEZpcnN0LWZpdCBhbGxvY2F0aW9uIGFmdGVyIGZyYWdtZW50YXRpb24KICAgIHByaW50bG5JbnQoMTgwNSk7IC8vIFBvc3QtZnJhZ21lbnRhdGlvbiBhbGxvY2F0aW9uIG1hcmtlcgogICAgbGV0IG11dCByZWFsbG9jX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCB0ZXN0X3NpemU6IGkzMiA9IDE2OwogICAgd2hpbGUgKHRlc3Rfc2l6ZSA8PSA0OCAmJiByZWFsbG9jX2NvdW50IDwgMjApIHsKICAgICAgICBsZXQgbmV3X2Jsb2NrOiBpMzIgPSBhbGxvY2F0ZUJsb2NrKCZtdXQgbWVtb3J5X3Bvb2wsIGZyZWVfbGlzdF9oZWFkLCB0ZXN0X3NpemUpOwogICAgICAgIGlmIChuZXdfYmxvY2sgIT0gLTEpIHsKICAgICAgICAgICAgcmVhbGxvY19jb3VudCA9IHJlYWxsb2NfY291bnQgKyAxOwogICAgICAgICAgICBmcmVlX2xpc3RfaGVhZCA9IGZpbmRGcmVlTGlzdEhlYWQoJm1lbW9yeV9wb29sLCBwb29sX3NpemUpOwogICAgICAgIH0KICAgICAgICB0ZXN0X3NpemUgPSB0ZXN0X3NpemUgKyA0OwogICAgfQogICAgcHJpbnRsbkludChyZWFsbG9jX2NvdW50KTsKCiAgICAvLyBUZXN0IDU6IE1lbW9yeSB1dGlsaXphdGlvbiBhbmFseXNpcwogICAgcHJpbnRsbkludCgxODA2KTsgLy8gVXRpbGl6YXRpb24gYW5hbHlzaXMgbWFya2VyCiAgICBsZXQgdXRpbGl6YXRpb25fc3RhdHM6IGkzMiA9IGFuYWx5emVNZW1vcnlVdGlsaXphdGlvbigmbWVtb3J5X3Bvb2wsIHBvb2xfc2l6ZSk7CiAgICBwcmludGxuSW50KHV0aWxpemF0aW9uX3N0YXRzKTsKfQoKLy8gSW5pdGlhbGl6ZSBtZW1vcnkgcG9vbCB3aXRoIGluaXRpYWwgZnJlZSBibG9jawpmbiBpbml0aWFsaXplTWVtb3J5UG9vbChtZW1vcnlfcG9vbDogJm11dCBbaTMyOyAyMDAwXSwgcG9vbF9zaXplOiBpMzIpIHsKICAgIC8vIEluaXRpYWxpemUgdGhlIGVudGlyZSBwb29sIGFzIG9uZSBsYXJnZSBmcmVlIGJsb2NrCiAgICBtZW1vcnlfcG9vbFswXSA9IHBvb2xfc2l6ZSAtIDQ7IC8vIFNpemUgb2YgZnJlZSBzcGFjZSAoZXhjbHVkaW5nIGhlYWRlcikKICAgIG1lbW9yeV9wb29sWzFdID0gMDsgLy8gU3RhdHVzOiBmcmVlCiAgICBtZW1vcnlfcG9vbFsyXSA9IC0xOyAvLyBOZXh0IGZyZWU6IG5vbmUKICAgIG1lbW9yeV9wb29sWzNdID0gLTE7IC8vIFByZXYgZnJlZTogbm9uZQoKICAgIC8vIENsZWFyIHRoZSByZXN0IG9mIHRoZSBtZW1vcnkKICAgIGxldCBtdXQgaTogaTMyID0gNDsKICAgIHdoaWxlIChpIDwgcG9vbF9zaXplKSB7CiAgICAgICAgbWVtb3J5X3Bvb2xbaSBhcyB1c2l6ZV0gPSAwOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gQWxsb2NhdGUgYSBibG9jayB1c2luZyBmaXJzdC1maXQgc3RyYXRlZ3kKZm4gYWxsb2NhdGVCbG9jayhtZW1vcnlfcG9vbDogJm11dCBbaTMyOyAyMDAwXSwgZnJlZV9oZWFkOiBpMzIsIHJlcXVlc3RlZF9zaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgYWxpZ25lZF9zaXplOiBpMzIgPSBhbGlnblNpemUocmVxdWVzdGVkX3NpemUsIDQpOyAvLyA0LWJ5dGUgYWxpZ25tZW50CiAgICBsZXQgdG90YWxfbmVlZGVkOiBpMzIgPSBhbGlnbmVkX3NpemUgKyA0OyAvLyBJbmNsdWRlIGhlYWRlciBzaXplCgogICAgbGV0IG11dCBjdXJyZW50OiBpMzIgPSBmcmVlX2hlYWQ7CiAgICB3aGlsZSAoY3VycmVudCAhPSAtMSAmJiBjdXJyZW50IDwgMTk5NikgewogICAgICAgIGlmIChtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplICsgMV0gPT0gMCkgewogICAgICAgICAgICAvLyBTdGF0dXMgaXMgZnJlZQogICAgICAgICAgICBsZXQgYXZhaWxhYmxlX3NpemU6IGkzMiA9IG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemVdOwoKICAgICAgICAgICAgaWYgKGF2YWlsYWJsZV9zaXplID49IHRvdGFsX25lZWRlZCkgewogICAgICAgICAgICAgICAgLy8gRm91bmQgYSBzdWl0YWJsZSBibG9jawogICAgICAgICAgICAgICAgaWYgKGF2YWlsYWJsZV9zaXplID4gdG90YWxfbmVlZGVkICsgOCkgewogICAgICAgICAgICAgICAgICAgIC8vIFdvcnRoIHNwbGl0dGluZwogICAgICAgICAgICAgICAgICAgIHNwbGl0QmxvY2sobWVtb3J5X3Bvb2wsIGN1cnJlbnQsIHRvdGFsX25lZWRlZCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gTWFyayBhcyBhbGxvY2F0ZWQKICAgICAgICAgICAgICAgIG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemVdID0gYWxpZ25lZF9zaXplOwogICAgICAgICAgICAgICAgbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdID0gMTsgLy8gU3RhdHVzOiBhbGxvY2F0ZWQKICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50OwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBNb3ZlIHRvIG5leHQgZnJlZSBibG9jawogICAgICAgIGN1cnJlbnQgPSBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplICsgMl07CiAgICB9CgogICAgcmV0dXJuIC0xOyAvLyBBbGxvY2F0aW9uIGZhaWxlZAp9CgovLyBBbGlnbiBzaXplIHRvIHNwZWNpZmllZCBib3VuZGFyeQpmbiBhbGlnblNpemUoc2l6ZTogaTMyLCBhbGlnbm1lbnQ6IGkzMikgLT4gaTMyIHsKICAgIHJldHVybiAoKHNpemUgKyBhbGlnbm1lbnQgLSAxKSAvIGFsaWdubWVudCkgKiBhbGlnbm1lbnQ7Cn0KCi8vIFNwbGl0IGEgYmxvY2sgaWYgaXQncyBsYXJnZSBlbm91Z2gKZm4gc3BsaXRCbG9jayhtZW1vcnlfcG9vbDogJm11dCBbaTMyOyAyMDAwXSwgYmxvY2tfc3RhcnQ6IGkzMiwgbmVlZGVkX3NpemU6IGkzMikgewogICAgbGV0IG9yaWdpbmFsX3NpemU6IGkzMiA9IG1lbW9yeV9wb29sW2Jsb2NrX3N0YXJ0IGFzIHVzaXplXTsKICAgIGxldCByZW1haW5pbmdfc2l6ZTogaTMyID0gb3JpZ2luYWxfc2l6ZSAtIG5lZWRlZF9zaXplOwoKICAgIGlmIChyZW1haW5pbmdfc2l6ZSA+PSA4KSB7CiAgICAgICAgLy8gTWluaW11bSBibG9jayBzaXplIGluY2x1ZGluZyBoZWFkZXIKICAgICAgICBsZXQgbmV3X2Jsb2NrX3N0YXJ0OiBpMzIgPSBibG9ja19zdGFydCArIG5lZWRlZF9zaXplOwoKICAgICAgICAvLyBDcmVhdGUgbmV3IGZyZWUgYmxvY2sgaGVhZGVyCiAgICAgICAgbWVtb3J5X3Bvb2xbbmV3X2Jsb2NrX3N0YXJ0IGFzIHVzaXplXSA9IHJlbWFpbmluZ19zaXplIC0gNDsKICAgICAgICBtZW1vcnlfcG9vbFtuZXdfYmxvY2tfc3RhcnQgYXMgdXNpemUgKyAxXSA9IDA7IC8vIFN0YXR1czogZnJlZQogICAgICAgIG1lbW9yeV9wb29sW25ld19ibG9ja19zdGFydCBhcyB1c2l6ZSArIDJdID0gbWVtb3J5X3Bvb2xbYmxvY2tfc3RhcnQgYXMgdXNpemUgKyAyXTsgLy8gTmV4dAogICAgICAgIG1lbW9yeV9wb29sW25ld19ibG9ja19zdGFydCBhcyB1c2l6ZSArIDNdID0gYmxvY2tfc3RhcnQ7IC8vIFByZXYKCiAgICAgICAgLy8gVXBkYXRlIG9yaWdpbmFsIGJsb2NrCiAgICAgICAgbWVtb3J5X3Bvb2xbYmxvY2tfc3RhcnQgYXMgdXNpemVdID0gbmVlZGVkX3NpemUgLSA0OwogICAgICAgIG1lbW9yeV9wb29sW2Jsb2NrX3N0YXJ0IGFzIHVzaXplICsgMl0gPSBuZXdfYmxvY2tfc3RhcnQ7IC8vIE5leHQgcG9pbnRzIHRvIG5ldyBibG9jawoKICAgICAgICAvLyBVcGRhdGUgbmV4dCBibG9jaydzIHByZXYgcG9pbnRlciBpZiBpdCBleGlzdHMKICAgICAgICBpZiAobWVtb3J5X3Bvb2xbbmV3X2Jsb2NrX3N0YXJ0IGFzIHVzaXplICsgMl0gIT0gLTEpIHsKICAgICAgICAgICAgbGV0IG5leHRfYmxvY2s6IGkzMiA9IG1lbW9yeV9wb29sW25ld19ibG9ja19zdGFydCBhcyB1c2l6ZSArIDJdOwogICAgICAgICAgICBtZW1vcnlfcG9vbFtuZXh0X2Jsb2NrIGFzIHVzaXplICsgM10gPSBuZXdfYmxvY2tfc3RhcnQ7CiAgICAgICAgfQogICAgfQp9CgovLyBEZWFsbG9jYXRlIGEgYmxvY2sKZm4gZGVhbGxvY2F0ZUJsb2NrKG1lbW9yeV9wb29sOiAmbXV0IFtpMzI7IDIwMDBdLCBibG9ja19zdGFydDogaTMyKSB7CiAgICBpZiAoYmxvY2tfc3RhcnQgPj0gMCAmJiBibG9ja19zdGFydCA8IDE5OTYpIHsKICAgICAgICBtZW1vcnlfcG9vbFtibG9ja19zdGFydCBhcyB1c2l6ZSArIDFdID0gMDsgLy8gU3RhdHVzOiBmcmVlCiAgICAgICAgbWVtb3J5X3Bvb2xbYmxvY2tfc3RhcnQgYXMgdXNpemUgKyAyXSA9IC0xOyAvLyBDbGVhciBuZXh0IHBvaW50ZXIKICAgICAgICBtZW1vcnlfcG9vbFtibG9ja19zdGFydCBhcyB1c2l6ZSArIDNdID0gLTE7IC8vIENsZWFyIHByZXYgcG9pbnRlcgogICAgfQp9CgovLyBGaW5kIHRoZSBoZWFkIG9mIGZyZWUgbGlzdApmbiBmaW5kRnJlZUxpc3RIZWFkKG1lbW9yeV9wb29sOiAmW2kzMjsgMjAwMF0sIHBvb2xfc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBwb29sX3NpemUgLSA0KSB7CiAgICAgICAgaWYgKG1lbW9yeV9wb29sW2kgYXMgdXNpemUgKyAxXSA9PSAwKSB7CiAgICAgICAgICAgIC8vIEZvdW5kIGZyZWUgYmxvY2sKICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfQogICAgICAgIC8vIFNraXAgdG8gbmV4dCBibG9jawogICAgICAgIGxldCBibG9ja19zaXplOiBpMzIgPSBtZW1vcnlfcG9vbFtpIGFzIHVzaXplXSArIDQ7CiAgICAgICAgaSA9IGkgKyBibG9ja19zaXplOwogICAgfQogICAgcmV0dXJuIC0xOwp9CgovLyBDb2FsZXNjZSBhZGphY2VudCBmcmVlIGJsb2NrcwpmbiBjb2FsZXNjZUFkamFjZW50QmxvY2tzKG1lbW9yeV9wb29sOiAmbXV0IFtpMzI7IDIwMDBdLCBwb29sX3NpemU6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgY29hbGVzY2VkX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBjdXJyZW50OiBpMzIgPSAwOwoKICAgIHdoaWxlIChjdXJyZW50IDwgcG9vbF9zaXplIC0gOCkgewogICAgICAgIGlmIChtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplICsgMV0gPT0gMCkgewogICAgICAgICAgICAvLyBDdXJyZW50IGJsb2NrIGlzIGZyZWUKICAgICAgICAgICAgbGV0IGN1cnJlbnRfc2l6ZTogaTMyID0gbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZV0gKyA0OwogICAgICAgICAgICBsZXQgbmV4dF9ibG9jazogaTMyID0gY3VycmVudCArIGN1cnJlbnRfc2l6ZTsKCiAgICAgICAgICAgIC8vIENoZWNrIGlmIG5leHQgYmxvY2sgZXhpc3RzIGFuZCBpcyBmcmVlCiAgICAgICAgICAgIGlmIChuZXh0X2Jsb2NrIDwgcG9vbF9zaXplIC0gNCAmJiBtZW1vcnlfcG9vbFtuZXh0X2Jsb2NrIGFzIHVzaXplICsgMV0gPT0gMCkgewogICAgICAgICAgICAgICAgbGV0IG5leHRfc2l6ZTogaTMyID0gbWVtb3J5X3Bvb2xbbmV4dF9ibG9jayBhcyB1c2l6ZV0gKyA0OwoKICAgICAgICAgICAgICAgIC8vIENvYWxlc2NlIGJsb2NrcwogICAgICAgICAgICAgICAgbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZV0gPSBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplXSArIG5leHRfc2l6ZTsKCiAgICAgICAgICAgICAgICAvLyBDbGVhciB0aGUgbWVyZ2VkIGJsb2NrIGhlYWRlcgogICAgICAgICAgICAgICAgbWVtb3J5X3Bvb2xbbmV4dF9ibG9jayBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICAgICAgbWVtb3J5X3Bvb2xbbmV4dF9ibG9jayBhcyB1c2l6ZSArIDFdID0gLTE7IC8vIE1hcmsgYXMgaW52YWxpZAogICAgICAgICAgICAgICAgbWVtb3J5X3Bvb2xbbmV4dF9ibG9jayBhcyB1c2l6ZSArIDJdID0gMDsKICAgICAgICAgICAgICAgIG1lbW9yeV9wb29sW25leHRfYmxvY2sgYXMgdXNpemUgKyAzXSA9IDA7CgogICAgICAgICAgICAgICAgY29hbGVzY2VkX2NvdW50ID0gY29hbGVzY2VkX2NvdW50ICsgMTsKICAgICAgICAgICAgICAgIC8vIERvbid0IGFkdmFuY2UgY3VycmVudCB0byBjaGVjayBmb3IgZnVydGhlciBjb2FsZXNjaW5nCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudCArIGN1cnJlbnRfc2l6ZTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFNraXAgYWxsb2NhdGVkIGJsb2NrCiAgICAgICAgICAgIGxldCBibG9ja19zaXplOiBpMzIgPSBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplXSArIDQ7CiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50ICsgYmxvY2tfc2l6ZTsKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIGNvYWxlc2NlZF9jb3VudDsKfQoKLy8gQW5hbHl6ZSBtZW1vcnkgdXRpbGl6YXRpb24KZm4gYW5hbHl6ZU1lbW9yeVV0aWxpemF0aW9uKG1lbW9yeV9wb29sOiAmW2kzMjsgMjAwMF0sIHBvb2xfc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBhbGxvY2F0ZWRfYnl0ZXM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGZyZWVfYnl0ZXM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGFsbG9jYXRlZF9ibG9ja3M6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGZyZWVfYmxvY2tzOiBpMzIgPSAwOwogICAgbGV0IG11dCBjdXJyZW50OiBpMzIgPSAwOwoKICAgIHdoaWxlIChjdXJyZW50IDwgcG9vbF9zaXplIC0gNCkgewogICAgICAgIGxldCBibG9ja19zaXplOiBpMzIgPSBtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplXSArIDQ7CgogICAgICAgIGlmIChtZW1vcnlfcG9vbFtjdXJyZW50IGFzIHVzaXplICsgMV0gPT0gMCkgewogICAgICAgICAgICAvLyBGcmVlIGJsb2NrCiAgICAgICAgICAgIGZyZWVfYnl0ZXMgPSBmcmVlX2J5dGVzICsgbWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZV07CiAgICAgICAgICAgIGZyZWVfYmxvY2tzID0gZnJlZV9ibG9ja3MgKyAxOwogICAgICAgIH0gZWxzZSBpZiAobWVtb3J5X3Bvb2xbY3VycmVudCBhcyB1c2l6ZSArIDFdID09IDEpIHsKICAgICAgICAgICAgLy8gQWxsb2NhdGVkIGJsb2NrCiAgICAgICAgICAgIGFsbG9jYXRlZF9ieXRlcyA9IGFsbG9jYXRlZF9ieXRlcyArIG1lbW9yeV9wb29sW2N1cnJlbnQgYXMgdXNpemVdOwogICAgICAgICAgICBhbGxvY2F0ZWRfYmxvY2tzID0gYWxsb2NhdGVkX2Jsb2NrcyArIDE7CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50ID0gY3VycmVudCArIGJsb2NrX3NpemU7CiAgICB9CgogICAgLy8gUmV0dXJuIHV0aWxpemF0aW9uIHBlcmNlbnRhZ2UgKGFsbG9jYXRlZCAvIHRvdGFsICogMTAwKQogICAgbGV0IHRvdGFsX3VzYWJsZTogaTMyID0gYWxsb2NhdGVkX2J5dGVzICsgZnJlZV9ieXRlczsKICAgIGlmICh0b3RhbF91c2FibGUgPiAwKSB7CiAgICAgICAgcmV0dXJuIChhbGxvY2F0ZWRfYnl0ZXMgKiAxMDApIC8gdG90YWxfdXNhYmxlOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KfQoKLy8gQnVkZHkgYWxsb2NhdGlvbiBzeXN0ZW0gc2ltdWxhdGlvbgpmbiBwZXJmb3JtQnVkZHlBbGxvY2F0aW9uVGVzdCgpIHsKICAgIHByaW50bG5JbnQoMTgxMCk7IC8vIEJ1ZGR5IGFsbG9jYXRpb24gc3RhcnQKCiAgICAvLyBCdWRkeSBhbGxvY2F0b3Igc2ltdWxhdGlvbiB1c2luZyBiaW5hcnkgdHJlZSBzdHJ1Y3R1cmUKICAgIC8vIFRyZWUgbm9kZXMgcmVwcmVzZW50IG1lbW9yeSBibG9ja3Mgb2YgZGlmZmVyZW50IHNpemVzCiAgICBsZXQgbXV0IGJ1ZGR5X3RyZWU6IFtpMzI7IDUxMl0gPSBbMDsgNTEyXTsgLy8gQmluYXJ5IHRyZWUgZm9yIGJ1ZGR5IHN5c3RlbQogICAgbGV0IG11dCBhbGxvY2F0aW9uX21hcDogW2kzMjsgMTAwXSA9IFswOyAxMDBdOyAvLyBUcmFjayBhbGxvY2F0aW9ucwogICAgbGV0IG11dCBhbGxvY2F0aW9uX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IHRyZWVfZGVwdGg6IGkzMiA9IDg7IC8vIFN1cHBvcnRzIGJsb2NrcyBmcm9tIHNpemUgMSB0byAxMjgKCiAgICAvLyBJbml0aWFsaXplIGJ1ZGR5IHN5c3RlbQogICAgaW5pdGlhbGl6ZUJ1ZGR5U3lzdGVtKCZtdXQgYnVkZHlfdHJlZSwgdHJlZV9kZXB0aCk7CgogICAgLy8gVGVzdCAxOiBBbGxvY2F0ZSBibG9ja3Mgb2YgdmFyaW91cyBzaXplcwogICAgcHJpbnRsbkludCgxODExKTsgLy8gQnVkZHkgYWxsb2NhdGlvbiBtYXJrZXIKICAgIGxldCBtdXQgc2l6ZTogaTMyID0gMTsKICAgIHdoaWxlIChzaXplIDw9IDY0ICYmIGFsbG9jYXRpb25fY291bnQgPCAxMDApIHsKICAgICAgICBsZXQgYWxsb2NhdGVkX25vZGU6IGkzMiA9IGJ1ZGR5QWxsb2NhdGUoJm11dCBidWRkeV90cmVlLCB0cmVlX2RlcHRoLCBzaXplKTsKICAgICAgICBpZiAoYWxsb2NhdGVkX25vZGUgIT0gLTEpIHsKICAgICAgICAgICAgYWxsb2NhdGlvbl9tYXBbYWxsb2NhdGlvbl9jb3VudCBhcyB1c2l6ZV0gPSBhbGxvY2F0ZWRfbm9kZTsKICAgICAgICAgICAgYWxsb2NhdGlvbl9jb3VudCA9IGFsbG9jYXRpb25fY291bnQgKyAxOwogICAgICAgIH0KICAgICAgICBzaXplID0gc2l6ZSAqIDI7IC8vIFBvd2VyIG9mIDIgc2l6ZXMKICAgIH0KICAgIHByaW50bG5JbnQoYWxsb2NhdGlvbl9jb3VudCk7CgogICAgLy8gVGVzdCAyOiBEZWFsbG9jYXRlIHNvbWUgYmxvY2tzCiAgICBwcmludGxuSW50KDE4MTIpOyAvLyBCdWRkeSBkZWFsbG9jYXRpb24gbWFya2VyCiAgICBsZXQgbXV0IGRlYWxsb2NhdGVkOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBhbGxvY2F0aW9uX2NvdW50KSB7CiAgICAgICAgaWYgKGkgJSAyID09IDApIHsKICAgICAgICAgICAgLy8gRGVhbGxvY2F0ZSBldmVyeSBvdGhlciBibG9jawogICAgICAgICAgICBidWRkeURlYWxsb2NhdGUoJm11dCBidWRkeV90cmVlLCB0cmVlX2RlcHRoLCBhbGxvY2F0aW9uX21hcFtpIGFzIHVzaXplXSk7CiAgICAgICAgICAgIGRlYWxsb2NhdGVkID0gZGVhbGxvY2F0ZWQgKyAxOwogICAgICAgICAgICBhbGxvY2F0aW9uX21hcFtpIGFzIHVzaXplXSA9IC0xOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICBwcmludGxuSW50KGRlYWxsb2NhdGVkKTsKCiAgICAvLyBUZXN0IDM6IEF0dGVtcHQgcmVhbGxvY2F0aW9uIGFmdGVyIGNvYWxlc2NpbmcKICAgIHByaW50bG5JbnQoMTgxMyk7IC8vIEJ1ZGR5IHJlYWxsb2NhdGlvbiBtYXJrZXIKICAgIGxldCBtdXQgcmVhbGxvY2F0ZWQ6IGkzMiA9IDA7CiAgICBzaXplID0gODsKICAgIHdoaWxlIChzaXplIDw9IDMyICYmIHJlYWxsb2NhdGVkIDwgMTApIHsKICAgICAgICBsZXQgbmV3X2FsbG9jYXRpb246IGkzMiA9IGJ1ZGR5QWxsb2NhdGUoJm11dCBidWRkeV90cmVlLCB0cmVlX2RlcHRoLCBzaXplKTsKICAgICAgICBpZiAobmV3X2FsbG9jYXRpb24gIT0gLTEpIHsKICAgICAgICAgICAgcmVhbGxvY2F0ZWQgPSByZWFsbG9jYXRlZCArIDE7CiAgICAgICAgfQogICAgICAgIHNpemUgPSBzaXplICsgODsKICAgIH0KICAgIHByaW50bG5JbnQocmVhbGxvY2F0ZWQpOwoKICAgIC8vIFRlc3QgNDogRnJhZ21lbnRhdGlvbiBhbmFseXNpcwogICAgcHJpbnRsbkludCgxODE0KTsgLy8gQnVkZHkgZnJhZ21lbnRhdGlvbiBtYXJrZXIKICAgIGxldCBmcmFnbWVudGF0aW9uX3Njb3JlOiBpMzIgPSBhbmFseXplQnVkZHlGcmFnbWVudGF0aW9uKCZidWRkeV90cmVlLCB0cmVlX2RlcHRoKTsKICAgIHByaW50bG5JbnQoZnJhZ21lbnRhdGlvbl9zY29yZSk7Cn0KCi8vIEluaXRpYWxpemUgYnVkZHkgc3lzdGVtIHRyZWUKZm4gaW5pdGlhbGl6ZUJ1ZGR5U3lzdGVtKGJ1ZGR5X3RyZWU6ICZtdXQgW2kzMjsgNTEyXSwgZGVwdGg6IGkzMikgewogICAgbGV0IHRyZWVfc2l6ZTogaTMyID0gKDEgPDwgZGVwdGgpIC0gMTsgLy8gMl5kZXB0aCAtIDEgbm9kZXMKCiAgICAvLyBJbml0aWFsaXplIGFsbCBub2RlcyBhcyBmcmVlICgwID0gZnJlZSwgMSA9IGFsbG9jYXRlZCwgMiA9IHNwbGl0KQogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCB0cmVlX3NpemUpIHsKICAgICAgICBidWRkeV90cmVlW2kgYXMgdXNpemVdID0gMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIEJ1ZGR5IGFsbG9jYXRpb24gYWxnb3JpdGhtCmZuIGJ1ZGR5QWxsb2NhdGUoYnVkZHlfdHJlZTogJm11dCBbaTMyOyA1MTJdLCBkZXB0aDogaTMyLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgcmVxdWlyZWRfbGV2ZWw6IGkzMiA9IGNhbGN1bGF0ZVJlcXVpcmVkTGV2ZWwoc2l6ZSwgZGVwdGgpOwogICAgaWYgKHJlcXVpcmVkX2xldmVsIDwgMCkgewogICAgICAgIHJldHVybiAtMTsgLy8gU2l6ZSB0b28gbGFyZ2UKICAgIH0KCiAgICBsZXQgbm9kZTogaTMyID0gZmluZEZyZWVOb2RlKGJ1ZGR5X3RyZWUsIDAsIDAsIHJlcXVpcmVkX2xldmVsLCBkZXB0aCk7CiAgICBpZiAobm9kZSAhPSAtMSkgewogICAgICAgIG1hcmtOb2RlQXNBbGxvY2F0ZWQoYnVkZHlfdHJlZSwgbm9kZSwgcmVxdWlyZWRfbGV2ZWwsIGRlcHRoKTsKICAgICAgICByZXR1cm4gbm9kZTsKICAgIH0KCiAgICByZXR1cm4gLTE7IC8vIE5vIHN1aXRhYmxlIG5vZGUgZm91bmQKfQoKLy8gQ2FsY3VsYXRlIHJlcXVpcmVkIHRyZWUgbGV2ZWwgZm9yIGdpdmVuIHNpemUKZm4gY2FsY3VsYXRlUmVxdWlyZWRMZXZlbChzaXplOiBpMzIsIG1heF9kZXB0aDogaTMyKSAtPiBpMzIgewogICAgbGV0IG1heF9zaXplOiBpMzIgPSAxIDw8IChtYXhfZGVwdGggLSAxKTsgLy8gMl4obWF4X2RlcHRoLTEpCiAgICBsZXQgbXV0IGxldmVsOiBpMzIgPSAwOwogICAgbGV0IG11dCBsZXZlbF9zaXplOiBpMzIgPSBtYXhfc2l6ZTsKCiAgICB3aGlsZSAobGV2ZWwgPCBtYXhfZGVwdGgpIHsKICAgICAgICBpZiAobGV2ZWxfc2l6ZSA+PSBzaXplKSB7CiAgICAgICAgICAgIHJldHVybiBsZXZlbDsKICAgICAgICB9CiAgICAgICAgbGV2ZWxfc2l6ZSA9IGxldmVsX3NpemUgLyAyOwogICAgICAgIGxldmVsID0gbGV2ZWwgKyAxOwogICAgfQoKICAgIHJldHVybiAtMTsgLy8gU2l6ZSB0b28gbGFyZ2UKfQoKLy8gRmluZCBmcmVlIG5vZGUgYXQgcmVxdWlyZWQgbGV2ZWwKZm4gZmluZEZyZWVOb2RlKAogICAgYnVkZHlfdHJlZTogJltpMzI7IDUxMl0sCiAgICBub2RlOiBpMzIsCiAgICBjdXJyZW50X2xldmVsOiBpMzIsCiAgICB0YXJnZXRfbGV2ZWw6IGkzMiwKICAgIG1heF9kZXB0aDogaTMyLAopIC0+IGkzMiB7CiAgICBpZiAoY3VycmVudF9sZXZlbCA9PSB0YXJnZXRfbGV2ZWwpIHsKICAgICAgICBpZiAoYnVkZHlfdHJlZVtub2RlIGFzIHVzaXplXSA9PSAwKSB7CiAgICAgICAgICAgIC8vIEZyZWUgbm9kZQogICAgICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgfQoKICAgIGlmIChidWRkeV90cmVlW25vZGUgYXMgdXNpemVdID09IDEpIHsKICAgICAgICAvLyBBbGxvY2F0ZWQgbm9kZQogICAgICAgIHJldHVybiAtMTsKICAgIH0KCiAgICAvLyBUcnkgbGVmdCBjaGlsZCBmaXJzdAogICAgbGV0IGxlZnRfY2hpbGQ6IGkzMiA9IDIgKiBub2RlICsgMTsKICAgIGxldCByaWdodF9jaGlsZDogaTMyID0gMiAqIG5vZGUgKyAyOwoKICAgIGlmIChsZWZ0X2NoaWxkIDwgNTExKSB7CiAgICAgICAgbGV0IGxlZnRfcmVzdWx0OiBpMzIgPSBmaW5kRnJlZU5vZGUoCiAgICAgICAgICAgIGJ1ZGR5X3RyZWUsCiAgICAgICAgICAgIGxlZnRfY2hpbGQsCiAgICAgICAgICAgIGN1cnJlbnRfbGV2ZWwgKyAxLAogICAgICAgICAgICB0YXJnZXRfbGV2ZWwsCiAgICAgICAgICAgIG1heF9kZXB0aCwKICAgICAgICApOwogICAgICAgIGlmIChsZWZ0X3Jlc3VsdCAhPSAtMSkgewogICAgICAgICAgICByZXR1cm4gbGVmdF9yZXN1bHQ7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFRyeSByaWdodCBjaGlsZAogICAgaWYgKHJpZ2h0X2NoaWxkIDwgNTExKSB7CiAgICAgICAgbGV0IHJpZ2h0X3Jlc3VsdDogaTMyID0gZmluZEZyZWVOb2RlKAogICAgICAgICAgICBidWRkeV90cmVlLAogICAgICAgICAgICByaWdodF9jaGlsZCwKICAgICAgICAgICAgY3VycmVudF9sZXZlbCArIDEsCiAgICAgICAgICAgIHRhcmdldF9sZXZlbCwKICAgICAgICAgICAgbWF4X2RlcHRoLAogICAgICAgICk7CiAgICAgICAgaWYgKHJpZ2h0X3Jlc3VsdCAhPSAtMSkgewogICAgICAgICAgICByZXR1cm4gcmlnaHRfcmVzdWx0OwogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gLTE7Cn0KCi8vIE1hcmsgbm9kZSBhbmQgaXRzIGFuY2VzdG9ycyBhcyBhbGxvY2F0ZWQvc3BsaXQKZm4gbWFya05vZGVBc0FsbG9jYXRlZChidWRkeV90cmVlOiAmbXV0IFtpMzI7IDUxMl0sIG11dCBub2RlOiBpMzIsIGxldmVsOiBpMzIsIG1heF9kZXB0aDogaTMyKSB7CiAgICBidWRkeV90cmVlW25vZGUgYXMgdXNpemVdID0gMTsgLy8gTWFyayBhcyBhbGxvY2F0ZWQKCiAgICAvLyBNYXJrIGFuY2VzdG9ycyBhcyBzcGxpdAogICAgbGV0IG11dCBwYXJlbnQ6IGkzMiA9IChub2RlIC0gMSkgLyAyOwogICAgd2hpbGUgKHBhcmVudCA+PSAwICYmIG5vZGUgPiAwKSB7CiAgICAgICAgaWYgKGJ1ZGR5X3RyZWVbcGFyZW50IGFzIHVzaXplXSAhPSAxKSB7CiAgICAgICAgICAgIGJ1ZGR5X3RyZWVbcGFyZW50IGFzIHVzaXplXSA9IDI7IC8vIE1hcmsgYXMgc3BsaXQKICAgICAgICB9CiAgICAgICAgaWYgKHBhcmVudCA9PSAwKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBub2RlID0gcGFyZW50OwogICAgICAgIHBhcmVudCA9IChwYXJlbnQgLSAxKSAvIDI7CiAgICB9Cn0KCi8vIEJ1ZGR5IGRlYWxsb2NhdGlvbgpmbiBidWRkeURlYWxsb2NhdGUoYnVkZHlfdHJlZTogJm11dCBbaTMyOyA1MTJdLCBkZXB0aDogaTMyLCBub2RlOiBpMzIpIHsKICAgIGlmIChub2RlID49IDAgJiYgbm9kZSA8IDUxMSkgewogICAgICAgIGJ1ZGR5X3RyZWVbbm9kZSBhcyB1c2l6ZV0gPSAwOyAvLyBNYXJrIGFzIGZyZWUKCiAgICAgICAgLy8gVHJ5IHRvIGNvYWxlc2NlIHdpdGggYnVkZHkKICAgICAgICBjb2FsZXNjZUJ1ZGRpZXMoYnVkZHlfdHJlZSwgbm9kZSk7CiAgICB9Cn0KCi8vIENvYWxlc2NlIGJ1ZGR5IG5vZGVzIGlmIGJvdGggYXJlIGZyZWUKZm4gY29hbGVzY2VCdWRkaWVzKGJ1ZGR5X3RyZWU6ICZtdXQgW2kzMjsgNTEyXSwgbm9kZTogaTMyKSB7CiAgICBpZiAobm9kZSA9PSAwKSB7CiAgICAgICAgcmV0dXJuOyAvLyBSb290IG5vZGUgaGFzIG5vIGJ1ZGR5CiAgICB9CgogICAgbGV0IHBhcmVudDogaTMyID0gKG5vZGUgLSAxKSAvIDI7CiAgICBsZXQgbGVmdF9jaGlsZDogaTMyID0gMiAqIHBhcmVudCArIDE7CiAgICBsZXQgcmlnaHRfY2hpbGQ6IGkzMiA9IDIgKiBwYXJlbnQgKyAyOwoKICAgIC8vIENoZWNrIGlmIGJvdGggY2hpbGRyZW4gYXJlIGZyZWUKICAgIGlmIChidWRkeV90cmVlW2xlZnRfY2hpbGQgYXMgdXNpemVdID09IDAgJiYgYnVkZHlfdHJlZVtyaWdodF9jaGlsZCBhcyB1c2l6ZV0gPT0gMCkgewogICAgICAgIGJ1ZGR5X3RyZWVbcGFyZW50IGFzIHVzaXplXSA9IDA7IC8vIE1hcmsgcGFyZW50IGFzIGZyZWUKICAgICAgICBidWRkeV90cmVlW2xlZnRfY2hpbGQgYXMgdXNpemVdID0gLTE7IC8vIE1hcmsgY2hpbGRyZW4gYXMgaW52YWxpZAogICAgICAgIGJ1ZGR5X3RyZWVbcmlnaHRfY2hpbGQgYXMgdXNpemVdID0gLTE7CgogICAgICAgIC8vIFJlY3Vyc2l2ZWx5IGNvYWxlc2NlIHVwIHRoZSB0cmVlCiAgICAgICAgY29hbGVzY2VCdWRkaWVzKGJ1ZGR5X3RyZWUsIHBhcmVudCk7CiAgICB9Cn0KCi8vIEFuYWx5emUgYnVkZHkgc3lzdGVtIGZyYWdtZW50YXRpb24KZm4gYW5hbHl6ZUJ1ZGR5RnJhZ21lbnRhdGlvbihidWRkeV90cmVlOiAmW2kzMjsgNTEyXSwgZGVwdGg6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgZnJlZV9ub2RlczogaTMyID0gMDsKICAgIGxldCBtdXQgYWxsb2NhdGVkX25vZGVzOiBpMzIgPSAwOwogICAgbGV0IG11dCBzcGxpdF9ub2RlczogaTMyID0gMDsKCiAgICBsZXQgdHJlZV9zaXplOiBpMzIgPSAoMSA8PCBkZXB0aCkgLSAxOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCB0cmVlX3NpemUpIHsKICAgICAgICBpZiAoYnVkZHlfdHJlZVtpIGFzIHVzaXplXSA9PSAwKSB7CiAgICAgICAgICAgIGZyZWVfbm9kZXMgPSBmcmVlX25vZGVzICsgMTsKICAgICAgICB9IGVsc2UgaWYgKGJ1ZGR5X3RyZWVbaSBhcyB1c2l6ZV0gPT0gMSkgewogICAgICAgICAgICBhbGxvY2F0ZWRfbm9kZXMgPSBhbGxvY2F0ZWRfbm9kZXMgKyAxOwogICAgICAgIH0gZWxzZSBpZiAoYnVkZHlfdHJlZVtpIGFzIHVzaXplXSA9PSAyKSB7CiAgICAgICAgICAgIHNwbGl0X25vZGVzID0gc3BsaXRfbm9kZXMgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gUmV0dXJuIGZyYWdtZW50YXRpb24gc2NvcmUgYmFzZWQgb24gc3BsaXQgbm9kZXMKICAgIHJldHVybiBzcGxpdF9ub2RlcyAqIDEwMCAvIChhbGxvY2F0ZWRfbm9kZXMgKyBzcGxpdF9ub2RlcyArIDEpOwp9CgovLyBHYXJiYWdlIGNvbGxlY3Rpb24gc2ltdWxhdGlvbgpmbiBwZXJmb3JtR2FyYmFnZUNvbGxlY3Rpb25UZXN0KCkgewogICAgcHJpbnRsbkludCgxODIwKTsgLy8gR0MgdGVzdCBzdGFydAoKICAgIC8vIFNpbXVsYXRlIG9iamVjdHMgd2l0aCByZWZlcmVuY2VzCiAgICBsZXQgbXV0IG9iamVjdF9wb29sOiBbaTMyOyAxMDAwXSA9IFswOyAxMDAwXTsKICAgIGxldCBtdXQgb2JqZWN0X3JlZnM6IFtpMzI7IDUwMF0gPSBbMDsgNTAwXTsgLy8gUmVmZXJlbmNlIHRhYmxlCiAgICBsZXQgbXV0IHJvb3Rfc2V0OiBbaTMyOyA1MF0gPSBbMDsgNTBdOyAvLyBSb290IHJlZmVyZW5jZXMKICAgIGxldCBtdXQgZ2NfbWFya3M6IFtpMzI7IDIwMF0gPSBbMDsgMjAwXTsgLy8gTWFyayBiaXRzIGZvciBHQwogICAgbGV0IG11dCBvYmplY3RfY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHJvb3RfY291bnQ6IGkzMiA9IDA7CgogICAgLy8gSW5pdGlhbGl6ZSBvYmplY3QgcG9vbCBhbmQgY3JlYXRlIHJlZmVyZW5jZSBncmFwaAogICAgaW5pdGlhbGl6ZU9iamVjdEdyYXBoKAogICAgICAgICZtdXQgb2JqZWN0X3Bvb2wsCiAgICAgICAgJm11dCBvYmplY3RfcmVmcywKICAgICAgICAmbXV0IHJvb3Rfc2V0LAogICAgICAgICZtdXQgb2JqZWN0X2NvdW50LAogICAgICAgICZtdXQgcm9vdF9jb3VudCwKICAgICk7CgogICAgLy8gVGVzdCAxOiBNYXJrIHBoYXNlIG9mIGdhcmJhZ2UgY29sbGVjdGlvbgogICAgcHJpbnRsbkludCgxODIxKTsgLy8gTWFyayBwaGFzZSBtYXJrZXIKICAgIGxldCBtYXJrZWRfb2JqZWN0czogaTMyID0gcGVyZm9ybU1hcmtQaGFzZSgKICAgICAgICAmb2JqZWN0X3Bvb2wsCiAgICAgICAgJm9iamVjdF9yZWZzLAogICAgICAgICZyb290X3NldCwKICAgICAgICAmbXV0IGdjX21hcmtzLAogICAgICAgIHJvb3RfY291bnQsCiAgICApOwogICAgcHJpbnRsbkludChtYXJrZWRfb2JqZWN0cyk7CgogICAgLy8gVGVzdCAyOiBTd2VlcCBwaGFzZSBvZiBnYXJiYWdlIGNvbGxlY3Rpb24KICAgIHByaW50bG5JbnQoMTgyMik7IC8vIFN3ZWVwIHBoYXNlIG1hcmtlcgogICAgbGV0IGNvbGxlY3RlZF9vYmplY3RzOiBpMzIgPSBwZXJmb3JtU3dlZXBQaGFzZSgmbXV0IG9iamVjdF9wb29sLCAmZ2NfbWFya3MsIG9iamVjdF9jb3VudCk7CiAgICBwcmludGxuSW50KGNvbGxlY3RlZF9vYmplY3RzKTsKCiAgICAvLyBUZXN0IDM6IENvbXBhY3Rpb24gcGhhc2UKICAgIHByaW50bG5JbnQoMTgyMyk7IC8vIENvbXBhY3Rpb24gbWFya2VyCiAgICBsZXQgY29tcGFjdGVkX3NpemU6IGkzMiA9CiAgICAgICAgcGVyZm9ybUNvbXBhY3Rpb25QaGFzZSgmbXV0IG9iamVjdF9wb29sLCAmbXV0IG9iamVjdF9yZWZzLCBvYmplY3RfY291bnQpOwogICAgcHJpbnRsbkludChjb21wYWN0ZWRfc2l6ZSk7CgogICAgLy8gVGVzdCA0OiBSZWZlcmVuY2UgY291bnRpbmcgc2ltdWxhdGlvbgogICAgcHJpbnRsbkludCgxODI0KTsgLy8gUmVmZXJlbmNlIGNvdW50aW5nIG1hcmtlcgogICAgbGV0IHJlZl9jb3VudF9yZXN1bHQ6IGkzMiA9IHNpbXVsYXRlUmVmZXJlbmNlQ291bnRpbmcoJm11dCBvYmplY3RfcG9vbCwgb2JqZWN0X2NvdW50KTsKICAgIHByaW50bG5JbnQocmVmX2NvdW50X3Jlc3VsdCk7Cn0KCi8vIEluaXRpYWxpemUgb2JqZWN0IGdyYXBoIGZvciBHQyB0ZXN0aW5nCmZuIGluaXRpYWxpemVPYmplY3RHcmFwaCgKICAgIG9iamVjdF9wb29sOiAmbXV0IFtpMzI7IDEwMDBdLAogICAgb2JqZWN0X3JlZnM6ICZtdXQgW2kzMjsgNTAwXSwKICAgIHJvb3Rfc2V0OiAmbXV0IFtpMzI7IDUwXSwKICAgIG9iamVjdF9jb3VudDogJm11dCBpMzIsCiAgICByb290X2NvdW50OiAmbXV0IGkzMiwKKSB7CiAgICAvLyBDcmVhdGUgb2JqZWN0cyB3aXRoIHJlZmVyZW5jZXMgdG8gc2ltdWxhdGUgcmVhbGlzdGljIG1lbW9yeSBncmFwaAogICAgLy8gT2JqZWN0IGxheW91dDogW3R5cGUsIHNpemUsIHJlZl9jb3VudCwgcmVmMSwgcmVmMiwgLi4uZGF0YS4uLl0KCiAgICAvLyBDcmVhdGUgcm9vdCBvYmplY3RzCiAgICAqcm9vdF9jb3VudCA9IDU7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICBsZXQgcmM6IGkzMiA9ICpyb290X2NvdW50OwogICAgd2hpbGUgKGkgPCByYykgewogICAgICAgIHJvb3Rfc2V0W2kgYXMgdXNpemVdID0gaSAqIDIwOyAvLyBSb290IHBvaW50cyB0byBvYmplY3RzIGF0IHJlZ3VsYXIgaW50ZXJ2YWxzCiAgICAgICAgb2JqZWN0X3Bvb2xbaSBhcyB1c2l6ZSAqIDIwXSA9IDE7IC8vIFR5cGUKICAgICAgICBvYmplY3RfcG9vbFtpIGFzIHVzaXplICogMjAgKyAxXSA9IDE2OyAvLyBTaXplCiAgICAgICAgb2JqZWN0X3Bvb2xbaSBhcyB1c2l6ZSAqIDIwICsgMl0gPSAxOyAvLyBSZWZlcmVuY2UgY291bnQKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gQ3JlYXRlIGludGVyY29ubmVjdGVkIG9iamVjdHMKICAgICpvYmplY3RfY291bnQgPSAzMDsKICAgIGkgPSAwOwogICAgbGV0IG9jOiBpMzIgPSAqb2JqZWN0X2NvdW50OwogICAgd2hpbGUgKGkgPCBvYykgewogICAgICAgIGxldCBvYmplY3Rfc3RhcnQ6IGkzMiA9IGkgKiAyMDsKICAgICAgICBpZiAob2JqZWN0X3N0YXJ0ICsgMTAgPCAxMDAwKSB7CiAgICAgICAgICAgIG9iamVjdF9wb29sW29iamVjdF9zdGFydCBhcyB1c2l6ZV0gPSBpICUgMyArIDE7IC8vIFR5cGUgKDEtMykKICAgICAgICAgICAgb2JqZWN0X3Bvb2xbb2JqZWN0X3N0YXJ0IGFzIHVzaXplICsgMV0gPSAxMiArIGkgJSA4OyAvLyBTaXplCiAgICAgICAgICAgIG9iamVjdF9wb29sW29iamVjdF9zdGFydCBhcyB1c2l6ZSArIDJdID0gMDsgLy8gUmVmZXJlbmNlIGNvdW50CgogICAgICAgICAgICAvLyBBZGQgc29tZSByZWZlcmVuY2VzCiAgICAgICAgICAgIGlmIChpICsgMSA8IG9jKSB7CiAgICAgICAgICAgICAgICBvYmplY3RfcG9vbFtvYmplY3Rfc3RhcnQgYXMgdXNpemUgKyAzXSA9IChpICsgMSkgKiAyMDsgLy8gUmVmIHRvIG5leHQgb2JqZWN0CiAgICAgICAgICAgICAgICBvYmplY3RfcmVmc1tpIGFzIHVzaXplICogMl0gPSBvYmplY3Rfc3RhcnQgKyAzOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChpICsgMiA8IG9jICYmIGkgJSAzID09IDApIHsKICAgICAgICAgICAgICAgIG9iamVjdF9wb29sW29iamVjdF9zdGFydCBhcyB1c2l6ZSArIDRdID0gKGkgKyAyKSAqIDIwOyAvLyBTb21lIG9iamVjdHMgaGF2ZSAyIHJlZnMKICAgICAgICAgICAgICAgIG9iamVjdF9yZWZzW2kgYXMgdXNpemUgKiAyICsgMV0gPSBvYmplY3Rfc3RhcnQgKyA0OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gTWFyayBwaGFzZSBvZiBnYXJiYWdlIGNvbGxlY3Rpb24KZm4gcGVyZm9ybU1hcmtQaGFzZSgKICAgIG9iamVjdF9wb29sOiAmW2kzMjsgMTAwMF0sCiAgICBvYmplY3RfcmVmczogJltpMzI7IDUwMF0sCiAgICByb290X3NldDogJltpMzI7IDUwXSwKICAgIGdjX21hcmtzOiAmbXV0IFtpMzI7IDIwMF0sCiAgICByb290X2NvdW50OiBpMzIsCikgLT4gaTMyIHsKICAgIC8vIENsZWFyIGFsbCBtYXJrcwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAyMDApIHsKICAgICAgICBnY19tYXJrc1tpIGFzIHVzaXplXSA9IDA7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIE1hcmsgYWxsIHJlYWNoYWJsZSBvYmplY3RzIHN0YXJ0aW5nIGZyb20gcm9vdHMKICAgIGxldCBtdXQgbWFya2VkX2NvdW50OiBpMzIgPSAwOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IHJvb3RfY291bnQpIHsKICAgICAgICBsZXQgcm9vdF9vYmplY3Q6IGkzMiA9IHJvb3Rfc2V0W2kgYXMgdXNpemVdOwogICAgICAgIG1hcmtlZF9jb3VudCA9CiAgICAgICAgICAgIG1hcmtlZF9jb3VudCArIG1hcmtPYmplY3Qob2JqZWN0X3Bvb2wsIG9iamVjdF9yZWZzLCBnY19tYXJrcywgcm9vdF9vYmplY3QsIDApOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gbWFya2VkX2NvdW50Owp9CgovLyBSZWN1cnNpdmVseSBtYXJrIGFuIG9iamVjdCBhbmQgaXRzIHJlZmVyZW5jZXMKZm4gbWFya09iamVjdCgKICAgIG9iamVjdF9wb29sOiAmW2kzMjsgMTAwMF0sCiAgICBvYmplY3RfcmVmczogJltpMzI7IDUwMF0sCiAgICBnY19tYXJrczogJm11dCBbaTMyOyAyMDBdLAogICAgb2JqZWN0X2FkZHI6IGkzMiwKICAgIGRlcHRoOiBpMzIsCikgLT4gaTMyIHsKICAgIGlmIChkZXB0aCA+IDEwIHx8IG9iamVjdF9hZGRyIDwgMCB8fCBvYmplY3RfYWRkciA+PSAxMDAwKSB7CiAgICAgICAgcmV0dXJuIDA7IC8vIFByZXZlbnQgaW5maW5pdGUgcmVjdXJzaW9uCiAgICB9CgogICAgbGV0IG9iamVjdF9pbmRleDogaTMyID0gb2JqZWN0X2FkZHIgLyAyMDsKICAgIGlmIChvYmplY3RfaW5kZXggPj0gMjAwIHx8IGdjX21hcmtzW29iamVjdF9pbmRleCBhcyB1c2l6ZV0gPT0gMSkgewogICAgICAgIHJldHVybiAwOyAvLyBBbHJlYWR5IG1hcmtlZCBvciBpbnZhbGlkCiAgICB9CgogICAgLy8gTWFyayB0aGlzIG9iamVjdAogICAgZ2NfbWFya3Nbb2JqZWN0X2luZGV4IGFzIHVzaXplXSA9IDE7CiAgICBsZXQgbXV0IG1hcmtlZF9jb3VudDogaTMyID0gMTsKCiAgICAvLyBNYXJrIHJlZmVyZW5jZWQgb2JqZWN0cwogICAgaWYgKG9iamVjdF9hZGRyICsgNSA8IDEwMDApIHsKICAgICAgICBsZXQgcmVmMTogaTMyID0gb2JqZWN0X3Bvb2xbb2JqZWN0X2FkZHIgYXMgdXNpemUgKyAzXTsKICAgICAgICBsZXQgcmVmMjogaTMyID0gb2JqZWN0X3Bvb2xbb2JqZWN0X2FkZHIgYXMgdXNpemUgKyA0XTsKCiAgICAgICAgaWYgKHJlZjEgPiAwICYmIHJlZjEgPCAxMDAwKSB7CiAgICAgICAgICAgIG1hcmtlZF9jb3VudCA9CiAgICAgICAgICAgICAgICBtYXJrZWRfY291bnQgKyBtYXJrT2JqZWN0KG9iamVjdF9wb29sLCBvYmplY3RfcmVmcywgZ2NfbWFya3MsIHJlZjEsIGRlcHRoICsgMSk7CiAgICAgICAgfQogICAgICAgIGlmIChyZWYyID4gMCAmJiByZWYyIDwgMTAwMCkgewogICAgICAgICAgICBtYXJrZWRfY291bnQgPQogICAgICAgICAgICAgICAgbWFya2VkX2NvdW50ICsgbWFya09iamVjdChvYmplY3RfcG9vbCwgb2JqZWN0X3JlZnMsIGdjX21hcmtzLCByZWYyLCBkZXB0aCArIDEpOwogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbWFya2VkX2NvdW50Owp9CgovLyBTd2VlcCBwaGFzZSBvZiBnYXJiYWdlIGNvbGxlY3Rpb24KZm4gcGVyZm9ybVN3ZWVwUGhhc2UoCiAgICBvYmplY3RfcG9vbDogJm11dCBbaTMyOyAxMDAwXSwKICAgIGdjX21hcmtzOiAmW2kzMjsgMjAwXSwKICAgIG9iamVjdF9jb3VudDogaTMyLAopIC0+IGkzMiB7CiAgICBsZXQgbXV0IGNvbGxlY3RlZF9jb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICB3aGlsZSAoaSA8IG9iamVjdF9jb3VudCkgewogICAgICAgIGlmIChnY19tYXJrc1tpIGFzIHVzaXplXSA9PSAwKSB7CiAgICAgICAgICAgIC8vIFVubWFya2VkIG9iamVjdCAtIGNvbGxlY3QgaXQKICAgICAgICAgICAgbGV0IG9iamVjdF9zdGFydDogaTMyID0gaSAqIDIwOwogICAgICAgICAgICBpZiAob2JqZWN0X3N0YXJ0ICsgMTAgPCAxMDAwKSB7CiAgICAgICAgICAgICAgICAvLyBDbGVhciBvYmplY3QgZGF0YQogICAgICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICAgICAgd2hpbGUgKGogPCAyMCkgewogICAgICAgICAgICAgICAgICAgIG9iamVjdF9wb29sWyhvYmplY3Rfc3RhcnQgKyBqKSBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbGxlY3RlZF9jb3VudCA9IGNvbGxlY3RlZF9jb3VudCArIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHJldHVybiBjb2xsZWN0ZWRfY291bnQ7Cn0KCi8vIENvbXBhY3Rpb24gcGhhc2UgdG8gcmVkdWNlIGZyYWdtZW50YXRpb24KZm4gcGVyZm9ybUNvbXBhY3Rpb25QaGFzZSgKICAgIG9iamVjdF9wb29sOiAmbXV0IFtpMzI7IDEwMDBdLAogICAgb2JqZWN0X3JlZnM6ICZtdXQgW2kzMjsgNTAwXSwKICAgIG9iamVjdF9jb3VudDogaTMyLAopIC0+IGkzMiB7CiAgICBsZXQgbXV0IGNvbXBhY3RlZF9vYmplY3RzOiBpMzIgPSAwOwogICAgbGV0IG11dCB3cml0ZV9wb3M6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgLy8gQ29tcGFjdCBsaXZlIG9iamVjdHMgdG8gdGhlIGJlZ2lubmluZyBvZiB0aGUgcG9vbAogICAgd2hpbGUgKGkgPCBvYmplY3RfY291bnQpIHsKICAgICAgICBsZXQgcmVhZF9wb3M6IGkzMiA9IGkgKiAyMDsKICAgICAgICBpZiAocmVhZF9wb3MgPCAxMDAwICYmIG9iamVjdF9wb29sW3JlYWRfcG9zIGFzIHVzaXplXSAhPSAwKSB7CiAgICAgICAgICAgIC8vIExpdmUgb2JqZWN0CiAgICAgICAgICAgIGlmIChyZWFkX3BvcyAhPSB3cml0ZV9wb3MpIHsKICAgICAgICAgICAgICAgIC8vIE1vdmUgb2JqZWN0IGRhdGEKICAgICAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICAgICAgICAgIHdoaWxlIChqIDwgMjAgJiYgd3JpdGVfcG9zICsgaiA8IDEwMDAgJiYgcmVhZF9wb3MgKyBqIDwgMTAwMCkgewogICAgICAgICAgICAgICAgICAgIG9iamVjdF9wb29sWyh3cml0ZV9wb3MgKyBqKSBhcyB1c2l6ZV0gPSBvYmplY3RfcG9vbFsocmVhZF9wb3MgKyBqKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAgICAgb2JqZWN0X3Bvb2xbKHJlYWRfcG9zICsgaikgYXMgdXNpemVdID0gMDsgLy8gQ2xlYXIgb2xkIGxvY2F0aW9uCiAgICAgICAgICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSByZWZlcmVuY2VzIHRvIHRoaXMgb2JqZWN0CiAgICAgICAgICAgICAgICB1cGRhdGVSZWZlcmVuY2VzQWZ0ZXJDb21wYWN0aW9uKG9iamVjdF9wb29sLCBvYmplY3RfcmVmcywgcmVhZF9wb3MsIHdyaXRlX3BvcywgNTAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB3cml0ZV9wb3MgPSB3cml0ZV9wb3MgKyAyMDsKICAgICAgICAgICAgY29tcGFjdGVkX29iamVjdHMgPSBjb21wYWN0ZWRfb2JqZWN0cyArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gY29tcGFjdGVkX29iamVjdHM7Cn0KCi8vIFVwZGF0ZSByZWZlcmVuY2VzIGFmdGVyIGNvbXBhY3Rpb24KZm4gdXBkYXRlUmVmZXJlbmNlc0FmdGVyQ29tcGFjdGlvbigKICAgIG9iamVjdF9wb29sOiAmbXV0IFtpMzI7IDEwMDBdLAogICAgb2JqZWN0X3JlZnM6ICZtdXQgW2kzMjsgNTAwXSwKICAgIG9sZF9hZGRyOiBpMzIsCiAgICBuZXdfYWRkcjogaTMyLAogICAgcmVmX2NvdW50OiBpMzIsCikgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCByZWZfY291bnQpIHsKICAgICAgICBpZiAob2JqZWN0X3JlZnNbaSBhcyB1c2l6ZV0gPiAwICYmIG9iamVjdF9yZWZzW2kgYXMgdXNpemVdIDwgMTAwMCkgewogICAgICAgICAgICBsZXQgcmVmX2xvY2F0aW9uOiBpMzIgPSBvYmplY3RfcmVmc1tpIGFzIHVzaXplXTsKICAgICAgICAgICAgaWYgKG9iamVjdF9wb29sW3JlZl9sb2NhdGlvbiBhcyB1c2l6ZV0gPT0gb2xkX2FkZHIpIHsKICAgICAgICAgICAgICAgIG9iamVjdF9wb29sW3JlZl9sb2NhdGlvbiBhcyB1c2l6ZV0gPSBuZXdfYWRkcjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIFNpbXVsYXRlIHJlZmVyZW5jZSBjb3VudGluZyBnYXJiYWdlIGNvbGxlY3Rpb24KZm4gc2ltdWxhdGVSZWZlcmVuY2VDb3VudGluZyhvYmplY3RfcG9vbDogJm11dCBbaTMyOyAxMDAwXSwgb2JqZWN0X2NvdW50OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGNvbGxlY3RlZF9ieV9yZWZjb3VudDogaTMyID0gMDsKCiAgICAvLyBJbml0aWFsaXplIHJlZmVyZW5jZSBjb3VudHMKICAgIGNhbGN1bGF0ZVJlZmVyZW5jZUNvdW50cyhvYmplY3RfcG9vbCwgb2JqZWN0X2NvdW50KTsKCiAgICAvLyBTaW11bGF0ZSBvYmplY3QgZGVsZXRpb25zIGFuZCByZWYgY291bnQgdXBkYXRlcwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBvYmplY3RfY291bnQpIHsKICAgICAgICBsZXQgb2JqZWN0X3N0YXJ0OiBpMzIgPSBpICogMjA7CiAgICAgICAgaWYgKG9iamVjdF9zdGFydCArIDUgPCAxMDAwICYmIG9iamVjdF9wb29sW29iamVjdF9zdGFydCBhcyB1c2l6ZV0gIT0gMCkgewogICAgICAgICAgICAvLyBTaW11bGF0ZSByZW1vdmluZyBhIHJlZmVyZW5jZQogICAgICAgICAgICBpZiAob2JqZWN0X3Bvb2xbb2JqZWN0X3N0YXJ0IGFzIHVzaXplICsgMl0gPiAwKSB7CiAgICAgICAgICAgICAgICBvYmplY3RfcG9vbFtvYmplY3Rfc3RhcnQgYXMgdXNpemUgKyAyXSA9IG9iamVjdF9wb29sW29iamVjdF9zdGFydCBhcyB1c2l6ZSArIDJdIC0gMTsKCiAgICAgICAgICAgICAgICAvLyBJZiByZWYgY291bnQgcmVhY2hlcyB6ZXJvLCBjb2xsZWN0IHRoZSBvYmplY3QKICAgICAgICAgICAgICAgIGlmIChvYmplY3RfcG9vbFtvYmplY3Rfc3RhcnQgYXMgdXNpemUgKyAyXSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgZGVjcmVtZW50UmVmZXJlbmNlZE9iamVjdHMob2JqZWN0X3Bvb2wsIG9iamVjdF9zdGFydCk7CiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGVkX2J5X3JlZmNvdW50ID0gY29sbGVjdGVkX2J5X3JlZmNvdW50ICsgMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDI7IC8vIFNraXAgc29tZSBvYmplY3RzCiAgICB9CgogICAgcmV0dXJuIGNvbGxlY3RlZF9ieV9yZWZjb3VudDsKfQoKLy8gQ2FsY3VsYXRlIHJlZmVyZW5jZSBjb3VudHMgZm9yIGFsbCBvYmplY3RzCmZuIGNhbGN1bGF0ZVJlZmVyZW5jZUNvdW50cyhvYmplY3RfcG9vbDogJm11dCBbaTMyOyAxMDAwXSwgb2JqZWN0X2NvdW50OiBpMzIpIHsKICAgIC8vIFJlc2V0IGFsbCByZWZlcmVuY2UgY291bnRzCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG9iamVjdF9jb3VudCkgewogICAgICAgIGxldCBvYmplY3Rfc3RhcnQ6IGkzMiA9IGkgKiAyMDsKICAgICAgICBpZiAob2JqZWN0X3N0YXJ0ICsgMiA8IDEwMDApIHsKICAgICAgICAgICAgb2JqZWN0X3Bvb2xbb2JqZWN0X3N0YXJ0IGFzIHVzaXplICsgMl0gPSAwOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gQ291bnQgcmVmZXJlbmNlcwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IG9iamVjdF9jb3VudCkgewogICAgICAgIGxldCBvYmplY3Rfc3RhcnQ6IGkzMiA9IGkgKiAyMDsKICAgICAgICBpZiAob2JqZWN0X3N0YXJ0ICsgNSA8IDEwMDAgJiYgb2JqZWN0X3Bvb2xbb2JqZWN0X3N0YXJ0IGFzIHVzaXplXSAhPSAwKSB7CiAgICAgICAgICAgIGxldCByZWYxOiBpMzIgPSBvYmplY3RfcG9vbFtvYmplY3Rfc3RhcnQgYXMgdXNpemUgKyAzXTsKICAgICAgICAgICAgbGV0IHJlZjI6IGkzMiA9IG9iamVjdF9wb29sW29iamVjdF9zdGFydCBhcyB1c2l6ZSArIDRdOwoKICAgICAgICAgICAgaWYgKHJlZjEgPiAwICYmIHJlZjEgPCAxMDAwICYmIHJlZjEgKyAyIDwgMTAwMCkgewogICAgICAgICAgICAgICAgb2JqZWN0X3Bvb2xbcmVmMSBhcyB1c2l6ZSArIDJdID0gb2JqZWN0X3Bvb2xbcmVmMSBhcyB1c2l6ZSArIDJdICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocmVmMiA+IDAgJiYgcmVmMiA8IDEwMDAgJiYgcmVmMiArIDIgPCAxMDAwKSB7CiAgICAgICAgICAgICAgICBvYmplY3RfcG9vbFtyZWYyIGFzIHVzaXplICsgMl0gPSBvYmplY3RfcG9vbFtyZWYyIGFzIHVzaXplICsgMl0gKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gRGVjcmVtZW50IHJlZmVyZW5jZSBjb3VudHMgb2Ygb2JqZWN0cyByZWZlcmVuY2VkIGJ5IGEgY29sbGVjdGVkIG9iamVjdApmbiBkZWNyZW1lbnRSZWZlcmVuY2VkT2JqZWN0cyhvYmplY3RfcG9vbDogJm11dCBbaTMyOyAxMDAwXSwgb2JqZWN0X3N0YXJ0OiBpMzIpIHsKICAgIGlmIChvYmplY3Rfc3RhcnQgKyA1IDwgMTAwMCkgewogICAgICAgIGxldCByZWYxOiBpMzIgPSBvYmplY3RfcG9vbFtvYmplY3Rfc3RhcnQgYXMgdXNpemUgKyAzXTsKICAgICAgICBsZXQgcmVmMjogaTMyID0gb2JqZWN0X3Bvb2xbb2JqZWN0X3N0YXJ0IGFzIHVzaXplICsgNF07CgogICAgICAgIGlmIChyZWYxID4gMCAmJiByZWYxICsgMiA8IDEwMDAgJiYgb2JqZWN0X3Bvb2xbcmVmMSBhcyB1c2l6ZSArIDJdID4gMCkgewogICAgICAgICAgICBvYmplY3RfcG9vbFtyZWYxIGFzIHVzaXplICsgMl0gPSBvYmplY3RfcG9vbFtyZWYxIGFzIHVzaXplICsgMl0gLSAxOwogICAgICAgIH0KICAgICAgICBpZiAocmVmMiA+IDAgJiYgcmVmMiArIDIgPCAxMDAwICYmIG9iamVjdF9wb29sW3JlZjIgYXMgdXNpemUgKyAyXSA+IDApIHsKICAgICAgICAgICAgb2JqZWN0X3Bvb2xbcmVmMiBhcyB1c2l6ZSArIDJdID0gb2JqZWN0X3Bvb2xbcmVmMiBhcyB1c2l6ZSArIDJdIC0gMTsKICAgICAgICB9CiAgICB9Cn0KCi8vIE1lbW9yeSBmcmFnbWVudGF0aW9uIGFuZCBjb21wYWN0aW9uIHRlc3RpbmcKZm4gcGVyZm9ybUZyYWdtZW50YXRpb25UZXN0KCkgewogICAgcHJpbnRsbkludCgxODMwKTsgLy8gRnJhZ21lbnRhdGlvbiB0ZXN0IHN0YXJ0CgogICAgLy8gQ3JlYXRlIGEgaGVhdmlseSBmcmFnbWVudGVkIG1lbW9yeSBzY2VuYXJpbwogICAgbGV0IG11dCBmcmFnbWVudGVkX21lbW9yeTogW2kzMjsgMTAwMF0gPSBbMDsgMTAwMF07CiAgICBsZXQgbXV0IGZyZWVfbGlzdDogW2kzMjsgMjAwXSA9IFswOyAyMDBdOwogICAgbGV0IG11dCBhbGxvY2F0ZWRfbGlzdDogW2kzMjsgMjAwXSA9IFswOyAyMDBdOwogICAgbGV0IG11dCBmcmVlX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBhbGxvY2F0ZWRfY291bnQ6IGkzMiA9IDA7CgogICAgLy8gVGVzdCAxOiBDcmVhdGUgZnJhZ21lbnRhdGlvbiBwYXR0ZXJuCiAgICBwcmludGxuSW50KDE4MzEpOyAvLyBDcmVhdGUgZnJhZ21lbnRhdGlvbiBtYXJrZXIKICAgIGNyZWF0ZUZyYWdtZW50YXRpb25QYXR0ZXJuKAogICAgICAgICZtdXQgZnJhZ21lbnRlZF9tZW1vcnksCiAgICAgICAgJm11dCBmcmVlX2xpc3QsCiAgICAgICAgJm11dCBhbGxvY2F0ZWRfbGlzdCwKICAgICAgICAmbXV0IGZyZWVfY291bnQsCiAgICAgICAgJm11dCBhbGxvY2F0ZWRfY291bnQsCiAgICApOwoKICAgIC8vIFRlc3QgMjogTWVhc3VyZSBmcmFnbWVudGF0aW9uCiAgICBwcmludGxuSW50KDE4MzIpOyAvLyBNZWFzdXJlIGZyYWdtZW50YXRpb24gbWFya2VyCiAgICBsZXQgZnJhZ21lbnRhdGlvbl9zY29yZTogaTMyID0gbWVhc3VyZUZyYWdtZW50YXRpb24oJmZyYWdtZW50ZWRfbWVtb3J5LCAxMDAwKTsKICAgIHByaW50bG5JbnQoZnJhZ21lbnRhdGlvbl9zY29yZSk7CgogICAgLy8gVGVzdCAzOiBBdHRlbXB0IGFsbG9jYXRpb24gaW4gZnJhZ21lbnRlZCBtZW1vcnkKICAgIHByaW50bG5JbnQoMTgzMyk7IC8vIEZyYWdtZW50ZWQgYWxsb2NhdGlvbiBtYXJrZXIKICAgIGxldCBzdWNjZXNzZnVsX2FsbG9jczogaTMyID0gYXR0ZW1wdEZyYWdtZW50ZWRBbGxvY2F0aW9ucygmbXV0IGZyYWdtZW50ZWRfbWVtb3J5LCAxMDAwKTsKICAgIHByaW50bG5JbnQoc3VjY2Vzc2Z1bF9hbGxvY3MpOwoKICAgIC8vIFRlc3QgNDogUGVyZm9ybSBtZW1vcnkgY29tcGFjdGlvbgogICAgcHJpbnRsbkludCgxODM0KTsgLy8gQ29tcGFjdGlvbiBtYXJrZXIKICAgIGxldCBjb21wYWN0aW9uX3Jlc3VsdDogaTMyID0gcGVyZm9ybU1lbW9yeUNvbXBhY3Rpb24oJm11dCBmcmFnbWVudGVkX21lbW9yeSwgMTAwMCk7CiAgICBwcmludGxuSW50KGNvbXBhY3Rpb25fcmVzdWx0KTsKCiAgICAvLyBUZXN0IDU6IE1lYXN1cmUgZnJhZ21lbnRhdGlvbiBhZnRlciBjb21wYWN0aW9uCiAgICBwcmludGxuSW50KDE4MzUpOyAvLyBQb3N0LWNvbXBhY3Rpb24gZnJhZ21lbnRhdGlvbiBtYXJrZXIKICAgIGxldCBwb3N0X2NvbXBhY3Rpb25fc2NvcmU6IGkzMiA9IG1lYXN1cmVGcmFnbWVudGF0aW9uKCZmcmFnbWVudGVkX21lbW9yeSwgMTAwMCk7CiAgICBwcmludGxuSW50KHBvc3RfY29tcGFjdGlvbl9zY29yZSk7Cn0KCi8vIENyZWF0ZSBhIHNwZWNpZmljIGZyYWdtZW50YXRpb24gcGF0dGVybgpmbiBjcmVhdGVGcmFnbWVudGF0aW9uUGF0dGVybigKICAgIG1lbW9yeTogJm11dCBbaTMyOyAxMDAwXSwKICAgIGZyZWVfbGlzdDogJm11dCBbaTMyOyAyMDBdLAogICAgYWxsb2NhdGVkX2xpc3Q6ICZtdXQgW2kzMjsgMjAwXSwKICAgIGZyZWVfY291bnQ6ICZtdXQgaTMyLAogICAgYWxsb2NhdGVkX2NvdW50OiAmbXV0IGkzMiwKKSB7CiAgICAvLyBBbGxvY2F0ZSBibG9ja3Mgd2l0aCB2YXJ5aW5nIHNpemVzCiAgICBsZXQgbXV0IHBvczogaTMyID0gMDsKICAgIGxldCBtdXQgcGF0dGVybjogaTMyID0gMDsKCiAgICB3aGlsZSAocG9zIDwgOTUwKSB7CiAgICAgICAgbGV0IGJsb2NrX3NpemU6IGkzMiA9IChwYXR0ZXJuICUgNCArIDEpICogODsgLy8gU2l6ZXM6IDgsIDE2LCAyNCwgMzIKCiAgICAgICAgaWYgKHBhdHRlcm4gJSAzID09IDApIHsKICAgICAgICAgICAgLy8gQWxsb2NhdGUgdGhpcyBibG9jawogICAgICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChpIDwgYmxvY2tfc2l6ZSAmJiBwb3MgKyBpIDwgMTAwMCkgewogICAgICAgICAgICAgICAgbWVtb3J5Wyhwb3MgKyBpKSBhcyB1c2l6ZV0gPSAxOyAvLyBNYXJrIGFzIGFsbG9jYXRlZAogICAgICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgqYWxsb2NhdGVkX2NvdW50IDwgMjAwKSB7CiAgICAgICAgICAgICAgICBhbGxvY2F0ZWRfbGlzdFsqYWxsb2NhdGVkX2NvdW50IGFzIHVzaXplXSA9IHBvczsKICAgICAgICAgICAgICAgICphbGxvY2F0ZWRfY291bnQgPSAqYWxsb2NhdGVkX2NvdW50ICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIExlYXZlIGFzIGZyZWUKICAgICAgICAgICAgaWYgKCpmcmVlX2NvdW50IDwgMjAwKSB7CiAgICAgICAgICAgICAgICBmcmVlX2xpc3RbKmZyZWVfY291bnQgYXMgdXNpemVdID0gcG9zOwogICAgICAgICAgICAgICAgKmZyZWVfY291bnQgPSAqZnJlZV9jb3VudCArIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHBvcyA9IHBvcyArIGJsb2NrX3NpemU7CiAgICAgICAgcGF0dGVybiA9IHBhdHRlcm4gKyAxOwogICAgfQoKICAgIC8vIE5vdyBkZWFsbG9jYXRlIGV2ZXJ5IHRoaXJkIGFsbG9jYXRlZCBibG9jayB0byBjcmVhdGUgaG9sZXMKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgKmFsbG9jYXRlZF9jb3VudCkgewogICAgICAgIGlmIChpICUgMyA9PSAwKSB7CiAgICAgICAgICAgIGxldCBkZWFsbG9jX3BvczogaTMyID0gYWxsb2NhdGVkX2xpc3RbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGxldCBkZWFsbG9jX3NpemU6IGkzMiA9IDE2OyAvLyBBc3N1bWUgYXZlcmFnZSBzaXplCiAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKGogPCBkZWFsbG9jX3NpemUgJiYgZGVhbGxvY19wb3MgKyBqIDwgMTAwMCkgewogICAgICAgICAgICAgICAgbWVtb3J5WyhkZWFsbG9jX3BvcyArIGopIGFzIHVzaXplXSA9IDA7IC8vIE1hcmsgYXMgZnJlZQogICAgICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gTWVhc3VyZSBtZW1vcnkgZnJhZ21lbnRhdGlvbgpmbiBtZWFzdXJlRnJhZ21lbnRhdGlvbihtZW1vcnk6ICZbaTMyOyAxMDAwXSwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBmcmVlX2hvbGVzOiBpMzIgPSAwOwogICAgbGV0IG11dCBsYXJnZXN0X2hvbGU6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGN1cnJlbnRfaG9sZV9zaXplOiBpMzIgPSAwOwogICAgbGV0IG11dCB0b3RhbF9mcmVlOiBpMzIgPSAwOwogICAgbGV0IG11dCBpbl9ob2xlOiBpMzIgPSAwOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGlmIChtZW1vcnlbaSBhcyB1c2l6ZV0gPT0gMCkgewogICAgICAgICAgICAvLyBGcmVlIHNwYWNlCiAgICAgICAgICAgIGlmIChpbl9ob2xlID09IDApIHsKICAgICAgICAgICAgICAgIGZyZWVfaG9sZXMgPSBmcmVlX2hvbGVzICsgMTsKICAgICAgICAgICAgICAgIGluX2hvbGUgPSAxOwogICAgICAgICAgICAgICAgY3VycmVudF9ob2xlX3NpemUgPSAxOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY3VycmVudF9ob2xlX3NpemUgPSBjdXJyZW50X2hvbGVfc2l6ZSArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdG90YWxfZnJlZSA9IHRvdGFsX2ZyZWUgKyAxOwoKICAgICAgICAgICAgaWYgKGN1cnJlbnRfaG9sZV9zaXplID4gbGFyZ2VzdF9ob2xlKSB7CiAgICAgICAgICAgICAgICBsYXJnZXN0X2hvbGUgPSBjdXJyZW50X2hvbGVfc2l6ZTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIEFsbG9jYXRlZCBzcGFjZQogICAgICAgICAgICBpbl9ob2xlID0gMDsKICAgICAgICAgICAgY3VycmVudF9ob2xlX3NpemUgPSAwOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gRnJhZ21lbnRhdGlvbiBzY29yZTogaGlnaGVyIHdoZW4gbWFueSBzbWFsbCBob2xlcyBleGlzdAogICAgaWYgKGZyZWVfaG9sZXMgPiAwICYmIHRvdGFsX2ZyZWUgPiAwKSB7CiAgICAgICAgcmV0dXJuIChmcmVlX2hvbGVzICogMTAwKSAvIChsYXJnZXN0X2hvbGUgKyAxKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9Cn0KCi8vIEF0dGVtcHQgYWxsb2NhdGlvbnMgaW4gZnJhZ21lbnRlZCBtZW1vcnkKZm4gYXR0ZW1wdEZyYWdtZW50ZWRBbGxvY2F0aW9ucyhtZW1vcnk6ICZtdXQgW2kzMjsgMTAwMF0sIHNpemU6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgc3VjY2Vzc2Z1bF9hbGxvY2F0aW9uczogaTMyID0gMDsKICAgIGxldCBhdHRlbXB0X3NpemVzOiBbaTMyOyAxMF0gPSBbOCwgMTYsIDEyLCAyMCwgMjQsIDMyLCA2LCAxMCwgMTQsIDE4XTsKCiAgICBsZXQgbXV0IGF0dGVtcHQ6IGkzMiA9IDA7CiAgICB3aGlsZSAoYXR0ZW1wdCA8IDEwKSB7CiAgICAgICAgbGV0IHJlcXVlc3RlZF9zaXplOiBpMzIgPSBhdHRlbXB0X3NpemVzW2F0dGVtcHQgYXMgdXNpemVdOwogICAgICAgIGxldCBhbGxvY2F0ZWRfcG9zOiBpMzIgPSBmaW5kRnJlZVNwYWNlKG1lbW9yeSwgc2l6ZSwgcmVxdWVzdGVkX3NpemUpOwoKICAgICAgICBpZiAoYWxsb2NhdGVkX3BvcyAhPSAtMSkgewogICAgICAgICAgICAvLyBNYXJrIHNwYWNlIGFzIGFsbG9jYXRlZAogICAgICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChpIDwgcmVxdWVzdGVkX3NpemUgJiYgYWxsb2NhdGVkX3BvcyArIGkgPCBzaXplKSB7CiAgICAgICAgICAgICAgICBtZW1vcnlbKGFsbG9jYXRlZF9wb3MgKyBpKSBhcyB1c2l6ZV0gPSAxOwogICAgICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHN1Y2Nlc3NmdWxfYWxsb2NhdGlvbnMgPSBzdWNjZXNzZnVsX2FsbG9jYXRpb25zICsgMTsKICAgICAgICB9CgogICAgICAgIGF0dGVtcHQgPSBhdHRlbXB0ICsgMTsKICAgIH0KCiAgICByZXR1cm4gc3VjY2Vzc2Z1bF9hbGxvY2F0aW9uczsKfQoKLy8gRmluZCBmcmVlIHNwYWNlIG9mIHJlcXVlc3RlZCBzaXplCmZuIGZpbmRGcmVlU3BhY2UobWVtb3J5OiAmW2kzMjsgMTAwMF0sIHBvb2xfc2l6ZTogaTMyLCByZXF1ZXN0ZWRfc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPD0gcG9vbF9zaXplIC0gcmVxdWVzdGVkX3NpemUpIHsKICAgICAgICBsZXQgbXV0IGZvdW5kX3NwYWNlOiBpMzIgPSAxOwogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IHJlcXVlc3RlZF9zaXplKSB7CiAgICAgICAgICAgIGlmIChtZW1vcnlbKGkgKyBqKSBhcyB1c2l6ZV0gIT0gMCkgewogICAgICAgICAgICAgICAgZm91bmRfc3BhY2UgPSAwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KCiAgICAgICAgaWYgKGZvdW5kX3NwYWNlID09IDEpIHsKICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfQoKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcmV0dXJuIC0xOwp9CgovLyBQZXJmb3JtIG1lbW9yeSBjb21wYWN0aW9uCmZuIHBlcmZvcm1NZW1vcnlDb21wYWN0aW9uKG1lbW9yeTogJm11dCBbaTMyOyAxMDAwXSwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCB3cml0ZV9wb3M6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGNvbXBhY3RlZF9ibG9ja3M6IGkzMiA9IDA7CgogICAgbGV0IG11dCByZWFkX3BvczogaTMyID0gMDsKICAgIHdoaWxlIChyZWFkX3BvcyA8IHNpemUpIHsKICAgICAgICBpZiAobWVtb3J5W3JlYWRfcG9zIGFzIHVzaXplXSA9PSAxKSB7CiAgICAgICAgICAgIC8vIEFsbG9jYXRlZCBibG9jawogICAgICAgICAgICAvLyBGaW5kIHRoZSBzaXplIG9mIHRoaXMgYWxsb2NhdGVkIGJsb2NrCiAgICAgICAgICAgIGxldCBtdXQgYmxvY2tfc2l6ZTogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKHJlYWRfcG9zICsgYmxvY2tfc2l6ZSA8IHNpemUgJiYgbWVtb3J5WyhyZWFkX3BvcyArIGJsb2NrX3NpemUpIGFzIHVzaXplXSA9PSAxKSB7CiAgICAgICAgICAgICAgICBibG9ja19zaXplID0gYmxvY2tfc2l6ZSArIDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIE1vdmUgYmxvY2sgdG8gd3JpdGUgcG9zaXRpb24gaWYgbmVjZXNzYXJ5CiAgICAgICAgICAgIGlmIChyZWFkX3BvcyAhPSB3cml0ZV9wb3MpIHsKICAgICAgICAgICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICAgICAgICAgIHdoaWxlIChpIDwgYmxvY2tfc2l6ZSkgewogICAgICAgICAgICAgICAgICAgIG1lbW9yeVsod3JpdGVfcG9zICsgaSkgYXMgdXNpemVdID0gMTsKICAgICAgICAgICAgICAgICAgICBtZW1vcnlbKHJlYWRfcG9zICsgaSkgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHdyaXRlX3BvcyA9IHdyaXRlX3BvcyArIGJsb2NrX3NpemU7CiAgICAgICAgICAgIHJlYWRfcG9zID0gcmVhZF9wb3MgKyBibG9ja19zaXplOwogICAgICAgICAgICBjb21wYWN0ZWRfYmxvY2tzID0gY29tcGFjdGVkX2Jsb2NrcyArIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVhZF9wb3MgPSByZWFkX3BvcyArIDE7CiAgICAgICAgfQogICAgfQoKICAgIC8vIENsZWFyIHJlbWFpbmluZyBzcGFjZQogICAgd2hpbGUgKHdyaXRlX3BvcyA8IHNpemUpIHsKICAgICAgICBtZW1vcnlbd3JpdGVfcG9zIGFzIHVzaXplXSA9IDA7CiAgICAgICAgd3JpdGVfcG9zID0gd3JpdGVfcG9zICsgMTsKICAgIH0KCiAgICByZXR1cm4gY29tcGFjdGVkX2Jsb2NrczsKfQoKLy8gVGVzdCBlZGdlIGNhc2VzIGFuZCBzdHJlc3Mgc2NlbmFyaW9zCmZuIHRlc3RNZW1vcnlFZGdlQ2FzZXMoKSB7CiAgICBwcmludGxuSW50KDE4NDApOyAvLyBFZGdlIGNhc2VzIHN0YXJ0CgogICAgLy8gVGVzdCAxOiBaZXJvLXNpemUgYWxsb2NhdGlvbnMKICAgIHRlc3RaZXJvU2l6ZUFsbG9jYXRpb25zKCk7CgogICAgLy8gVGVzdCAyOiBNYXhpbXVtIHNpemUgYWxsb2NhdGlvbnMKCiAgICB0ZXN0TWF4U2l6ZUFsbG9jYXRpb25zKCk7CgogICAgLy8gVGVzdCAzOiBBbGxvY2F0aW9uIGZhaWx1cmUgc2NlbmFyaW9zCiAgICB0ZXN0QWxsb2NhdGlvbkZhaWx1cmVzKCk7CgogICAgLy8gVGVzdCA0OiBEb3VibGUgZnJlZSBkZXRlY3Rpb24KICAgIHRlc3REb3VibGVGcmVlRGV0ZWN0aW9uKCk7CgogICAgLy8gVGVzdCA1OiBNZW1vcnkgY29ycnVwdGlvbiBkZXRlY3Rpb24KICAgIHRlc3RNZW1vcnlDb3JydXB0aW9uKCk7CgogICAgcHJpbnRsbkludCgxODQ5KTsgLy8gRWRnZSBjYXNlcyBlbmQKfQoKLy8gVGVzdCB6ZXJvLXNpemUgYWxsb2NhdGlvbiBoYW5kbGluZwpmbiB0ZXN0WmVyb1NpemVBbGxvY2F0aW9ucygpIHsKICAgIHByaW50bG5JbnQoMTg0MSk7IC8vIFplcm8tc2l6ZSB0ZXN0IG1hcmtlcgoKICAgIGxldCBtdXQgdGVzdF9tZW1vcnk6IFtpMzI7IDEwMF0gPSBbMDsgMTAwXTsKICAgIGluaXRpYWxpemVNZW1vcnlQb29sMTAwKCZtdXQgdGVzdF9tZW1vcnkpOwoKICAgIC8vIEF0dGVtcHQgemVyby1zaXplIGFsbG9jYXRpb24KICAgIGxldCB6ZXJvX2FsbG9jOiBpMzIgPSBhbGxvY2F0ZUJsb2NrMTAwKCZtdXQgdGVzdF9tZW1vcnksIDAsIDApOwogICAgcHJpbnRsbkludCh6ZXJvX2FsbG9jKTsgLy8gU2hvdWxkIGZhaWwgKC0xKQoKICAgIC8vIEF0dGVtcHQgbmVnYXRpdmUgc2l6ZSBhbGxvY2F0aW9uCiAgICBsZXQgbmVnYXRpdmVfYWxsb2M6IGkzMiA9IGFsbG9jYXRlQmxvY2sxMDAoJm11dCB0ZXN0X21lbW9yeSwgMCwgLTUpOwogICAgcHJpbnRsbkludChuZWdhdGl2ZV9hbGxvYyk7IC8vIFNob3VsZCBmYWlsICgtMSkKfQoKLy8gVGVzdCBtYXhpbXVtIHNpemUgYWxsb2NhdGlvbnMKZm4gdGVzdE1heFNpemVBbGxvY2F0aW9ucygpIHsKICAgIHByaW50bG5JbnQoMTg0Mik7IC8vIE1heCBzaXplIHRlc3QgbWFya2VyCgogICAgbGV0IG11dCB0ZXN0X21lbW9yeTogW2kzMjsgMTAwXSA9IFswOyAxMDBdOwogICAgaW5pdGlhbGl6ZU1lbW9yeVBvb2wxMDAoJm11dCB0ZXN0X21lbW9yeSk7CgogICAgLy8gQXR0ZW1wdCBhbGxvY2F0aW9uIGxhcmdlciB0aGFuIGF2YWlsYWJsZSBtZW1vcnkKICAgIGxldCBodWdlX2FsbG9jOiBpMzIgPSBhbGxvY2F0ZUJsb2NrMTAwKCZtdXQgdGVzdF9tZW1vcnksIDAsIDIwMCk7CiAgICBwcmludGxuSW50KGh1Z2VfYWxsb2MpOyAvLyBTaG91bGQgZmFpbCAoLTEpCgogICAgLy8gQXR0ZW1wdCBhbGxvY2F0aW9uIGV4YWN0bHkgYXQgbGltaXQKICAgIGxldCBsaW1pdF9hbGxvYzogaTMyID0gYWxsb2NhdGVCbG9jazEwMCgmbXV0IHRlc3RfbWVtb3J5LCAwLCA5Nik7CiAgICBwcmludGxuSW50KGxpbWl0X2FsbG9jKTsgLy8gU2hvdWxkIHN1Y2NlZWQgKDApCn0KCi8vIFRlc3QgYWxsb2NhdGlvbiBmYWlsdXJlIHNjZW5hcmlvcwpmbiB0ZXN0QWxsb2NhdGlvbkZhaWx1cmVzKCkgewogICAgcHJpbnRsbkludCgxODQzKTsgLy8gQWxsb2NhdGlvbiBmYWlsdXJlIG1hcmtlcgoKICAgIGxldCBtdXQgdGVzdF9tZW1vcnk6IFtpMzI7IDUwXSA9IFswOyA1MF07CiAgICBpbml0aWFsaXplTWVtb3J5UG9vbDUwKCZtdXQgdGVzdF9tZW1vcnkpOwoKICAgIGxldCBtdXQgYWxsb2NhdGlvbnM6IFtpMzI7IDEwXSA9IFswOyAxMF07CiAgICBsZXQgbXV0IGFsbG9jX2NvdW50OiBpMzIgPSAwOwoKICAgIC8vIEFsbG9jYXRlIHVudGlsIG1lbW9yeSBpcyBleGhhdXN0ZWQKICAgIGxldCBtdXQgc2l6ZTogaTMyID0gODsKICAgIHdoaWxlIChhbGxvY19jb3VudCA8IDEwKSB7CiAgICAgICAgbGV0IGFsbG9jX3Jlc3VsdDogaTMyID0gYWxsb2NhdGVCbG9jazUwKCZtdXQgdGVzdF9tZW1vcnksIDAsIHNpemUpOwogICAgICAgIGlmIChhbGxvY19yZXN1bHQgPT0gLTEpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGFsbG9jYXRpb25zW2FsbG9jX2NvdW50IGFzIHVzaXplXSA9IGFsbG9jX3Jlc3VsdDsKICAgICAgICBhbGxvY19jb3VudCA9IGFsbG9jX2NvdW50ICsgMTsKICAgICAgICBzaXplID0gc2l6ZSArIDI7CiAgICB9CgogICAgcHJpbnRsbkludChhbGxvY19jb3VudCk7CgogICAgLy8gVHJ5IG9uZSBtb3JlIGFsbG9jYXRpb24gKHNob3VsZCBmYWlsKQogICAgbGV0IGZpbmFsX2FsbG9jOiBpMzIgPSBhbGxvY2F0ZUJsb2NrNTAoJm11dCB0ZXN0X21lbW9yeSwgMCwgNCk7CiAgICBwcmludGxuSW50KGZpbmFsX2FsbG9jKTsgLy8gU2hvdWxkIGJlIC0xCn0KCi8vIFRlc3QgZG91YmxlIGZyZWUgZGV0ZWN0aW9uCmZuIHRlc3REb3VibGVGcmVlRGV0ZWN0aW9uKCkgewogICAgcHJpbnRsbkludCgxODQ0KTsgLy8gRG91YmxlIGZyZWUgbWFya2VyCgogICAgbGV0IG11dCB0ZXN0X21lbW9yeTogW2kzMjsgMTAwXSA9IFswOyAxMDBdOwogICAgaW5pdGlhbGl6ZU1lbW9yeVBvb2wxMDAoJm11dCB0ZXN0X21lbW9yeSk7CgogICAgLy8gQWxsb2NhdGUgYSBibG9jawogICAgbGV0IGFsbG9jYXRlZF9ibG9jazogaTMyID0gYWxsb2NhdGVCbG9jazEwMCgmbXV0IHRlc3RfbWVtb3J5LCAwLCAxNik7CiAgICBwcmludGxuSW50KGFsbG9jYXRlZF9ibG9jayk7CgogICAgLy8gRnJlZSBpdCBvbmNlCiAgICBkZWFsbG9jYXRlQmxvY2sxMDAoJm11dCB0ZXN0X21lbW9yeSwgYWxsb2NhdGVkX2Jsb2NrKTsKICAgIGxldCBzdGF0dXNfYWZ0ZXJfZmlyc3RfZnJlZTogaTMyID0gdGVzdF9tZW1vcnlbYWxsb2NhdGVkX2Jsb2NrIGFzIHVzaXplICsgMV07CiAgICBwcmludGxuSW50KHN0YXR1c19hZnRlcl9maXJzdF9mcmVlKTsgLy8gU2hvdWxkIGJlIDAgKGZyZWUpCgogICAgLy8gVHJ5IHRvIGZyZWUgaXQgYWdhaW4gKGRvdWJsZSBmcmVlKQogICAgZGVhbGxvY2F0ZUJsb2NrMTAwKCZtdXQgdGVzdF9tZW1vcnksIGFsbG9jYXRlZF9ibG9jayk7CiAgICBsZXQgc3RhdHVzX2FmdGVyX2RvdWJsZV9mcmVlOiBpMzIgPSB0ZXN0X21lbW9yeVthbGxvY2F0ZWRfYmxvY2sgYXMgdXNpemUgKyAxXTsKICAgIHByaW50bG5JbnQoc3RhdHVzX2FmdGVyX2RvdWJsZV9mcmVlKTsgLy8gU2hvdWxkIHN0aWxsIGJlIDAsIGJ1dCB0aGlzIGlzIGEgYnVnCn0KCi8vIFRlc3QgbWVtb3J5IGNvcnJ1cHRpb24gZGV0ZWN0aW9uCmZuIHRlc3RNZW1vcnlDb3JydXB0aW9uKCkgewogICAgcHJpbnRsbkludCgxODQ1KTsgLy8gQ29ycnVwdGlvbiB0ZXN0IG1hcmtlcgoKICAgIGxldCBtdXQgdGVzdF9tZW1vcnk6IFtpMzI7IDIwMF0gPSBbMDsgMjAwXTsKICAgIGluaXRpYWxpemVNZW1vcnlQb29sMjAwKCZtdXQgdGVzdF9tZW1vcnkpOwoKICAgIC8vIEFsbG9jYXRlIHNldmVyYWwgYmxvY2tzCiAgICBsZXQgYmxvY2sxOiBpMzIgPSBhbGxvY2F0ZUJsb2NrMjAwKCZtdXQgdGVzdF9tZW1vcnksIDAsIDIwKTsKICAgIGxldCBibG9jazI6IGkzMiA9IGFsbG9jYXRlQmxvY2syMDAoJm11dCB0ZXN0X21lbW9yeSwgMCwgMjQpOwogICAgbGV0IGJsb2NrMzogaTMyID0gYWxsb2NhdGVCbG9jazIwMCgmbXV0IHRlc3RfbWVtb3J5LCAwLCAxNik7CgogICAgLy8gU2ltdWxhdGUgY29ycnVwdGlvbiBieSB3cml0aW5nIHBhc3QgYmxvY2sgYm91bmRhcnkKICAgIGlmIChibG9jazEgPj0gMCAmJiBibG9jazEgKyAzMCA8IDIwMCkgewogICAgICAgIHRlc3RfbWVtb3J5W2Jsb2NrMSBhcyB1c2l6ZSArIDI1XSA9IDk5OTk5OyAvLyBXcml0ZSBwYXN0IGFsbG9jYXRlZCBib3VuZGFyeQogICAgfQoKICAgIC8vIFRyeSB0byBkZXRlY3QgY29ycnVwdGlvbgogICAgbGV0IGNvcnJ1cHRpb25fZGV0ZWN0ZWQ6IGkzMiA9IGRldGVjdE1lbW9yeUNvcnJ1cHRpb24oJnRlc3RfbWVtb3J5LCAyMDApOwogICAgcHJpbnRsbkludChjb3JydXB0aW9uX2RldGVjdGVkKTsKCiAgICAvLyBWZXJpZnkgb3RoZXIgYmxvY2tzIGFyZSBzdGlsbCB2YWxpZAogICAgbGV0IHZhbGlkYXRpb25fcmVzdWx0OiBpMzIgPSB2YWxpZGF0ZU1lbW9yeUludGVncml0eSgmdGVzdF9tZW1vcnksIDIwMCk7CiAgICBwcmludGxuSW50KHZhbGlkYXRpb25fcmVzdWx0KTsKfQoKLy8gSGVscGVyIGZ1bmN0aW9ucyBmb3IgZWRnZSBjYXNlIHRlc3RpbmcKCmZuIGluaXRpYWxpemVNZW1vcnlQb29sMTAwKG1lbW9yeTogJm11dCBbaTMyOyAxMDBdKSB7CiAgICBtZW1vcnlbMF0gPSA5NjsgLy8gU2l6ZSBvZiBmcmVlIHNwYWNlCiAgICBtZW1vcnlbMV0gPSAwOyAvLyBTdGF0dXM6IGZyZWUKICAgIG1lbW9yeVsyXSA9IC0xOyAvLyBOZXh0IGZyZWU6IG5vbmUKICAgIG1lbW9yeVszXSA9IC0xOyAvLyBQcmV2IGZyZWU6IG5vbmUKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDQ7CiAgICB3aGlsZSAoaSA8IDEwMCkgewogICAgICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IDA7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgpmbiBpbml0aWFsaXplTWVtb3J5UG9vbDUwKG1lbW9yeTogJm11dCBbaTMyOyA1MF0pIHsKICAgIG1lbW9yeVswXSA9IDQ2OyAvLyBTaXplIG9mIGZyZWUgc3BhY2UKICAgIG1lbW9yeVsxXSA9IDA7IC8vIFN0YXR1czogZnJlZQogICAgbWVtb3J5WzJdID0gLTE7IC8vIE5leHQgZnJlZTogbm9uZQogICAgbWVtb3J5WzNdID0gLTE7IC8vIFByZXYgZnJlZTogbm9uZQoKICAgIGxldCBtdXQgaTogaTMyID0gNDsKICAgIHdoaWxlIChpIDwgNTApIHsKICAgICAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSAwOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKZm4gaW5pdGlhbGl6ZU1lbW9yeVBvb2wyMDAobWVtb3J5OiAmbXV0IFtpMzI7IDIwMF0pIHsKICAgIG1lbW9yeVswXSA9IDE5NjsgLy8gU2l6ZSBvZiBmcmVlIHNwYWNlCiAgICBtZW1vcnlbMV0gPSAwOyAvLyBTdGF0dXM6IGZyZWUKICAgIG1lbW9yeVsyXSA9IC0xOyAvLyBOZXh0IGZyZWU6IG5vbmUKICAgIG1lbW9yeVszXSA9IC0xOyAvLyBQcmV2IGZyZWU6IG5vbmUKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDQ7CiAgICB3aGlsZSAoaSA8IDIwMCkgewogICAgICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IDA7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgpmbiBhbGxvY2F0ZUJsb2NrMTAwKG1lbW9yeTogJm11dCBbaTMyOyAxMDBdLCBmcmVlX2hlYWQ6IGkzMiwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgaWYgKHNpemUgPD0gMCB8fCBzaXplID4gOTYpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CgogICAgaWYgKG1lbW9yeVsxXSA9PSAwICYmIG1lbW9yeVswXSA+PSBzaXplKSB7CiAgICAgICAgbWVtb3J5WzBdID0gc2l6ZTsKICAgICAgICBtZW1vcnlbMV0gPSAxOyAvLyBBbGxvY2F0ZWQKICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAgICByZXR1cm4gLTE7Cn0KCmZuIGFsbG9jYXRlQmxvY2s1MChtZW1vcnk6ICZtdXQgW2kzMjsgNTBdLCBmcmVlX2hlYWQ6IGkzMiwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgaWYgKHNpemUgPD0gMCB8fCBzaXplID4gNDYpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CgogICAgLy8gU2ltcGxlIGFsbG9jYXRpb24gLSBmaW5kIGZpcnN0IGZpdAogICAgbGV0IG11dCBwb3M6IGkzMiA9IDA7CiAgICB3aGlsZSAocG9zIDw9IDQ2IC0gc2l6ZSkgewogICAgICAgIGlmIChtZW1vcnlbcG9zIGFzIHVzaXplICsgMV0gPT0gMCkgewogICAgICAgICAgICAvLyBGcmVlIGJsb2NrCiAgICAgICAgICAgIGxldCBhdmFpbGFibGVfc2l6ZTogaTMyID0gbWVtb3J5W3BvcyBhcyB1c2l6ZV07CiAgICAgICAgICAgIGlmIChhdmFpbGFibGVfc2l6ZSA+PSBzaXplKSB7CiAgICAgICAgICAgICAgICBtZW1vcnlbcG9zIGFzIHVzaXplXSA9IHNpemU7CiAgICAgICAgICAgICAgICBtZW1vcnlbcG9zIGFzIHVzaXplICsgMV0gPSAxOyAvLyBBbGxvY2F0ZWQKICAgICAgICAgICAgICAgIHJldHVybiBwb3M7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcG9zID0gcG9zICsgbWVtb3J5W3BvcyBhcyB1c2l6ZV0gKyA0OyAvLyBNb3ZlIHRvIG5leHQgYmxvY2sKICAgIH0KCiAgICByZXR1cm4gLTE7Cn0KCmZuIGFsbG9jYXRlQmxvY2syMDAobWVtb3J5OiAmbXV0IFtpMzI7IDIwMF0sIGZyZWVfaGVhZDogaTMyLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoc2l6ZSA8PSAwIHx8IHNpemUgPiAxOTYpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CgogICAgaWYgKG1lbW9yeVsxXSA9PSAwICYmIG1lbW9yeVswXSA+PSBzaXplKSB7CiAgICAgICAgbWVtb3J5WzBdID0gc2l6ZTsKICAgICAgICBtZW1vcnlbMV0gPSAxOyAvLyBBbGxvY2F0ZWQKICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAgICByZXR1cm4gLTE7Cn0KCmZuIGRlYWxsb2NhdGVCbG9jazEwMChtZW1vcnk6ICZtdXQgW2kzMjsgMTAwXSwgYmxvY2tfc3RhcnQ6IGkzMikgewogICAgaWYgKGJsb2NrX3N0YXJ0ID49IDAgJiYgYmxvY2tfc3RhcnQgKyAxIDwgMTAwKSB7CiAgICAgICAgbWVtb3J5W2Jsb2NrX3N0YXJ0IGFzIHVzaXplICsgMV0gPSAwOyAvLyBTdGF0dXM6IGZyZWUKICAgIH0KfQoKZm4gZGV0ZWN0TWVtb3J5Q29ycnVwdGlvbihtZW1vcnk6ICZbaTMyOyAyMDBdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGNvcnJ1cHRpb25fY291bnQ6IGkzMiA9IDA7CgogICAgLy8gTG9vayBmb3Igc3VzcGljaW91cyB2YWx1ZXMgb3IgcGF0dGVybnMKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGlmIChtZW1vcnlbaSBhcyB1c2l6ZV0gPiAxMDAwMCB8fCBtZW1vcnlbaSBhcyB1c2l6ZV0gPCAtMTAwMCkgewogICAgICAgICAgICBjb3JydXB0aW9uX2NvdW50ID0gY29ycnVwdGlvbl9jb3VudCArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZXR1cm4gY29ycnVwdGlvbl9jb3VudDsKfQoKZm4gdmFsaWRhdGVNZW1vcnlJbnRlZ3JpdHkobWVtb3J5OiAmW2kzMjsgMjAwXSwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCB2YWxpZF9ibG9ja3M6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgd2hpbGUgKGkgPCBzaXplIC0gNCkgewogICAgICAgIGlmIChtZW1vcnlbaSBhcyB1c2l6ZV0gPiAwCiAgICAgICAgICAgICYmIG1lbW9yeVtpIGFzIHVzaXplXSA8PSAxMDAKICAgICAgICAgICAgJiYgKG1lbW9yeVtpIGFzIHVzaXplICsgMV0gPT0gMCB8fCBtZW1vcnlbaSBhcyB1c2l6ZSArIDFdID09IDEpKQogICAgICAgIHsKICAgICAgICAgICAgdmFsaWRfYmxvY2tzID0gdmFsaWRfYmxvY2tzICsgMTsKICAgICAgICB9CgogICAgICAgIGxldCBibG9ja19zaXplOiBpMzIgPSBtZW1vcnlbaSBhcyB1c2l6ZV0gKyA0OwogICAgICAgIGlmIChibG9ja19zaXplID4gMCAmJiBibG9ja19zaXplIDwgNTApIHsKICAgICAgICAgICAgaSA9IGkgKyBibG9ja19zaXplOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGkgPSBpICsgNDsgLy8gU2tpcCBwb3RlbnRpYWxseSBjb3JydXB0ZWQgYmxvY2sKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIHZhbGlkX2Jsb2NrczsKfQoK", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (19, "comprehensive19", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlMTkKQXV0aG9yOiBXZW54aW4gWmhlbmcKVGltZTogMjAyNS0wOC0xNwpWZXJkaWN0OiBQYXNzCkNvbW1lbnQ6IENvbXByZWhlbnNpdmUgdGVzdCBvZiBjb21wbGV4IGRhdGEgc3RydWN0dXJlcyB3aXRoIG1lbW9yeSBtYW5hZ2VtZW50IHNpbXVsYXRpb24KICAgICAgICAgVGVzdHM6IExpbmtlZCBMaXN0LCBTdGFjaywgUXVldWUsIEhhc2ggVGFibGUsIE1lbW9yeSBQb29sIEFsbG9jYXRvcgogICAgICAgICBGb2N1czogQ29tcGxleCBwb2ludGVyIG9wZXJhdGlvbnMsIGR5bmFtaWMgbWVtb3J5IG1hbmFnZW1lbnQgc2ltdWxhdGlvbiwKICAgICAgICAgICAgICAgY29sbGlzaW9uIGhhbmRsaW5nLCBkYXRhIHN0cnVjdHVyZSBjb21wb3NpdGlvbiwgY29ybmVyIGNhc2VzCiovCgovLyBDb25zdGFudHMgZm9yIGRhdGEgc3RydWN0dXJlIHNpemVzIGFuZCBsaW1pdHMKY29uc3QgTUFYX05PREVTOiB1c2l6ZSA9IDEwMDA7CmNvbnN0IEhBU0hfVEFCTEVfU0laRTogdXNpemUgPSAxMjc7IC8vIFByaW1lIG51bWJlciBmb3IgYmV0dGVyIGRpc3RyaWJ1dGlvbgpjb25zdCBNRU1PUllfUE9PTF9TSVpFOiB1c2l6ZSA9IDIwMDA7CmNvbnN0IE5VTExfSU5ERVg6IGkzMiA9IC0xOwpjb25zdCBTVEFDS19TSVpFOiB1c2l6ZSA9IDUwMDsKY29uc3QgUVVFVUVfU0laRTogdXNpemUgPSA1MDA7CgovLyBOb2RlIHN0cnVjdHVyZSBmb3IgbGlua2VkIGxpc3Qgb3BlcmF0aW9ucwpzdHJ1Y3QgTGlzdE5vZGUgewogICAgZGF0YTogaTMyLAogICAgbmV4dDogaTMyLCAvLyBJbmRleCBpbiBtZW1vcnkgcG9vbCBpbnN0ZWFkIG9mIHBvaW50ZXIKfQoKLy8gSGFzaCB0YWJsZSBlbnRyeSB3aXRoIGNoYWluaW5nIGZvciBjb2xsaXNpb24gcmVzb2x1dGlvbgpzdHJ1Y3QgSGFzaEVudHJ5IHsKICAgIGtleTogaTMyLAogICAgdmFsdWU6IGkzMiwKICAgIG5leHQ6IGkzMiwgLy8gTmV4dCBlbnRyeSBpbiBjaGFpbgogICAgaXNfdXNlZDogYm9vbCwKfQoKLy8gU3RhY2sgaW1wbGVtZW50YXRpb24gdXNpbmcgYXJyYXkKc3RydWN0IFN0YWNrIHsKICAgIGRhdGE6IFtpMzI7IFNUQUNLX1NJWkVdLAogICAgdG9wOiBpMzIsCiAgICBjYXBhY2l0eTogaTMyLAp9CgovLyBRdWV1ZSBpbXBsZW1lbnRhdGlvbiB1c2luZyBjaXJjdWxhciBhcnJheQpzdHJ1Y3QgUXVldWUgewogICAgZGF0YTogW2kzMjsgUVVFVUVfU0laRV0sCiAgICBmcm9udDogaTMyLAogICAgcmVhcjogaTMyLAogICAgc2l6ZTogaTMyLAogICAgY2FwYWNpdHk6IGkzMiwKfQoKLy8gTWVtb3J5IHBvb2wgYWxsb2NhdG9yIHNpbXVsYXRpb24Kc3RydWN0IE1lbW9yeVBvb2wgewogICAgbm9kZXM6IFtMaXN0Tm9kZTsgTUVNT1JZX1BPT0xfU0laRV0sCiAgICBmcmVlX2xpc3Q6IGkzMiwgLy8gSGVhZCBvZiBmcmVlIGxpc3QKICAgIGFsbG9jYXRlZF9jb3VudDogaTMyLAogICAgbmV4dF9pbmRleDogaTMyLAp9CgovLyBIYXNoIHRhYmxlIHdpdGggc2VwYXJhdGUgY2hhaW5pbmcKc3RydWN0IEhhc2hUYWJsZSB7CiAgICBidWNrZXRzOiBbaTMyOyBIQVNIX1RBQkxFX1NJWkVdLCAvLyBIZWFkcyBvZiBjaGFpbnMKICAgIGVudHJpZXM6IFtIYXNoRW50cnk7IE1BWF9OT0RFU10sCiAgICBlbnRyeV9jb3VudDogaTMyLAp9CgovLyBDb21wbGV4IGxpbmtlZCBsaXN0IG1hbmFnZXIKc3RydWN0IExpbmtlZExpc3RNYW5hZ2VyIHsKICAgIGhlYWRzOiBbaTMyOyAxMF0sIC8vIE11bHRpcGxlIGxpc3RzCiAgICBsaXN0X2NvdW50OiBpMzIsCiAgICB0b3RhbF9ub2RlczogaTMyLAp9CgovLyBJbml0aWFsaXplIG1lbW9yeSBwb29sCmZuIGluaXRfbWVtb3J5X3Bvb2woKSAtPiBNZW1vcnlQb29sIHsKICAgIGxldCBtdXQgcG9vbDogTWVtb3J5UG9vbCA9IE1lbW9yeVBvb2wgewogICAgICAgIG5vZGVzOiBbTGlzdE5vZGUgewogICAgICAgICAgICBkYXRhOiAwLAogICAgICAgICAgICBuZXh0OiBOVUxMX0lOREVYLAogICAgICAgIH07IE1FTU9SWV9QT09MX1NJWkVdLAogICAgICAgIGZyZWVfbGlzdDogMCwKICAgICAgICBhbGxvY2F0ZWRfY291bnQ6IDAsCiAgICAgICAgbmV4dF9pbmRleDogMCwKICAgIH07CgogICAgLy8gSW5pdGlhbGl6ZSBmcmVlIGxpc3QgLSBsaW5rIGFsbCBub2RlcwogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICB3aGlsZSAoaSA8IE1FTU9SWV9QT09MX1NJWkUgLSAxKSB7CiAgICAgICAgcG9vbC5ub2Rlc1tpXS5uZXh0ID0gaSBhcyBpMzIgKyAxOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHBvb2wubm9kZXNbTUVNT1JZX1BPT0xfU0laRSBhcyB1c2l6ZSAtIDFdLm5leHQgPSBOVUxMX0lOREVYOwoKICAgIHBvb2wKfQoKLy8gQWxsb2NhdGUgbm9kZSBmcm9tIG1lbW9yeSBwb29sCmZuIGFsbG9jYXRlX25vZGUocG9vbDogJm11dCBNZW1vcnlQb29sLCBkYXRhOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAocG9vbC5mcmVlX2xpc3QgPT0gTlVMTF9JTkRFWCkgewogICAgICAgIHJldHVybiBOVUxMX0lOREVYOyAvLyBPdXQgb2YgbWVtb3J5CiAgICB9CgogICAgbGV0IGFsbG9jYXRlZF9pbmRleDogaTMyID0gcG9vbC5mcmVlX2xpc3Q7CiAgICBsZXQgYWxsb2NhdGVkX2luZGV4OiBpMzIgPSBwb29sLmZyZWVfbGlzdDsKICAgIHBvb2wuZnJlZV9saXN0ID0gcG9vbC5ub2Rlc1thbGxvY2F0ZWRfaW5kZXggYXMgdXNpemVdLm5leHQ7CgogICAgcG9vbC5ub2Rlc1thbGxvY2F0ZWRfaW5kZXggYXMgdXNpemVdLmRhdGEgPSBkYXRhOwogICAgcG9vbC5ub2Rlc1thbGxvY2F0ZWRfaW5kZXggYXMgdXNpemVdLm5leHQgPSBOVUxMX0lOREVYOwogICAgcG9vbC5hbGxvY2F0ZWRfY291bnQgPSBwb29sLmFsbG9jYXRlZF9jb3VudCArIDE7CgogICAgYWxsb2NhdGVkX2luZGV4Cn0KCi8vIERlYWxsb2NhdGUgbm9kZSBiYWNrIHRvIG1lbW9yeSBwb29sCmZuIGRlYWxsb2NhdGVfbm9kZShwb29sOiAmbXV0IE1lbW9yeVBvb2wsIGluZGV4OiBpMzIpIHsKICAgIGlmIChpbmRleCA9PSBOVUxMX0lOREVYKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIHBvb2wubm9kZXNbaW5kZXggYXMgdXNpemVdLm5leHQgPSBwb29sLmZyZWVfbGlzdDsKICAgIHBvb2wuZnJlZV9saXN0ID0gaW5kZXg7CiAgICBwb29sLmFsbG9jYXRlZF9jb3VudCA9IHBvb2wuYWxsb2NhdGVkX2NvdW50IC0gMTsKfQoKLy8gSW5pdGlhbGl6ZSBzdGFjawpmbiBpbml0X3N0YWNrKCkgLT4gU3RhY2sgewogICAgU3RhY2sgewogICAgICAgIGRhdGE6IFswOyBTVEFDS19TSVpFXSwKICAgICAgICB0b3A6IC0xLAogICAgICAgIGNhcGFjaXR5OiBTVEFDS19TSVpFIGFzIGkzMiwKICAgIH0KfQoKLy8gUHVzaCB0byBzdGFjawpmbiBzdGFja19wdXNoKHN0YWNrOiAmbXV0IFN0YWNrLCB2YWx1ZTogaTMyKSAtPiBib29sIHsKICAgIGlmIChzdGFjay50b3AgPj0gc3RhY2suY2FwYWNpdHkgLSAxKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBTdGFjayBvdmVyZmxvdwogICAgfQoKICAgIHN0YWNrLnRvcCA9IHN0YWNrLnRvcCArIDE7CiAgICBzdGFjay5kYXRhWyhzdGFjay50b3ApIGFzIHVzaXplXSA9IHZhbHVlOwogICAgdHJ1ZQp9CgovLyBQb3AgZnJvbSBzdGFjawpmbiBzdGFja19wb3Aoc3RhY2s6ICZtdXQgU3RhY2spIC0+IGkzMiB7CiAgICBpZiAoc3RhY2sudG9wIDwgMCkgewogICAgICAgIHJldHVybiAtOTk5OTk5OyAvLyBTdGFjayB1bmRlcmZsb3cgaW5kaWNhdG9yCiAgICB9CgogICAgbGV0IHZhbHVlOiBpMzIgPSBzdGFjay5kYXRhWyhzdGFjay50b3ApIGFzIHVzaXplXTsKICAgIGxldCB2YWx1ZTogaTMyID0gc3RhY2suZGF0YVsoc3RhY2sudG9wKSBhcyB1c2l6ZV07CiAgICBzdGFjay50b3AgPSBzdGFjay50b3AgLSAxOwogICAgdmFsdWUKfQoKLy8gQ2hlY2sgaWYgc3RhY2sgaXMgZW1wdHkKZm4gc3RhY2tfaXNfZW1wdHkoc3RhY2s6ICZTdGFjaykgLT4gYm9vbCB7CiAgICBzdGFjay50b3AgPCAwCn0KCi8vIEluaXRpYWxpemUgcXVldWUKZm4gaW5pdF9xdWV1ZSgpIC0+IFF1ZXVlIHsKICAgIFF1ZXVlIHsKICAgICAgICBkYXRhOiBbMDsgUVVFVUVfU0laRV0sCiAgICAgICAgZnJvbnQ6IDAsCiAgICAgICAgcmVhcjogMCwKICAgICAgICBzaXplOiAwLAogICAgICAgIGNhcGFjaXR5OiBRVUVVRV9TSVpFIGFzIGkzMiwKICAgIH0KfQoKLy8gRW5xdWV1ZSB0byBxdWV1ZQpmbiBxdWV1ZV9lbnF1ZXVlKHF1ZXVlOiAmbXV0IFF1ZXVlLCB2YWx1ZTogaTMyKSAtPiBib29sIHsKICAgIGlmIChxdWV1ZS5zaXplID49IHF1ZXVlLmNhcGFjaXR5KSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBRdWV1ZSBvdmVyZmxvdwogICAgfQoKICAgIHF1ZXVlLmRhdGFbKHF1ZXVlLnJlYXIpIGFzIHVzaXplXSA9IHZhbHVlOwogICAgcXVldWUucmVhciA9IChxdWV1ZS5yZWFyICsgMSkgJSBxdWV1ZS5jYXBhY2l0eTsKICAgIHF1ZXVlLnNpemUgPSBxdWV1ZS5zaXplICsgMTsKICAgIHRydWUKfQoKLy8gRGVxdWV1ZSBmcm9tIHF1ZXVlCmZuIHF1ZXVlX2RlcXVldWUocXVldWU6ICZtdXQgUXVldWUpIC0+IGkzMiB7CiAgICBpZiAocXVldWUuc2l6ZSA8PSAwKSB7CiAgICAgICAgcmV0dXJuIC05OTk5OTk7IC8vIFF1ZXVlIHVuZGVyZmxvdyBpbmRpY2F0b3IKICAgIH0KCiAgICBsZXQgdmFsdWU6IGkzMiA9IHF1ZXVlLmRhdGFbKHF1ZXVlLmZyb250KSBhcyB1c2l6ZV07CiAgICBsZXQgdmFsdWU6IGkzMiA9IHF1ZXVlLmRhdGFbKHF1ZXVlLmZyb250KSBhcyB1c2l6ZV07CiAgICBxdWV1ZS5mcm9udCA9IChxdWV1ZS5mcm9udCArIDEpICUgcXVldWUuY2FwYWNpdHk7CiAgICBxdWV1ZS5zaXplID0gcXVldWUuc2l6ZSAtIDE7CiAgICB2YWx1ZQp9CgovLyBDaGVjayBpZiBxdWV1ZSBpcyBlbXB0eQpmbiBxdWV1ZV9pc19lbXB0eShxdWV1ZTogJlF1ZXVlKSAtPiBib29sIHsKICAgIHF1ZXVlLnNpemUgPD0gMAp9CgovLyBIYXNoIGZ1bmN0aW9uIGZvciBoYXNoIHRhYmxlCmZuIGhhc2hfZnVuY3Rpb24oa2V5OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGhhc2g6IGkzMiA9IGtleTsKICAgIGhhc2ggPSBoYXNoICogMzEgKyAxNzsgLy8gU2ltcGxlIG11bHRpcGxpY2F0aXZlIGhhc2gKICAgIGhhc2ggPSBoYXNoICUgSEFTSF9UQUJMRV9TSVpFIGFzIGkzMjsKICAgIGlmIChoYXNoIDwgMCkgewogICAgICAgIGhhc2ggPSBoYXNoICsgSEFTSF9UQUJMRV9TSVpFIGFzIGkzMjsKICAgIH0KICAgIGhhc2gKfQoKLy8gSW5pdGlhbGl6ZSBoYXNoIHRhYmxlCmZuIGluaXRfaGFzaF90YWJsZSgpIC0+IEhhc2hUYWJsZSB7CiAgICBsZXQgbXV0IHRhYmxlOiBIYXNoVGFibGUgPSBIYXNoVGFibGUgewogICAgICAgIGJ1Y2tldHM6IFtOVUxMX0lOREVYOyBIQVNIX1RBQkxFX1NJWkVdLAogICAgICAgIGVudHJpZXM6IFtIYXNoRW50cnkgewogICAgICAgICAgICBrZXk6IDAsCiAgICAgICAgICAgIHZhbHVlOiAwLAogICAgICAgICAgICBuZXh0OiBOVUxMX0lOREVYLAogICAgICAgICAgICBpc191c2VkOiBmYWxzZSwKICAgICAgICB9OyBNQVhfTk9ERVNdLAogICAgICAgIGVudHJ5X2NvdW50OiAwLAogICAgfTsKCiAgICAvLyBJbml0aWFsaXplIGFsbCBlbnRyaWVzIGFzIHVudXNlZAogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICB3aGlsZSAoaSA8IE1BWF9OT0RFUykgewogICAgICAgIHRhYmxlLmVudHJpZXNbaV0uaXNfdXNlZCA9IGZhbHNlOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICB0YWJsZQp9CgovLyBJbnNlcnQgaW50byBoYXNoIHRhYmxlCmZuIGhhc2hfdGFibGVfaW5zZXJ0KHRhYmxlOiAmbXV0IEhhc2hUYWJsZSwga2V5OiBpMzIsIHZhbHVlOiBpMzIpIC0+IGJvb2wgewogICAgaWYgKHRhYmxlLmVudHJ5X2NvdW50ID49IE1BWF9OT0RFUyBhcyBpMzIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7IC8vIFRhYmxlIGZ1bGwKICAgIH0KCiAgICBsZXQgYnVja2V0X2luZGV4OiBpMzIgPSBoYXNoX2Z1bmN0aW9uKGtleSk7CgogICAgLy8gQ2hlY2sgaWYga2V5IGFscmVhZHkgZXhpc3RzCiAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9IHRhYmxlLmJ1Y2tldHNbYnVja2V0X2luZGV4IGFzIHVzaXplXTsKICAgIHdoaWxlIChjdXJyZW50ICE9IE5VTExfSU5ERVgpIHsKICAgICAgICBpZiAodGFibGUuZW50cmllc1tjdXJyZW50IGFzIHVzaXplXS5rZXkgPT0ga2V5KSB7CiAgICAgICAgICAgIHRhYmxlLmVudHJpZXNbY3VycmVudCBhcyB1c2l6ZV0udmFsdWUgPSB2YWx1ZTsgLy8gVXBkYXRlIGV4aXN0aW5nCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBjdXJyZW50ID0gdGFibGUuZW50cmllc1tjdXJyZW50IGFzIHVzaXplXS5uZXh0OwogICAgfQoKICAgIC8vIEZpbmQgZnJlZSBlbnRyeQogICAgbGV0IG11dCBlbnRyeV9pbmRleDogaTMyID0gMDsKICAgIHdoaWxlIChlbnRyeV9pbmRleCA8IE1BWF9OT0RFUyBhcyBpMzIgJiYgdGFibGUuZW50cmllc1tlbnRyeV9pbmRleCBhcyB1c2l6ZV0uaXNfdXNlZCkgewogICAgICAgIGVudHJ5X2luZGV4ID0gZW50cnlfaW5kZXggKyAxOwogICAgfQoKICAgIGlmIChlbnRyeV9pbmRleCA+PSBNQVhfTk9ERVMgYXMgaTMyKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBObyBmcmVlIGVudHJpZXMKICAgIH0KCiAgICAvLyBJbnNlcnQgbmV3IGVudHJ5CiAgICB0YWJsZS5lbnRyaWVzW2VudHJ5X2luZGV4IGFzIHVzaXplXS5rZXkgPSBrZXk7CiAgICB0YWJsZS5lbnRyaWVzW2VudHJ5X2luZGV4IGFzIHVzaXplXS52YWx1ZSA9IHZhbHVlOwogICAgdGFibGUuZW50cmllc1tlbnRyeV9pbmRleCBhcyB1c2l6ZV0ubmV4dCA9IHRhYmxlLmJ1Y2tldHNbYnVja2V0X2luZGV4IGFzIHVzaXplXTsKICAgIHRhYmxlLmVudHJpZXNbZW50cnlfaW5kZXggYXMgdXNpemVdLmlzX3VzZWQgPSB0cnVlOwogICAgdGFibGUuYnVja2V0c1tidWNrZXRfaW5kZXggYXMgdXNpemVdID0gZW50cnlfaW5kZXg7CiAgICB0YWJsZS5lbnRyeV9jb3VudCA9IHRhYmxlLmVudHJ5X2NvdW50ICsgMTsKCiAgICB0cnVlCn0KCi8vIFNlYXJjaCBpbiBoYXNoIHRhYmxlCmZuIGhhc2hfdGFibGVfc2VhcmNoKHRhYmxlOiAmSGFzaFRhYmxlLCBrZXk6IGkzMikgLT4gaTMyIHsKICAgIGxldCBidWNrZXRfaW5kZXg6IGkzMiA9IGhhc2hfZnVuY3Rpb24oa2V5KTsKICAgIGxldCBtdXQgY3VycmVudDogaTMyID0gdGFibGUuYnVja2V0c1tidWNrZXRfaW5kZXggYXMgdXNpemVdOwoKICAgIHdoaWxlIChjdXJyZW50ICE9IE5VTExfSU5ERVgpIHsKICAgICAgICBpZiAodGFibGUuZW50cmllc1tjdXJyZW50IGFzIHVzaXplXS5rZXkgPT0ga2V5KSB7CiAgICAgICAgICAgIHJldHVybiB0YWJsZS5lbnRyaWVzW2N1cnJlbnQgYXMgdXNpemVdLnZhbHVlOwogICAgICAgIH0KICAgICAgICBjdXJyZW50ID0gdGFibGUuZW50cmllc1tjdXJyZW50IGFzIHVzaXplXS5uZXh0OwogICAgfQoKICAgIC05OTk5OTkgLy8gTm90IGZvdW5kIGluZGljYXRvcgp9CgovLyBEZWxldGUgZnJvbSBoYXNoIHRhYmxlCmZuIGhhc2hfdGFibGVfZGVsZXRlKHRhYmxlOiAmbXV0IEhhc2hUYWJsZSwga2V5OiBpMzIpIC0+IGJvb2wgewogICAgbGV0IGJ1Y2tldF9pbmRleDogaTMyID0gaGFzaF9mdW5jdGlvbihrZXkpOwogICAgbGV0IG11dCBjdXJyZW50OiBpMzIgPSB0YWJsZS5idWNrZXRzW2J1Y2tldF9pbmRleCBhcyB1c2l6ZV07CiAgICBsZXQgbXV0IHByZXY6IGkzMiA9IE5VTExfSU5ERVg7CgogICAgd2hpbGUgKGN1cnJlbnQgIT0gTlVMTF9JTkRFWCkgewogICAgICAgIGlmICh0YWJsZS5lbnRyaWVzW2N1cnJlbnQgYXMgdXNpemVdLmtleSA9PSBrZXkpIHsKICAgICAgICAgICAgLy8gUmVtb3ZlIGZyb20gY2hhaW4KICAgICAgICAgICAgaWYgKHByZXYgPT0gTlVMTF9JTkRFWCkgewogICAgICAgICAgICAgICAgdGFibGUuYnVja2V0c1tidWNrZXRfaW5kZXggYXMgdXNpemVdID0gdGFibGUuZW50cmllc1tjdXJyZW50IGFzIHVzaXplXS5uZXh0OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGFibGUuZW50cmllc1twcmV2IGFzIHVzaXplXS5uZXh0ID0gdGFibGUuZW50cmllc1tjdXJyZW50IGFzIHVzaXplXS5uZXh0OwogICAgICAgICAgICB9CgogICAgICAgICAgICB0YWJsZS5lbnRyaWVzW2N1cnJlbnQgYXMgdXNpemVdLmlzX3VzZWQgPSBmYWxzZTsKICAgICAgICAgICAgdGFibGUuZW50cnlfY291bnQgPSB0YWJsZS5lbnRyeV9jb3VudCAtIDE7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBwcmV2ID0gY3VycmVudDsKICAgICAgICBjdXJyZW50ID0gdGFibGUuZW50cmllc1tjdXJyZW50IGFzIHVzaXplXS5uZXh0OwogICAgfQoKICAgIGZhbHNlIC8vIE5vdCBmb3VuZAp9CgovLyBJbml0aWFsaXplIGxpbmtlZCBsaXN0IG1hbmFnZXIKZm4gaW5pdF9saXN0X21hbmFnZXIoKSAtPiBMaW5rZWRMaXN0TWFuYWdlciB7CiAgICBMaW5rZWRMaXN0TWFuYWdlciB7CiAgICAgICAgaGVhZHM6IFtOVUxMX0lOREVYOyAxMF0sCiAgICAgICAgbGlzdF9jb3VudDogMCwKICAgICAgICB0b3RhbF9ub2RlczogMCwKICAgIH0KfQoKLy8gSW5zZXJ0IGF0IGhlYWQgb2Ygc3BlY2lmaWMgbGlzdApmbiBsaXN0X2luc2VydF9oZWFkKAogICAgbWFuYWdlcjogJm11dCBMaW5rZWRMaXN0TWFuYWdlciwKICAgIHBvb2w6ICZtdXQgTWVtb3J5UG9vbCwKICAgIGxpc3RfaWQ6IGkzMiwKICAgIGRhdGE6IGkzMiwKKSAtPiBib29sIHsKICAgIGlmIChsaXN0X2lkIDwgMCB8fCBsaXN0X2lkID49IDEwKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGxldCBuZXdfbm9kZTogaTMyID0gYWxsb2NhdGVfbm9kZShwb29sLCBkYXRhKTsKICAgIGxldCBuZXdfbm9kZTogaTMyID0gYWxsb2NhdGVfbm9kZShwb29sLCBkYXRhKTsKICAgIGlmIChuZXdfbm9kZSA9PSBOVUxMX0lOREVYKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHBvb2wubm9kZXNbbmV3X25vZGUgYXMgdXNpemVdLm5leHQgPSBtYW5hZ2VyLmhlYWRzW2xpc3RfaWQgYXMgdXNpemVdOwogICAgbWFuYWdlci5oZWFkc1tsaXN0X2lkIGFzIHVzaXplXSA9IG5ld19ub2RlOwogICAgbWFuYWdlci50b3RhbF9ub2RlcyA9IG1hbmFnZXIudG90YWxfbm9kZXMgKyAxOwoKICAgIHRydWUKfQoKLy8gU2VhcmNoIGluIHNwZWNpZmljIGxpc3QKZm4gbGlzdF9zZWFyY2gobWFuYWdlcjogJkxpbmtlZExpc3RNYW5hZ2VyLCBwb29sOiAmTWVtb3J5UG9vbCwgbGlzdF9pZDogaTMyLCBkYXRhOiBpMzIpIC0+IGJvb2wgewogICAgaWYgKGxpc3RfaWQgPCAwIHx8IGxpc3RfaWQgPj0gMTApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgbGV0IG11dCBjdXJyZW50OiBpMzIgPSBtYW5hZ2VyLmhlYWRzW2xpc3RfaWQgYXMgdXNpemVdOwogICAgd2hpbGUgKGN1cnJlbnQgIT0gTlVMTF9JTkRFWCkgewogICAgICAgIGlmIChwb29sLm5vZGVzW2N1cnJlbnQgYXMgdXNpemVdLmRhdGEgPT0gZGF0YSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgY3VycmVudCA9IHBvb2wubm9kZXNbY3VycmVudCBhcyB1c2l6ZV0ubmV4dDsKICAgIH0KCiAgICBmYWxzZQp9CgovLyBEZWxldGUgZnJvbSBzcGVjaWZpYyBsaXN0CmZuIGxpc3RfZGVsZXRlKAogICAgbWFuYWdlcjogJm11dCBMaW5rZWRMaXN0TWFuYWdlciwKICAgIHBvb2w6ICZtdXQgTWVtb3J5UG9vbCwKICAgIGxpc3RfaWQ6IGkzMiwKICAgIGRhdGE6IGkzMiwKKSAtPiBib29sIHsKICAgIGlmIChsaXN0X2lkIDwgMCB8fCBsaXN0X2lkID49IDEwKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGxldCBtdXQgY3VycmVudDogaTMyID0gbWFuYWdlci5oZWFkc1tsaXN0X2lkIGFzIHVzaXplXTsKICAgIGxldCBtdXQgcHJldjogaTMyID0gTlVMTF9JTkRFWDsKCiAgICB3aGlsZSAoY3VycmVudCAhPSBOVUxMX0lOREVYKSB7CiAgICAgICAgaWYgKHBvb2wubm9kZXNbY3VycmVudCBhcyB1c2l6ZV0uZGF0YSA9PSBkYXRhKSB7CiAgICAgICAgICAgIGlmIChwcmV2ID09IE5VTExfSU5ERVgpIHsKICAgICAgICAgICAgICAgIG1hbmFnZXIuaGVhZHNbbGlzdF9pZCBhcyB1c2l6ZV0gPSBwb29sLm5vZGVzW2N1cnJlbnQgYXMgdXNpemVdLm5leHQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBwb29sLm5vZGVzW3ByZXYgYXMgdXNpemVdLm5leHQgPSBwb29sLm5vZGVzW2N1cnJlbnQgYXMgdXNpemVdLm5leHQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGRlYWxsb2NhdGVfbm9kZShwb29sLCBjdXJyZW50KTsKICAgICAgICAgICAgbWFuYWdlci50b3RhbF9ub2RlcyA9IG1hbmFnZXIudG90YWxfbm9kZXMgLSAxOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcHJldiA9IGN1cnJlbnQ7CiAgICAgICAgY3VycmVudCA9IHBvb2wubm9kZXNbY3VycmVudCBhcyB1c2l6ZV0ubmV4dDsKICAgIH0KCiAgICBmYWxzZQp9CgovLyBHZXQgbGlzdCBsZW5ndGgKZm4gbGlzdF9sZW5ndGgobWFuYWdlcjogJkxpbmtlZExpc3RNYW5hZ2VyLCBwb29sOiAmTWVtb3J5UG9vbCwgbGlzdF9pZDogaTMyKSAtPiBpMzIgewogICAgaWYgKGxpc3RfaWQgPCAwIHx8IGxpc3RfaWQgPj0gMTApIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAgICBsZXQgbXV0IGNvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBjdXJyZW50OiBpMzIgPSBtYW5hZ2VyLmhlYWRzW2xpc3RfaWQgYXMgdXNpemVdOwoKICAgIHdoaWxlIChjdXJyZW50ICE9IE5VTExfSU5ERVgpIHsKICAgICAgICBjb3VudCA9IGNvdW50ICsgMTsKICAgICAgICBjdXJyZW50ID0gcG9vbC5ub2Rlc1tjdXJyZW50IGFzIHVzaXplXS5uZXh0OwogICAgfQoKICAgIGNvdW50Cn0KCi8vIENvbXBsZXggb3BlcmF0aW9uOiBtZXJnZSB0d28gc29ydGVkIGxpc3RzCmZuIGxpc3RfbWVyZ2Vfc29ydGVkKAogICAgbWFuYWdlcjogJm11dCBMaW5rZWRMaXN0TWFuYWdlciwKICAgIHBvb2w6ICZtdXQgTWVtb3J5UG9vbCwKICAgIGxpc3QxX2lkOiBpMzIsCiAgICBsaXN0Ml9pZDogaTMyLAogICAgcmVzdWx0X2lkOiBpMzIsCikgLT4gYm9vbCB7CiAgICBpZiAobGlzdDFfaWQgPCAwCiAgICAgICAgfHwgbGlzdDFfaWQgPj0gMTAKICAgICAgICB8fCBsaXN0Ml9pZCA8IDAKICAgICAgICB8fCBsaXN0Ml9pZCA+PSAxMAogICAgICAgIHx8IHJlc3VsdF9pZCA8IDAKICAgICAgICB8fCByZXN1bHRfaWQgPj0gMTApCiAgICB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGxldCBtdXQgcHRyMTogaTMyID0gbWFuYWdlci5oZWFkc1tsaXN0MV9pZCBhcyB1c2l6ZV07CiAgICBsZXQgbXV0IHB0cjI6IGkzMiA9IG1hbmFnZXIuaGVhZHNbbGlzdDJfaWQgYXMgdXNpemVdOwogICAgbWFuYWdlci5oZWFkc1tyZXN1bHRfaWQgYXMgdXNpemVdID0gTlVMTF9JTkRFWDsKICAgIGxldCBtdXQgcmVzdWx0X3RhaWw6IGkzMiA9IE5VTExfSU5ERVg7CgogICAgLy8gTWVyZ2UgcHJvY2VzcwogICAgd2hpbGUgKHB0cjEgIT0gTlVMTF9JTkRFWCAmJiBwdHIyICE9IE5VTExfSU5ERVgpIHsKICAgICAgICBsZXQgbXV0IG5leHRfbm9kZTogaTMyID0gMDsKCiAgICAgICAgaWYgKHBvb2wubm9kZXNbcHRyMSBhcyB1c2l6ZV0uZGF0YSA8PSBwb29sLm5vZGVzW3B0cjIgYXMgdXNpemVdLmRhdGEpIHsKICAgICAgICAgICAgbmV4dF9ub2RlID0gcHRyMTsKICAgICAgICAgICAgcHRyMSA9IHBvb2wubm9kZXNbcHRyMSBhcyB1c2l6ZV0ubmV4dDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXh0X25vZGUgPSBwdHIyOwogICAgICAgICAgICBwdHIyID0gcG9vbC5ub2Rlc1twdHIyIGFzIHVzaXplXS5uZXh0OwogICAgICAgIH0KCiAgICAgICAgcG9vbC5ub2Rlc1tuZXh0X25vZGUgYXMgdXNpemVdLm5leHQgPSBOVUxMX0lOREVYOwoKICAgICAgICBpZiAobWFuYWdlci5oZWFkc1tyZXN1bHRfaWQgYXMgdXNpemVdID09IE5VTExfSU5ERVgpIHsKICAgICAgICAgICAgbWFuYWdlci5oZWFkc1tyZXN1bHRfaWQgYXMgdXNpemVdID0gbmV4dF9ub2RlOwogICAgICAgICAgICByZXN1bHRfdGFpbCA9IG5leHRfbm9kZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwb29sLm5vZGVzW3Jlc3VsdF90YWlsIGFzIHVzaXplXS5uZXh0ID0gbmV4dF9ub2RlOwogICAgICAgICAgICByZXN1bHRfdGFpbCA9IG5leHRfbm9kZTsKICAgICAgICB9CiAgICB9CgogICAgLy8gQXBwZW5kIHJlbWFpbmluZyBub2RlcwogICAgbGV0IHJlbWFpbmluZzogaTMyID0gaWYgKHB0cjEgIT0gTlVMTF9JTkRFWCkgeyBwdHIxIH0gZWxzZSB7IHB0cjIgfTsKICAgIGlmIChyZW1haW5pbmcgIT0gTlVMTF9JTkRFWCkgewogICAgICAgIGlmIChyZXN1bHRfdGFpbCAhPSBOVUxMX0lOREVYKSB7CiAgICAgICAgICAgIHBvb2wubm9kZXNbcmVzdWx0X3RhaWwgYXMgdXNpemVdLm5leHQgPSByZW1haW5pbmc7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbWFuYWdlci5oZWFkc1tyZXN1bHRfaWQgYXMgdXNpemVdID0gcmVtYWluaW5nOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBDbGVhciBzb3VyY2UgbGlzdHMKICAgIG1hbmFnZXIuaGVhZHNbbGlzdDFfaWQgYXMgdXNpemVdID0gTlVMTF9JTkRFWDsKICAgIG1hbmFnZXIuaGVhZHNbbGlzdDJfaWQgYXMgdXNpemVdID0gTlVMTF9JTkRFWDsKCiAgICB0cnVlCn0KCi8vIFRlc3QgY29tcHJlaGVuc2l2ZSBkYXRhIHN0cnVjdHVyZSBvcGVyYXRpb25zCmZuIHRlc3RfY29tcHJlaGVuc2l2ZV9vcGVyYXRpb25zKCkgewogICAgcHJpbnRsbkludCgxOTAwMSk7IC8vIFRlc3Qgc3RhcnQgbWFya2VyCgogICAgLy8gSW5pdGlhbGl6ZSBhbGwgZGF0YSBzdHJ1Y3R1cmVzCiAgICBsZXQgbXV0IG1lbW9yeV9wb29sOk1lbW9yeVBvb2wgPSBpbml0X21lbW9yeV9wb29sKCk7CiAgICBsZXQgbXV0IGhhc2hfdGFibGU6SGFzaFRhYmxlID0gaW5pdF9oYXNoX3RhYmxlKCk7CiAgICBsZXQgbXV0IHN0YWNrOlN0YWNrID0gaW5pdF9zdGFjaygpOwogICAgbGV0IG11dCBxdWV1ZTpRdWV1ZSA9IGluaXRfcXVldWUoKTsKICAgIGxldCBtdXQgbGlzdF9tYW5hZ2VyOkxpbmtlZExpc3RNYW5hZ2VyID0gaW5pdF9saXN0X21hbmFnZXIoKTsKCiAgICBwcmludGxuSW50KDE5MDAyKTsgLy8gSW5pdGlhbGl6YXRpb24gY29tcGxldGUKCiAgICAvLyBUZXN0IDE6IE1lbW9yeSBwb29sIHN0cmVzcyB0ZXN0CiAgICBsZXQgbXV0IGFsbG9jYXRlZF9ub2RlczogW2kzMjsgMTAwXSA9IFtOVUxMX0lOREVYOyAxMDBdOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAxMDApIHsKICAgICAgICBhbGxvY2F0ZWRfbm9kZXNbaSBhcyB1c2l6ZV0gPSBhbGxvY2F0ZV9ub2RlKCZtdXQgbWVtb3J5X3Bvb2wsIGkgKiA3ICsgMTMpOwogICAgICAgIGlmIChhbGxvY2F0ZWRfbm9kZXNbaSBhcyB1c2l6ZV0gPT0gTlVMTF9JTkRFWCkgewogICAgICAgICAgICBwcmludGxuSW50KDE5OTAxKTsgLy8gQWxsb2NhdGlvbiBmYWlsdXJlCiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBwcmludGxuSW50KG1lbW9yeV9wb29sLmFsbG9jYXRlZF9jb3VudCk7IC8vIFNob3VsZCBiZSAxMDAKCiAgICAvLyBUZXN0IDI6IEhhc2ggdGFibGUgY29sbGlzaW9uIGhhbmRsaW5nCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgMjAwKSB7CiAgICAgICAgbGV0IGtleTogaTMyID0gaSAqIDEyNyArIDE7IC8vIEZvcmNlIGNvbGxpc2lvbnMKICAgICAgICBsZXQgdmFsdWU6IGkzMiA9IGkgKiBpICsgMTc7CiAgICAgICAgaWYgKGhhc2hfdGFibGVfaW5zZXJ0KCZtdXQgaGFzaF90YWJsZSwga2V5LCB2YWx1ZSkpIHsKICAgICAgICAgICAgbGV0IHJldHJpZXZlZDogaTMyID0gaGFzaF90YWJsZV9zZWFyY2goJmhhc2hfdGFibGUsIGtleSk7CiAgICAgICAgICAgIGxldCByZXRyaWV2ZWQ6IGkzMiA9IGhhc2hfdGFibGVfc2VhcmNoKCZoYXNoX3RhYmxlLCBrZXkpOwogICAgICAgICAgICBpZiAocmV0cmlldmVkICE9IHZhbHVlKSB7CiAgICAgICAgICAgICAgICBwcmludGxuSW50KDE5OTAyKTsgLy8gSGFzaCB0YWJsZSBlcnJvcgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBwcmludGxuSW50KGhhc2hfdGFibGUuZW50cnlfY291bnQpOyAvLyBIYXNoIHRhYmxlIHNpemUKCiAgICAvLyBUZXN0IDM6IFN0YWNrIG9wZXJhdGlvbnMgd2l0aCBjb3JuZXIgY2FzZXMKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBTVEFDS19TSVpFIGFzIGkzMiArIDEwKSB7CiAgICAgICAgLy8gVGVzdCBvdmVyZmxvdwogICAgICAgIGlmICghc3RhY2tfcHVzaCgmbXV0IHN0YWNrLCBpICogMyArIDcpKSB7CiAgICAgICAgICAgIHByaW50bG5JbnQoMTk5MDMpOyAvLyBTdGFjayBvdmVyZmxvdyBkZXRlY3RlZAogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGxldCBtdXQgcG9wX2NvdW50OiBpMzIgPSAwOwogICAgd2hpbGUgKCFzdGFja19pc19lbXB0eSgmc3RhY2spKSB7CiAgICAgICAgbGV0IHZhbHVlOiBpMzIgPSBzdGFja19wb3AoJm11dCBzdGFjayk7CiAgICAgICAgaWYgKHZhbHVlICE9IC05OTk5OTkpIHsKICAgICAgICAgICAgcG9wX2NvdW50ID0gcG9wX2NvdW50ICsgMTsKICAgICAgICB9CiAgICB9CgogICAgcHJpbnRsbkludChwb3BfY291bnQpOyAvLyBTaG91bGQgZXF1YWwgbnVtYmVyIG9mIHB1c2hlcwoKICAgIC8vIFRlc3QgNDogUXVldWUgY2lyY3VsYXIgb3BlcmF0aW9ucwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IFFVRVVFX1NJWkUgYXMgaTMyIC8gMikgewogICAgICAgIHF1ZXVlX2VucXVldWUoJm11dCBxdWV1ZSwgaSAqIDUgKyAxMSk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBRVUVVRV9TSVpFIGFzIGkzMiAvIDQpIHsKICAgICAgICBxdWV1ZV9kZXF1ZXVlKCZtdXQgcXVldWUpOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgUVVFVUVfU0laRSBhcyBpMzIgLyAyKSB7CiAgICAgICAgaWYgKCFxdWV1ZV9lbnF1ZXVlKCZtdXQgcXVldWUsIGkgKiA3ICsgMjMpKSB7CiAgICAgICAgICAgIHByaW50bG5JbnQoMTk5MDQpOyAvLyBRdWV1ZSBvcGVyYXRpb24gZXJyb3IKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHByaW50bG5JbnQocXVldWUuc2l6ZSk7IC8vIEN1cnJlbnQgcXVldWUgc2l6ZQoKICAgIC8vIFRlc3QgNTogQ29tcGxleCBsaW5rZWQgbGlzdCBvcGVyYXRpb25zCiAgICAvLyBDcmVhdGUgbXVsdGlwbGUgc29ydGVkIGxpc3RzCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgNSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IDIwKSB7CiAgICAgICAgICAgIGxpc3RfaW5zZXJ0X2hlYWQoJm11dCBsaXN0X21hbmFnZXIsICZtdXQgbWVtb3J5X3Bvb2wsIGksIGogKiAyICsgaSk7CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHByaW50bG5JbnQobGlzdF9tYW5hZ2VyLnRvdGFsX25vZGVzKTsgLy8gVG90YWwgbm9kZXMgaW4gYWxsIGxpc3RzCgogICAgLy8gU2VhcmNoIG9wZXJhdGlvbnMKICAgIGxldCBtdXQgc2VhcmNoX3N1Y2Nlc3M6IGkzMiA9IDA7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgNSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IDIwKSB7CiAgICAgICAgICAgIGlmIChsaXN0X3NlYXJjaCgmbGlzdF9tYW5hZ2VyLCAmbWVtb3J5X3Bvb2wsIGksIGogKiAyICsgaSkpIHsKICAgICAgICAgICAgICAgIHNlYXJjaF9zdWNjZXNzID0gc2VhcmNoX3N1Y2Nlc3MgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHByaW50bG5JbnQoc2VhcmNoX3N1Y2Nlc3MpOyAvLyBTaG91bGQgYmUgMTAwCgogICAgLy8gVGVzdCA2OiBNZW1vcnkgZnJhZ21lbnRhdGlvbiBoYW5kbGluZwogICAgLy8gRGVhbGxvY2F0ZSBldmVyeSBvdGhlciBub2RlIGZyb20gbWVtb3J5IHBvb2wKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCAxMDApIHsKICAgICAgICBpZiAoaSAlIDIgPT0gMCAmJiBhbGxvY2F0ZWRfbm9kZXNbaSBhcyB1c2l6ZV0gIT0gTlVMTF9JTkRFWCkgewogICAgICAgICAgICBkZWFsbG9jYXRlX25vZGUoJm11dCBtZW1vcnlfcG9vbCwgYWxsb2NhdGVkX25vZGVzW2kgYXMgdXNpemVdKTsKICAgICAgICAgICAgYWxsb2NhdGVkX25vZGVzW2kgYXMgdXNpemVdID0gTlVMTF9JTkRFWDsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHByaW50bG5JbnQobWVtb3J5X3Bvb2wuYWxsb2NhdGVkX2NvdW50KTsgLy8gU2hvdWxkIGJlIDUwCgogICAgLy8gVHJ5IHRvIGFsbG9jYXRlIG5ldyBub2RlcyBpbiBmcmFnbWVudGVkIHBvb2wKICAgIGxldCBtdXQgbmV3X2FsbG9jYXRpb25zOiBpMzIgPSAwOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDYwKSB7CiAgICAgICAgbGV0IG5ld19ub2RlOiBpMzIgPSBhbGxvY2F0ZV9ub2RlKCZtdXQgbWVtb3J5X3Bvb2wsIGkgKiAxMSArIDE5KTsKICAgICAgICBpZiAobmV3X25vZGUgIT0gTlVMTF9JTkRFWCkgewogICAgICAgICAgICBuZXdfYWxsb2NhdGlvbnMgPSBuZXdfYWxsb2NhdGlvbnMgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcHJpbnRsbkludChuZXdfYWxsb2NhdGlvbnMpOyAvLyBTaG91bGQgYmUgNTAgKGZyZWUgc2xvdHMpCgogICAgLy8gVGVzdCA3OiBIYXNoIHRhYmxlIGRlbGV0aW9uIGFuZCByZWluc2VydAogICAgbGV0IG11dCBkZWxldGlvbl9jb3VudDogaTMyID0gMDsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCAxMDApIHsKICAgICAgICBsZXQga2V5OiBpMzIgPSBpICogMTI3ICsgMTsKICAgICAgICBpZiAoaGFzaF90YWJsZV9kZWxldGUoJm11dCBoYXNoX3RhYmxlLCBrZXkpKSB7CiAgICAgICAgICAgIGRlbGV0aW9uX2NvdW50ID0gZGVsZXRpb25fY291bnQgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcHJpbnRsbkludChkZWxldGlvbl9jb3VudCk7IC8vIFN1Y2Nlc3NmdWwgZGVsZXRpb25zCgogICAgLy8gUmVpbnNlcnQgd2l0aCBkaWZmZXJlbnQgdmFsdWVzCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgNTApIHsKICAgICAgICBsZXQga2V5OiBpMzIgPSBpICogMTI3ICsgMTsKICAgICAgICBsZXQgdmFsdWU6IGkzMiA9IGkgKiBpICogaSArIDI5OwogICAgICAgIGhhc2hfdGFibGVfaW5zZXJ0KCZtdXQgaGFzaF90YWJsZSwga2V5LCB2YWx1ZSk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHByaW50bG5JbnQoaGFzaF90YWJsZS5lbnRyeV9jb3VudCk7IC8vIEZpbmFsIGhhc2ggdGFibGUgc2l6ZQoKICAgIC8vIFRlc3QgODogTGlzdCBtZXJnZSBvcGVyYXRpb25zCiAgICAvLyBDcmVhdGUgdHdvIHNvcnRlZCBsaXN0cyBmb3IgbWVyZ2luZwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDE1KSB7CiAgICAgICAgbGlzdF9pbnNlcnRfaGVhZCgmbXV0IGxpc3RfbWFuYWdlciwgJm11dCBtZW1vcnlfcG9vbCwgNywgaSAqIDQpOwogICAgICAgIGxpc3RfaW5zZXJ0X2hlYWQoJm11dCBsaXN0X21hbmFnZXIsICZtdXQgbWVtb3J5X3Bvb2wsIDgsIGkgKiA0ICsgMik7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGxldCBsaXN0N19sZW46IGkzMiA9IGxpc3RfbGVuZ3RoKCZsaXN0X21hbmFnZXIsICZtZW1vcnlfcG9vbCwgNyk7CiAgICBsZXQgbGlzdDhfbGVuOiBpMzIgPSBsaXN0X2xlbmd0aCgmbGlzdF9tYW5hZ2VyLCAmbWVtb3J5X3Bvb2wsIDgpOwoKICAgIHByaW50bG5JbnQobGlzdDdfbGVuICsgbGlzdDhfbGVuKTsgLy8gQ29tYmluZWQgbGVuZ3RoIGJlZm9yZSBtZXJnZQoKICAgIGxpc3RfbWVyZ2Vfc29ydGVkKCZtdXQgbGlzdF9tYW5hZ2VyLCAmbXV0IG1lbW9yeV9wb29sLCA3LCA4LCA5KTsKCiAgICBsZXQgbWVyZ2VkX2xlbjogaTMyID0gbGlzdF9sZW5ndGgoJmxpc3RfbWFuYWdlciwgJm1lbW9yeV9wb29sLCA5KTsKICAgIHByaW50bG5JbnQobWVyZ2VkX2xlbik7IC8vIExlbmd0aCBhZnRlciBtZXJnZQoKICAgIHByaW50bG5JbnQoMTk5OTkpOyAvLyBUZXN0IGVuZCBtYXJrZXIKfQoKZm4gbWFpbigpIHsKICAgIHRlc3RfY29tcHJlaGVuc2l2ZV9vcGVyYXRpb25zKCk7CiAgICBleGl0KDApOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (20, "comprehensive20", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlMjAKQXV0aG9yOiBXZW54aW4gWmhlbmcKVGltZTogMjAyNS0wOC0xNwpWZXJkaWN0OiBQYXNzCkNvbW1lbnQ6IENvbXByZWhlbnNpdmUgdGVzdCBvZiBjb21wbGV4IGNvbnRyb2wgZmxvdyBhbmQgZmluaXRlIHN0YXRlIG1hY2hpbmUgc2ltdWxhdGlvbgogICAgICAgICBUZXN0czogTXVsdGktbGF5ZXIgRlNNLCBFdmVudC1kcml2ZW4gcHJvZ3JhbW1pbmcsIENvbXBsZXggYnJhbmNoaW5nIHBhdHRlcm5zLAogICAgICAgICAgICAgICBQcm90b2NvbCBwYXJzaW5nLCBUYXNrIHNjaGVkdWxpbmcgc2ltdWxhdGlvbiwgTmVzdGVkIHN0YXRlIG1hY2hpbmVzCiAgICAgICAgIEZvY3VzOiBDb250cm9sIGZsb3cgb3B0aW1pemF0aW9uLCBicmFuY2ggcHJlZGljdGlvbiwganVtcCB0YWJsZSBvcHRpbWl6YXRpb24sCiAgICAgICAgICAgICAgIHN0YXRlIHRyYW5zaXRpb24gb3B0aW1pemF0aW9uLCBjb21wbGV4IG5lc3RlZCBjb25kaXRpb25zCiovCgovLyBDb25zdGFudHMgZm9yIHN0YXRlIG1hY2hpbmUgY29uZmlndXJhdGlvbgpjb25zdCBNQVhfU1RBVEVTOiB1c2l6ZSA9IDUwOwpjb25zdCBNQVhfRVZFTlRTOiB1c2l6ZSA9IDEwMDsKY29uc3QgTUFYX1RSQU5TSVRJT05TOiB1c2l6ZSA9IDIwMDsKY29uc3QgTUFYX1RBU0tTOiB1c2l6ZSA9IDEwMDsKY29uc3QgTUFYX1BST1RPQ09MX0JVRkZFUjogdXNpemUgPSAxMDAwOwpjb25zdCBNQVhfTkVTVEVEX0NBTExTOiB1c2l6ZSA9IDIwOwpjb25zdCBJTlZBTElEX1NUQVRFOiBpMzIgPSAtMTsKY29uc3QgSU5WQUxJRF9FVkVOVDogaTMyID0gLTE7CgovLyBTdGF0ZSBtYWNoaW5lIHN0YXRlcyBlbnVtZXJhdGlvbgpjb25zdCBTVEFURV9JTklUOiBpMzIgPSAwOwpjb25zdCBTVEFURV9SRUFEWTogaTMyID0gMTsKY29uc3QgU1RBVEVfUFJPQ0VTU0lORzogaTMyID0gMjsKY29uc3QgU1RBVEVfV0FJVElORzogaTMyID0gMzsKY29uc3QgU1RBVEVfRVJST1I6IGkzMiA9IDQ7CmNvbnN0IFNUQVRFX0NMRUFOVVA6IGkzMiA9IDU7CmNvbnN0IFNUQVRFX1NVU1BFTkRFRDogaTMyID0gNjsKY29uc3QgU1RBVEVfUkVDT1ZFUklORzogaTMyID0gNzsKY29uc3QgU1RBVEVfRklOQUxJWklORzogaTMyID0gODsKY29uc3QgU1RBVEVfVEVSTUlOQVRFRDogaTMyID0gOTsKCi8vIEV2ZW50IHR5cGVzCmNvbnN0IEVWRU5UX1NUQVJUOiBpMzIgPSAwOwpjb25zdCBFVkVOVF9QUk9DRVNTOiBpMzIgPSAxOwpjb25zdCBFVkVOVF9DT01QTEVURTogaTMyID0gMjsKY29uc3QgRVZFTlRfRVJST1I6IGkzMiA9IDM7CmNvbnN0IEVWRU5UX1RJTUVPVVQ6IGkzMiA9IDQ7CmNvbnN0IEVWRU5UX1JFVFJZOiBpMzIgPSA1Owpjb25zdCBFVkVOVF9TVVNQRU5EOiBpMzIgPSA2Owpjb25zdCBFVkVOVF9SRVNVTUU6IGkzMiA9IDc7CmNvbnN0IEVWRU5UX0FCT1JUOiBpMzIgPSA4Owpjb25zdCBFVkVOVF9SRVNFVDogaTMyID0gOTsKCi8vIFByb3RvY29sIHBhY2tldCB0eXBlcwpjb25zdCBQQUNLRVRfU1lOOiBpMzIgPSAxOwpjb25zdCBQQUNLRVRfQUNLOiBpMzIgPSAyOwpjb25zdCBQQUNLRVRfREFUQTogaTMyID0gMzsKY29uc3QgUEFDS0VUX0ZJTjogaTMyID0gNDsKY29uc3QgUEFDS0VUX1JTVDogaTMyID0gNTsKY29uc3QgUEFDS0VUX1BJTkc6IGkzMiA9IDY7CmNvbnN0IFBBQ0tFVF9QT05HOiBpMzIgPSA3OwoKLy8gVGFzayBwcmlvcml0aWVzCmNvbnN0IFBSSU9SSVRZX0xPVzogaTMyID0gMTsKY29uc3QgUFJJT1JJVFlfTk9STUFMOiBpMzIgPSAyOwpjb25zdCBQUklPUklUWV9ISUdIOiBpMzIgPSAzOwpjb25zdCBQUklPUklUWV9DUklUSUNBTDogaTMyID0gNDsKCi8vIFN0YXRlIHRyYW5zaXRpb24gc3RydWN0dXJlCnN0cnVjdCBUcmFuc2l0aW9uIHsKICAgIGZyb21fc3RhdGU6IGkzMiwKICAgIGV2ZW50OiBpMzIsCiAgICB0b19zdGF0ZTogaTMyLAogICAgYWN0aW9uX2lkOiBpMzIsCiAgICBjb25kaXRpb246IGkzMiwKfQoKLy8gRmluaXRlIHN0YXRlIG1hY2hpbmUgc3RydWN0dXJlCnN0cnVjdCBGU00gewogICAgY3VycmVudF9zdGF0ZTogaTMyLAogICAgcHJldmlvdXNfc3RhdGU6IGkzMiwKICAgIHRyYW5zaXRpb25zOiBbVHJhbnNpdGlvbjsgTUFYX1RSQU5TSVRJT05TXSwKICAgIHRyYW5zaXRpb25fY291bnQ6IGkzMiwKICAgIGV2ZW50X3F1ZXVlOiBbaTMyOyBNQVhfRVZFTlRTXSwKICAgIHF1ZXVlX2hlYWQ6IGkzMiwKICAgIHF1ZXVlX3RhaWw6IGkzMiwKICAgIHF1ZXVlX3NpemU6IGkzMiwKICAgIHN0YXRlX2NvdW50ZXJzOiBbaTMyOyBNQVhfU1RBVEVTXSwKICAgIGVycm9yX2NvdW50OiBpMzIsCiAgICB0b3RhbF90cmFuc2l0aW9uczogaTMyLAp9CgovLyBUYXNrIHN0cnVjdHVyZSBmb3Igc2NoZWR1bGVyIHNpbXVsYXRpb24Kc3RydWN0IFRhc2sgewogICAgaWQ6IGkzMiwKICAgIHByaW9yaXR5OiBpMzIsCiAgICBzdGF0ZTogaTMyLAogICAgcmVtYWluaW5nX3RpbWU6IGkzMiwKICAgIHdhaXRfZXZlbnQ6IGkzMiwKICAgIG5leHRfdGFzazogaTMyLCAvLyBGb3IgbGlua2VkIGxpc3Qgc2NoZWR1bGluZwogICAgZXhlY3V0aW9uX2NvdW50OiBpMzIsCn0KCi8vIFByb3RvY29sIHBhcnNlciBzdGF0ZQpzdHJ1Y3QgUHJvdG9jb2xQYXJzZXIgewogICAgc3RhdGU6IGkzMiwKICAgIGJ1ZmZlcjogW2kzMjsgTUFYX1BST1RPQ09MX0JVRkZFUl0sCiAgICBidWZmZXJfcG9zOiBpMzIsCiAgICBwYWNrZXRfY291bnQ6IGkzMiwKICAgIGVycm9yX2NvdW50OiBpMzIsCiAgICBzZXF1ZW5jZV9udW1iZXI6IGkzMiwKICAgIGV4cGVjdGVkX3NlcTogaTMyLAp9CgovLyBUYXNrIHNjaGVkdWxlcgpzdHJ1Y3QgVGFza1NjaGVkdWxlciB7CiAgICB0YXNrczogW1Rhc2s7IE1BWF9UQVNLU10sCiAgICB0YXNrX2NvdW50OiBpMzIsCiAgICBjdXJyZW50X3Rhc2s6IGkzMiwKICAgIHJlYWR5X3F1ZXVlOiBbaTMyOyBNQVhfVEFTS1NdLAogICAgd2FpdGluZ19xdWV1ZTogW2kzMjsgTUFYX1RBU0tTXSwKICAgIHJlYWR5X2NvdW50OiBpMzIsCiAgICB3YWl0aW5nX2NvdW50OiBpMzIsCiAgICB0aW1lX3NsaWNlOiBpMzIsCiAgICBjdXJyZW50X3RpbWU6IGkzMiwKfQoKLy8gTmVzdGVkIHN0YXRlIG1hY2hpbmUgZm9yIGNvbXBsZXggc2NlbmFyaW9zCnN0cnVjdCBOZXN0ZWRGU00gewogICAgbWFpbl9mc206IEZTTSwKICAgIHN1Yl9mc206IEZTTSwKICAgIGludGVyYWN0aW9uX2NvdW50OiBpMzIsCiAgICBuZXN0ZWRfbGV2ZWw6IGkzMiwKICAgIGNhbGxfc3RhY2s6IFtpMzI7IE1BWF9ORVNURURfQ0FMTFNdLAogICAgc3RhY2tfdG9wOiBpMzIsCn0KCi8vIEluaXRpYWxpemUgRlNNCmZuIGluaXRfZnNtKCkgLT4gRlNNIHsKICAgIGxldCBtdXQgZnNtOiBGU00gPSBGU00gewogICAgICAgIGN1cnJlbnRfc3RhdGU6IFNUQVRFX0lOSVQsCiAgICAgICAgcHJldmlvdXNfc3RhdGU6IElOVkFMSURfU1RBVEUsCiAgICAgICAgdHJhbnNpdGlvbnM6IFtUcmFuc2l0aW9uIHsKICAgICAgICAgICAgZnJvbV9zdGF0ZTogMCwKICAgICAgICAgICAgZXZlbnQ6IDAsCiAgICAgICAgICAgIHRvX3N0YXRlOiAwLAogICAgICAgICAgICBhY3Rpb25faWQ6IDAsCiAgICAgICAgICAgIGNvbmRpdGlvbjogMCwKICAgICAgICB9OyBNQVhfVFJBTlNJVElPTlNdLAogICAgICAgIHRyYW5zaXRpb25fY291bnQ6IDAsCiAgICAgICAgZXZlbnRfcXVldWU6IFswOyBNQVhfRVZFTlRTXSwKICAgICAgICBxdWV1ZV9oZWFkOiAwLAogICAgICAgIHF1ZXVlX3RhaWw6IDAsCiAgICAgICAgcXVldWVfc2l6ZTogMCwKICAgICAgICBzdGF0ZV9jb3VudGVyczogWzA7IE1BWF9TVEFURVNdLAogICAgICAgIGVycm9yX2NvdW50OiAwLAogICAgICAgIHRvdGFsX3RyYW5zaXRpb25zOiAwLAogICAgfTsKCiAgICAvLyBJbml0aWFsaXplIHN0YXRlIGNvdW50ZXJzCiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgIHdoaWxlIChpIDwgTUFYX1NUQVRFUykgewogICAgICAgIGZzbS5zdGF0ZV9jb3VudGVyc1tpXSA9IDA7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGZzbS5zdGF0ZV9jb3VudGVyc1tTVEFURV9JTklUIGFzIHVzaXplXSA9IDE7IC8vIFN0YXJ0IGluIGluaXQgc3RhdGUKICAgIGZzbQp9CgovLyBBZGQgdHJhbnNpdGlvbiB0byBGU00KZm4gYWRkX3RyYW5zaXRpb24oCiAgICBmc206ICZtdXQgRlNNLAogICAgZnJvbTogaTMyLAogICAgZXZlbnQ6IGkzMiwKICAgIHRvOiBpMzIsCiAgICBhY3Rpb246IGkzMiwKICAgIGNvbmRpdGlvbjogaTMyLAopIC0+IGJvb2wgewogICAgaWYgKGZzbS50cmFuc2l0aW9uX2NvdW50ID49IE1BWF9UUkFOU0lUSU9OUyBhcyBpMzIpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgZnNtLnRyYW5zaXRpb25zWyhmc20udHJhbnNpdGlvbl9jb3VudCkgYXMgdXNpemVdID0gVHJhbnNpdGlvbiB7CiAgICAgICAgZnJvbV9zdGF0ZTogZnJvbSwKICAgICAgICBldmVudDogZXZlbnQsCiAgICAgICAgdG9fc3RhdGU6IHRvLAogICAgICAgIGFjdGlvbl9pZDogYWN0aW9uLAogICAgICAgIGNvbmRpdGlvbjogY29uZGl0aW9uLAogICAgfTsKCiAgICBmc20udHJhbnNpdGlvbl9jb3VudCA9IGZzbS50cmFuc2l0aW9uX2NvdW50ICsgMTsKICAgIHRydWUKfQoKLy8gQWRkIGV2ZW50IHRvIEZTTSBxdWV1ZQpmbiBmc21fYWRkX2V2ZW50KGZzbTogJm11dCBGU00sIGV2ZW50OiBpMzIpIC0+IGJvb2wgewogICAgaWYgKGZzbS5xdWV1ZV9zaXplID49IE1BWF9FVkVOVFMgYXMgaTMyKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBRdWV1ZSBmdWxsCiAgICB9CgogICAgZnNtLmV2ZW50X3F1ZXVlWyhmc20ucXVldWVfdGFpbCkgYXMgdXNpemVdID0gZXZlbnQ7CiAgICBmc20ucXVldWVfdGFpbCA9IChmc20ucXVldWVfdGFpbCArIDEpICUgTUFYX0VWRU5UUyBhcyBpMzI7CiAgICBmc20ucXVldWVfc2l6ZSA9IGZzbS5xdWV1ZV9zaXplICsgMTsKICAgIHRydWUKfQoKLy8gR2V0IG5leHQgZXZlbnQgZnJvbSBGU00gcXVldWUKZm4gZnNtX2dldF9ldmVudChmc206ICZtdXQgRlNNKSAtPiBpMzIgewogICAgaWYgKGZzbS5xdWV1ZV9zaXplIDw9IDApIHsKICAgICAgICByZXR1cm4gSU5WQUxJRF9FVkVOVDsKICAgIH0KCiAgICBsZXQgZXZlbnQ6IGkzMiA9IGZzbS5ldmVudF9xdWV1ZVsoZnNtLnF1ZXVlX2hlYWQpIGFzIHVzaXplXTsKICAgIGZzbS5xdWV1ZV9oZWFkID0gKGZzbS5xdWV1ZV9oZWFkICsgMSkgJSBNQVhfRVZFTlRTIGFzIGkzMjsKICAgIGZzbS5xdWV1ZV9zaXplID0gZnNtLnF1ZXVlX3NpemUgLSAxOwogICAgZXZlbnQKfQoKLy8gQ29tcGxleCBjb25kaXRpb24gZXZhbHVhdG9yIGZvciBzdGF0ZSB0cmFuc2l0aW9ucwpmbiBldmFsdWF0ZV9jb25kaXRpb24oY29uZGl0aW9uOiBpMzIsIGN1cnJlbnRfc3RhdGU6IGkzMiwgZXZlbnQ6IGkzMiwgY29udGV4dDogaTMyKSAtPiBib29sIHsKICAgIC8vIENvbXBsZXggYnJhbmNoaW5nIGxvZ2ljIGZvciBjb25kaXRpb24gZXZhbHVhdGlvbgogICAgaWYgKGNvbmRpdGlvbiA9PSAwKSB7CiAgICAgICAgcmV0dXJuIHRydWU7IC8vIEFsd2F5cyB0cnVlCiAgICB9IGVsc2UgaWYgKGNvbmRpdGlvbiA9PSAxKSB7CiAgICAgICAgcmV0dXJuIGN1cnJlbnRfc3RhdGUgPT0gU1RBVEVfUkVBRFk7CiAgICB9IGVsc2UgaWYgKGNvbmRpdGlvbiA9PSAyKSB7CiAgICAgICAgcmV0dXJuIGV2ZW50ID49IEVWRU5UX1BST0NFU1MgJiYgZXZlbnQgPD0gRVZFTlRfQ09NUExFVEU7CiAgICB9IGVsc2UgaWYgKGNvbmRpdGlvbiA9PSAzKSB7CiAgICAgICAgcmV0dXJuIGNvbnRleHQgPiAwICYmIGNvbnRleHQgJSAyID09IDA7CiAgICB9IGVsc2UgaWYgKGNvbmRpdGlvbiA9PSA0KSB7CiAgICAgICAgcmV0dXJuIGN1cnJlbnRfc3RhdGUgIT0gU1RBVEVfRVJST1IgJiYgZXZlbnQgIT0gRVZFTlRfRVJST1I7CiAgICB9IGVsc2UgaWYgKGNvbmRpdGlvbiA9PSA1KSB7CiAgICAgICAgLy8gQ29tcGxleCBuZXN0ZWQgY29uZGl0aW9uCiAgICAgICAgaWYgKGN1cnJlbnRfc3RhdGUgPT0gU1RBVEVfUFJPQ0VTU0lORykgewogICAgICAgICAgICBpZiAoZXZlbnQgPT0gRVZFTlRfQ09NUExFVEUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0ID4gMTA7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQgPT0gRVZFTlRfRVJST1IpIHsKICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0IDwgNTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0ICUgMyA9PSAwOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50X3N0YXRlID09IFNUQVRFX1dBSVRJTkcpIHsKICAgICAgICAgICAgcmV0dXJuIGV2ZW50ID09IEVWRU5UX1RJTUVPVVQgfHwgZXZlbnQgPT0gRVZFTlRfUkVUUlk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoY29uZGl0aW9uID09IDYpIHsKICAgICAgICAvLyBNdWx0aS1sZXZlbCBjb25kaXRpb24gd2l0aCB2YXJpb3VzIGJyYW5jaGVzCiAgICAgICAgbGV0IHRlbXAxOiBpMzIgPSBjdXJyZW50X3N0YXRlICogMyArIGV2ZW50OwogICAgICAgIGxldCB0ZW1wMjogaTMyID0gY29udGV4dCAvIDI7CgogICAgICAgIGlmICh0ZW1wMSA+IHRlbXAyKSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50X3N0YXRlIDwgU1RBVEVfU1VTUEVOREVEKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZXZlbnQgIT0gRVZFTlRfQUJPUlQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZXZlbnQgPT0gRVZFTlRfUkVTVU1FIHx8IGV2ZW50ID09IEVWRU5UX1JFU0VUOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKHRlbXAxICUgNCA9PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dCA+IHRlbXAxOwogICAgICAgICAgICB9IGVsc2UgaWYgKHRlbXAxICUgNCA9PSAxKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dCA8IHRlbXAxOwogICAgICAgICAgICB9IGVsc2UgaWYgKHRlbXAxICUgNCA9PSAyKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dCA9PSB0ZW1wMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0ICE9IHRlbXAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICAvLyBEZWZhdWx0IGNvbXBsZXggY29uZGl0aW9uCiAgICAgICAgcmV0dXJuIChjb25kaXRpb24gKyBjdXJyZW50X3N0YXRlICsgZXZlbnQgKyBjb250ZXh0KSAlIDcgPiAzOwogICAgfQp9CgovLyBFeGVjdXRlIGFjdGlvbiBiYXNlZCBvbiBhY3Rpb24gSUQKZm4gZXhlY3V0ZV9hY3Rpb24oYWN0aW9uX2lkOiBpMzIsIGZzbTogJm11dCBGU00sIGNvbnRleHQ6ICZtdXQgaTMyKSAtPiBpMzIgewogICAgaWYgKGFjdGlvbl9pZCA9PSAwKSB7CiAgICAgICAgcmV0dXJuIDA7IC8vIE5vIGFjdGlvbgogICAgfSBlbHNlIGlmIChhY3Rpb25faWQgPT0gMSkgewogICAgICAgICpjb250ZXh0ID0gKmNvbnRleHQgKyAxOwogICAgICAgIHJldHVybiAxOwogICAgfSBlbHNlIGlmIChhY3Rpb25faWQgPT0gMikgewogICAgICAgICpjb250ZXh0ID0gKmNvbnRleHQgKiAyOwogICAgICAgIHJldHVybiAyOwogICAgfSBlbHNlIGlmIChhY3Rpb25faWQgPT0gMykgewogICAgICAgICpjb250ZXh0ID0gKmNvbnRleHQgLSAxOwogICAgICAgIGlmICgqY29udGV4dCA8IDApIHsKICAgICAgICAgICAgKmNvbnRleHQgPSAwOwogICAgICAgIH0KICAgICAgICByZXR1cm4gMzsKICAgIH0gZWxzZSBpZiAoYWN0aW9uX2lkID09IDQpIHsKICAgICAgICAvLyBDb21wbGV4IGFjdGlvbiB3aXRoIG11bHRpcGxlIG9wZXJhdGlvbnMKICAgICAgICBsZXQgdGVtcDogaTMyID0gKmNvbnRleHQ7CiAgICAgICAgKmNvbnRleHQgPSAodGVtcCAqIDMgKyAxNykgJSAxMDA7CiAgICAgICAgZnNtLmVycm9yX2NvdW50ID0gZnNtLmVycm9yX2NvdW50ICsgMTsKICAgICAgICByZXR1cm4gNDsKICAgIH0gZWxzZSBpZiAoYWN0aW9uX2lkID09IDUpIHsKICAgICAgICAvLyBDb25kaXRpb25hbCBhY3Rpb24gZXhlY3V0aW9uCiAgICAgICAgaWYgKCpjb250ZXh0ID4gNTApIHsKICAgICAgICAgICAgKmNvbnRleHQgPSAqY29udGV4dCAvIDI7CiAgICAgICAgICAgIGZzbV9hZGRfZXZlbnQoZnNtLCBFVkVOVF9SRVRSWSk7CiAgICAgICAgfSBlbHNlIGlmICgqY29udGV4dCA+IDI1KSB7CiAgICAgICAgICAgICpjb250ZXh0ID0gKmNvbnRleHQgKiAzOwogICAgICAgICAgICBmc21fYWRkX2V2ZW50KGZzbSwgRVZFTlRfUFJPQ0VTUyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgKmNvbnRleHQgPSAqY29udGV4dCArIDEwOwogICAgICAgICAgICBmc21fYWRkX2V2ZW50KGZzbSwgRVZFTlRfQ09NUExFVEUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gNTsKICAgIH0gZWxzZSBpZiAoYWN0aW9uX2lkID09IDYpIHsKICAgICAgICAvLyBNdWx0aS1zdGVwIGFjdGlvbiB3aXRoIGJyYW5jaGluZwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IDUpIHsKICAgICAgICAgICAgaWYgKGkgJSAyID09IDApIHsKICAgICAgICAgICAgICAgICpjb250ZXh0ID0gKmNvbnRleHQgKyBpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgKmNvbnRleHQgPSAqY29udGV4dCAtIGk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgqY29udGV4dCAlIDMgPT0gMCkgewogICAgICAgICAgICAgICAgZnNtX2FkZF9ldmVudChmc20sIEVWRU5UX1BST0NFU1MgKyBpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIHJldHVybiA2OwogICAgfSBlbHNlIHsKICAgICAgICAvLyBEZWZhdWx0IGFjdGlvbiB3aXRoIGNvbXBsZXggY29tcHV0YXRpb24KICAgICAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gYWN0aW9uX2lkOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IGFjdGlvbl9pZCAlIDEwKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCAqIDIgKyAqY29udGV4dDsKICAgICAgICAgICAgaWYgKHJlc3VsdCA+IDEwMDApIHsKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCAlIDEwMDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH07CiAgICAgICAgKmNvbnRleHQgPSByZXN1bHQgJSAxMDA7CiAgICAgICAgcmV0dXJuIGFjdGlvbl9pZDsKICAgIH0KfQoKLy8gUHJvY2VzcyBzaW5nbGUgRlNNIHN0ZXAKZm4gZnNtX3N0ZXAoZnNtOiAmbXV0IEZTTSwgY29udGV4dDogJm11dCBpMzIpIC0+IGJvb2wgewogICAgbGV0IGV2ZW50OiBpMzIgPSBmc21fZ2V0X2V2ZW50KGZzbSk7CiAgICBpZiAoZXZlbnQgPT0gSU5WQUxJRF9FVkVOVCkgewogICAgICAgIHJldHVybiBmYWxzZTsgLy8gTm8gZXZlbnRzIHRvIHByb2Nlc3MKICAgIH0KCiAgICAvLyBGaW5kIG1hdGNoaW5nIHRyYW5zaXRpb24KICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgZnNtLnRyYW5zaXRpb25fY291bnQpIHsKICAgICAgICBsZXQgdHJhbnNpdGlvbjogJlRyYW5zaXRpb24gPSAmZnNtLnRyYW5zaXRpb25zW2kgYXMgdXNpemVdOwoKICAgICAgICBpZiAodHJhbnNpdGlvbi5mcm9tX3N0YXRlID09IGZzbS5jdXJyZW50X3N0YXRlICYmIHRyYW5zaXRpb24uZXZlbnQgPT0gZXZlbnQpIHsKICAgICAgICAgICAgaWYgKGV2YWx1YXRlX2NvbmRpdGlvbih0cmFuc2l0aW9uLmNvbmRpdGlvbiwgZnNtLmN1cnJlbnRfc3RhdGUsIGV2ZW50LCAqY29udGV4dCkpIHsKICAgICAgICAgICAgICAgIC8vIEV4ZWN1dGUgdHJhbnNpdGlvbgogICAgICAgICAgICAgICAgZnNtLnByZXZpb3VzX3N0YXRlID0gZnNtLmN1cnJlbnRfc3RhdGU7CiAgICAgICAgICAgICAgICBmc20uY3VycmVudF9zdGF0ZSA9IHRyYW5zaXRpb24udG9fc3RhdGU7CgogICAgICAgICAgICAgICAgLy8gVXBkYXRlIHN0YXRlIGNvdW50ZXJzCiAgICAgICAgICAgICAgICBmc20uc3RhdGVfY291bnRlcnNbKGZzbS5jdXJyZW50X3N0YXRlKSBhcyB1c2l6ZV0gPQogICAgICAgICAgICAgICAgICAgIGZzbS5zdGF0ZV9jb3VudGVyc1soZnNtLmN1cnJlbnRfc3RhdGUpIGFzIHVzaXplXSArIDE7CiAgICAgICAgICAgICAgICBmc20udG90YWxfdHJhbnNpdGlvbnMgPSBmc20udG90YWxfdHJhbnNpdGlvbnMgKyAxOwoKICAgICAgICAgICAgICAgIC8vIEV4ZWN1dGUgYWN0aW9uCiAgICAgICAgICAgICAgICBleGVjdXRlX2FjdGlvbih0cmFuc2l0aW9uLmFjdGlvbl9pZCwgZnNtLCBjb250ZXh0KTsKCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gTm8gdmFsaWQgdHJhbnNpdGlvbiBmb3VuZAogICAgZnNtLmVycm9yX2NvdW50ID0gZnNtLmVycm9yX2NvdW50ICsgMTsKICAgIGZhbHNlCn0KCi8vIEluaXRpYWxpemUgcHJvdG9jb2wgcGFyc2VyCmZuIGluaXRfcHJvdG9jb2xfcGFyc2VyKCkgLT4gUHJvdG9jb2xQYXJzZXIgewogICAgUHJvdG9jb2xQYXJzZXIgewogICAgICAgIHN0YXRlOiAwLCAvLyBJZGxlIHN0YXRlCiAgICAgICAgYnVmZmVyOiBbMDsgTUFYX1BST1RPQ09MX0JVRkZFUl0sCiAgICAgICAgYnVmZmVyX3BvczogMCwKICAgICAgICBwYWNrZXRfY291bnQ6IDAsCiAgICAgICAgZXJyb3JfY291bnQ6IDAsCiAgICAgICAgc2VxdWVuY2VfbnVtYmVyOiAwLAogICAgICAgIGV4cGVjdGVkX3NlcTogMSwKICAgIH0KfQoKLy8gUGFyc2UgcHJvdG9jb2wgcGFja2V0IHdpdGggY29tcGxleCBzdGF0ZSBsb2dpYwpmbiBwYXJzZV9wYWNrZXQocGFyc2VyOiAmbXV0IFByb3RvY29sUGFyc2VyLCBwYWNrZXRfdHlwZTogaTMyLCBkYXRhOiBpMzIsIHNlcTogaTMyKSAtPiBpMzIgewogICAgLy8gQ29tcGxleCBwYXJzaW5nIGxvZ2ljIHdpdGggbXVsdGlwbGUgc3RhdGVzIGFuZCBjb25kaXRpb25zCiAgICBpZiAocGFyc2VyLnN0YXRlID09IDApIHsKICAgICAgICAvLyBJZGxlCiAgICAgICAgaWYgKHBhY2tldF90eXBlID09IFBBQ0tFVF9TWU4pIHsKICAgICAgICAgICAgcGFyc2VyLnN0YXRlID0gMTsgLy8gU1lOIHJlY2VpdmVkCiAgICAgICAgICAgIHBhcnNlci5leHBlY3RlZF9zZXEgPSBzZXEgKyAxOwogICAgICAgICAgICByZXR1cm4gMTsgLy8gU2VuZCBTWU4tQUNLCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcGFyc2VyLmVycm9yX2NvdW50ID0gcGFyc2VyLmVycm9yX2NvdW50ICsgMTsKICAgICAgICAgICAgcmV0dXJuIC0xOyAvLyBFcnJvcgogICAgICAgIH0KICAgIH0gZWxzZSBpZiAocGFyc2VyLnN0YXRlID09IDEpIHsKICAgICAgICAvLyBTWU4gcmVjZWl2ZWQKICAgICAgICBpZiAocGFja2V0X3R5cGUgPT0gUEFDS0VUX0FDSyAmJiBzZXEgPT0gcGFyc2VyLmV4cGVjdGVkX3NlcSkgewogICAgICAgICAgICBwYXJzZXIuc3RhdGUgPSAyOyAvLyBFc3RhYmxpc2hlZAogICAgICAgICAgICBwYXJzZXIuZXhwZWN0ZWRfc2VxID0gc2VxICsgMTsKICAgICAgICAgICAgcmV0dXJuIDI7IC8vIENvbm5lY3Rpb24gZXN0YWJsaXNoZWQKICAgICAgICB9IGVsc2UgaWYgKHBhY2tldF90eXBlID09IFBBQ0tFVF9SU1QpIHsKICAgICAgICAgICAgcGFyc2VyLnN0YXRlID0gMDsgLy8gUmVzZXQgdG8gaWRsZQogICAgICAgICAgICByZXR1cm4gMDsgLy8gQ29ubmVjdGlvbiByZXNldAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHBhcnNlci5lcnJvcl9jb3VudCA9IHBhcnNlci5lcnJvcl9jb3VudCArIDE7CiAgICAgICAgICAgIHJldHVybiAtMTsgLy8gRXJyb3IKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKHBhcnNlci5zdGF0ZSA9PSAyKSB7CiAgICAgICAgLy8gRXN0YWJsaXNoZWQKICAgICAgICBpZiAocGFja2V0X3R5cGUgPT0gUEFDS0VUX0RBVEEpIHsKICAgICAgICAgICAgaWYgKHNlcSA9PSBwYXJzZXIuZXhwZWN0ZWRfc2VxKSB7CiAgICAgICAgICAgICAgICAvLyBTdG9yZSBkYXRhIGluIGJ1ZmZlcgogICAgICAgICAgICAgICAgaWYgKHBhcnNlci5idWZmZXJfcG9zIDwgTUFYX1BST1RPQ09MX0JVRkZFUiBhcyBpMzIpIHsKICAgICAgICAgICAgICAgICAgICBwYXJzZXIuYnVmZmVyWyhwYXJzZXIuYnVmZmVyX3BvcykgYXMgdXNpemVdID0gZGF0YTsKICAgICAgICAgICAgICAgICAgICBwYXJzZXIuYnVmZmVyX3BvcyA9IHBhcnNlci5idWZmZXJfcG9zICsgMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHBhcnNlci5leHBlY3RlZF9zZXEgPSBzZXEgKyAxOwogICAgICAgICAgICAgICAgcGFyc2VyLnBhY2tldF9jb3VudCA9IHBhcnNlci5wYWNrZXRfY291bnQgKyAxOwogICAgICAgICAgICAgICAgcmV0dXJuIDM7IC8vIFNlbmQgQUNLCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBwYXJzZXIuZXJyb3JfY291bnQgPSBwYXJzZXIuZXJyb3JfY291bnQgKyAxOwogICAgICAgICAgICAgICAgcmV0dXJuIDQ7IC8vIE91dCBvZiBvcmRlciwgcmVxdWVzdCByZXRyYW5zbWl0CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHBhY2tldF90eXBlID09IFBBQ0tFVF9GSU4pIHsKICAgICAgICAgICAgcGFyc2VyLnN0YXRlID0gMzsgLy8gQ2xvc2luZwogICAgICAgICAgICByZXR1cm4gNTsgLy8gU2VuZCBGSU4tQUNLCiAgICAgICAgfSBlbHNlIGlmIChwYWNrZXRfdHlwZSA9PSBQQUNLRVRfUElORykgewogICAgICAgICAgICByZXR1cm4gNjsgLy8gU2VuZCBQT05HCiAgICAgICAgfSBlbHNlIGlmIChwYWNrZXRfdHlwZSA9PSBQQUNLRVRfUlNUKSB7CiAgICAgICAgICAgIHBhcnNlci5zdGF0ZSA9IDA7IC8vIFJlc2V0IHRvIGlkbGUKICAgICAgICAgICAgcGFyc2VyLmJ1ZmZlcl9wb3MgPSAwOwogICAgICAgICAgICByZXR1cm4gMDsgLy8gQ29ubmVjdGlvbiByZXNldAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHBhcnNlci5lcnJvcl9jb3VudCA9IHBhcnNlci5lcnJvcl9jb3VudCArIDE7CiAgICAgICAgICAgIHJldHVybiAtMTsgLy8gRXJyb3IKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKHBhcnNlci5zdGF0ZSA9PSAzKSB7CiAgICAgICAgLy8gQ2xvc2luZwogICAgICAgIGlmIChwYWNrZXRfdHlwZSA9PSBQQUNLRVRfQUNLKSB7CiAgICAgICAgICAgIHBhcnNlci5zdGF0ZSA9IDA7IC8vIEJhY2sgdG8gaWRsZQogICAgICAgICAgICBwYXJzZXIuYnVmZmVyX3BvcyA9IDA7CiAgICAgICAgICAgIHJldHVybiA3OyAvLyBDb25uZWN0aW9uIGNsb3NlZAogICAgICAgIH0gZWxzZSBpZiAocGFja2V0X3R5cGUgPT0gUEFDS0VUX1JTVCkgewogICAgICAgICAgICBwYXJzZXIuc3RhdGUgPSAwOyAvLyBSZXNldCB0byBpZGxlCiAgICAgICAgICAgIHBhcnNlci5idWZmZXJfcG9zID0gMDsKICAgICAgICAgICAgcmV0dXJuIDA7IC8vIENvbm5lY3Rpb24gcmVzZXQKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwYXJzZXIuZXJyb3JfY291bnQgPSBwYXJzZXIuZXJyb3JfY291bnQgKyAxOwogICAgICAgICAgICByZXR1cm4gLTE7IC8vIEVycm9yCiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICAvLyBJbnZhbGlkIHN0YXRlCiAgICAgICAgcGFyc2VyLmVycm9yX2NvdW50ID0gcGFyc2VyLmVycm9yX2NvdW50ICsgMTsKICAgICAgICBwYXJzZXIuc3RhdGUgPSAwOyAvLyBSZXNldCB0byBpZGxlCiAgICAgICAgcmV0dXJuIC0xOyAvLyBFcnJvcgogICAgfQp9CgovLyBJbml0aWFsaXplIHRhc2sgc2NoZWR1bGVyCmZuIGluaXRfdGFza19zY2hlZHVsZXIoKSAtPiBUYXNrU2NoZWR1bGVyIHsKICAgIFRhc2tTY2hlZHVsZXIgewogICAgICAgIHRhc2tzOiBbVGFzayB7CiAgICAgICAgICAgIGlkOiAwLAogICAgICAgICAgICBwcmlvcml0eTogMCwKICAgICAgICAgICAgc3RhdGU6IDAsCiAgICAgICAgICAgIHJlbWFpbmluZ190aW1lOiAwLAogICAgICAgICAgICB3YWl0X2V2ZW50OiAwLAogICAgICAgICAgICBuZXh0X3Rhc2s6IC0xLAogICAgICAgICAgICBleGVjdXRpb25fY291bnQ6IDAsCiAgICAgICAgfTsgTUFYX1RBU0tTXSwKICAgICAgICB0YXNrX2NvdW50OiAwLAogICAgICAgIGN1cnJlbnRfdGFzazogLTEsCiAgICAgICAgcmVhZHlfcXVldWU6IFstMTsgTUFYX1RBU0tTXSwKICAgICAgICB3YWl0aW5nX3F1ZXVlOiBbLTE7IE1BWF9UQVNLU10sCiAgICAgICAgcmVhZHlfY291bnQ6IDAsCiAgICAgICAgd2FpdGluZ19jb3VudDogMCwKICAgICAgICB0aW1lX3NsaWNlOiAxMCwKICAgICAgICBjdXJyZW50X3RpbWU6IDAsCiAgICB9Cn0KCi8vIEFkZCB0YXNrIHRvIHNjaGVkdWxlcgpmbiBhZGRfdGFzayhzY2hlZHVsZXI6ICZtdXQgVGFza1NjaGVkdWxlciwgcHJpb3JpdHk6IGkzMiwgZXhlY3V0aW9uX3RpbWU6IGkzMikgLT4gaTMyIHsKICAgIGlmIChzY2hlZHVsZXIudGFza19jb3VudCA+PSBNQVhfVEFTS1MgYXMgaTMyKSB7CiAgICAgICAgcmV0dXJuIC0xOyAvLyBObyBzcGFjZQogICAgfQoKICAgIGxldCB0YXNrX2lkOiBpMzIgPSBzY2hlZHVsZXIudGFza19jb3VudDsKICAgIHNjaGVkdWxlci50YXNrc1t0YXNrX2lkIGFzIHVzaXplXSA9IFRhc2sgewogICAgICAgIGlkOiB0YXNrX2lkLAogICAgICAgIHByaW9yaXR5OiBwcmlvcml0eSwKICAgICAgICBzdGF0ZTogMCwgLy8gUmVhZHkKICAgICAgICByZW1haW5pbmdfdGltZTogZXhlY3V0aW9uX3RpbWUsCiAgICAgICAgd2FpdF9ldmVudDogLTEsCiAgICAgICAgbmV4dF90YXNrOiAtMSwKICAgICAgICBleGVjdXRpb25fY291bnQ6IDAsCiAgICB9OwoKICAgIC8vIEluc2VydCBpbnRvIHJlYWR5IHF1ZXVlIGJhc2VkIG9uIHByaW9yaXR5CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNjaGVkdWxlci5yZWFkeV9jb3VudCkgewogICAgICAgIGxldCBleGlzdGluZ190YXNrOiBpMzIgPSBzY2hlZHVsZXIucmVhZHlfcXVldWVbaSBhcyB1c2l6ZV07CiAgICAgICAgaWYgKHNjaGVkdWxlci50YXNrc1tleGlzdGluZ190YXNrIGFzIHVzaXplXS5wcmlvcml0eSA8IHByaW9yaXR5KSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gU2hpZnQgZWxlbWVudHMgdG8gbWFrZSBzcGFjZQogICAgbGV0IG11dCBqOiBpMzIgPSBzY2hlZHVsZXIucmVhZHlfY291bnQ7CiAgICB3aGlsZSAoaiA+IGkpIHsKICAgICAgICBzY2hlZHVsZXIucmVhZHlfcXVldWVbaiBhcyB1c2l6ZV0gPSBzY2hlZHVsZXIucmVhZHlfcXVldWVbaiBhcyB1c2l6ZSAtIDFdOwogICAgICAgIGogPSBqIC0gMTsKICAgIH0KCiAgICBzY2hlZHVsZXIucmVhZHlfcXVldWVbaSBhcyB1c2l6ZV0gPSB0YXNrX2lkOwogICAgc2NoZWR1bGVyLnJlYWR5X2NvdW50ID0gc2NoZWR1bGVyLnJlYWR5X2NvdW50ICsgMTsKICAgIHNjaGVkdWxlci50YXNrX2NvdW50ID0gc2NoZWR1bGVyLnRhc2tfY291bnQgKyAxOwoKICAgIHRhc2tfaWQKfQoKLy8gU2NoZWR1bGUgbmV4dCB0YXNrIHdpdGggY29tcGxleCBwcmlvcml0eSBsb2dpYwpmbiBzY2hlZHVsZV9uZXh0X3Rhc2soc2NoZWR1bGVyOiAmbXV0IFRhc2tTY2hlZHVsZXIpIC0+IGkzMiB7CiAgICBzY2hlZHVsZXIuY3VycmVudF90aW1lID0gc2NoZWR1bGVyLmN1cnJlbnRfdGltZSArIDE7CgogICAgLy8gQ2hlY2sgZm9yIHRhc2sgY29tcGxldGlvbiBvciBwcmVlbXB0aW9uCiAgICBpZiAoc2NoZWR1bGVyLmN1cnJlbnRfdGFzayAhPSAtMSkgewogICAgICAgIGxldCBjdXJyZW50OiBpMzIgPSBzY2hlZHVsZXIuY3VycmVudF90YXNrOwogICAgICAgIHNjaGVkdWxlci50YXNrc1tjdXJyZW50IGFzIHVzaXplXS5yZW1haW5pbmdfdGltZSA9CiAgICAgICAgICAgIHNjaGVkdWxlci50YXNrc1tjdXJyZW50IGFzIHVzaXplXS5yZW1haW5pbmdfdGltZSAtIDE7CiAgICAgICAgc2NoZWR1bGVyLnRhc2tzW2N1cnJlbnQgYXMgdXNpemVdLmV4ZWN1dGlvbl9jb3VudCA9CiAgICAgICAgICAgIHNjaGVkdWxlci50YXNrc1tjdXJyZW50IGFzIHVzaXplXS5leGVjdXRpb25fY291bnQgKyAxOwoKICAgICAgICBpZiAoc2NoZWR1bGVyLnRhc2tzW2N1cnJlbnQgYXMgdXNpemVdLnJlbWFpbmluZ190aW1lIDw9IDApIHsKICAgICAgICAgICAgLy8gVGFzayBjb21wbGV0ZWQKICAgICAgICAgICAgc2NoZWR1bGVyLnRhc2tzW2N1cnJlbnQgYXMgdXNpemVdLnN0YXRlID0gMjsgLy8gQ29tcGxldGVkCiAgICAgICAgICAgIHNjaGVkdWxlci5jdXJyZW50X3Rhc2sgPSAtMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBDaGVjayBmb3IgcHJlZW1wdGlvbiBiYXNlZCBvbiBjb21wbGV4IGxvZ2ljCiAgICAgICAgICAgIGxldCBtdXQgc2hvdWxkX3ByZWVtcHQ6IGJvb2wgPSBmYWxzZTsKCiAgICAgICAgICAgIGlmIChzY2hlZHVsZXIucmVhZHlfY291bnQgPiAwKSB7CiAgICAgICAgICAgICAgICBsZXQgbmV4dF90YXNrOiBpMzIgPSBzY2hlZHVsZXIucmVhZHlfcXVldWVbMF07CiAgICAgICAgICAgICAgICBsZXQgY3VycmVudF9wcmlvcml0eTogaTMyID0gc2NoZWR1bGVyLnRhc2tzW2N1cnJlbnQgYXMgdXNpemVdLnByaW9yaXR5OwogICAgICAgICAgICAgICAgbGV0IG5leHRfcHJpb3JpdHk6IGkzMiA9IHNjaGVkdWxlci50YXNrc1tuZXh0X3Rhc2sgYXMgdXNpemVdLnByaW9yaXR5OwoKICAgICAgICAgICAgICAgIC8vIENvbXBsZXggcHJlZW1wdGlvbiBsb2dpYwogICAgICAgICAgICAgICAgaWYgKG5leHRfcHJpb3JpdHkgPiBjdXJyZW50X3ByaW9yaXR5KSB7CiAgICAgICAgICAgICAgICAgICAgc2hvdWxkX3ByZWVtcHQgPSB0cnVlOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuZXh0X3ByaW9yaXR5ID09IGN1cnJlbnRfcHJpb3JpdHkpIHsKICAgICAgICAgICAgICAgICAgICAvLyBSb3VuZC1yb2JpbiB3aXRoaW4gc2FtZSBwcmlvcml0eQogICAgICAgICAgICAgICAgICAgIGlmIChzY2hlZHVsZXIudGFza3NbY3VycmVudCBhcyB1c2l6ZV0uZXhlY3V0aW9uX2NvdW50ICUgc2NoZWR1bGVyLnRpbWVfc2xpY2UKICAgICAgICAgICAgICAgICAgICAgICAgPT0gMCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZF9wcmVlbXB0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNjaGVkdWxlci5jdXJyZW50X3RpbWUgJSA1MCA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gUGVyaW9kaWMgcHJlZW1wdGlvbiB0byBwcmV2ZW50IHN0YXJ2YXRpb24KICAgICAgICAgICAgICAgICAgICBzaG91bGRfcHJlZW1wdCA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChzaG91bGRfcHJlZW1wdCkgewogICAgICAgICAgICAgICAgLy8gTW92ZSBjdXJyZW50IHRhc2sgYmFjayB0byByZWFkeSBxdWV1ZQogICAgICAgICAgICAgICAgc2NoZWR1bGVyLnRhc2tzW2N1cnJlbnQgYXMgdXNpemVdLnN0YXRlID0gMDsgLy8gUmVhZHkKCiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgYmFjayBpbnRvIHJlYWR5IHF1ZXVlCiAgICAgICAgICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgICAgICAgICB3aGlsZSAoaSA8IHNjaGVkdWxlci5yZWFkeV9jb3VudCkgewogICAgICAgICAgICAgICAgICAgIGxldCBleGlzdGluZ190YXNrOiBpMzIgPSBzY2hlZHVsZXIucmVhZHlfcXVldWVbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAgICAgaWYgKHNjaGVkdWxlci50YXNrc1tleGlzdGluZ190YXNrIGFzIHVzaXplXS5wcmlvcml0eQogICAgICAgICAgICAgICAgICAgICAgICA8IHNjaGVkdWxlci50YXNrc1tjdXJyZW50IGFzIHVzaXplXS5wcmlvcml0eSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gU2hpZnQgYW5kIGluc2VydAogICAgICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSBzY2hlZHVsZXIucmVhZHlfY291bnQ7CiAgICAgICAgICAgICAgICB3aGlsZSAoaiA+IGkpIHsKICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZXIucmVhZHlfcXVldWVbaiBhcyB1c2l6ZV0gPSBzY2hlZHVsZXIucmVhZHlfcXVldWVbaiBhcyB1c2l6ZSAtIDFdOwogICAgICAgICAgICAgICAgICAgIGogPSBqIC0gMTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBzY2hlZHVsZXIucmVhZHlfcXVldWVbaSBhcyB1c2l6ZV0gPSBjdXJyZW50OwogICAgICAgICAgICAgICAgc2NoZWR1bGVyLnJlYWR5X2NvdW50ID0gc2NoZWR1bGVyLnJlYWR5X2NvdW50ICsgMTsKICAgICAgICAgICAgICAgIHNjaGVkdWxlci5jdXJyZW50X3Rhc2sgPSAtMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLyBTZWxlY3QgbmV4dCB0YXNrIGlmIG5vIGN1cnJlbnQgdGFzawogICAgaWYgKHNjaGVkdWxlci5jdXJyZW50X3Rhc2sgPT0gLTEgJiYgc2NoZWR1bGVyLnJlYWR5X2NvdW50ID4gMCkgewogICAgICAgIHNjaGVkdWxlci5jdXJyZW50X3Rhc2sgPSBzY2hlZHVsZXIucmVhZHlfcXVldWVbMF07CiAgICAgICAgc2NoZWR1bGVyLnRhc2tzWyhzY2hlZHVsZXIuY3VycmVudF90YXNrKSBhcyB1c2l6ZV0uc3RhdGUgPSAxOyAvLyBSdW5uaW5nCgogICAgICAgIC8vIFJlbW92ZSBmcm9tIHJlYWR5IHF1ZXVlCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgc2NoZWR1bGVyLnJlYWR5X2NvdW50IC0gMSkgewogICAgICAgICAgICBzY2hlZHVsZXIucmVhZHlfcXVldWVbaSBhcyB1c2l6ZV0gPSBzY2hlZHVsZXIucmVhZHlfcXVldWVbaSBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIHNjaGVkdWxlci5yZWFkeV9jb3VudCA9IHNjaGVkdWxlci5yZWFkeV9jb3VudCAtIDE7CiAgICB9CgogICAgc2NoZWR1bGVyLmN1cnJlbnRfdGFzawp9CgovLyBDb21wbGV4IGNvbnRyb2wgZmxvdyB0ZXN0IHdpdGggZGVlcCBuZXN0aW5nCmZuIGNvbXBsZXhfbmVzdGVkX2NvbnRyb2xfZmxvdyhkZXB0aDogaTMyLCB2YWx1ZTogaTMyKSAtPiBpMzIgewogICAgaWYgKGRlcHRoIDw9IDApIHsKICAgICAgICByZXR1cm4gdmFsdWU7CiAgICB9CgogICAgbGV0IG11dCByZXN1bHQ6IGkzMiA9IHZhbHVlOwoKICAgIC8vIENvbXBsZXggbmVzdGVkIGJyYW5jaGluZwogICAgaWYgKGRlcHRoICUgNyA9PSAwKSB7CiAgICAgICAgaWYgKHZhbHVlID4gMTAwKSB7CiAgICAgICAgICAgIGlmICh2YWx1ZSAlIDMgPT0gMCkgewogICAgICAgICAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgICAgICAgICAgd2hpbGUgKGkgPCBkZXB0aCkgewogICAgICAgICAgICAgICAgICAgIGlmIChpICUgMiA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCArIGkgKiAyOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID4gMTAwMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICUgMTAwMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPCAxMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgKyA1MDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCAtIGk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPCAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSAtcmVzdWx0OwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSAlIDMgPT0gMSkgewogICAgICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSBkZXB0aDsKICAgICAgICAgICAgICAgIHdoaWxlIChqID4gMCkgewogICAgICAgICAgICAgICAgICAgIGlmIChqICUgNCA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCAqIDI7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChqICUgNCA9PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCArIGo7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChqICUgNCA9PSAyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCAtIGo7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0IC8gMjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPiA1MDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGogPSBqIC0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlc3VsdCA9IGNvbXBsZXhfbmVzdGVkX2NvbnRyb2xfZmxvdyhkZXB0aCAtIDEsIHJlc3VsdCAvIDIpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA+IDUwKSB7CiAgICAgICAgICAgIGxldCBtdXQgazogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKGsgPCAxMCkgewogICAgICAgICAgICAgICAgaWYgKGsgJSAzID09IDApIHsKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgKyBrICogZGVwdGg7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGsgJSAzID09IDEpIHsKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgLSBrICogZGVwdGg7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCAqIChrICsgMSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA+IDgwMCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgJSA4MDA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgayA9IGsgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0ID0gY29tcGxleF9uZXN0ZWRfY29udHJvbF9mbG93KGRlcHRoIC0gMiwgcmVzdWx0ICsgZGVwdGgpOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoZGVwdGggJSA3ID09IDEpIHsKICAgICAgICAvLyBBbm90aGVyIGNvbXBsZXggYnJhbmNoCiAgICAgICAgbGV0IHRlbXA6IGkzMiA9IHJlc3VsdDsKICAgICAgICBpZiAodGVtcCA+IGRlcHRoICogMTApIHsKICAgICAgICAgICAgcmVzdWx0ID0gY29tcGxleF9uZXN0ZWRfY29udHJvbF9mbG93KGRlcHRoIC0gMSwgdGVtcCAtIGRlcHRoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXN1bHQgPSBjb21wbGV4X25lc3RlZF9jb250cm9sX2Zsb3coZGVwdGggLSAxLCB0ZW1wICsgZGVwdGgpOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgLy8gRGVmYXVsdCByZWN1cnNpdmUgY2FzZSB3aXRoIG1vZGlmaWNhdGlvbgogICAgICAgIHJlc3VsdCA9IGNvbXBsZXhfbmVzdGVkX2NvbnRyb2xfZmxvdyhkZXB0aCAtIDEsIHJlc3VsdCAqIDIgKyBkZXB0aCk7CiAgICB9CgogICAgcmVzdWx0ICUgMTAwMDAgLy8gS2VlcCByZXN1bHQgbWFuYWdlYWJsZQp9CgovLyBNYWluIHRlc3QgZnVuY3Rpb24KZm4gdGVzdF9jb21wbGV4X2NvbnRyb2xfZmxvdygpIHsKICAgIHByaW50bG5JbnQoMjAwMDEpOyAvLyBUZXN0IHN0YXJ0IG1hcmtlcgoKICAgIC8vIFRlc3QgMTogRlNNIHdpdGggY29tcGxleCB0cmFuc2l0aW9ucwogICAgbGV0IG11dCBmc206IEZTTSA9IGluaXRfZnNtKCk7CiAgICBsZXQgbXV0IGNvbnRleHQ6IGkzMiA9IDQyOwoKICAgIC8vIFNldCB1cCBjb21wbGV4IHN0YXRlIG1hY2hpbmUKICAgIGFkZF90cmFuc2l0aW9uKCZtdXQgZnNtLCBTVEFURV9JTklULCBFVkVOVF9TVEFSVCwgU1RBVEVfUkVBRFksIDEsIDApOwogICAgYWRkX3RyYW5zaXRpb24oJm11dCBmc20sIFNUQVRFX1JFQURZLCBFVkVOVF9QUk9DRVNTLCBTVEFURV9QUk9DRVNTSU5HLCAyLCAxKTsKICAgIGFkZF90cmFuc2l0aW9uKAogICAgICAgICZtdXQgZnNtLAogICAgICAgIFNUQVRFX1BST0NFU1NJTkcsCiAgICAgICAgRVZFTlRfQ09NUExFVEUsCiAgICAgICAgU1RBVEVfUkVBRFksCiAgICAgICAgMywKICAgICAgICA1LAogICAgKTsKICAgIGFkZF90cmFuc2l0aW9uKCZtdXQgZnNtLCBTVEFURV9QUk9DRVNTSU5HLCBFVkVOVF9FUlJPUiwgU1RBVEVfRVJST1IsIDQsIDQpOwogICAgYWRkX3RyYW5zaXRpb24oJm11dCBmc20sIFNUQVRFX0VSUk9SLCBFVkVOVF9SRVRSWSwgU1RBVEVfUkVBRFksIDUsIDYpOwogICAgYWRkX3RyYW5zaXRpb24oJm11dCBmc20sIFNUQVRFX1JFQURZLCBFVkVOVF9TVVNQRU5ELCBTVEFURV9TVVNQRU5ERUQsIDYsIDIpOwogICAgYWRkX3RyYW5zaXRpb24oJm11dCBmc20sIFNUQVRFX1NVU1BFTkRFRCwgRVZFTlRfUkVTVU1FLCBTVEFURV9SRUFEWSwgMSwgMyk7CgogICAgLy8gR2VuZXJhdGUgY29tcGxleCBldmVudCBzZXF1ZW5jZQogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAxMDApIHsKICAgICAgICBsZXQgZXZlbnQ6IGkzMiA9IChpICogNyArIDMpICUgMTA7IC8vIEdlbmVyYXRlIHZhcmllZCBldmVudHMKICAgICAgICBmc21fYWRkX2V2ZW50KCZtdXQgZnNtLCBldmVudCk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIFByb2Nlc3MgZXZlbnRzCiAgICBsZXQgbXV0IHByb2Nlc3NlZDogaTMyID0gMDsKICAgIHdoaWxlIChwcm9jZXNzZWQgPCAxNTApIHsKICAgICAgICBpZiAoIWZzbV9zdGVwKCZtdXQgZnNtLCAmbXV0IGNvbnRleHQpKSB7CiAgICAgICAgICAgIGZzbV9hZGRfZXZlbnQoJm11dCBmc20sIEVWRU5UX1BST0NFU1MpOyAvLyBBZGQgbW9yZSBldmVudHMKICAgICAgICB9CiAgICAgICAgcHJvY2Vzc2VkID0gcHJvY2Vzc2VkICsgMTsKICAgIH0KCiAgICBwcmludGxuSW50KGZzbS50b3RhbF90cmFuc2l0aW9ucyk7CiAgICBwcmludGxuSW50KGZzbS5lcnJvcl9jb3VudCk7CiAgICBwcmludGxuSW50KGNvbnRleHQpOwoKICAgIC8vIFRlc3QgMjogUHJvdG9jb2wgcGFyc2VyIHNpbXVsYXRpb24KICAgIGxldCBtdXQgcGFyc2VyOiBQcm90b2NvbFBhcnNlciA9IGluaXRfcHJvdG9jb2xfcGFyc2VyKCk7CiAgICBsZXQgbXV0IHBhY2tldF9yZXNwb25zZXM6IGkzMiA9IDA7CgogICAgLy8gU2ltdWxhdGUgY29tcGxleCBwcm90b2NvbCBleGNoYW5nZQogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDIwMCkgewogICAgICAgIGxldCBwYWNrZXRfdHlwZTogaTMyID0gKGkgJSA3KSArIDE7CiAgICAgICAgbGV0IGRhdGE6IGkzMiA9IGkgKiAxMyArIDc7CiAgICAgICAgbGV0IHNlcTogaTMyID0gaSArIDE7CgogICAgICAgIGxldCByZXNwb25zZTogaTMyID0gcGFyc2VfcGFja2V0KCZtdXQgcGFyc2VyLCBwYWNrZXRfdHlwZSwgZGF0YSwgc2VxKTsKICAgICAgICBpZiAocmVzcG9uc2UgPiAwKSB7CiAgICAgICAgICAgIHBhY2tldF9yZXNwb25zZXMgPSBwYWNrZXRfcmVzcG9uc2VzICsgMTsKICAgICAgICB9CgogICAgICAgIC8vIENvbXBsZXggc3RhdGUtZGVwZW5kZW50IGxvZ2ljCiAgICAgICAgaWYgKHBhcnNlci5zdGF0ZSA9PSAyICYmIGkgJSAxMCA9PSAwKSB7CiAgICAgICAgICAgIC8vIFNlbmQgcGluZyBvY2Nhc2lvbmFsbHkKICAgICAgICAgICAgcGFyc2VfcGFja2V0KCZtdXQgcGFyc2VyLCBQQUNLRVRfUElORywgMCwgc2VxICsgMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAocGFyc2VyLmVycm9yX2NvdW50ID4gNSAmJiBpICUgMTUgPT0gMCkgewogICAgICAgICAgICAvLyBSZXNldCBvbiB0b28gbWFueSBlcnJvcnMKICAgICAgICAgICAgcGFyc2VfcGFja2V0KCZtdXQgcGFyc2VyLCBQQUNLRVRfUlNULCAwLCAwKTsKICAgICAgICB9CgogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBwcmludGxuSW50KHBhcnNlci5wYWNrZXRfY291bnQpOwogICAgcHJpbnRsbkludChwYXJzZXIuZXJyb3JfY291bnQpOwogICAgcHJpbnRsbkludChwYWNrZXRfcmVzcG9uc2VzKTsKCiAgICAvLyBUZXN0IDM6IFRhc2sgc2NoZWR1bGVyIHNpbXVsYXRpb24KICAgIGxldCBtdXQgc2NoZWR1bGVyOiBUYXNrU2NoZWR1bGVyID0gaW5pdF90YXNrX3NjaGVkdWxlcigpOwoKICAgIC8vIEFkZCB0YXNrcyB3aXRoIGRpZmZlcmVudCBwcmlvcml0aWVzCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgNTApIHsKICAgICAgICBsZXQgcHJpb3JpdHk6IGkzMiA9IChpICUgNCkgKyAxOwogICAgICAgIGxldCBleGVjdXRpb25fdGltZTogaTMyID0gKGkgKiAzICsgNSkgJSAyMCArIDE7CiAgICAgICAgYWRkX3Rhc2soJm11dCBzY2hlZHVsZXIsIHByaW9yaXR5LCBleGVjdXRpb25fdGltZSk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIFJ1biBzY2hlZHVsZXIgc2ltdWxhdGlvbgogICAgbGV0IG11dCBzY2hlZHVsaW5nX3N0ZXBzOiBpMzIgPSAwOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDEwMDApIHsKICAgICAgICBsZXQgY3VycmVudDogaTMyID0gc2NoZWR1bGVfbmV4dF90YXNrKCZtdXQgc2NoZWR1bGVyKTsKICAgICAgICBpZiAoY3VycmVudCAhPSAtMSkgewogICAgICAgICAgICBzY2hlZHVsaW5nX3N0ZXBzID0gc2NoZWR1bGluZ19zdGVwcyArIDE7CiAgICAgICAgfQoKICAgICAgICAvLyBPY2Nhc2lvbmFsbHkgYWRkIG5ldyB0YXNrcwogICAgICAgIGlmIChpICUgNTAgPT0gMCAmJiBzY2hlZHVsZXIudGFza19jb3VudCA8IE1BWF9UQVNLUyBhcyBpMzIpIHsKICAgICAgICAgICAgbGV0IHByaW9yaXR5OiBpMzIgPSAoKGkgLyA1MCkgJSA0KSArIDE7CiAgICAgICAgICAgIGxldCBleGVjdXRpb25fdGltZTogaTMyID0gKGkgLyAxMCkgJSAxNSArIDE7CiAgICAgICAgICAgIGFkZF90YXNrKCZtdXQgc2NoZWR1bGVyLCBwcmlvcml0eSwgZXhlY3V0aW9uX3RpbWUpOwogICAgICAgIH0KCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHByaW50bG5JbnQoc2NoZWR1bGluZ19zdGVwcyk7CiAgICBwcmludGxuSW50KHNjaGVkdWxlci50YXNrX2NvdW50KTsKCiAgICAvLyBUZXN0IDQ6IENvbXBsZXggbmVzdGVkIGNvbnRyb2wgZmxvdwogICAgbGV0IG11dCBuZXN0ZWRfcmVzdWx0czogaTMyID0gMDsKICAgIGkgPSAxOwogICAgd2hpbGUgKGkgPD0gMjApIHsKICAgICAgICBsZXQgcmVzdWx0OiBpMzIgPSBjb21wbGV4X25lc3RlZF9jb250cm9sX2Zsb3coaSwgaSAqIDE3ICsgMyk7CiAgICAgICAgbmVzdGVkX3Jlc3VsdHMgPSBuZXN0ZWRfcmVzdWx0cyArIHJlc3VsdDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcHJpbnRsbkludChuZXN0ZWRfcmVzdWx0cyAlIDEwMDAwMCk7CgogICAgLy8gVGVzdCA1OiBNdWx0aXBsZSBpbnRlcmFjdGluZyBzdGF0ZSBtYWNoaW5lcwogICAgbGV0IG11dCBmc20yOiBGU00gPSBpbml0X2ZzbSgpOwogICAgbGV0IG11dCBjb250ZXh0MjogaTMyID0gMTc7CgogICAgLy8gU2V0IHVwIHNlY29uZCBGU00gd2l0aCBkaWZmZXJlbnQgdHJhbnNpdGlvbnMKICAgIGFkZF90cmFuc2l0aW9uKCZtdXQgZnNtMiwgU1RBVEVfSU5JVCwgRVZFTlRfU1RBUlQsIFNUQVRFX1BST0NFU1NJTkcsIDIsIDApOwogICAgYWRkX3RyYW5zaXRpb24oCiAgICAgICAgJm11dCBmc20yLAogICAgICAgIFNUQVRFX1BST0NFU1NJTkcsCiAgICAgICAgRVZFTlRfUFJPQ0VTUywKICAgICAgICBTVEFURV9XQUlUSU5HLAogICAgICAgIDQsCiAgICAgICAgMiwKICAgICk7CiAgICBhZGRfdHJhbnNpdGlvbigmbXV0IGZzbTIsIFNUQVRFX1dBSVRJTkcsIEVWRU5UX1RJTUVPVVQsIFNUQVRFX0VSUk9SLCA2LCAxKTsKICAgIGFkZF90cmFuc2l0aW9uKCZtdXQgZnNtMiwgU1RBVEVfRVJST1IsIEVWRU5UX1JFU0VULCBTVEFURV9JTklULCAxLCAwKTsKCiAgICAvLyBJbnRlcmFjdCB0d28gRlNNcwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDEwMCkgewogICAgICAgIC8vIFByb2Nlc3MgRlNNIDEKICAgICAgICBpZiAoIWZzbV9zdGVwKCZtdXQgZnNtLCAmbXV0IGNvbnRleHQpKSB7CiAgICAgICAgICAgIGZzbV9hZGRfZXZlbnQoJm11dCBmc20sIChpICUgNSkgKyBFVkVOVF9TVEFSVCk7CiAgICAgICAgfQoKICAgICAgICAvLyBQcm9jZXNzIEZTTSAyCiAgICAgICAgaWYgKCFmc21fc3RlcCgmbXV0IGZzbTIsICZtdXQgY29udGV4dDIpKSB7CiAgICAgICAgICAgIGZzbV9hZGRfZXZlbnQoJm11dCBmc20yLCAoaSAlIDMpICsgRVZFTlRfU1RBUlQpOwogICAgICAgIH0KCiAgICAgICAgLy8gQ3Jvc3MtaW50ZXJhY3Rpb24gYmFzZWQgb24gc3RhdGVzCiAgICAgICAgaWYgKGZzbS5jdXJyZW50X3N0YXRlID09IFNUQVRFX1BST0NFU1NJTkcgJiYgZnNtMi5jdXJyZW50X3N0YXRlID09IFNUQVRFX1dBSVRJTkcpIHsKICAgICAgICAgICAgZnNtX2FkZF9ldmVudCgmbXV0IGZzbTIsIEVWRU5UX0NPTVBMRVRFKTsKICAgICAgICAgICAgZnNtX2FkZF9ldmVudCgmbXV0IGZzbSwgRVZFTlRfU1VTUEVORCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29udGV4dCA+IDgwICYmIGNvbnRleHQyIDwgMjApIHsKICAgICAgICAgICAgY29udGV4dDIgPSBjb250ZXh0MiArIGNvbnRleHQgLyA0OwogICAgICAgICAgICBjb250ZXh0ID0gY29udGV4dCAtIDEwOwogICAgICAgIH0KCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHByaW50bG5JbnQoZnNtMi50b3RhbF90cmFuc2l0aW9ucyk7CiAgICBwcmludGxuSW50KGNvbnRleHQyKTsKCiAgICBwcmludGxuSW50KDIwOTk5KTsgLy8gVGVzdCBlbmQgbWFya2VyCn0KCmZuIG1haW4oKSB7CiAgICB0ZXN0X2NvbXBsZXhfY29udHJvbF9mbG93KCk7CiAgICBleGl0KDApOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (21, "comprehensive21", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlMjEKQXV0aG9yOiBXZW54aW4gWmhlbmcKVGltZTogMjAyNS0wOC0xNwpWZXJkaWN0OiBQYXNzCkNvbW1lbnQ6IENvbXByZWhlbnNpdmUgdGVzdCBvZiBsYXJnZS1zY2FsZSBkYXRhIHByb2Nlc3NpbmcgYW5kIHBlcmZvcm1hbmNlIG9wdGltaXphdGlvbgogICAgICAgICBUZXN0czogTXVsdGlwbGUgc29ydGluZyBhbGdvcml0aG1zLCBzZWFyY2hpbmcgYWxnb3JpdGhtcywgc3RhdGlzdGljYWwgY29tcHV0YXRpb25zLAogICAgICAgICAgICAgICBtYXRyaXggb3BlcmF0aW9ucywgbnVtZXJpY2FsIGFsZ29yaXRobXMsIHBlcmZvcm1hbmNlIGNvbXBhcmlzb25zCiAgICAgICAgIEZvY3VzOiBMb29wIG9wdGltaXphdGlvbiwgdmVjdG9yaXphdGlvbiwgY2FjaGUgZWZmaWNpZW5jeSwgYWxnb3JpdGhtaWMgY29tcGxleGl0eSwKICAgICAgICAgICAgICAgY29ybmVyIGNhc2VzIHdpdGggZXh0cmVtZSBkYXRhIGRpc3RyaWJ1dGlvbnMsIG1lbW9yeSBhY2Nlc3MgcGF0dGVybnMKKi8KCi8vIENvbnN0YW50cyBmb3IgbGFyZ2Utc2NhbGUgZGF0YSBwcm9jZXNzaW5nCmNvbnN0IE1BWF9BUlJBWV9TSVpFOiB1c2l6ZSA9IDEwMDAwOwpjb25zdCBNQVRSSVhfU0laRTogdXNpemUgPSAxMDA7CmNvbnN0IEhBU0hfU0laRTogdXNpemUgPSAxMDA5OyAvLyBMYXJnZSBwcmltZSBmb3IgaGFzaCB0YWJsZQpjb25zdCBNQVhfSVRFUkFUSU9OUzogaTMyID0gMTAwMDsKY29uc3QgU1RBVElTVElDQUxfU0FNUExFUzogaTMyID0gNTAwMDsKY29uc3QgUEVSRk9STUFOQ0VfUlVOUzogaTMyID0gMTA7CgovLyBEYXRhIHN0cnVjdHVyZXMgZm9yIHBlcmZvcm1hbmNlIHRlc3RpbmcKc3RydWN0IERhdGFTZXQgewogICAgZGF0YTogW2kzMjsgTUFYX0FSUkFZX1NJWkVdLAogICAgc2l6ZTogaTMyLAogICAgc29ydGVkOiBib29sLAogICAgbWluX3ZhbHVlOiBpMzIsCiAgICBtYXhfdmFsdWU6IGkzMiwKICAgIHN1bTogaTMyLAogICAgbWVhbjogaTMyLAp9CgpzdHJ1Y3QgTWF0cml4IHsKICAgIGRhdGE6IFtbaTMyOyBNQVRSSVhfU0laRV07IE1BVFJJWF9TSVpFXSwKICAgIHJvd3M6IGkzMiwKICAgIGNvbHM6IGkzMiwKfQoKc3RydWN0IFBlcmZvcm1hbmNlQ291bnRlciB7CiAgICBvcGVyYXRpb25zOiBpMzIsCiAgICBjb21wYXJpc29uczogaTMyLAogICAgc3dhcHM6IGkzMiwKICAgIG1lbW9yeV9hY2Nlc3NlczogaTMyLAogICAgZnVuY3Rpb25fY2FsbHM6IGkzMiwKfQoKc3RydWN0IFNvcnRpbmdSZXN1bHRzIHsKICAgIGJ1YmJsZV90aW1lOiBpMzIsCiAgICBzZWxlY3Rpb25fdGltZTogaTMyLAogICAgaW5zZXJ0aW9uX3RpbWU6IGkzMiwKICAgIHF1aWNrX3RpbWU6IGkzMiwKICAgIG1lcmdlX3RpbWU6IGkzMiwKICAgIGhlYXBfdGltZTogaTMyLAp9CgovLyBJbml0aWFsaXplIGxhcmdlIGRhdGFzZXQgd2l0aCB2YXJpb3VzIHBhdHRlcm5zCmZuIGluaXRfZGF0YXNldF9wYXR0ZXJuKHBhdHRlcm46IGkzMiwgc2l6ZTogaTMyKSAtPiBEYXRhU2V0IHsKICAgIGxldCBtdXQgZGF0YXNldDogRGF0YVNldCA9IERhdGFTZXQgewogICAgICAgIGRhdGE6IFswOyBNQVhfQVJSQVlfU0laRV0sCiAgICAgICAgc2l6ZTogc2l6ZSwKICAgICAgICBzb3J0ZWQ6IGZhbHNlLAogICAgICAgIG1pbl92YWx1ZTogOTk5OTk5LAogICAgICAgIG1heF92YWx1ZTogLTk5OTk5OSwKICAgICAgICBzdW06IDAsCiAgICAgICAgbWVhbjogMCwKICAgIH07CgogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgbGV0IHZhbHVlOiBpMzIgPSBpZiAocGF0dGVybiA9PSAwKSB7CiAgICAgICAgICAgIC8vIFJhbmRvbS1saWtlIHBhdHRlcm4KICAgICAgICAgICAgKGkgKiAxMTA0NyArIDEyMzQ1KSAlIDEwMDAwMAogICAgICAgIH0gZWxzZSBpZiAocGF0dGVybiA9PSAxKSB7CiAgICAgICAgICAgIC8vIEFzY2VuZGluZyBwYXR0ZXJuCiAgICAgICAgICAgIGkgKiAzICsgNwogICAgICAgIH0gZWxzZSBpZiAocGF0dGVybiA9PSAyKSB7CiAgICAgICAgICAgIC8vIERlc2NlbmRpbmcgcGF0dGVybgogICAgICAgICAgICAoc2l6ZSAtIGkpICogNSArIDEzCiAgICAgICAgfSBlbHNlIGlmIChwYXR0ZXJuID09IDMpIHsKICAgICAgICAgICAgLy8gTW91bnRhaW4gcGF0dGVybiAoYXNjZW5kaW5nIHRoZW4gZGVzY2VuZGluZykKICAgICAgICAgICAgaWYgKGkgPCBzaXplIC8gMikgewogICAgICAgICAgICAgICAgaSAqIDQKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIChzaXplIC0gaSkgKiA0CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHBhdHRlcm4gPT0gNCkgewogICAgICAgICAgICAvLyBWYWxsZXkgcGF0dGVybiAoZGVzY2VuZGluZyB0aGVuIGFzY2VuZGluZykKICAgICAgICAgICAgaWYgKGkgPCBzaXplIC8gMikgewogICAgICAgICAgICAgICAgKHNpemUgLyAyIC0gaSkgKiAzCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAoaSAtIHNpemUgLyAyKSAqIDMKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAocGF0dGVybiA9PSA1KSB7CiAgICAgICAgICAgIC8vIE5lYXJseSBzb3J0ZWQgd2l0aCBmZXcgc3dhcHMKICAgICAgICAgICAgaSAqIDIgKyAoKGkgJSAxMCA9PSA1KSBhcyBpMzIpICogMTAwCiAgICAgICAgfSBlbHNlIGlmIChwYXR0ZXJuID09IDYpIHsKICAgICAgICAgICAgLy8gUmVwZWF0ZWQgdmFsdWVzCiAgICAgICAgICAgIChpIC8gMTApICogNyArIDIzCiAgICAgICAgfSBlbHNlIGlmIChwYXR0ZXJuID09IDcpIHsKICAgICAgICAgICAgLy8gQWx0ZXJuYXRpbmcgcGF0dGVybgogICAgICAgICAgICBpZiAoaSAlIDIgPT0gMCkgeyBpIH0gZWxzZSB7IHNpemUgLSBpIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBDb21wbGV4IHBhdHRlcm4KICAgICAgICAgICAgKGkgKiBpICsgaSAqIDcgKyAxNykgJSAxMDAwCiAgICAgICAgfTsKCiAgICAgICAgZGF0YXNldC5kYXRhW2kgYXMgdXNpemVdID0gdmFsdWU7CiAgICAgICAgZGF0YXNldC5zdW0gPSBkYXRhc2V0LnN1bSArIHZhbHVlOwoKICAgICAgICBpZiAodmFsdWUgPCBkYXRhc2V0Lm1pbl92YWx1ZSkgewogICAgICAgICAgICBkYXRhc2V0Lm1pbl92YWx1ZSA9IHZhbHVlOwogICAgICAgIH0KICAgICAgICBpZiAodmFsdWUgPiBkYXRhc2V0Lm1heF92YWx1ZSkgewogICAgICAgICAgICBkYXRhc2V0Lm1heF92YWx1ZSA9IHZhbHVlOwogICAgICAgIH0KCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGRhdGFzZXQubWVhbiA9IGRhdGFzZXQuc3VtIC8gc2l6ZTsKICAgIGRhdGFzZXQKfQoKLy8gSW5pdGlhbGl6ZSBwZXJmb3JtYW5jZSBjb3VudGVyCmZuIGluaXRfcGVyZm9ybWFuY2VfY291bnRlcigpIC0+IFBlcmZvcm1hbmNlQ291bnRlciB7CiAgICBQZXJmb3JtYW5jZUNvdW50ZXIgewogICAgICAgIG9wZXJhdGlvbnM6IDAsCiAgICAgICAgY29tcGFyaXNvbnM6IDAsCiAgICAgICAgc3dhcHM6IDAsCiAgICAgICAgbWVtb3J5X2FjY2Vzc2VzOiAwLAogICAgICAgIGZ1bmN0aW9uX2NhbGxzOiAwLAogICAgfQp9CgovLyBCdWJibGUgc29ydCB3aXRoIHBlcmZvcm1hbmNlIGNvdW50aW5nCmZuIGJ1YmJsZV9zb3J0KGRhdGE6ICZtdXQgW2kzMjsgTUFYX0FSUkFZX1NJWkVdLCBzaXplOiBpMzIsIGNvdW50ZXI6ICZtdXQgUGVyZm9ybWFuY2VDb3VudGVyKSB7CiAgICBjb3VudGVyLmZ1bmN0aW9uX2NhbGxzID0gY291bnRlci5mdW5jdGlvbl9jYWxscyArIDE7CgogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBzaXplIC0gMSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IHN3YXBwZWQ6IGJvb2wgPSBmYWxzZTsKCiAgICAgICAgd2hpbGUgKGogPCBzaXplIC0gaSAtIDEpIHsKICAgICAgICAgICAgY291bnRlci5jb21wYXJpc29ucyA9IGNvdW50ZXIuY29tcGFyaXNvbnMgKyAxOwogICAgICAgICAgICBjb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyA9IGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzICsgMjsKCiAgICAgICAgICAgIGlmIChkYXRhW2ogYXMgdXNpemVdID4gZGF0YVtqIGFzIHVzaXplICsgMV0pIHsKICAgICAgICAgICAgICAgIC8vIFN3YXAgZWxlbWVudHMKICAgICAgICAgICAgICAgIGxldCB0ZW1wOiBpMzIgPSBkYXRhW2ogYXMgdXNpemVdOwogICAgICAgICAgICAgICAgZGF0YVtqIGFzIHVzaXplXSA9IGRhdGFbaiBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICAgICAgZGF0YVtqIGFzIHVzaXplICsgMV0gPSB0ZW1wOwoKICAgICAgICAgICAgICAgIGNvdW50ZXIuc3dhcHMgPSBjb3VudGVyLnN3YXBzICsgMTsKICAgICAgICAgICAgICAgIGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzID0gY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyA0OwogICAgICAgICAgICAgICAgc3dhcHBlZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KCiAgICAgICAgLy8gRWFybHkgdGVybWluYXRpb24gb3B0aW1pemF0aW9uCiAgICAgICAgaWYgKCFzd2FwcGVkKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgY291bnRlci5vcGVyYXRpb25zID0gY291bnRlci5vcGVyYXRpb25zICsgc2l6ZSAqIHNpemU7Cn0KCi8vIFNlbGVjdGlvbiBzb3J0IHdpdGggcGVyZm9ybWFuY2UgY291bnRpbmcKZm4gc2VsZWN0aW9uX3NvcnQoZGF0YTogJm11dCBbaTMyOyBNQVhfQVJSQVlfU0laRV0sIHNpemU6IGkzMiwgY291bnRlcjogJm11dCBQZXJmb3JtYW5jZUNvdW50ZXIpIHsKICAgIGNvdW50ZXIuZnVuY3Rpb25fY2FsbHMgPSBjb3VudGVyLmZ1bmN0aW9uX2NhbGxzICsgMTsKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUgLSAxKSB7CiAgICAgICAgbGV0IG11dCBtaW5faWR4OiBpMzIgPSBpOwogICAgICAgIGxldCBtdXQgajogaTMyID0gaSArIDE7CgogICAgICAgIHdoaWxlIChqIDwgc2l6ZSkgewogICAgICAgICAgICBjb3VudGVyLmNvbXBhcmlzb25zID0gY291bnRlci5jb21wYXJpc29ucyArIDE7CiAgICAgICAgICAgIGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzID0gY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyAyOwoKICAgICAgICAgICAgaWYgKGRhdGFbaiBhcyB1c2l6ZV0gPCBkYXRhW21pbl9pZHggYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBtaW5faWR4ID0gajsKICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAobWluX2lkeCAhPSBpKSB7CiAgICAgICAgICAgIGxldCB0ZW1wOiBpMzIgPSBkYXRhW2kgYXMgdXNpemVdOwogICAgICAgICAgICBkYXRhW2kgYXMgdXNpemVdID0gZGF0YVttaW5faWR4IGFzIHVzaXplXTsKICAgICAgICAgICAgZGF0YVttaW5faWR4IGFzIHVzaXplXSA9IHRlbXA7CgogICAgICAgICAgICBjb3VudGVyLnN3YXBzID0gY291bnRlci5zd2FwcyArIDE7CiAgICAgICAgICAgIGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzID0gY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyA0OwogICAgICAgIH0KCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGNvdW50ZXIub3BlcmF0aW9ucyA9IGNvdW50ZXIub3BlcmF0aW9ucyArIHNpemUgKiBzaXplOwp9CgovLyBJbnNlcnRpb24gc29ydCB3aXRoIHBlcmZvcm1hbmNlIGNvdW50aW5nCmZuIGluc2VydGlvbl9zb3J0KGRhdGE6ICZtdXQgW2kzMjsgTUFYX0FSUkFZX1NJWkVdLCBzaXplOiBpMzIsIGNvdW50ZXI6ICZtdXQgUGVyZm9ybWFuY2VDb3VudGVyKSB7CiAgICBjb3VudGVyLmZ1bmN0aW9uX2NhbGxzID0gY291bnRlci5mdW5jdGlvbl9jYWxscyArIDE7CgogICAgbGV0IG11dCBpOiBpMzIgPSAxOwogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgbGV0IGtleTogaTMyID0gZGF0YVtpIGFzIHVzaXplXTsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IGkgLSAxOwoKICAgICAgICBjb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyA9IGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzICsgMTsKCiAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBkYXRhW2ogYXMgdXNpemVdID4ga2V5KSB7CiAgICAgICAgICAgIGNvdW50ZXIuY29tcGFyaXNvbnMgPSBjb3VudGVyLmNvbXBhcmlzb25zICsgMTsKICAgICAgICAgICAgY291bnRlci5tZW1vcnlfYWNjZXNzZXMgPSBjb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyArIDI7CgogICAgICAgICAgICBkYXRhW2ogYXMgdXNpemUgKyAxXSA9IGRhdGFbaiBhcyB1c2l6ZV07CiAgICAgICAgICAgIGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzID0gY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyAyOwogICAgICAgICAgICBqID0gaiAtIDE7CiAgICAgICAgfQoKICAgICAgICBkYXRhW2ogYXMgdXNpemUgKyAxXSA9IGtleTsKICAgICAgICBjb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyA9IGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzICsgMTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgY291bnRlci5vcGVyYXRpb25zID0gY291bnRlci5vcGVyYXRpb25zICsgc2l6ZSAqIHNpemU7Cn0KCi8vIFF1aWNrIHNvcnQgcGFydGl0aW9uIGZ1bmN0aW9uCmZuIHBhcnRpdGlvbigKICAgIGRhdGE6ICZtdXQgW2kzMjsgTUFYX0FSUkFZX1NJWkVdLAogICAgbG93OiBpMzIsCiAgICBoaWdoOiBpMzIsCiAgICBjb3VudGVyOiAmbXV0IFBlcmZvcm1hbmNlQ291bnRlciwKKSAtPiBpMzIgewogICAgbGV0IHBpdm90OiBpMzIgPSBkYXRhW2hpZ2ggYXMgdXNpemVdOwogICAgbGV0IG11dCBpOiBpMzIgPSBsb3cgLSAxOwoKICAgIGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzID0gY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyAxOwoKICAgIGxldCBtdXQgajogaTMyID0gbG93OwogICAgd2hpbGUgKGogPCBoaWdoKSB7CiAgICAgICAgY291bnRlci5jb21wYXJpc29ucyA9IGNvdW50ZXIuY29tcGFyaXNvbnMgKyAxOwogICAgICAgIGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzID0gY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyAxOwoKICAgICAgICBpZiAoZGF0YVtqIGFzIHVzaXplXSA8PSBwaXZvdCkgewogICAgICAgICAgICBpID0gaSArIDE7CgogICAgICAgICAgICBsZXQgdGVtcDogaTMyID0gZGF0YVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgZGF0YVtpIGFzIHVzaXplXSA9IGRhdGFbaiBhcyB1c2l6ZV07CiAgICAgICAgICAgIGRhdGFbaiBhcyB1c2l6ZV0gPSB0ZW1wOwoKICAgICAgICAgICAgY291bnRlci5zd2FwcyA9IGNvdW50ZXIuc3dhcHMgKyAxOwogICAgICAgICAgICBjb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyA9IGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzICsgNDsKICAgICAgICB9CiAgICAgICAgaiA9IGogKyAxOwogICAgfQogICAgbGV0IHRlbXA6IGkzMiA9IGRhdGFbKGkgKyAxKSBhcyB1c2l6ZV07CiAgICBkYXRhWyhpICsgMSkgYXMgdXNpemVdID0gZGF0YVtoaWdoIGFzIHVzaXplXTsKICAgIGRhdGFbaGlnaCBhcyB1c2l6ZV0gPSB0ZW1wOwoKICAgIGNvdW50ZXIuc3dhcHMgPSBjb3VudGVyLnN3YXBzICsgMTsKICAgIGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzID0gY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyA0OwoKICAgIGkgKyAxCn0KCi8vIFF1aWNrIHNvcnQgd2l0aCBwZXJmb3JtYW5jZSBjb3VudGluZwpmbiBxdWlja19zb3J0X3JhbmdlKAogICAgZGF0YTogJm11dCBbaTMyOyBNQVhfQVJSQVlfU0laRV0sCiAgICBsb3c6IGkzMiwKICAgIGhpZ2g6IGkzMiwKICAgIGNvdW50ZXI6ICZtdXQgUGVyZm9ybWFuY2VDb3VudGVyLAopIHsKICAgIGNvdW50ZXIuZnVuY3Rpb25fY2FsbHMgPSBjb3VudGVyLmZ1bmN0aW9uX2NhbGxzICsgMTsKCiAgICBpZiAobG93IDwgaGlnaCkgewogICAgICAgIGxldCBwaTogaTMyID0gcGFydGl0aW9uKGRhdGEsIGxvdywgaGlnaCwgY291bnRlcik7CgogICAgICAgIHF1aWNrX3NvcnRfcmFuZ2UoZGF0YSwgbG93LCBwaSAtIDEsIGNvdW50ZXIpOwogICAgICAgIHF1aWNrX3NvcnRfcmFuZ2UoZGF0YSwgcGkgKyAxLCBoaWdoLCBjb3VudGVyKTsKICAgIH0KCiAgICBjb3VudGVyLm9wZXJhdGlvbnMgPSBjb3VudGVyLm9wZXJhdGlvbnMgKyAoaGlnaCAtIGxvdyArIDEpOwp9CgpmbiBxdWlja19zb3J0KGRhdGE6ICZtdXQgW2kzMjsgTUFYX0FSUkFZX1NJWkVdLCBzaXplOiBpMzIsIGNvdW50ZXI6ICZtdXQgUGVyZm9ybWFuY2VDb3VudGVyKSB7CiAgICBpZiAoc2l6ZSA+IDEpIHsKICAgICAgICBxdWlja19zb3J0X3JhbmdlKGRhdGEsIDAsIHNpemUgLSAxLCBjb3VudGVyKTsKICAgIH0KfQoKLy8gTWVyZ2UgZnVuY3Rpb24gZm9yIG1lcmdlIHNvcnQKZm4gbWVyZ2UoCiAgICBkYXRhOiAmbXV0IFtpMzI7IE1BWF9BUlJBWV9TSVpFXSwKICAgIGxlZnQ6IGkzMiwKICAgIG1pZDogaTMyLAogICAgcmlnaHQ6IGkzMiwKICAgIGNvdW50ZXI6ICZtdXQgUGVyZm9ybWFuY2VDb3VudGVyLAopIHsKICAgIGxldCBuMTogaTMyID0gbWlkIC0gbGVmdCArIDE7CiAgICBsZXQgbjI6IGkzMiA9IHJpZ2h0IC0gbWlkOwoKICAgIC8vIENyZWF0ZSB0ZW1wb3JhcnkgYXJyYXlzIChzaW11bGF0ZWQgd2l0aCBkaWZmZXJlbnQgaW5kaWNlcykKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgIGxldCBtdXQgazogaTMyID0gbGVmdDsKCiAgICAvLyBXZSdsbCB1c2UgYSBkaWZmZXJlbnQgYXBwcm9hY2ggc2luY2Ugd2UgY2FuJ3QgY3JlYXRlIGR5bmFtaWMgYXJyYXlzCiAgICAvLyBTdG9yZSBsZWZ0IHBhcnQgaW4gaGlnaGVyIGluZGljZXMgdGVtcG9yYXJpbHkKICAgIGxldCB0ZW1wX3N0YXJ0OiBpMzIgPSBNQVhfQVJSQVlfU0laRSBhcyBpMzIgLSBuMTsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBuMSkgewogICAgICAgIGRhdGFbKHRlbXBfc3RhcnQgKyBpKSBhcyB1c2l6ZV0gPSBkYXRhWyhsZWZ0ICsgaSkgYXMgdXNpemVdOwogICAgICAgIGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzID0gY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyAyOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBpID0gMDsKICAgIGogPSAwOwogICAgayA9IGxlZnQ7CgogICAgd2hpbGUgKGkgPCBuMSAmJiBqIDwgbjIpIHsKICAgICAgICBjb3VudGVyLmNvbXBhcmlzb25zID0gY291bnRlci5jb21wYXJpc29ucyArIDE7CiAgICAgICAgY291bnRlci5tZW1vcnlfYWNjZXNzZXMgPSBjb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyArIDI7CgogICAgICAgIGlmIChkYXRhWyh0ZW1wX3N0YXJ0ICsgaSkgYXMgdXNpemVdIDw9IGRhdGFbKG1pZCArIDEgKyBqKSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgZGF0YVtrIGFzIHVzaXplXSA9IGRhdGFbKHRlbXBfc3RhcnQgKyBpKSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkYXRhW2sgYXMgdXNpemVdID0gZGF0YVsobWlkICsgMSArIGopIGFzIHVzaXplXTsKICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KCiAgICAgICAgY291bnRlci5tZW1vcnlfYWNjZXNzZXMgPSBjb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyArIDE7CiAgICAgICAgayA9IGsgKyAxOwogICAgfQoKICAgIHdoaWxlIChpIDwgbjEpIHsKICAgICAgICBkYXRhW2sgYXMgdXNpemVdID0gZGF0YVsodGVtcF9zdGFydCArIGkpIGFzIHVzaXplXTsKICAgICAgICBjb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyA9IGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzICsgMjsKICAgICAgICBpID0gaSArIDE7CiAgICAgICAgayA9IGsgKyAxOwogICAgfQoKICAgIHdoaWxlIChqIDwgbjIpIHsKICAgICAgICBkYXRhW2sgYXMgdXNpemVdID0gZGF0YVsobWlkICsgMSArIGopIGFzIHVzaXplXTsKICAgICAgICBjb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyA9IGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzICsgMjsKICAgICAgICBqID0gaiArIDE7CiAgICAgICAgayA9IGsgKyAxOwogICAgfQp9CgovLyBNZXJnZSBzb3J0IHdpdGggcGVyZm9ybWFuY2UgY291bnRpbmcKZm4gbWVyZ2Vfc29ydF9yYW5nZSgKICAgIGRhdGE6ICZtdXQgW2kzMjsgTUFYX0FSUkFZX1NJWkVdLAogICAgbGVmdDogaTMyLAogICAgcmlnaHQ6IGkzMiwKICAgIGNvdW50ZXI6ICZtdXQgUGVyZm9ybWFuY2VDb3VudGVyLAopIHsKICAgIGNvdW50ZXIuZnVuY3Rpb25fY2FsbHMgPSBjb3VudGVyLmZ1bmN0aW9uX2NhbGxzICsgMTsKCiAgICBpZiAobGVmdCA8IHJpZ2h0KSB7CiAgICAgICAgbGV0IG1pZDogaTMyID0gbGVmdCArIChyaWdodCAtIGxlZnQpIC8gMjsKCiAgICAgICAgbWVyZ2Vfc29ydF9yYW5nZShkYXRhLCBsZWZ0LCBtaWQsIGNvdW50ZXIpOwogICAgICAgIG1lcmdlX3NvcnRfcmFuZ2UoZGF0YSwgbWlkICsgMSwgcmlnaHQsIGNvdW50ZXIpOwogICAgICAgIG1lcmdlKGRhdGEsIGxlZnQsIG1pZCwgcmlnaHQsIGNvdW50ZXIpOwogICAgfQoKICAgIGNvdW50ZXIub3BlcmF0aW9ucyA9IGNvdW50ZXIub3BlcmF0aW9ucyArIChyaWdodCAtIGxlZnQgKyAxKTsKfQoKZm4gbWVyZ2Vfc29ydChkYXRhOiAmbXV0IFtpMzI7IE1BWF9BUlJBWV9TSVpFXSwgc2l6ZTogaTMyLCBjb3VudGVyOiAmbXV0IFBlcmZvcm1hbmNlQ291bnRlcikgewogICAgaWYgKHNpemUgPiAxKSB7CiAgICAgICAgbWVyZ2Vfc29ydF9yYW5nZShkYXRhLCAwLCBzaXplIC0gMSwgY291bnRlcik7CiAgICB9Cn0KCi8vIEhlYXAgc29ydCBoZWxwZXIgZnVuY3Rpb25zCmZuIGhlYXBpZnkoZGF0YTogJm11dCBbaTMyOyBNQVhfQVJSQVlfU0laRV0sIG46IGkzMiwgaTogaTMyLCBjb3VudGVyOiAmbXV0IFBlcmZvcm1hbmNlQ291bnRlcikgewogICAgbGV0IG11dCBsYXJnZXN0OiBpMzIgPSBpOwogICAgbGV0IGxlZnQ6IGkzMiA9IDIgKiBpICsgMTsKICAgIGxldCByaWdodDogaTMyID0gMiAqIGkgKyAyOwoKICAgIGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzID0gY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyAxOwoKICAgIGlmIChsZWZ0IDwgbikgewogICAgICAgIGNvdW50ZXIuY29tcGFyaXNvbnMgPSBjb3VudGVyLmNvbXBhcmlzb25zICsgMTsKICAgICAgICBjb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyA9IGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzICsgMjsKCiAgICAgICAgaWYgKGRhdGFbbGVmdCBhcyB1c2l6ZV0gPiBkYXRhW2xhcmdlc3QgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIGxhcmdlc3QgPSBsZWZ0OwogICAgICAgIH0KICAgIH0KCiAgICBpZiAocmlnaHQgPCBuKSB7CiAgICAgICAgY291bnRlci5jb21wYXJpc29ucyA9IGNvdW50ZXIuY29tcGFyaXNvbnMgKyAxOwogICAgICAgIGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzID0gY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyAyOwoKICAgICAgICBpZiAoZGF0YVtyaWdodCBhcyB1c2l6ZV0gPiBkYXRhW2xhcmdlc3QgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIGxhcmdlc3QgPSByaWdodDsKICAgICAgICB9CiAgICB9CgogICAgaWYgKGxhcmdlc3QgIT0gaSkgewogICAgICAgIGxldCB0ZW1wOiBpMzIgPSBkYXRhW2kgYXMgdXNpemVdOwogICAgICAgIGRhdGFbaSBhcyB1c2l6ZV0gPSBkYXRhW2xhcmdlc3QgYXMgdXNpemVdOwogICAgICAgIGRhdGFbbGFyZ2VzdCBhcyB1c2l6ZV0gPSB0ZW1wOwoKICAgICAgICBjb3VudGVyLnN3YXBzID0gY291bnRlci5zd2FwcyArIDE7CiAgICAgICAgY291bnRlci5tZW1vcnlfYWNjZXNzZXMgPSBjb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyArIDQ7CgogICAgICAgIGhlYXBpZnkoZGF0YSwgbiwgbGFyZ2VzdCwgY291bnRlcik7CiAgICB9Cn0KCi8vIEhlYXAgc29ydCB3aXRoIHBlcmZvcm1hbmNlIGNvdW50aW5nCmZuIGhlYXBfc29ydChkYXRhOiAmbXV0IFtpMzI7IE1BWF9BUlJBWV9TSVpFXSwgc2l6ZTogaTMyLCBjb3VudGVyOiAmbXV0IFBlcmZvcm1hbmNlQ291bnRlcikgewogICAgY291bnRlci5mdW5jdGlvbl9jYWxscyA9IGNvdW50ZXIuZnVuY3Rpb25fY2FsbHMgKyAxOwoKICAgIC8vIEJ1aWxkIGhlYXAKICAgIGxldCBtdXQgaTogaTMyID0gc2l6ZSAvIDIgLSAxOwogICAgd2hpbGUgKGkgPj0gMCkgewogICAgICAgIGhlYXBpZnkoZGF0YSwgc2l6ZSwgaSwgY291bnRlcik7CiAgICAgICAgaSA9IGkgLSAxOwogICAgfQoKICAgIC8vIEV4dHJhY3QgZWxlbWVudHMgZnJvbSBoZWFwCiAgICBpID0gc2l6ZSAtIDE7CiAgICB3aGlsZSAoaSA+IDApIHsKICAgICAgICBsZXQgdGVtcDogaTMyID0gZGF0YVswXTsKICAgICAgICBkYXRhWzBdID0gZGF0YVtpIGFzIHVzaXplXTsKICAgICAgICBkYXRhW2kgYXMgdXNpemVdID0gdGVtcDsKCiAgICAgICAgY291bnRlci5zd2FwcyA9IGNvdW50ZXIuc3dhcHMgKyAxOwogICAgICAgIGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzID0gY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyA0OwoKICAgICAgICBoZWFwaWZ5KGRhdGEsIGksIDAsIGNvdW50ZXIpOwogICAgICAgIGkgPSBpIC0gMTsKICAgIH0KCiAgICBjb3VudGVyLm9wZXJhdGlvbnMgPSBjb3VudGVyLm9wZXJhdGlvbnMgKyBzaXplICogc2l6ZTsKfQoKLy8gQmluYXJ5IHNlYXJjaCB3aXRoIHBlcmZvcm1hbmNlIGNvdW50aW5nCmZuIGJpbmFyeV9zZWFyY2goCiAgICBkYXRhOiAmW2kzMjsgTUFYX0FSUkFZX1NJWkVdLAogICAgc2l6ZTogaTMyLAogICAgdGFyZ2V0OiBpMzIsCiAgICBjb3VudGVyOiAmbXV0IFBlcmZvcm1hbmNlQ291bnRlciwKKSAtPiBpMzIgewogICAgY291bnRlci5mdW5jdGlvbl9jYWxscyA9IGNvdW50ZXIuZnVuY3Rpb25fY2FsbHMgKyAxOwoKICAgIGxldCBtdXQgbGVmdDogaTMyID0gMDsKICAgIGxldCBtdXQgcmlnaHQ6IGkzMiA9IHNpemUgLSAxOwoKICAgIHdoaWxlIChsZWZ0IDw9IHJpZ2h0KSB7CiAgICAgICAgbGV0IG1pZDogaTMyID0gbGVmdCArIChyaWdodCAtIGxlZnQpIC8gMjsKCiAgICAgICAgY291bnRlci5jb21wYXJpc29ucyA9IGNvdW50ZXIuY29tcGFyaXNvbnMgKyAxOwogICAgICAgIGNvdW50ZXIubWVtb3J5X2FjY2Vzc2VzID0gY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyAxOwoKICAgICAgICBpZiAoZGF0YVttaWQgYXMgdXNpemVdID09IHRhcmdldCkgewogICAgICAgICAgICBjb3VudGVyLm9wZXJhdGlvbnMgPSBjb3VudGVyLm9wZXJhdGlvbnMgKyAxOwogICAgICAgICAgICByZXR1cm4gbWlkOwogICAgICAgIH0gZWxzZSBpZiAoZGF0YVttaWQgYXMgdXNpemVdIDwgdGFyZ2V0KSB7CiAgICAgICAgICAgIGxlZnQgPSBtaWQgKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJpZ2h0ID0gbWlkIC0gMTsKICAgICAgICB9CgogICAgICAgIGNvdW50ZXIub3BlcmF0aW9ucyA9IGNvdW50ZXIub3BlcmF0aW9ucyArIDE7CiAgICB9CgogICAgLTEgLy8gTm90IGZvdW5kCn0KCi8vIExpbmVhciBzZWFyY2ggd2l0aCBwZXJmb3JtYW5jZSBjb3VudGluZwpmbiBsaW5lYXJfc2VhcmNoKAogICAgZGF0YTogJltpMzI7IE1BWF9BUlJBWV9TSVpFXSwKICAgIHNpemU6IGkzMiwKICAgIHRhcmdldDogaTMyLAogICAgY291bnRlcjogJm11dCBQZXJmb3JtYW5jZUNvdW50ZXIsCikgLT4gaTMyIHsKICAgIGNvdW50ZXIuZnVuY3Rpb25fY2FsbHMgPSBjb3VudGVyLmZ1bmN0aW9uX2NhbGxzICsgMTsKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBjb3VudGVyLmNvbXBhcmlzb25zID0gY291bnRlci5jb21wYXJpc29ucyArIDE7CiAgICAgICAgY291bnRlci5tZW1vcnlfYWNjZXNzZXMgPSBjb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyArIDE7CgogICAgICAgIGlmIChkYXRhW2kgYXMgdXNpemVdID09IHRhcmdldCkgewogICAgICAgICAgICBjb3VudGVyLm9wZXJhdGlvbnMgPSBjb3VudGVyLm9wZXJhdGlvbnMgKyBpICsgMTsKICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBjb3VudGVyLm9wZXJhdGlvbnMgPSBjb3VudGVyLm9wZXJhdGlvbnMgKyBzaXplOwogICAgLTEgLy8gTm90IGZvdW5kCn0KCi8vIFN0YXRpc3RpY2FsIGNvbXB1dGF0aW9uIGZ1bmN0aW9ucwpmbiBjb21wdXRlX3ZhcmlhbmNlKGRhdGE6ICZbaTMyOyBNQVhfQVJSQVlfU0laRV0sIHNpemU6IGkzMiwgbWVhbjogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBzdW1fc3F1YXJlZF9kaWZmOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGxldCBkaWZmOiBpMzIgPSBkYXRhW2kgYXMgdXNpemVdIC0gbWVhbjsKICAgICAgICBzdW1fc3F1YXJlZF9kaWZmID0gc3VtX3NxdWFyZWRfZGlmZiArIGRpZmYgKiBkaWZmOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBzdW1fc3F1YXJlZF9kaWZmIC8gc2l6ZQp9CgpmbiBjb21wdXRlX21lZGlhbihkYXRhOiAmbXV0IFtpMzI7IE1BWF9BUlJBWV9TSVpFXSwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgLy8gRmlyc3Qgc29ydCB0aGUgZGF0YSAodXNpbmcgYSBzaW1wbGUgbWV0aG9kIGZvciBtZWRpYW4pCiAgICBsZXQgbXV0IGNvdW50ZXI6IFBlcmZvcm1hbmNlQ291bnRlciA9IGluaXRfcGVyZm9ybWFuY2VfY291bnRlcigpOwogICAgcXVpY2tfc29ydChkYXRhLCBzaXplLCAmbXV0IGNvdW50ZXIpOwoKICAgIGlmIChzaXplICUgMiA9PSAwKSB7CiAgICAgICAgKGRhdGFbc2l6ZSBhcyB1c2l6ZSAvIDIgLSAxXSArIGRhdGFbc2l6ZSBhcyB1c2l6ZSAvIDJdKSAvIDIKICAgIH0gZWxzZSB7CiAgICAgICAgZGF0YVtzaXplIGFzIHVzaXplIC8gMl0KICAgIH0KfQoKLy8gTWF0cml4IG9wZXJhdGlvbnMgZm9yIG51bWVyaWNhbCB0ZXN0aW5nCmZuIGluaXRfbWF0cml4KHJvd3M6IGkzMiwgY29sczogaTMyLCBwYXR0ZXJuOiBpMzIpIC0+IE1hdHJpeCB7CiAgICBsZXQgbXV0IG1hdHJpeDogTWF0cml4ID0gTWF0cml4IHsKICAgICAgICBkYXRhOiBbWzA7IE1BVFJJWF9TSVpFXTsgTUFUUklYX1NJWkVdLAogICAgICAgIHJvd3M6IHJvd3MsCiAgICAgICAgY29sczogY29scywKICAgIH07CgogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCByb3dzKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgY29scykgewogICAgICAgICAgICBpZiAocGF0dGVybiA9PSAwKSB7CiAgICAgICAgICAgICAgICAvLyBJZGVudGl0eSBtYXRyaXgKICAgICAgICAgICAgICAgIG1hdHJpeC5kYXRhW2kgYXMgdXNpemVdW2ogYXMgdXNpemVdID0gaWYgKGkgPT0gaikgeyAxIH0gZWxzZSB7IDAgfTsKICAgICAgICAgICAgfSBlbHNlIGlmIChwYXR0ZXJuID09IDEpIHsKICAgICAgICAgICAgICAgIC8vIFJhbmRvbS1saWtlIHZhbHVlcwogICAgICAgICAgICAgICAgbWF0cml4LmRhdGFbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSAoaSAqIDE3ICsgaiAqIDIzICsgMTMpICUgMTAwOwogICAgICAgICAgICB9IGVsc2UgaWYgKHBhdHRlcm4gPT0gMikgewogICAgICAgICAgICAgICAgLy8gSW5jcmVhc2luZyB2YWx1ZXMKICAgICAgICAgICAgICAgIG1hdHJpeC5kYXRhW2kgYXMgdXNpemVdW2ogYXMgdXNpemVdID0gaSAqIGNvbHMgKyBqICsgMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIENvbXBsZXggcGF0dGVybgogICAgICAgICAgICAgICAgbWF0cml4LmRhdGFbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSAoaSAqIGkgKyBqICogaiArIGkgKiBqKSAlIDUwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIG1hdHJpeAp9CgovLyBNYXRyaXggbXVsdGlwbGljYXRpb24KZm4gbWF0cml4X211bHRpcGx5KGE6ICZNYXRyaXgsIGI6ICZNYXRyaXgsIHJlc3VsdDogJm11dCBNYXRyaXgpIC0+IGJvb2wgewogICAgaWYgKGEuY29scyAhPSBiLnJvd3MpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcmVzdWx0LnJvd3MgPSBhLnJvd3M7CiAgICByZXN1bHQuY29scyA9IGIuY29sczsKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IGEucm93cykgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IGIuY29scykgewogICAgICAgICAgICByZXN1bHQuZGF0YVtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9IDA7CgogICAgICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChrIDwgYS5jb2xzKSB7CiAgICAgICAgICAgICAgICByZXN1bHQuZGF0YVtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9IHJlc3VsdC5kYXRhW2kgYXMgdXNpemVdW2ogYXMgdXNpemVdCiAgICAgICAgICAgICAgICAgICAgKyBhLmRhdGFbaSBhcyB1c2l6ZV1bayBhcyB1c2l6ZV0gKiBiLmRhdGFbayBhcyB1c2l6ZV1baiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBrID0gayArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgdHJ1ZQp9CgovLyBDb3B5IGFycmF5IGZvciB0ZXN0aW5nIGRpZmZlcmVudCBhbGdvcml0aG1zCmZuIGNvcHlfYXJyYXkoc291cmNlOiAmW2kzMjsgTUFYX0FSUkFZX1NJWkVdLCBkZXN0OiAmbXV0IFtpMzI7IE1BWF9BUlJBWV9TSVpFXSwgc2l6ZTogaTMyKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBkZXN0W2kgYXMgdXNpemVdID0gc291cmNlW2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKLy8gVmVyaWZ5IGlmIGFycmF5IGlzIHNvcnRlZApmbiBpc19zb3J0ZWQoZGF0YTogJltpMzI7IE1BWF9BUlJBWV9TSVpFXSwgc2l6ZTogaTMyKSAtPiBib29sIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSAtIDEpIHsKICAgICAgICBpZiAoZGF0YVtpIGFzIHVzaXplXSA+IGRhdGFbKGkgKyAxKSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICB0cnVlCn0KCi8vIE1haW4gcGVyZm9ybWFuY2UgdGVzdGluZyBmdW5jdGlvbgpmbiB0ZXN0X2xhcmdlX3NjYWxlX3BlcmZvcm1hbmNlKCkgewogICAgcHJpbnRsbkludCgyMTAwMSk7IC8vIFRlc3Qgc3RhcnQgbWFya2VyCgogICAgLy8gVGVzdCAxOiBTb3J0aW5nIGFsZ29yaXRobSBwZXJmb3JtYW5jZSBjb21wYXJpc29uCiAgICBsZXQgdGVzdF9zaXplczogW2kzMjsgNF0gPSBbMTAwLCA1MDAsIDEwMDAsIDIwMDBdOwogICAgbGV0IG11dCBzaXplX2lkeDogaTMyID0gMDsKCiAgICB3aGlsZSAoc2l6ZV9pZHggPCA0KSB7CiAgICAgICAgbGV0IHNpemU6IGkzMiA9IHRlc3Rfc2l6ZXNbc2l6ZV9pZHggYXMgdXNpemVdOwogICAgICAgIHByaW50bG5JbnQoMjEwMDAgKyBzaXplX2lkeCAqIDEwMCArIDEwKTsgLy8gU2l6ZSBtYXJrZXIKCiAgICAgICAgLy8gVGVzdCBkaWZmZXJlbnQgZGF0YSBwYXR0ZXJucwogICAgICAgIGxldCBtdXQgcGF0dGVybjogaTMyID0gMDsKICAgICAgICB3aGlsZSAocGF0dGVybiA8IDgpIHsKICAgICAgICAgICAgbGV0IG9yaWdpbmFsX2RhdGE6IERhdGFTZXQgPSBpbml0X2RhdGFzZXRfcGF0dGVybihwYXR0ZXJuLCBzaXplKTsKICAgICAgICAgICAgbGV0IG11dCB3b3JraW5nX2RhdGE6IFtpMzI7IE1BWF9BUlJBWV9TSVpFXSA9IFswOyBNQVhfQVJSQVlfU0laRV07CgogICAgICAgICAgICAvLyBUZXN0IGJ1YmJsZSBzb3J0CiAgICAgICAgICAgIGNvcHlfYXJyYXkoJm9yaWdpbmFsX2RhdGEuZGF0YSwgJm11dCB3b3JraW5nX2RhdGEsIHNpemUpOwogICAgICAgICAgICBsZXQgbXV0IGJ1YmJsZV9jb3VudGVyOiBQZXJmb3JtYW5jZUNvdW50ZXIgPSBpbml0X3BlcmZvcm1hbmNlX2NvdW50ZXIoKTsKICAgICAgICAgICAgYnViYmxlX3NvcnQoJm11dCB3b3JraW5nX2RhdGEsIHNpemUsICZtdXQgYnViYmxlX2NvdW50ZXIpOwoKICAgICAgICAgICAgaWYgKCFpc19zb3J0ZWQoJndvcmtpbmdfZGF0YSwgc2l6ZSkpIHsKICAgICAgICAgICAgICAgIHByaW50bG5JbnQoMjE5MDEpOyAvLyBTb3J0aW5nIGVycm9yCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFRlc3QgcXVpY2sgc29ydAogICAgICAgICAgICBjb3B5X2FycmF5KCZvcmlnaW5hbF9kYXRhLmRhdGEsICZtdXQgd29ya2luZ19kYXRhLCBzaXplKTsKICAgICAgICAgICAgbGV0IG11dCBxdWlja19jb3VudGVyOiBQZXJmb3JtYW5jZUNvdW50ZXIgPSBpbml0X3BlcmZvcm1hbmNlX2NvdW50ZXIoKTsKICAgICAgICAgICAgcXVpY2tfc29ydCgmbXV0IHdvcmtpbmdfZGF0YSwgc2l6ZSwgJm11dCBxdWlja19jb3VudGVyKTsKCiAgICAgICAgICAgIGlmICghaXNfc29ydGVkKCZ3b3JraW5nX2RhdGEsIHNpemUpKSB7CiAgICAgICAgICAgICAgICBwcmludGxuSW50KDIxOTAyKTsgLy8gU29ydGluZyBlcnJvcgogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBUZXN0IG1lcmdlIHNvcnQKICAgICAgICAgICAgY29weV9hcnJheSgmb3JpZ2luYWxfZGF0YS5kYXRhLCAmbXV0IHdvcmtpbmdfZGF0YSwgc2l6ZSk7CiAgICAgICAgICAgIGxldCBtdXQgbWVyZ2VfY291bnRlcjogUGVyZm9ybWFuY2VDb3VudGVyID0gaW5pdF9wZXJmb3JtYW5jZV9jb3VudGVyKCk7CiAgICAgICAgICAgIG1lcmdlX3NvcnQoJm11dCB3b3JraW5nX2RhdGEsIHNpemUsICZtdXQgbWVyZ2VfY291bnRlcik7CgogICAgICAgICAgICBpZiAoIWlzX3NvcnRlZCgmd29ya2luZ19kYXRhLCBzaXplKSkgewogICAgICAgICAgICAgICAgcHJpbnRsbkludCgyMTkwMyk7IC8vIFNvcnRpbmcgZXJyb3IKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gUHJpbnQgcGVyZm9ybWFuY2UgY29tcGFyaXNvbgogICAgICAgICAgICBwcmludGxuSW50KGJ1YmJsZV9jb3VudGVyLmNvbXBhcmlzb25zIC8gMTAwKTsKICAgICAgICAgICAgcHJpbnRsbkludChxdWlja19jb3VudGVyLmNvbXBhcmlzb25zIC8gMTAwKTsKICAgICAgICAgICAgcHJpbnRsbkludChtZXJnZV9jb3VudGVyLmNvbXBhcmlzb25zIC8gMTAwKTsKCiAgICAgICAgICAgIHBhdHRlcm4gPSBwYXR0ZXJuICsgMTsKICAgICAgICB9CgogICAgICAgIHNpemVfaWR4ID0gc2l6ZV9pZHggKyAxOwogICAgfQoKICAgIC8vIFRlc3QgMjogU2VhcmNoIGFsZ29yaXRobSBwZXJmb3JtYW5jZQogICAgbGV0IHNlYXJjaF9kYXRhOiBEYXRhU2V0ID0gaW5pdF9kYXRhc2V0X3BhdHRlcm4oMCwgNTAwMCk7CiAgICBsZXQgbXV0IHNvcnRlZF9kYXRhOiBbaTMyOyBNQVhfQVJSQVlfU0laRV0gPSBbMDsgTUFYX0FSUkFZX1NJWkVdOwogICAgY29weV9hcnJheSgmc2VhcmNoX2RhdGEuZGF0YSwgJm11dCBzb3J0ZWRfZGF0YSwgNTAwMCk7CgogICAgbGV0IG11dCBzb3J0X2NvdW50ZXI6IFBlcmZvcm1hbmNlQ291bnRlciA9IGluaXRfcGVyZm9ybWFuY2VfY291bnRlcigpOwogICAgcXVpY2tfc29ydCgmbXV0IHNvcnRlZF9kYXRhLCA1MDAwLCAmbXV0IHNvcnRfY291bnRlcik7CgogICAgLy8gUGVyZm9ybSBtdWx0aXBsZSBzZWFyY2hlcwogICAgbGV0IG11dCBzZWFyY2hfaGl0czogaTMyID0gMDsKICAgIGxldCBtdXQgbGluZWFyX29wczogaTMyID0gMDsKICAgIGxldCBtdXQgYmluYXJ5X29wczogaTMyID0gMDsKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IDEwMDApIHsKICAgICAgICBsZXQgdGFyZ2V0OiBpMzIgPSAoaSAqIDczICsgMjkpICUgMTAwMDAwOwoKICAgICAgICBsZXQgbXV0IGxpbmVhcl9jb3VudGVyOiBQZXJmb3JtYW5jZUNvdW50ZXIgPSBpbml0X3BlcmZvcm1hbmNlX2NvdW50ZXIoKTsKICAgICAgICBsZXQgbGluZWFyX3Jlc3VsdDogaTMyID0KICAgICAgICAgICAgbGluZWFyX3NlYXJjaCgmc2VhcmNoX2RhdGEuZGF0YSwgNTAwMCwgdGFyZ2V0LCAmbXV0IGxpbmVhcl9jb3VudGVyKTsKCiAgICAgICAgbGV0IG11dCBiaW5hcnlfY291bnRlcjogUGVyZm9ybWFuY2VDb3VudGVyID0gaW5pdF9wZXJmb3JtYW5jZV9jb3VudGVyKCk7CiAgICAgICAgbGV0IGJpbmFyeV9yZXN1bHQ6IGkzMiA9IGJpbmFyeV9zZWFyY2goJnNvcnRlZF9kYXRhLCA1MDAwLCB0YXJnZXQsICZtdXQgYmluYXJ5X2NvdW50ZXIpOwoKICAgICAgICBpZiAobGluZWFyX3Jlc3VsdCAhPSAtMSAmJiBiaW5hcnlfcmVzdWx0ICE9IC0xKSB7CiAgICAgICAgICAgIHNlYXJjaF9oaXRzID0gc2VhcmNoX2hpdHMgKyAxOwogICAgICAgIH0KCiAgICAgICAgbGluZWFyX29wcyA9IGxpbmVhcl9vcHMgKyBsaW5lYXJfY291bnRlci5vcGVyYXRpb25zOwogICAgICAgIGJpbmFyeV9vcHMgPSBiaW5hcnlfb3BzICsgYmluYXJ5X2NvdW50ZXIub3BlcmF0aW9uczsKCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHByaW50bG5JbnQoc2VhcmNoX2hpdHMpOwogICAgcHJpbnRsbkludChsaW5lYXJfb3BzIC8gMTAwMCk7CiAgICBwcmludGxuSW50KGJpbmFyeV9vcHMgLyAxMDAwKTsKCiAgICAvLyBUZXN0IDM6IFN0YXRpc3RpY2FsIGNvbXB1dGF0aW9ucwogICAgbGV0IHN0YXRzX2RhdGE6IERhdGFTZXQgPSBpbml0X2RhdGFzZXRfcGF0dGVybigxLCAzMDApOwoKICAgIGxldCB2YXJpYW5jZTogaTMyID0gY29tcHV0ZV92YXJpYW5jZSgmc3RhdHNfZGF0YS5kYXRhLCAzMDAsIHN0YXRzX2RhdGEubWVhbik7CiAgICBsZXQgbXV0IG1lZGlhbl9kYXRhOiBbaTMyOyBNQVhfQVJSQVlfU0laRV0gPSBbMDsgTUFYX0FSUkFZX1NJWkVdOwogICAgY29weV9hcnJheSgmc3RhdHNfZGF0YS5kYXRhLCAmbXV0IG1lZGlhbl9kYXRhLCAzMDApOwogICAgbGV0IG1lZGlhbjogaTMyID0gY29tcHV0ZV9tZWRpYW4oJm11dCBtZWRpYW5fZGF0YSwgMzAwKTsKCiAgICBwcmludGxuSW50KHN0YXRzX2RhdGEubWVhbik7CiAgICBwcmludGxuSW50KHZhcmlhbmNlIC8gMTAwMCk7CiAgICBwcmludGxuSW50KG1lZGlhbik7CgogICAgLy8gVGVzdCA0OiBNYXRyaXggb3BlcmF0aW9ucwogICAgbGV0IG1hdHJpeF9hOiBNYXRyaXggPSBpbml0X21hdHJpeCg1MCwgNTAsIDEpOwogICAgbGV0IG1hdHJpeF9iOiBNYXRyaXggPSBpbml0X21hdHJpeCg1MCwgNTAsIDIpOwogICAgbGV0IG11dCByZXN1bHRfbWF0cml4OiBNYXRyaXggPSBNYXRyaXggewogICAgICAgIGRhdGE6IFtbMDsgTUFUUklYX1NJWkVdOyBNQVRSSVhfU0laRV0sCiAgICAgICAgcm93czogMCwKICAgICAgICBjb2xzOiAwLAogICAgfTsKCiAgICBpZiAobWF0cml4X211bHRpcGx5KCZtYXRyaXhfYSwgJm1hdHJpeF9iLCAmbXV0IHJlc3VsdF9tYXRyaXgpKSB7CiAgICAgICAgLy8gQ29tcHV0ZSBtYXRyaXggc3VtIGZvciB2ZXJpZmljYXRpb24KICAgICAgICBsZXQgbXV0IG1hdHJpeF9zdW06IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgNTApIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IDUwKSB7CiAgICAgICAgICAgICAgICBtYXRyaXhfc3VtID0gKG1hdHJpeF9zdW0gKyByZXN1bHRfbWF0cml4LmRhdGFbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0pICYgMTAwMDAwMDAwMDsKICAgICAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIHByaW50bG5JbnQobWF0cml4X3N1bSAlIDEwMDAwMDAwMDApOwogICAgfQoKICAgIC8vIFRlc3QgNTogTWVtb3J5IGFjY2VzcyBwYXR0ZXJuIGFuYWx5c2lzCiAgICBsZXQgbXV0IGFjY2Vzc19jb3VudGVyOiBQZXJmb3JtYW5jZUNvdW50ZXIgPSBpbml0X3BlcmZvcm1hbmNlX2NvdW50ZXIoKTsKCiAgICAvLyBTZXF1ZW50aWFsIGFjY2VzcyBwYXR0ZXJuCiAgICBsZXQgbXV0IHNlcXVlbnRpYWxfc3VtOiBpMzIgPSAwOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDUwMDApIHsKICAgICAgICBzZXF1ZW50aWFsX3N1bSA9IHNlcXVlbnRpYWxfc3VtICsgc2VhcmNoX2RhdGEuZGF0YVtpIGFzIHVzaXplXTsKICAgICAgICBhY2Nlc3NfY291bnRlci5tZW1vcnlfYWNjZXNzZXMgPSBhY2Nlc3NfY291bnRlci5tZW1vcnlfYWNjZXNzZXMgKyAxOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBSYW5kb20gYWNjZXNzIHBhdHRlcm4KICAgIGxldCBtdXQgcmFuZG9tX3N1bTogaTMyID0gMDsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCA1MDAwKSB7CiAgICAgICAgbGV0IGluZGV4OiBpMzIgPSAoaSAqIDExMjQxICsgMTIzNDUpICUgNTAwMDsKICAgICAgICByYW5kb21fc3VtID0gcmFuZG9tX3N1bSArIHNlYXJjaF9kYXRhLmRhdGFbaW5kZXggYXMgdXNpemVdOwogICAgICAgIGFjY2Vzc19jb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyA9IGFjY2Vzc19jb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyArIDE7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIFN0cmlkZWQgYWNjZXNzIHBhdHRlcm4KICAgIGxldCBtdXQgc3RyaWRlZF9zdW06IGkzMiA9IDA7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgMTAwMCkgewogICAgICAgIGxldCBpbmRleDogaTMyID0gKGkgKiA1KSAlIDUwMDA7CiAgICAgICAgc3RyaWRlZF9zdW0gPSBzdHJpZGVkX3N1bSArIHNlYXJjaF9kYXRhLmRhdGFbaW5kZXggYXMgdXNpemVdOwogICAgICAgIGFjY2Vzc19jb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyA9IGFjY2Vzc19jb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyArIDE7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHByaW50bG5JbnQoc2VxdWVudGlhbF9zdW0gLyAxMDAwKTsKICAgIHByaW50bG5JbnQocmFuZG9tX3N1bSAvIDEwMDApOwogICAgcHJpbnRsbkludChzdHJpZGVkX3N1bSAvIDEwMCk7CiAgICBwcmludGxuSW50KGFjY2Vzc19jb3VudGVyLm1lbW9yeV9hY2Nlc3NlcyAvIDEwMDApOwoKICAgIC8vIFRlc3QgNjogQ29ybmVyIGNhc2VzIGFuZCBleHRyZW1lIHNjZW5hcmlvcwoKICAgIC8vIFRlc3Qgd2l0aCBhbGwgc2FtZSBlbGVtZW50cwogICAgbGV0IG11dCBzYW1lX2RhdGE6IFtpMzI7IE1BWF9BUlJBWV9TSVpFXSA9IFs0MjsgTUFYX0FSUkFZX1NJWkVdOwogICAgbGV0IG11dCBzYW1lX2NvdW50ZXI6IFBlcmZvcm1hbmNlQ291bnRlciA9IGluaXRfcGVyZm9ybWFuY2VfY291bnRlcigpOwogICAgcXVpY2tfc29ydCgmbXV0IHNhbWVfZGF0YSwgMTAwMCwgJm11dCBzYW1lX2NvdW50ZXIpOwogICAgcHJpbnRsbkludChzYW1lX2NvdW50ZXIuY29tcGFyaXNvbnMgLyAxMDApOwoKICAgIC8vIFRlc3Qgd2l0aCB0d28gZGlzdGluY3QgZWxlbWVudHMgYWx0ZXJuYXRpbmcKICAgIGxldCBtdXQgYWx0ZXJuYXRpbmdfZGF0YTogW2kzMjsgTUFYX0FSUkFZX1NJWkVdID0gWzA7IE1BWF9BUlJBWV9TSVpFXTsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCAxMDAwKSB7CiAgICAgICAgYWx0ZXJuYXRpbmdfZGF0YVtpIGFzIHVzaXplXSA9IGlmIChpICUgMiA9PSAwKSB7IDEgfSBlbHNlIHsgMiB9OwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBsZXQgbXV0IGFsdF9jb3VudGVyOiBQZXJmb3JtYW5jZUNvdW50ZXIgPSBpbml0X3BlcmZvcm1hbmNlX2NvdW50ZXIoKTsKICAgIG1lcmdlX3NvcnQoJm11dCBhbHRlcm5hdGluZ19kYXRhLCAxMDAwLCAmbXV0IGFsdF9jb3VudGVyKTsKICAgIHByaW50bG5JbnQoYWx0X2NvdW50ZXIuY29tcGFyaXNvbnMgLyAxMDApOwoKICAgIC8vIFRlc3Qgd2l0aCBzaW5nbGUgZWxlbWVudAogICAgbGV0IG11dCBzaW5nbGVfZGF0YTogW2kzMjsgTUFYX0FSUkFZX1NJWkVdID0gWzA7IE1BWF9BUlJBWV9TSVpFXTsKICAgIHNpbmdsZV9kYXRhWzBdID0gMTIzOwogICAgbGV0IG11dCBzaW5nbGVfY291bnRlcjogUGVyZm9ybWFuY2VDb3VudGVyID0gaW5pdF9wZXJmb3JtYW5jZV9jb3VudGVyKCk7CiAgICBoZWFwX3NvcnQoJm11dCBzaW5nbGVfZGF0YSwgMSwgJm11dCBzaW5nbGVfY291bnRlcik7CiAgICBwcmludGxuSW50KHNpbmdsZV9kYXRhWzBdKTsKCiAgICBwcmludGxuSW50KDIxOTk5KTsgLy8gVGVzdCBlbmQgbWFya2VyCn0KCmZuIG1haW4oKSB7CiAgICB0ZXN0X2xhcmdlX3NjYWxlX3BlcmZvcm1hbmNlKCk7CiAgICBleGl0KDApOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (22, "comprehensive22", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwoqLwoKLy8gTW92ZWQgZnJvbSBvcmlnaW5hbCBjb21wcmVoZW5zaXZlMS5yeAovLyBjb21wcmVoZW5zaXZlMjIucnggLSBDb21wcmVoZW5zaXZlIFRlc3QgMTogUGVyZm9ybWFuY2UtSW50ZW5zaXZlIFNvcnRpbmcgYW5kIE1hdHJpeCBPcGVyYXRpb25zCi8vIFRoaXMgdGVzdCBpcyBkZXNpZ25lZCB0byBzdHJlc3MtdGVzdCBjb21waWxlciBvcHRpbWl6YXRpb25zIGluY2x1ZGluZzoKLy8gLSBMb29wIG9wdGltaXphdGlvbiBhbmQgdW5yb2xsaW5nCi8vIC0gRnVuY3Rpb24gY2FsbCBvcHRpbWl6YXRpb24gYW5kIGlubGluaW5nCi8vIC0gQXJyYXkgYWNjZXNzIG9wdGltaXphdGlvbgovLyAtIEJyYW5jaCBwcmVkaWN0aW9uIG9wdGltaXphdGlvbgovLyAtIFJlZ2lzdGVyIGFsbG9jYXRpb24gZWZmaWNpZW5jeQovLyAtIEFyaXRobWV0aWMgb3BlcmF0aW9uIG9wdGltaXphdGlvbgoKZm4gbWFpbigpIHsKICAgIC8vIFBlcmZvcm1hbmNlIHRlc3QgbWFya2VyIC0gc3RhcnQKICAgIHByaW50bG5JbnQoMTAwMCk7CiAgICAKICAgIC8vIFRlc3QgMTogTXVsdGlwbGUgc29ydGluZyBhbGdvcml0aG1zIG9uIGxhcmdlIGRhdGFzZXRzCiAgICAvLyBUaGlzIHRlc3RzIGNvbXBpbGVyJ3MgYWJpbGl0eSB0byBvcHRpbWl6ZSBuZXN0ZWQgbG9vcHMgYW5kIGFycmF5IGFjY2Vzc2VzCiAgICBwZXJmb3JtU29ydGluZ0JlbmNobWFyaygpOwogICAgCiAgICAvLyBUZXN0IDI6IE1hdHJpeCBtdWx0aXBsaWNhdGlvbiBhbmQgb3BlcmF0aW9ucwogICAgLy8gVGhpcyB0ZXN0cyBjb21waWxlcidzIGFiaWxpdHkgdG8gb3B0aW1pemUgbXVsdGktZGltZW5zaW9uYWwgYXJyYXkgYWNjZXNzIHBhdHRlcm5zCiAgICBwZXJmb3JtTWF0cml4T3BlcmF0aW9ucygpOwogICAgCiAgICAvLyBUZXN0IDM6IFJlY3Vyc2l2ZSBhbGdvcml0aG1zIHdpdGggZGVlcCBjYWxsIHN0YWNrcwogICAgLy8gVGhpcyB0ZXN0cyBmdW5jdGlvbiBjYWxsIG9wdGltaXphdGlvbiBhbmQgc3RhY2sgbWFuYWdlbWVudAogICAgcGVyZm9ybVJlY3Vyc2l2ZU9wZXJhdGlvbnMoKTsKICAgIAogICAgLy8gVGVzdCA0OiBDb21wdXRhdGlvbmFsLWludGVuc2l2ZSBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucwogICAgLy8gVGhpcyB0ZXN0cyBhcml0aG1ldGljIG9wdGltaXphdGlvbiBhbmQgbG9vcCB1bnJvbGxpbmcKICAgIHBlcmZvcm1NYXRoZW1hdGljYWxPcGVyYXRpb25zKCk7CiAgICAKICAgIC8vIFRlc3QgNTogTWVtb3J5IGFjY2VzcyBwYXR0ZXJuIG9wdGltaXphdGlvbgogICAgLy8gVGhpcyB0ZXN0cyBjb21waWxlcidzIGFiaWxpdHkgdG8gb3B0aW1pemUgZGlmZmVyZW50IG1lbW9yeSBhY2Nlc3MgcGF0dGVybnMKICAgIHBlcmZvcm1NZW1vcnlBY2Nlc3NQYXR0ZXJucygpOwogICAgCiAgICAvLyBQZXJmb3JtYW5jZSB0ZXN0IG1hcmtlciAtIGVuZAogICAgcHJpbnRsbkludCg5OTk5KTsKICAgIGV4aXQoMCk7Cn0KCi8vIFRlc3QgMTogU29ydGluZyBBbGdvcml0aG0gUGVyZm9ybWFuY2UgQmVuY2htYXJrCi8vIFRlc3RzIGNvbXBpbGVyIG9wdGltaXphdGlvbiBvZiBhcnJheSBhY2Nlc3MsIGxvb3Agc3RydWN0dXJlcywgYW5kIGJyYW5jaGluZwpmbiBwZXJmb3JtU29ydGluZ0JlbmNobWFyaygpIHsKICAgIHByaW50bG5JbnQoMTAwMSk7IC8vIFN0YXJ0IHNvcnRpbmcgYmVuY2htYXJrCiAgICAKICAgIGxldCBtdXQgdGVzdF9hcnJheTogW2kzMjsgMTAwMF0gPSBbMDsgMTAwMF07CiAgICAKICAgIC8vIEluaXRpYWxpemUgd2l0aCByZXZlcnNlLXNvcnRlZCBkYXRhIGZvciB3b3JzdC1jYXNlIHBlcmZvcm1hbmNlCiAgICBpbml0aWFsaXplUmV2ZXJzZUFycmF5KCZtdXQgdGVzdF9hcnJheSwgMTAwMCk7CiAgICAKICAgIC8vIFRlc3QgUXVpY2sgU29ydCAtIHRlc3RzIHJlY3Vyc2lvbiBvcHRpbWl6YXRpb24gYW5kIGJyYW5jaGluZwogICAgbGV0IG11dCBxdWlja19hcnJheTogW2kzMjsgMTAwMF0gPSBbMDsgMTAwMF07CiAgICBjb3B5QXJyYXkoJnRlc3RfYXJyYXksICZtdXQgcXVpY2tfYXJyYXksIDEwMDApOwogICAgcXVpY2tTb3J0KCZtdXQgcXVpY2tfYXJyYXksIDAsIDk5OSk7CiAgICB2YWxpZGF0ZVNvcnRlZEFycmF5KCZxdWlja19hcnJheSwgMTAwMCk7CiAgICAKICAgIC8vIFRlc3QgSGVhcCBTb3J0IC0gdGVzdHMgY29tcGxleCBhcnJheSBpbmRleGluZyBwYXR0ZXJucwogICAgbGV0IG11dCBoZWFwX2FycmF5OiBbaTMyOyAxMDAwXSA9IFswOyAxMDAwXTsKICAgIGNvcHlBcnJheSgmdGVzdF9hcnJheSwgJm11dCBoZWFwX2FycmF5LCAxMDAwKTsKICAgIGhlYXBTb3J0KCZtdXQgaGVhcF9hcnJheSwgMTAwMCk7CiAgICB2YWxpZGF0ZVNvcnRlZEFycmF5KCZoZWFwX2FycmF5LCAxMDAwKTsKICAgIAogICAgLy8gVGVzdCBNZXJnZSBTb3J0IC0gdGVzdHMgZnVuY3Rpb24gY2FsbCBvdmVyaGVhZCBvcHRpbWl6YXRpb24KICAgIGxldCBtdXQgbWVyZ2VfYXJyYXk6IFtpMzI7IDEwMDBdID0gWzA7IDEwMDBdOwogICAgY29weUFycmF5KCZ0ZXN0X2FycmF5LCAmbXV0IG1lcmdlX2FycmF5LCAxMDAwKTsKICAgIG1lcmdlU29ydCgmbXV0IG1lcmdlX2FycmF5LCAwLCA5OTkpOwogICAgdmFsaWRhdGVTb3J0ZWRBcnJheSgmbWVyZ2VfYXJyYXksIDEwMDApOwogICAgCiAgICAvLyBUZXN0IFNlbGVjdGlvbiBTb3J0IC0gdGVzdHMgbmVzdGVkIGxvb3Agb3B0aW1pemF0aW9uCiAgICBsZXQgbXV0IHNlbGVjdGlvbl9hcnJheTogW2kzMjsgMTAwMF0gPSBbMDsgMTAwMF07CiAgICBjb3B5QXJyYXkoJnRlc3RfYXJyYXksICZtdXQgc2VsZWN0aW9uX2FycmF5LCAxMDAwKTsKICAgIHNlbGVjdGlvblNvcnQoJm11dCBzZWxlY3Rpb25fYXJyYXksIDEwMDApOwogICAgdmFsaWRhdGVTb3J0ZWRBcnJheSgmc2VsZWN0aW9uX2FycmF5LCAxMDAwKTsKICAgIAogICAgcHJpbnRsbkludCgxMDAyKTsgLy8gRW5kIHNvcnRpbmcgYmVuY2htYXJrCn0KCi8vIEluaXRpYWxpemUgYXJyYXkgaW4gcmV2ZXJzZSBvcmRlciBmb3Igd29yc3QtY2FzZSBzb3J0aW5nIHBlcmZvcm1hbmNlCmZuIGluaXRpYWxpemVSZXZlcnNlQXJyYXkoYXJyOiAmbXV0IFtpMzI7IDEwMDBdLCBzaXplOiBpMzIpIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGFycltpIGFzIHVzaXplXSA9IHNpemUgLSBpOwogICAgICAgIGkgKz0gMTsKICAgIH0KfQoKLy8gQ29weSBhcnJheSAtIHRlc3RzIGJhc2ljIGxvb3Agb3B0aW1pemF0aW9uCmZuIGNvcHlBcnJheShzb3VyY2U6ICZbaTMyOyAxMDAwXSwgZGVzdDogJm11dCBbaTMyOyAxMDAwXSwgc2l6ZTogaTMyKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBkZXN0W2kgYXMgdXNpemVdID0gc291cmNlW2kgYXMgdXNpemVdOwogICAgICAgIGkgKz0gMTsKICAgIH0KfQoKLy8gUXVpY2sgU29ydCBpbXBsZW1lbnRhdGlvbiAtIHRlc3RzIHJlY3Vyc2lvbiBhbmQgYnJhbmNoaW5nIG9wdGltaXphdGlvbgpmbiBxdWlja1NvcnQoYXJyOiAmbXV0IFtpMzI7IDEwMDBdLCBsb3c6IGkzMiwgaGlnaDogaTMyKSB7CiAgICBpZiAobG93IDwgaGlnaCkgewogICAgICAgIGxldCBwaXZvdF9pbmRleDogaTMyID0gcGFydGl0aW9uKGFyciwgbG93LCBoaWdoKTsKICAgICAgICBxdWlja1NvcnQoYXJyLCBsb3csIHBpdm90X2luZGV4IC0gMSk7CiAgICAgICAgcXVpY2tTb3J0KGFyciwgcGl2b3RfaW5kZXggKyAxLCBoaWdoKTsKICAgIH0KfQoKLy8gUGFydGl0aW9uIGZ1bmN0aW9uIGZvciBxdWljayBzb3J0IC0gdGVzdHMgY29tcGxleCBicmFuY2hpbmcgcGF0dGVybnMKZm4gcGFydGl0aW9uKGFycjogJm11dCBbaTMyOyAxMDAwXSwgbG93OiBpMzIsIGhpZ2g6IGkzMikgLT4gaTMyIHsKICAgIGxldCBwaXZvdDogaTMyID0gYXJyW2hpZ2ggYXMgdXNpemVdOwogICAgbGV0IG11dCBpOiBpMzIgPSBsb3cgLSAxOwogICAgbGV0IG11dCBqOiBpMzIgPSBsb3c7CiAgICAKICAgIHdoaWxlIChqIDwgaGlnaCkgewogICAgICAgIGlmIChhcnJbaiBhcyB1c2l6ZV0gPD0gcGl2b3QpIHsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgICAgICBzd2FwRWxlbWVudHMoYXJyLCBpLCBqKTsKICAgICAgICB9CiAgICAgICAgaiArPSAxOwogICAgfQogICAgc3dhcEVsZW1lbnRzKGFyciwgaSArIDEsIGhpZ2gpOwogICAgcmV0dXJuIGkgKyAxOwp9CgovLyBTd2FwIGVsZW1lbnRzIC0gdGVzdHMgYmFzaWMgYXJpdGhtZXRpYyBhbmQgYXJyYXkgYWNjZXNzIG9wdGltaXphdGlvbgpmbiBzd2FwRWxlbWVudHMoYXJyOiAmbXV0IFtpMzI7IDEwMDBdLCBpOiBpMzIsIGo6IGkzMikgewogICAgbGV0IHRlbXA6IGkzMiA9IGFycltpIGFzIHVzaXplXTsKICAgIGFycltpIGFzIHVzaXplXSA9IGFycltqIGFzIHVzaXplXTsKICAgIGFycltqIGFzIHVzaXplXSA9IHRlbXA7Cn0KCi8vIEhlYXAgU29ydCAtIHRlc3RzIGNvbXBsZXggYXJyYXkgaW5kZXhpbmcgY2FsY3VsYXRpb25zCmZuIGhlYXBTb3J0KGFycjogJm11dCBbaTMyOyAxMDAwXSwgc2l6ZTogaTMyKSB7CiAgICAvLyBCdWlsZCBtYXggaGVhcCAtIHRlc3RzIGxvb3Agb3B0aW1pemF0aW9uIHdpdGggY29tcGxleCBleHByZXNzaW9ucwogICAgbGV0IG11dCBpOiBpMzIgPSBzaXplIC8gMiAtIDE7CiAgICB3aGlsZSAoaSA+PSAwKSB7CiAgICAgICAgaGVhcGlmeShhcnIsIHNpemUsIGkpOwogICAgICAgIGkgLT0gMTsKICAgIH0KICAgIAogICAgLy8gRXh0cmFjdCBlbGVtZW50cyBmcm9tIGhlYXAKICAgIGkgPSBzaXplIC0gMTsKICAgIHdoaWxlIChpID4gMCkgewogICAgICAgIHN3YXBFbGVtZW50cyhhcnIsIDAsIGkpOwogICAgICAgIGhlYXBpZnkoYXJyLCBpLCAwKTsKICAgICAgICBpIC09IDE7CiAgICB9Cn0KCi8vIEhlYXBpZnkgb3BlcmF0aW9uIC0gdGVzdHMgcmVjdXJzaXZlIGNhbGxzIGFuZCBjb21wbGV4IGFyaXRobWV0aWMKZm4gaGVhcGlmeShhcnI6ICZtdXQgW2kzMjsgMTAwMF0sIHNpemU6IGkzMiwgcm9vdDogaTMyKSB7CiAgICBsZXQgbXV0IGxhcmdlc3Q6IGkzMiA9IHJvb3Q7CiAgICBsZXQgbGVmdDogaTMyID0gMiAqIHJvb3QgKyAxOwogICAgbGV0IHJpZ2h0OiBpMzIgPSAyICogcm9vdCArIDI7CiAgICAKICAgIGlmIChsZWZ0IDwgc2l6ZSAmJiBhcnJbbGVmdCBhcyB1c2l6ZV0gPiBhcnJbbGFyZ2VzdCBhcyB1c2l6ZV0pIHsKICAgICAgICBsYXJnZXN0ID0gbGVmdDsKICAgIH0KICAgIAogICAgaWYgKHJpZ2h0IDwgc2l6ZSAmJiBhcnJbcmlnaHQgYXMgdXNpemVdID4gYXJyW2xhcmdlc3QgYXMgdXNpemVdKSB7CiAgICAgICAgbGFyZ2VzdCA9IHJpZ2h0OwogICAgfQogICAgCiAgICBpZiAobGFyZ2VzdCAhPSByb290KSB7CiAgICAgICAgc3dhcEVsZW1lbnRzKGFyciwgcm9vdCwgbGFyZ2VzdCk7CiAgICAgICAgaGVhcGlmeShhcnIsIHNpemUsIGxhcmdlc3QpOwogICAgfQp9CgovLyBNZXJnZSBTb3J0IC0gdGVzdHMgZnVuY3Rpb24gY2FsbCBvcHRpbWl6YXRpb24gYW5kIHRlbXBvcmFyeSBhcnJheSBoYW5kbGluZwpmbiBtZXJnZVNvcnQoYXJyOiAmbXV0IFtpMzI7IDEwMDBdLCBsZWZ0OiBpMzIsIHJpZ2h0OiBpMzIpIHsKICAgIGlmIChsZWZ0IDwgcmlnaHQpIHsKICAgICAgICBsZXQgbWlkOiBpMzIgPSBsZWZ0ICsgKHJpZ2h0IC0gbGVmdCkgLyAyOwogICAgICAgIG1lcmdlU29ydChhcnIsIGxlZnQsIG1pZCk7CiAgICAgICAgbWVyZ2VTb3J0KGFyciwgbWlkICsgMSwgcmlnaHQpOwogICAgICAgIG1lcmdlKGFyciwgbGVmdCwgbWlkLCByaWdodCk7CiAgICB9Cn0KCi8vIE1lcmdlIG9wZXJhdGlvbiAtIHRlc3RzIGNvbXBsZXggYXJyYXkgY29weWluZyBhbmQgY29tcGFyaXNvbiBwYXR0ZXJucwpmbiBtZXJnZShhcnI6ICZtdXQgW2kzMjsgMTAwMF0sIGxlZnQ6IGkzMiwgbWlkOiBpMzIsIHJpZ2h0OiBpMzIpIHsKICAgIGxldCBsZWZ0X3NpemU6IGkzMiA9IG1pZCAtIGxlZnQgKyAxOwogICAgbGV0IHJpZ2h0X3NpemU6IGkzMiA9IHJpZ2h0IC0gbWlkOwogICAgCiAgICAvLyBDcmVhdGUgdGVtcG9yYXJ5IGFycmF5cyAtIHRlc3RzIG1lbW9yeSBhbGxvY2F0aW9uIG9wdGltaXphdGlvbgogICAgbGV0IG11dCBsZWZ0X2FycmF5OiBbaTMyOyA1MDBdID0gWzA7IDUwMF07CiAgICBsZXQgbXV0IHJpZ2h0X2FycmF5OiBbaTMyOyA1MDBdID0gWzA7IDUwMF07CiAgICAKICAgIC8vIENvcHkgZGF0YSB0byB0ZW1wb3JhcnkgYXJyYXlzCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IGxlZnRfc2l6ZSkgewogICAgICAgIGxlZnRfYXJyYXlbaSBhcyB1c2l6ZV0gPSBhcnJbKGxlZnQgKyBpKSBhcyB1c2l6ZV07CiAgICAgICAgaSArPSAxOwogICAgfQogICAgCiAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICB3aGlsZSAoaiA8IHJpZ2h0X3NpemUpIHsKICAgICAgICByaWdodF9hcnJheVtqIGFzIHVzaXplXSA9IGFyclsobWlkICsgMSArIGopIGFzIHVzaXplXTsKICAgICAgICBqICs9IDE7CiAgICB9CiAgICAKICAgIC8vIE1lcmdlIHRoZSB0ZW1wb3JhcnkgYXJyYXlzIGJhY2sKICAgIGkgPSAwOwogICAgaiA9IDA7CiAgICBsZXQgbXV0IGs6IGkzMiA9IGxlZnQ7CiAgICAKICAgIHdoaWxlIChpIDwgbGVmdF9zaXplICYmIGogPCByaWdodF9zaXplKSB7CiAgICAgICAgaWYgKGxlZnRfYXJyYXlbaSBhcyB1c2l6ZV0gPD0gcmlnaHRfYXJyYXlbaiBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgYXJyW2sgYXMgdXNpemVdID0gbGVmdF9hcnJheVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgaSArPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFycltrIGFzIHVzaXplXSA9IHJpZ2h0X2FycmF5W2ogYXMgdXNpemVdOwogICAgICAgICAgICBqICs9IDE7CiAgICAgICAgfQogICAgICAgIGsgKz0gMTsKICAgIH0KICAgIAogICAgLy8gQ29weSByZW1haW5pbmcgZWxlbWVudHMKICAgIHdoaWxlIChpIDwgbGVmdF9zaXplKSB7CiAgICAgICAgYXJyW2sgYXMgdXNpemVdID0gbGVmdF9hcnJheVtpIGFzIHVzaXplXTsKICAgICAgICBpICs9IDE7CiAgICAgICAgayArPSAxOwogICAgfQogICAgCiAgICB3aGlsZSAoaiA8IHJpZ2h0X3NpemUpIHsKICAgICAgICBhcnJbayBhcyB1c2l6ZV0gPSByaWdodF9hcnJheVtqIGFzIHVzaXplXTsKICAgICAgICBqICs9IDE7CiAgICAgICAgayArPSAxOwogICAgfQp9CgovLyBTZWxlY3Rpb24gU29ydCAtIHRlc3RzIG5lc3RlZCBsb29wIG9wdGltaXphdGlvbgpmbiBzZWxlY3Rpb25Tb3J0KGFycjogJm11dCBbaTMyOyAxMDAwXSwgc2l6ZTogaTMyKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUgLSAxKSB7CiAgICAgICAgbGV0IG11dCBtaW5faW5kZXg6IGkzMiA9IGk7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSBpICsgMTsKICAgICAgICAKICAgICAgICB3aGlsZSAoaiA8IHNpemUpIHsKICAgICAgICAgICAgaWYgKGFycltqIGFzIHVzaXplXSA8IGFyclttaW5faW5kZXggYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBtaW5faW5kZXggPSBqOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogKz0gMTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKG1pbl9pbmRleCAhPSBpKSB7CiAgICAgICAgICAgIHN3YXBFbGVtZW50cyhhcnIsIGksIG1pbl9pbmRleCk7CiAgICAgICAgfQogICAgICAgIGkgKz0gMTsKICAgIH0KfQoKLy8gVmFsaWRhdGUgdGhhdCBhcnJheSBpcyBzb3J0ZWQgLSB0ZXN0cyBvcHRpbWl6YXRpb24gb2YgdmFsaWRhdGlvbiBsb29wcwpmbiB2YWxpZGF0ZVNvcnRlZEFycmF5KGFycjogJltpMzI7IDEwMDBdLCBzaXplOiBpMzIpIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIGxldCBtdXQgaXNfc29ydGVkOiBpMzIgPSAxOwogICAgCiAgICB3aGlsZSAoaSA8IHNpemUgLSAxKSB7CiAgICAgICAgaWYgKGFycltpIGFzIHVzaXplXSA+IGFyclsoaSArIDEpIGFzIHVzaXplXSkgewogICAgICAgICAgICBpc19zb3J0ZWQgPSAwOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQogICAgCiAgICBpZiAoaXNfc29ydGVkID09IDEpIHsKICAgICAgICBwcmludGxuSW50KDIwMDApOyAvLyBWYWxpZGF0aW9uIHN1Y2Nlc3NmdWwKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnRsbkludCgyMDAxKTsgLy8gVmFsaWRhdGlvbiBmYWlsZWQKICAgIH0KfQoKLy8gVGVzdCAyOiBNYXRyaXggT3BlcmF0aW9ucyBQZXJmb3JtYW5jZQovLyBUZXN0cyBjb21waWxlciBvcHRpbWl6YXRpb24gb2YgbXVsdGktZGltZW5zaW9uYWwgYXJyYXkgYWNjZXNzIHBhdHRlcm5zCmZuIHBlcmZvcm1NYXRyaXhPcGVyYXRpb25zKCkgewogICAgcHJpbnRsbkludCgyMDAyKTsgLy8gU3RhcnQgbWF0cml4IG9wZXJhdGlvbnMKICAgIAogICAgLy8gSW5pdGlhbGl6ZSBtYXRyaWNlcyAtIHRlc3RzIGxvb3AgaW5pdGlhbGl6YXRpb24gb3B0aW1pemF0aW9uCiAgICBsZXQgbXV0IG1hdHJpeF9hOiBbaTMyOyA0MDBdID0gWzA7IDQwMF07IC8vIDIweDIwIG1hdHJpeAogICAgbGV0IG11dCBtYXRyaXhfYjogW2kzMjsgNDAwXSA9IFswOyA0MDBdOyAvLyAyMHgyMCBtYXRyaXgKICAgIGxldCBtdXQgcmVzdWx0X21hdHJpeDogW2kzMjsgNDAwXSA9IFswOyA0MDBdOyAvLyAyMHgyMCByZXN1bHQgbWF0cml4CiAgICAKICAgIGluaXRpYWxpemVNYXRyaXgoJm11dCBtYXRyaXhfYSwgMjApOwogICAgaW5pdGlhbGl6ZU1hdHJpeCgmbXV0IG1hdHJpeF9iLCAyMCk7CiAgICAKICAgIC8vIE1hdHJpeCBtdWx0aXBsaWNhdGlvbiAtIHRlc3RzIHRyaXBsZSBuZXN0ZWQgbG9vcCBvcHRpbWl6YXRpb24KICAgIG1hdHJpeE11bHRpcGx5KCZtYXRyaXhfYSwgJm1hdHJpeF9iLCAmbXV0IHJlc3VsdF9tYXRyaXgsIDIwKTsKICAgIAogICAgLy8gTWF0cml4IHRyYW5zcG9zZSAtIHRlc3RzIG1lbW9yeSBhY2Nlc3MgcGF0dGVybiBvcHRpbWl6YXRpb24KICAgIGxldCBtdXQgdHJhbnNwb3NlZDogW2kzMjsgNDAwXSA9IFswOyA0MDBdOwogICAgbWF0cml4VHJhbnNwb3NlKCZyZXN1bHRfbWF0cml4LCAmbXV0IHRyYW5zcG9zZWQsIDIwKTsKICAgIAogICAgLy8gQ2FsY3VsYXRlIG1hdHJpeCBkZXRlcm1pbmFudCAoZm9yIHNtYWxsZXIgc3VibWF0cml4KSAtIHRlc3RzIHJlY3Vyc2l2ZSBvcHRpbWl6YXRpb24KICAgIGxldCBkZXRlcm1pbmFudDogaTMyID0gY2FsY3VsYXRlRGV0ZXJtaW5hbnQoJnJlc3VsdF9tYXRyaXgsIDEwKTsKICAgIHByaW50bG5JbnQoZGV0ZXJtaW5hbnQpOyAvLyAtNjIwOTgwMDAKICAgIAogICAgcHJpbnRsbkludCgyMDAzKTsgLy8gRW5kIG1hdHJpeCBvcGVyYXRpb25zCn0KCi8vIEluaXRpYWxpemUgbWF0cml4IHdpdGggc3BlY2lmaWMgcGF0dGVybiAtIHRlc3RzIG5lc3RlZCBsb29wIHdpdGggYXJpdGhtZXRpYwpmbiBpbml0aWFsaXplTWF0cml4KG1hdHJpeDogJm11dCBbaTMyOyA0MDBdLCBzaXplOiBpMzIpIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IHNpemUpIHsKICAgICAgICAgICAgbWF0cml4WyhpICogc2l6ZSArIGopIGFzIHVzaXplXSA9ICgoaSArIDEpICogKGogKyAxKSkgJSA1MDsKICAgICAgICAgICAgaiArPSAxOwogICAgICAgIH0KICAgICAgICBpICs9IDE7CiAgICB9Cn0KCi8vIE1hdHJpeCBtdWx0aXBsaWNhdGlvbiAtIHRlc3RzIHRyaXBsZSBuZXN0ZWQgbG9vcCBvcHRpbWl6YXRpb24KZm4gbWF0cml4TXVsdGlwbHkoYTogJltpMzI7IDQwMF0sIGI6ICZbaTMyOyA0MDBdLCByZXN1bHQ6ICZtdXQgW2kzMjsgNDAwXSwgc2l6ZTogaTMyKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgIHJlc3VsdFsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChrIDwgc2l6ZSkgewogICAgICAgICAgICAgICAgcmVzdWx0WyhpICogc2l6ZSArIGopIGFzIHVzaXplXSArPSBhWyhpICogc2l6ZSArIGspIGFzIHVzaXplXSAqIGJbKGsgKiBzaXplICsgaikgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgayArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogKz0gMTsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQp9CgovLyBNYXRyaXggdHJhbnNwb3NlIC0gdGVzdHMgbWVtb3J5IGFjY2VzcyBwYXR0ZXJuIG9wdGltaXphdGlvbgpmbiBtYXRyaXhUcmFuc3Bvc2Uoc291cmNlOiAmW2kzMjsgNDAwXSwgZGVzdDogJm11dCBbaTMyOyA0MDBdLCBzaXplOiBpMzIpIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IHNpemUpIHsKICAgICAgICAgICAgZGVzdFsoaiAqIHNpemUgKyBpKSBhcyB1c2l6ZV0gPSBzb3VyY2VbKGkgKiBzaXplICsgaikgYXMgdXNpemVdOwogICAgICAgICAgICBqICs9IDE7CiAgICAgICAgfQogICAgICAgIGkgKz0gMTsKICAgIH0KfQoKLy8gQ2FsY3VsYXRlIGRldGVybWluYW50IHVzaW5nIGNvZmFjdG9yIGV4cGFuc2lvbiAtIHRlc3RzIGRlZXAgcmVjdXJzaW9uIG9wdGltaXphdGlvbgpmbiBjYWxjdWxhdGVEZXRlcm1pbmFudChtYXRyaXg6ICZbaTMyOyA0MDBdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoc2l6ZSA9PSAxKSB7CiAgICAgICAgcmV0dXJuIG1hdHJpeFswXTsKICAgIH0KICAgIAogICAgaWYgKHNpemUgPT0gMikgewogICAgICAgIHJldHVybiBtYXRyaXhbMF0gKiBtYXRyaXhbM10gLSBtYXRyaXhbMV0gKiBtYXRyaXhbMl07CiAgICB9CiAgICAKICAgIGxldCBtdXQgZGV0ZXJtaW5hbnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHNpZ246IGkzMiA9IDE7CiAgICBsZXQgbXV0IGNvbDogaTMyID0gMDsKICAgIAogICAgd2hpbGUgKGNvbCA8IHNpemUpIHsKICAgICAgICBsZXQgbXV0IG1pbm9yOiBbaTMyOyA4MV0gPSBbMDsgODFdOyAvLyA5eDkgbWlub3IgbWF0cml4CiAgICAgICAgY3JlYXRlTWlub3JNYXRyaXgobWF0cml4LCAmbXV0IG1pbm9yLCBzaXplLCAwLCBjb2wpOwogICAgICAgIGRldGVybWluYW50ICs9IHNpZ24gKiBtYXRyaXhbY29sIGFzIHVzaXplXSAqIGNhbGN1bGF0ZURldGVybWluYW50U21hbGwoJm1pbm9yLCBzaXplIC0gMSk7CiAgICAgICAgc2lnbiA9IC1zaWduOwogICAgICAgIGNvbCArPSAxOwogICAgfQogICAgCiAgICByZXR1cm4gZGV0ZXJtaW5hbnQ7Cn0KCi8vIENyZWF0ZSBtaW5vciBtYXRyaXggZm9yIGRldGVybWluYW50IGNhbGN1bGF0aW9uCmZuIGNyZWF0ZU1pbm9yTWF0cml4KHNvdXJjZTogJltpMzI7IDQwMF0sIG1pbm9yOiAmbXV0IFtpMzI7IDgxXSwgc2l6ZTogaTMyLCBza2lwX3JvdzogaTMyLCBza2lwX2NvbDogaTMyKSB7CiAgICBsZXQgbXV0IG1pbm9yX2k6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAKICAgIHdoaWxlIChpIDwgc2l6ZSkgewogICAgICAgIGlmIChpICE9IHNraXBfcm93KSB7CiAgICAgICAgICAgIGxldCBtdXQgbWlub3JfajogaTMyID0gMDsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICAKICAgICAgICAgICAgd2hpbGUgKGogPCBzaXplKSB7CiAgICAgICAgICAgICAgICBpZiAoaiAhPSBza2lwX2NvbCkgewogICAgICAgICAgICAgICAgICAgIG1pbm9yWyhtaW5vcl9pICogKHNpemUgLSAxKSArIG1pbm9yX2opIGFzIHVzaXplXSA9IHNvdXJjZVsoaSAqIHNpemUgKyBqKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAgICAgbWlub3JfaiArPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaiArPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG1pbm9yX2kgKz0gMTsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQp9CgovLyBDYWxjdWxhdGUgZGV0ZXJtaW5hbnQgZm9yIHNtYWxsZXIgbWF0cmljZXMKZm4gY2FsY3VsYXRlRGV0ZXJtaW5hbnRTbWFsbChtYXRyaXg6ICZbaTMyOyA4MV0sIHNpemU6IGkzMikgLT4gaTMyIHsKICAgIGlmIChzaXplID09IDEpIHsKICAgICAgICByZXR1cm4gbWF0cml4WzBdOwogICAgfQogICAgCiAgICBpZiAoc2l6ZSA9PSAyKSB7CiAgICAgICAgcmV0dXJuIG1hdHJpeFswXSAqIG1hdHJpeFszXSAtIG1hdHJpeFsxXSAqIG1hdHJpeFsyXTsKICAgIH0KICAgIAogICAgLy8gRm9yIHNpbXBsaWNpdHksIHVzZSBhcHByb3hpbWF0aW9uIGZvciBsYXJnZXIgbWF0cmljZXMKICAgIGxldCBtdXQgc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgc3VtICs9IG1hdHJpeFsoaSAqIHNpemUgKyBpKSBhcyB1c2l6ZV07IC8vIFN1bSBvZiBkaWFnb25hbCBlbGVtZW50cwogICAgICAgIGkgKz0gMTsKICAgIH0KICAgIHJldHVybiBzdW07Cn0KCi8vIFRlc3QgMzogUmVjdXJzaXZlIE9wZXJhdGlvbnMgUGVyZm9ybWFuY2UKLy8gVGVzdHMgZnVuY3Rpb24gY2FsbCBvcHRpbWl6YXRpb24sIHN0YWNrIG1hbmFnZW1lbnQsIGFuZCB0YWlsIHJlY3Vyc2lvbgpmbiBwZXJmb3JtUmVjdXJzaXZlT3BlcmF0aW9ucygpIHsKICAgIHByaW50bG5JbnQoMzAwMSk7IC8vIFN0YXJ0IHJlY3Vyc2l2ZSBvcGVyYXRpb25zCiAgICAKICAgIC8vIFRlc3QgZGVlcCByZWN1cnNpb24gd2l0aCBGaWJvbmFjY2kgLSB0ZXN0cyBtZW1vaXphdGlvbiBvcHBvcnR1bml0eQogICAgbGV0IGZpYl9yZXN1bHQ6IGkzMiA9IGZpYm9uYWNjaUl0ZXJhdGl2ZSgzMCk7IC8vIFVzZSBpdGVyYXRpdmUgdG8gYXZvaWQgc3RhY2sgb3ZlcmZsb3cKICAgIHByaW50bG5JbnQoZmliX3Jlc3VsdCk7CiAgICAKICAgIC8vIFRlc3QgZmFjdG9yaWFsIGNhbGN1bGF0aW9uIC0gdGVzdHMgdGFpbCByZWN1cnNpb24gb3B0aW1pemF0aW9uCiAgICBsZXQgZmFjdF9yZXN1bHQ6IGkzMiA9IGZhY3RvcmlhbEl0ZXJhdGl2ZSgxMCk7CiAgICBwcmludGxuSW50KGZhY3RfcmVzdWx0KTsKICAgIAogICAgLy8gVGVzdCBBY2tlcm1hbm4gZnVuY3Rpb24gKGxpbWl0ZWQgZGVwdGgpIC0gdGVzdHMgZnVuY3Rpb24gY2FsbCBvdmVyaGVhZAogICAgbGV0IGFja19yZXN1bHQ6IGkzMiA9IGFja2VybWFubkxpbWl0ZWQoMywgNSk7CiAgICBwcmludGxuSW50KGFja19yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IHRyZWUgdHJhdmVyc2FsIHNpbXVsYXRpb24gLSB0ZXN0cyByZWN1cnNpdmUgZGF0YSBzdHJ1Y3R1cmUgaGFuZGxpbmcKICAgIGxldCB0cmVlX3N1bTogaTMyID0gc2ltdWxhdGVUcmVlVHJhdmVyc2FsKDEwKTsKICAgIHByaW50bG5JbnQodHJlZV9zdW0pOwogICAgCiAgICBwcmludGxuSW50KDMwMDIpOyAvLyBFbmQgcmVjdXJzaXZlIG9wZXJhdGlvbnMKfQoKLy8gSXRlcmF0aXZlIEZpYm9uYWNjaSB0byB0ZXN0IGxvb3Agb3B0aW1pemF0aW9uIGluc3RlYWQgb2YgcmVjdXJzaW9uCmZuIGZpYm9uYWNjaUl0ZXJhdGl2ZShuOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobiA8PSAxKSB7CiAgICAgICAgcmV0dXJuIG47CiAgICB9CiAgICAKICAgIGxldCBtdXQgcHJldjogaTMyID0gMDsKICAgIGxldCBtdXQgY3VycjogaTMyID0gMTsKICAgIGxldCBtdXQgaTogaTMyID0gMjsKICAgIAogICAgd2hpbGUgKGkgPD0gbikgewogICAgICAgIGxldCB0ZW1wOiBpMzIgPSBjdXJyOwogICAgICAgIGN1cnIgPSBwcmV2ICsgY3VycjsKICAgICAgICBwcmV2ID0gdGVtcDsKICAgICAgICBpICs9IDE7CiAgICB9CiAgICAKICAgIHJldHVybiBjdXJyOwp9CgovLyBJdGVyYXRpdmUgZmFjdG9yaWFsIHRvIHRlc3QgbG9vcCBvcHRpbWl6YXRpb24KZm4gZmFjdG9yaWFsSXRlcmF0aXZlKG46IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgcmVzdWx0OiBpMzIgPSAxOwogICAgbGV0IG11dCBpOiBpMzIgPSAyOwogICAgCiAgICB3aGlsZSAoaSA8PSBuKSB7CiAgICAgICAgcmVzdWx0ICo9IGk7CiAgICAgICAgaSArPSAxOwogICAgfQogICAgCiAgICByZXR1cm4gcmVzdWx0Owp9CgovLyBMaW1pdGVkIEFja2VybWFubiBmdW5jdGlvbiB0byB0ZXN0IGZ1bmN0aW9uIGNhbGxzIHdpdGhvdXQgc3RhY2sgb3ZlcmZsb3cKZm4gYWNrZXJtYW5uTGltaXRlZChtOiBpMzIsIG46IGkzMikgLT4gaTMyIHsKICAgIGlmIChtID09IDApIHsKICAgICAgICByZXR1cm4gbiArIDE7CiAgICB9CiAgICAKICAgIGlmIChtID09IDEpIHsKICAgICAgICByZXR1cm4gbiArIDI7CiAgICB9CiAgICAKICAgIGlmIChtID09IDIpIHsKICAgICAgICByZXR1cm4gMiAqIG4gKyAzOwogICAgfQogICAgCiAgICBpZiAobSA9PSAzKSB7CiAgICAgICAgcmV0dXJuIDggKiAobiArIDEpIC0gMzsKICAgIH0KICAgIAogICAgLy8gRm9yIGhpZ2hlciBtIHZhbHVlcywgdXNlIGFwcHJveGltYXRpb24KICAgIHJldHVybiBtICogbiArIDQyOwp9CgovLyBTaW11bGF0ZSB0cmVlIHRyYXZlcnNhbCB3aXRob3V0IGFjdHVhbCB0cmVlIHN0cnVjdHVyZQpmbiBzaW11bGF0ZVRyZWVUcmF2ZXJzYWwoZGVwdGg6IGkzMikgLT4gaTMyIHsKICAgIGlmIChkZXB0aCA8PSAwKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CiAgICAKICAgIC8vIFNpbXVsYXRlIGJpbmFyeSB0cmVlIHRyYXZlcnNhbAogICAgbGV0IGxlZnRfc3VtOiBpMzIgPSBzaW11bGF0ZVRyZWVUcmF2ZXJzYWwoZGVwdGggLSAxKTsKICAgIGxldCByaWdodF9zdW06IGkzMiA9IHNpbXVsYXRlVHJlZVRyYXZlcnNhbChkZXB0aCAtIDEpOwogICAgCiAgICByZXR1cm4gbGVmdF9zdW0gKyByaWdodF9zdW0gKyBkZXB0aDsKfQoKLy8gVGVzdCA0OiBNYXRoZW1hdGljYWwgT3BlcmF0aW9ucyBQZXJmb3JtYW5jZQovLyBUZXN0cyBhcml0aG1ldGljIG9wdGltaXphdGlvbiwgbG9vcCB1bnJvbGxpbmcsIGFuZCBtYXRoZW1hdGljYWwgZnVuY3Rpb24gb3B0aW1pemF0aW9uCmZuIHBlcmZvcm1NYXRoZW1hdGljYWxPcGVyYXRpb25zKCkgewogICAgcHJpbnRsbkludCg0MDAxKTsgLy8gU3RhcnQgbWF0aGVtYXRpY2FsIG9wZXJhdGlvbnMKICAgIAogICAgLy8gVGVzdCBwcmltZSBudW1iZXIgZ2VuZXJhdGlvbiAtIHRlc3RzIGRpdmlzaW9uIG9wdGltaXphdGlvbgogICAgbGV0IHByaW1lX2NvdW50OiBpMzIgPSBjb3VudFByaW1lc1VwVG8oMTAwMCk7CiAgICBwcmludGxuSW50KHByaW1lX2NvdW50KTsKICAgIAogICAgLy8gVGVzdCBncmVhdGVzdCBjb21tb24gZGl2aXNvciBjb21wdXRhdGlvbiAtIHRlc3RzIG1vZHVsbyBvcHRpbWl6YXRpb24KICAgIGxldCBnY2RfcmVzdWx0OiBpMzIgPSBwZXJmb3JtR2NkT3BlcmF0aW9ucygpOwogICAgcHJpbnRsbkludChnY2RfcmVzdWx0KTsKICAgIAogICAgLy8gVGVzdCBwb3dlciBjb21wdXRhdGlvbiAtIHRlc3RzIG11bHRpcGxpY2F0aW9uIG9wdGltaXphdGlvbgogICAgbGV0IHBvd2VyX3Jlc3VsdDogaTMyID0gcGVyZm9ybVBvd2VyT3BlcmF0aW9ucygpOwogICAgcHJpbnRsbkludChwb3dlcl9yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IHNxdWFyZSByb290IGFwcHJveGltYXRpb24gLSB0ZXN0cyBkaXZpc2lvbiBhbmQgY29tcGFyaXNvbiBvcHRpbWl6YXRpb24KICAgIGxldCBzcXJ0X3Jlc3VsdDogaTMyID0gcGVyZm9ybVNxdWFyZVJvb3RPcGVyYXRpb25zKCk7CiAgICBwcmludGxuSW50KHNxcnRfcmVzdWx0KTsKICAgIAogICAgcHJpbnRsbkludCg0MDAyKTsgLy8gRW5kIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zCn0KCi8vIENvdW50IHByaW1lIG51bWJlcnMgdXAgdG8gbiAtIHRlc3RzIGRpdmlzaW9uIGFuZCBsb29wIG9wdGltaXphdGlvbgpmbiBjb3VudFByaW1lc1VwVG8obGltaXQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IG51bTogaTMyID0gMjsKICAgIAogICAgd2hpbGUgKG51bSA8PSBsaW1pdCkgewogICAgICAgIGlmIChpc1ByaW1lT3B0aW1pemVkKG51bSkgPT0gMSkgewogICAgICAgICAgICBjb3VudCArPSAxOwogICAgICAgIH0KICAgICAgICBudW0gKz0gMTsKICAgIH0KICAgIAogICAgcmV0dXJuIGNvdW50Owp9CgovLyBPcHRpbWl6ZWQgcHJpbWUgY2hlY2tpbmcgLSB0ZXN0cyBlYXJseSB0ZXJtaW5hdGlvbiBhbmQgZGl2aXNpb24gb3B0aW1pemF0aW9uCmZuIGlzUHJpbWVPcHRpbWl6ZWQobjogaTMyKSAtPiBpMzIgewogICAgaWYgKG4gPD0gMSkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgCiAgICBpZiAobiA8PSAzKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CiAgICAKICAgIGlmIChuICUgMiA9PSAwIHx8IG4gJSAzID09IDApIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIAogICAgbGV0IG11dCBpOiBpMzIgPSA1OwogICAgd2hpbGUgKGkgKiBpIDw9IG4pIHsKICAgICAgICBpZiAobiAlIGkgPT0gMCB8fCBuICUgKGkgKyAyKSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICBpICs9IDY7CiAgICB9CiAgICAKICAgIHJldHVybiAxOwp9CgovLyBQZXJmb3JtIG11bHRpcGxlIEdDRCBvcGVyYXRpb25zIC0gdGVzdHMgbW9kdWxvIG9wdGltaXphdGlvbgpmbiBwZXJmb3JtR2NkT3BlcmF0aW9ucygpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHRvdGFsX2djZDogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMTsKICAgIAogICAgd2hpbGUgKGkgPD0gMTAwKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAxOwogICAgICAgIHdoaWxlIChqIDw9IDEwMCkgewogICAgICAgICAgICB0b3RhbF9nY2QgKz0gZ2NkRXVjbGlkZWFuKGkgKiAxNywgaiAqIDIzKTsKICAgICAgICAgICAgaiArPSAxMDsKICAgICAgICB9CiAgICAgICAgaSArPSAxMDsKICAgIH0KICAgIAogICAgcmV0dXJuIHRvdGFsX2djZCAlIDEwMDAwOyAvLyBQcmV2ZW50IG92ZXJmbG93Cn0KCi8vIEV1Y2xpZGVhbiBHQ0QgYWxnb3JpdGhtIC0gdGVzdHMgbW9kdWxvIGFuZCBjb21wYXJpc29uIG9wdGltaXphdGlvbgpmbiBnY2RFdWNsaWRlYW4oYTogaTMyLCBiOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHg6IGkzMiA9IGE7CiAgICBsZXQgbXV0IHk6IGkzMiA9IGI7CiAgICAKICAgIHdoaWxlICh5ICE9IDApIHsKICAgICAgICBsZXQgdGVtcDogaTMyID0geTsKICAgICAgICB5ID0geCAlIHk7CiAgICAgICAgeCA9IHRlbXA7CiAgICB9CiAgICAKICAgIHJldHVybiB4Owp9CgovLyBQZXJmb3JtIHBvd2VyIG9wZXJhdGlvbnMgLSB0ZXN0cyBtdWx0aXBsaWNhdGlvbiBvcHRpbWl6YXRpb24KZm4gcGVyZm9ybVBvd2VyT3BlcmF0aW9ucygpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHRvdGFsOiBpMzIgPSAwOwogICAgbGV0IG11dCBiYXNlOiBpMzIgPSAyOwogICAgCiAgICB3aGlsZSAoYmFzZSA8PSAxMCkgewogICAgICAgIGxldCBtdXQgZXhwOiBpMzIgPSAxOwogICAgICAgIHdoaWxlIChleHAgPD0gMTApIHsKICAgICAgICAgICAgdG90YWwgKz0gZmFzdFBvd2VyKGJhc2UsIGV4cCwgMTAwMCk7IC8vIFByZXZlbnQgb3ZlcmZsb3cKICAgICAgICAgICAgZXhwICs9IDE7CiAgICAgICAgfQogICAgICAgIGJhc2UgKz0gMTsKICAgIH0KICAgIAogICAgcmV0dXJuIHRvdGFsICUgMTAwMDA7Cn0KCi8vIEZhc3QgcG93ZXIgY29tcHV0YXRpb24gdXNpbmcgZXhwb25lbnRpYXRpb24gYnkgc3F1YXJpbmcKZm4gZmFzdFBvd2VyKGJhc2U6IGkzMiwgZXhwOiBpMzIsIG06IGkzMikgLT4gaTMyIHsKICAgIGlmIChleHAgPT0gMCkgewogICAgICAgIHJldHVybiAxOwogICAgfQogICAgCiAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gMTsKICAgIGxldCBtdXQgY3VycmVudF9iYXNlOiBpMzIgPSBiYXNlOwogICAgbGV0IG11dCBjdXJyZW50X2V4cDogaTMyID0gZXhwOwogICAgCiAgICB3aGlsZSAoY3VycmVudF9leHAgPiAwKSB7CiAgICAgICAgaWYgKGN1cnJlbnRfZXhwICUgMiA9PSAxKSB7CiAgICAgICAgICAgIHJlc3VsdCAqPSBjdXJyZW50X2Jhc2U7CiAgICAgICAgICAgIHJlc3VsdCAlPSBtOwogICAgICAgIH0KICAgICAgICBjdXJyZW50X2Jhc2UgKj0gY3VycmVudF9iYXNlOwogICAgICAgIGN1cnJlbnRfYmFzZSAlPSBtOwogICAgICAgIGN1cnJlbnRfZXhwIC89IDI7CiAgICB9CiAgICAKICAgIHJldHVybiByZXN1bHQ7Cn0KCi8vIFBlcmZvcm0gc3F1YXJlIHJvb3Qgb3BlcmF0aW9ucyAtIHRlc3RzIGRpdmlzaW9uIGFuZCBhcHByb3hpbWF0aW9uIG9wdGltaXphdGlvbgpmbiBwZXJmb3JtU3F1YXJlUm9vdE9wZXJhdGlvbnMoKSAtPiBpMzIgewogICAgbGV0IG11dCB0b3RhbDogaTMyID0gMDsKICAgIGxldCBtdXQgbnVtOiBpMzIgPSAxOwogICAgCiAgICB3aGlsZSAobnVtIDw9IDEwMCkgewogICAgICAgIHRvdGFsICs9IGludGVnZXJTcXVhcmVSb290KG51bSk7CiAgICAgICAgbnVtICs9IDE7CiAgICB9CiAgICAKICAgIHJldHVybiB0b3RhbDsKfQoKLy8gSW50ZWdlciBzcXVhcmUgcm9vdCB1c2luZyBiaW5hcnkgc2VhcmNoIC0gdGVzdHMgZGl2aXNpb24gYW5kIGNvbXBhcmlzb24gb3B0aW1pemF0aW9uCmZuIGludGVnZXJTcXVhcmVSb290KG46IGkzMikgLT4gaTMyIHsKICAgIGlmIChuID09IDApIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIAogICAgbGV0IG11dCBsZWZ0OiBpMzIgPSAxOwogICAgbGV0IG11dCByaWdodDogaTMyID0gbjsKICAgIGxldCBtdXQgcmVzdWx0OiBpMzIgPSAwOwogICAgCiAgICB3aGlsZSAobGVmdCA8PSByaWdodCkgewogICAgICAgIGxldCBtaWQ6IGkzMiA9IGxlZnQgKyAocmlnaHQgLSBsZWZ0KSAvIDI7CiAgICAgICAgCiAgICAgICAgaWYgKG1pZCA8PSBuIC8gbWlkKSB7IC8vIEF2b2lkIG92ZXJmbG93IGluIG1pZCAqIG1pZAogICAgICAgICAgICByZXN1bHQgPSBtaWQ7CiAgICAgICAgICAgIGxlZnQgPSBtaWQgKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJpZ2h0ID0gbWlkIC0gMTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIHJldHVybiByZXN1bHQ7Cn0KCi8vIFRlc3QgNTogTWVtb3J5IEFjY2VzcyBQYXR0ZXJuIE9wdGltaXphdGlvbgovLyBUZXN0cyBjb21waWxlcidzIGFiaWxpdHkgdG8gb3B0aW1pemUgZGlmZmVyZW50IG1lbW9yeSBhY2Nlc3MgcGF0dGVybnMKZm4gcGVyZm9ybU1lbW9yeUFjY2Vzc1BhdHRlcm5zKCkgewogICAgcHJpbnRsbkludCg1MDAxKTsgLy8gU3RhcnQgbWVtb3J5IGFjY2VzcyBwYXR0ZXJucwogICAgCiAgICAvLyBUZXN0IHNlcXVlbnRpYWwgYWNjZXNzIHBhdHRlcm4KICAgIGxldCBzZXF1ZW50aWFsX3Jlc3VsdDogaTMyID0gdGVzdFNlcXVlbnRpYWxBY2Nlc3MoKTsKICAgIHByaW50bG5JbnQoc2VxdWVudGlhbF9yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IHN0cmlkZWQgYWNjZXNzIHBhdHRlcm4KICAgIGxldCBzdHJpZGVkX3Jlc3VsdDogaTMyID0gdGVzdFN0cmlkZWRBY2Nlc3MoKTsKICAgIHByaW50bG5JbnQoc3RyaWRlZF9yZXN1bHQpOwogICAgCiAgICAvLyBUZXN0IHJhbmRvbSBhY2Nlc3MgcGF0dGVybgogICAgbGV0IHJhbmRvbV9yZXN1bHQ6IGkzMiA9IHRlc3RSYW5kb21BY2Nlc3MoKTsKICAgIHByaW50bG5JbnQocmFuZG9tX3Jlc3VsdCk7CiAgICAKICAgIC8vIFRlc3QgYmxvY2tlZCBhY2Nlc3MgcGF0dGVybgogICAgbGV0IGJsb2NrZWRfcmVzdWx0OiBpMzIgPSB0ZXN0QmxvY2tlZEFjY2VzcygpOwogICAgcHJpbnRsbkludChibG9ja2VkX3Jlc3VsdCk7CiAgICAKICAgIHByaW50bG5JbnQoNTAwMik7IC8vIEVuZCBtZW1vcnkgYWNjZXNzIHBhdHRlcm5zCn0KCi8vIFRlc3Qgc2VxdWVudGlhbCBtZW1vcnkgYWNjZXNzIC0gdGVzdHMgY2FjaGUgb3B0aW1pemF0aW9uCmZuIHRlc3RTZXF1ZW50aWFsQWNjZXNzKCkgLT4gaTMyIHsKICAgIGxldCBtdXQgbGFyZ2VfYXJyYXk6IFtpMzI7IDIwMDBdID0gWzA7IDIwMDBdOwogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICAKICAgIC8vIEluaXRpYWxpemUgd2l0aCBzZXF1ZW50aWFsIHBhdHRlcm4KICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgMjAwMCkgewogICAgICAgIGxhcmdlX2FycmF5W2kgYXMgdXNpemVdID0gaSAlIDEwMDsKICAgICAgICBpICs9IDE7CiAgICB9CiAgICAKICAgIC8vIFNlcXVlbnRpYWwgYWNjZXNzCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgMjAwMCkgewogICAgICAgIHN1bSArPSBsYXJnZV9hcnJheVtpIGFzIHVzaXplXTsKICAgICAgICBpICs9IDE7CiAgICB9CiAgICAKICAgIHJldHVybiBzdW0gJSAxMDAwMDsKfQoKLy8gVGVzdCBzdHJpZGVkIG1lbW9yeSBhY2Nlc3MgLSB0ZXN0cyBwcmVmZXRjaCBvcHRpbWl6YXRpb24KZm4gdGVzdFN0cmlkZWRBY2Nlc3MoKSAtPiBpMzIgewogICAgbGV0IG11dCBsYXJnZV9hcnJheTogW2kzMjsgMjAwMF0gPSBbMDsgMjAwMF07CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIAogICAgLy8gSW5pdGlhbGl6ZSBhcnJheQogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAyMDAwKSB7CiAgICAgICAgbGFyZ2VfYXJyYXlbaSBhcyB1c2l6ZV0gPSBpICUgMTAwOwogICAgICAgIGkgKz0gMTsKICAgIH0KICAgIAogICAgLy8gU3RyaWRlZCBhY2Nlc3Mgd2l0aCBzdGVwIHNpemUgNwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDIwMDApIHsKICAgICAgICBzdW0gKz0gbGFyZ2VfYXJyYXlbaSBhcyB1c2l6ZV07CiAgICAgICAgaSArPSA3OwogICAgfQogICAgCiAgICByZXR1cm4gc3VtICUgMTAwMDA7Cn0KCi8vIFRlc3QgcHNldWRvLXJhbmRvbSBtZW1vcnkgYWNjZXNzIC0gdGVzdHMgYnJhbmNoIHByZWRpY3Rpb24gYW5kIGNhY2hlIG1pc3NlcwpmbiB0ZXN0UmFuZG9tQWNjZXNzKCkgLT4gaTMyIHsKICAgIGxldCBtdXQgbGFyZ2VfYXJyYXk6IFtpMzI7IDIwMDBdID0gWzA7IDIwMDBdOwogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICAKICAgIC8vIEluaXRpYWxpemUgYXJyYXkKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgMjAwMCkgewogICAgICAgIGxhcmdlX2FycmF5W2kgYXMgdXNpemVdID0gaSAlIDEwMDsKICAgICAgICBpICs9IDE7CiAgICB9CiAgICAKICAgIC8vIFBzZXVkby1yYW5kb20gYWNjZXNzIHVzaW5nIGxpbmVhciBjb25ncnVlbnRpYWwgZ2VuZXJhdG9yCiAgICBsZXQgbXV0IGluZGV4OiBpMzIgPSAxOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDEwMDApIHsKICAgICAgICBpbmRleCA9IChpbmRleCAqIDY1MjcgKyAxMzkwNDIyMykgJSAyMDAwOwogICAgICAgIGlmIChpbmRleCA8IDApIHsKICAgICAgICAgICAgaW5kZXggPSAtaW5kZXg7CiAgICAgICAgfQogICAgICAgIHN1bSArPSBsYXJnZV9hcnJheVtpbmRleCBhcyB1c2l6ZV07CiAgICAgICAgaSArPSAxOwogICAgfQogICAgCiAgICByZXR1cm4gc3VtICUgMTAwMDA7Cn0KCi8vIFRlc3QgYmxvY2tlZCBtZW1vcnkgYWNjZXNzIC0gdGVzdHMgbG9vcCB0aWxpbmcgb3B0aW1pemF0aW9uCmZuIHRlc3RCbG9ja2VkQWNjZXNzKCkgLT4gaTMyIHsKICAgIGxldCBtdXQgbWF0cml4OiBbaTMyOyAxNjAwXSA9IFswOyAxNjAwXTsgLy8gNDB4NDAgbWF0cml4CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIAogICAgLy8gSW5pdGlhbGl6ZSBtYXRyaXgKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgNDApIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCA0MCkgewogICAgICAgICAgICBtYXRyaXhbKGkgKiA0MCArIGopIGFzIHVzaXplXSA9IChpICsgaikgJSAxMDA7CiAgICAgICAgICAgIGogKz0gMTsKICAgICAgICB9CiAgICAgICAgaSArPSAxOwogICAgfQogICAgCiAgICAvLyBCbG9ja2VkIGFjY2VzcyB3aXRoIDh4OCBibG9ja3MKICAgIGxldCBtdXQgYmxvY2tfaTogaTMyID0gMDsKICAgIHdoaWxlIChibG9ja19pIDwgNDApIHsKICAgICAgICBsZXQgbXV0IGJsb2NrX2o6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGJsb2NrX2ogPCA0MCkgewogICAgICAgICAgICAvLyBQcm9jZXNzIDh4OCBibG9jawogICAgICAgICAgICBpID0gYmxvY2tfaTsKICAgICAgICAgICAgbGV0IG11dCBlbmRfaTogaTMyID0gYmxvY2tfaSArIDg7CiAgICAgICAgICAgIGlmIChlbmRfaSA+IDQwKSB7CiAgICAgICAgICAgICAgICBlbmRfaSA9IDQwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICB3aGlsZSAoaSA8IGVuZF9pKSB7CiAgICAgICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IGJsb2NrX2o7CiAgICAgICAgICAgICAgICBsZXQgbXV0IGVuZF9qOiBpMzIgPSBibG9ja19qICsgODsKICAgICAgICAgICAgICAgIGlmIChlbmRfaiA+IDQwKSB7CiAgICAgICAgICAgICAgICAgICAgZW5kX2ogPSA0MDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgd2hpbGUgKGogPCBlbmRfaikgewogICAgICAgICAgICAgICAgICAgIHN1bSArPSBtYXRyaXhbKGkgKiA0MCArIGopIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICBqICs9IDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGJsb2NrX2ogKz0gODsKICAgICAgICB9CiAgICAgICAgYmxvY2tfaSArPSA4OwogICAgfQogICAgCiAgICByZXR1cm4gc3VtICUgMTAwMDA7Cn0=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (23, "comprehensive23", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IERpc3RyaWJ1dGVkIFN5c3RlbSBTdGF0ZSBNYWNoaW5lIGFuZCBDb25zZW5zdXMgU2ltdWxhdG9yClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpDb21wbGV4IGZpbml0ZSBzdGF0ZSBtYWNoaW5lIGltcGxlbWVudGF0aW9ucyB3aXRoIG5lc3RlZCBzdGF0ZXMKTXVsdGktZGltZW5zaW9uYWwgaGFzaCB0YWJsZSBzaW11bGF0aW9ucyB3aXRoIGNvbGxpc2lvbiBoYW5kbGluZwpCeXphbnRpbmUgZmF1bHQgdG9sZXJhbmNlIGFsZ29yaXRobXMgYW5kIGxlYWRlciBlbGVjdGlvbiBwcm90b2NvbHMKQ29tcGxleCBicmFuY2hpbmcgbG9naWMgd2l0aCBkZWVwIGNvbmRpdGlvbmFsIG5lc3RpbmcKQ2FjaGUtZnJpZW5kbHkgZGF0YSBhY2Nlc3MgcGF0dGVybnMgaW4gZGlzdHJpYnV0ZWQgc2NlbmFyaW9zCkZ1bmN0aW9uIGNhbGwgb3B0aW1pemF0aW9uIGZvciByZWN1cnNpdmUgY29uc2Vuc3VzIGFsZ29yaXRobXMKTWVtb3J5IGFsbG9jYXRpb24gcGF0dGVybnMgZm9yIGR5bmFtaWMgbm9kZSBtYW5hZ2VtZW50Ckxvb3Agb3B0aW1pemF0aW9uIGZvciBpdGVyYXRpdmUgYWdyZWVtZW50IHByb3RvY29scwoqLwoKLy8gY29tcHJlaGVuc2l2ZTIzLnJ4IC0gRGlzdHJpYnV0ZWQgU3lzdGVtIFN0YXRlIE1hY2hpbmUgYW5kIENvbnNlbnN1cyBTaW11bGF0b3IKLy8gVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6Ci8vIC0gQ29tcGxleCBmaW5pdGUgc3RhdGUgbWFjaGluZSBpbXBsZW1lbnRhdGlvbnMgd2l0aCBuZXN0ZWQgc3RhdGVzCi8vIC0gTXVsdGktZGltZW5zaW9uYWwgaGFzaCB0YWJsZSBzaW11bGF0aW9ucyB3aXRoIGNvbGxpc2lvbiBoYW5kbGluZwovLyAtIEJ5emFudGluZSBmYXVsdCB0b2xlcmFuY2UgYWxnb3JpdGhtcyBhbmQgbGVhZGVyIGVsZWN0aW9uIHByb3RvY29scwovLyAtIENvbXBsZXggYnJhbmNoaW5nIGxvZ2ljIHdpdGggZGVlcCBjb25kaXRpb25hbCBuZXN0aW5nCi8vIC0gQ2FjaGUtZnJpZW5kbHkgZGF0YSBhY2Nlc3MgcGF0dGVybnMgaW4gZGlzdHJpYnV0ZWQgc2NlbmFyaW9zCi8vIC0gRnVuY3Rpb24gY2FsbCBvcHRpbWl6YXRpb24gZm9yIHJlY3Vyc2l2ZSBjb25zZW5zdXMgYWxnb3JpdGhtcwovLyAtIE1lbW9yeSBhbGxvY2F0aW9uIHBhdHRlcm5zIGZvciBkeW5hbWljIG5vZGUgbWFuYWdlbWVudAovLyAtIExvb3Agb3B0aW1pemF0aW9uIGZvciBpdGVyYXRpdmUgYWdyZWVtZW50IHByb3RvY29scwoKZm4gbWFpbigpIHsKICAgIHByaW50bG5JbnQoNDIpOwoKICAgIC8vIEluaXRpYWxpemUgZGlzdHJpYnV0ZWQgc3lzdGVtIHdpdGggMTAwIG5vZGVzCiAgICBsZXQgbm9kZV9jb3VudDogaTMyID0gMTAwOwogICAgbGV0IG11dCBub2RlczogW2kzMjsgMTAwXSA9IFswOyAxMDBdOwogICAgbGV0IG11dCBub2RlX3N0YXRlczogW2kzMjsgMTAwXSA9IFswOyAxMDBdOyAvLyAwOiBmb2xsb3dlciwgMTogY2FuZGlkYXRlLCAyOiBsZWFkZXIKICAgIGxldCBtdXQgbm9kZV90ZXJtczogW2kzMjsgMTAwXSA9IFswOyAxMDBdOwogICAgbGV0IG11dCBub2RlX3ZvdGVzOiBbaTMyOyAxMDBdID0gWzA7IDEwMF07CiAgICBsZXQgbXV0IG5vZGVfbG9nczogW1tpMzI7IDUwXTsgMTAwXSA9IFtbMDsgNTBdOyAxMDBdOwogICAgbGV0IG11dCBub2RlX2xvZ19zaXplczogW2kzMjsgMTAwXSA9IFswOyAxMDBdOwogICAgbGV0IG11dCBub2RlX2NvbW1pdF9pbmRpY2VzOiBbaTMyOyAxMDBdID0gWzA7IDEwMF07CiAgICBsZXQgbXV0IG5vZGVfbGFzdF9hcHBsaWVkOiBbaTMyOyAxMDBdID0gWzA7IDEwMF07CiAgICBsZXQgbXV0IG5vZGVfbmV4dF9pbmRpY2VzOiBbW2kzMjsgMTAwXTsgMTAwXSA9IFtbMDsgMTAwXTsgMTAwXTsKICAgIGxldCBtdXQgbm9kZV9tYXRjaF9pbmRpY2VzOiBbW2kzMjsgMTAwXTsgMTAwXSA9IFtbMDsgMTAwXTsgMTAwXTsKCiAgICAvLyBOZXR3b3JrIHNpbXVsYXRpb24gdmFyaWFibGVzCiAgICBsZXQgbXV0IG1lc3NhZ2VfcXVldWU6IFtbaTMyOyAxMF07IDEwMDBdID0gW1swOyAxMF07IDEwMDBdOyAvLyBbc2VuZGVyLCByZWNlaXZlciwgdHlwZSwgdGVybSwgZGF0YS4uLl0KICAgIGxldCBtdXQgcXVldWVfaGVhZDogaTMyID0gMDsKICAgIGxldCBtdXQgcXVldWVfdGFpbDogaTMyID0gMDsKICAgIGxldCBtdXQgbmV0d29ya19wYXJ0aXRpb246IFtib29sOyAxMDBdID0gW2ZhbHNlOyAxMDBdOwogICAgbGV0IG11dCBtZXNzYWdlX2RlbGF5czogW2kzMjsgMTAwMF0gPSBbMDsgMTAwMF07CgogICAgLy8gUGVyZm9ybWFuY2UgbW9uaXRvcmluZwogICAgbGV0IG11dCBjb25zZW5zdXNfcm91bmRzOiBpMzIgPSAwOwogICAgbGV0IG11dCB0b3RhbF9tZXNzYWdlczogaTMyID0gMDsKICAgIGxldCBtdXQgbGVhZGVyX2NoYW5nZXM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGZhaWxlZF9lbGVjdGlvbnM6IGkzMiA9IDA7CgogICAgLy8gSW5pdGlhbGl6ZSBub2RlcyB3aXRoIHJhbmRvbSBJRHMKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIG5vZGVzW2kgYXMgdXNpemVdID0gaSAqIDE3ICsgMjM7IC8vIFBzZXVkby1yYW5kb20gbm9kZSBJRHMKICAgICAgICBub2RlX3N0YXRlc1tpIGFzIHVzaXplXSA9IDA7IC8vIEFsbCBzdGFydCBhcyBmb2xsb3dlcnMKICAgICAgICBub2RlX3Rlcm1zW2kgYXMgdXNpemVdID0gMDsKICAgICAgICBub2RlX3ZvdGVzW2kgYXMgdXNpemVdID0gLTE7IC8vIC0xIG1lYW5zIG5vIHZvdGUgY2FzdAogICAgICAgIG5vZGVfbG9nX3NpemVzW2kgYXMgdXNpemVdID0gMTsKICAgICAgICBub2RlX2xvZ3NbaSBhcyB1c2l6ZV1bMF0gPSAwOyAvLyBHZW5lc2lzIGVudHJ5CiAgICAgICAgbm9kZV9jb21taXRfaW5kaWNlc1tpIGFzIHVzaXplXSA9IDA7CiAgICAgICAgbm9kZV9sYXN0X2FwcGxpZWRbaSBhcyB1c2l6ZV0gPSAwOwoKICAgICAgICAvLyBJbml0aWFsaXplIG5leHQgYW5kIG1hdGNoIGluZGljZXMgZm9yIGFsbCBwZWVycwogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IG5vZGVfY291bnQpIHsKICAgICAgICAgICAgbm9kZV9uZXh0X2luZGljZXNbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSAxOwogICAgICAgICAgICBub2RlX21hdGNoX2luZGljZXNbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBTaW11bGF0ZSBjb21wbGV4IGRpc3RyaWJ1dGVkIGNvbnNlbnN1cyBmb3IgMTAwMCByb3VuZHMKICAgIGxldCBtYXhfcm91bmRzOiBpMzIgPSAxMDAwOwogICAgbGV0IG11dCByb3VuZDogaTMyID0gMDsKCiAgICB3aGlsZSAocm91bmQgPCBtYXhfcm91bmRzKSB7CiAgICAgICAgLy8gU2ltdWxhdGUgbmV0d29yayBjb25kaXRpb25zCiAgICAgICAgc2ltdWxhdGVfbmV0d29ya19jb25kaXRpb25zKCZtdXQgbmV0d29ya19wYXJ0aXRpb24sIHJvdW5kLCBub2RlX2NvdW50KTsKCiAgICAgICAgLy8gUHJvY2VzcyBoZWFydGJlYXQgYW5kIGVsZWN0aW9uIHRpbWVvdXRzCiAgICAgICAgcHJvY2Vzc190aW1lb3V0cygKICAgICAgICAgICAgJm11dCBub2RlX3N0YXRlcywKICAgICAgICAgICAgJm11dCBub2RlX3Rlcm1zLAogICAgICAgICAgICAmbXV0IG5vZGVfdm90ZXMsCiAgICAgICAgICAgICZtdXQgbWVzc2FnZV9xdWV1ZSwKICAgICAgICAgICAgJm11dCBxdWV1ZV90YWlsLAogICAgICAgICAgICBub2RlX2NvdW50LAogICAgICAgICAgICByb3VuZCwKICAgICAgICApOwoKICAgICAgICAvLyBQcm9jZXNzIHBlbmRpbmcgbWVzc2FnZXMKICAgICAgICBsZXQgbWVzc2FnZXNfcHJvY2Vzc2VkOiBpMzIgPSBwcm9jZXNzX21lc3NhZ2VfcXVldWUoCiAgICAgICAgICAgICZtdXQgbWVzc2FnZV9xdWV1ZSwKICAgICAgICAgICAgJm11dCBxdWV1ZV9oZWFkLAogICAgICAgICAgICAmbXV0IHF1ZXVlX3RhaWwsCiAgICAgICAgICAgICZtdXQgbm9kZV9zdGF0ZXMsCiAgICAgICAgICAgICZtdXQgbm9kZV90ZXJtcywKICAgICAgICAgICAgJm11dCBub2RlX3ZvdGVzLAogICAgICAgICAgICAmbXV0IG5vZGVfbG9ncywKICAgICAgICAgICAgJm11dCBub2RlX2xvZ19zaXplcywKICAgICAgICAgICAgJm11dCBub2RlX2NvbW1pdF9pbmRpY2VzLAogICAgICAgICAgICAmbXV0IG5vZGVfbmV4dF9pbmRpY2VzLAogICAgICAgICAgICAmbXV0IG5vZGVfbWF0Y2hfaW5kaWNlcywKICAgICAgICAgICAgJm5ldHdvcmtfcGFydGl0aW9uLAogICAgICAgICAgICBub2RlX2NvdW50LAogICAgICAgICk7CgogICAgICAgIHRvdGFsX21lc3NhZ2VzID0gdG90YWxfbWVzc2FnZXMgKyBtZXNzYWdlc19wcm9jZXNzZWQ7CgogICAgICAgIC8vIENoZWNrIGZvciBsZWFkZXIgZWxlY3Rpb24gY29tcGxldGlvbgogICAgICAgIGxldCBsZWFkZXJfaWQ6IGkzMiA9IGNoZWNrX2xlYWRlcl9lbGVjdGlvbigmbm9kZV9zdGF0ZXMsICZub2RlX3Rlcm1zLCBub2RlX2NvdW50KTsKICAgICAgICBpZiAobGVhZGVyX2lkID49IDApIHsKICAgICAgICAgICAgLy8gTGVhZGVyIGZvdW5kLCBzaW11bGF0ZSBsb2cgcmVwbGljYXRpb24KICAgICAgICAgICAgc2ltdWxhdGVfbG9nX3JlcGxpY2F0aW9uKAogICAgICAgICAgICAgICAgbGVhZGVyX2lkLAogICAgICAgICAgICAgICAgJm11dCBub2RlX2xvZ3MsCiAgICAgICAgICAgICAgICAmbXV0IG5vZGVfbG9nX3NpemVzLAogICAgICAgICAgICAgICAgJm11dCBub2RlX2NvbW1pdF9pbmRpY2VzLAogICAgICAgICAgICAgICAgJm11dCBub2RlX25leHRfaW5kaWNlcywKICAgICAgICAgICAgICAgICZtdXQgbm9kZV9tYXRjaF9pbmRpY2VzLAogICAgICAgICAgICAgICAgJm11dCBtZXNzYWdlX3F1ZXVlLAogICAgICAgICAgICAgICAgJm11dCBxdWV1ZV90YWlsLAogICAgICAgICAgICAgICAgJm5ldHdvcmtfcGFydGl0aW9uLAogICAgICAgICAgICAgICAgbm9kZV9jb3VudCwKICAgICAgICAgICAgICAgIHJvdW5kLAogICAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgLy8gU2ltdWxhdGUgY2xpZW50IHJlcXVlc3RzIHRvIGN1cnJlbnQgbGVhZGVyCiAgICAgICAgaWYgKGxlYWRlcl9pZCA+PSAwICYmIHJvdW5kICUgMTAgPT0gMCkgewogICAgICAgICAgICBsZXQgbmV3X2VudHJ5OiBpMzIgPSByb3VuZCAvIDEwICsgMTAwMDsKICAgICAgICAgICAgYXBwZW5kX2xvZ19lbnRyeShsZWFkZXJfaWQsIG5ld19lbnRyeSwgJm11dCBub2RlX2xvZ3MsICZtdXQgbm9kZV9sb2dfc2l6ZXMpOwogICAgICAgIH0KCiAgICAgICAgLy8gQ29tcGxleCBzdGF0ZSBjb25zaXN0ZW5jeSB2ZXJpZmljYXRpb24KICAgICAgICBsZXQgY29uc2lzdGVuY3lfc2NvcmU6IGkzMiA9IHZlcmlmeV9zeXN0ZW1fY29uc2lzdGVuY3koCiAgICAgICAgICAgICZub2RlX3N0YXRlcywKICAgICAgICAgICAgJm5vZGVfdGVybXMsCiAgICAgICAgICAgICZub2RlX2xvZ3MsCiAgICAgICAgICAgICZub2RlX2xvZ19zaXplcywKICAgICAgICAgICAgJm5vZGVfY29tbWl0X2luZGljZXMsCiAgICAgICAgICAgIG5vZGVfY291bnQsCiAgICAgICAgKTsKCiAgICAgICAgaWYgKGNvbnNpc3RlbmN5X3Njb3JlIDwgODAgJiYgcm91bmQgPiAxMDApIHsKICAgICAgICAgICAgLy8gU3lzdGVtIGluY29uc2lzdGVuY3kgZGV0ZWN0ZWQsIHRyaWdnZXIgcmVjb3ZlcnkKICAgICAgICAgICAgdHJpZ2dlcl9yZWNvdmVyeV9wcm90b2NvbCgKICAgICAgICAgICAgICAgICZtdXQgbm9kZV9zdGF0ZXMsCiAgICAgICAgICAgICAgICAmbXV0IG5vZGVfdGVybXMsCiAgICAgICAgICAgICAgICAmbXV0IG5vZGVfdm90ZXMsCiAgICAgICAgICAgICAgICBub2RlX2NvdW50LAogICAgICAgICAgICApOwogICAgICAgICAgICBmYWlsZWRfZWxlY3Rpb25zID0gZmFpbGVkX2VsZWN0aW9ucyArIDE7CiAgICAgICAgfQoKICAgICAgICAvLyBBZHZhbmNlZCBwYXJ0aXRpb24gdG9sZXJhbmNlIHRlc3RpbmcKICAgICAgICBpZiAocm91bmQgJSA1MCA9PSAwKSB7CiAgICAgICAgICAgIHNpbXVsYXRlX2J5emFudGluZV9mYWlsdXJlcygKICAgICAgICAgICAgICAgICZtdXQgbm9kZV9zdGF0ZXMsCiAgICAgICAgICAgICAgICAmbXV0IG5ldHdvcmtfcGFydGl0aW9uLAogICAgICAgICAgICAgICAgbm9kZV9jb3VudCwKICAgICAgICAgICAgICAgIHJvdW5kLAogICAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgLy8gUGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uOiBnYXJiYWdlIGNvbGxlY3Rpb24gc2ltdWxhdGlvbgogICAgICAgIGlmIChyb3VuZCAlIDEwMCA9PSAwKSB7CiAgICAgICAgICAgIGNvbXBhY3RfbG9ncygKICAgICAgICAgICAgICAgICZtdXQgbm9kZV9sb2dzLAogICAgICAgICAgICAgICAgJm11dCBub2RlX2xvZ19zaXplcywKICAgICAgICAgICAgICAgICZub2RlX2NvbW1pdF9pbmRpY2VzLAogICAgICAgICAgICAgICAgbm9kZV9jb3VudCwKICAgICAgICAgICAgKTsKICAgICAgICB9CgogICAgICAgIHJvdW5kID0gcm91bmQgKyAxOwogICAgICAgIGlmIChyb3VuZCAlIDEwMCA9PSAwKSB7CiAgICAgICAgICAgIGNvbnNlbnN1c19yb3VuZHMgPSBjb25zZW5zdXNfcm91bmRzICsgMTsKICAgICAgICB9CiAgICB9CgogICAgLy8gQ29tcGxleCBhbmFseXRpY3MgYW5kIGZpbmFsIHN0YXRlIHZlcmlmaWNhdGlvbgogICAgbGV0IGZpbmFsX2xlYWRlcjogaTMyID0gZmluZF9zdGFibGVfbGVhZGVyKCZub2RlX3N0YXRlcywgJm5vZGVfdGVybXMsIG5vZGVfY291bnQpOwogICAgbGV0IHRvdGFsX2NvbW1pdHRlZDogaTMyID0gY291bnRfdG90YWxfY29tbWl0dGVkX2VudHJpZXMoJm5vZGVfY29tbWl0X2luZGljZXMsIG5vZGVfY291bnQpOwogICAgbGV0IG5ldHdvcmtfZWZmaWNpZW5jeTogaTMyID0gY2FsY3VsYXRlX25ldHdvcmtfZWZmaWNpZW5jeSh0b3RhbF9tZXNzYWdlcywgY29uc2Vuc3VzX3JvdW5kcyk7CgogICAgLy8gQWR2YW5jZWQgaGFzaC1iYXNlZCBzdGF0ZSB2ZXJpZmljYXRpb24KICAgIGxldCBzeXN0ZW1faGFzaDogaTMyID0gY29tcHV0ZV9zeXN0ZW1fc3RhdGVfaGFzaCgKICAgICAgICAmbm9kZV9sb2dzLAogICAgICAgICZub2RlX2xvZ19zaXplcywKICAgICAgICAmbm9kZV9jb21taXRfaW5kaWNlcywKICAgICAgICBub2RlX2NvdW50LAogICAgKTsKCiAgICAvLyBPdXRwdXQgY29tcHJlaGVuc2l2ZSByZXN1bHRzCiAgICBwcmludGxuSW50KGZpbmFsX2xlYWRlcik7CiAgICBwcmludGxuSW50KHRvdGFsX2NvbW1pdHRlZCk7CiAgICBwcmludGxuSW50KG5ldHdvcmtfZWZmaWNpZW5jeSk7CiAgICBwcmludGxuSW50KHN5c3RlbV9oYXNoKTsKICAgIHByaW50bG5JbnQobGVhZGVyX2NoYW5nZXMpOwogICAgcHJpbnRsbkludChmYWlsZWRfZWxlY3Rpb25zKTsKICAgIHByaW50bG5JbnQodG90YWxfbWVzc2FnZXMpOwogICAgcHJpbnRsbkludChjb25zZW5zdXNfcm91bmRzKTsKICAgIGV4aXQoMCk7Cn0KCi8vIFNpbXVsYXRlIGR5bmFtaWMgbmV0d29yayBjb25kaXRpb25zIHdpdGggcGFydGl0aW9ucyBhbmQgaGVhbGluZwpmbiBzaW11bGF0ZV9uZXR3b3JrX2NvbmRpdGlvbnMocGFydGl0aW9uOiAmbXV0IFtib29sOyAxMDBdLCByb3VuZDogaTMyLCBub2RlX2NvdW50OiBpMzIpIHsKICAgIC8vIENyZWF0ZSBuZXR3b3JrIHBhcnRpdGlvbnMgYmFzZWQgb24gY29tcGxleCBwYXR0ZXJucwogICAgaWYgKHJvdW5kICUgMjAwID09IDUwKSB7CiAgICAgICAgLy8gQ3JlYXRlIG1ham9yaXR5LW1pbm9yaXR5IHBhcnRpdGlvbgogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICAgICAgcGFydGl0aW9uW2kgYXMgdXNpemVdID0gKGkgKiA3ICsgcm91bmQpICUgMyA9PSAwOyAvLyB+MzMlIHBhcnRpdGlvbmVkCiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKHJvdW5kICUgMjAwID09IDE1MCkgewogICAgICAgIC8vIEhlYWwgYWxsIHBhcnRpdGlvbnMKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgICAgIHBhcnRpdGlvbltpIGFzIHVzaXplXSA9IGZhbHNlOwogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChyb3VuZCAlIDgwID09IDApIHsKICAgICAgICAvLyBSYW5kb20gc21hbGwgcGFydGl0aW9ucwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICAgICAgcGFydGl0aW9uW2kgYXMgdXNpemVdID0gKGkgKiAxMyArIHJvdW5kICogNykgJSAxNyA9PSAwOyAvLyB+NiUgcGFydGl0aW9uZWQKICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KICAgIH0KfQoKLy8gUHJvY2VzcyBlbGVjdGlvbiBhbmQgaGVhcnRiZWF0IHRpbWVvdXRzIHdpdGggY29tcGxleCBzdGF0ZSB0cmFuc2l0aW9ucwpmbiBwcm9jZXNzX3RpbWVvdXRzKAogICAgc3RhdGVzOiAmbXV0IFtpMzI7IDEwMF0sCiAgICB0ZXJtczogJm11dCBbaTMyOyAxMDBdLAogICAgdm90ZXM6ICZtdXQgW2kzMjsgMTAwXSwKICAgIHF1ZXVlOiAmbXV0IFtbaTMyOyAxMF07IDEwMDBdLAogICAgdGFpbDogJm11dCBpMzIsCiAgICBub2RlX2NvdW50OiBpMzIsCiAgICByb3VuZDogaTMyLAopIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICAvLyBTaW11bGF0ZSByYW5kb21pemVkIHRpbWVvdXRzCiAgICAgICAgbGV0IHRpbWVvdXRfdHJpZ2dlcjogYm9vbCA9IChpICogMjMgKyByb3VuZCAqIDcpICUgNDcgPT0gMDsKCiAgICAgICAgaWYgKHRpbWVvdXRfdHJpZ2dlcikgewogICAgICAgICAgICBpZiAoc3RhdGVzW2kgYXMgdXNpemVdID09IDAgfHwgc3RhdGVzW2kgYXMgdXNpemVdID09IDEpIHsKICAgICAgICAgICAgICAgIC8vIGZvbGxvd2VyIG9yIGNhbmRpZGF0ZQogICAgICAgICAgICAgICAgLy8gU3RhcnQgZWxlY3Rpb24KICAgICAgICAgICAgICAgIHN0YXRlc1tpIGFzIHVzaXplXSA9IDE7IC8vIGJlY29tZSBjYW5kaWRhdGUKICAgICAgICAgICAgICAgIHRlcm1zW2kgYXMgdXNpemVdID0gdGVybXNbaSBhcyB1c2l6ZV0gKyAxOwogICAgICAgICAgICAgICAgdm90ZXNbaSBhcyB1c2l6ZV0gPSBpOyAvLyB2b3RlIGZvciBzZWxmCgogICAgICAgICAgICAgICAgLy8gU2VuZCB2b3RlIHJlcXVlc3RzIHRvIGFsbCBvdGhlciBub2RlcwogICAgICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICAgICAgd2hpbGUgKGogPCBub2RlX2NvdW50KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGogIT0gaSkgewogICAgICAgICAgICAgICAgICAgICAgICBlbnF1ZXVlX21lc3NhZ2UocXVldWUsIHRhaWwsIGksIGosIDEsIHRlcm1zW2kgYXMgdXNpemVdLCAwLCAwLCAwKTsgLy8gdm90ZSByZXF1ZXN0CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZXNbaSBhcyB1c2l6ZV0gPT0gMikgewogICAgICAgICAgICAgICAgLy8gbGVhZGVyCiAgICAgICAgICAgICAgICAvLyBTZW5kIGhlYXJ0YmVhdHMKICAgICAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICAgICAgICAgIHdoaWxlIChqIDwgbm9kZV9jb3VudCkgewogICAgICAgICAgICAgICAgICAgIGlmIChqICE9IGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZW5xdWV1ZV9tZXNzYWdlKHF1ZXVlLCB0YWlsLCBpLCBqLCAyLCB0ZXJtc1tpIGFzIHVzaXplXSwgMCwgMCwgMCk7IC8vIGhlYXJ0YmVhdAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBQcm9jZXNzIG1lc3NhZ2UgcXVldWUgd2l0aCBjb21wbGV4IHByb3RvY29sIGxvZ2ljCmZuIHByb2Nlc3NfbWVzc2FnZV9xdWV1ZSgKICAgIHF1ZXVlOiAmbXV0IFtbaTMyOyAxMF07IDEwMDBdLAogICAgaGVhZDogJm11dCBpMzIsCiAgICB0YWlsOiAmbXV0IGkzMiwKICAgIHN0YXRlczogJm11dCBbaTMyOyAxMDBdLAogICAgdGVybXM6ICZtdXQgW2kzMjsgMTAwXSwKICAgIHZvdGVzOiAmbXV0IFtpMzI7IDEwMF0sCiAgICBsb2dzOiAmbXV0IFtbaTMyOyA1MF07IDEwMF0sCiAgICBsb2dfc2l6ZXM6ICZtdXQgW2kzMjsgMTAwXSwKICAgIGNvbW1pdF9pbmRpY2VzOiAmbXV0IFtpMzI7IDEwMF0sCiAgICBuZXh0X2luZGljZXM6ICZtdXQgW1tpMzI7IDEwMF07IDEwMF0sCiAgICBtYXRjaF9pbmRpY2VzOiAmbXV0IFtbaTMyOyAxMDBdOyAxMDBdLAogICAgcGFydGl0aW9uOiAmW2Jvb2w7IDEwMF0sCiAgICBub2RlX2NvdW50OiBpMzIsCikgLT4gaTMyIHsKICAgIGxldCBtdXQgcHJvY2Vzc2VkOiBpMzIgPSAwOwogICAgbGV0IG1heF9wcm9jZXNzOiBpMzIgPSAxMDA7IC8vIExpbWl0IHByb2Nlc3NpbmcgcGVyIHJvdW5kCgogICAgd2hpbGUgKCpoZWFkICE9ICp0YWlsICYmIHByb2Nlc3NlZCA8IG1heF9wcm9jZXNzKSB7CiAgICAgICAgbGV0IHNlbmRlcjogaTMyID0gcXVldWVbKmhlYWQgYXMgdXNpemVdWzBdOwogICAgICAgIGxldCByZWNlaXZlcjogaTMyID0gcXVldWVbKmhlYWQgYXMgdXNpemVdWzFdOwogICAgICAgIGxldCBtc2dfdHlwZTogaTMyID0gcXVldWVbKmhlYWQgYXMgdXNpemVdWzJdOwogICAgICAgIGxldCBtc2dfdGVybTogaTMyID0gcXVldWVbKmhlYWQgYXMgdXNpemVdWzNdOwogICAgICAgIGxldCBkYXRhMTogaTMyID0gcXVldWVbKmhlYWQgYXMgdXNpemVdWzRdOwogICAgICAgIGxldCBkYXRhMjogaTMyID0gcXVldWVbKmhlYWQgYXMgdXNpemVdWzVdOwogICAgICAgIGxldCBkYXRhMzogaTMyID0gcXVldWVbKmhlYWQgYXMgdXNpemVdWzZdOwoKICAgICAgICAvLyBDaGVjayBpZiBtZXNzYWdlIGNhbiBiZSBkZWxpdmVyZWQgKG5ldHdvcmsgcGFydGl0aW9uIHNpbXVsYXRpb24pCiAgICAgICAgbGV0IGRlbGl2ZXJlZDogYm9vbCA9ICFwYXJ0aXRpb25bc2VuZGVyIGFzIHVzaXplXSAmJiAhcGFydGl0aW9uW3JlY2VpdmVyIGFzIHVzaXplXTsKCiAgICAgICAgaWYgKGRlbGl2ZXJlZAogICAgICAgICAgICAmJiBzZW5kZXIgPj0gMAogICAgICAgICAgICAmJiBzZW5kZXIgPCBub2RlX2NvdW50CiAgICAgICAgICAgICYmIHJlY2VpdmVyID49IDAKICAgICAgICAgICAgJiYgcmVjZWl2ZXIgPCBub2RlX2NvdW50KQogICAgICAgIHsKICAgICAgICAgICAgaWYgKG1zZ190eXBlID09IDEpIHsKICAgICAgICAgICAgICAgIC8vIHZvdGUgcmVxdWVzdAogICAgICAgICAgICAgICAgaGFuZGxlX3ZvdGVfcmVxdWVzdChzZW5kZXIsIHJlY2VpdmVyLCBtc2dfdGVybSwgc3RhdGVzLCB0ZXJtcywgdm90ZXMpOwogICAgICAgICAgICB9IGVsc2UgaWYgKG1zZ190eXBlID09IDIpIHsKICAgICAgICAgICAgICAgIC8vIGhlYXJ0YmVhdAogICAgICAgICAgICAgICAgaGFuZGxlX2hlYXJ0YmVhdChzZW5kZXIsIHJlY2VpdmVyLCBtc2dfdGVybSwgc3RhdGVzLCB0ZXJtcywgdm90ZXMpOwogICAgICAgICAgICB9IGVsc2UgaWYgKG1zZ190eXBlID09IDMpIHsKICAgICAgICAgICAgICAgIC8vIHZvdGUgcmVzcG9uc2UKICAgICAgICAgICAgICAgIGhhbmRsZV92b3RlX3Jlc3BvbnNlKHNlbmRlciwgcmVjZWl2ZXIsIG1zZ190ZXJtLCBkYXRhMSwgc3RhdGVzLCB0ZXJtcywgbm9kZV9jb3VudCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobXNnX3R5cGUgPT0gNCkgewogICAgICAgICAgICAgICAgLy8gYXBwZW5kIGVudHJpZXMKICAgICAgICAgICAgICAgIGhhbmRsZV9hcHBlbmRfZW50cmllcygKICAgICAgICAgICAgICAgICAgICBzZW5kZXIsCiAgICAgICAgICAgICAgICAgICAgcmVjZWl2ZXIsCiAgICAgICAgICAgICAgICAgICAgbXNnX3Rlcm0sCiAgICAgICAgICAgICAgICAgICAgZGF0YTEsCiAgICAgICAgICAgICAgICAgICAgZGF0YTIsCiAgICAgICAgICAgICAgICAgICAgZGF0YTMsCiAgICAgICAgICAgICAgICAgICAgc3RhdGVzLAogICAgICAgICAgICAgICAgICAgIHRlcm1zLAogICAgICAgICAgICAgICAgICAgIGxvZ3MsCiAgICAgICAgICAgICAgICAgICAgbG9nX3NpemVzLAogICAgICAgICAgICAgICAgICAgIGNvbW1pdF9pbmRpY2VzLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChtc2dfdHlwZSA9PSA1KSB7CiAgICAgICAgICAgICAgICAvLyBhcHBlbmQgcmVzcG9uc2UKICAgICAgICAgICAgICAgIGhhbmRsZV9hcHBlbmRfcmVzcG9uc2UoCiAgICAgICAgICAgICAgICAgICAgc2VuZGVyLAogICAgICAgICAgICAgICAgICAgIHJlY2VpdmVyLAogICAgICAgICAgICAgICAgICAgIG1zZ190ZXJtLAogICAgICAgICAgICAgICAgICAgIGRhdGExLAogICAgICAgICAgICAgICAgICAgIGRhdGEyLAogICAgICAgICAgICAgICAgICAgIHN0YXRlcywKICAgICAgICAgICAgICAgICAgICBuZXh0X2luZGljZXMsCiAgICAgICAgICAgICAgICAgICAgbWF0Y2hfaW5kaWNlcywKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICpoZWFkID0gKCpoZWFkICsgMSkgJSAxMDAwOwogICAgICAgIHByb2Nlc3NlZCA9IHByb2Nlc3NlZCArIDE7CiAgICB9CgogICAgcHJvY2Vzc2VkCn0KCi8vIEhhbmRsZSB2b3RlIHJlcXVlc3Qgd2l0aCBjb21wbGV4IHZhbGlkYXRpb24KZm4gaGFuZGxlX3ZvdGVfcmVxdWVzdCgKICAgIHNlbmRlcjogaTMyLAogICAgcmVjZWl2ZXI6IGkzMiwKICAgIHRlcm06IGkzMiwKICAgIHN0YXRlczogJm11dCBbaTMyOyAxMDBdLAogICAgdGVybXM6ICZtdXQgW2kzMjsgMTAwXSwKICAgIHZvdGVzOiAmbXV0IFtpMzI7IDEwMF0sCikgewogICAgaWYgKHRlcm0gPiB0ZXJtc1tyZWNlaXZlciBhcyB1c2l6ZV0pIHsKICAgICAgICB0ZXJtc1tyZWNlaXZlciBhcyB1c2l6ZV0gPSB0ZXJtOwogICAgICAgIHN0YXRlc1tyZWNlaXZlciBhcyB1c2l6ZV0gPSAwOyAvLyByZXZlcnQgdG8gZm9sbG93ZXIKICAgICAgICB2b3Rlc1tyZWNlaXZlciBhcyB1c2l6ZV0gPSAtMTsKICAgIH0KCiAgICBpZiAodGVybSA9PSB0ZXJtc1tyZWNlaXZlciBhcyB1c2l6ZV0KICAgICAgICAmJiAodm90ZXNbcmVjZWl2ZXIgYXMgdXNpemVdID09IC0xIHx8IHZvdGVzW3JlY2VpdmVyIGFzIHVzaXplXSA9PSBzZW5kZXIpKQogICAgewogICAgICAgIHZvdGVzW3JlY2VpdmVyIGFzIHVzaXplXSA9IHNlbmRlcjsKICAgICAgICAvLyBTZW5kIHZvdGUgcmVzcG9uc2UgKHNpbXBsaWZpZWQgLSB3b3VsZCBuZWVkIG1lc3NhZ2UgcXVldWUpCiAgICB9Cn0KCi8vIEhhbmRsZSBoZWFydGJlYXQgd2l0aCBzdGF0ZSB1cGRhdGVzCmZuIGhhbmRsZV9oZWFydGJlYXQoCiAgICBzZW5kZXI6IGkzMiwKICAgIHJlY2VpdmVyOiBpMzIsCiAgICB0ZXJtOiBpMzIsCiAgICBzdGF0ZXM6ICZtdXQgW2kzMjsgMTAwXSwKICAgIHRlcm1zOiAmbXV0IFtpMzI7IDEwMF0sCiAgICB2b3RlczogJm11dCBbaTMyOyAxMDBdLAopIHsKICAgIGlmICh0ZXJtID49IHRlcm1zW3JlY2VpdmVyIGFzIHVzaXplXSkgewogICAgICAgIHRlcm1zW3JlY2VpdmVyIGFzIHVzaXplXSA9IHRlcm07CiAgICAgICAgc3RhdGVzW3JlY2VpdmVyIGFzIHVzaXplXSA9IDA7IC8vIGJlY29tZSBmb2xsb3dlcgogICAgICAgIHZvdGVzW3JlY2VpdmVyIGFzIHVzaXplXSA9IC0xOwogICAgfQp9CgovLyBIYW5kbGUgdm90ZSByZXNwb25zZSB3aXRoIGxlYWRlciBlbGVjdGlvbiBsb2dpYwpmbiBoYW5kbGVfdm90ZV9yZXNwb25zZSgKICAgIHNlbmRlcjogaTMyLAogICAgcmVjZWl2ZXI6IGkzMiwKICAgIHRlcm06IGkzMiwKICAgIGdyYW50ZWQ6IGkzMiwKICAgIHN0YXRlczogJm11dCBbaTMyOyAxMDBdLAogICAgdGVybXM6ICZbaTMyOyAxMDBdLAogICAgbm9kZV9jb3VudDogaTMyLAopIHsKICAgIGlmIChzdGF0ZXNbcmVjZWl2ZXIgYXMgdXNpemVdID09IDEgJiYgdGVybSA9PSB0ZXJtc1tyZWNlaXZlciBhcyB1c2l6ZV0gJiYgZ3JhbnRlZCA9PSAxKSB7CiAgICAgICAgLy8gQ291bnQgdm90ZXMgKHNpbXBsaWZpZWQgLSBpbiByZWFsIGltcGxlbWVudGF0aW9uIHdvdWxkIHRyYWNrIHZvdGVzKQogICAgICAgIGxldCB2b3RlX3RocmVzaG9sZDogaTMyID0gbm9kZV9jb3VudCAvIDIgKyAxOwogICAgICAgIC8vIElmIGVub3VnaCB2b3RlcyByZWNlaXZlZCwgYmVjb21lIGxlYWRlcgogICAgICAgIGlmIChyZWNlaXZlciAqIDMgJSBub2RlX2NvdW50ID49IHZvdGVfdGhyZXNob2xkIC0gMSkgewogICAgICAgICAgICAvLyBTaW1wbGlmaWVkIHZvdGUgY291bnRpbmcKICAgICAgICAgICAgc3RhdGVzW3JlY2VpdmVyIGFzIHVzaXplXSA9IDI7IC8vIGJlY29tZSBsZWFkZXIKICAgICAgICB9CiAgICB9Cn0KCi8vIEhhbmRsZSBhcHBlbmQgZW50cmllcyBmb3IgbG9nIHJlcGxpY2F0aW9uCmZuIGhhbmRsZV9hcHBlbmRfZW50cmllcygKICAgIHNlbmRlcjogaTMyLAogICAgcmVjZWl2ZXI6IGkzMiwKICAgIHRlcm06IGkzMiwKICAgIHByZXZfbG9nX2luZGV4OiBpMzIsCiAgICBwcmV2X2xvZ190ZXJtOiBpMzIsCiAgICBlbnRyeTogaTMyLAogICAgc3RhdGVzOiAmbXV0IFtpMzI7IDEwMF0sCiAgICB0ZXJtczogJm11dCBbaTMyOyAxMDBdLAogICAgbG9nczogJm11dCBbW2kzMjsgNTBdOyAxMDBdLAogICAgbG9nX3NpemVzOiAmbXV0IFtpMzI7IDEwMF0sCiAgICBjb21taXRfaW5kaWNlczogJm11dCBbaTMyOyAxMDBdLAopIHsKICAgIGlmICh0ZXJtIDwgdGVybXNbcmVjZWl2ZXIgYXMgdXNpemVdKSB7CiAgICAgICAgcmV0dXJuOyAvLyBSZWplY3Qgb3V0ZGF0ZWQgdGVybXMKICAgIH0KCiAgICBpZiAodGVybSA+IHRlcm1zW3JlY2VpdmVyIGFzIHVzaXplXSkgewogICAgICAgIHRlcm1zW3JlY2VpdmVyIGFzIHVzaXplXSA9IHRlcm07CiAgICAgICAgc3RhdGVzW3JlY2VpdmVyIGFzIHVzaXplXSA9IDA7IC8vIGJlY29tZSBmb2xsb3dlcgogICAgfQoKICAgIC8vIENvbXBsZXggbG9nIGNvbnNpc3RlbmN5IGNoZWNrcwogICAgaWYgKHByZXZfbG9nX2luZGV4ID49IDAgJiYgcHJldl9sb2dfaW5kZXggPCBsb2dfc2l6ZXNbcmVjZWl2ZXIgYXMgdXNpemVdKSB7CiAgICAgICAgaWYgKGxvZ3NbcmVjZWl2ZXIgYXMgdXNpemVdW3ByZXZfbG9nX2luZGV4IGFzIHVzaXplXSA9PSBwcmV2X2xvZ190ZXJtKSB7CiAgICAgICAgICAgIC8vIEFwcGVuZCBuZXcgZW50cnkKICAgICAgICAgICAgaWYgKGVudHJ5ID4gMCAmJiBsb2dfc2l6ZXNbcmVjZWl2ZXIgYXMgdXNpemVdIDwgNTApIHsKICAgICAgICAgICAgICAgIGxvZ3NbcmVjZWl2ZXIgYXMgdXNpemVdWyhsb2dfc2l6ZXNbcmVjZWl2ZXIgYXMgdXNpemVdKSBhcyB1c2l6ZV0gPSBlbnRyeTsKICAgICAgICAgICAgICAgIGxvZ19zaXplc1tyZWNlaXZlciBhcyB1c2l6ZV0gPSBsb2dfc2l6ZXNbcmVjZWl2ZXIgYXMgdXNpemVdICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKLy8gSGFuZGxlIGFwcGVuZCByZXNwb25zZSBmb3IgbGVhZGVyIHN0YXRlIG1hbmFnZW1lbnQKZm4gaGFuZGxlX2FwcGVuZF9yZXNwb25zZSgKICAgIHNlbmRlcjogaTMyLAogICAgcmVjZWl2ZXI6IGkzMiwKICAgIHRlcm06IGkzMiwKICAgIHN1Y2Nlc3M6IGkzMiwKICAgIG1hdGNoX2luZGV4OiBpMzIsCiAgICBzdGF0ZXM6ICZbaTMyOyAxMDBdLAogICAgbmV4dF9pbmRpY2VzOiAmbXV0IFtbaTMyOyAxMDBdOyAxMDBdLAogICAgbWF0Y2hfaW5kaWNlczogJm11dCBbW2kzMjsgMTAwXTsgMTAwXSwKKSB7CiAgICBpZiAoc3RhdGVzW3JlY2VpdmVyIGFzIHVzaXplXSA9PSAyICYmIHRlcm0gPT0gc3RhdGVzW3JlY2VpdmVyIGFzIHVzaXplXSkgewogICAgICAgIC8vIGlmIHN0aWxsIGxlYWRlcgogICAgICAgIGlmIChzdWNjZXNzID09IDEpIHsKICAgICAgICAgICAgbmV4dF9pbmRpY2VzW3JlY2VpdmVyIGFzIHVzaXplXVtzZW5kZXIgYXMgdXNpemVdID0gbWF0Y2hfaW5kZXggKyAxOwogICAgICAgICAgICBtYXRjaF9pbmRpY2VzW3JlY2VpdmVyIGFzIHVzaXplXVtzZW5kZXIgYXMgdXNpemVdID0gbWF0Y2hfaW5kZXg7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKG5leHRfaW5kaWNlc1tyZWNlaXZlciBhcyB1c2l6ZV1bc2VuZGVyIGFzIHVzaXplXSA+IDApIHsKICAgICAgICAgICAgICAgIG5leHRfaW5kaWNlc1tyZWNlaXZlciBhcyB1c2l6ZV1bc2VuZGVyIGFzIHVzaXplXSA9CiAgICAgICAgICAgICAgICAgICAgbmV4dF9pbmRpY2VzW3JlY2VpdmVyIGFzIHVzaXplXVtzZW5kZXIgYXMgdXNpemVdIC0gMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKLy8gQ2hlY2sgZm9yIHN1Y2Nlc3NmdWwgbGVhZGVyIGVsZWN0aW9uCmZuIGNoZWNrX2xlYWRlcl9lbGVjdGlvbihzdGF0ZXM6ICZbaTMyOyAxMDBdLCB0ZXJtczogJltpMzI7IDEwMF0sIG5vZGVfY291bnQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgbWF4X3Rlcm06IGkzMiA9IC0xOwogICAgbGV0IG11dCBsZWFkZXJfY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGxlYWRlcl9pZDogaTMyID0gLTE7CgogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaWYgKHRlcm1zW2kgYXMgdXNpemVdID4gbWF4X3Rlcm0pIHsKICAgICAgICAgICAgbWF4X3Rlcm0gPSB0ZXJtc1tpIGFzIHVzaXplXTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaWYgKHN0YXRlc1tpIGFzIHVzaXplXSA9PSAyICYmIHRlcm1zW2kgYXMgdXNpemVdID09IG1heF90ZXJtKSB7CiAgICAgICAgICAgIGxlYWRlcl9jb3VudCA9IGxlYWRlcl9jb3VudCArIDE7CiAgICAgICAgICAgIGxlYWRlcl9pZCA9IGk7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBpZiAobGVhZGVyX2NvdW50ID09IDEpIHsgbGVhZGVyX2lkIH0gZWxzZSB7IC0xIH0KfQoKLy8gU2ltdWxhdGUgbG9nIHJlcGxpY2F0aW9uIGZyb20gbGVhZGVyIHRvIGZvbGxvd2VycwpmbiBzaW11bGF0ZV9sb2dfcmVwbGljYXRpb24oCiAgICBsZWFkZXI6IGkzMiwKICAgIGxvZ3M6ICZbW2kzMjsgNTBdOyAxMDBdLAogICAgbG9nX3NpemVzOiAmW2kzMjsgMTAwXSwKICAgIGNvbW1pdF9pbmRpY2VzOiAmbXV0IFtpMzI7IDEwMF0sCiAgICBuZXh0X2luZGljZXM6ICZtdXQgW1tpMzI7IDEwMF07IDEwMF0sCiAgICBtYXRjaF9pbmRpY2VzOiAmbXV0IFtbaTMyOyAxMDBdOyAxMDBdLAogICAgcXVldWU6ICZtdXQgW1tpMzI7IDEwXTsgMTAwMF0sCiAgICB0YWlsOiAmbXV0IGkzMiwKICAgIHBhcnRpdGlvbjogJltib29sOyAxMDBdLAogICAgbm9kZV9jb3VudDogaTMyLAogICAgcm91bmQ6IGkzMiwKKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICBpZiAoaSAhPSBsZWFkZXIgJiYgIXBhcnRpdGlvbltpIGFzIHVzaXplXSkgewogICAgICAgICAgICBsZXQgbmV4dF9pbmRleDogaTMyID0gbmV4dF9pbmRpY2VzW2xlYWRlciBhcyB1c2l6ZV1baSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGlmIChuZXh0X2luZGV4IDwgbG9nX3NpemVzW2xlYWRlciBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIGxldCBwcmV2X2luZGV4OiBpMzIgPSBuZXh0X2luZGV4IC0gMTsKICAgICAgICAgICAgICAgIGxldCBwcmV2X3Rlcm06IGkzMiA9IGlmIChwcmV2X2luZGV4ID49IDApIHsKICAgICAgICAgICAgICAgICAgICBsb2dzW2xlYWRlciBhcyB1c2l6ZV1bcHJldl9pbmRleCBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgMAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGxldCBlbnRyeTogaTMyID0gbG9nc1tsZWFkZXIgYXMgdXNpemVdW25leHRfaW5kZXggYXMgdXNpemVdOwoKICAgICAgICAgICAgICAgIGVucXVldWVfbWVzc2FnZShxdWV1ZSwgdGFpbCwgbGVhZGVyLCBpLCA0LCAwLCBwcmV2X2luZGV4LCBwcmV2X3Rlcm0sIGVudHJ5KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gVXBkYXRlIGNvbW1pdCBpbmRleCBiYXNlZCBvbiBtYWpvcml0eSByZXBsaWNhdGlvbgogICAgbGV0IG11dCBuZXdfY29tbWl0OiBpMzIgPSBjb21taXRfaW5kaWNlc1tsZWFkZXIgYXMgdXNpemVdOwogICAgbGV0IG11dCBqOiBpMzIgPSBjb21taXRfaW5kaWNlc1tsZWFkZXIgYXMgdXNpemVdICsgMTsKICAgIHdoaWxlIChqIDwgbG9nX3NpemVzW2xlYWRlciBhcyB1c2l6ZV0pIHsKICAgICAgICBsZXQgbXV0IHJlcGxpY2F0ZWRfY291bnQ6IGkzMiA9IDE7IC8vIGxlYWRlciBpdHNlbGYKICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGsgPCBub2RlX2NvdW50KSB7CiAgICAgICAgICAgIGlmIChrICE9IGxlYWRlciAmJiBtYXRjaF9pbmRpY2VzW2xlYWRlciBhcyB1c2l6ZV1bayBhcyB1c2l6ZV0gPj0gaikgewogICAgICAgICAgICAgICAgcmVwbGljYXRlZF9jb3VudCA9IHJlcGxpY2F0ZWRfY291bnQgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGsgPSBrICsgMTsKICAgICAgICB9CgogICAgICAgIGlmIChyZXBsaWNhdGVkX2NvdW50ID4gbm9kZV9jb3VudCAvIDIpIHsKICAgICAgICAgICAgbmV3X2NvbW1pdCA9IGo7CiAgICAgICAgfQogICAgICAgIGogPSBqICsgMTsKICAgIH0KICAgIGNvbW1pdF9pbmRpY2VzW2xlYWRlciBhcyB1c2l6ZV0gPSBuZXdfY29tbWl0Owp9CgovLyBBcHBlbmQgbmV3IGxvZyBlbnRyeQpmbiBhcHBlbmRfbG9nX2VudHJ5KAogICAgbm9kZTogaTMyLAogICAgZW50cnk6IGkzMiwKICAgIGxvZ3M6ICZtdXQgW1tpMzI7IDUwXTsgMTAwXSwKICAgIGxvZ19zaXplczogJm11dCBbaTMyOyAxMDBdLAopIHsKICAgIGlmIChsb2dfc2l6ZXNbbm9kZSBhcyB1c2l6ZV0gPCA1MCkgewogICAgICAgIGxvZ3Nbbm9kZSBhcyB1c2l6ZV1bKGxvZ19zaXplc1tub2RlIGFzIHVzaXplXSkgYXMgdXNpemVdID0gZW50cnk7CiAgICAgICAgbG9nX3NpemVzW25vZGUgYXMgdXNpemVdID0gbG9nX3NpemVzW25vZGUgYXMgdXNpemVdICsgMTsKICAgIH0KfQoKLy8gVmVyaWZ5IHN5c3RlbSBjb25zaXN0ZW5jeSB3aXRoIGNvbXBsZXggc2NvcmluZwpmbiB2ZXJpZnlfc3lzdGVtX2NvbnNpc3RlbmN5KAogICAgc3RhdGVzOiAmW2kzMjsgMTAwXSwKICAgIHRlcm1zOiAmW2kzMjsgMTAwXSwKICAgIGxvZ3M6ICZbW2kzMjsgNTBdOyAxMDBdLAogICAgbG9nX3NpemVzOiAmW2kzMjsgMTAwXSwKICAgIGNvbW1pdF9pbmRpY2VzOiAmW2kzMjsgMTAwXSwKICAgIG5vZGVfY291bnQ6IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IG11dCBjb25zaXN0ZW5jeV9zY29yZTogaTMyID0gMTAwOwoKICAgIC8vIENoZWNrIGZvciBzcGxpdCBsZWFkZXJzaGlwCiAgICBsZXQgbXV0IGxlYWRlcl9jb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgbWF4X3Rlcm06IGkzMiA9IC0xOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIGlmICh0ZXJtc1tpIGFzIHVzaXplXSA+IG1heF90ZXJtKSB7CiAgICAgICAgICAgIG1heF90ZXJtID0gdGVybXNbaSBhcyB1c2l6ZV07CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIGlmIChzdGF0ZXNbaSBhcyB1c2l6ZV0gPT0gMiAmJiB0ZXJtc1tpIGFzIHVzaXplXSA9PSBtYXhfdGVybSkgewogICAgICAgICAgICBsZWFkZXJfY291bnQgPSBsZWFkZXJfY291bnQgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgaWYgKGxlYWRlcl9jb3VudCA+IDEpIHsKICAgICAgICBjb25zaXN0ZW5jeV9zY29yZSA9IGNvbnNpc3RlbmN5X3Njb3JlIC0gMzA7IC8vIFNwbGl0IGJyYWluIHBlbmFsdHkKICAgIH0gZWxzZSBpZiAobGVhZGVyX2NvdW50ID09IDApIHsKICAgICAgICBjb25zaXN0ZW5jeV9zY29yZSA9IGNvbnNpc3RlbmN5X3Njb3JlIC0gMjA7IC8vIE5vIGxlYWRlciBwZW5hbHR5CiAgICB9CgogICAgLy8gQ2hlY2sgbG9nIGNvbnNpc3RlbmN5IGFtb25nIGNvbW1pdHRlZCBlbnRyaWVzCiAgICBsZXQgbXV0IGxvZ19pbmNvbnNpc3RlbmNpZXM6IGkzMiA9IDA7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gaSArIDE7CiAgICAgICAgd2hpbGUgKGogPCBub2RlX2NvdW50KSB7CiAgICAgICAgICAgIGxldCBtaW5fY29tbWl0OiBpMzIgPSBpZiAoY29tbWl0X2luZGljZXNbaSBhcyB1c2l6ZV0gPCBjb21taXRfaW5kaWNlc1tqIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgY29tbWl0X2luZGljZXNbaSBhcyB1c2l6ZV0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbW1pdF9pbmRpY2VzW2ogYXMgdXNpemVdCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChrIDw9IG1pbl9jb21taXQgJiYgayA8IDUwKSB7CiAgICAgICAgICAgICAgICBpZiAobG9nc1tpIGFzIHVzaXplXVtrIGFzIHVzaXplXSAhPSBsb2dzW2ogYXMgdXNpemVdW2sgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICAgICAgbG9nX2luY29uc2lzdGVuY2llcyA9IGxvZ19pbmNvbnNpc3RlbmNpZXMgKyAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgayA9IGsgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGNvbnNpc3RlbmN5X3Njb3JlID0gY29uc2lzdGVuY3lfc2NvcmUgLSBsb2dfaW5jb25zaXN0ZW5jaWVzICogMjsKCiAgICBpZiAoY29uc2lzdGVuY3lfc2NvcmUgPCAwKSB7CiAgICAgICAgY29uc2lzdGVuY3lfc2NvcmUgPSAwOwogICAgfQoKICAgIGNvbnNpc3RlbmN5X3Njb3JlCn0KCi8vIFRyaWdnZXIgcmVjb3ZlcnkgcHJvdG9jb2wgZm9yIHN5c3RlbSBpbmNvbnNpc3RlbmNpZXMKZm4gdHJpZ2dlcl9yZWNvdmVyeV9wcm90b2NvbCgKICAgIHN0YXRlczogJm11dCBbaTMyOyAxMDBdLAogICAgdGVybXM6ICZbaTMyOyAxMDBdLAogICAgdm90ZXM6ICZtdXQgW2kzMjsgMTAwXSwKICAgIG5vZGVfY291bnQ6IGkzMiwKKSB7CiAgICAvLyBSZXNldCBhbGwgbm9kZXMgdG8gZm9sbG93ZXIgc3RhdGUKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIHN0YXRlc1tpIGFzIHVzaXplXSA9IDA7IC8vIGZvbGxvd2VyCiAgICAgICAgdm90ZXNbaSBhcyB1c2l6ZV0gPSAtMTsgLy8gbm8gdm90ZQogICAgICAgIC8vIEtlZXAgdGVybXMgYXMgdGhleSBhcmUgdG8gbWFpbnRhaW4gcHJvZ3Jlc3MKICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIFNpbXVsYXRlIEJ5emFudGluZSBmYWlsdXJlcyBhbmQgbmV0d29yayBhdHRhY2tzCmZuIHNpbXVsYXRlX2J5emFudGluZV9mYWlsdXJlcygKICAgIHN0YXRlczogJm11dCBbaTMyOyAxMDBdLAogICAgcGFydGl0aW9uOiAmbXV0IFtib29sOyAxMDBdLAogICAgbm9kZV9jb3VudDogaTMyLAogICAgcm91bmQ6IGkzMiwKKSB7CiAgICAvLyBSYW5kb21seSBjb3JydXB0IHNvbWUgbm9kZXMKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIGlmICgoaSAqIDE5ICsgcm91bmQgKiA1KSAlIDk3ID09IDApIHsKICAgICAgICAgICAgLy8gfjElIEJ5emFudGluZSBmYWlsdXJlIHJhdGUKICAgICAgICAgICAgc3RhdGVzW2kgYXMgdXNpemVdID0gMzsgLy8gQnl6YW50aW5lIHN0YXRlIChpbnZhbGlkKQogICAgICAgICAgICBwYXJ0aXRpb25baSBhcyB1c2l6ZV0gPSB0cnVlOyAvLyBJc29sYXRlIEJ5emFudGluZSBub2RlcwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIENvbXBhY3QgbG9ncyBmb3IgbWVtb3J5IG9wdGltaXphdGlvbgpmbiBjb21wYWN0X2xvZ3MoCiAgICBsb2dzOiAmbXV0IFtbaTMyOyA1MF07IDEwMF0sCiAgICBsb2dfc2l6ZXM6ICZtdXQgW2kzMjsgMTAwXSwKICAgIGNvbW1pdF9pbmRpY2VzOiAmW2kzMjsgMTAwXSwKICAgIG5vZGVfY291bnQ6IGkzMiwKKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICBsZXQgY29tcGFjdF91bnRpbDogaTMyID0gY29tbWl0X2luZGljZXNbaSBhcyB1c2l6ZV0gLyAyOyAvLyBLZWVwIGhhbGYgb2YgY29tbWl0dGVkIGVudHJpZXMKICAgICAgICBpZiAoY29tcGFjdF91bnRpbCA+IDAgJiYgY29tcGFjdF91bnRpbCA8IGxvZ19zaXplc1tpIGFzIHVzaXplXSkgewogICAgICAgICAgICAvLyBTaGlmdCByZW1haW5pbmcgZW50cmllcwogICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChqICsgY29tcGFjdF91bnRpbCA8IGxvZ19zaXplc1tpIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgbG9nc1tpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9IGxvZ3NbaSBhcyB1c2l6ZV1bKGogKyBjb21wYWN0X3VudGlsKSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbG9nX3NpemVzW2kgYXMgdXNpemVdID0gbG9nX3NpemVzW2kgYXMgdXNpemVdIC0gY29tcGFjdF91bnRpbDsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBGaW5kIHN0YWJsZSBsZWFkZXIgYWNyb3NzIG11bHRpcGxlIHRlcm1zCmZuIGZpbmRfc3RhYmxlX2xlYWRlcihzdGF0ZXM6ICZbaTMyOyAxMDBdLCB0ZXJtczogJltpMzI7IDEwMF0sIG5vZGVfY291bnQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgbWF4X3Rlcm06IGkzMiA9IC0xOwogICAgbGV0IG11dCBzdGFibGVfbGVhZGVyOiBpMzIgPSAtMTsKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICBpZiAoc3RhdGVzW2kgYXMgdXNpemVdID09IDIgJiYgdGVybXNbaSBhcyB1c2l6ZV0gPiBtYXhfdGVybSkgewogICAgICAgICAgICBtYXhfdGVybSA9IHRlcm1zW2kgYXMgdXNpemVdOwogICAgICAgICAgICBzdGFibGVfbGVhZGVyID0gaTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHN0YWJsZV9sZWFkZXIKfQoKLy8gQ291bnQgdG90YWwgY29tbWl0dGVkIGVudHJpZXMgYWNyb3NzIGFsbCBub2RlcwpmbiBjb3VudF90b3RhbF9jb21taXR0ZWRfZW50cmllcyhjb21taXRfaW5kaWNlczogJltpMzI7IDEwMF0sIG5vZGVfY291bnQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgdG90YWw6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICB0b3RhbCA9IHRvdGFsICsgY29tbWl0X2luZGljZXNbaSBhcyB1c2l6ZV07CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgdG90YWwKfQoKLy8gQ2FsY3VsYXRlIG5ldHdvcmsgZWZmaWNpZW5jeSBtZXRyaWNzCmZuIGNhbGN1bGF0ZV9uZXR3b3JrX2VmZmljaWVuY3kodG90YWxfbWVzc2FnZXM6IGkzMiwgY29uc2Vuc3VzX3JvdW5kczogaTMyKSAtPiBpMzIgewogICAgaWYgKGNvbnNlbnN1c19yb3VuZHMgPiAwKSB7CiAgICAgICAgKHRvdGFsX21lc3NhZ2VzICogMTAwKSAvIChjb25zZW5zdXNfcm91bmRzICogMTAwKSAvLyBTaW1wbGlmaWVkIGVmZmljaWVuY3kgbWV0cmljCiAgICB9IGVsc2UgewogICAgICAgIDAKICAgIH0KfQoKLy8gQ29tcHV0ZSBoYXNoIG9mIHN5c3RlbSBzdGF0ZSBmb3IgdmVyaWZpY2F0aW9uCmZuIGNvbXB1dGVfc3lzdGVtX3N0YXRlX2hhc2goCiAgICBsb2dzOiAmW1tpMzI7IDUwXTsgMTAwXSwKICAgIGxvZ19zaXplczogJltpMzI7IDEwMF0sCiAgICBjb21taXRfaW5kaWNlczogJltpMzI7IDEwMF0sCiAgICBub2RlX2NvdW50OiBpMzIsCikgLT4gaTMyIHsKICAgIGxldCBtdXQgaGFzaDogaTMyID0gMTc7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaGFzaCA9IChoYXNoICogMzEgKyBsb2dfc2l6ZXNbaSBhcyB1c2l6ZV0pICUgMTY3NzcyMTk7CiAgICAgICAgaGFzaCA9IChoYXNoICogMzEgKyBjb21taXRfaW5kaWNlc1tpIGFzIHVzaXplXSkgJSAxNjc3NzIxOTsKCiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgbG9nX3NpemVzW2kgYXMgdXNpemVdICYmIGogPCA1MCkgewogICAgICAgICAgICBoYXNoID0gKGhhc2ggKiAzMSArIGxvZ3NbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0pICUgMTY3NzcyMTk7CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGlmIChoYXNoIDwgMCkgewogICAgICAgIGhhc2ggPSAtaGFzaDsKICAgIH0KCiAgICBoYXNoICUgMTAwMDAwMCAvLyBLZWVwIGhhc2ggd2l0aGluIHJlYXNvbmFibGUgcmFuZ2UKfQoKLy8gRW5xdWV1ZSBtZXNzYWdlIGZvciBpbnRlci1ub2RlIGNvbW11bmljYXRpb24KZm4gZW5xdWV1ZV9tZXNzYWdlKAogICAgcXVldWU6ICZtdXQgW1tpMzI7IDEwXTsgMTAwMF0sCiAgICB0YWlsOiAmbXV0IGkzMiwKICAgIHNlbmRlcjogaTMyLAogICAgcmVjZWl2ZXI6IGkzMiwKICAgIG1zZ190eXBlOiBpMzIsCiAgICB0ZXJtOiBpMzIsCiAgICBkYXRhMTogaTMyLAogICAgZGF0YTI6IGkzMiwKICAgIGRhdGEzOiBpMzIsCikgewogICAgcXVldWVbKnRhaWwgYXMgdXNpemVdWzBdID0gc2VuZGVyOwogICAgcXVldWVbKnRhaWwgYXMgdXNpemVdWzFdID0gcmVjZWl2ZXI7CiAgICBxdWV1ZVsqdGFpbCBhcyB1c2l6ZV1bMl0gPSBtc2dfdHlwZTsKICAgIHF1ZXVlWyp0YWlsIGFzIHVzaXplXVszXSA9IHRlcm07CiAgICBxdWV1ZVsqdGFpbCBhcyB1c2l6ZV1bNF0gPSBkYXRhMTsKICAgIHF1ZXVlWyp0YWlsIGFzIHVzaXplXVs1XSA9IGRhdGEyOwogICAgcXVldWVbKnRhaWwgYXMgdXNpemVdWzZdID0gZGF0YTM7CiAgICBxdWV1ZVsqdGFpbCBhcyB1c2l6ZV1bN10gPSAwOyAvLyBSZXNlcnZlZAogICAgcXVldWVbKnRhaWwgYXMgdXNpemVdWzhdID0gMDsgLy8gUmVzZXJ2ZWQKICAgIHF1ZXVlWyp0YWlsIGFzIHVzaXplXVs5XSA9IDA7IC8vIFJlc2VydmVkCgogICAgKnRhaWwgPSAoKnRhaWwgKyAxKSAlIDEwMDA7Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (24, "comprehensive24", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IFZpcnR1YWwgTWVtb3J5IE1hbmFnZW1lbnQgYW5kIFBhZ2UgUmVwbGFjZW1lbnQgQWxnb3JpdGhtIFNpbXVsYXRvcgpTdW1tYXJ5OiBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKRGV0YWlsczoKQ29tcGxleCB2aXJ0dWFsIG1lbW9yeSBtYW5hZ2VtZW50IHdpdGggbXVsdGktbGV2ZWwgcGFnZSB0YWJsZXMKQWR2YW5jZWQgcGFnZSByZXBsYWNlbWVudCBhbGdvcml0aG1zIChMUlUsIENMT0NLLCBXb3JraW5nIFNldCkKQ2FjaGUgaGllcmFyY2h5IHNpbXVsYXRpb24gd2l0aCBtdWx0aXBsZSBsZXZlbHMgYW5kIHBvbGljaWVzCk1lbW9yeSBhbGxvY2F0aW9uIHRyYWNraW5nIHdpdGggZnJhZ21lbnRhdGlvbiBhbmFseXNpcwpDb21wbGV4IGJpdCBtYW5pcHVsYXRpb24gZm9yIHBhZ2UgdGFibGUgZW50cmllcyBhbmQgZmxhZ3MKTmVzdGVkIGxvb3Agb3B0aW1pemF0aW9uIGZvciBtZW1vcnkgYWNjZXNzIHBhdHRlcm5zCkJyYW5jaCBwcmVkaWN0aW9uIG9wdGltaXphdGlvbiBmb3IgY2FjaGUgaGl0L21pc3Mgc2NlbmFyaW9zCkFycmF5IGFjY2VzcyBwYXR0ZXJuIG9wdGltaXphdGlvbiBmb3Igc3BhcnNlIGRhdGEgc3RydWN0dXJlcwoqLwoKLy8gY29tcHJlaGVuc2l2ZTI0LnJ4IC0gVmlydHVhbCBNZW1vcnkgTWFuYWdlbWVudCBhbmQgUGFnZSBSZXBsYWNlbWVudCBBbGdvcml0aG0gU2ltdWxhdG9yCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIENvbXBsZXggdmlydHVhbCBtZW1vcnkgbWFuYWdlbWVudCB3aXRoIG11bHRpLWxldmVsIHBhZ2UgdGFibGVzCi8vIC0gQWR2YW5jZWQgcGFnZSByZXBsYWNlbWVudCBhbGdvcml0aG1zIChMUlUsIENMT0NLLCBXb3JraW5nIFNldCkKLy8gLSBDYWNoZSBoaWVyYXJjaHkgc2ltdWxhdGlvbiB3aXRoIG11bHRpcGxlIGxldmVscyBhbmQgcG9saWNpZXMKLy8gLSBNZW1vcnkgYWxsb2NhdGlvbiB0cmFja2luZyB3aXRoIGZyYWdtZW50YXRpb24gYW5hbHlzaXMKLy8gLSBDb21wbGV4IGJpdCBtYW5pcHVsYXRpb24gZm9yIHBhZ2UgdGFibGUgZW50cmllcyBhbmQgZmxhZ3MKLy8gLSBOZXN0ZWQgbG9vcCBvcHRpbWl6YXRpb24gZm9yIG1lbW9yeSBhY2Nlc3MgcGF0dGVybnMKLy8gLSBCcmFuY2ggcHJlZGljdGlvbiBvcHRpbWl6YXRpb24gZm9yIGNhY2hlIGhpdC9taXNzIHNjZW5hcmlvcwovLyAtIEFycmF5IGFjY2VzcyBwYXR0ZXJuIG9wdGltaXphdGlvbiBmb3Igc3BhcnNlIGRhdGEgc3RydWN0dXJlcwoKZm4gbWFpbigpIHsKICAgIHByaW50bG5JbnQoNDIpOwoKICAgIC8vIFZpcnR1YWwgTWVtb3J5IFN5c3RlbSBDb25maWd1cmF0aW9uCiAgICBsZXQgcGFnZV9zaXplOiBpMzIgPSA0MDk2OwogICAgbGV0IHZpcnR1YWxfYWRkcmVzc19zcGFjZTogaTMyID0gMTA0ODU3NjsgLy8gMU1CIHZpcnR1YWwgc3BhY2UKICAgIGxldCBwaHlzaWNhbF9tZW1vcnlfc2l6ZTogaTMyID0gMjYyMTQ0OyAvLyAyNTZLQiBwaHlzaWNhbCBtZW1vcnkKICAgIGxldCBudW1fdmlydHVhbF9wYWdlczogaTMyID0gdmlydHVhbF9hZGRyZXNzX3NwYWNlIC8gcGFnZV9zaXplOyAvLyAyNTYgdmlydHVhbCBwYWdlcwogICAgbGV0IG51bV9waHlzaWNhbF9mcmFtZXM6IGkzMiA9IHBoeXNpY2FsX21lbW9yeV9zaXplIC8gcGFnZV9zaXplOyAvLyA2NCBwaHlzaWNhbCBmcmFtZXMKCiAgICAvLyBQYWdlIFRhYmxlIFN0cnVjdHVyZSAoc2ltcGxpZmllZCB0d28tbGV2ZWwpCiAgICBsZXQgbXV0IHBhZ2VfZGlyZWN0b3J5OiBbaTMyOyAxNl0gPSBbMDsgMTZdOyAvLyBUb3AtbGV2ZWwgZGlyZWN0b3J5CiAgICBsZXQgbXV0IHBhZ2VfdGFibGVzOiBbW2kzMjsgMTZdOyAxNl0gPSBbWzA7IDE2XTsgMTZdOyAvLyBTZWNvbmQtbGV2ZWwgdGFibGVzCiAgICBsZXQgbXV0IGZyYW1lX2FsbG9jYXRpb25fdGFibGU6IFtpMzI7IDY0XSA9IFswOyA2NF07IC8vIFBoeXNpY2FsIGZyYW1lIHN0YXR1cwogICAgbGV0IG11dCByZXZlcnNlX21hcHBpbmc6IFtpMzI7IDY0XSA9IFstMTsgNjRdOyAvLyBGcmFtZSB0byBwYWdlIG1hcHBpbmcKCiAgICAvLyBQYWdlIFJlcGxhY2VtZW50IEFsZ29yaXRobSBEYXRhIFN0cnVjdHVyZXMKICAgIGxldCBtdXQgbHJ1X2NvdW50ZXI6IFtpMzI7IDI1Nl0gPSBbMDsgMjU2XTsgLy8gTFJVIHRpbWVzdGFtcHMgZm9yIGVhY2ggdmlydHVhbCBwYWdlCiAgICBsZXQgbXV0IHJlZmVyZW5jZV9iaXRzOiBbYm9vbDsgMjU2XSA9IFtmYWxzZTsgMjU2XTsgLy8gUmVmZXJlbmNlIGJpdHMgZm9yIENMT0NLIGFsZ29yaXRobQogICAgbGV0IG11dCBtb2RpZnlfYml0czogW2Jvb2w7IDI1Nl0gPSBbZmFsc2U7IDI1Nl07IC8vIERpcnR5IGJpdHMgZm9yIHdyaXRlIG9wZXJhdGlvbnMKICAgIGxldCBtdXQgY2xvY2tfaGFuZDogaTMyID0gMDsgLy8gQ3VycmVudCBwb3NpdGlvbiBpbiBDTE9DSyBhbGdvcml0aG0KICAgIGxldCBtdXQgd29ya2luZ19zZXRfd2luZG93OiBpMzIgPSA1MDsgLy8gV29ya2luZyBzZXQgd2luZG93IHNpemUKICAgIGxldCBtdXQgYWNjZXNzX2hpc3Rvcnk6IFtpMzI7IDEwMDBdID0gWzA7IDEwMDBdOyAvLyBSZWNlbnQgcGFnZSBhY2Nlc3NlcwogICAgbGV0IG11dCBoaXN0b3J5X2hlYWQ6IGkzMiA9IDA7CgogICAgLy8gQ2FjaGUgSGllcmFyY2h5IFNpbXVsYXRpb24KICAgIGxldCBtdXQgbDFfY2FjaGU6IFtbaTMyOyA0XTsgNjRdID0gW1swOyA0XTsgNjRdOyAvLyBMMSBjYWNoZTogNjQgc2V0cywgNCB3YXlzCiAgICBsZXQgbXV0IGwxX3RhZ3M6IFtbaTMyOyA0XTsgNjRdID0gW1stMTsgNF07IDY0XTsgLy8gTDEgY2FjaGUgdGFncwogICAgbGV0IG11dCBsMV92YWxpZDogW1tib29sOyA0XTsgNjRdID0gW1tmYWxzZTsgNF07IDY0XTsgLy8gTDEgdmFsaWRpdHkgYml0cwogICAgbGV0IG11dCBsMV9scnVfYml0czogW1tpMzI7IDRdOyA2NF0gPSBbWzA7IDRdOyA2NF07IC8vIEwxIExSVSBjb3VudGVycwoKICAgIGxldCBtdXQgbDJfY2FjaGU6IFtbaTMyOyA4XTsgMTI4XSA9IFtbMDsgOF07IDEyOF07IC8vIEwyIGNhY2hlOiAxMjggc2V0cywgOCB3YXlzCiAgICBsZXQgbXV0IGwyX3RhZ3M6IFtbaTMyOyA4XTsgMTI4XSA9IFtbLTE7IDhdOyAxMjhdOyAvLyBMMiBjYWNoZSB0YWdzCiAgICBsZXQgbXV0IGwyX3ZhbGlkOiBbW2Jvb2w7IDhdOyAxMjhdID0gW1tmYWxzZTsgOF07IDEyOF07IC8vIEwyIHZhbGlkaXR5IGJpdHMKICAgIGxldCBtdXQgbDJfbHJ1X2JpdHM6IFtbaTMyOyA4XTsgMTI4XSA9IFtbMDsgOF07IDEyOF07IC8vIEwyIExSVSBjb3VudGVycwoKICAgIC8vIE1lbW9yeSBBY2Nlc3MgU3RhdGlzdGljcwogICAgbGV0IG11dCB0b3RhbF9hY2Nlc3NlczogaTMyID0gMDsKICAgIGxldCBtdXQgcGFnZV9mYXVsdHM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGwxX2hpdHM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGwxX21pc3NlczogaTMyID0gMDsKICAgIGxldCBtdXQgbDJfaGl0czogaTMyID0gMDsKICAgIGxldCBtdXQgbDJfbWlzc2VzOiBpMzIgPSAwOwogICAgbGV0IG11dCB0bGJfaGl0czogaTMyID0gMDsKICAgIGxldCBtdXQgdGxiX21pc3NlczogaTMyID0gMDsKCiAgICAvLyBUTEIgKFRyYW5zbGF0aW9uIExvb2thc2lkZSBCdWZmZXIpIFNpbXVsYXRpb24KICAgIGxldCBtdXQgdGxiX3ZpcnR1YWxfdGFnczogW2kzMjsgMTZdID0gWy0xOyAxNl07CiAgICBsZXQgbXV0IHRsYl9waHlzaWNhbF9mcmFtZXM6IFtpMzI7IDE2XSA9IFstMTsgMTZdOwogICAgbGV0IG11dCB0bGJfdmFsaWQ6IFtib29sOyAxNl0gPSBbZmFsc2U7IDE2XTsKICAgIGxldCBtdXQgdGxiX2xydV9jb3VudGVyczogW2kzMjsgMTZdID0gWzA7IDE2XTsKCiAgICAvLyBNZW1vcnkgRnJhZ21lbnRhdGlvbiBUcmFja2luZwogICAgbGV0IG11dCBmcmVlX2ZyYW1lX2xpc3Q6IFtpMzI7IDY0XSA9IFswOyA2NF07IC8vIExpc3Qgb2YgZnJlZSBmcmFtZXMKICAgIGxldCBtdXQgZnJlZV9mcmFtZV9jb3VudDogaTMyID0gbnVtX3BoeXNpY2FsX2ZyYW1lczsKICAgIGxldCBtdXQgZnJhZ21lbnRhdGlvbl9zY29yZTogaTMyID0gMDsKCiAgICAvLyBJbml0aWFsaXplIGZyZWUgZnJhbWUgbGlzdAogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBudW1fcGh5c2ljYWxfZnJhbWVzKSB7CiAgICAgICAgZnJlZV9mcmFtZV9saXN0W2kgYXMgdXNpemVdID0gaTsKICAgICAgICBmcmFtZV9hbGxvY2F0aW9uX3RhYmxlW2kgYXMgdXNpemVdID0gMDsgLy8gMCA9IGZyZWUsIDEgPSBhbGxvY2F0ZWQKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gQ29tcGxleCBtZW1vcnkgYWNjZXNzIHBhdHRlcm4gc2ltdWxhdGlvbgogICAgbGV0IGFjY2Vzc19wYXR0ZXJuczogaTMyID0gNTAwMDsKICAgIGxldCBtdXQgYWNjZXNzX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBjdXJyZW50X3RpbWU6IGkzMiA9IDA7CgogICAgd2hpbGUgKGFjY2Vzc19jb3VudCA8IGFjY2Vzc19wYXR0ZXJucykgewogICAgICAgIGN1cnJlbnRfdGltZSA9IGN1cnJlbnRfdGltZSArIDE7CgogICAgICAgIC8vIEdlbmVyYXRlIGNvbXBsZXggbWVtb3J5IGFjY2VzcyBwYXR0ZXJucwogICAgICAgIGxldCB2aXJ0dWFsX2FkZHJlc3M6IGkzMiA9IGdlbmVyYXRlX21lbW9yeV9hY2Nlc3NfcGF0dGVybihhY2Nlc3NfY291bnQsIGFjY2Vzc19wYXR0ZXJucyk7CiAgICAgICAgbGV0IHZpcnR1YWxfcGFnZTogaTMyID0gdmlydHVhbF9hZGRyZXNzIC8gcGFnZV9zaXplOwogICAgICAgIGxldCBwYWdlX29mZnNldDogaTMyID0gdmlydHVhbF9hZGRyZXNzICUgcGFnZV9zaXplOwoKICAgICAgICB0b3RhbF9hY2Nlc3NlcyA9IHRvdGFsX2FjY2Vzc2VzICsgMTsKCiAgICAgICAgLy8gUmVjb3JkIGFjY2VzcyBpbiBoaXN0b3J5IGZvciB3b3JraW5nIHNldCBjYWxjdWxhdGlvbgogICAgICAgIGFjY2Vzc19oaXN0b3J5W2hpc3RvcnlfaGVhZCBhcyB1c2l6ZV0gPSB2aXJ0dWFsX3BhZ2U7CiAgICAgICAgaGlzdG9yeV9oZWFkID0gKGhpc3RvcnlfaGVhZCArIDEpICUgMTAwMDsKCiAgICAgICAgLy8gVExCIExvb2t1cAogICAgICAgIGxldCB0bGJfaGl0OiBib29sID0gbG9va3VwX3RsYih2aXJ0dWFsX3BhZ2UsICZ0bGJfdmlydHVhbF90YWdzLCAmdGxiX3ZhbGlkKTsKICAgICAgICBsZXQgbXV0IHBoeXNpY2FsX2ZyYW1lOiBpMzIgPSAtMTsKICAgICAgICBpZiAodGxiX2hpdCkgewogICAgICAgICAgICB0bGJfaGl0cyA9IHRsYl9oaXRzICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0bGJfbWlzc2VzID0gdGxiX21pc3NlcyArIDE7CgogICAgICAgICAgICAvLyBQYWdlIFRhYmxlIFdhbGsKICAgICAgICAgICAgbGV0IHBhZ2VfZGlyX2luZGV4OiBpMzIgPSB2aXJ0dWFsX3BhZ2UgLyAxNjsKICAgICAgICAgICAgbGV0IHBhZ2VfdGFibGVfaW5kZXg6IGkzMiA9IHZpcnR1YWxfcGFnZSAlIDE2OwoKICAgICAgICAgICAgbGV0IHBhZ2VfdGFibGVfZW50cnk6IGkzMiA9CiAgICAgICAgICAgICAgICBwYWdlX3RhYmxlc1twYWdlX2Rpcl9pbmRleCBhcyB1c2l6ZV1bcGFnZV90YWJsZV9pbmRleCBhcyB1c2l6ZV07CgogICAgICAgICAgICBpZiAocGFnZV90YWJsZV9lbnRyeSA+IDApIHsKICAgICAgICAgICAgICAgIC8vIFBhZ2UgaXMgbWFwcGVkCiAgICAgICAgICAgICAgICBwaHlzaWNhbF9mcmFtZSA9IHBhZ2VfdGFibGVfZW50cnkgLSAxOyAvLyBDb252ZXJ0IGZyb20gMS1iYXNlZCB0byAwLWJhc2VkCgogICAgICAgICAgICAgICAgLy8gVXBkYXRlIHBhZ2UgYWNjZXNzIGluZm9ybWF0aW9uCiAgICAgICAgICAgICAgICByZWZlcmVuY2VfYml0c1t2aXJ0dWFsX3BhZ2UgYXMgdXNpemVdID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGxydV9jb3VudGVyW3ZpcnR1YWxfcGFnZSBhcyB1c2l6ZV0gPSBjdXJyZW50X3RpbWU7CgogICAgICAgICAgICAgICAgLy8gVXBkYXRlIFRMQgogICAgICAgICAgICAgICAgdXBkYXRlX3RsYigKICAgICAgICAgICAgICAgICAgICB2aXJ0dWFsX3BhZ2UsCiAgICAgICAgICAgICAgICAgICAgcGh5c2ljYWxfZnJhbWUsCiAgICAgICAgICAgICAgICAgICAgJm11dCB0bGJfdmlydHVhbF90YWdzLAogICAgICAgICAgICAgICAgICAgICZtdXQgdGxiX3BoeXNpY2FsX2ZyYW1lcywKICAgICAgICAgICAgICAgICAgICAmbXV0IHRsYl92YWxpZCwKICAgICAgICAgICAgICAgICAgICAmbXV0IHRsYl9scnVfY291bnRlcnMsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gUGFnZSBmYXVsdCEgTmVlZCB0byBhbGxvY2F0ZSBhIGZyYW1lCiAgICAgICAgICAgICAgICBwYWdlX2ZhdWx0cyA9IHBhZ2VfZmF1bHRzICsgMTsKCiAgICAgICAgICAgICAgICBpZiAoZnJlZV9mcmFtZV9jb3VudCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAvLyBBbGxvY2F0ZSBhIGZyZWUgZnJhbWUKICAgICAgICAgICAgICAgICAgICBwaHlzaWNhbF9mcmFtZSA9IGFsbG9jYXRlX2ZyZWVfZnJhbWUoCiAgICAgICAgICAgICAgICAgICAgICAgICZmcmVlX2ZyYW1lX2xpc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICZtdXQgZnJlZV9mcmFtZV9jb3VudCwKICAgICAgICAgICAgICAgICAgICAgICAgJm11dCBmcmFtZV9hbGxvY2F0aW9uX3RhYmxlLAogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vIE5lZWQgdG8gdXNlIHBhZ2UgcmVwbGFjZW1lbnQgYWxnb3JpdGhtCiAgICAgICAgICAgICAgICAgICAgcGh5c2ljYWxfZnJhbWUgPSBwYWdlX3JlcGxhY2VtZW50X2FsZ29yaXRobSgKICAgICAgICAgICAgICAgICAgICAgICAgJnBhZ2VfdGFibGVzLAogICAgICAgICAgICAgICAgICAgICAgICAmcmV2ZXJzZV9tYXBwaW5nLAogICAgICAgICAgICAgICAgICAgICAgICAmbXV0IHJlZmVyZW5jZV9iaXRzLAogICAgICAgICAgICAgICAgICAgICAgICAmbW9kaWZ5X2JpdHMsCiAgICAgICAgICAgICAgICAgICAgICAgICZtdXQgY2xvY2tfaGFuZCwKICAgICAgICAgICAgICAgICAgICAgICAgJmxydV9jb3VudGVyLAogICAgICAgICAgICAgICAgICAgICAgICAmYWNjZXNzX2hpc3RvcnksCiAgICAgICAgICAgICAgICAgICAgICAgIGhpc3RvcnlfaGVhZCwKICAgICAgICAgICAgICAgICAgICAgICAgd29ya2luZ19zZXRfd2luZG93LAogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3RpbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIGFjY2Vzc19jb3VudCwKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChwaHlzaWNhbF9mcmFtZSA+PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gTWFwIHRoZSBwYWdlIHRvIHRoZSBmcmFtZQogICAgICAgICAgICAgICAgICAgIHBhZ2VfdGFibGVzW3BhZ2VfZGlyX2luZGV4IGFzIHVzaXplXVtwYWdlX3RhYmxlX2luZGV4IGFzIHVzaXplXSA9CiAgICAgICAgICAgICAgICAgICAgICAgIHBoeXNpY2FsX2ZyYW1lICsgMTsgLy8gMS1iYXNlZAogICAgICAgICAgICAgICAgICAgIHJldmVyc2VfbWFwcGluZ1twaHlzaWNhbF9mcmFtZSBhcyB1c2l6ZV0gPSB2aXJ0dWFsX3BhZ2U7CiAgICAgICAgICAgICAgICAgICAgcmVmZXJlbmNlX2JpdHNbdmlydHVhbF9wYWdlIGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgbHJ1X2NvdW50ZXJbdmlydHVhbF9wYWdlIGFzIHVzaXplXSA9IGN1cnJlbnRfdGltZTsKICAgICAgICAgICAgICAgICAgICBmcmFtZV9hbGxvY2F0aW9uX3RhYmxlW3BoeXNpY2FsX2ZyYW1lIGFzIHVzaXplXSA9IDE7IC8vIE1hcmsgYXMgYWxsb2NhdGVkCgogICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBUTEIKICAgICAgICAgICAgICAgICAgICB1cGRhdGVfdGxiKAogICAgICAgICAgICAgICAgICAgICAgICB2aXJ0dWFsX3BhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgIHBoeXNpY2FsX2ZyYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAmbXV0IHRsYl92aXJ0dWFsX3RhZ3MsCiAgICAgICAgICAgICAgICAgICAgICAgICZtdXQgdGxiX3BoeXNpY2FsX2ZyYW1lcywKICAgICAgICAgICAgICAgICAgICAgICAgJm11dCB0bGJfdmFsaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICZtdXQgdGxiX2xydV9jb3VudGVycywKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBTaW11bGF0ZSBwYWdlIGxvYWRpbmcgdGltZSBwZW5hbHR5CiAgICAgICAgICAgIGN1cnJlbnRfdGltZSA9IGN1cnJlbnRfdGltZSArIDEwMDsgLy8gUGFnZSBmYXVsdCBwZW5hbHR5CiAgICAgICAgfQoKICAgICAgICAvLyBTaW11bGF0ZSBjYWNoZSBhY2Nlc3MgaWYgd2UgaGF2ZSBhIHZhbGlkIHBoeXNpY2FsIGFkZHJlc3MKICAgICAgICBpZiAocGh5c2ljYWxfZnJhbWUgPj0gMCkgewogICAgICAgICAgICBsZXQgcGh5c2ljYWxfYWRkcmVzczogaTMyID0gcGh5c2ljYWxfZnJhbWUgKiBwYWdlX3NpemUgKyBwYWdlX29mZnNldDsKCiAgICAgICAgICAgIC8vIEwxIENhY2hlIEFjY2VzcwogICAgICAgICAgICBsZXQgbDFfaGl0OiBib29sID0gYWNjZXNzX2wxX2NhY2hlKAogICAgICAgICAgICAgICAgcGh5c2ljYWxfYWRkcmVzcywKICAgICAgICAgICAgICAgICZsMV9jYWNoZSwKICAgICAgICAgICAgICAgICZtdXQgbDFfdGFncywKICAgICAgICAgICAgICAgICZtdXQgbDFfdmFsaWQsCiAgICAgICAgICAgICAgICAmbXV0IGwxX2xydV9iaXRzLAogICAgICAgICAgICAgICAgY3VycmVudF90aW1lLAogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAobDFfaGl0KSB7CiAgICAgICAgICAgICAgICBsMV9oaXRzID0gbDFfaGl0cyArIDE7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBsMV9taXNzZXMgPSBsMV9taXNzZXMgKyAxOwoKICAgICAgICAgICAgICAgIC8vIEwyIENhY2hlIEFjY2VzcwogICAgICAgICAgICAgICAgbGV0IGwyX2hpdDogYm9vbCA9IGFjY2Vzc19sMl9jYWNoZSgKICAgICAgICAgICAgICAgICAgICBwaHlzaWNhbF9hZGRyZXNzLAogICAgICAgICAgICAgICAgICAgICZsMl9jYWNoZSwKICAgICAgICAgICAgICAgICAgICAmbXV0IGwyX3RhZ3MsCiAgICAgICAgICAgICAgICAgICAgJm11dCBsMl92YWxpZCwKICAgICAgICAgICAgICAgICAgICAmbXV0IGwyX2xydV9iaXRzLAogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfdGltZSwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBpZiAobDJfaGl0KSB7CiAgICAgICAgICAgICAgICAgICAgbDJfaGl0cyA9IGwyX2hpdHMgKyAxOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBsMl9taXNzZXMgPSBsMl9taXNzZXMgKyAxOwogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfdGltZSA9IGN1cnJlbnRfdGltZSArIDIwMDsgLy8gTWFpbiBtZW1vcnkgYWNjZXNzIHBlbmFsdHkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gU2ltdWxhdGUgd3JpdGUgb3BlcmF0aW9ucyAobWFyayBwYWdlcyBhcyBkaXJ0eSkKICAgICAgICBpZiAoYWNjZXNzX2NvdW50ICUgNCA9PSAwICYmIHZpcnR1YWxfcGFnZSA8IDI1NikgewogICAgICAgICAgICBtb2RpZnlfYml0c1t2aXJ0dWFsX3BhZ2UgYXMgdXNpemVdID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIC8vIFBlcmlvZGljIG1lbW9yeSBjb21wYWN0aW9uIGFuZCBkZWZyYWdtZW50YXRpb24KICAgICAgICBpZiAoYWNjZXNzX2NvdW50ICUgNTAwID09IDApIHsKICAgICAgICAgICAgZnJhZ21lbnRhdGlvbl9zY29yZSA9CiAgICAgICAgICAgICAgICBhbmFseXplX21lbW9yeV9mcmFnbWVudGF0aW9uKCZmcmFtZV9hbGxvY2F0aW9uX3RhYmxlLCBudW1fcGh5c2ljYWxfZnJhbWVzKTsKICAgICAgICAgICAgaWYgKGZyYWdtZW50YXRpb25fc2NvcmUgPiAzMCkgewogICAgICAgICAgICAgICAgY29tcGFjdF9tZW1vcnkoCiAgICAgICAgICAgICAgICAgICAgJm11dCBwYWdlX3RhYmxlcywKICAgICAgICAgICAgICAgICAgICAmbXV0IHJldmVyc2VfbWFwcGluZywKICAgICAgICAgICAgICAgICAgICAmbXV0IGZyYW1lX2FsbG9jYXRpb25fdGFibGUsCiAgICAgICAgICAgICAgICAgICAgJm11dCBmcmVlX2ZyYW1lX2xpc3QsCiAgICAgICAgICAgICAgICAgICAgJm11dCBmcmVlX2ZyYW1lX2NvdW50LAogICAgICAgICAgICAgICAgICAgIG51bV9waHlzaWNhbF9mcmFtZXMsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBXb3JraW5nIHNldCBhbmFseXNpcwogICAgICAgIGlmIChhY2Nlc3NfY291bnQgJSAxMDAgPT0gMCkgewogICAgICAgICAgICBsZXQgd29ya2luZ19zZXRfc2l6ZTogaTMyID0KICAgICAgICAgICAgICAgIGNhbGN1bGF0ZV93b3JraW5nX3NldF9zaXplKCZhY2Nlc3NfaGlzdG9yeSwgaGlzdG9yeV9oZWFkLCB3b3JraW5nX3NldF93aW5kb3cpOwogICAgICAgICAgICAvLyBBZGp1c3Qgd29ya2luZyBzZXQgd2luZG93IGJhc2VkIG9uIHJlY2VudCBiZWhhdmlvcgogICAgICAgICAgICBpZiAod29ya2luZ19zZXRfc2l6ZSA+IDQwKSB7CiAgICAgICAgICAgICAgICB3b3JraW5nX3NldF93aW5kb3cgPSB3b3JraW5nX3NldF93aW5kb3cgKyA1OwogICAgICAgICAgICB9IGVsc2UgaWYgKHdvcmtpbmdfc2V0X3NpemUgPCAyMCAmJiB3b3JraW5nX3NldF93aW5kb3cgPiAxMCkgewogICAgICAgICAgICAgICAgd29ya2luZ19zZXRfd2luZG93ID0gd29ya2luZ19zZXRfd2luZG93IC0gNTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gQWRhcHRpdmUgY2FjaGUgcG9saWN5IGFkanVzdG1lbnQKICAgICAgICBpZiAoYWNjZXNzX2NvdW50ICUgMjAwID09IDApIHsKICAgICAgICAgICAgYWRqdXN0X2NhY2hlX3BvbGljaWVzKAogICAgICAgICAgICAgICAgJm11dCBsMV9scnVfYml0cywKICAgICAgICAgICAgICAgICZtdXQgbDJfbHJ1X2JpdHMsCiAgICAgICAgICAgICAgICBsMV9oaXRzLAogICAgICAgICAgICAgICAgbDFfbWlzc2VzLAogICAgICAgICAgICAgICAgbDJfaGl0cywKICAgICAgICAgICAgICAgIGwyX21pc3NlcywKICAgICAgICAgICAgKTsKICAgICAgICB9CgogICAgICAgIGFjY2Vzc19jb3VudCA9IGFjY2Vzc19jb3VudCArIDE7CiAgICB9CgogICAgLy8gQ29tcGxleCBwZXJmb3JtYW5jZSBhbmFseXNpcwogICAgbGV0IHBhZ2VfZmF1bHRfcmF0ZTogaTMyID0gKHBhZ2VfZmF1bHRzICogMTAwKSAvIHRvdGFsX2FjY2Vzc2VzOwogICAgbGV0IGwxX2hpdF9yYXRlOiBpMzIgPSAobDFfaGl0cyAqIDEwMCkgLyB0b3RhbF9hY2Nlc3NlczsKICAgIGxldCBsMl9oaXRfcmF0ZTogaTMyID0gKGwyX2hpdHMgKiAxMDApIC8gdG90YWxfYWNjZXNzZXM7CiAgICBsZXQgdGxiX2hpdF9yYXRlOiBpMzIgPSAodGxiX2hpdHMgKiAxMDApIC8gdG90YWxfYWNjZXNzZXM7CgogICAgLy8gTWVtb3J5IHV0aWxpemF0aW9uIGFuYWx5c2lzCiAgICBsZXQgbWVtb3J5X3V0aWxpemF0aW9uOiBpMzIgPQogICAgICAgICgobnVtX3BoeXNpY2FsX2ZyYW1lcyAtIGZyZWVfZnJhbWVfY291bnQpICogMTAwKSAvIG51bV9waHlzaWNhbF9mcmFtZXM7CgogICAgLy8gQWR2YW5jZWQgbWV0cmljcyBjYWxjdWxhdGlvbgogICAgbGV0IGF2Z19tZW1vcnlfYWNjZXNzX3RpbWU6IGkzMiA9CiAgICAgICAgY2FsY3VsYXRlX2F2ZXJhZ2VfbWVtb3J5X2FjY2Vzc190aW1lKGwxX2hpdHMsIGwxX21pc3NlcywgbDJfaGl0cywgbDJfbWlzc2VzLCBwYWdlX2ZhdWx0cyk7CgogICAgbGV0IGZpbmFsX2ZyYWdtZW50YXRpb246IGkzMiA9CiAgICAgICAgYW5hbHl6ZV9tZW1vcnlfZnJhZ21lbnRhdGlvbigmZnJhbWVfYWxsb2NhdGlvbl90YWJsZSwgbnVtX3BoeXNpY2FsX2ZyYW1lcyk7CgogICAgLy8gT3V0cHV0IGNvbXByZWhlbnNpdmUgcmVzdWx0cwogICAgcHJpbnRsbkludChwYWdlX2ZhdWx0X3JhdGUpOwogICAgcHJpbnRsbkludChsMV9oaXRfcmF0ZSk7CiAgICBwcmludGxuSW50KGwyX2hpdF9yYXRlKTsKICAgIHByaW50bG5JbnQodGxiX2hpdF9yYXRlKTsKICAgIHByaW50bG5JbnQobWVtb3J5X3V0aWxpemF0aW9uKTsKICAgIHByaW50bG5JbnQoYXZnX21lbW9yeV9hY2Nlc3NfdGltZSk7CiAgICBwcmludGxuSW50KGZpbmFsX2ZyYWdtZW50YXRpb24pOwogICAgcHJpbnRsbkludCh3b3JraW5nX3NldF93aW5kb3cpOwogICAgZXhpdCgwKTsKfQoKLy8gR2VuZXJhdGUgY29tcGxleCBtZW1vcnkgYWNjZXNzIHBhdHRlcm5zIGZvciB0ZXN0aW5nCmZuIGdlbmVyYXRlX21lbW9yeV9hY2Nlc3NfcGF0dGVybihhY2Nlc3NfbnVtOiBpMzIsIHRvdGFsX2FjY2Vzc2VzOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgcGF0dGVybl90eXBlOiBpMzIgPSAoYWNjZXNzX251bSAvIDEwMCkgJSA2OwoKICAgIGlmIChwYXR0ZXJuX3R5cGUgPT0gMCkgewogICAgICAgIC8vIFNlcXVlbnRpYWwgYWNjZXNzIHBhdHRlcm4KICAgICAgICAoYWNjZXNzX251bSAqIDY0KSAlIDEwNDg1NzYKICAgIH0gZWxzZSBpZiAocGF0dGVybl90eXBlID09IDEpIHsKICAgICAgICAvLyBSYW5kb20gYWNjZXNzIHBhdHRlcm4KICAgICAgICAoKGFjY2Vzc19udW0gKiAxNyArIDIzKSAqIDEzMSArIDQ3KSAlIDEwNDg1NzYKICAgIH0gZWxzZSBpZiAocGF0dGVybl90eXBlID09IDIpIHsKICAgICAgICAvLyBTdHJpZGVkIGFjY2VzcyBwYXR0ZXJuCiAgICAgICAgKGFjY2Vzc19udW0gKiA1MTIpICUgMTA0ODU3NgogICAgfSBlbHNlIGlmIChwYXR0ZXJuX3R5cGUgPT0gMykgewogICAgICAgIC8vIExvY2FsaXR5LWJhc2VkIGFjY2VzcyBwYXR0ZXJuICg4MCUgbG9jYWwsIDIwJSByYW5kb20pCiAgICAgICAgbGV0IGJhc2VfYWRkcjogaTMyID0gKChhY2Nlc3NfbnVtIC8gNTApICogODE5MikgJSAxMDQ4NTc2OwogICAgICAgIGlmICgoYWNjZXNzX251bSAqIDcpICUgMTAgPCA4KSB7CiAgICAgICAgICAgIGJhc2VfYWRkciArICgoYWNjZXNzX251bSAqIDMpICUgMTAyNCkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAoKGFjY2Vzc19udW0gKiAxOSArIDM3KSAqIDExMykgJSAxMDQ4NTc2CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChwYXR0ZXJuX3R5cGUgPT0gNCkgewogICAgICAgIC8vIFdvcmtpbmcgc2V0IHBhdHRlcm4gKGNvbmNlbnRyYXRlIG9uIGEgZmV3IHBhZ2VzKQogICAgICAgIGxldCB3b3JraW5nX3NldF9iYXNlOiBpMzIgPSAoKGFjY2Vzc19udW0gLyAyMDApICogMTYzODQpICUgMTA0ODU3NjsKICAgICAgICB3b3JraW5nX3NldF9iYXNlICsgKChhY2Nlc3NfbnVtICogNSkgJSA0MDk2KQogICAgfSBlbHNlIHsKICAgICAgICAvLyBTcGFyc2UgYWNjZXNzIHBhdHRlcm4gKHdpZGUgZGlzdHJpYnV0aW9uKQogICAgICAgICgoYWNjZXNzX251bSAqIDk3ICsgMTEzKSAqIDIxMSArIDMwNykgJSAxMDQ4NTc2CiAgICB9Cn0KCi8vIFRMQiBsb29rdXAgZnVuY3Rpb24KZm4gbG9va3VwX3RsYih2aXJ0dWFsX3BhZ2U6IGkzMiwgdGxiX3RhZ3M6ICZbaTMyOyAxNl0sIHRsYl92YWxpZDogJltib29sOyAxNl0pIC0+IGJvb2wgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAxNikgewogICAgICAgIGlmICh0bGJfdmFsaWRbaSBhcyB1c2l6ZV0gJiYgdGxiX3RhZ3NbaSBhcyB1c2l6ZV0gPT0gdmlydHVhbF9wYWdlKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICBmYWxzZQp9CgovLyBVcGRhdGUgVExCIHdpdGggbmV3IHRyYW5zbGF0aW9uCmZuIHVwZGF0ZV90bGIoCiAgICB2aXJ0dWFsX3BhZ2U6IGkzMiwKICAgIHBoeXNpY2FsX2ZyYW1lOiBpMzIsCiAgICB0bGJfdGFnczogJm11dCBbaTMyOyAxNl0sCiAgICB0bGJfZnJhbWVzOiAmbXV0IFtpMzI7IDE2XSwKICAgIHRsYl92YWxpZDogJm11dCBbYm9vbDsgMTZdLAogICAgdGxiX2xydTogJm11dCBbaTMyOyAxNl0sCikgewogICAgLy8gRmluZCBMUlUgZW50cnkgdG8gcmVwbGFjZQogICAgbGV0IG11dCBscnVfaW5kZXg6IGkzMiA9IDA7CiAgICBsZXQgbXV0IG1pbl9jb3VudGVyOiBpMzIgPSB0bGJfbHJ1WzBdOwoKICAgIGxldCBtdXQgaTogaTMyID0gMTsKICAgIHdoaWxlIChpIDwgMTYpIHsKICAgICAgICBpZiAodGxiX2xydVtpIGFzIHVzaXplXSA8IG1pbl9jb3VudGVyKSB7CiAgICAgICAgICAgIG1pbl9jb3VudGVyID0gdGxiX2xydVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgbHJ1X2luZGV4ID0gaTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIFVwZGF0ZSB0aGUgTFJVIGVudHJ5CiAgICB0bGJfdGFnc1tscnVfaW5kZXggYXMgdXNpemVdID0gdmlydHVhbF9wYWdlOwogICAgdGxiX2ZyYW1lc1tscnVfaW5kZXggYXMgdXNpemVdID0gcGh5c2ljYWxfZnJhbWU7CiAgICB0bGJfdmFsaWRbbHJ1X2luZGV4IGFzIHVzaXplXSA9IHRydWU7CgogICAgLy8gVXBkYXRlIGFsbCBMUlUgY291bnRlcnMKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCAxNikgewogICAgICAgIGlmIChpID09IGxydV9pbmRleCkgewogICAgICAgICAgICB0bGJfbHJ1W2kgYXMgdXNpemVdID0gMTAwMDsgLy8gSGlnaCBwcmlvcml0eQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRsYl9scnVbaSBhcyB1c2l6ZV0gPSB0bGJfbHJ1W2kgYXMgdXNpemVdIC0gMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBBbGxvY2F0ZSBhIGZyZWUgZnJhbWUgZnJvbSB0aGUgZnJlZSBsaXN0CmZuIGFsbG9jYXRlX2ZyZWVfZnJhbWUoCiAgICBmcmVlX2xpc3Q6ICZbaTMyOyA2NF0sCiAgICBmcmVlX2NvdW50OiAmbXV0IGkzMiwKICAgIGFsbG9jYXRpb25fdGFibGU6ICZtdXQgW2kzMjsgNjRdLAopIC0+IGkzMiB7CiAgICBpZiAoKmZyZWVfY291bnQgPD0gMCkgewogICAgICAgIHJldHVybiAtMTsgLy8gTm8gZnJlZSBmcmFtZXMKICAgIH0KCiAgICAqZnJlZV9jb3VudCA9ICpmcmVlX2NvdW50IC0gMTsKICAgIGxldCBmcmFtZTogaTMyID0gZnJlZV9saXN0WypmcmVlX2NvdW50IGFzIHVzaXplXTsKICAgIGFsbG9jYXRpb25fdGFibGVbZnJhbWUgYXMgdXNpemVdID0gMTsgLy8gTWFyayBhcyBhbGxvY2F0ZWQKICAgIGZyYW1lCn0KCi8vIEFkdmFuY2VkIHBhZ2UgcmVwbGFjZW1lbnQgYWxnb3JpdGhtIGNvbWJpbmluZyBtdWx0aXBsZSBzdHJhdGVnaWVzCmZuIHBhZ2VfcmVwbGFjZW1lbnRfYWxnb3JpdGhtKAogICAgcGFnZV90YWJsZXM6ICZbW2kzMjsgMTZdOyAxNl0sCiAgICByZXZlcnNlX21hcHBpbmc6ICZbaTMyOyA2NF0sCiAgICByZWZlcmVuY2VfYml0czogJm11dCBbYm9vbDsgMjU2XSwKICAgIG1vZGlmeV9iaXRzOiAmW2Jvb2w7IDI1Nl0sCiAgICBjbG9ja19oYW5kOiAmbXV0IGkzMiwKICAgIGxydV9jb3VudGVyOiAmW2kzMjsgMjU2XSwKICAgIGFjY2Vzc19oaXN0b3J5OiAmW2kzMjsgMTAwMF0sCiAgICBoaXN0b3J5X2hlYWQ6IGkzMiwKICAgIHdvcmtpbmdfc2V0X3dpbmRvdzogaTMyLAogICAgY3VycmVudF90aW1lOiBpMzIsCiAgICBhY2Nlc3NfbnVtOiBpMzIsCikgLT4gaTMyIHsKICAgIC8vIENob29zZSByZXBsYWNlbWVudCBhbGdvcml0aG0gYmFzZWQgb24gc3lzdGVtIHN0YXRlCiAgICBsZXQgYWxnb3JpdGhtX2Nob2ljZTogaTMyID0gKGFjY2Vzc19udW0gLyA1MCkgJSA0OwoKICAgIGlmIChhbGdvcml0aG1fY2hvaWNlID09IDApIHsKICAgICAgICAvLyBFbmhhbmNlZCBDTE9DSyBhbGdvcml0aG0KICAgICAgICBlbmhhbmNlZF9jbG9ja19yZXBsYWNlbWVudChyZXZlcnNlX21hcHBpbmcsIHJlZmVyZW5jZV9iaXRzLCBtb2RpZnlfYml0cywgY2xvY2tfaGFuZCkKICAgIH0gZWxzZSBpZiAoYWxnb3JpdGhtX2Nob2ljZSA9PSAxKSB7CiAgICAgICAgLy8gTFJVIHJlcGxhY2VtZW50CiAgICAgICAgbHJ1X3JlcGxhY2VtZW50KHJldmVyc2VfbWFwcGluZywgbHJ1X2NvdW50ZXIsIGN1cnJlbnRfdGltZSkKICAgIH0gZWxzZSBpZiAoYWxnb3JpdGhtX2Nob2ljZSA9PSAyKSB7CiAgICAgICAgLy8gV29ya2luZyBzZXQgYmFzZWQgcmVwbGFjZW1lbnQKICAgICAgICB3b3JraW5nX3NldF9yZXBsYWNlbWVudCgKICAgICAgICAgICAgcmV2ZXJzZV9tYXBwaW5nLAogICAgICAgICAgICBhY2Nlc3NfaGlzdG9yeSwKICAgICAgICAgICAgaGlzdG9yeV9oZWFkLAogICAgICAgICAgICB3b3JraW5nX3NldF93aW5kb3csCiAgICAgICAgKQogICAgfSBlbHNlIHsKICAgICAgICAvLyBBZGFwdGl2ZSBhbGdvcml0aG0gKGNvbWJpbmVzIG11bHRpcGxlIGZhY3RvcnMpCiAgICAgICAgYWRhcHRpdmVfcmVwbGFjZW1lbnQoCiAgICAgICAgICAgIHJldmVyc2VfbWFwcGluZywKICAgICAgICAgICAgcmVmZXJlbmNlX2JpdHMsCiAgICAgICAgICAgIG1vZGlmeV9iaXRzLAogICAgICAgICAgICBscnVfY291bnRlciwKICAgICAgICAgICAgY3VycmVudF90aW1lLAogICAgICAgICAgICBhY2Nlc3NfaGlzdG9yeSwKICAgICAgICAgICAgaGlzdG9yeV9oZWFkLAogICAgICAgICAgICB3b3JraW5nX3NldF93aW5kb3csCiAgICAgICAgKQogICAgfQp9CgovLyBFbmhhbmNlZCBDTE9DSyBhbGdvcml0aG0gd2l0aCBzZWNvbmQgY2hhbmNlIGZvciBkaXJ0eSBwYWdlcwpmbiBlbmhhbmNlZF9jbG9ja19yZXBsYWNlbWVudCgKICAgIHJldmVyc2VfbWFwcGluZzogJltpMzI7IDY0XSwKICAgIHJlZmVyZW5jZV9iaXRzOiAmbXV0IFtib29sOyAyNTZdLAogICAgbW9kaWZ5X2JpdHM6ICZbYm9vbDsgMjU2XSwKICAgIGNsb2NrX2hhbmQ6ICZtdXQgaTMyLAopIC0+IGkzMiB7CiAgICBsZXQgc3RhcnRfaGFuZDogaTMyID0gKmNsb2NrX2hhbmQ7CiAgICBsZXQgbXV0IHBhc3NlczogaTMyID0gMDsKCiAgICB3aGlsZSAocGFzc2VzIDwgMykgewogICAgICAgIC8vIE1heGltdW0gMyBwYXNzZXMgdG8gYXZvaWQgaW5maW5pdGUgbG9vcAogICAgICAgIGxldCBmcmFtZTogaTMyID0gKmNsb2NrX2hhbmQ7CiAgICAgICAgbGV0IHZpcnR1YWxfcGFnZTogaTMyID0gcmV2ZXJzZV9tYXBwaW5nW2ZyYW1lIGFzIHVzaXplXTsKCiAgICAgICAgaWYgKHZpcnR1YWxfcGFnZSA+PSAwICYmIHZpcnR1YWxfcGFnZSA8IDI1NikgewogICAgICAgICAgICBpZiAoIXJlZmVyZW5jZV9iaXRzW3ZpcnR1YWxfcGFnZSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIGlmICghbW9kaWZ5X2JpdHNbdmlydHVhbF9wYWdlIGFzIHVzaXplXSB8fCBwYXNzZXMgPj0gMikgewogICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIHZpY3RpbTogY2xlYW4gcGFnZSBvciBkaXJ0eSBwYWdlIGFmdGVyIDIgcGFzc2VzCiAgICAgICAgICAgICAgICAgICAgKmNsb2NrX2hhbmQgPSAoKmNsb2NrX2hhbmQgKyAxKSAlIDY0OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBmcmFtZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlZmVyZW5jZV9iaXRzW3ZpcnR1YWxfcGFnZSBhcyB1c2l6ZV0gPSBmYWxzZTsgLy8gR2l2ZSBzZWNvbmQgY2hhbmNlCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICpjbG9ja19oYW5kID0gKCpjbG9ja19oYW5kICsgMSkgJSA2NDsKICAgICAgICBpZiAoKmNsb2NrX2hhbmQgPT0gc3RhcnRfaGFuZCkgewogICAgICAgICAgICBwYXNzZXMgPSBwYXNzZXMgKyAxOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBGYWxsYmFjazogcmV0dXJuIGN1cnJlbnQgY2xvY2sgaGFuZCBwb3NpdGlvbgogICAgbGV0IHZpY3RpbTogaTMyID0gKmNsb2NrX2hhbmQ7CiAgICAqY2xvY2tfaGFuZCA9ICgqY2xvY2tfaGFuZCArIDEpICUgNjQ7CiAgICB2aWN0aW0KfQoKLy8gTFJVIHJlcGxhY2VtZW50IGFsZ29yaXRobQpmbiBscnVfcmVwbGFjZW1lbnQoCiAgICByZXZlcnNlX21hcHBpbmc6ICZbaTMyOyA2NF0sCiAgICBscnVfY291bnRlcjogJltpMzI7IDI1Nl0sCiAgICBjdXJyZW50X3RpbWU6IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IG11dCB2aWN0aW1fZnJhbWU6IGkzMiA9IDA7CiAgICBsZXQgbXV0IG9sZGVzdF90aW1lOiBpMzIgPSBjdXJyZW50X3RpbWUgKyAxOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgNjQpIHsKICAgICAgICBsZXQgdmlydHVhbF9wYWdlOiBpMzIgPSByZXZlcnNlX21hcHBpbmdbaSBhcyB1c2l6ZV07CiAgICAgICAgaWYgKHZpcnR1YWxfcGFnZSA+PSAwICYmIHZpcnR1YWxfcGFnZSA8IDI1NikgewogICAgICAgICAgICBpZiAobHJ1X2NvdW50ZXJbdmlydHVhbF9wYWdlIGFzIHVzaXplXSA8IG9sZGVzdF90aW1lKSB7CiAgICAgICAgICAgICAgICBvbGRlc3RfdGltZSA9IGxydV9jb3VudGVyW3ZpcnR1YWxfcGFnZSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICB2aWN0aW1fZnJhbWUgPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICB2aWN0aW1fZnJhbWUKfQoKLy8gV29ya2luZyBzZXQgYmFzZWQgcmVwbGFjZW1lbnQKZm4gd29ya2luZ19zZXRfcmVwbGFjZW1lbnQoCiAgICByZXZlcnNlX21hcHBpbmc6ICZbaTMyOyA2NF0sCiAgICBhY2Nlc3NfaGlzdG9yeTogJltpMzI7IDEwMDBdLAogICAgaGlzdG9yeV9oZWFkOiBpMzIsCiAgICB3aW5kb3dfc2l6ZTogaTMyLAopIC0+IGkzMiB7CiAgICAvLyBCdWlsZCB3b3JraW5nIHNldCBmcm9tIHJlY2VudCBhY2Nlc3NlcwogICAgbGV0IG11dCB3b3JraW5nX3NldDogW2Jvb2w7IDI1Nl0gPSBbZmFsc2U7IDI1Nl07CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICBsZXQgc3RhcnRfcG9zOiBpMzIgPSBpZiAoaGlzdG9yeV9oZWFkID49IHdpbmRvd19zaXplKSB7CiAgICAgICAgaGlzdG9yeV9oZWFkIC0gd2luZG93X3NpemUKICAgIH0gZWxzZSB7CiAgICAgICAgMTAwMCAtICh3aW5kb3dfc2l6ZSAtIGhpc3RvcnlfaGVhZCkKICAgIH07CgogICAgbGV0IG11dCBwb3M6IGkzMiA9IHN0YXJ0X3BvczsKICAgIHdoaWxlIChpIDwgd2luZG93X3NpemUpIHsKICAgICAgICBpZiAocG9zID49IDAgJiYgcG9zIDwgMTAwMCkgewogICAgICAgICAgICBsZXQgcGFnZTogaTMyID0gYWNjZXNzX2hpc3RvcnlbcG9zIGFzIHVzaXplXTsKICAgICAgICAgICAgaWYgKHBhZ2UgPj0gMCAmJiBwYWdlIDwgMjU2KSB7CiAgICAgICAgICAgICAgICB3b3JraW5nX3NldFtwYWdlIGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcG9zID0gKHBvcyArIDEpICUgMTAwMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gRmluZCBmcmFtZSB3aXRoIHBhZ2Ugbm90IGluIHdvcmtpbmcgc2V0CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgNjQpIHsKICAgICAgICBsZXQgdmlydHVhbF9wYWdlOiBpMzIgPSByZXZlcnNlX21hcHBpbmdbaSBhcyB1c2l6ZV07CiAgICAgICAgaWYgKHZpcnR1YWxfcGFnZSA+PSAwICYmIHZpcnR1YWxfcGFnZSA8IDI1NiAmJiAhd29ya2luZ19zZXRbdmlydHVhbF9wYWdlIGFzIHVzaXplXSkgewogICAgICAgICAgICByZXR1cm4gaTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIElmIGFsbCBwYWdlcyBhcmUgaW4gd29ya2luZyBzZXQsIGZhbGwgYmFjayB0byBzaW1wbGUgcmVwbGFjZW1lbnQKICAgIChoaXN0b3J5X2hlYWQgKiA3KSAlIDY0Cn0KCi8vIEFkYXB0aXZlIHJlcGxhY2VtZW50IGFsZ29yaXRobQpmbiBhZGFwdGl2ZV9yZXBsYWNlbWVudCgKICAgIHJldmVyc2VfbWFwcGluZzogJltpMzI7IDY0XSwKICAgIHJlZmVyZW5jZV9iaXRzOiAmW2Jvb2w7IDI1Nl0sCiAgICBtb2RpZnlfYml0czogJltib29sOyAyNTZdLAogICAgbHJ1X2NvdW50ZXI6ICZbaTMyOyAyNTZdLAogICAgY3VycmVudF90aW1lOiBpMzIsCiAgICBhY2Nlc3NfaGlzdG9yeTogJltpMzI7IDEwMDBdLAogICAgaGlzdG9yeV9oZWFkOiBpMzIsCiAgICB3aW5kb3dfc2l6ZTogaTMyLAopIC0+IGkzMiB7CiAgICBsZXQgbXV0IGJlc3RfZnJhbWU6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGJlc3Rfc2NvcmU6IGkzMiA9IC0xOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgNjQpIHsKICAgICAgICBsZXQgdmlydHVhbF9wYWdlOiBpMzIgPSByZXZlcnNlX21hcHBpbmdbaSBhcyB1c2l6ZV07CiAgICAgICAgaWYgKHZpcnR1YWxfcGFnZSA+PSAwICYmIHZpcnR1YWxfcGFnZSA8IDI1NikgewogICAgICAgICAgICBsZXQgbXV0IHNjb3JlOiBpMzIgPSAwOwoKICAgICAgICAgICAgLy8gRmFjdG9yIDE6IEFnZSAob2xkZXIgaXMgYmV0dGVyIGZvciByZXBsYWNlbWVudCkKICAgICAgICAgICAgbGV0IGFnZTogaTMyID0gY3VycmVudF90aW1lIC0gbHJ1X2NvdW50ZXJbdmlydHVhbF9wYWdlIGFzIHVzaXplXTsKICAgICAgICAgICAgc2NvcmUgPSBzY29yZSArIGFnZSAvIDEwOwoKICAgICAgICAgICAgLy8gRmFjdG9yIDI6IFJlZmVyZW5jZSBiaXQgKHVucmVmZXJlbmNlZCBpcyBiZXR0ZXIpCiAgICAgICAgICAgIGlmICghcmVmZXJlbmNlX2JpdHNbdmlydHVhbF9wYWdlIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgc2NvcmUgPSBzY29yZSArIDUwOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBGYWN0b3IgMzogRGlydHkgYml0IChjbGVhbiBpcyBiZXR0ZXIpCiAgICAgICAgICAgIGlmICghbW9kaWZ5X2JpdHNbdmlydHVhbF9wYWdlIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgc2NvcmUgPSBzY29yZSArIDMwOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBGYWN0b3IgNDogV29ya2luZyBzZXQgbWVtYmVyc2hpcCAobm9uLW1lbWJlciBpcyBiZXR0ZXIpCiAgICAgICAgICAgIGxldCBpbl93b3JraW5nX3NldDogYm9vbCA9IGNoZWNrX3dvcmtpbmdfc2V0X21lbWJlcnNoaXAoCiAgICAgICAgICAgICAgICB2aXJ0dWFsX3BhZ2UsCiAgICAgICAgICAgICAgICBhY2Nlc3NfaGlzdG9yeSwKICAgICAgICAgICAgICAgIGhpc3RvcnlfaGVhZCwKICAgICAgICAgICAgICAgIHdpbmRvd19zaXplLAogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoIWluX3dvcmtpbmdfc2V0KSB7CiAgICAgICAgICAgICAgICBzY29yZSA9IHNjb3JlICsgNDA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChzY29yZSA+IGJlc3Rfc2NvcmUpIHsKICAgICAgICAgICAgICAgIGJlc3Rfc2NvcmUgPSBzY29yZTsKICAgICAgICAgICAgICAgIGJlc3RfZnJhbWUgPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBiZXN0X2ZyYW1lCn0KCi8vIENoZWNrIGlmIHBhZ2UgaXMgaW4gd29ya2luZyBzZXQKZm4gY2hlY2tfd29ya2luZ19zZXRfbWVtYmVyc2hpcCgKICAgIHBhZ2U6IGkzMiwKICAgIGFjY2Vzc19oaXN0b3J5OiAmW2kzMjsgMTAwMF0sCiAgICBoaXN0b3J5X2hlYWQ6IGkzMiwKICAgIHdpbmRvd19zaXplOiBpMzIsCikgLT4gYm9vbCB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICBsZXQgc3RhcnRfcG9zOiBpMzIgPSBpZiAoaGlzdG9yeV9oZWFkID49IHdpbmRvd19zaXplKSB7CiAgICAgICAgaGlzdG9yeV9oZWFkIC0gd2luZG93X3NpemUKICAgIH0gZWxzZSB7CiAgICAgICAgMTAwMCAtICh3aW5kb3dfc2l6ZSAtIGhpc3RvcnlfaGVhZCkKICAgIH07CgogICAgbGV0IG11dCBwb3M6IGkzMiA9IHN0YXJ0X3BvczsKICAgIHdoaWxlIChpIDwgd2luZG93X3NpemUpIHsKICAgICAgICBpZiAocG9zID49IDAgJiYgcG9zIDwgMTAwMCAmJiBhY2Nlc3NfaGlzdG9yeVtwb3MgYXMgdXNpemVdID09IHBhZ2UpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHBvcyA9IChwb3MgKyAxKSAlIDEwMDA7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgZmFsc2UKfQoKLy8gTDEgQ2FjaGUgYWNjZXNzIHNpbXVsYXRpb24KZm4gYWNjZXNzX2wxX2NhY2hlKAogICAgYWRkcmVzczogaTMyLAogICAgY2FjaGU6ICZbW2kzMjsgNF07IDY0XSwKICAgIHRhZ3M6ICZtdXQgW1tpMzI7IDRdOyA2NF0sCiAgICB2YWxpZDogJm11dCBbW2Jvb2w7IDRdOyA2NF0sCiAgICBscnVfYml0czogJm11dCBbW2kzMjsgNF07IDY0XSwKICAgIHRpbWU6IGkzMiwKKSAtPiBib29sIHsKICAgIGxldCBzZXRfaW5kZXg6IGkzMiA9IChhZGRyZXNzIC8gNjQpICUgNjQ7CiAgICBsZXQgdGFnOiBpMzIgPSAoYWRkcmVzcyAvIDY0KSAvIDY0OwoKICAgIC8vIENoZWNrIGZvciBoaXQKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgNCkgewogICAgICAgIGlmICh2YWxpZFtzZXRfaW5kZXggYXMgdXNpemVdW2kgYXMgdXNpemVdICYmIHRhZ3Nbc2V0X2luZGV4IGFzIHVzaXplXVtpIGFzIHVzaXplXSA9PSB0YWcpIHsKICAgICAgICAgICAgLy8gQ2FjaGUgaGl0IC0gdXBkYXRlIExSVQogICAgICAgICAgICB1cGRhdGVfY2FjaGVfbHJ1KGxydV9iaXRzLCBzZXRfaW5kZXgsIGksIHRpbWUsIDQpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIENhY2hlIG1pc3MgLSBmaW5kIExSVSB3YXkgdG8gcmVwbGFjZQogICAgbGV0IHZpY3RpbV93YXk6IGkzMiA9IGZpbmRfbHJ1X3dheShscnVfYml0cywgc2V0X2luZGV4LCA0KTsKICAgIHRhZ3Nbc2V0X2luZGV4IGFzIHVzaXplXVt2aWN0aW1fd2F5IGFzIHVzaXplXSA9IHRhZzsKICAgIHZhbGlkW3NldF9pbmRleCBhcyB1c2l6ZV1bdmljdGltX3dheSBhcyB1c2l6ZV0gPSB0cnVlOwogICAgdXBkYXRlX2NhY2hlX2xydShscnVfYml0cywgc2V0X2luZGV4LCB2aWN0aW1fd2F5LCB0aW1lLCA0KTsKCiAgICBmYWxzZQp9CgovLyBMMiBDYWNoZSBhY2Nlc3Mgc2ltdWxhdGlvbgpmbiBhY2Nlc3NfbDJfY2FjaGUoCiAgICBhZGRyZXNzOiBpMzIsCiAgICBjYWNoZTogJltbaTMyOyA4XTsgMTI4XSwKICAgIHRhZ3M6ICZtdXQgW1tpMzI7IDhdOyAxMjhdLAogICAgdmFsaWQ6ICZtdXQgW1tib29sOyA4XTsgMTI4XSwKICAgIGxydV9iaXRzOiAmbXV0IFtbaTMyOyA4XTsgMTI4XSwKICAgIHRpbWU6IGkzMiwKKSAtPiBib29sIHsKICAgIGxldCBzZXRfaW5kZXg6IGkzMiA9IChhZGRyZXNzIC8gNjQpICUgMTI4OwogICAgbGV0IHRhZzogaTMyID0gKGFkZHJlc3MgLyA2NCkgLyAxMjg7CgogICAgLy8gQ2hlY2sgZm9yIGhpdAogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCA4KSB7CiAgICAgICAgaWYgKHZhbGlkW3NldF9pbmRleCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gJiYgdGFnc1tzZXRfaW5kZXggYXMgdXNpemVdW2kgYXMgdXNpemVdID09IHRhZykgewogICAgICAgICAgICAvLyBDYWNoZSBoaXQgLSB1cGRhdGUgTFJVCiAgICAgICAgICAgIHVwZGF0ZV9jYWNoZV9scnVfOHdheShscnVfYml0cywgc2V0X2luZGV4LCBpLCB0aW1lKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBDYWNoZSBtaXNzIC0gZmluZCBMUlUgd2F5IHRvIHJlcGxhY2UKICAgIGxldCB2aWN0aW1fd2F5OiBpMzIgPSBmaW5kX2xydV93YXlfOChscnVfYml0cywgc2V0X2luZGV4KTsKICAgIHRhZ3Nbc2V0X2luZGV4IGFzIHVzaXplXVt2aWN0aW1fd2F5IGFzIHVzaXplXSA9IHRhZzsKICAgIHZhbGlkW3NldF9pbmRleCBhcyB1c2l6ZV1bdmljdGltX3dheSBhcyB1c2l6ZV0gPSB0cnVlOwogICAgdXBkYXRlX2NhY2hlX2xydV84d2F5KGxydV9iaXRzLCBzZXRfaW5kZXgsIHZpY3RpbV93YXksIHRpbWUpOwoKICAgIGZhbHNlCn0KCi8vIFVwZGF0ZSBjYWNoZSBMUlUgZm9yIDQtd2F5IGNhY2hlCmZuIHVwZGF0ZV9jYWNoZV9scnUobHJ1X2JpdHM6ICZtdXQgW1tpMzI7IDRdOyA2NF0sIHNldF9pbmRleDogaTMyLCB3YXk6IGkzMiwgdGltZTogaTMyLCB3YXlzOiBpMzIpIHsKICAgIGxydV9iaXRzW3NldF9pbmRleCBhcyB1c2l6ZV1bd2F5IGFzIHVzaXplXSA9IHRpbWU7Cn0KCi8vIFVwZGF0ZSBjYWNoZSBMUlUgZm9yIDgtd2F5IGNhY2hlCmZuIHVwZGF0ZV9jYWNoZV9scnVfOHdheShscnVfYml0czogJm11dCBbW2kzMjsgOF07IDEyOF0sIHNldF9pbmRleDogaTMyLCB3YXk6IGkzMiwgdGltZTogaTMyKSB7CiAgICBscnVfYml0c1tzZXRfaW5kZXggYXMgdXNpemVdW3dheSBhcyB1c2l6ZV0gPSB0aW1lOwp9CgovLyBGaW5kIExSVSB3YXkgaW4gNC13YXkgY2FjaGUKZm4gZmluZF9scnVfd2F5KGxydV9iaXRzOiAmW1tpMzI7IDRdOyA2NF0sIHNldF9pbmRleDogaTMyLCB3YXlzOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGxydV93YXk6IGkzMiA9IDA7CiAgICBsZXQgbXV0IG1pbl90aW1lOiBpMzIgPSBscnVfYml0c1tzZXRfaW5kZXggYXMgdXNpemVdWzBdOwoKICAgIGxldCBtdXQgaTogaTMyID0gMTsKICAgIHdoaWxlIChpIDwgd2F5cykgewogICAgICAgIGlmIChscnVfYml0c1tzZXRfaW5kZXggYXMgdXNpemVdW2kgYXMgdXNpemVdIDwgbWluX3RpbWUpIHsKICAgICAgICAgICAgbWluX3RpbWUgPSBscnVfYml0c1tzZXRfaW5kZXggYXMgdXNpemVdW2kgYXMgdXNpemVdOwogICAgICAgICAgICBscnVfd2F5ID0gaTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGxydV93YXkKfQoKLy8gRmluZCBMUlUgd2F5IGluIDgtd2F5IGNhY2hlCmZuIGZpbmRfbHJ1X3dheV84KGxydV9iaXRzOiAmW1tpMzI7IDhdOyAxMjhdLCBzZXRfaW5kZXg6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgbHJ1X3dheTogaTMyID0gMDsKICAgIGxldCBtdXQgbWluX3RpbWU6IGkzMiA9IGxydV9iaXRzW3NldF9pbmRleCBhcyB1c2l6ZV1bMF07CgogICAgbGV0IG11dCBpOiBpMzIgPSAxOwogICAgd2hpbGUgKGkgPCA4KSB7CiAgICAgICAgaWYgKGxydV9iaXRzW3NldF9pbmRleCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gPCBtaW5fdGltZSkgewogICAgICAgICAgICBtaW5fdGltZSA9IGxydV9iaXRzW3NldF9pbmRleCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGxydV93YXkgPSBpOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgbHJ1X3dheQp9CgovLyBBbmFseXplIG1lbW9yeSBmcmFnbWVudGF0aW9uCmZuIGFuYWx5emVfbWVtb3J5X2ZyYWdtZW50YXRpb24oYWxsb2NhdGlvbl90YWJsZTogJltpMzI7IDY0XSwgbnVtX2ZyYW1lczogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBmcmVlX2Jsb2NrczogaTMyID0gMDsKICAgIGxldCBtdXQgbGFyZ2VzdF9mcmVlX2Jsb2NrOiBpMzIgPSAwOwogICAgbGV0IG11dCBjdXJyZW50X2ZyZWVfYmxvY2s6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHRvdGFsX2ZyZWU6IGkzMiA9IDA7CgogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBudW1fZnJhbWVzKSB7CiAgICAgICAgaWYgKGFsbG9jYXRpb25fdGFibGVbaSBhcyB1c2l6ZV0gPT0gMCkgewogICAgICAgICAgICAvLyBGcmVlIGZyYW1lCiAgICAgICAgICAgIGN1cnJlbnRfZnJlZV9ibG9jayA9IGN1cnJlbnRfZnJlZV9ibG9jayArIDE7CiAgICAgICAgICAgIHRvdGFsX2ZyZWUgPSB0b3RhbF9mcmVlICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBBbGxvY2F0ZWQgZnJhbWUKICAgICAgICAgICAgaWYgKGN1cnJlbnRfZnJlZV9ibG9jayA+IDApIHsKICAgICAgICAgICAgICAgIGZyZWVfYmxvY2tzID0gZnJlZV9ibG9ja3MgKyAxOwogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRfZnJlZV9ibG9jayA+IGxhcmdlc3RfZnJlZV9ibG9jaykgewogICAgICAgICAgICAgICAgICAgIGxhcmdlc3RfZnJlZV9ibG9jayA9IGN1cnJlbnRfZnJlZV9ibG9jazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGN1cnJlbnRfZnJlZV9ibG9jayA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIEhhbmRsZSBsYXN0IGJsb2NrIGlmIGl0J3MgZnJlZQogICAgaWYgKGN1cnJlbnRfZnJlZV9ibG9jayA+IDApIHsKICAgICAgICBmcmVlX2Jsb2NrcyA9IGZyZWVfYmxvY2tzICsgMTsKICAgICAgICBpZiAoY3VycmVudF9mcmVlX2Jsb2NrID4gbGFyZ2VzdF9mcmVlX2Jsb2NrKSB7CiAgICAgICAgICAgIGxhcmdlc3RfZnJlZV9ibG9jayA9IGN1cnJlbnRfZnJlZV9ibG9jazsKICAgICAgICB9CiAgICB9CgogICAgLy8gQ2FsY3VsYXRlIGZyYWdtZW50YXRpb24gc2NvcmUgKGhpZ2hlciA9IG1vcmUgZnJhZ21lbnRlZCkKICAgIGlmICh0b3RhbF9mcmVlID09IDApIHsKICAgICAgICAwCiAgICB9IGVsc2UgewogICAgICAgIDEwMCAtICgobGFyZ2VzdF9mcmVlX2Jsb2NrICogMTAwKSAvIHRvdGFsX2ZyZWUpCiAgICB9Cn0KCi8vIENvbXBhY3QgbWVtb3J5IHRvIHJlZHVjZSBmcmFnbWVudGF0aW9uCmZuIGNvbXBhY3RfbWVtb3J5KAogICAgcGFnZV90YWJsZXM6ICZtdXQgW1tpMzI7IDE2XTsgMTZdLAogICAgcmV2ZXJzZV9tYXBwaW5nOiAmbXV0IFtpMzI7IDY0XSwKICAgIGFsbG9jYXRpb25fdGFibGU6ICZtdXQgW2kzMjsgNjRdLAogICAgZnJlZV9saXN0OiAmbXV0IFtpMzI7IDY0XSwKICAgIGZyZWVfY291bnQ6ICZtdXQgaTMyLAogICAgbnVtX2ZyYW1lczogaTMyLAopIHsKICAgIGxldCBtdXQgY29tcGFjdGVkX3BvczogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICAvLyBNb3ZlIGFsbCBhbGxvY2F0ZWQgZnJhbWVzIHRvIHRoZSBiZWdpbm5pbmcKICAgIHdoaWxlIChpIDwgbnVtX2ZyYW1lcykgewogICAgICAgIGlmIChhbGxvY2F0aW9uX3RhYmxlW2kgYXMgdXNpemVdID09IDEpIHsKICAgICAgICAgICAgLy8gQWxsb2NhdGVkIGZyYW1lCiAgICAgICAgICAgIGlmIChpICE9IGNvbXBhY3RlZF9wb3MpIHsKICAgICAgICAgICAgICAgIC8vIE1vdmUgZnJhbWUgZnJvbSBwb3NpdGlvbiBpIHRvIGNvbXBhY3RlZF9wb3MKICAgICAgICAgICAgICAgIGxldCB2aXJ0dWFsX3BhZ2U6IGkzMiA9IHJldmVyc2VfbWFwcGluZ1tpIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIHJldmVyc2VfbWFwcGluZ1tjb21wYWN0ZWRfcG9zIGFzIHVzaXplXSA9IHZpcnR1YWxfcGFnZTsKICAgICAgICAgICAgICAgIHJldmVyc2VfbWFwcGluZ1tpIGFzIHVzaXplXSA9IC0xOwogICAgICAgICAgICAgICAgYWxsb2NhdGlvbl90YWJsZVtjb21wYWN0ZWRfcG9zIGFzIHVzaXplXSA9IDE7CiAgICAgICAgICAgICAgICBhbGxvY2F0aW9uX3RhYmxlW2kgYXMgdXNpemVdID0gMDsKCiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgcGFnZSB0YWJsZSBlbnRyeQogICAgICAgICAgICAgICAgaWYgKHZpcnR1YWxfcGFnZSA+PSAwICYmIHZpcnR1YWxfcGFnZSA8IDI1NikgewogICAgICAgICAgICAgICAgICAgIGxldCBwYWdlX2Rpcl9pbmRleDogaTMyID0gdmlydHVhbF9wYWdlIC8gMTY7CiAgICAgICAgICAgICAgICAgICAgbGV0IHBhZ2VfdGFibGVfaW5kZXg6IGkzMiA9IHZpcnR1YWxfcGFnZSAlIDE2OwogICAgICAgICAgICAgICAgICAgIHBhZ2VfdGFibGVzW3BhZ2VfZGlyX2luZGV4IGFzIHVzaXplXVtwYWdlX3RhYmxlX2luZGV4IGFzIHVzaXplXSA9CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhY3RlZF9wb3MgKyAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbXBhY3RlZF9wb3MgPSBjb21wYWN0ZWRfcG9zICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIFVwZGF0ZSBmcmVlIGxpc3QKICAgICpmcmVlX2NvdW50ID0gbnVtX2ZyYW1lcyAtIGNvbXBhY3RlZF9wb3M7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgKmZyZWVfY291bnQpIHsKICAgICAgICBmcmVlX2xpc3RbaSBhcyB1c2l6ZV0gPSBjb21wYWN0ZWRfcG9zICsgaTsKICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIENhbGN1bGF0ZSB3b3JraW5nIHNldCBzaXplCmZuIGNhbGN1bGF0ZV93b3JraW5nX3NldF9zaXplKAogICAgYWNjZXNzX2hpc3Rvcnk6ICZbaTMyOyAxMDAwXSwKICAgIGhpc3RvcnlfaGVhZDogaTMyLAogICAgd2luZG93X3NpemU6IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IG11dCB1bmlxdWVfcGFnZXM6IFtib29sOyAyNTZdID0gW2ZhbHNlOyAyNTZdOwogICAgbGV0IG11dCB3b3JraW5nX3NldF9zaXplOiBpMzIgPSAwOwoKICAgIGxldCBzdGFydF9wb3M6IGkzMiA9IGlmIChoaXN0b3J5X2hlYWQgPj0gd2luZG93X3NpemUpIHsKICAgICAgICBoaXN0b3J5X2hlYWQgLSB3aW5kb3dfc2l6ZQogICAgfSBlbHNlIHsKICAgICAgICAxMDAwIC0gKHdpbmRvd19zaXplIC0gaGlzdG9yeV9oZWFkKQogICAgfTsKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHBvczogaTMyID0gc3RhcnRfcG9zOwogICAgd2hpbGUgKGkgPCB3aW5kb3dfc2l6ZSkgewogICAgICAgIGlmIChwb3MgPj0gMCAmJiBwb3MgPCAxMDAwKSB7CiAgICAgICAgICAgIGxldCBwYWdlOiBpMzIgPSBhY2Nlc3NfaGlzdG9yeVtwb3MgYXMgdXNpemVdOwogICAgICAgICAgICBpZiAocGFnZSA+PSAwICYmIHBhZ2UgPCAyNTYgJiYgIXVuaXF1ZV9wYWdlc1twYWdlIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgdW5pcXVlX3BhZ2VzW3BhZ2UgYXMgdXNpemVdID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHdvcmtpbmdfc2V0X3NpemUgPSB3b3JraW5nX3NldF9zaXplICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwb3MgPSAocG9zICsgMSkgJSAxMDAwOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICB3b3JraW5nX3NldF9zaXplCn0KCi8vIEFkanVzdCBjYWNoZSBwb2xpY2llcyBiYXNlZCBvbiBwZXJmb3JtYW5jZQpmbiBhZGp1c3RfY2FjaGVfcG9saWNpZXMoCiAgICBsMV9scnU6ICZtdXQgW1tpMzI7IDRdOyA2NF0sCiAgICBsMl9scnU6ICZtdXQgW1tpMzI7IDhdOyAxMjhdLAogICAgbDFfaGl0czogaTMyLAogICAgbDFfbWlzc2VzOiBpMzIsCiAgICBsMl9oaXRzOiBpMzIsCiAgICBsMl9taXNzZXM6IGkzMiwKKSB7CiAgICBsZXQgbDFfaGl0X3JhdGU6IGkzMiA9IGlmIChsMV9oaXRzICsgbDFfbWlzc2VzID4gMCkgewogICAgICAgIChsMV9oaXRzICogMTAwKSAvIChsMV9oaXRzICsgbDFfbWlzc2VzKQogICAgfSBlbHNlIHsKICAgICAgICAwCiAgICB9OwoKICAgIGxldCBsMl9oaXRfcmF0ZTogaTMyID0gaWYgKGwyX2hpdHMgKyBsMl9taXNzZXMgPiAwKSB7CiAgICAgICAgKGwyX2hpdHMgKiAxMDApIC8gKGwyX2hpdHMgKyBsMl9taXNzZXMpCiAgICB9IGVsc2UgewogICAgICAgIDAKICAgIH07CgogICAgLy8gSWYgaGl0IHJhdGVzIGFyZSBsb3csIGFkanVzdCByZXBsYWNlbWVudCBwb2xpY2llcwogICAgaWYgKGwxX2hpdF9yYXRlIDwgNzApIHsKICAgICAgICAvLyBNYWtlIEwxIGNhY2hlIG1vcmUgY29uc2VydmF0aXZlIChhZ2UgZW50cmllcyBmYXN0ZXIpCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgNjQpIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IDQpIHsKICAgICAgICAgICAgICAgIGwxX2xydVtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9IGwxX2xydVtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSAtIDEwOwogICAgICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICB9CgogICAgaWYgKGwyX2hpdF9yYXRlIDwgNjApIHsKICAgICAgICAvLyBNYWtlIEwyIGNhY2hlIG1vcmUgY29uc2VydmF0aXZlCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgMTI4KSB7CiAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKGogPCA4KSB7CiAgICAgICAgICAgICAgICBsMl9scnVbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSBsMl9scnVbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gLSAxNTsKICAgICAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgfQp9CgovLyBDYWxjdWxhdGUgYXZlcmFnZSBtZW1vcnkgYWNjZXNzIHRpbWUKZm4gY2FsY3VsYXRlX2F2ZXJhZ2VfbWVtb3J5X2FjY2Vzc190aW1lKAogICAgbDFfaGl0czogaTMyLAogICAgbDFfbWlzc2VzOiBpMzIsCiAgICBsMl9oaXRzOiBpMzIsCiAgICBsMl9taXNzZXM6IGkzMiwKICAgIHBhZ2VfZmF1bHRzOiBpMzIsCikgLT4gaTMyIHsKICAgIGxldCB0b3RhbF9hY2Nlc3NlczogaTMyID0gbDFfaGl0cyArIGwxX21pc3NlczsKICAgIGlmICh0b3RhbF9hY2Nlc3NlcyA9PSAwKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgbGV0IGwxX2hpdF90aW1lOiBpMzIgPSAxOwogICAgbGV0IGwyX2hpdF90aW1lOiBpMzIgPSAxMDsKICAgIGxldCBtZW1vcnlfYWNjZXNzX3RpbWU6IGkzMiA9IDEwMDsKICAgIGxldCBwYWdlX2ZhdWx0X3RpbWU6IGkzMiA9IDEwMDAwOwoKICAgIGxldCB0b3RhbF90aW1lOiBpMzIgPSBsMV9oaXRzICogbDFfaGl0X3RpbWUKICAgICAgICArIGwyX2hpdHMgKiAobDFfaGl0X3RpbWUgKyBsMl9oaXRfdGltZSkKICAgICAgICArIGwyX21pc3NlcyAqIChsMV9oaXRfdGltZSArIGwyX2hpdF90aW1lICsgbWVtb3J5X2FjY2Vzc190aW1lKQogICAgICAgICsgcGFnZV9mYXVsdHMgKiBwYWdlX2ZhdWx0X3RpbWU7CgogICAgdG90YWxfdGltZSAvIHRvdGFsX2FjY2Vzc2VzCn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (25, "comprehensive25", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IERpc3RyaWJ1dGVkIENvbnNlbnN1cyBBbGdvcml0aG0gYW5kIEJ5emFudGluZSBGYXVsdCBUb2xlcmFuY2UgU2ltdWxhdG9yClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpDb21wbGV4IHN0YXRlIG1hY2hpbmUgcmVwbGljYXRpb24gd2l0aCBtdWx0aXBsZSBjb25zZW5zdXMgcm91bmRzCkJ5emFudGluZSBmYXVsdCB0b2xlcmFuY2Ugc2ltdWxhdGlvbiB3aXRoIG1hbGljaW91cyBub2RlIGJlaGF2aW9yCk5ldHdvcmsgcGFydGl0aW9uIHNpbXVsYXRpb24gYW5kIG1lc3NhZ2Ugb3JkZXJpbmcgb3B0aW1pemF0aW9uCkNvbXBsZXggdm90aW5nIGFuZCBxdW9ydW0gY2FsY3VsYXRpb24gYWxnb3JpdGhtcwpNdWx0aS1kaW1lbnNpb25hbCBzdGF0ZSB0cmFja2luZyBhbmQgY29uc2lzdGVuY3kgdmVyaWZpY2F0aW9uCkFkdmFuY2VkIHRpbWVvdXQgYW5kIGZhaWx1cmUgZGV0ZWN0aW9uIG1lY2hhbmlzbXMKQ29tcGxleCBldmVudC1kcml2ZW4gc2ltdWxhdGlvbiB3aXRoIHByaW9yaXR5IHF1ZXVlcwpDcnlwdG9ncmFwaGljIGhhc2ggc2ltdWxhdGlvbiBmb3IgbWVzc2FnZSBpbnRlZ3JpdHkKTG9hZCBiYWxhbmNpbmcgYW5kIGxlYWRlciBlbGVjdGlvbiBhbGdvcml0aG0gb3B0aW1pemF0aW9uCiovCgovLyBjb21wcmVoZW5zaXZlMjUucnggLSBEaXN0cmlidXRlZCBDb25zZW5zdXMgQWxnb3JpdGhtIGFuZCBCeXphbnRpbmUgRmF1bHQgVG9sZXJhbmNlIFNpbXVsYXRvcgovLyBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKLy8gLSBDb21wbGV4IHN0YXRlIG1hY2hpbmUgcmVwbGljYXRpb24gd2l0aCBtdWx0aXBsZSBjb25zZW5zdXMgcm91bmRzCi8vIC0gQnl6YW50aW5lIGZhdWx0IHRvbGVyYW5jZSBzaW11bGF0aW9uIHdpdGggbWFsaWNpb3VzIG5vZGUgYmVoYXZpb3IKLy8gLSBOZXR3b3JrIHBhcnRpdGlvbiBzaW11bGF0aW9uIGFuZCBtZXNzYWdlIG9yZGVyaW5nIG9wdGltaXphdGlvbgovLyAtIENvbXBsZXggdm90aW5nIGFuZCBxdW9ydW0gY2FsY3VsYXRpb24gYWxnb3JpdGhtcwovLyAtIE11bHRpLWRpbWVuc2lvbmFsIHN0YXRlIHRyYWNraW5nIGFuZCBjb25zaXN0ZW5jeSB2ZXJpZmljYXRpb24KLy8gLSBBZHZhbmNlZCB0aW1lb3V0IGFuZCBmYWlsdXJlIGRldGVjdGlvbiBtZWNoYW5pc21zCi8vIC0gQ29tcGxleCBldmVudC1kcml2ZW4gc2ltdWxhdGlvbiB3aXRoIHByaW9yaXR5IHF1ZXVlcwovLyAtIENyeXB0b2dyYXBoaWMgaGFzaCBzaW11bGF0aW9uIGZvciBtZXNzYWdlIGludGVncml0eQovLyAtIExvYWQgYmFsYW5jaW5nIGFuZCBsZWFkZXIgZWxlY3Rpb24gYWxnb3JpdGhtIG9wdGltaXphdGlvbgovLyAtIFJlc2VydmUgdGhlIHBhc3NpbmctcGFyYW0tYnktdmFsdWUgb2YgYXJyYXlzCgpmbiBtYWluKCkgewogICAgLy8gUGVyZm9ybWFuY2UgdGVzdCBtYXJrZXIgLSBzdGFydAogICAgcHJpbnRsbkludCgyNTAwMCk7CiAgICAKICAgIC8vIEluaXRpYWxpemUgZGlzdHJpYnV0ZWQgc3lzdGVtIHdpdGggNyBub2RlcyAoY2FuIHRvbGVyYXRlIDIgQnl6YW50aW5lIGZhaWx1cmVzKQogICAgbGV0IG5vZGVfY291bnQ6IGkzMiA9IDc7CiAgICBsZXQgYnl6YW50aW5lX3RvbGVyYW5jZTogaTMyID0gMjsKICAgIGxldCBtYXhfY29uc2Vuc3VzX3JvdW5kczogaTMyID0gMTAwOwogICAgCiAgICAvLyBUZXN0IDE6IEJhc2ljIGNvbnNlbnN1cyB3aXRoIGhvbmVzdCBub2RlcwogICAgLy8gVGVzdHMgc3RhdGUgbWFjaGluZSBvcHRpbWl6YXRpb24gYW5kIHZvdGluZyBhbGdvcml0aG1zCiAgICBwZXJmb3JtQmFzaWNDb25zZW5zdXNUZXN0KG5vZGVfY291bnQpOwogICAgCiAgICAvLyBUZXN0IDI6IEJ5emFudGluZSBmYXVsdCB0b2xlcmFuY2Ugd2l0aCBtYWxpY2lvdXMgbm9kZXMKICAgIC8vIFRlc3RzIGNvbXBsZXggYnJhbmNoaW5nIGFuZCBmYXVsdCBkZXRlY3Rpb24gb3B0aW1pemF0aW9uCiAgICBwZXJmb3JtQnl6YW50aW5lRmF1bHRUb2xlcmFuY2VUZXN0KG5vZGVfY291bnQsIGJ5emFudGluZV90b2xlcmFuY2UpOwogICAgCiAgICAvLyBUZXN0IDM6IE5ldHdvcmsgcGFydGl0aW9uIHNpbXVsYXRpb24KICAgIC8vIFRlc3RzIHRpbWVvdXQgb3B0aW1pemF0aW9uIGFuZCByZWNvdmVyeSBhbGdvcml0aG1zCiAgICBwZXJmb3JtTmV0d29ya1BhcnRpdGlvblRlc3Qobm9kZV9jb3VudCk7CiAgICAKICAgIC8vIFRlc3QgNDogTGVhZGVyIGVsZWN0aW9uIHVuZGVyIHZhcmlvdXMgZmFpbHVyZSBzY2VuYXJpb3MKICAgIC8vIFRlc3RzIHByaW9yaXR5IHF1ZXVlIG9wdGltaXphdGlvbiBhbmQgc3RhdGUgbWFuYWdlbWVudAogICAgcGVyZm9ybUxlYWRlckVsZWN0aW9uVGVzdChub2RlX2NvdW50KTsKICAgIAogICAgLy8gVGVzdCA1OiBDb21wbGV4IGNvbnNlbnN1cyB3aXRoIHZhcnlpbmcgbWVzc2FnZSBkZWxheXMKICAgIC8vIFRlc3RzIGV2ZW50IG9yZGVyaW5nIGFuZCBzeW5jaHJvbml6YXRpb24gb3B0aW1pemF0aW9uCiAgICBwZXJmb3JtQXN5bmNocm9ub3VzQ29uc2Vuc3VzVGVzdChub2RlX2NvdW50LCBtYXhfY29uc2Vuc3VzX3JvdW5kcyk7CiAgICAKICAgIC8vIFBlcmZvcm1hbmNlIHRlc3QgbWFya2VyIC0gZW5kCiAgICBwcmludGxuSW50KDI1OTk5KTsKICAgIGV4aXQoMCk7Cn0KCi8vIFRlc3QgMTogQmFzaWMgQ29uc2Vuc3VzIEFsZ29yaXRobSBJbXBsZW1lbnRhdGlvbgovLyBUZXN0cyBjb21waWxlciBvcHRpbWl6YXRpb24gb2Ygdm90aW5nIG1lY2hhbmlzbXMgYW5kIHN0YXRlIHN5bmNocm9uaXphdGlvbgpmbiBwZXJmb3JtQmFzaWNDb25zZW5zdXNUZXN0KG5vZGVfY291bnQ6IGkzMikgewogICAgcHJpbnRsbkludCgyNTAwMSk7IC8vIFN0YXJ0IGJhc2ljIGNvbnNlbnN1cyB0ZXN0CiAgICAKICAgIC8vIEluaXRpYWxpemUgbm9kZSBzdGF0ZXMKICAgIGxldCBtdXQgbm9kZV9zdGF0ZXM6IFtpMzI7IDddID0gWzA7IDddOyAvLyAwPWZvbGxvd2VyLCAxPWNhbmRpZGF0ZSwgMj1sZWFkZXIKICAgIGxldCBtdXQgbm9kZV90ZXJtczogW2kzMjsgN10gPSBbMDsgN107ICAvLyBDdXJyZW50IHRlcm0gZm9yIGVhY2ggbm9kZQogICAgbGV0IG11dCBub2RlX3ZvdGVzOiBbaTMyOyA3XSA9IFstMTsgN107IC8vIFdobyBlYWNoIG5vZGUgdm90ZWQgZm9yICgtMSA9IG5vIHZvdGUpCiAgICBsZXQgbXV0IG5vZGVfbG9nczogW1tpMzI7IDEwMF07IDddID0gW1swOyAxMDBdOyA3XTsgLy8gTG9nIGVudHJpZXMgZm9yIGVhY2ggbm9kZQogICAgbGV0IG11dCBsb2dfbGVuZ3RoczogW2kzMjsgN10gPSBbMDsgN107IC8vIEN1cnJlbnQgbG9nIGxlbmd0aCBmb3IgZWFjaCBub2RlCiAgICAKICAgIC8vIFNpbXVsYXRlIG11bHRpcGxlIGNvbnNlbnN1cyByb3VuZHMKICAgIGxldCBtdXQgY29uc2Vuc3VzX3JvdW5kOiBpMzIgPSAwOwogICAgd2hpbGUgKGNvbnNlbnN1c19yb3VuZCA8IDUwKSB7CiAgICAgICAgLy8gUGhhc2UgMTogTGVhZGVyIGVsZWN0aW9uCiAgICAgICAgbGV0IGxlYWRlcl9pZDogaTMyID0gY29uZHVjdExlYWRlckVsZWN0aW9uKG5vZGVfY291bnQsICZtdXQgbm9kZV9zdGF0ZXMsICZtdXQgbm9kZV90ZXJtcywgJm11dCBub2RlX3ZvdGVzKTsKICAgICAgICAKICAgICAgICBpZiAobGVhZGVyX2lkID49IDApIHsKICAgICAgICAgICAgLy8gUGhhc2UgMjogTG9nIHJlcGxpY2F0aW9uCiAgICAgICAgICAgIGxldCBzdWNjZXNzOiBib29sID0gcGVyZm9ybUxvZ1JlcGxpY2F0aW9uKGxlYWRlcl9pZCwgbm9kZV9jb3VudCwgJm11dCBub2RlX2xvZ3MsICZtdXQgbG9nX2xlbmd0aHMpOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKHN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIHByaW50bG5JbnQoMjUwMDAgKyBjb25zZW5zdXNfcm91bmQpOyAvLyBTdWNjZXNzZnVsbHkgcmVhY2hlZCBjb25zZW5zdXMKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gVmVyaWZ5IGNvbnNpc3RlbmN5IGFjcm9zcyBhbGwgbm9kZXMKICAgICAgICAgICAgICAgIGxldCBjb25zaXN0ZW5jeV9jaGVjazogYm9vbCA9IHZlcmlmeUxvZ0NvbnNpc3RlbmN5KG5vZGVfY291bnQsICZub2RlX2xvZ3MsICZsb2dfbGVuZ3Rocyk7CiAgICAgICAgICAgICAgICBpZiAoY29uc2lzdGVuY3lfY2hlY2spIHsKICAgICAgICAgICAgICAgICAgICBwcmludGxuSW50KDI1MTAwICsgY29uc2Vuc3VzX3JvdW5kKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICBjb25zZW5zdXNfcm91bmQgPSBjb25zZW5zdXNfcm91bmQgKyAxOwogICAgfQogICAgCiAgICBwcmludGxuSW50KDI1MDk5KTsgLy8gRW5kIGJhc2ljIGNvbnNlbnN1cyB0ZXN0Cn0KCi8vIExlYWRlciBFbGVjdGlvbiBBbGdvcml0aG0gd2l0aCBDb21wbGV4IFZvdGluZyBMb2dpYwpmbiBjb25kdWN0TGVhZGVyRWxlY3Rpb24obm9kZV9jb3VudDogaTMyLCBub2RlX3N0YXRlczogJm11dCBbaTMyOyA3XSwgbm9kZV90ZXJtczogJm11dCBbaTMyOyA3XSwgbm9kZV92b3RlczogJm11dCBbaTMyOyA3XSkgLT4gaTMyIHsKICAgIGxldCBtdXQgY3VycmVudF90ZXJtOiBpMzIgPSBmaW5kTWF4VGVybShub2RlX3Rlcm1zLCBub2RlX2NvdW50KTsKICAgIGN1cnJlbnRfdGVybSA9IGN1cnJlbnRfdGVybSArIDE7CiAgICAKICAgIC8vIFJlc2V0IHZvdGVzIGZvciBuZXcgdGVybQogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgbm9kZV92b3Rlc1tpIGFzIHVzaXplXSA9IC0xOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgLy8gU2ltdWxhdGUgY2FuZGlkYXRlIGFubm91bmNlbWVudAogICAgbGV0IG11dCBjYW5kaWRhdGVzOiBbYm9vbDsgN10gPSBbZmFsc2U7IDddOwogICAgbGV0IG11dCBjYW5kaWRhdGVfY291bnQ6IGkzMiA9IDA7CiAgICAKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgLy8gQ29tcGxleCBjb25kaXRpb24gZm9yIGJlY29taW5nIGNhbmRpZGF0ZQogICAgICAgIGlmIChzaG91bGRCZWNvbWVDYW5kaWRhdGUoaSwgbm9kZV9zdGF0ZXNbaSBhcyB1c2l6ZV0sIG5vZGVfdGVybXNbaSBhcyB1c2l6ZV0sIGN1cnJlbnRfdGVybSkpIHsKICAgICAgICAgICAgY2FuZGlkYXRlc1tpIGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgICAgIG5vZGVfc3RhdGVzW2kgYXMgdXNpemVdID0gMTsgLy8gQmVjb21lIGNhbmRpZGF0ZQogICAgICAgICAgICBub2RlX3Rlcm1zW2kgYXMgdXNpemVdID0gY3VycmVudF90ZXJtOwogICAgICAgICAgICBjYW5kaWRhdGVfY291bnQgPSBjYW5kaWRhdGVfY291bnQgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIFZvdGluZyBwaGFzZSB3aXRoIGNvbXBsZXggZGVjaXNpb24gbG9naWMKICAgIGxldCBtdXQgdm90ZV9jb3VudHM6IFtpMzI7IDddID0gWzA7IDddOwogICAgbGV0IG11dCB2b3RlcjogaTMyID0gMDsKICAgIHdoaWxlICh2b3RlciA8IG5vZGVfY291bnQpIHsKICAgICAgICBpZiAobm9kZV9zdGF0ZXNbdm90ZXIgYXMgdXNpemVdICE9IDEpIHsgLy8gTm9uLWNhbmRpZGF0ZXMgY2FuIHZvdGUKICAgICAgICAgICAgbGV0IHZvdGVfY2hvaWNlOiBpMzIgPSBkZWNpZGVWb3RlKHZvdGVyLCBub2RlX2NvdW50LCAmY2FuZGlkYXRlcywgbm9kZV90ZXJtcywgY3VycmVudF90ZXJtKTsKICAgICAgICAgICAgaWYgKHZvdGVfY2hvaWNlID49IDAgJiYgdm90ZV9jaG9pY2UgPCBub2RlX2NvdW50KSB7CiAgICAgICAgICAgICAgICBub2RlX3ZvdGVzW3ZvdGVyIGFzIHVzaXplXSA9IHZvdGVfY2hvaWNlOwogICAgICAgICAgICAgICAgdm90ZV9jb3VudHNbdm90ZV9jaG9pY2UgYXMgdXNpemVdID0gdm90ZV9jb3VudHNbdm90ZV9jaG9pY2UgYXMgdXNpemVdICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB2b3RlciA9IHZvdGVyICsgMTsKICAgIH0KICAgIAogICAgLy8gU2VsZi12b3RpbmcgYnkgY2FuZGlkYXRlcwogICAgbGV0IG11dCBjYW5kaWRhdGVfaWQ6IGkzMiA9IDA7CiAgICB3aGlsZSAoY2FuZGlkYXRlX2lkIDwgbm9kZV9jb3VudCkgewogICAgICAgIGlmIChjYW5kaWRhdGVzW2NhbmRpZGF0ZV9pZCBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgbm9kZV92b3Rlc1tjYW5kaWRhdGVfaWQgYXMgdXNpemVdID0gY2FuZGlkYXRlX2lkOwogICAgICAgICAgICB2b3RlX2NvdW50c1tjYW5kaWRhdGVfaWQgYXMgdXNpemVdID0gdm90ZV9jb3VudHNbY2FuZGlkYXRlX2lkIGFzIHVzaXplXSArIDE7CiAgICAgICAgfQogICAgICAgIGNhbmRpZGF0ZV9pZCA9IGNhbmRpZGF0ZV9pZCArIDE7CiAgICB9CiAgICAKICAgIC8vIERldGVybWluZSB3aW5uZXIgKG5lZWQgbWFqb3JpdHkpCiAgICBsZXQgbWFqb3JpdHlfdGhyZXNob2xkOiBpMzIgPSAobm9kZV9jb3VudCAvIDIpICsgMTsKICAgIGxldCBtdXQgd2lubmVyOiBpMzIgPSAtMTsKICAgIGxldCBtdXQgY2hlY2tfY2FuZGlkYXRlOiBpMzIgPSAwOwogICAgd2hpbGUgKGNoZWNrX2NhbmRpZGF0ZSA8IG5vZGVfY291bnQpIHsKICAgICAgICBpZiAodm90ZV9jb3VudHNbY2hlY2tfY2FuZGlkYXRlIGFzIHVzaXplXSA+PSBtYWpvcml0eV90aHJlc2hvbGQpIHsKICAgICAgICAgICAgd2lubmVyID0gY2hlY2tfY2FuZGlkYXRlOwogICAgICAgICAgICBub2RlX3N0YXRlc1tjaGVja19jYW5kaWRhdGUgYXMgdXNpemVdID0gMjsgLy8gQmVjb21lIGxlYWRlcgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2hlY2tfY2FuZGlkYXRlID0gY2hlY2tfY2FuZGlkYXRlICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIHdpbm5lcjsKfQoKLy8gQ29tcGxleCB2b3RpbmcgZGVjaXNpb24gYWxnb3JpdGhtCmZuIGRlY2lkZVZvdGUodm90ZXJfaWQ6IGkzMiwgbm9kZV9jb3VudDogaTMyLCBjYW5kaWRhdGVzOiAmW2Jvb2w7IDddLCBub2RlX3Rlcm1zOiAmbXV0IFtpMzI7IDddLCBjdXJyZW50X3Rlcm06IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgYmVzdF9jYW5kaWRhdGU6IGkzMiA9IC0xOwogICAgbGV0IG11dCBiZXN0X3Rlcm06IGkzMiA9IC0xOwogICAgCiAgICBsZXQgbXV0IGNhbmRpZGF0ZV9pZDogaTMyID0gMDsKICAgIHdoaWxlIChjYW5kaWRhdGVfaWQgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaWYgKGNhbmRpZGF0ZXNbY2FuZGlkYXRlX2lkIGFzIHVzaXplXSkgewogICAgICAgICAgICAvLyBDb21wbGV4IHZvdGluZyBjcml0ZXJpYQogICAgICAgICAgICBsZXQgY2FuZGlkYXRlX3Njb3JlOiBpMzIgPSBjYWxjdWxhdGVDYW5kaWRhdGVTY29yZShjYW5kaWRhdGVfaWQsIHZvdGVyX2lkLCBub2RlX3Rlcm1zW2NhbmRpZGF0ZV9pZCBhcyB1c2l6ZV0sIGN1cnJlbnRfdGVybSk7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoY2FuZGlkYXRlX3Njb3JlID4gYmVzdF90ZXJtKSB7CiAgICAgICAgICAgICAgICBiZXN0X3Rlcm0gPSBjYW5kaWRhdGVfc2NvcmU7CiAgICAgICAgICAgICAgICBiZXN0X2NhbmRpZGF0ZSA9IGNhbmRpZGF0ZV9pZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYW5kaWRhdGVfaWQgPSBjYW5kaWRhdGVfaWQgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gYmVzdF9jYW5kaWRhdGU7Cn0KCi8vIENhbGN1bGF0ZSBjYW5kaWRhdGUgZml0bmVzcyBzY29yZQpmbiBjYWxjdWxhdGVDYW5kaWRhdGVTY29yZShjYW5kaWRhdGVfaWQ6IGkzMiwgdm90ZXJfaWQ6IGkzMiwgY2FuZGlkYXRlX3Rlcm06IGkzMiwgY3VycmVudF90ZXJtOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHNjb3JlOiBpMzIgPSBjYW5kaWRhdGVfdGVybSAqIDEwMDsKICAgIAogICAgLy8gUHJlZmVyIGNhbmRpZGF0ZXMgd2l0aCBsb3dlciBJRCAoZGV0ZXJtaW5pc3RpYyB0aWUtYnJlYWtpbmcpCiAgICBzY29yZSA9IHNjb3JlIC0gY2FuZGlkYXRlX2lkOwogICAgCiAgICAvLyBBZGQgcmFuZG9tbmVzcyBiYXNlZCBvbiB2b3Rlci1jYW5kaWRhdGUgcmVsYXRpb25zaGlwCiAgICBsZXQgcmVsYXRpb25zaGlwX2ZhY3RvcjogaTMyID0gKHZvdGVyX2lkICogNyArIGNhbmRpZGF0ZV9pZCAqIDExKSAlIDUwOwogICAgc2NvcmUgPSBzY29yZSArIHJlbGF0aW9uc2hpcF9mYWN0b3I7CiAgICAKICAgIC8vIFBlbmFsdHkgZm9yIGNhbmRpZGF0ZXMgdGhhdCBhcmUgdG9vIGZhciBmcm9tIHZvdGVyCiAgICBsZXQgZGlzdGFuY2VfcGVuYWx0eTogaTMyID0gYWJzKHZvdGVyX2lkIC0gY2FuZGlkYXRlX2lkKSAqIDU7CiAgICBzY29yZSA9IHNjb3JlIC0gZGlzdGFuY2VfcGVuYWx0eTsKICAgIAogICAgcmV0dXJuIHNjb3JlOwp9CgovLyBMb2cgcmVwbGljYXRpb24gd2l0aCBjb21wbGV4IGNvbnNpc3RlbmN5IGNoZWNrcwpmbiBwZXJmb3JtTG9nUmVwbGljYXRpb24obGVhZGVyX2lkOiBpMzIsIG5vZGVfY291bnQ6IGkzMiwgbm9kZV9sb2dzOiAmbXV0IFtbaTMyOyAxMDBdOyA3XSwgbG9nX2xlbmd0aHM6ICZtdXQgW2kzMjsgN10pIC0+IGJvb2wgewogICAgLy8gTGVhZGVyIHByb3Bvc2VzIG5ldyBsb2cgZW50cnkKICAgIGxldCBuZXdfZW50cnk6IGkzMiA9IGdlbmVyYXRlTG9nRW50cnkobGVhZGVyX2lkLCBsb2dfbGVuZ3Roc1tsZWFkZXJfaWQgYXMgdXNpemVdKTsKICAgIAogICAgLy8gQWRkIHRvIGxlYWRlcidzIGxvZwogICAgaWYgKGxvZ19sZW5ndGhzW2xlYWRlcl9pZCBhcyB1c2l6ZV0gPCAxMDApIHsKICAgICAgICBub2RlX2xvZ3NbbGVhZGVyX2lkIGFzIHVzaXplXVsobG9nX2xlbmd0aHNbbGVhZGVyX2lkIGFzIHVzaXplXSkgYXMgdXNpemVdID0gbmV3X2VudHJ5OwogICAgICAgIGxvZ19sZW5ndGhzW2xlYWRlcl9pZCBhcyB1c2l6ZV0gPSBsb2dfbGVuZ3Roc1tsZWFkZXJfaWQgYXMgdXNpemVdICsgMTsKICAgIH0KICAgIAogICAgLy8gUmVwbGljYXRlIHRvIGZvbGxvd2VycyB3aXRoIGNvbXBsZXggYWNrbm93bGVkZ21lbnQgbG9naWMKICAgIGxldCBtdXQgYWNrX2NvdW50OiBpMzIgPSAxOyAvLyBMZWFkZXIgYWNrbm93bGVkZ2VzIGl0c2VsZgogICAgbGV0IG11dCBmb2xsb3dlcjogaTMyID0gMDsKICAgIHdoaWxlIChmb2xsb3dlciA8IG5vZGVfY291bnQpIHsKICAgICAgICBpZiAoZm9sbG93ZXIgIT0gbGVhZGVyX2lkKSB7CiAgICAgICAgICAgIGxldCBzdWNjZXNzOiBib29sID0gcmVwbGljYXRlVG9Gb2xsb3dlcihsZWFkZXJfaWQsIGZvbGxvd2VyLCBuZXdfZW50cnksIG5vZGVfbG9ncywgbG9nX2xlbmd0aHMpOwogICAgICAgICAgICBpZiAoc3VjY2VzcykgewogICAgICAgICAgICAgICAgYWNrX2NvdW50ID0gYWNrX2NvdW50ICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBmb2xsb3dlciA9IGZvbGxvd2VyICsgMTsKICAgIH0KICAgIAogICAgLy8gTmVlZCBtYWpvcml0eSBhY2tub3dsZWRnbWVudAogICAgbGV0IG1ham9yaXR5X3RocmVzaG9sZDogaTMyID0gKG5vZGVfY291bnQgLyAyKSArIDE7CiAgICByZXR1cm4gYWNrX2NvdW50ID49IG1ham9yaXR5X3RocmVzaG9sZDsKfQoKLy8gQ29tcGxleCBmb2xsb3dlciBsb2cgcmVwbGljYXRpb24gbG9naWMKZm4gcmVwbGljYXRlVG9Gb2xsb3dlcihsZWFkZXJfaWQ6IGkzMiwgZm9sbG93ZXJfaWQ6IGkzMiwgZW50cnk6IGkzMiwgbm9kZV9sb2dzOiAmbXV0IFtbaTMyOyAxMDBdOyA3XSwgbG9nX2xlbmd0aHM6ICZtdXQgW2kzMjsgN10pIC0+IGJvb2wgewogICAgLy8gU2ltdWxhdGUgbmV0d29yayBkZWxheSBhbmQgcG90ZW50aWFsIGZhaWx1cmUKICAgIGxldCBuZXR3b3JrX3N1Y2Nlc3M6IGJvb2wgPSBzaW11bGF0ZU5ldHdvcmtSZWxpYWJpbGl0eShsZWFkZXJfaWQsIGZvbGxvd2VyX2lkKTsKICAgIAogICAgaWYgKCFuZXR3b3JrX3N1Y2Nlc3MpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAKICAgIC8vIENoZWNrIGxvZyBjb25zaXN0ZW5jeSBiZWZvcmUgYXBwZW5kaW5nCiAgICBsZXQgY29uc2lzdGVuY3lfb2s6IGJvb2wgPSBjaGVja0xvZ0NvbnNpc3RlbmN5KGxlYWRlcl9pZCwgZm9sbG93ZXJfaWQsIG5vZGVfbG9ncywgbG9nX2xlbmd0aHMpOwogICAgCiAgICBpZiAoY29uc2lzdGVuY3lfb2sgJiYgbG9nX2xlbmd0aHNbZm9sbG93ZXJfaWQgYXMgdXNpemVdIDwgMTAwKSB7CiAgICAgICAgbm9kZV9sb2dzW2ZvbGxvd2VyX2lkIGFzIHVzaXplXVsobG9nX2xlbmd0aHNbZm9sbG93ZXJfaWQgYXMgdXNpemVdKSBhcyB1c2l6ZV0gPSBlbnRyeTsKICAgICAgICBsb2dfbGVuZ3Roc1tmb2xsb3dlcl9pZCBhcyB1c2l6ZV0gPSBsb2dfbGVuZ3Roc1tmb2xsb3dlcl9pZCBhcyB1c2l6ZV0gKyAxOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICByZXR1cm4gZmFsc2U7Cn0KCi8vIFRlc3QgMjogQnl6YW50aW5lIEZhdWx0IFRvbGVyYW5jZSBTaW11bGF0aW9uCmZuIHBlcmZvcm1CeXphbnRpbmVGYXVsdFRvbGVyYW5jZVRlc3Qobm9kZV9jb3VudDogaTMyLCBieXphbnRpbmVfdG9sZXJhbmNlOiBpMzIpIHsKICAgIHByaW50bG5JbnQoMjUyMDEpOyAvLyBTdGFydCBCeXphbnRpbmUgZmF1bHQgdG9sZXJhbmNlIHRlc3QKICAgIAogICAgLy8gTWFyayBzb21lIG5vZGVzIGFzIEJ5emFudGluZSAobWFsaWNpb3VzKQogICAgbGV0IG11dCBieXphbnRpbmVfbm9kZXM6IFtib29sOyA3XSA9IFtmYWxzZTsgN107CiAgICBsZXQgbXV0IGJ5emFudGluZV9jb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCAmJiBieXphbnRpbmVfY291bnQgPCBieXphbnRpbmVfdG9sZXJhbmNlKSB7CiAgICAgICAgaWYgKHNob3VsZEJlQnl6YW50aW5lKGkpKSB7CiAgICAgICAgICAgIGJ5emFudGluZV9ub2Rlc1tpIGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgICAgIGJ5emFudGluZV9jb3VudCA9IGJ5emFudGluZV9jb3VudCArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgLy8gSW5pdGlhbGl6ZSBCeXphbnRpbmUtcmVzaXN0YW50IGRhdGEgc3RydWN0dXJlcwogICAgbGV0IG11dCBub2RlX3ZhbHVlczogW2kzMjsgN10gPSBbMDsgN107CiAgICBsZXQgbXV0IG5vZGVfc2lnbmF0dXJlczogW1tpMzI7IDEwXTsgN10gPSBbWzA7IDEwXTsgN107IC8vIFNpbXVsYXRlZCBkaWdpdGFsIHNpZ25hdHVyZXMKICAgIGxldCBtdXQgbWVzc2FnZV9oYXNoZXM6IFtpMzI7IDEwMF0gPSBbMDsgMTAwXTsgLy8gTWVzc2FnZSBpbnRlZ3JpdHkgdmVyaWZpY2F0aW9uCiAgICBsZXQgbXV0IGNvbnNlbnN1c19wcm9wb3NhbHM6IFtbaTMyOyAzXTsgN10gPSBbWzA7IDNdOyA3XTsgLy8gRWFjaCBub2RlIGNhbiBwcm9wb3NlIHVwIHRvIDMgdmFsdWVzCiAgICAKICAgIC8vIFNpbXVsYXRlIEJ5emFudGluZSBhZ3JlZW1lbnQgcHJvdG9jb2wKICAgIGxldCBtdXQgYWdyZWVtZW50X3JvdW5kOiBpMzIgPSAwOwogICAgd2hpbGUgKGFncmVlbWVudF9yb3VuZCA8IDIwKSB7CiAgICAgICAgLy8gUGhhc2UgMTogVmFsdWUgcHJvcG9zYWwgd2l0aCBCeXphbnRpbmUgaW50ZXJmZXJlbmNlCiAgICAgICAgbGV0IHByb3Bvc2FsX3N1Y2Nlc3M6IGJvb2wgPSBjb25kdWN0Qnl6YW50aW5lVmFsdWVQcm9wb3NhbCgKICAgICAgICAgICAgbm9kZV9jb3VudCwgJmJ5emFudGluZV9ub2RlcywgJm11dCBub2RlX3ZhbHVlcywgJm11dCBjb25zZW5zdXNfcHJvcG9zYWxzLCBhZ3JlZW1lbnRfcm91bmQKICAgICAgICApOwogICAgICAgIAogICAgICAgIGlmIChwcm9wb3NhbF9zdWNjZXNzKSB7CiAgICAgICAgICAgIC8vIFBoYXNlIDI6IEJ5emFudGluZSBhZ3JlZW1lbnQgd2l0aCBtYWxpY2lvdXMgYmVoYXZpb3IKICAgICAgICAgICAgbGV0IGFncmVlbWVudF9yZWFjaGVkOiBib29sID0gcGVyZm9ybUJ5emFudGluZUFncmVlbWVudCgKICAgICAgICAgICAgICAgIG5vZGVfY291bnQsICZieXphbnRpbmVfbm9kZXMsICZjb25zZW5zdXNfcHJvcG9zYWxzLCAmbXV0IG5vZGVfc2lnbmF0dXJlcywgYWdyZWVtZW50X3JvdW5kCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoYWdyZWVtZW50X3JlYWNoZWQpIHsKICAgICAgICAgICAgICAgIHByaW50bG5JbnQoMjUyMDAgKyBhZ3JlZW1lbnRfcm91bmQpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBWZXJpZnkgdGhhdCBob25lc3Qgbm9kZXMgYWdyZWUgZGVzcGl0ZSBCeXphbnRpbmUgaW50ZXJmZXJlbmNlCiAgICAgICAgICAgICAgICBsZXQgaG9uZXN0X2FncmVlbWVudDogYm9vbCA9IHZlcmlmeUhvbmVzdE5vZGVBZ3JlZW1lbnQoCiAgICAgICAgICAgICAgICAgICAgbm9kZV9jb3VudCwgJmJ5emFudGluZV9ub2RlcywgJmNvbnNlbnN1c19wcm9wb3NhbHMKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIChob25lc3RfYWdyZWVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgcHJpbnRsbkludCgyNTIyMCArIGFncmVlbWVudF9yb3VuZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgYWdyZWVtZW50X3JvdW5kID0gYWdyZWVtZW50X3JvdW5kICsgMTsKICAgIH0KICAgIAogICAgcHJpbnRsbkludCgyNTI5OSk7IC8vIEVuZCBCeXphbnRpbmUgZmF1bHQgdG9sZXJhbmNlIHRlc3QKfQoKLy8gQ29tcGxleCBCeXphbnRpbmUgdmFsdWUgcHJvcG9zYWwgd2l0aCBtYWxpY2lvdXMgYmVoYXZpb3Igc2ltdWxhdGlvbgpmbiBjb25kdWN0Qnl6YW50aW5lVmFsdWVQcm9wb3NhbCgKICAgIG5vZGVfY291bnQ6IGkzMiwgCiAgICBieXphbnRpbmVfbm9kZXM6ICZbYm9vbDsgN10sIAogICAgbm9kZV92YWx1ZXM6ICZtdXQgW2kzMjsgN10sIAogICAgY29uc2Vuc3VzX3Byb3Bvc2FsczogJm11dCBbW2kzMjsgM107IDddLAogICAgcm91bmQ6IGkzMgopIC0+IGJvb2wgewogICAgbGV0IG11dCBwcm9wb3NhbF9jb3VudDogaTMyID0gMDsKICAgIAogICAgbGV0IG11dCBub2RlX2lkOiBpMzIgPSAwOwogICAgd2hpbGUgKG5vZGVfaWQgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaWYgKGJ5emFudGluZV9ub2Rlc1tub2RlX2lkIGFzIHVzaXplXSkgewogICAgICAgICAgICAvLyBCeXphbnRpbmUgbm9kZXMgcHJvcG9zZSBjb25mbGljdGluZyB2YWx1ZXMKICAgICAgICAgICAgbGV0IG1hbGljaW91c192YWx1ZTE6IGkzMiA9IGdlbmVyYXRlTWFsaWNpb3VzVmFsdWUobm9kZV9pZCwgcm91bmQsIDEpOwogICAgICAgICAgICBsZXQgbWFsaWNpb3VzX3ZhbHVlMjogaTMyID0gZ2VuZXJhdGVNYWxpY2lvdXNWYWx1ZShub2RlX2lkLCByb3VuZCwgMik7CiAgICAgICAgICAgIGxldCBtYWxpY2lvdXNfdmFsdWUzOiBpMzIgPSBnZW5lcmF0ZU1hbGljaW91c1ZhbHVlKG5vZGVfaWQsIHJvdW5kLCAzKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnNlbnN1c19wcm9wb3NhbHNbbm9kZV9pZCBhcyB1c2l6ZV1bMF0gPSBtYWxpY2lvdXNfdmFsdWUxOwogICAgICAgICAgICBjb25zZW5zdXNfcHJvcG9zYWxzW25vZGVfaWQgYXMgdXNpemVdWzFdID0gbWFsaWNpb3VzX3ZhbHVlMjsKICAgICAgICAgICAgY29uc2Vuc3VzX3Byb3Bvc2Fsc1tub2RlX2lkIGFzIHVzaXplXVsyXSA9IG1hbGljaW91c192YWx1ZTM7CiAgICAgICAgICAgIAogICAgICAgICAgICBub2RlX3ZhbHVlc1tub2RlX2lkIGFzIHVzaXplXSA9IG1hbGljaW91c192YWx1ZTE7IC8vIFByaW1hcnkgbWFsaWNpb3VzIHZhbHVlCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gSG9uZXN0IG5vZGVzIHByb3Bvc2UgY29uc2lzdGVudCB2YWx1ZXMKICAgICAgICAgICAgbGV0IGhvbmVzdF92YWx1ZTogaTMyID0gZ2VuZXJhdGVIb25lc3RWYWx1ZShub2RlX2lkLCByb3VuZCk7CiAgICAgICAgICAgIGNvbnNlbnN1c19wcm9wb3NhbHNbbm9kZV9pZCBhcyB1c2l6ZV1bMF0gPSBob25lc3RfdmFsdWU7CiAgICAgICAgICAgIGNvbnNlbnN1c19wcm9wb3NhbHNbbm9kZV9pZCBhcyB1c2l6ZV1bMV0gPSBob25lc3RfdmFsdWU7CiAgICAgICAgICAgIGNvbnNlbnN1c19wcm9wb3NhbHNbbm9kZV9pZCBhcyB1c2l6ZV1bMl0gPSBob25lc3RfdmFsdWU7CiAgICAgICAgICAgIAogICAgICAgICAgICBub2RlX3ZhbHVlc1tub2RlX2lkIGFzIHVzaXplXSA9IGhvbmVzdF92YWx1ZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHJvcG9zYWxfY291bnQgPSBwcm9wb3NhbF9jb3VudCArIDE7CiAgICAgICAgbm9kZV9pZCA9IG5vZGVfaWQgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gcHJvcG9zYWxfY291bnQgPj0gbm9kZV9jb3VudDsKfQoKLy8gQnl6YW50aW5lIGFncmVlbWVudCBhbGdvcml0aG0gd2l0aCBzaWduYXR1cmUgdmVyaWZpY2F0aW9uCmZuIHBlcmZvcm1CeXphbnRpbmVBZ3JlZW1lbnQoCiAgICBub2RlX2NvdW50OiBpMzIsCiAgICBieXphbnRpbmVfbm9kZXM6ICZbYm9vbDsgN10sCiAgICBjb25zZW5zdXNfcHJvcG9zYWxzOiAmW1tpMzI7IDNdOyA3XSwKICAgIG5vZGVfc2lnbmF0dXJlczogJm11dCBbW2kzMjsgMTBdOyA3XSwKICAgIHJvdW5kOiBpMzIKKSAtPiBib29sIHsKICAgIC8vIFBoYXNlIDE6IEV4Y2hhbmdlIHByb3Bvc2FscyB3aXRoIHNpZ25hdHVyZXMKICAgIGxldCBtdXQgc2lnbmF0dXJlX21hdHJpeDogW1tpMzI7IDddOyA3XSA9IFtbMDsgN107IDddOyAvLyBOb2RlIGkncyBzaWduYXR1cmUgb24gbm9kZSBqJ3MgcHJvcG9zYWwKICAgIAogICAgbGV0IG11dCBzaWduZXI6IGkzMiA9IDA7CiAgICB3aGlsZSAoc2lnbmVyIDwgbm9kZV9jb3VudCkgewogICAgICAgIGxldCBtdXQgcHJvcG9zYWxfb3duZXI6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKHByb3Bvc2FsX293bmVyIDwgbm9kZV9jb3VudCkgewogICAgICAgICAgICBsZXQgc2lnbmF0dXJlOiBpMzIgPSBnZW5lcmF0ZVNpZ25hdHVyZShzaWduZXIsIHByb3Bvc2FsX293bmVyLCBjb25zZW5zdXNfcHJvcG9zYWxzW3Byb3Bvc2FsX293bmVyIGFzIHVzaXplXVswXSwgcm91bmQpOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGJ5emFudGluZV9ub2Rlc1tzaWduZXIgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICAvLyBCeXphbnRpbmUgbm9kZXMgbWF5IGZvcmdlIHNpZ25hdHVyZXMgb3Igc2lnbiBtdWx0aXBsZSBjb25mbGljdGluZyB2YWx1ZXMKICAgICAgICAgICAgICAgIHNpZ25hdHVyZV9tYXRyaXhbc2lnbmVyIGFzIHVzaXplXVtwcm9wb3NhbF9vd25lciBhcyB1c2l6ZV0gPSBjb3JydXB0U2lnbmF0dXJlKHNpZ25hdHVyZSwgc2lnbmVyLCBwcm9wb3NhbF9vd25lcik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzaWduYXR1cmVfbWF0cml4W3NpZ25lciBhcyB1c2l6ZV1bcHJvcG9zYWxfb3duZXIgYXMgdXNpemVdID0gc2lnbmF0dXJlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBwcm9wb3NhbF9vd25lciA9IHByb3Bvc2FsX293bmVyICsgMTsKICAgICAgICB9CiAgICAgICAgc2lnbmVyID0gc2lnbmVyICsgMTsKICAgIH0KICAgIAogICAgLy8gUGhhc2UgMjogVmVyaWZ5IHNpZ25hdHVyZXMgYW5kIGRldGVjdCBCeXphbnRpbmUgYmVoYXZpb3IKICAgIGxldCBtdXQgdmFsaWRfcHJvcG9zYWxzOiBbYm9vbDsgN10gPSBbZmFsc2U7IDddOwogICAgbGV0IG11dCB2YWxpZF9jb3VudDogaTMyID0gMDsKICAgIAogICAgbGV0IG11dCBwcm9wb3NhbF9pZDogaTMyID0gMDsKICAgIHdoaWxlIChwcm9wb3NhbF9pZCA8IG5vZGVfY291bnQpIHsKICAgICAgICBsZXQgc2lnbmF0dXJlX2NvdW50OiBpMzIgPSBjb3VudFZhbGlkU2lnbmF0dXJlcygKICAgICAgICAgICAgcHJvcG9zYWxfaWQsIG5vZGVfY291bnQsICZzaWduYXR1cmVfbWF0cml4LCBjb25zZW5zdXNfcHJvcG9zYWxzLCBieXphbnRpbmVfbm9kZXMKICAgICAgICApOwogICAgICAgIAogICAgICAgIC8vIE5lZWQgYXQgbGVhc3QgKDJmKzEpIHZhbGlkIHNpZ25hdHVyZXMgd2hlcmUgZiBpcyB0aGUgbnVtYmVyIG9mIEJ5emFudGluZSBub2RlcwogICAgICAgIGxldCByZXF1aXJlZF9zaWduYXR1cmVzOiBpMzIgPSAobm9kZV9jb3VudCAtICgobm9kZV9jb3VudCAtIDEpIC8gMykpOwogICAgICAgIAogICAgICAgIGlmIChzaWduYXR1cmVfY291bnQgPj0gcmVxdWlyZWRfc2lnbmF0dXJlcykgewogICAgICAgICAgICB2YWxpZF9wcm9wb3NhbHNbcHJvcG9zYWxfaWQgYXMgdXNpemVdID0gdHJ1ZTsKICAgICAgICAgICAgdmFsaWRfY291bnQgPSB2YWxpZF9jb3VudCArIDE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHByb3Bvc2FsX2lkID0gcHJvcG9zYWxfaWQgKyAxOwogICAgfQogICAgCiAgICAvLyBBZ3JlZW1lbnQgcmVhY2hlZCBpZiBtYWpvcml0eSBvZiB2YWxpZCBwcm9wb3NhbHMgYWdyZWUgb24gc2FtZSB2YWx1ZQogICAgcmV0dXJuIGNoZWNrUHJvcG9zYWxBZ3JlZW1lbnQobm9kZV9jb3VudCwgJnZhbGlkX3Byb3Bvc2FscywgY29uc2Vuc3VzX3Byb3Bvc2Fscyk7Cn0KCi8vIFRlc3QgMzogTmV0d29yayBQYXJ0aXRpb24gU2ltdWxhdGlvbgpmbiBwZXJmb3JtTmV0d29ya1BhcnRpdGlvblRlc3Qobm9kZV9jb3VudDogaTMyKSB7CiAgICBwcmludGxuSW50KDI1MzAxKTsgLy8gU3RhcnQgbmV0d29yayBwYXJ0aXRpb24gdGVzdAogICAgCiAgICAvLyBDcmVhdGUgbmV0d29yayB0b3BvbG9neSBtYXRyaXgKICAgIGxldCBtdXQgbmV0d29ya19jb25uZWN0aXZpdHk6IFtbYm9vbDsgN107IDddID0gW1t0cnVlOyA3XTsgN107CiAgICBsZXQgbXV0IHBhcnRpdGlvbl9ncm91cHM6IFtpMzI7IDddID0gWzA7IDddOyAvLyBXaGljaCBwYXJ0aXRpb24gZWFjaCBub2RlIGJlbG9uZ3MgdG8KICAgIAogICAgLy8gU2ltdWxhdGUgdmFyaW91cyBwYXJ0aXRpb24gc2NlbmFyaW9zCiAgICBsZXQgbXV0IHBhcnRpdGlvbl9zY2VuYXJpbzogaTMyID0gMDsKICAgIHdoaWxlIChwYXJ0aXRpb25fc2NlbmFyaW8gPCAxMCkgewogICAgICAgIC8vIENyZWF0ZSBuZXR3b3JrIHBhcnRpdGlvbgogICAgICAgIGNyZWF0ZU5ldHdvcmtQYXJ0aXRpb24obm9kZV9jb3VudCwgJm11dCBuZXR3b3JrX2Nvbm5lY3Rpdml0eSwgJm11dCBwYXJ0aXRpb25fZ3JvdXBzLCBwYXJ0aXRpb25fc2NlbmFyaW8pOwogICAgICAgIAogICAgICAgIC8vIFRlc3QgY29uc2Vuc3VzIHVuZGVyIHBhcnRpdGlvbgogICAgICAgIGxldCBwYXJ0aXRpb25fY29uc2Vuc3VzOiBib29sID0gdGVzdENvbnNlbnN1c1VuZGVyUGFydGl0aW9uKAogICAgICAgICAgICBub2RlX2NvdW50LCAmbmV0d29ya19jb25uZWN0aXZpdHksICZwYXJ0aXRpb25fZ3JvdXBzCiAgICAgICAgKTsKICAgICAgICAKICAgICAgICBpZiAocGFydGl0aW9uX2NvbnNlbnN1cykgewogICAgICAgICAgICBwcmludGxuSW50KDI1MzAwICsgcGFydGl0aW9uX3NjZW5hcmlvKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy8gU2ltdWxhdGUgcGFydGl0aW9uIGhlYWxpbmcKICAgICAgICBoZWFsTmV0d29ya1BhcnRpdGlvbihub2RlX2NvdW50LCAmbXV0IG5ldHdvcmtfY29ubmVjdGl2aXR5LCAmbXV0IHBhcnRpdGlvbl9ncm91cHMpOwogICAgICAgIAogICAgICAgIC8vIFRlc3QgcmVjb3ZlcnkgYmVoYXZpb3IKICAgICAgICBsZXQgcmVjb3Zlcnlfc3VjY2VzczogYm9vbCA9IHRlc3RQYXJ0aXRpb25SZWNvdmVyeShub2RlX2NvdW50LCAmbmV0d29ya19jb25uZWN0aXZpdHkpOwogICAgICAgIAogICAgICAgIGlmIChyZWNvdmVyeV9zdWNjZXNzKSB7CiAgICAgICAgICAgIHByaW50bG5JbnQoMjUzMTAgKyBwYXJ0aXRpb25fc2NlbmFyaW8pOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwYXJ0aXRpb25fc2NlbmFyaW8gPSBwYXJ0aXRpb25fc2NlbmFyaW8gKyAxOwogICAgfQogICAgCiAgICBwcmludGxuSW50KDI1Mzk5KTsgLy8gRW5kIG5ldHdvcmsgcGFydGl0aW9uIHRlc3QKfQoKLy8gQ3JlYXRlIGNvbXBsZXggbmV0d29yayBwYXJ0aXRpb24gcGF0dGVybnMKZm4gY3JlYXRlTmV0d29ya1BhcnRpdGlvbigKICAgIG5vZGVfY291bnQ6IGkzMiwgCiAgICBuZXR3b3JrX2Nvbm5lY3Rpdml0eTogJm11dCBbW2Jvb2w7IDddOyA3XSwgCiAgICBwYXJ0aXRpb25fZ3JvdXBzOiAmbXV0IFtpMzI7IDddLAogICAgc2NlbmFyaW86IGkzMgopIHsKICAgIC8vIFJlc2V0IGNvbm5lY3Rpdml0eSBtYXRyaXgKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IG5vZGVfY291bnQpIHsKICAgICAgICAgICAgbmV0d29ya19jb25uZWN0aXZpdHlbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSBmYWxzZTsKICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIC8vIENyZWF0ZSBkaWZmZXJlbnQgcGFydGl0aW9uIHBhdHRlcm5zIGJhc2VkIG9uIHNjZW5hcmlvCiAgICBpZiAoKHNjZW5hcmlvICUgMykgPT0gMCkgewogICAgICAgIC8vIFNwbGl0IGludG8gdHdvIGVxdWFsIGdyb3VwcwogICAgICAgIGNyZWF0ZUJpbmFyeVBhcnRpdGlvbihub2RlX2NvdW50LCBuZXR3b3JrX2Nvbm5lY3Rpdml0eSwgcGFydGl0aW9uX2dyb3Vwcyk7CiAgICB9IGVsc2UgaWYgKChzY2VuYXJpbyAlIDMpID09IDEpIHsKICAgICAgICAvLyBDcmVhdGUgYXN5bW1ldHJpYyBwYXJ0aXRpb24gKG1ham9yaXR5IHZzIG1pbm9yaXR5KQogICAgICAgIGNyZWF0ZUFzeW1tZXRyaWNQYXJ0aXRpb24obm9kZV9jb3VudCwgbmV0d29ya19jb25uZWN0aXZpdHksIHBhcnRpdGlvbl9ncm91cHMpOwogICAgfSBlbHNlIHsKICAgICAgICAvLyBDcmVhdGUgY29tcGxleCBtdWx0aS13YXkgcGFydGl0aW9uCiAgICAgICAgY3JlYXRlTXVsdGl3YXlQYXJ0aXRpb24obm9kZV9jb3VudCwgbmV0d29ya19jb25uZWN0aXZpdHksIHBhcnRpdGlvbl9ncm91cHMpOwogICAgfQp9CgovLyBUZXN0IDQ6IExlYWRlciBFbGVjdGlvbiBVbmRlciBGYWlsdXJlIFNjZW5hcmlvcwpmbiBwZXJmb3JtTGVhZGVyRWxlY3Rpb25UZXN0KG5vZGVfY291bnQ6IGkzMikgewogICAgcHJpbnRsbkludCgyNTQwMSk7IC8vIFN0YXJ0IGxlYWRlciBlbGVjdGlvbiB0ZXN0CiAgICAKICAgIC8vIEluaXRpYWxpemUgY29tcGxleCBlbGVjdGlvbiBzdGF0ZQogICAgbGV0IG11dCBub2RlX3ByaW9yaXRpZXM6IFtpMzI7IDddID0gWzA7IDddOwogICAgbGV0IG11dCBub2RlX2hlYWx0aF9zdGF0dXM6IFtpMzI7IDddID0gWzEwMDsgN107IC8vIEhlYWx0aCBwZXJjZW50YWdlCiAgICBsZXQgZWxlY3Rpb25fdGltZW91dHM6IFtpMzI7IDddID0gWzA7IDddOwogICAgbGV0IG11dCBmYWlsdXJlX2RldGVjdG9yczogW1tib29sOyA3XTsgN10gPSBbW2ZhbHNlOyA3XTsgN107IC8vIE5vZGUgaSBkZXRlY3RzIGZhaWx1cmUgb2Ygbm9kZSBqCiAgICAKICAgIC8vIEdlbmVyYXRlIGluaXRpYWwgcHJpb3JpdGllcwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgbm9kZV9wcmlvcml0aWVzW2kgYXMgdXNpemVdID0gZ2VuZXJhdGVOb2RlUHJpb3JpdHkoaSk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICAvLyBTaW11bGF0ZSBtdWx0aXBsZSBlbGVjdGlvbiByb3VuZHMgd2l0aCBkaWZmZXJlbnQgZmFpbHVyZSBwYXR0ZXJucwogICAgbGV0IG11dCBlbGVjdGlvbl9yb3VuZDogaTMyID0gMDsKICAgIHdoaWxlIChlbGVjdGlvbl9yb3VuZCA8IDE1KSB7CiAgICAgICAgLy8gU2ltdWxhdGUgbm9kZSBmYWlsdXJlcwogICAgICAgIHNpbXVsYXRlTm9kZUZhaWx1cmVzKG5vZGVfY291bnQsICZtdXQgbm9kZV9oZWFsdGhfc3RhdHVzLCBlbGVjdGlvbl9yb3VuZCk7CiAgICAgICAgCiAgICAgICAgLy8gVXBkYXRlIGZhaWx1cmUgZGV0ZWN0b3JzCiAgICAgICAgdXBkYXRlRmFpbHVyZURldGVjdG9ycyhub2RlX2NvdW50LCAmbm9kZV9oZWFsdGhfc3RhdHVzLCAmbXV0IGZhaWx1cmVfZGV0ZWN0b3JzKTsKICAgICAgICAKICAgICAgICAvLyBDb25kdWN0IGVsZWN0aW9uIHdpdGggZmFpbHVyZSBhd2FyZW5lc3MKICAgICAgICBsZXQgZWxlY3RlZF9sZWFkZXI6IGkzMiA9IGNvbmR1Y3RGYWlsdXJlQXdhcmVFbGVjdGlvbigKICAgICAgICAgICAgbm9kZV9jb3VudCwgJm5vZGVfcHJpb3JpdGllcywgJm5vZGVfaGVhbHRoX3N0YXR1cywgJmZhaWx1cmVfZGV0ZWN0b3JzLCAmZWxlY3Rpb25fdGltZW91dHMKICAgICAgICApOwogICAgICAgIAogICAgICAgIGlmIChlbGVjdGVkX2xlYWRlciA+PSAwKSB7CiAgICAgICAgICAgIHByaW50bG5JbnQoMjU0MDAgKyBlbGVjdGVkX2xlYWRlcik7CiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBUZXN0IGxlYWRlciBzdGFiaWxpdHkgdW5kZXIgY29udGludWluZyBmYWlsdXJlcwogICAgICAgICAgICBsZXQgbGVhZGVyc2hpcF9zdGFibGU6IGJvb2wgPSB0ZXN0TGVhZGVyc2hpcFN0YWJpbGl0eSgKICAgICAgICAgICAgICAgIGVsZWN0ZWRfbGVhZGVyLCBub2RlX2NvdW50LCAmbm9kZV9oZWFsdGhfc3RhdHVzLCAmZmFpbHVyZV9kZXRlY3RvcnMKICAgICAgICAgICAgKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChsZWFkZXJzaGlwX3N0YWJsZSkgewogICAgICAgICAgICAgICAgcHJpbnRsbkludCgyNTQxMCArIGVsZWN0aW9uX3JvdW5kKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBTaW11bGF0ZSByZWNvdmVyeQogICAgICAgIHNpbXVsYXRlTm9kZVJlY292ZXJ5KG5vZGVfY291bnQsICZtdXQgbm9kZV9oZWFsdGhfc3RhdHVzKTsKICAgICAgICAKICAgICAgICBlbGVjdGlvbl9yb3VuZCA9IGVsZWN0aW9uX3JvdW5kICsgMTsKICAgIH0KICAgIAogICAgcHJpbnRsbkludCgyNTQ5OSk7IC8vIEVuZCBsZWFkZXIgZWxlY3Rpb24gdGVzdAp9CgovLyBUZXN0IDU6IEFzeW5jaHJvbm91cyBDb25zZW5zdXMgd2l0aCBNZXNzYWdlIERlbGF5cwpmbiBwZXJmb3JtQXN5bmNocm9ub3VzQ29uc2Vuc3VzVGVzdChub2RlX2NvdW50OiBpMzIsIG1heF9yb3VuZHM6IGkzMikgewogICAgcHJpbnRsbkludCgyNTUwMSk7IC8vIFN0YXJ0IGFzeW5jaHJvbm91cyBjb25zZW5zdXMgdGVzdAogICAgCiAgICAvLyBNZXNzYWdlIHF1ZXVlIHNpbXVsYXRpb24KICAgIGxldCBtdXQgbWVzc2FnZV9xdWV1ZTogW2kzMjsgMTAwMF0gPSBbMDsgMTAwMF07IC8vIENpcmN1bGFyIGJ1ZmZlciBmb3IgbWVzc2FnZXMKICAgIGxldCBtdXQgcXVldWVfaGVhZDogaTMyID0gMDsKICAgIGxldCBtdXQgcXVldWVfdGFpbDogaTMyID0gMDsKICAgIGxldCBtdXQgcXVldWVfc2l6ZTogaTMyID0gMDsKICAgIAogICAgLy8gTWVzc2FnZSBkZWxheSBzaW11bGF0aW9uCiAgICBsZXQgbXV0IG1lc3NhZ2VfZGVsYXlzOiBbaTMyOyAxMDAwXSA9IFswOyAxMDAwXTsKICAgIGxldCBtdXQgbWVzc2FnZV90aW1lc3RhbXBzOiBbaTMyOyAxMDAwXSA9IFswOyAxMDAwXTsKICAgIAogICAgLy8gTm9kZSBzdGF0ZSBmb3IgYXN5bmNocm9ub3VzIGNvbnNlbnN1cwogICAgbGV0IG11dCBub2RlX3Byb3Bvc2FsczogW2kzMjsgN10gPSBbMDsgN107CiAgICBsZXQgbXV0IG5vZGVfZGVjaXNpb25zOiBbaTMyOyA3XSA9IFstMTsgN107IC8vIC0xIG1lYW5zIG5vIGRlY2lzaW9uIHlldAogICAgbGV0IG11dCBjb25zZW5zdXNfdmFsdWVzOiBbaTMyOyAxMDBdID0gWzA7IDEwMF07IC8vIEhpc3Rvcnkgb2YgY29uc2Vuc3VzIHZhbHVlcwogICAgbGV0IG11dCBjb25zZW5zdXNfY291bnQ6IGkzMiA9IDA7CiAgICAKICAgIC8vIFNpbXVsYXRlIGFzeW5jaHJvbm91cyBjb25zZW5zdXMgcm91bmRzCiAgICBsZXQgbXV0IGFzeW5jX3JvdW5kOiBpMzIgPSAwOwogICAgd2hpbGUgKGFzeW5jX3JvdW5kIDwgbWF4X3JvdW5kcyAmJiBjb25zZW5zdXNfY291bnQgPCA1MCkgewogICAgICAgIC8vIEdlbmVyYXRlIHByb3Bvc2FscyB3aXRoIHZhcnlpbmcgZGVsYXlzCiAgICAgICAgZ2VuZXJhdGVBc3luY1Byb3Bvc2Fscyhub2RlX2NvdW50LCAmbXV0IG5vZGVfcHJvcG9zYWxzLCBhc3luY19yb3VuZCk7CiAgICAgICAgCiAgICAgICAgLy8gQWRkIHByb3Bvc2FscyB0byBtZXNzYWdlIHF1ZXVlIHdpdGggc2ltdWxhdGVkIGRlbGF5cwogICAgICAgIGVucXVldWVQcm9wb3NhbHNXaXRoRGVsYXlzKAogICAgICAgICAgICBub2RlX2NvdW50LCAmbm9kZV9wcm9wb3NhbHMsICZtdXQgbWVzc2FnZV9xdWV1ZSwgJm11dCBtZXNzYWdlX2RlbGF5cywgCiAgICAgICAgICAgICZtdXQgbWVzc2FnZV90aW1lc3RhbXBzLCAmbXV0IHF1ZXVlX2hlYWQsICZtdXQgcXVldWVfdGFpbCwgJm11dCBxdWV1ZV9zaXplLCBhc3luY19yb3VuZAogICAgICAgICk7CiAgICAgICAgCiAgICAgICAgLy8gUHJvY2VzcyBtZXNzYWdlcyBpbiBvcmRlciB3aXRoIGRlbGF5IHNpbXVsYXRpb24KICAgICAgICBsZXQgbWVzc2FnZXNfcHJvY2Vzc2VkOiBpMzIgPSBwcm9jZXNzQXN5bmNNZXNzYWdlcygKICAgICAgICAgICAgJm11dCBtZXNzYWdlX3F1ZXVlLCAmbXV0IG1lc3NhZ2VfZGVsYXlzLCAmbXV0IG1lc3NhZ2VfdGltZXN0YW1wcywKICAgICAgICAgICAgJm11dCBxdWV1ZV9oZWFkLCAmbXV0IHF1ZXVlX3RhaWwsICZtdXQgcXVldWVfc2l6ZSwgJm11dCBub2RlX2RlY2lzaW9ucywgYXN5bmNfcm91bmQKICAgICAgICApOwogICAgICAgIAogICAgICAgIGlmIChtZXNzYWdlc19wcm9jZXNzZWQgPiAwKSB7CiAgICAgICAgICAgIC8vIENoZWNrIGZvciBjb25zZW5zdXMKICAgICAgICAgICAgbGV0IGNvbnNlbnN1c19yZWFjaGVkOiBib29sID0gY2hlY2tBc3luY0NvbnNlbnN1cyhub2RlX2NvdW50LCAmbm9kZV9kZWNpc2lvbnMpOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKGNvbnNlbnN1c19yZWFjaGVkKSB7CiAgICAgICAgICAgICAgICBsZXQgY29uc2Vuc3VzX3ZhbHVlOiBpMzIgPSBleHRyYWN0Q29uc2Vuc3VzVmFsdWUobm9kZV9jb3VudCwgJm5vZGVfZGVjaXNpb25zKTsKICAgICAgICAgICAgICAgIGNvbnNlbnN1c192YWx1ZXNbY29uc2Vuc3VzX2NvdW50IGFzIHVzaXplXSA9IGNvbnNlbnN1c192YWx1ZTsKICAgICAgICAgICAgICAgIGNvbnNlbnN1c19jb3VudCA9IGNvbnNlbnN1c19jb3VudCArIDE7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHByaW50bG5JbnQoMjU1MDAgKyBjb25zZW5zdXNfY291bnQpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBSZXNldCBmb3IgbmV4dCBjb25zZW5zdXMgcm91bmQKICAgICAgICAgICAgICAgIHJlc2V0Tm9kZURlY2lzaW9ucyhub2RlX2NvdW50LCAmbXV0IG5vZGVfZGVjaXNpb25zKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICBhc3luY19yb3VuZCA9IGFzeW5jX3JvdW5kICsgMTsKICAgIH0KICAgIAogICAgLy8gVmVyaWZ5IGNvbnNlbnN1cyBoaXN0b3J5IGNvbnNpc3RlbmN5CiAgICBsZXQgaGlzdG9yeV9jb25zaXN0ZW50OiBib29sID0gdmVyaWZ5Q29uc2Vuc3VzSGlzdG9yeSgmY29uc2Vuc3VzX3ZhbHVlcywgY29uc2Vuc3VzX2NvdW50KTsKICAgIGlmIChoaXN0b3J5X2NvbnNpc3RlbnQpIHsKICAgICAgICBwcmludGxuSW50KDI1NTUwKTsKICAgIH0KICAgIAogICAgcHJpbnRsbkludCgyNTU5OSk7IC8vIEVuZCBhc3luY2hyb25vdXMgY29uc2Vuc3VzIHRlc3QKfQoKLy8gVXRpbGl0eSBGdW5jdGlvbnMgZm9yIENvbXBsZXggQ2FsY3VsYXRpb25zCgpmbiBmaW5kTWF4VGVybSh0ZXJtczogJiBbaTMyOyA3XSwgY291bnQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgbWF4X3Rlcm06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IGNvdW50KSB7CiAgICAgICAgaWYgKHRlcm1zW2kgYXMgdXNpemVdID4gbWF4X3Rlcm0pIHsKICAgICAgICAgICAgbWF4X3Rlcm0gPSB0ZXJtc1tpIGFzIHVzaXplXTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcmV0dXJuIG1heF90ZXJtOwp9CgpmbiBzaG91bGRCZWNvbWVDYW5kaWRhdGUobm9kZV9pZDogaTMyLCBjdXJyZW50X3N0YXRlOiBpMzIsIGN1cnJlbnRfdGVybTogaTMyLCBuZXdfdGVybTogaTMyKSAtPiBib29sIHsKICAgIC8vIENvbXBsZXggaGV1cmlzdGljIGZvciBjYW5kaWRhdGUgYW5ub3VuY2VtZW50CiAgICBpZiAoY3VycmVudF9zdGF0ZSA9PSAyKSB7IC8vIEFscmVhZHkgbGVhZGVyCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgCiAgICBsZXQgY2FuZGlkYWN5X3Byb2JhYmlsaXR5OiBpMzIgPSAobm9kZV9pZCAqIDE3ICsgbmV3X3Rlcm0gKiA3KSAlIDEwMDsKICAgIHJldHVybiBjYW5kaWRhY3lfcHJvYmFiaWxpdHkgPCAzMDsgLy8gMzAlIGNoYW5jZSB0byBiZWNvbWUgY2FuZGlkYXRlCn0KCmZuIGFicyh4OiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoeCA8IDApIHsKICAgICAgICByZXR1cm4gLXg7CiAgICB9CiAgICByZXR1cm4geDsKfQoKZm4gZ2VuZXJhdGVMb2dFbnRyeShsZWFkZXJfaWQ6IGkzMiwgbG9nX3Bvc2l0aW9uOiBpMzIpIC0+IGkzMiB7CiAgICByZXR1cm4gKGxlYWRlcl9pZCAqIDEwMDApICsgKGxvZ19wb3NpdGlvbiAqIDEwKSArICgobGVhZGVyX2lkICsgbG9nX3Bvc2l0aW9uKSAlIDcpOwp9CgpmbiBzaW11bGF0ZU5ldHdvcmtSZWxpYWJpbGl0eShmcm9tX25vZGU6IGkzMiwgdG9fbm9kZTogaTMyKSAtPiBib29sIHsKICAgIGxldCByZWxpYWJpbGl0eV9mYWN0b3I6IGkzMiA9IChmcm9tX25vZGUgKiAxMyArIHRvX25vZGUgKiAxOSkgJSAxMDA7CiAgICByZXR1cm4gcmVsaWFiaWxpdHlfZmFjdG9yID4gMTU7IC8vIDg1JSBuZXR3b3JrIHJlbGlhYmlsaXR5Cn0KCmZuIGNoZWNrTG9nQ29uc2lzdGVuY3kobGVhZGVyX2lkOiBpMzIsIGZvbGxvd2VyX2lkOiBpMzIsIG5vZGVfbG9nczogJltbaTMyOyAxMDBdOyA3XSwgbG9nX2xlbmd0aHM6ICYgW2kzMjsgN10pIC0+IGJvb2wgewogICAgaWYgKGxvZ19sZW5ndGhzW2ZvbGxvd2VyX2lkIGFzIHVzaXplXSA+IGxvZ19sZW5ndGhzW2xlYWRlcl9pZCBhcyB1c2l6ZV0pIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbG9nX2xlbmd0aHNbZm9sbG93ZXJfaWQgYXMgdXNpemVdKSB7CiAgICAgICAgaWYgKG5vZGVfbG9nc1tsZWFkZXJfaWQgYXMgdXNpemVdW2kgYXMgdXNpemVdICE9IG5vZGVfbG9nc1tmb2xsb3dlcl9pZCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiB0cnVlOwp9CgpmbiB2ZXJpZnlMb2dDb25zaXN0ZW5jeShub2RlX2NvdW50OiBpMzIsIG5vZGVfbG9nczogJltbaTMyOyAxMDBdOyA3XSwgbG9nX2xlbmd0aHM6ICYgW2kzMjsgN10pIC0+IGJvb2wgewogICAgaWYgKG5vZGVfY291bnQgPD0gMSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICBsZXQgcmVmZXJlbmNlX2xlbmd0aDogaTMyID0gbG9nX2xlbmd0aHNbMF07CiAgICBsZXQgbXV0IGk6IGkzMiA9IDE7CiAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICBpZiAobG9nX2xlbmd0aHNbaSBhcyB1c2l6ZV0gIT0gcmVmZXJlbmNlX2xlbmd0aCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgLy8gQ2hlY2sgbG9nIGNvbnRlbnQgY29uc2lzdGVuY3kKICAgIGxldCBtdXQgbG9nX3BvczogaTMyID0gMDsKICAgIHdoaWxlIChsb2dfcG9zIDwgcmVmZXJlbmNlX2xlbmd0aCkgewogICAgICAgIGxldCByZWZlcmVuY2VfZW50cnk6IGkzMiA9IG5vZGVfbG9nc1swXVtsb2dfcG9zIGFzIHVzaXplXTsKICAgICAgICBsZXQgbXV0IG5vZGVfaWQ6IGkzMiA9IDE7CiAgICAgICAgd2hpbGUgKG5vZGVfaWQgPCBub2RlX2NvdW50KSB7CiAgICAgICAgICAgIGlmIChub2RlX2xvZ3Nbbm9kZV9pZCBhcyB1c2l6ZV1bbG9nX3BvcyBhcyB1c2l6ZV0gIT0gcmVmZXJlbmNlX2VudHJ5KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbm9kZV9pZCA9IG5vZGVfaWQgKyAxOwogICAgICAgIH0KICAgICAgICBsb2dfcG9zID0gbG9nX3BvcyArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiB0cnVlOwp9CgovLyBCeXphbnRpbmUtc3BlY2lmaWMgdXRpbGl0eSBmdW5jdGlvbnMKCmZuIHNob3VsZEJlQnl6YW50aW5lKG5vZGVfaWQ6IGkzMikgLT4gYm9vbCB7CiAgICAvLyBEZXRlcm1pbmlzdGljIHNlbGVjdGlvbiBvZiBCeXphbnRpbmUgbm9kZXMKICAgIHJldHVybiAoKG5vZGVfaWQgKiAyMykgJSA3KSA8IDI7IC8vIEFwcHJveGltYXRlbHkgMi83IG5vZGVzIGFyZSBCeXphbnRpbmUKfQoKZm4gZ2VuZXJhdGVNYWxpY2lvdXNWYWx1ZShub2RlX2lkOiBpMzIsIHJvdW5kOiBpMzIsIHZhcmlhbnQ6IGkzMikgLT4gaTMyIHsKICAgIC8vIEdlbmVyYXRlIGNvbmZsaWN0aW5nIHZhbHVlcyBmb3IgQnl6YW50aW5lIGJlaGF2aW9yCiAgICByZXR1cm4gKG5vZGVfaWQgKiAxMDApICsgKHJvdW5kICogMTApICsgdmFyaWFudCArIDk5OTk7Cn0KCmZuIGdlbmVyYXRlSG9uZXN0VmFsdWUobm9kZV9pZDogaTMyLCByb3VuZDogaTMyKSAtPiBpMzIgewogICAgLy8gSG9uZXN0IG5vZGVzIGdlbmVyYXRlIGNvbnNpc3RlbnQgdmFsdWVzCiAgICByZXR1cm4gKHJvdW5kICogNDIpICsgMTAwMDsKfQoKZm4gZ2VuZXJhdGVTaWduYXR1cmUoc2lnbmVyOiBpMzIsIHByb3Bvc2FsX293bmVyOiBpMzIsIHZhbHVlOiBpMzIsIHJvdW5kOiBpMzIpIC0+IGkzMiB7CiAgICAvLyBTaW1wbGlmaWVkIGRpZ2l0YWwgc2lnbmF0dXJlIHNpbXVsYXRpb24KICAgIHJldHVybiAoc2lnbmVyICogMTAwMCkgKyAocHJvcG9zYWxfb3duZXIgKiAxMDApICsgKHZhbHVlICUgMTAwKSArIChyb3VuZCAlIDEwKTsKfQoKZm4gY29ycnVwdFNpZ25hdHVyZShvcmlnaW5hbF9zaWduYXR1cmU6IGkzMiwgc2lnbmVyOiBpMzIsIHRhcmdldDogaTMyKSAtPiBpMzIgewogICAgLy8gQnl6YW50aW5lIG5vZGVzIGNvcnJ1cHQgc2lnbmF0dXJlcwogICAgbGV0IGNvcnJ1cHRpb25fZmFjdG9yOiBpMzIgPSAoc2lnbmVyICogNyArIHRhcmdldCAqIDExKSAlIDEwMDA7CiAgICByZXR1cm4gb3JpZ2luYWxfc2lnbmF0dXJlICsgY29ycnVwdGlvbl9mYWN0b3I7Cn0KCmZuIGNvdW50VmFsaWRTaWduYXR1cmVzKAogICAgcHJvcG9zYWxfaWQ6IGkzMiwgCiAgICBub2RlX2NvdW50OiBpMzIsIAogICAgc2lnbmF0dXJlX21hdHJpeDogJltbaTMyOyA3XTsgN10sIAogICAgY29uc2Vuc3VzX3Byb3Bvc2FsczogJltbaTMyOyAzXTsgN10sCiAgICBieXphbnRpbmVfbm9kZXM6ICZbYm9vbDsgN10KKSAtPiBpMzIgewogICAgbGV0IG11dCB2YWxpZF9zaWduYXR1cmVzOiBpMzIgPSAwOwogICAgCiAgICBsZXQgbXV0IHNpZ25lcjogaTMyID0gMDsKICAgIHdoaWxlIChzaWduZXIgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaWYgKCFieXphbnRpbmVfbm9kZXNbc2lnbmVyIGFzIHVzaXplXSkgeyAvLyBPbmx5IGNvdW50IHNpZ25hdHVyZXMgZnJvbSBob25lc3Qgbm9kZXMKICAgICAgICAgICAgbGV0IGV4cGVjdGVkX3NpZ25hdHVyZTogaTMyID0gZ2VuZXJhdGVTaWduYXR1cmUoCiAgICAgICAgICAgICAgICBzaWduZXIsIHByb3Bvc2FsX2lkLCBjb25zZW5zdXNfcHJvcG9zYWxzW3Byb3Bvc2FsX2lkIGFzIHVzaXplXVswXSwgMAogICAgICAgICAgICApOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gU2ltcGxpZmllZCBzaWduYXR1cmUgdmVyaWZpY2F0aW9uCiAgICAgICAgICAgIGxldCBzaWduYXR1cmVfdmFsaWQ6IGJvb2wgPSB2ZXJpZnlTaWduYXR1cmUoCiAgICAgICAgICAgICAgICBzaWduYXR1cmVfbWF0cml4W3NpZ25lciBhcyB1c2l6ZV1bcHJvcG9zYWxfaWQgYXMgdXNpemVdLCBleHBlY3RlZF9zaWduYXR1cmUKICAgICAgICAgICAgKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChzaWduYXR1cmVfdmFsaWQpIHsKICAgICAgICAgICAgICAgIHZhbGlkX3NpZ25hdHVyZXMgPSB2YWxpZF9zaWduYXR1cmVzICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzaWduZXIgPSBzaWduZXIgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gdmFsaWRfc2lnbmF0dXJlczsKfQoKZm4gdmVyaWZ5U2lnbmF0dXJlKHJlY2VpdmVkX3NpZ25hdHVyZTogaTMyLCBleHBlY3RlZF9zaWduYXR1cmU6IGkzMikgLT4gYm9vbCB7CiAgICAvLyBTaW1wbGlmaWVkIHNpZ25hdHVyZSB2ZXJpZmljYXRpb24gd2l0aCBzb21lIHRvbGVyYW5jZQogICAgbGV0IGRpZmZlcmVuY2U6IGkzMiA9IGFicyhyZWNlaXZlZF9zaWduYXR1cmUgLSBleHBlY3RlZF9zaWduYXR1cmUpOwogICAgcmV0dXJuIGRpZmZlcmVuY2UgPCAxMDA7IC8vIEFsbG93IHNtYWxsIHZhcmlhdGlvbnMKfQoKZm4gY2hlY2tQcm9wb3NhbEFncmVlbWVudCgKICAgIG5vZGVfY291bnQ6IGkzMiwgCiAgICB2YWxpZF9wcm9wb3NhbHM6ICZbYm9vbDsgN10sIAogICAgY29uc2Vuc3VzX3Byb3Bvc2FsczogJltbaTMyOyAzXTsgN10KKSAtPiBib29sIHsKICAgIGxldCBtdXQgZmlyc3RfdmFsaWRfdmFsdWU6IGkzMiA9IC0xOwogICAgbGV0IG11dCBmb3VuZF9maXJzdDogYm9vbCA9IGZhbHNlOwogICAgCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICBpZiAodmFsaWRfcHJvcG9zYWxzW2kgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIGlmICghZm91bmRfZmlyc3QpIHsKICAgICAgICAgICAgICAgIGZpcnN0X3ZhbGlkX3ZhbHVlID0gY29uc2Vuc3VzX3Byb3Bvc2Fsc1tpIGFzIHVzaXplXVswXTsKICAgICAgICAgICAgICAgIGZvdW5kX2ZpcnN0ID0gdHJ1ZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChjb25zZW5zdXNfcHJvcG9zYWxzW2kgYXMgdXNpemVdWzBdICE9IGZpcnN0X3ZhbGlkX3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBEaXNhZ3JlZW1lbnQgZm91bmQKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiBmb3VuZF9maXJzdDsgLy8gQWdyZWVtZW50IGlmIChhdCBsZWFzdCBvbmUgdmFsaWQgcHJvcG9zYWwgZXhpc3RzKQp9CgpmbiB2ZXJpZnlIb25lc3ROb2RlQWdyZWVtZW50KAogICAgbm9kZV9jb3VudDogaTMyLCAKICAgIGJ5emFudGluZV9ub2RlczogJltib29sOyA3XSwgCiAgICBjb25zZW5zdXNfcHJvcG9zYWxzOiAmW1tpMzI7IDNdOyA3XQopIC0+IGJvb2wgewogICAgbGV0IG11dCBob25lc3RfdmFsdWU6IGkzMiA9IC0xOwogICAgbGV0IG11dCBmb3VuZF9ob25lc3RfdmFsdWU6IGJvb2wgPSBmYWxzZTsKICAgIAogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaWYgKCFieXphbnRpbmVfbm9kZXNbaSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgaWYgKCFmb3VuZF9ob25lc3RfdmFsdWUpIHsKICAgICAgICAgICAgICAgIGhvbmVzdF92YWx1ZSA9IGNvbnNlbnN1c19wcm9wb3NhbHNbaSBhcyB1c2l6ZV1bMF07CiAgICAgICAgICAgICAgICBmb3VuZF9ob25lc3RfdmFsdWUgPSB0cnVlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKGNvbnNlbnN1c19wcm9wb3NhbHNbaSBhcyB1c2l6ZV1bMF0gIT0gaG9uZXN0X3ZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIGZvdW5kX2hvbmVzdF92YWx1ZTsKfQoKLy8gTmV0d29yayBwYXJ0aXRpb24gdXRpbGl0eSBmdW5jdGlvbnMKCmZuIGNyZWF0ZUJpbmFyeVBhcnRpdGlvbigKICAgIG5vZGVfY291bnQ6IGkzMiwgCiAgICBuZXR3b3JrX2Nvbm5lY3Rpdml0eTogJm11dCBbW2Jvb2w7IDddOyA3XSwgCiAgICBwYXJ0aXRpb25fZ3JvdXBzOiAmbXV0IFtpMzI7IDddCikgewogICAgbGV0IHBhcnRpdGlvbl9zaXplOiBpMzIgPSBub2RlX2NvdW50IC8gMjsKICAgIAogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaWYgKGkgPCBwYXJ0aXRpb25fc2l6ZSkgewogICAgICAgICAgICBwYXJ0aXRpb25fZ3JvdXBzW2kgYXMgdXNpemVdID0gMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwYXJ0aXRpb25fZ3JvdXBzW2kgYXMgdXNpemVdID0gMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICAvLyBDcmVhdGUgY29ubmVjdGl2aXR5IHdpdGhpbiBwYXJ0aXRpb25zCiAgICB1cGRhdGVDb25uZWN0aXZpdHlNYXRyaXgobm9kZV9jb3VudCwgbmV0d29ya19jb25uZWN0aXZpdHksIHBhcnRpdGlvbl9ncm91cHMpOwp9CgpmbiBjcmVhdGVBc3ltbWV0cmljUGFydGl0aW9uKAogICAgbm9kZV9jb3VudDogaTMyLCAKICAgIG5ldHdvcmtfY29ubmVjdGl2aXR5OiAmbXV0IFtbYm9vbDsgN107IDddLCAKICAgIHBhcnRpdGlvbl9ncm91cHM6ICZtdXQgW2kzMjsgN10KKSB7CiAgICBsZXQgbWFqb3JpdHlfc2l6ZTogaTMyID0gKG5vZGVfY291bnQgKiAyKSAvIDM7CiAgICAKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIGlmIChpIDwgbWFqb3JpdHlfc2l6ZSkgewogICAgICAgICAgICBwYXJ0aXRpb25fZ3JvdXBzW2kgYXMgdXNpemVdID0gMDsgLy8gTWFqb3JpdHkgcGFydGl0aW9uCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcGFydGl0aW9uX2dyb3Vwc1tpIGFzIHVzaXplXSA9IDE7IC8vIE1pbm9yaXR5IHBhcnRpdGlvbgogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIHVwZGF0ZUNvbm5lY3Rpdml0eU1hdHJpeChub2RlX2NvdW50LCBuZXR3b3JrX2Nvbm5lY3Rpdml0eSwgcGFydGl0aW9uX2dyb3Vwcyk7Cn0KCmZuIGNyZWF0ZU11bHRpd2F5UGFydGl0aW9uKAogICAgbm9kZV9jb3VudDogaTMyLCAKICAgIG5ldHdvcmtfY29ubmVjdGl2aXR5OiAmbXV0IFtbYm9vbDsgN107IDddLCAKICAgIHBhcnRpdGlvbl9ncm91cHM6ICZtdXQgW2kzMjsgN10KKSB7CiAgICAvLyBDcmVhdGUgMy13YXkgcGFydGl0aW9uCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICBwYXJ0aXRpb25fZ3JvdXBzW2kgYXMgdXNpemVdID0gaSAlIDM7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICB1cGRhdGVDb25uZWN0aXZpdHlNYXRyaXgobm9kZV9jb3VudCwgbmV0d29ya19jb25uZWN0aXZpdHksIHBhcnRpdGlvbl9ncm91cHMpOwp9CgpmbiB1cGRhdGVDb25uZWN0aXZpdHlNYXRyaXgoCiAgICBub2RlX2NvdW50OiBpMzIsIAogICAgbmV0d29ya19jb25uZWN0aXZpdHk6ICZtdXQgW1tib29sOyA3XTsgN10sIAogICAgcGFydGl0aW9uX2dyb3VwczogJiBbaTMyOyA3XQopIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IG5vZGVfY291bnQpIHsKICAgICAgICAgICAgaWYgKGkgPT0gaikgewogICAgICAgICAgICAgICAgbmV0d29ya19jb25uZWN0aXZpdHlbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSB0cnVlOyAvLyBOb2RlIGNhbiBhbHdheXMgdGFsayB0byBpdHNlbGYKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG5ldHdvcmtfY29ubmVjdGl2aXR5W2kgYXMgdXNpemVdW2ogYXMgdXNpemVdID0gcGFydGl0aW9uX2dyb3Vwc1tpIGFzIHVzaXplXSA9PSBwYXJ0aXRpb25fZ3JvdXBzW2ogYXMgdXNpemVdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgpmbiB0ZXN0Q29uc2Vuc3VzVW5kZXJQYXJ0aXRpb24oCiAgICBub2RlX2NvdW50OiBpMzIsIAogICAgbmV0d29ya19jb25uZWN0aXZpdHk6ICZbW2Jvb2w7IDddOyA3XSwgCiAgICBwYXJ0aXRpb25fZ3JvdXBzOiAmIFtpMzI7IDddCikgLT4gYm9vbCB7CiAgICAvLyBUZXN0IGlmIGVhY2ggcGFydGl0aW9uIGNhbiBhY2hpZXZlIGludGVybmFsIGNvbnNlbnN1cwogICAgbGV0IG1heF9wYXJ0aXRpb25faWQ6IGkzMiA9IGZpbmRNYXhQYXJ0aXRpb25JZChub2RlX2NvdW50LCBwYXJ0aXRpb25fZ3JvdXBzKTsKICAgIAogICAgbGV0IG11dCBwYXJ0aXRpb25faWQ6IGkzMiA9IDA7CiAgICB3aGlsZSAocGFydGl0aW9uX2lkIDw9IG1heF9wYXJ0aXRpb25faWQpIHsKICAgICAgICBsZXQgcGFydGl0aW9uX3NpemU6IGkzMiA9IGNvdW50UGFydGl0aW9uU2l6ZShub2RlX2NvdW50LCBwYXJ0aXRpb25fZ3JvdXBzLCBwYXJ0aXRpb25faWQpOwogICAgICAgIAogICAgICAgIGlmIChwYXJ0aXRpb25fc2l6ZSA+IDApIHsKICAgICAgICAgICAgbGV0IGludGVybmFsX2NvbnNlbnN1czogYm9vbCA9IHRlc3RQYXJ0aXRpb25JbnRlcm5hbENvbnNlbnN1cygKICAgICAgICAgICAgICAgIG5vZGVfY291bnQsIHBhcnRpdGlvbl9ncm91cHMsIHBhcnRpdGlvbl9pZCwgbmV0d29ya19jb25uZWN0aXZpdHkKICAgICAgICAgICAgKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICghaW50ZXJuYWxfY29uc2Vuc3VzKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcGFydGl0aW9uX2lkID0gcGFydGl0aW9uX2lkICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIHRydWU7Cn0KCmZuIGhlYWxOZXR3b3JrUGFydGl0aW9uKAogICAgbm9kZV9jb3VudDogaTMyLCAKICAgIG5ldHdvcmtfY29ubmVjdGl2aXR5OiAmbXV0IFtbYm9vbDsgN107IDddLCAKICAgIHBhcnRpdGlvbl9ncm91cHM6ICZtdXQgW2kzMjsgN10KKSB7CiAgICAvLyBSZXN0b3JlIGZ1bGwgY29ubmVjdGl2aXR5CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICBwYXJ0aXRpb25fZ3JvdXBzW2kgYXMgdXNpemVdID0gMDsgLy8gQWxsIG5vZGVzIGluIHNhbWUgcGFydGl0aW9uCiAgICAgICAgCiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgbm9kZV9jb3VudCkgewogICAgICAgICAgICBuZXR3b3JrX2Nvbm5lY3Rpdml0eVtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgpmbiB0ZXN0UGFydGl0aW9uUmVjb3Zlcnkobm9kZV9jb3VudDogaTMyLCBuZXR3b3JrX2Nvbm5lY3Rpdml0eTogJltbYm9vbDsgN107IDddKSAtPiBib29sIHsKICAgIC8vIFZlcmlmeSB0aGF0IGFsbCBub2RlcyBjYW4gY29tbXVuaWNhdGUgYWZ0ZXIgcGFydGl0aW9uIGhlYWxpbmcKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IG5vZGVfY291bnQpIHsKICAgICAgICAgICAgaWYgKCFuZXR3b3JrX2Nvbm5lY3Rpdml0eVtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gdHJ1ZTsKfQoKLy8gTGVhZGVyIGVsZWN0aW9uIHV0aWxpdHkgZnVuY3Rpb25zCgpmbiBnZW5lcmF0ZU5vZGVQcmlvcml0eShub2RlX2lkOiBpMzIpIC0+IGkzMiB7CiAgICAvLyBHZW5lcmF0ZSBkZXRlcm1pbmlzdGljIGJ1dCB2YXJpZWQgcHJpb3JpdGllcwogICAgcmV0dXJuIChub2RlX2lkICogMTQ3ICsgNzMpICUgMTAwMDsKfQoKZm4gc2ltdWxhdGVOb2RlRmFpbHVyZXMobm9kZV9jb3VudDogaTMyLCBub2RlX2hlYWx0aF9zdGF0dXM6ICZtdXQgW2kzMjsgN10sIHJvdW5kOiBpMzIpIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIGxldCBmYWlsdXJlX3Byb2JhYmlsaXR5OiBpMzIgPSAoaSAqIDE5ICsgcm91bmQgKiA3KSAlIDEwMDsKICAgICAgICAKICAgICAgICBpZiAoZmFpbHVyZV9wcm9iYWJpbGl0eSA8IDIwKSB7IC8vIDIwJSBjaGFuY2Ugb2YgaGVhbHRoIGRlZ3JhZGF0aW9uCiAgICAgICAgICAgIG5vZGVfaGVhbHRoX3N0YXR1c1tpIGFzIHVzaXplXSA9IG5vZGVfaGVhbHRoX3N0YXR1c1tpIGFzIHVzaXplXSAtIDI1OwogICAgICAgICAgICBpZiAobm9kZV9oZWFsdGhfc3RhdHVzW2kgYXMgdXNpemVdIDwgMCkgewogICAgICAgICAgICAgICAgbm9kZV9oZWFsdGhfc3RhdHVzW2kgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCmZuIHVwZGF0ZUZhaWx1cmVEZXRlY3RvcnMoCiAgICBub2RlX2NvdW50OiBpMzIsIAogICAgbm9kZV9oZWFsdGhfc3RhdHVzOiAmIFtpMzI7IDddLCAKICAgIGZhaWx1cmVfZGV0ZWN0b3JzOiAmbXV0IFtbYm9vbDsgN107IDddCikgewogICAgbGV0IG11dCBkZXRlY3RvcjogaTMyID0gMDsKICAgIHdoaWxlIChkZXRlY3RvciA8IG5vZGVfY291bnQpIHsKICAgICAgICBsZXQgbXV0IHRhcmdldDogaTMyID0gMDsKICAgICAgICB3aGlsZSAodGFyZ2V0IDwgbm9kZV9jb3VudCkgewogICAgICAgICAgICBpZiAoZGV0ZWN0b3IgIT0gdGFyZ2V0KSB7CiAgICAgICAgICAgICAgICAvLyBGYWlsdXJlIGRldGVjdGVkIGlmIHRhcmdldCBoZWFsdGggaXMgYmVsb3cgdGhyZXNob2xkCiAgICAgICAgICAgICAgICBmYWlsdXJlX2RldGVjdG9yc1tkZXRlY3RvciBhcyB1c2l6ZV1bdGFyZ2V0IGFzIHVzaXplXSA9IG5vZGVfaGVhbHRoX3N0YXR1c1t0YXJnZXQgYXMgdXNpemVdIDwgMzA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0ICsgMTsKICAgICAgICB9CiAgICAgICAgZGV0ZWN0b3IgPSBkZXRlY3RvciArIDE7CiAgICB9Cn0KCmZuIGNvbmR1Y3RGYWlsdXJlQXdhcmVFbGVjdGlvbigKICAgIG5vZGVfY291bnQ6IGkzMiwKICAgIG5vZGVfcHJpb3JpdGllczogJiBbaTMyOyA3XSwKICAgIG5vZGVfaGVhbHRoX3N0YXR1czogJiBbaTMyOyA3XSwKICAgIGZhaWx1cmVfZGV0ZWN0b3JzOiAmIFtbYm9vbDsgN107IDddLAogICAgZWxlY3Rpb25fdGltZW91dHM6ICYgW2kzMjsgN10sCikgLT4gaTMyIHsKICAgIGxldCBtdXQgYmVzdF9jYW5kaWRhdGU6IGkzMiA9IC0xOwogICAgbGV0IG11dCBiZXN0X3Njb3JlOiBpMzIgPSAtMTsKICAgIAogICAgbGV0IG11dCBjYW5kaWRhdGU6IGkzMiA9IDA7CiAgICB3aGlsZSAoY2FuZGlkYXRlIDwgbm9kZV9jb3VudCkgewogICAgICAgIGlmIChub2RlX2hlYWx0aF9zdGF0dXNbY2FuZGlkYXRlIGFzIHVzaXplXSA+IDMwKSB7IC8vIEhlYWx0aHkgZW5vdWdoIHRvIGJlIGxlYWRlcgogICAgICAgICAgICBsZXQgZmFpbHVyZV9jb3VudDogaTMyID0gY291bnREZXRlY3RlZEZhaWx1cmVzKGNhbmRpZGF0ZSwgbm9kZV9jb3VudCwgZmFpbHVyZV9kZXRlY3RvcnMpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGNvbXBvc2l0ZSBzY29yZQogICAgICAgICAgICBsZXQgaGVhbHRoX3Njb3JlOiBpMzIgPSBub2RlX2hlYWx0aF9zdGF0dXNbY2FuZGlkYXRlIGFzIHVzaXplXSAqIDEwOwogICAgICAgICAgICBsZXQgcHJpb3JpdHlfc2NvcmU6IGkzMiA9IG5vZGVfcHJpb3JpdGllc1tjYW5kaWRhdGUgYXMgdXNpemVdOwogICAgICAgICAgICBsZXQgcmVsaWFiaWxpdHlfc2NvcmU6IGkzMiA9IChub2RlX2NvdW50IC0gZmFpbHVyZV9jb3VudCkgKiAxMDA7CiAgICAgICAgICAgIAogICAgICAgICAgICBsZXQgdG90YWxfc2NvcmU6IGkzMiA9IGhlYWx0aF9zY29yZSArIHByaW9yaXR5X3Njb3JlICsgcmVsaWFiaWxpdHlfc2NvcmU7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAodG90YWxfc2NvcmUgPiBiZXN0X3Njb3JlKSB7CiAgICAgICAgICAgICAgICBiZXN0X3Njb3JlID0gdG90YWxfc2NvcmU7CiAgICAgICAgICAgICAgICBiZXN0X2NhbmRpZGF0ZSA9IGNhbmRpZGF0ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYW5kaWRhdGUgPSBjYW5kaWRhdGUgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gYmVzdF9jYW5kaWRhdGU7Cn0KCmZuIHRlc3RMZWFkZXJzaGlwU3RhYmlsaXR5KAogICAgbGVhZGVyX2lkOiBpMzIsCiAgICBub2RlX2NvdW50OiBpMzIsCiAgICBub2RlX2hlYWx0aF9zdGF0dXM6ICYgW2kzMjsgN10sCiAgICBmYWlsdXJlX2RldGVjdG9yczogJiBbW2Jvb2w7IDddOyA3XQopIC0+IGJvb2wgewogICAgLy8gQ2hlY2sgaWYgbGVhZGVyIGlzIHN0aWxsIGNvbnNpZGVyZWQgdmlhYmxlIGJ5IG1ham9yaXR5CiAgICBsZXQgbXV0IHN1cHBvcnRfY291bnQ6IGkzMiA9IDA7CiAgICAKICAgIGxldCBtdXQgdm90ZXI6IGkzMiA9IDA7CiAgICB3aGlsZSAodm90ZXIgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaWYgKHZvdGVyICE9IGxlYWRlcl9pZCAmJiBub2RlX2hlYWx0aF9zdGF0dXNbdm90ZXIgYXMgdXNpemVdID4gMzApIHsKICAgICAgICAgICAgaWYgKCFmYWlsdXJlX2RldGVjdG9yc1t2b3RlciBhcyB1c2l6ZV1bbGVhZGVyX2lkIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgc3VwcG9ydF9jb3VudCA9IHN1cHBvcnRfY291bnQgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHZvdGVyID0gdm90ZXIgKyAxOwogICAgfQogICAgCiAgICBsZXQgcmVxdWlyZWRfc3VwcG9ydDogaTMyID0gKG5vZGVfY291bnQgLSAxKSAvIDI7IC8vIE1ham9yaXR5IG9mIG90aGVyIG5vZGVzCiAgICByZXR1cm4gc3VwcG9ydF9jb3VudCA+PSByZXF1aXJlZF9zdXBwb3J0Owp9CgpmbiBzaW11bGF0ZU5vZGVSZWNvdmVyeShub2RlX2NvdW50OiBpMzIsIG5vZGVfaGVhbHRoX3N0YXR1czogJm11dCBbaTMyOyA3XSkgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaWYgKG5vZGVfaGVhbHRoX3N0YXR1c1tpIGFzIHVzaXplXSA8IDEwMCkgewogICAgICAgICAgICBub2RlX2hlYWx0aF9zdGF0dXNbaSBhcyB1c2l6ZV0gPSBub2RlX2hlYWx0aF9zdGF0dXNbaSBhcyB1c2l6ZV0gKyAxNTsgLy8gR3JhZHVhbCByZWNvdmVyeQogICAgICAgICAgICBpZiAobm9kZV9oZWFsdGhfc3RhdHVzW2kgYXMgdXNpemVdID4gMTAwKSB7CiAgICAgICAgICAgICAgICBub2RlX2hlYWx0aF9zdGF0dXNbaSBhcyB1c2l6ZV0gPSAxMDA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgovLyBBc3luY2hyb25vdXMgY29uc2Vuc3VzIHV0aWxpdHkgZnVuY3Rpb25zCgpmbiBnZW5lcmF0ZUFzeW5jUHJvcG9zYWxzKG5vZGVfY291bnQ6IGkzMiwgbm9kZV9wcm9wb3NhbHM6ICZtdXQgW2kzMjsgN10sIHJvdW5kOiBpMzIpIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIG5vZGVfcHJvcG9zYWxzW2kgYXMgdXNpemVdID0gKHJvdW5kICogMTAwKSArIChpICogMTApICsgKChyb3VuZCArIGkpICUgNyk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQp9CgpmbiBlbnF1ZXVlUHJvcG9zYWxzV2l0aERlbGF5cygKICAgIG5vZGVfY291bnQ6IGkzMiwKICAgIG5vZGVfcHJvcG9zYWxzOiAmIFtpMzI7IDddLAogICAgbWVzc2FnZV9xdWV1ZTogJm11dCBbaTMyOyAxMDAwXSwKICAgIG1lc3NhZ2VfZGVsYXlzOiAmbXV0IFtpMzI7IDEwMDBdLAogICAgbWVzc2FnZV90aW1lc3RhbXBzOiAmbXV0IFtpMzI7IDEwMDBdLAogICAgcXVldWVfaGVhZDogJm11dCBpMzIsCiAgICBxdWV1ZV90YWlsOiAmbXV0IGkzMiwKICAgIHF1ZXVlX3NpemU6ICZtdXQgaTMyLAogICAgY3VycmVudF90aW1lOiBpMzIKKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQgJiYgKnF1ZXVlX3NpemUgPCAxMDAwKSB7CiAgICAgICAgbGV0IGRlbGF5OiBpMzIgPSAoaSAqIDEzICsgY3VycmVudF90aW1lICogNykgJSAyMDsgLy8gMC0xOSB0aW1lIHVuaXRzIGRlbGF5CiAgICAgICAgCiAgICAgICAgbWVzc2FnZV9xdWV1ZVsqcXVldWVfdGFpbCBhcyB1c2l6ZV0gPSBub2RlX3Byb3Bvc2Fsc1tpIGFzIHVzaXplXTsKICAgICAgICBtZXNzYWdlX2RlbGF5c1sqcXVldWVfdGFpbCBhcyB1c2l6ZV0gPSBkZWxheTsKICAgICAgICBtZXNzYWdlX3RpbWVzdGFtcHNbKnF1ZXVlX3RhaWwgYXMgdXNpemVdID0gY3VycmVudF90aW1lOwogICAgICAgIAogICAgICAgICpxdWV1ZV90YWlsID0gKCpxdWV1ZV90YWlsICsgMSkgJSAxMDAwOwogICAgICAgICpxdWV1ZV9zaXplID0gKnF1ZXVlX3NpemUgKyAxOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKZm4gcHJvY2Vzc0FzeW5jTWVzc2FnZXMoCiAgICBtZXNzYWdlX3F1ZXVlOiAmbXV0IFtpMzI7IDEwMDBdLAogICAgbWVzc2FnZV9kZWxheXM6ICZtdXQgW2kzMjsgMTAwMF0sCiAgICBtZXNzYWdlX3RpbWVzdGFtcHM6ICZtdXQgW2kzMjsgMTAwMF0sCiAgICBxdWV1ZV9oZWFkOiAmbXV0IGkzMiwKICAgIHF1ZXVlX3RhaWw6ICZtdXQgaTMyLAogICAgcXVldWVfc2l6ZTogJm11dCBpMzIsCiAgICBub2RlX2RlY2lzaW9uczogJm11dCBbaTMyOyA3XSwKICAgIGN1cnJlbnRfdGltZTogaTMyCikgLT4gaTMyIHsKICAgIGxldCBtdXQgcHJvY2Vzc2VkX2NvdW50OiBpMzIgPSAwOwogICAgCiAgICAvLyBQcm9jZXNzIG1lc3NhZ2VzIHdob3NlIGRlbGF5IGhhcyBleHBpcmVkCiAgICBsZXQgbXV0IGNoZWNrZWQ6IGkzMiA9IDA7CiAgICB3aGlsZSAoY2hlY2tlZCA8ICpxdWV1ZV9zaXplICYmICpxdWV1ZV9zaXplID4gMCkgewogICAgICAgIGxldCBtZXNzYWdlX3JlYWR5X3RpbWU6IGkzMiA9IG1lc3NhZ2VfdGltZXN0YW1wc1sqcXVldWVfaGVhZCBhcyB1c2l6ZV0gKyBtZXNzYWdlX2RlbGF5c1sqcXVldWVfaGVhZCBhcyB1c2l6ZV07CiAgICAgICAgCiAgICAgICAgaWYgKGN1cnJlbnRfdGltZSA+PSBtZXNzYWdlX3JlYWR5X3RpbWUpIHsKICAgICAgICAgICAgLy8gUHJvY2VzcyB0aGlzIG1lc3NhZ2UKICAgICAgICAgICAgbGV0IG1lc3NhZ2VfdmFsdWU6IGkzMiA9IG1lc3NhZ2VfcXVldWVbKnF1ZXVlX2hlYWQgYXMgdXNpemVdOwogICAgICAgICAgICBwcm9jZXNzQXN5bmNNZXNzYWdlKG1lc3NhZ2VfdmFsdWUsIG5vZGVfZGVjaXNpb25zLCBjdXJyZW50X3RpbWUpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gUmVtb3ZlIGZyb20gcXVldWUKICAgICAgICAgICAgKnF1ZXVlX2hlYWQgPSAoKnF1ZXVlX2hlYWQgKyAxKSAlIDEwMDA7CiAgICAgICAgICAgICpxdWV1ZV9zaXplID0gKnF1ZXVlX3NpemUgLSAxOwogICAgICAgICAgICBwcm9jZXNzZWRfY291bnQgPSBwcm9jZXNzZWRfY291bnQgKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIE1vdmUgdG8gbmV4dCBtZXNzYWdlCiAgICAgICAgICAgIGxldCBvbGRfaGVhZDogaTMyID0gKnF1ZXVlX2hlYWQ7CiAgICAgICAgICAgICpxdWV1ZV9oZWFkID0gKCpxdWV1ZV9oZWFkICsgMSkgJSAxMDAwOwogICAgICAgICAgICAqcXVldWVfc2l6ZSA9ICpxdWV1ZV9zaXplIC0gMTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIFJlLWVucXVldWUgYXQgdGFpbAogICAgICAgICAgICBtZXNzYWdlX3F1ZXVlWypxdWV1ZV90YWlsIGFzIHVzaXplXSA9IG1lc3NhZ2VfcXVldWVbKG9sZF9oZWFkIGFzIHVzaXplKV07CiAgICAgICAgICAgIG1lc3NhZ2VfZGVsYXlzWypxdWV1ZV90YWlsIGFzIHVzaXplXSA9IG1lc3NhZ2VfZGVsYXlzWyhvbGRfaGVhZCBhcyB1c2l6ZSldOwogICAgICAgICAgICBtZXNzYWdlX3RpbWVzdGFtcHNbKnF1ZXVlX3RhaWwgYXMgdXNpemVdID0gbWVzc2FnZV90aW1lc3RhbXBzWyhvbGRfaGVhZCBhcyB1c2l6ZSldOwogICAgICAgICAgICAqcXVldWVfdGFpbCA9ICgqcXVldWVfdGFpbCArIDEpICUgMTAwMDsKICAgICAgICAgICAgKnF1ZXVlX3NpemUgPSAqcXVldWVfc2l6ZSArIDE7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGNoZWNrZWQgPSBjaGVja2VkICsgMTsKICAgIH0KICAgIAogICAgcmV0dXJuIHByb2Nlc3NlZF9jb3VudDsKfQoKZm4gcHJvY2Vzc0FzeW5jTWVzc2FnZShtZXNzYWdlX3ZhbHVlOiBpMzIsIG5vZGVfZGVjaXNpb25zOiAmbXV0IFtpMzI7IDddLCBjdXJyZW50X3RpbWU6IGkzMikgewogICAgLy8gRXh0cmFjdCBub2RlIElEIGZyb20gbWVzc2FnZSB2YWx1ZQogICAgbGV0IHNlbmRlcl9pZDogaTMyID0gKG1lc3NhZ2VfdmFsdWUgLyAxMCkgJSA3OwogICAgCiAgICBpZiAoc2VuZGVyX2lkID49IDAgJiYgc2VuZGVyX2lkIDwgNykgewogICAgICAgIGlmIChub2RlX2RlY2lzaW9uc1tzZW5kZXJfaWQgYXMgdXNpemVdID09IC0xKSB7CiAgICAgICAgICAgIG5vZGVfZGVjaXNpb25zW3NlbmRlcl9pZCBhcyB1c2l6ZV0gPSBtZXNzYWdlX3ZhbHVlOwogICAgICAgIH0KICAgIH0KfQoKZm4gY2hlY2tBc3luY0NvbnNlbnN1cyhub2RlX2NvdW50OiBpMzIsIG5vZGVfZGVjaXNpb25zOiAmIFtpMzI7IDddKSAtPiBib29sIHsKICAgIGxldCBtdXQgZGVjaWRlZF9ub2RlczogaTMyID0gMDsKICAgIGxldCBtdXQgY29uc2Vuc3VzX3ZhbHVlOiBpMzIgPSAtMTsKICAgIGxldCBtdXQgY29uc2Vuc3VzX2ZvdW5kOiBib29sID0gdHJ1ZTsKICAgIAogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaWYgKG5vZGVfZGVjaXNpb25zW2kgYXMgdXNpemVdICE9IC0xKSB7CiAgICAgICAgICAgIGRlY2lkZWRfbm9kZXMgPSBkZWNpZGVkX25vZGVzICsgMTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChjb25zZW5zdXNfdmFsdWUgPT0gLTEpIHsKICAgICAgICAgICAgICAgIGNvbnNlbnN1c192YWx1ZSA9IG5vZGVfZGVjaXNpb25zW2kgYXMgdXNpemVdOwogICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGVfZGVjaXNpb25zW2kgYXMgdXNpemVdICE9IGNvbnNlbnN1c192YWx1ZSkgewogICAgICAgICAgICAgICAgY29uc2Vuc3VzX2ZvdW5kID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICAvLyBDb25zZW5zdXMgaWYgbWFqb3JpdHkgZGVjaWRlZCBhbmQgYWxsIGFncmVlCiAgICBsZXQgbWFqb3JpdHlfdGhyZXNob2xkOiBpMzIgPSAobm9kZV9jb3VudCAvIDIpICsgMTsKICAgIHJldHVybiBkZWNpZGVkX25vZGVzID49IG1ham9yaXR5X3RocmVzaG9sZCAmJiBjb25zZW5zdXNfZm91bmQ7Cn0KCmZuIGV4dHJhY3RDb25zZW5zdXNWYWx1ZShub2RlX2NvdW50OiBpMzIsIG5vZGVfZGVjaXNpb25zOiAmIFtpMzI7IDddKSAtPiBpMzIgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaWYgKG5vZGVfZGVjaXNpb25zW2kgYXMgdXNpemVdICE9IC0xKSB7CiAgICAgICAgICAgIHJldHVybiBub2RlX2RlY2lzaW9uc1tpIGFzIHVzaXplXTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcmV0dXJuIC0xOwp9CgpmbiByZXNldE5vZGVEZWNpc2lvbnMobm9kZV9jb3VudDogaTMyLCBub2RlX2RlY2lzaW9uczogJm11dCBbaTMyOyA3XSkgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgbm9kZV9kZWNpc2lvbnNbaSBhcyB1c2l6ZV0gPSAtMTsKICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCmZuIHZlcmlmeUNvbnNlbnN1c0hpc3RvcnkoY29uc2Vuc3VzX3ZhbHVlczogJiBbaTMyOyAxMDBdLCBjb25zZW5zdXNfY291bnQ6IGkzMikgLT4gYm9vbCB7CiAgICAvLyBDaGVjayB0aGF0IGNvbnNlbnN1cyB2YWx1ZXMgZm9sbG93IGV4cGVjdGVkIHBhdHRlcm4KICAgIGlmIChjb25zZW5zdXNfY291bnQgPD0gMSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICBsZXQgbXV0IGk6IGkzMiA9IDE7CiAgICB3aGlsZSAoaSA8IGNvbnNlbnN1c19jb3VudCkgewogICAgICAgIC8vIENvbnNlbnN1cyB2YWx1ZXMgc2hvdWxkIGJlIGluY3JlYXNpbmcgb3IgZm9sbG93IHNvbWUgcGF0dGVybgogICAgICAgIGlmIChjb25zZW5zdXNfdmFsdWVzW2kgYXMgdXNpemVdIDw9IGNvbnNlbnN1c192YWx1ZXNbaSBhcyB1c2l6ZSAtIDFdKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICByZXR1cm4gdHJ1ZTsKfQoKLy8gQWRkaXRpb25hbCB1dGlsaXR5IGZ1bmN0aW9ucyBmb3IgY29tcGxleCBvcGVyYXRpb25zCgpmbiBmaW5kTWF4UGFydGl0aW9uSWQobm9kZV9jb3VudDogaTMyLCBwYXJ0aXRpb25fZ3JvdXBzOiAmIFtpMzI7IDddKSAtPiBpMzIgewogICAgbGV0IG11dCBtYXhfaWQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICBpZiAocGFydGl0aW9uX2dyb3Vwc1tpIGFzIHVzaXplXSA+IG1heF9pZCkgewogICAgICAgICAgICBtYXhfaWQgPSBwYXJ0aXRpb25fZ3JvdXBzW2kgYXMgdXNpemVdOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICByZXR1cm4gbWF4X2lkOwp9CgpmbiBjb3VudFBhcnRpdGlvblNpemUobm9kZV9jb3VudDogaTMyLCBwYXJ0aXRpb25fZ3JvdXBzOiAmIFtpMzI7IDddLCB0YXJnZXRfcGFydGl0aW9uOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHNpemU6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG5vZGVfY291bnQpIHsKICAgICAgICBpZiAocGFydGl0aW9uX2dyb3Vwc1tpIGFzIHVzaXplXSA9PSB0YXJnZXRfcGFydGl0aW9uKSB7CiAgICAgICAgICAgIHNpemUgPSBzaXplICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcmV0dXJuIHNpemU7Cn0KCmZuIHRlc3RQYXJ0aXRpb25JbnRlcm5hbENvbnNlbnN1cygKICAgIG5vZGVfY291bnQ6IGkzMiwKICAgIHBhcnRpdGlvbl9ncm91cHM6ICYgW2kzMjsgN10sCiAgICB0YXJnZXRfcGFydGl0aW9uOiBpMzIsCiAgICBuZXR3b3JrX2Nvbm5lY3Rpdml0eTogJltbYm9vbDsgN107IDddCikgLT4gYm9vbCB7CiAgICAvLyBTaW1wbGlmaWVkIGludGVybmFsIGNvbnNlbnN1cyB0ZXN0CiAgICBsZXQgcGFydGl0aW9uX3NpemU6IGkzMiA9IGNvdW50UGFydGl0aW9uU2l6ZShub2RlX2NvdW50LCBwYXJ0aXRpb25fZ3JvdXBzLCB0YXJnZXRfcGFydGl0aW9uKTsKICAgIAogICAgaWYgKHBhcnRpdGlvbl9zaXplIDw9IDEpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsgLy8gVHJpdmlhbCBjb25zZW5zdXMKICAgIH0KICAgIAogICAgLy8gQ2hlY2sgaWYgbm9kZXMgaW4gcGFydGl0aW9uIGNhbiBjb21tdW5pY2F0ZQogICAgbGV0IG11dCBmaXJzdF9ub2RlOiBpMzIgPSAtMTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbm9kZV9jb3VudCkgewogICAgICAgIGlmIChwYXJ0aXRpb25fZ3JvdXBzW2kgYXMgdXNpemVdID09IHRhcmdldF9wYXJ0aXRpb24pIHsKICAgICAgICAgICAgaWYgKGZpcnN0X25vZGUgPT0gLTEpIHsKICAgICAgICAgICAgICAgIGZpcnN0X25vZGUgPSBpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKCFuZXR3b3JrX2Nvbm5lY3Rpdml0eVtmaXJzdF9ub2RlIGFzIHVzaXplXVtpIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIHJldHVybiB0cnVlOwp9CgpmbiBjb3VudERldGVjdGVkRmFpbHVyZXMobm9kZV9pZDogaTMyLCBub2RlX2NvdW50OiBpMzIsIGZhaWx1cmVfZGV0ZWN0b3JzOiAmIFtbYm9vbDsgN107IDddKSAtPiBpMzIgewogICAgbGV0IG11dCBmYWlsdXJlX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBub2RlX2NvdW50KSB7CiAgICAgICAgaWYgKGkgIT0gbm9kZV9pZCAmJiBmYWlsdXJlX2RldGVjdG9yc1tub2RlX2lkIGFzIHVzaXplXVtpIGFzIHVzaXplXSkgewogICAgICAgICAgICBmYWlsdXJlX2NvdW50ID0gZmFpbHVyZV9jb3VudCArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJldHVybiBmYWlsdXJlX2NvdW50Owp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (26, "comprehensive26", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEhpZ2gtUGVyZm9ybWFuY2UgRGF0YWJhc2UgRW5naW5lIGFuZCBRdWVyeSBPcHRpbWl6YXRpb24gU2ltdWxhdG9yClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpDb21wbGV4IEIrIHRyZWUgaW5kZXggc3RydWN0dXJlcyB3aXRoIGJ1bGsgb3BlcmF0aW9ucyBhbmQgcmViYWxhbmNpbmcKUXVlcnkgZXhlY3V0aW9uIGVuZ2luZSB3aXRoIG11bHRpcGxlIGpvaW4gYWxnb3JpdGhtcyBhbmQgb3B0aW1pemF0aW9uClRyYW5zYWN0aW9uIHByb2Nlc3Npbmcgd2l0aCBBQ0lEIHByb3BlcnRpZXMgYW5kIGNvbmN1cnJlbmN5IGNvbnRyb2wKQnVmZmVyIHBvb2wgbWFuYWdlbWVudCB3aXRoIGFkdmFuY2VkIHJlcGxhY2VtZW50IHBvbGljaWVzCkxvY2sgbWFuYWdlciB3aXRoIGRlYWRsb2NrIGRldGVjdGlvbiBhbmQgcHJldmVudGlvbiBhbGdvcml0aG1zClF1ZXJ5IG9wdGltaXplciB3aXRoIGNvc3QtYmFzZWQgb3B0aW1pemF0aW9uIGFuZCBzdGF0aXN0aWNzCkhhc2ggdGFibGUgaW1wbGVtZW50YXRpb24gd2l0aCBkeW5hbWljIHJlc2l6aW5nIGFuZCBjb2xsaXNpb24gaGFuZGxpbmcKTWVtb3J5IG1hbmFnZW1lbnQgd2l0aCBnYXJiYWdlIGNvbGxlY3Rpb24gc2ltdWxhdGlvbgpDb21wbGV4IHJlY3Vyc2l2ZSBhbGdvcml0aG1zIGZvciB0cmVlIHRyYXZlcnNhbCBhbmQgbWFuaXB1bGF0aW9uCkFkdmFuY2VkIHNvcnRpbmcgYWxnb3JpdGhtcyB3aXRoIG1lbW9yeS1lZmZpY2llbnQgaW1wbGVtZW50YXRpb25zCiovCgovLyBjb21wcmVoZW5zaXZlMjYucnggLSBIaWdoLVBlcmZvcm1hbmNlIERhdGFiYXNlIEVuZ2luZSBhbmQgUXVlcnkgT3B0aW1pemF0aW9uIFNpbXVsYXRvcgovLyBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKLy8gLSBDb21wbGV4IEIrIHRyZWUgaW5kZXggc3RydWN0dXJlcyB3aXRoIGJ1bGsgb3BlcmF0aW9ucyBhbmQgcmViYWxhbmNpbmcKLy8gLSBRdWVyeSBleGVjdXRpb24gZW5naW5lIHdpdGggbXVsdGlwbGUgam9pbiBhbGdvcml0aG1zIGFuZCBvcHRpbWl6YXRpb24KLy8gLSBUcmFuc2FjdGlvbiBwcm9jZXNzaW5nIHdpdGggQUNJRCBwcm9wZXJ0aWVzIGFuZCBjb25jdXJyZW5jeSBjb250cm9sCi8vIC0gQnVmZmVyIHBvb2wgbWFuYWdlbWVudCB3aXRoIGFkdmFuY2VkIHJlcGxhY2VtZW50IHBvbGljaWVzCi8vIC0gTG9jayBtYW5hZ2VyIHdpdGggZGVhZGxvY2sgZGV0ZWN0aW9uIGFuZCBwcmV2ZW50aW9uIGFsZ29yaXRobXMKLy8gLSBRdWVyeSBvcHRpbWl6ZXIgd2l0aCBjb3N0LWJhc2VkIG9wdGltaXphdGlvbiBhbmQgc3RhdGlzdGljcwovLyAtIEhhc2ggdGFibGUgaW1wbGVtZW50YXRpb24gd2l0aCBkeW5hbWljIHJlc2l6aW5nIGFuZCBjb2xsaXNpb24gaGFuZGxpbmcKLy8gLSBNZW1vcnkgbWFuYWdlbWVudCB3aXRoIGdhcmJhZ2UgY29sbGVjdGlvbiBzaW11bGF0aW9uCi8vIC0gQ29tcGxleCByZWN1cnNpdmUgYWxnb3JpdGhtcyBmb3IgdHJlZSB0cmF2ZXJzYWwgYW5kIG1hbmlwdWxhdGlvbgovLyAtIEFkdmFuY2VkIHNvcnRpbmcgYWxnb3JpdGhtcyB3aXRoIG1lbW9yeS1lZmZpY2llbnQgaW1wbGVtZW50YXRpb25zCgpmbiBtYWluKCkgewogICAgLy8gUGVyZm9ybWFuY2UgdGVzdCBtYXJrZXIgLSBzdGFydAogICAgcHJpbnRsbkludCgyNjAwMCk7CgogICAgLy8gRGF0YWJhc2UgRW5naW5lIENvbmZpZ3VyYXRpb24KICAgIGxldCB0YWJsZV9zaXplOiBpMzIgPSAxMDAwOwogICAgbGV0IGluZGV4X3NpemU6IGkzMiA9IDUwMDsKICAgIGxldCBidWZmZXJfcG9vbF9zaXplOiBpMzIgPSAxMDA7CiAgICBsZXQgbWF4X3RyYW5zYWN0aW9uczogaTMyID0gNTA7CiAgICBsZXQgbG9ja190YWJsZV9zaXplOiBpMzIgPSAyMDA7CgogICAgLy8gVGVzdCAxOiBCKyBUcmVlIEluZGV4IE9wZXJhdGlvbnMKICAgIC8vIFRlc3RzIHRyZWUgYmFsYW5jaW5nIGFsZ29yaXRobXMgYW5kIHJlY3Vyc2l2ZSBmdW5jdGlvbiBvcHRpbWl6YXRpb24KICAgIHBlcmZvcm1CUGx1c1RyZWVPcGVyYXRpb25zKGluZGV4X3NpemUpOwoKICAgIC8vIFRlc3QgMjogUXVlcnkgRXhlY3V0aW9uIEVuZ2luZQogICAgLy8gVGVzdHMgam9pbiBhbGdvcml0aG1zIGFuZCBjb21wbGV4IG5lc3RlZCBsb29wIG9wdGltaXphdGlvbgogICAgcGVyZm9ybVF1ZXJ5RXhlY3V0aW9uVGVzdCh0YWJsZV9zaXplKTsKCiAgICAvLyBUZXN0IDM6IFRyYW5zYWN0aW9uIFByb2Nlc3NpbmcgU3lzdGVtCiAgICAvLyBUZXN0cyBjb25jdXJyZW5jeSBjb250cm9sIGFuZCBkZWFkbG9jayBkZXRlY3Rpb24gYWxnb3JpdGhtcwogICAgcGVyZm9ybVRyYW5zYWN0aW9uUHJvY2Vzc2luZ1Rlc3QobWF4X3RyYW5zYWN0aW9ucyk7CgogICAgLy8gVGVzdCA0OiBCdWZmZXIgUG9vbCBNYW5hZ2VtZW50CiAgICAvLyBUZXN0cyBjYWNoZSByZXBsYWNlbWVudCBhbGdvcml0aG1zIGFuZCBtZW1vcnkgb3B0aW1pemF0aW9uCiAgICBwZXJmb3JtQnVmZmVyUG9vbFRlc3QoYnVmZmVyX3Bvb2xfc2l6ZSk7CgogICAgLy8gVGVzdCA1OiBRdWVyeSBPcHRpbWl6YXRpb24gRW5naW5lCiAgICAvLyBUZXN0cyBjb3N0LWJhc2VkIG9wdGltaXphdGlvbiBhbmQgY29tcGxleCBkZWNpc2lvbiB0cmVlcwogICAgcGVyZm9ybVF1ZXJ5T3B0aW1pemF0aW9uVGVzdCh0YWJsZV9zaXplKTsKCiAgICAvLyBUZXN0IDY6IEFkdmFuY2VkIEhhc2ggVGFibGUgT3BlcmF0aW9ucwogICAgLy8gVGVzdHMgZHluYW1pYyByZXNpemluZyBhbmQgY29sbGlzaW9uIHJlc29sdXRpb24gYWxnb3JpdGhtcwogICAgcGVyZm9ybUhhc2hUYWJsZVRlc3QodGFibGVfc2l6ZSk7CgogICAgLy8gUGVyZm9ybWFuY2UgdGVzdCBtYXJrZXIgLSBlbmQKICAgIHByaW50bG5JbnQoMjY5OTkpOwogICAgZXhpdCgwKTsKfQoKLy8gVGVzdCAxOiBCKyBUcmVlIEluZGV4IE9wZXJhdGlvbnMKLy8gVGVzdHMgY29tcGxleCB0cmVlIGFsZ29yaXRobXMgYW5kIHJlY3Vyc2l2ZSBmdW5jdGlvbiBjYWxsIG9wdGltaXphdGlvbgpmbiBwZXJmb3JtQlBsdXNUcmVlT3BlcmF0aW9ucyhtYXhfa2V5czogaTMyKSB7CiAgICBwcmludGxuSW50KDI2MDAxKTsgLy8gU3RhcnQgQisgdHJlZSB0ZXN0CgogICAgLy8gQisgVHJlZSBOb2RlIFN0cnVjdHVyZSAoc2ltcGxpZmllZCkKICAgIC8vIFVzaW5nIGFycmF5cyB0byBzaW11bGF0ZSB0cmVlIG5vZGVzCiAgICBsZXQgbXV0IGJ0cmVlX2tleXM6IFtbaTMyOyAxMF07IDEwMF0gPSBbWzA7IDEwXTsgMTAwXTsgLy8gS2V5cyBpbiBlYWNoIG5vZGUKICAgIGxldCBtdXQgYnRyZWVfY2hpbGRyZW46IFtbaTMyOyAxMV07IDEwMF0gPSBbWy0xOyAxMV07IDEwMF07IC8vIENoaWxkIHBvaW50ZXJzCiAgICBsZXQgbXV0IGJ0cmVlX3BhcmVudDogW2kzMjsgMTAwXSA9IFstMTsgMTAwXTsgLy8gUGFyZW50IHBvaW50ZXJzCiAgICBsZXQgbXV0IGJ0cmVlX2lzX2xlYWY6IFtib29sOyAxMDBdID0gW2ZhbHNlOyAxMDBdOyAvLyBMZWFmIG5vZGUgZmxhZ3MKICAgIGxldCBtdXQgYnRyZWVfa2V5X2NvdW50OiBbaTMyOyAxMDBdID0gWzA7IDEwMF07IC8vIE51bWJlciBvZiBrZXlzIGluIGVhY2ggbm9kZQogICAgbGV0IG11dCBub2RlX2NvdW50OiBpMzIgPSAxOyAvLyBDdXJyZW50IG51bWJlciBvZiBub2RlcwogICAgbGV0IG11dCByb290X25vZGU6IGkzMiA9IDA7IC8vIFJvb3Qgbm9kZSBpbmRleAoKICAgIC8vIEluaXRpYWxpemUgcm9vdCBub2RlIGFzIGxlYWYKICAgIGJ0cmVlX2lzX2xlYWZbMF0gPSB0cnVlOwogICAgYnRyZWVfa2V5X2NvdW50WzBdID0gMDsKCiAgICAvLyBJbnNlcnQgb3BlcmF0aW9ucyB3aXRoIGNvbXBsZXggcmViYWxhbmNpbmcKICAgIGxldCBtdXQgaW5zZXJ0X3NlcXVlbmNlOiBbaTMyOyAxMDBdID0gWzA7IDEwMF07CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG1heF9rZXlzICYmIGkgPCAxMDApIHsKICAgICAgICAvLyBHZW5lcmF0ZSBjb21wbGV4IGluc2VydGlvbiBwYXR0ZXJuCiAgICAgICAgaW5zZXJ0X3NlcXVlbmNlW2kgYXMgdXNpemVdID0gKChpICogMTcgKyAyMykgJSA5OTcpICsgMTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gUGVyZm9ybSBpbnNlcnRpb25zIHdpdGggdHJlZSByZWJhbGFuY2luZwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IG1heF9rZXlzICYmIGkgPCAxMDApIHsKICAgICAgICBsZXQga2V5X3RvX2luc2VydDogaTMyID0gaW5zZXJ0X3NlcXVlbmNlW2kgYXMgdXNpemVdOwoKICAgICAgICAvLyBGaW5kIGxlYWYgbm9kZSBmb3IgaW5zZXJ0aW9uCiAgICAgICAgbGV0IG11dCBjdXJyZW50X25vZGU6IGkzMiA9IHJvb3Rfbm9kZTsKICAgICAgICB3aGlsZSAoIWJ0cmVlX2lzX2xlYWZbY3VycmVudF9ub2RlIGFzIHVzaXplXSkgewogICAgICAgICAgICBsZXQgbXV0IGNoaWxkX2luZGV4OiBpMzIgPSAwOwogICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChqIDwgYnRyZWVfa2V5X2NvdW50W2N1cnJlbnRfbm9kZSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIGlmIChrZXlfdG9faW5zZXJ0ID4gYnRyZWVfa2V5c1tjdXJyZW50X25vZGUgYXMgdXNpemVdW2ogYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICAgICAgY2hpbGRfaW5kZXggPSBqICsgMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjdXJyZW50X25vZGUgPSBidHJlZV9jaGlsZHJlbltjdXJyZW50X25vZGUgYXMgdXNpemVdW2NoaWxkX2luZGV4IGFzIHVzaXplXTsKICAgICAgICB9CgogICAgICAgIC8vIEluc2VydCBrZXkgaW50byBsZWFmIG5vZGUKICAgICAgICBpZiAoYnRyZWVfa2V5X2NvdW50W2N1cnJlbnRfbm9kZSBhcyB1c2l6ZV0gPCA5KSB7CiAgICAgICAgICAgIC8vIE5vdCBmdWxsCiAgICAgICAgICAgIC8vIFNpbXBsZSBpbnNlcnRpb24KICAgICAgICAgICAgbGV0IG11dCBpbnNlcnRfcG9zOiBpMzIgPSBidHJlZV9rZXlfY291bnRbY3VycmVudF9ub2RlIGFzIHVzaXplXTsKICAgICAgICAgICAgbGV0IG11dCBrOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoayA8IGJ0cmVlX2tleV9jb3VudFtjdXJyZW50X25vZGUgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBpZiAoa2V5X3RvX2luc2VydCA8IGJ0cmVlX2tleXNbY3VycmVudF9ub2RlIGFzIHVzaXplXVtrIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgICAgIGluc2VydF9wb3MgPSBrOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgayA9IGsgKyAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBTaGlmdCBrZXlzIHRvIG1ha2Ugcm9vbQogICAgICAgICAgICBsZXQgbXV0IHNoaWZ0X2luZGV4OiBpMzIgPSBidHJlZV9rZXlfY291bnRbY3VycmVudF9ub2RlIGFzIHVzaXplXTsKICAgICAgICAgICAgd2hpbGUgKHNoaWZ0X2luZGV4ID4gaW5zZXJ0X3BvcykgewogICAgICAgICAgICAgICAgYnRyZWVfa2V5c1tjdXJyZW50X25vZGUgYXMgdXNpemVdW3NoaWZ0X2luZGV4IGFzIHVzaXplXSA9CiAgICAgICAgICAgICAgICAgICAgYnRyZWVfa2V5c1tjdXJyZW50X25vZGUgYXMgdXNpemVdW3NoaWZ0X2luZGV4IGFzIHVzaXplIC0gMV07CiAgICAgICAgICAgICAgICBzaGlmdF9pbmRleCA9IHNoaWZ0X2luZGV4IC0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnRyZWVfa2V5c1tjdXJyZW50X25vZGUgYXMgdXNpemVdW2luc2VydF9wb3MgYXMgdXNpemVdID0ga2V5X3RvX2luc2VydDsKICAgICAgICAgICAgYnRyZWVfa2V5X2NvdW50W2N1cnJlbnRfbm9kZSBhcyB1c2l6ZV0gPSBidHJlZV9rZXlfY291bnRbY3VycmVudF9ub2RlIGFzIHVzaXplXSArIDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gTm9kZSBpcyBmdWxsLCBuZWVkIHRvIHNwbGl0CiAgICAgICAgICAgIGlmIChub2RlX2NvdW50IDwgOTkpIHsKICAgICAgICAgICAgICAgIGxldCBuZXdfbm9kZTogaTMyID0gbm9kZV9jb3VudDsKICAgICAgICAgICAgICAgIG5vZGVfY291bnQgPSBub2RlX2NvdW50ICsgMTsKCiAgICAgICAgICAgICAgICAvLyBJbml0aWFsaXplIG5ldyBub2RlCiAgICAgICAgICAgICAgICBidHJlZV9pc19sZWFmW25ld19ub2RlIGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgICAgICAgICBidHJlZV9rZXlfY291bnRbbmV3X25vZGUgYXMgdXNpemVdID0gNTsKICAgICAgICAgICAgICAgIGJ0cmVlX3BhcmVudFtuZXdfbm9kZSBhcyB1c2l6ZV0gPSBidHJlZV9wYXJlbnRbY3VycmVudF9ub2RlIGFzIHVzaXplXTsKCiAgICAgICAgICAgICAgICAvLyBNb3ZlIGhhbGYgdGhlIGtleXMgdG8gbmV3IG5vZGUKICAgICAgICAgICAgICAgIGxldCBtdXQgbW92ZV9pbmRleDogaTMyID0gMDsKICAgICAgICAgICAgICAgIHdoaWxlIChtb3ZlX2luZGV4IDwgNSkgewogICAgICAgICAgICAgICAgICAgIGJ0cmVlX2tleXNbbmV3X25vZGUgYXMgdXNpemVdW21vdmVfaW5kZXggYXMgdXNpemVdID0KICAgICAgICAgICAgICAgICAgICAgICAgYnRyZWVfa2V5c1tjdXJyZW50X25vZGUgYXMgdXNpemVdW21vdmVfaW5kZXggYXMgdXNpemUgKyA1XTsKICAgICAgICAgICAgICAgICAgICBidHJlZV9rZXlzW2N1cnJlbnRfbm9kZSBhcyB1c2l6ZV1bbW92ZV9pbmRleCBhcyB1c2l6ZSArIDVdID0gMDsKICAgICAgICAgICAgICAgICAgICBtb3ZlX2luZGV4ID0gbW92ZV9pbmRleCArIDE7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYnRyZWVfa2V5X2NvdW50W2N1cnJlbnRfbm9kZSBhcyB1c2l6ZV0gPSA1OwoKICAgICAgICAgICAgICAgIC8vIEluc2VydCBrZXkgaW50byBhcHByb3ByaWF0ZSBub2RlCiAgICAgICAgICAgICAgICBpZiAoa2V5X3RvX2luc2VydCA8IGJ0cmVlX2tleXNbbmV3X25vZGUgYXMgdXNpemVdWzBdKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGludG8gb3JpZ2luYWwgbm9kZQogICAgICAgICAgICAgICAgICAgIGxldCBtdXQgaW5zZXJ0X3BvczogaTMyID0gNTsKICAgICAgICAgICAgICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGsgPCA1KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXlfdG9faW5zZXJ0IDwgYnRyZWVfa2V5c1tjdXJyZW50X25vZGUgYXMgdXNpemVdW2sgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRfcG9zID0gazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGsgPSBrICsgMTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGxldCBtdXQgc2hpZnRfaW5kZXg6IGkzMiA9IDQ7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHNoaWZ0X2luZGV4ID49IGluc2VydF9wb3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYnRyZWVfa2V5c1tjdXJyZW50X25vZGUgYXMgdXNpemVdW3NoaWZ0X2luZGV4IGFzIHVzaXplICsgMV0gPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnRyZWVfa2V5c1tjdXJyZW50X25vZGUgYXMgdXNpemVdW3NoaWZ0X2luZGV4IGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNoaWZ0X2luZGV4ID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHNoaWZ0X2luZGV4ID0gc2hpZnRfaW5kZXggLSAxOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgYnRyZWVfa2V5c1tjdXJyZW50X25vZGUgYXMgdXNpemVdW2luc2VydF9wb3MgYXMgdXNpemVdID0ga2V5X3RvX2luc2VydDsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gSW5zZXJ0IGludG8gbmV3IG5vZGUKICAgICAgICAgICAgICAgICAgICBsZXQgbXV0IGluc2VydF9wb3M6IGkzMiA9IDU7CiAgICAgICAgICAgICAgICAgICAgbGV0IG11dCBrOiBpMzIgPSAwOwogICAgICAgICAgICAgICAgICAgIHdoaWxlIChrIDwgNSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5X3RvX2luc2VydCA8IGJ0cmVlX2tleXNbbmV3X25vZGUgYXMgdXNpemVdW2sgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRfcG9zID0gazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGsgPSBrICsgMTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGxldCBtdXQgc2hpZnRfaW5kZXg6IGkzMiA9IDQ7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHNoaWZ0X2luZGV4ID49IGluc2VydF9wb3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYnRyZWVfa2V5c1tuZXdfbm9kZSBhcyB1c2l6ZV1bc2hpZnRfaW5kZXggYXMgdXNpemUgKyAxXSA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidHJlZV9rZXlzW25ld19ub2RlIGFzIHVzaXplXVtzaGlmdF9pbmRleCBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzaGlmdF9pbmRleCA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBzaGlmdF9pbmRleCA9IHNoaWZ0X2luZGV4IC0gMTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGJ0cmVlX2tleXNbbmV3X25vZGUgYXMgdXNpemVdW2luc2VydF9wb3MgYXMgdXNpemVdID0ga2V5X3RvX2luc2VydDsKICAgICAgICAgICAgICAgICAgICBidHJlZV9rZXlfY291bnRbbmV3X25vZGUgYXMgdXNpemVdID0gNjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIFBlcmZvcm0gcmFuZ2UgcXVlcmllcyB0byB0ZXN0IHRyZWUgdHJhdmVyc2FsIG9wdGltaXphdGlvbgogICAgbGV0IG11dCByYW5nZV9zdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IHF1ZXJ5X2NvdW50OiBpMzIgPSAwOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDIwICYmIHF1ZXJ5X2NvdW50IDwgMTAwKSB7CiAgICAgICAgbGV0IHJhbmdlX3N0YXJ0OiBpMzIgPSAoaSAqIDEzICsgNykgJSA1MDAgKyAxOwogICAgICAgIGxldCByYW5nZV9lbmQ6IGkzMiA9IHJhbmdlX3N0YXJ0ICsgKGkgKiAzICsgMSkgJSA1MCArIDEwOwoKICAgICAgICAvLyBUcmF2ZXJzZSB0cmVlIHRvIGZpbmQga2V5cyBpbiByYW5nZQogICAgICAgIGxldCBtdXQgY3VycmVudF9zdW06IGkzMiA9IHBlcmZvcm1SYW5nZVF1ZXJ5KAogICAgICAgICAgICAmYnRyZWVfa2V5cywKICAgICAgICAgICAgJmJ0cmVlX2NoaWxkcmVuLAogICAgICAgICAgICAmYnRyZWVfaXNfbGVhZiwKICAgICAgICAgICAgJmJ0cmVlX2tleV9jb3VudCwKICAgICAgICAgICAgcm9vdF9ub2RlLAogICAgICAgICAgICByYW5nZV9zdGFydCwKICAgICAgICAgICAgcmFuZ2VfZW5kLAogICAgICAgICk7CiAgICAgICAgcmFuZ2Vfc3VtID0gcmFuZ2Vfc3VtICsgY3VycmVudF9zdW07CiAgICAgICAgcXVlcnlfY291bnQgPSBxdWVyeV9jb3VudCArIDE7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHByaW50bG5JbnQocmFuZ2Vfc3VtICUgMTAwMDApOwogICAgcHJpbnRsbkludCgyNjAwMik7IC8vIEVuZCBCKyB0cmVlIHRlc3QKfQoKLy8gSGVscGVyIGZ1bmN0aW9uIGZvciByYW5nZSBxdWVyaWVzIGluIEIrIHRyZWUKZm4gcGVyZm9ybVJhbmdlUXVlcnkoCiAgICBrZXlzOiAmW1tpMzI7IDEwXTsgMTAwXSwKICAgIGNoaWxkcmVuOiAmW1tpMzI7IDExXTsgMTAwXSwKICAgIGlzX2xlYWY6ICZbYm9vbDsgMTAwXSwKICAgIGtleV9jb3VudDogJltpMzI7IDEwMF0sCiAgICBub2RlOiBpMzIsCiAgICBzdGFydDogaTMyLAogICAgZW5kOiBpMzIsCikgLT4gaTMyIHsKICAgIGxldCBtdXQgcmVzdWx0X3N1bTogaTMyID0gMDsKCiAgICBpZiAoaXNfbGVhZltub2RlIGFzIHVzaXplXSkgewogICAgICAgIC8vIExlYWYgbm9kZSAtIGNoZWNrIGFsbCBrZXlzIGluIHJhbmdlCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwga2V5X2NvdW50W25vZGUgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIGlmIChrZXlzW25vZGUgYXMgdXNpemVdW2kgYXMgdXNpemVdID49IHN0YXJ0ICYmIGtleXNbbm9kZSBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gPD0gZW5kKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXN1bHRfc3VtID0gcmVzdWx0X3N1bSArIGtleXNbbm9kZSBhcyB1c2l6ZV1baSBhcyB1c2l6ZV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgLy8gSW50ZXJuYWwgbm9kZSAtIHJlY3Vyc2l2ZWx5IHNlYXJjaCBjaGlsZHJlbgogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8PSBrZXlfY291bnRbbm9kZSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgaWYgKGNoaWxkcmVuW25vZGUgYXMgdXNpemVdW2kgYXMgdXNpemVdID49IDAKICAgICAgICAgICAgICAgICYmIGNoaWxkcmVuW25vZGUgYXMgdXNpemVdW2kgYXMgdXNpemVdIDwgMTAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBsZXQgY2hpbGRfc3VtOiBpMzIgPSBwZXJmb3JtUmFuZ2VRdWVyeSgKICAgICAgICAgICAgICAgICAgICBrZXlzLAogICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuLAogICAgICAgICAgICAgICAgICAgIGlzX2xlYWYsCiAgICAgICAgICAgICAgICAgICAga2V5X2NvdW50LAogICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuW25vZGUgYXMgdXNpemVdW2kgYXMgdXNpemVdLAogICAgICAgICAgICAgICAgICAgIHN0YXJ0LAogICAgICAgICAgICAgICAgICAgIGVuZCwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICByZXN1bHRfc3VtID0gcmVzdWx0X3N1bSArIGNoaWxkX3N1bTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgfQoKICAgIHJlc3VsdF9zdW0KfQoKLy8gVGVzdCAyOiBRdWVyeSBFeGVjdXRpb24gRW5naW5lCi8vIFRlc3RzIGpvaW4gYWxnb3JpdGhtcyBhbmQgbmVzdGVkIGxvb3Agb3B0aW1pemF0aW9uCmZuIHBlcmZvcm1RdWVyeUV4ZWN1dGlvblRlc3QodGFibGVfc2l6ZTogaTMyKSB7CiAgICBwcmludGxuSW50KDI2MDAzKTsgLy8gU3RhcnQgcXVlcnkgZXhlY3V0aW9uIHRlc3QKCiAgICAvLyBTaW11bGF0ZSB0d28gdGFibGVzIGZvciBqb2luIG9wZXJhdGlvbnMKICAgIGxldCBtdXQgdGFibGUxX2lkOiBbaTMyOyAyMDBdID0gWzA7IDIwMF07CiAgICBsZXQgbXV0IHRhYmxlMV92YWx1ZTogW2kzMjsgMjAwXSA9IFswOyAyMDBdOwogICAgbGV0IG11dCB0YWJsZTJfaWQ6IFtpMzI7IDIwMF0gPSBbMDsgMjAwXTsKICAgIGxldCBtdXQgdGFibGUyX3ZhbHVlOiBbaTMyOyAyMDBdID0gWzA7IDIwMF07CiAgICBsZXQgbXV0IHRhYmxlMV9zaXplOiBpMzIgPSAwOwogICAgbGV0IG11dCB0YWJsZTJfc2l6ZTogaTMyID0gMDsKCiAgICAvLyBJbml0aWFsaXplIHRhYmxlMSB3aXRoIGNvbXBsZXggcGF0dGVybgogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCB0YWJsZV9zaXplICYmIGkgPCAyMDApIHsKICAgICAgICB0YWJsZTFfaWRbaSBhcyB1c2l6ZV0gPSAoaSAqIDMgKyAxKSAlIDE1MCArIDE7CiAgICAgICAgdGFibGUxX3ZhbHVlW2kgYXMgdXNpemVdID0gKGkgKiA3ICsgMTEpICUgMTAwMCArIDE7CiAgICAgICAgdGFibGUxX3NpemUgPSB0YWJsZTFfc2l6ZSArIDE7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC8vIEluaXRpYWxpemUgdGFibGUyIHdpdGggb3ZlcmxhcHBpbmcgYnV0IGRpZmZlcmVudCBwYXR0ZXJuCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgdGFibGVfc2l6ZSAmJiBpIDwgMjAwKSB7CiAgICAgICAgdGFibGUyX2lkW2kgYXMgdXNpemVdID0gKGkgKiA1ICsgMykgJSAxODAgKyAxOwogICAgICAgIHRhYmxlMl92YWx1ZVtpIGFzIHVzaXplXSA9IChpICogMTEgKyAxMykgJSAxMjAwICsgMTsKICAgICAgICB0YWJsZTJfc2l6ZSA9IHRhYmxlMl9zaXplICsgMTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gVGVzdCAxOiBOZXN0ZWQgTG9vcCBKb2luCiAgICBsZXQgbXV0IG5lc3RlZF9sb29wX3Jlc3VsdDogaTMyID0gMDsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCB0YWJsZTFfc2l6ZSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IHRhYmxlMl9zaXplKSB7CiAgICAgICAgICAgIGlmICh0YWJsZTFfaWRbaSBhcyB1c2l6ZV0gPT0gdGFibGUyX2lkW2ogYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBuZXN0ZWRfbG9vcF9yZXN1bHQgPQogICAgICAgICAgICAgICAgICAgIG5lc3RlZF9sb29wX3Jlc3VsdCArIHRhYmxlMV92YWx1ZVtpIGFzIHVzaXplXSArIHRhYmxlMl92YWx1ZVtqIGFzIHVzaXplXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBwcmludGxuSW50KG5lc3RlZF9sb29wX3Jlc3VsdCAlIDEwMDAwKTsKCiAgICAvLyBUZXN0IDI6IEhhc2ggSm9pbiBzaW11bGF0aW9uCiAgICAvLyBCdWlsZCBoYXNoIHRhYmxlIGZvciBzbWFsbGVyIHJlbGF0aW9uICh0YWJsZTEpCiAgICBsZXQgbXV0IGhhc2hfYnVja2V0czogW1tpMzI7IDVdOyA1MF0gPSBbWy0xOyA1XTsgNTBdOwogICAgbGV0IG11dCBoYXNoX3ZhbHVlczogW1tpMzI7IDVdOyA1MF0gPSBbWzA7IDVdOyA1MF07CiAgICBsZXQgbXV0IGhhc2hfY291bnQ6IFtpMzI7IDUwXSA9IFswOyA1MF07CgogICAgLy8gQnVpbGQgcGhhc2UKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCB0YWJsZTFfc2l6ZSkgewogICAgICAgIGxldCBoYXNoX2tleTogaTMyID0gdGFibGUxX2lkW2kgYXMgdXNpemVdICUgNTA7CiAgICAgICAgaWYgKGhhc2hfY291bnRbaGFzaF9rZXkgYXMgdXNpemVdIDwgNSkgewogICAgICAgICAgICBsZXQgc2xvdDogaTMyID0gaGFzaF9jb3VudFtoYXNoX2tleSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGhhc2hfYnVja2V0c1toYXNoX2tleSBhcyB1c2l6ZV1bc2xvdCBhcyB1c2l6ZV0gPSB0YWJsZTFfaWRbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGhhc2hfdmFsdWVzW2hhc2hfa2V5IGFzIHVzaXplXVtzbG90IGFzIHVzaXplXSA9IHRhYmxlMV92YWx1ZVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgaGFzaF9jb3VudFtoYXNoX2tleSBhcyB1c2l6ZV0gPSBoYXNoX2NvdW50W2hhc2hfa2V5IGFzIHVzaXplXSArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBQcm9iZSBwaGFzZQogICAgbGV0IG11dCBoYXNoX2pvaW5fcmVzdWx0OiBpMzIgPSAwOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IHRhYmxlMl9zaXplKSB7CiAgICAgICAgbGV0IGhhc2hfa2V5OiBpMzIgPSB0YWJsZTJfaWRbaSBhcyB1c2l6ZV0gJSA1MDsKICAgICAgICBsZXQgbXV0IGJ1Y2tldF9pbmRleDogaTMyID0gMDsKICAgICAgICB3aGlsZSAoYnVja2V0X2luZGV4IDwgaGFzaF9jb3VudFtoYXNoX2tleSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgaWYgKGhhc2hfYnVja2V0c1toYXNoX2tleSBhcyB1c2l6ZV1bYnVja2V0X2luZGV4IGFzIHVzaXplXSA9PSB0YWJsZTJfaWRbaSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIGhhc2hfam9pbl9yZXN1bHQgPSBoYXNoX2pvaW5fcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgKyBoYXNoX3ZhbHVlc1toYXNoX2tleSBhcyB1c2l6ZV1bYnVja2V0X2luZGV4IGFzIHVzaXplXQogICAgICAgICAgICAgICAgICAgICsgdGFibGUyX3ZhbHVlW2kgYXMgdXNpemVdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJ1Y2tldF9pbmRleCA9IGJ1Y2tldF9pbmRleCArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBwcmludGxuSW50KGhhc2hfam9pbl9yZXN1bHQgJSAxMDAwMCk7CgogICAgLy8gVGVzdCAzOiBTb3J0LU1lcmdlIEpvaW4KICAgIC8vIFNvcnQgYm90aCB0YWJsZXMgZmlyc3QgKHVzaW5nIGJ1YmJsZSBzb3J0IGZvciBzaW1wbGljaXR5KQogICAgcGVyZm9ybVRhYmxlU29ydCgmbXV0IHRhYmxlMV9pZCwgJm11dCB0YWJsZTFfdmFsdWUsIHRhYmxlMV9zaXplKTsKICAgIHBlcmZvcm1UYWJsZVNvcnQoJm11dCB0YWJsZTJfaWQsICZtdXQgdGFibGUyX3ZhbHVlLCB0YWJsZTJfc2l6ZSk7CgogICAgLy8gTWVyZ2UgcGhhc2UKICAgIGxldCBtdXQgbWVyZ2Vfam9pbl9yZXN1bHQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGkxOiBpMzIgPSAwOwogICAgbGV0IG11dCBpMjogaTMyID0gMDsKCiAgICB3aGlsZSAoaTEgPCB0YWJsZTFfc2l6ZSAmJiBpMiA8IHRhYmxlMl9zaXplKSB7CiAgICAgICAgaWYgKHRhYmxlMV9pZFtpMSBhcyB1c2l6ZV0gPT0gdGFibGUyX2lkW2kyIGFzIHVzaXplXSkgewogICAgICAgICAgICBtZXJnZV9qb2luX3Jlc3VsdCA9CiAgICAgICAgICAgICAgICBtZXJnZV9qb2luX3Jlc3VsdCArIHRhYmxlMV92YWx1ZVtpMSBhcyB1c2l6ZV0gKyB0YWJsZTJfdmFsdWVbaTIgYXMgdXNpemVdOwogICAgICAgICAgICBpMSA9IGkxICsgMTsKICAgICAgICAgICAgaTIgPSBpMiArIDE7CiAgICAgICAgfSBlbHNlIGlmICh0YWJsZTFfaWRbaTEgYXMgdXNpemVdIDwgdGFibGUyX2lkW2kyIGFzIHVzaXplXSkgewogICAgICAgICAgICBpMSA9IGkxICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpMiA9IGkyICsgMTsKICAgICAgICB9CiAgICB9CgogICAgcHJpbnRsbkludChtZXJnZV9qb2luX3Jlc3VsdCAlIDEwMDAwKTsKICAgIHByaW50bG5JbnQoMjYwMDQpOyAvLyBFbmQgcXVlcnkgZXhlY3V0aW9uIHRlc3QKfQoKLy8gSGVscGVyIGZ1bmN0aW9uIGZvciB0YWJsZSBzb3J0aW5nCmZuIHBlcmZvcm1UYWJsZVNvcnQoaWRzOiAmbXV0IFtpMzI7IDIwMF0sIHZhbHVlczogJm11dCBbaTMyOyAyMDBdLCBzaXplOiBpMzIpIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgc2l6ZSAtIDEpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBzaXplIC0gMSAtIGkpIHsKICAgICAgICAgICAgaWYgKGlkc1tqIGFzIHVzaXplXSA+IGlkc1tqIGFzIHVzaXplICsgMV0pIHsKICAgICAgICAgICAgICAgIC8vIFN3YXAgaWRzCiAgICAgICAgICAgICAgICBsZXQgdGVtcF9pZDogaTMyID0gaWRzW2ogYXMgdXNpemVdOwogICAgICAgICAgICAgICAgaWRzW2ogYXMgdXNpemVdID0gaWRzW2ogYXMgdXNpemUgKyAxXTsKICAgICAgICAgICAgICAgIGlkc1tqIGFzIHVzaXplICsgMV0gPSB0ZW1wX2lkOwoKICAgICAgICAgICAgICAgIC8vIFN3YXAgY29ycmVzcG9uZGluZyB2YWx1ZXMKICAgICAgICAgICAgICAgIGxldCB0ZW1wX3ZhbHVlOiBpMzIgPSB2YWx1ZXNbaiBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICB2YWx1ZXNbaiBhcyB1c2l6ZV0gPSB2YWx1ZXNbaiBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICAgICAgdmFsdWVzW2ogYXMgdXNpemUgKyAxXSA9IHRlbXBfdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCi8vIFRlc3QgMzogVHJhbnNhY3Rpb24gUHJvY2Vzc2luZyBTeXN0ZW0KLy8gVGVzdHMgY29uY3VycmVuY3kgY29udHJvbCBhbmQgZGVhZGxvY2sgZGV0ZWN0aW9uIGFsZ29yaXRobXMKZm4gcGVyZm9ybVRyYW5zYWN0aW9uUHJvY2Vzc2luZ1Rlc3QobWF4X3RyYW5zYWN0aW9uczogaTMyKSB7CiAgICBwcmludGxuSW50KDI2MDA1KTsgLy8gU3RhcnQgdHJhbnNhY3Rpb24gcHJvY2Vzc2luZyB0ZXN0CgogICAgLy8gVHJhbnNhY3Rpb24gc3RhdGUgbWFuYWdlbWVudAogICAgbGV0IG11dCB0cmFuc2FjdGlvbl9zdGF0ZXM6IFtpMzI7IDUwXSA9IFswOyA1MF07IC8vIDA9aW5hY3RpdmUsIDE9YWN0aXZlLCAyPWNvbW1pdHRlZCwgMz1hYm9ydGVkCiAgICBsZXQgbXV0IHRyYW5zYWN0aW9uX3N0YXJ0X3RpbWU6IFtpMzI7IDUwXSA9IFswOyA1MF07CiAgICBsZXQgbXV0IHRyYW5zYWN0aW9uX2xvY2tzOiBbW2kzMjsgMTBdOyA1MF0gPSBbWy0xOyAxMF07IDUwXTsgLy8gUmVzb3VyY2VzIGxvY2tlZCBieSBlYWNoIHRyYW5zYWN0aW9uCiAgICBsZXQgbXV0IHRyYW5zYWN0aW9uX2xvY2tfY291bnQ6IFtpMzI7IDUwXSA9IFswOyA1MF07CgogICAgLy8gTG9jayB0YWJsZSBmb3IgcmVzb3VyY2VzCiAgICBsZXQgbXV0IHJlc291cmNlX2xvY2tzOiBbaTMyOyAxMDBdID0gWy0xOyAxMDBdOyAvLyAtMT11bmxvY2tlZCwgb3RoZXJ3aXNlIHRyYW5zYWN0aW9uX2lkCiAgICBsZXQgbXV0IGxvY2tfd2FpdF9xdWV1ZTogW1tpMzI7IDVdOyAxMDBdID0gW1stMTsgNV07IDEwMF07IC8vIFdhaXRpbmcgdHJhbnNhY3Rpb25zIGZvciBlYWNoIHJlc291cmNlCiAgICBsZXQgbXV0IHdhaXRfcXVldWVfY291bnQ6IFtpMzI7IDEwMF0gPSBbMDsgMTAwXTsKCiAgICAvLyBEZWFkbG9jayBkZXRlY3Rpb24gc3RydWN0dXJlcwogICAgbGV0IG11dCB3YWl0X2Zvcl9ncmFwaDogW1tib29sOyA1MF07IDUwXSA9IFtbZmFsc2U7IDUwXTsgNTBdOyAvLyBUcmFuc2FjdGlvbiBkZXBlbmRlbmN5IGdyYXBoCiAgICBsZXQgbXV0IHZpc2l0ZWQ6IFtib29sOyA1MF0gPSBbZmFsc2U7IDUwXTsKICAgIGxldCBtdXQgcmVjdXJzaW9uX3N0YWNrOiBbYm9vbDsgNTBdID0gW2ZhbHNlOyA1MF07CgogICAgbGV0IG11dCBhY3RpdmVfdHJhbnNhY3Rpb25zOiBpMzIgPSAwOwogICAgbGV0IG11dCBjb21taXR0ZWRfY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGFib3J0ZWRfY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGN1cnJlbnRfdGltZTogaTMyID0gMTsKCiAgICAvLyBTaW11bGF0ZSB0cmFuc2FjdGlvbiBleGVjdXRpb24KICAgIGxldCBtdXQgcm91bmQ6IGkzMiA9IDA7CiAgICB3aGlsZSAocm91bmQgPCAyMCAmJiBhY3RpdmVfdHJhbnNhY3Rpb25zIDwgbWF4X3RyYW5zYWN0aW9ucykgewogICAgICAgIC8vIFN0YXJ0IG5ldyB0cmFuc2FjdGlvbnMKICAgICAgICBsZXQgbXV0IG5ld190cmFuc2FjdGlvbnM6IGkzMiA9IChyb3VuZCAlIDMpICsgMTsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBuZXdfdHJhbnNhY3Rpb25zICYmIGFjdGl2ZV90cmFuc2FjdGlvbnMgPCBtYXhfdHJhbnNhY3Rpb25zKSB7CiAgICAgICAgICAgIGlmIChhY3RpdmVfdHJhbnNhY3Rpb25zIDwgNTApIHsKICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX3N0YXRlc1thY3RpdmVfdHJhbnNhY3Rpb25zIGFzIHVzaXplXSA9IDE7IC8vIEFjdGl2ZQogICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25fc3RhcnRfdGltZVthY3RpdmVfdHJhbnNhY3Rpb25zIGFzIHVzaXplXSA9IGN1cnJlbnRfdGltZTsKICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX2xvY2tfY291bnRbYWN0aXZlX3RyYW5zYWN0aW9ucyBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICAgICAgYWN0aXZlX3RyYW5zYWN0aW9ucyA9IGFjdGl2ZV90cmFuc2FjdGlvbnMgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CgogICAgICAgIC8vIFByb2Nlc3MgbG9jayByZXF1ZXN0cyBmb3IgYWN0aXZlIHRyYW5zYWN0aW9ucwogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgYWN0aXZlX3RyYW5zYWN0aW9ucykgewogICAgICAgICAgICBpZiAodHJhbnNhY3Rpb25fc3RhdGVzW2kgYXMgdXNpemVdID09IDEpIHsKICAgICAgICAgICAgICAgIC8vIEFjdGl2ZSB0cmFuc2FjdGlvbgogICAgICAgICAgICAgICAgLy8gR2VuZXJhdGUgbG9jayByZXF1ZXN0cwogICAgICAgICAgICAgICAgbGV0IG11dCBsb2NrX3JlcXVlc3RzOiBpMzIgPSAoaSArIHJvdW5kKSAlIDMgKyAxOwogICAgICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICAgICAgd2hpbGUgKGogPCBsb2NrX3JlcXVlc3RzICYmIHRyYW5zYWN0aW9uX2xvY2tfY291bnRbaSBhcyB1c2l6ZV0gPCAxMCkgewogICAgICAgICAgICAgICAgICAgIGxldCByZXNvdXJjZV9pZDogaTMyID0gKChpICogNyArIGogKiAxMSArIHJvdW5kICogMykgJSAxMDApOwoKICAgICAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2VfbG9ja3NbcmVzb3VyY2VfaWQgYXMgdXNpemVdID09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdyYW50IGxvY2sKICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VfbG9ja3NbcmVzb3VyY2VfaWQgYXMgdXNpemVdID0gaTsKICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25fbG9ja3NbaSBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsodHJhbnNhY3Rpb25fbG9ja19jb3VudFtpIGFzIHVzaXplXSkgYXMgdXNpemVdID0gcmVzb3VyY2VfaWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uX2xvY2tfY291bnRbaSBhcyB1c2l6ZV0gPSB0cmFuc2FjdGlvbl9sb2NrX2NvdW50W2kgYXMgdXNpemVdICsgMTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlc291cmNlX2xvY2tzW3Jlc291cmNlX2lkIGFzIHVzaXplXSAhPSBpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0byB3YWl0IHF1ZXVlCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3YWl0X3F1ZXVlX2NvdW50W3Jlc291cmNlX2lkIGFzIHVzaXplXSA8IDUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2tfd2FpdF9xdWV1ZVtyZXNvdXJjZV9pZCBhcyB1c2l6ZV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbKHdhaXRfcXVldWVfY291bnRbcmVzb3VyY2VfaWQgYXMgdXNpemVdKSBhcyB1c2l6ZV0gPSBpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdF9xdWV1ZV9jb3VudFtyZXNvdXJjZV9pZCBhcyB1c2l6ZV0gPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRfcXVldWVfY291bnRbcmVzb3VyY2VfaWQgYXMgdXNpemVdICsgMTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgd2FpdC1mb3IgZ3JhcGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRfZm9yX2dyYXBoW2kgYXMgdXNpemVdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyhyZXNvdXJjZV9sb2Nrc1tyZXNvdXJjZV9pZCBhcyB1c2l6ZV0pIGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CgogICAgICAgIC8vIERlYWRsb2NrIGRldGVjdGlvbiB1c2luZyBERlMKICAgICAgICBsZXQgZGVhZGxvY2tfZGV0ZWN0ZWQ6IGJvb2wgPSBkZXRlY3REZWFkbG9jaygKICAgICAgICAgICAgJndhaXRfZm9yX2dyYXBoLAogICAgICAgICAgICAmbXV0IHZpc2l0ZWQsCiAgICAgICAgICAgICZtdXQgcmVjdXJzaW9uX3N0YWNrLAogICAgICAgICAgICBhY3RpdmVfdHJhbnNhY3Rpb25zLAogICAgICAgICk7CgogICAgICAgIGlmIChkZWFkbG9ja19kZXRlY3RlZCkgewogICAgICAgICAgICAvLyBBYm9ydCB5b3VuZ2VzdCB0cmFuc2FjdGlvbiBpbiBjeWNsZQogICAgICAgICAgICBsZXQgdmljdGltX3RyYW5zYWN0aW9uOiBpMzIgPSBmaW5kVmljdGltVHJhbnNhY3Rpb24oCiAgICAgICAgICAgICAgICAmdHJhbnNhY3Rpb25fc3RhcnRfdGltZSwKICAgICAgICAgICAgICAgICZ0cmFuc2FjdGlvbl9zdGF0ZXMsCiAgICAgICAgICAgICAgICBhY3RpdmVfdHJhbnNhY3Rpb25zLAogICAgICAgICAgICAgICAgY3VycmVudF90aW1lLAogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAodmljdGltX3RyYW5zYWN0aW9uID49IDApIHsKICAgICAgICAgICAgICAgIGFib3J0VHJhbnNhY3Rpb24oCiAgICAgICAgICAgICAgICAgICAgdmljdGltX3RyYW5zYWN0aW9uLAogICAgICAgICAgICAgICAgICAgICZtdXQgdHJhbnNhY3Rpb25fc3RhdGVzLAogICAgICAgICAgICAgICAgICAgICZ0cmFuc2FjdGlvbl9sb2NrcywKICAgICAgICAgICAgICAgICAgICAmbXV0IHRyYW5zYWN0aW9uX2xvY2tfY291bnQsCiAgICAgICAgICAgICAgICAgICAgJm11dCByZXNvdXJjZV9sb2NrcywKICAgICAgICAgICAgICAgICAgICAmbXV0IGxvY2tfd2FpdF9xdWV1ZSwKICAgICAgICAgICAgICAgICAgICAmbXV0IHdhaXRfcXVldWVfY291bnQsCiAgICAgICAgICAgICAgICAgICAgJm11dCB3YWl0X2Zvcl9ncmFwaCwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBhYm9ydGVkX2NvdW50ID0gYWJvcnRlZF9jb3VudCArIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIENvbW1pdCBzb21lIHRyYW5zYWN0aW9ucyByYW5kb21seQogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgYWN0aXZlX3RyYW5zYWN0aW9ucykgewogICAgICAgICAgICBpZiAodHJhbnNhY3Rpb25fc3RhdGVzW2kgYXMgdXNpemVdID09IDEKICAgICAgICAgICAgICAgICYmIChjdXJyZW50X3RpbWUgLSB0cmFuc2FjdGlvbl9zdGFydF90aW1lW2kgYXMgdXNpemVdKSA+IDMpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICgoaSArIHJvdW5kKSAlIDQgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGNvbW1pdFRyYW5zYWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICBpLAogICAgICAgICAgICAgICAgICAgICAgICAmbXV0IHRyYW5zYWN0aW9uX3N0YXRlcywKICAgICAgICAgICAgICAgICAgICAgICAgJnRyYW5zYWN0aW9uX2xvY2tzLAogICAgICAgICAgICAgICAgICAgICAgICAmbXV0IHRyYW5zYWN0aW9uX2xvY2tfY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgICZtdXQgcmVzb3VyY2VfbG9ja3MsCiAgICAgICAgICAgICAgICAgICAgICAgICZtdXQgbG9ja193YWl0X3F1ZXVlLAogICAgICAgICAgICAgICAgICAgICAgICAmbXV0IHdhaXRfcXVldWVfY291bnQsCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICBjb21taXR0ZWRfY291bnQgPSBjb21taXR0ZWRfY291bnQgKyAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CgogICAgICAgIGN1cnJlbnRfdGltZSA9IGN1cnJlbnRfdGltZSArIDE7CiAgICAgICAgcm91bmQgPSByb3VuZCArIDE7CiAgICB9CgogICAgcHJpbnRsbkludChjb21taXR0ZWRfY291bnQpOwogICAgcHJpbnRsbkludChhYm9ydGVkX2NvdW50KTsKICAgIHByaW50bG5JbnQoMjYwMDYpOyAvLyBFbmQgdHJhbnNhY3Rpb24gcHJvY2Vzc2luZyB0ZXN0Cn0KCi8vIERlYWRsb2NrIGRldGVjdGlvbiB1c2luZyBERlMKZm4gZGV0ZWN0RGVhZGxvY2soCiAgICB3YWl0X2dyYXBoOiAmW1tib29sOyA1MF07IDUwXSwKICAgIHZpc2l0ZWQ6ICZtdXQgW2Jvb2w7IDUwXSwKICAgIHJlY19zdGFjazogJm11dCBbYm9vbDsgNTBdLAogICAgdHJhbnNhY3Rpb25fY291bnQ6IGkzMiwKKSAtPiBib29sIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgdHJhbnNhY3Rpb25fY291bnQpIHsKICAgICAgICB2aXNpdGVkW2kgYXMgdXNpemVdID0gZmFsc2U7CiAgICAgICAgcmVjX3N0YWNrW2kgYXMgdXNpemVdID0gZmFsc2U7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCB0cmFuc2FjdGlvbl9jb3VudCkgewogICAgICAgIGlmICghdmlzaXRlZFtpIGFzIHVzaXplXSkgewogICAgICAgICAgICBpZiAoZGV0ZWN0Q3ljbGVERlMod2FpdF9ncmFwaCwgdmlzaXRlZCwgcmVjX3N0YWNrLCBpLCB0cmFuc2FjdGlvbl9jb3VudCkpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBmYWxzZQp9CgovLyBERlMgaGVscGVyIGZvciBjeWNsZSBkZXRlY3Rpb24KZm4gZGV0ZWN0Q3ljbGVERlMoCiAgICB3YWl0X2dyYXBoOiAmW1tib29sOyA1MF07IDUwXSwKICAgIHZpc2l0ZWQ6ICZtdXQgW2Jvb2w7IDUwXSwKICAgIHJlY19zdGFjazogJm11dCBbYm9vbDsgNTBdLAogICAgbm9kZTogaTMyLAogICAgdHJhbnNhY3Rpb25fY291bnQ6IGkzMiwKKSAtPiBib29sIHsKICAgIHZpc2l0ZWRbbm9kZSBhcyB1c2l6ZV0gPSB0cnVlOwogICAgcmVjX3N0YWNrW25vZGUgYXMgdXNpemVdID0gdHJ1ZTsKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHRyYW5zYWN0aW9uX2NvdW50KSB7CiAgICAgICAgaWYgKHdhaXRfZ3JhcGhbbm9kZSBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgaWYgKCF2aXNpdGVkW2kgYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBpZiAoZGV0ZWN0Q3ljbGVERlMod2FpdF9ncmFwaCwgdmlzaXRlZCwgcmVjX3N0YWNrLCBpLCB0cmFuc2FjdGlvbl9jb3VudCkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChyZWNfc3RhY2tbaSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICByZWNfc3RhY2tbbm9kZSBhcyB1c2l6ZV0gPSBmYWxzZTsKICAgIGZhbHNlCn0KCi8vIEZpbmQgdmljdGltIHRyYW5zYWN0aW9uIGZvciBkZWFkbG9jayByZXNvbHV0aW9uCmZuIGZpbmRWaWN0aW1UcmFuc2FjdGlvbigKICAgIHN0YXJ0X3RpbWVzOiAmW2kzMjsgNTBdLAogICAgc3RhdGVzOiAmW2kzMjsgNTBdLAogICAgY291bnQ6IGkzMiwKICAgIGN1cnJlbnRfdGltZTogaTMyLAopIC0+IGkzMiB7CiAgICBsZXQgbXV0IHlvdW5nZXN0X3RyYW5zYWN0aW9uOiBpMzIgPSAtMTsKICAgIGxldCBtdXQgbGF0ZXN0X3N0YXJ0X3RpbWU6IGkzMiA9IDA7CgogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBjb3VudCkgewogICAgICAgIGlmIChzdGF0ZXNbaSBhcyB1c2l6ZV0gPT0gMSAmJiBzdGFydF90aW1lc1tpIGFzIHVzaXplXSA+IGxhdGVzdF9zdGFydF90aW1lKSB7CiAgICAgICAgICAgIGxhdGVzdF9zdGFydF90aW1lID0gc3RhcnRfdGltZXNbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIHlvdW5nZXN0X3RyYW5zYWN0aW9uID0gaTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIHlvdW5nZXN0X3RyYW5zYWN0aW9uCn0KCi8vIEFib3J0IGEgdHJhbnNhY3Rpb24gYW5kIHJlbGVhc2UgaXRzIGxvY2tzCmZuIGFib3J0VHJhbnNhY3Rpb24oCiAgICB0cmFuc2FjdGlvbl9pZDogaTMyLAogICAgc3RhdGVzOiAmbXV0IFtpMzI7IDUwXSwKICAgIGxvY2tzOiAmW1tpMzI7IDEwXTsgNTBdLAogICAgbG9ja19jb3VudHM6ICZtdXQgW2kzMjsgNTBdLAogICAgcmVzb3VyY2VfbG9ja3M6ICZtdXQgW2kzMjsgMTAwXSwKICAgIHdhaXRfcXVldWVzOiAmbXV0IFtbaTMyOyA1XTsgMTAwXSwKICAgIHdhaXRfY291bnRzOiAmbXV0IFtpMzI7IDEwMF0sCiAgICB3YWl0X2dyYXBoOiAmbXV0IFtbYm9vbDsgNTBdOyA1MF0sCikgewogICAgc3RhdGVzW3RyYW5zYWN0aW9uX2lkIGFzIHVzaXplXSA9IDM7IC8vIEFib3J0ZWQKCiAgICAvLyBSZWxlYXNlIGFsbCBsb2NrcyBoZWxkIGJ5IHRoaXMgdHJhbnNhY3Rpb24KICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbG9ja19jb3VudHNbdHJhbnNhY3Rpb25faWQgYXMgdXNpemVdKSB7CiAgICAgICAgbGV0IHJlc291cmNlX2lkOiBpMzIgPSBsb2Nrc1t0cmFuc2FjdGlvbl9pZCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV07CiAgICAgICAgcmVzb3VyY2VfbG9ja3NbcmVzb3VyY2VfaWQgYXMgdXNpemVdID0gLTE7CgogICAgICAgIC8vIEdyYW50IGxvY2sgdG8gbmV4dCB3YWl0aW5nIHRyYW5zYWN0aW9uCiAgICAgICAgaWYgKHdhaXRfY291bnRzW3Jlc291cmNlX2lkIGFzIHVzaXplXSA+IDApIHsKICAgICAgICAgICAgbGV0IG5leHRfdHJhbnNhY3Rpb246IGkzMiA9IHdhaXRfcXVldWVzW3Jlc291cmNlX2lkIGFzIHVzaXplXVswXTsKICAgICAgICAgICAgcmVzb3VyY2VfbG9ja3NbcmVzb3VyY2VfaWQgYXMgdXNpemVdID0gbmV4dF90cmFuc2FjdGlvbjsKCiAgICAgICAgICAgIC8vIFNoaWZ0IHdhaXQgcXVldWUKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IHdhaXRfY291bnRzW3Jlc291cmNlX2lkIGFzIHVzaXplXSAtIDEpIHsKICAgICAgICAgICAgICAgIHdhaXRfcXVldWVzW3Jlc291cmNlX2lkIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9CiAgICAgICAgICAgICAgICAgICAgd2FpdF9xdWV1ZXNbcmVzb3VyY2VfaWQgYXMgdXNpemVdW2ogYXMgdXNpemUgKyAxXTsKICAgICAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICB3YWl0X2NvdW50c1tyZXNvdXJjZV9pZCBhcyB1c2l6ZV0gPSB3YWl0X2NvdW50c1tyZXNvdXJjZV9pZCBhcyB1c2l6ZV0gLSAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gQ2xlYXIgd2FpdC1mb3IgcmVsYXRpb25zaGlwcwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDUwKSB7CiAgICAgICAgd2FpdF9ncmFwaFt0cmFuc2FjdGlvbl9pZCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gPSBmYWxzZTsKICAgICAgICB3YWl0X2dyYXBoW2kgYXMgdXNpemVdW3RyYW5zYWN0aW9uX2lkIGFzIHVzaXplXSA9IGZhbHNlOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBsb2NrX2NvdW50c1t0cmFuc2FjdGlvbl9pZCBhcyB1c2l6ZV0gPSAwOwp9CgovLyBDb21taXQgYSB0cmFuc2FjdGlvbiBhbmQgcmVsZWFzZSBpdHMgbG9ja3MKZm4gY29tbWl0VHJhbnNhY3Rpb24oCiAgICB0cmFuc2FjdGlvbl9pZDogaTMyLAogICAgc3RhdGVzOiAmbXV0IFtpMzI7IDUwXSwKICAgIGxvY2tzOiAmW1tpMzI7IDEwXTsgNTBdLAogICAgbG9ja19jb3VudHM6ICZtdXQgW2kzMjsgNTBdLAogICAgcmVzb3VyY2VfbG9ja3M6ICZtdXQgW2kzMjsgMTAwXSwKICAgIHdhaXRfcXVldWVzOiAmbXV0IFtbaTMyOyA1XTsgMTAwXSwKICAgIHdhaXRfY291bnRzOiAmbXV0IFtpMzI7IDEwMF0sCikgewogICAgc3RhdGVzW3RyYW5zYWN0aW9uX2lkIGFzIHVzaXplXSA9IDI7IC8vIENvbW1pdHRlZAoKICAgIC8vIFJlbGVhc2UgYWxsIGxvY2tzIGhlbGQgYnkgdGhpcyB0cmFuc2FjdGlvbgogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBsb2NrX2NvdW50c1t0cmFuc2FjdGlvbl9pZCBhcyB1c2l6ZV0pIHsKICAgICAgICBsZXQgcmVzb3VyY2VfaWQ6IGkzMiA9IGxvY2tzW3RyYW5zYWN0aW9uX2lkIGFzIHVzaXplXVtpIGFzIHVzaXplXTsKICAgICAgICByZXNvdXJjZV9sb2Nrc1tyZXNvdXJjZV9pZCBhcyB1c2l6ZV0gPSAtMTsKCiAgICAgICAgLy8gR3JhbnQgbG9jayB0byBuZXh0IHdhaXRpbmcgdHJhbnNhY3Rpb24KICAgICAgICBpZiAod2FpdF9jb3VudHNbcmVzb3VyY2VfaWQgYXMgdXNpemVdID4gMCkgewogICAgICAgICAgICBsZXQgbmV4dF90cmFuc2FjdGlvbjogaTMyID0gd2FpdF9xdWV1ZXNbcmVzb3VyY2VfaWQgYXMgdXNpemVdWzBdOwogICAgICAgICAgICByZXNvdXJjZV9sb2Nrc1tyZXNvdXJjZV9pZCBhcyB1c2l6ZV0gPSBuZXh0X3RyYW5zYWN0aW9uOwoKICAgICAgICAgICAgLy8gU2hpZnQgd2FpdCBxdWV1ZQogICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChqIDwgd2FpdF9jb3VudHNbcmVzb3VyY2VfaWQgYXMgdXNpemVdIC0gMSkgewogICAgICAgICAgICAgICAgd2FpdF9xdWV1ZXNbcmVzb3VyY2VfaWQgYXMgdXNpemVdW2ogYXMgdXNpemVdID0KICAgICAgICAgICAgICAgICAgICB3YWl0X3F1ZXVlc1tyZXNvdXJjZV9pZCBhcyB1c2l6ZV1baiBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHdhaXRfY291bnRzW3Jlc291cmNlX2lkIGFzIHVzaXplXSA9IHdhaXRfY291bnRzW3Jlc291cmNlX2lkIGFzIHVzaXplXSAtIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBsb2NrX2NvdW50c1t0cmFuc2FjdGlvbl9pZCBhcyB1c2l6ZV0gPSAwOwp9CgovLyBUZXN0IDQ6IEJ1ZmZlciBQb29sIE1hbmFnZW1lbnQKLy8gVGVzdHMgY2FjaGUgcmVwbGFjZW1lbnQgYWxnb3JpdGhtcyBhbmQgbWVtb3J5IG9wdGltaXphdGlvbgpmbiBwZXJmb3JtQnVmZmVyUG9vbFRlc3QocG9vbF9zaXplOiBpMzIpIHsKICAgIHByaW50bG5JbnQoMjYwMDcpOyAvLyBTdGFydCBidWZmZXIgcG9vbCB0ZXN0CgogICAgLy8gQnVmZmVyIHBvb2wgc3RydWN0dXJlcwogICAgbGV0IG11dCBidWZmZXJfcG9vbDogW2kzMjsgMTAwXSA9IFstMTsgMTAwXTsgLy8gUGFnZSBJRHMgaW4gYnVmZmVyCiAgICBsZXQgbXV0IGJ1ZmZlcl9kaXJ0eTogW2Jvb2w7IDEwMF0gPSBbZmFsc2U7IDEwMF07IC8vIERpcnR5IGZsYWdzCiAgICBsZXQgbXV0IGJ1ZmZlcl9waW5fY291bnQ6IFtpMzI7IDEwMF0gPSBbMDsgMTAwXTsgLy8gUGluIGNvdW50cwogICAgbGV0IG11dCBidWZmZXJfbGFzdF91c2VkOiBbaTMyOyAxMDBdID0gWzA7IDEwMF07IC8vIExSVSB0aW1lc3RhbXBzCiAgICBsZXQgbXV0IGJ1ZmZlcl9yZWZlcmVuY2VfYml0OiBbYm9vbDsgMTAwXSA9IFtmYWxzZTsgMTAwXTsgLy8gQ0xPQ0sgYWxnb3JpdGhtIHJlZmVyZW5jZSBiaXRzCiAgICBsZXQgbXV0IGNsb2NrX2hhbmQ6IGkzMiA9IDA7IC8vIENMT0NLIGFsZ29yaXRobSBoYW5kIHBvc2l0aW9uCiAgICBsZXQgbXV0IGN1cnJlbnRfdGltZTogaTMyID0gMTsKCiAgICAvLyBQYWdlIHRhYmxlIGZvciB0cmFja2luZyB3aGljaCBwYWdlcyBhcmUgaW4gYnVmZmVyCiAgICBsZXQgbXV0IHBhZ2VfdG9fYnVmZmVyOiBbaTMyOyA1MDBdID0gWy0xOyA1MDBdOyAvLyBNYXBzIHBhZ2UgSUQgdG8gYnVmZmVyIHNsb3QKCiAgICBsZXQgbXV0IGJ1ZmZlcl9oaXRzOiBpMzIgPSAwOwogICAgbGV0IG11dCBidWZmZXJfbWlzc2VzOiBpMzIgPSAwOwogICAgbGV0IG11dCBwYWdlX2V2aWN0aW9uczogaTMyID0gMDsKCiAgICAvLyBTaW11bGF0ZSBkYXRhYmFzZSBwYWdlIGFjY2VzcyBwYXR0ZXJuCiAgICBsZXQgbXV0IGFjY2Vzc19jb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgcm91bmQ6IGkzMiA9IDA7CgogICAgd2hpbGUgKHJvdW5kIDwgMzAgJiYgYWNjZXNzX2NvdW50IDwgMjAwKSB7CiAgICAgICAgLy8gR2VuZXJhdGUgcGFnZSBhY2Nlc3MgcGF0dGVybiAobWl4dHVyZSBvZiBzZXF1ZW50aWFsIGFuZCByYW5kb20pCiAgICAgICAgbGV0IG11dCBwYXR0ZXJuX3R5cGU6IGkzMiA9IHJvdW5kICUgNDsKICAgICAgICBsZXQgbXV0IHBhZ2VzX2luX3BhdHRlcm46IGkzMiA9IChyb3VuZCAlIDUpICsgMzsKCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgcGFnZXNfaW5fcGF0dGVybiAmJiBhY2Nlc3NfY291bnQgPCAyMDApIHsKICAgICAgICAgICAgbGV0IHBhZ2VfaWQ6IGkzMiA9IGlmIChwYXR0ZXJuX3R5cGUgPT0gMCkgewogICAgICAgICAgICAgICAgLy8gU2VxdWVudGlhbCBhY2Nlc3MKICAgICAgICAgICAgICAgIChyb3VuZCAqIDEwICsgaSkgJSA0MDAgKyAxCiAgICAgICAgICAgIH0gZWxzZSBpZiAocGF0dGVybl90eXBlID09IDEpIHsKICAgICAgICAgICAgICAgIC8vIFJhbmRvbSBhY2Nlc3MKICAgICAgICAgICAgICAgICgoYWNjZXNzX2NvdW50ICogMTcgKyAyMykgJSAzNTApICsgMQogICAgICAgICAgICB9IGVsc2UgaWYgKHBhdHRlcm5fdHlwZSA9PSAyKSB7CiAgICAgICAgICAgICAgICAvLyBMb2NhbGl0eSBvZiByZWZlcmVuY2UgKGhvdCBwYWdlcykKICAgICAgICAgICAgICAgICgoYWNjZXNzX2NvdW50ICogMykgJSA1MCkgKyAxCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBNaXhlZCBwYXR0ZXJuCiAgICAgICAgICAgICAgICAoKGFjY2Vzc19jb3VudCAqIDcgKyByb3VuZCAqIDExKSAlIDMwMCkgKyAxCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIC8vIENoZWNrIGlmIHBhZ2UgaXMgaW4gYnVmZmVyIHBvb2wKICAgICAgICAgICAgbGV0IGJ1ZmZlcl9zbG90OiBpMzIgPSBwYWdlX3RvX2J1ZmZlcltwYWdlX2lkIGFzIHVzaXplXTsKCiAgICAgICAgICAgIGlmIChidWZmZXJfc2xvdCA+PSAwICYmIGJ1ZmZlcl9wb29sW2J1ZmZlcl9zbG90IGFzIHVzaXplXSA9PSBwYWdlX2lkKSB7CiAgICAgICAgICAgICAgICAvLyBCdWZmZXIgaGl0CiAgICAgICAgICAgICAgICBidWZmZXJfaGl0cyA9IGJ1ZmZlcl9oaXRzICsgMTsKICAgICAgICAgICAgICAgIGJ1ZmZlcl9sYXN0X3VzZWRbYnVmZmVyX3Nsb3QgYXMgdXNpemVdID0gY3VycmVudF90aW1lOwogICAgICAgICAgICAgICAgYnVmZmVyX3JlZmVyZW5jZV9iaXRbYnVmZmVyX3Nsb3QgYXMgdXNpemVdID0gdHJ1ZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIEJ1ZmZlciBtaXNzCiAgICAgICAgICAgICAgICBidWZmZXJfbWlzc2VzID0gYnVmZmVyX21pc3NlcyArIDE7CgogICAgICAgICAgICAgICAgLy8gRmluZCBmcmVlIGJ1ZmZlciBzbG90IG9yIGV2aWN0IHBhZ2UKICAgICAgICAgICAgICAgIGxldCBtdXQgZnJlZV9zbG90OiBpMzIgPSBmaW5kRnJlZUJ1ZmZlclNsb3QoJmJ1ZmZlcl9wb29sLCBwb29sX3NpemUpOwoKICAgICAgICAgICAgICAgIGlmIChmcmVlX3Nsb3QgPj0gMCkgewogICAgICAgICAgICAgICAgICAgIC8vIFVzZSBmcmVlIHNsb3QKICAgICAgICAgICAgICAgICAgICBidWZmZXJfcG9vbFtmcmVlX3Nsb3QgYXMgdXNpemVdID0gcGFnZV9pZDsKICAgICAgICAgICAgICAgICAgICBidWZmZXJfZGlydHlbZnJlZV9zbG90IGFzIHVzaXplXSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGJ1ZmZlcl9waW5fY291bnRbZnJlZV9zbG90IGFzIHVzaXplXSA9IDA7CiAgICAgICAgICAgICAgICAgICAgYnVmZmVyX2xhc3RfdXNlZFtmcmVlX3Nsb3QgYXMgdXNpemVdID0gY3VycmVudF90aW1lOwogICAgICAgICAgICAgICAgICAgIGJ1ZmZlcl9yZWZlcmVuY2VfYml0W2ZyZWVfc2xvdCBhcyB1c2l6ZV0gPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHBhZ2VfdG9fYnVmZmVyW3BhZ2VfaWQgYXMgdXNpemVdID0gZnJlZV9zbG90OwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIGV2aWN0IGEgcGFnZSB1c2luZyBDTE9DSyBhbGdvcml0aG0KICAgICAgICAgICAgICAgICAgICBsZXQgZXZpY3Rfc2xvdDogaTMyID0gY2xvY2tQYWdlUmVwbGFjZW1lbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICZidWZmZXJfcG9vbCwKICAgICAgICAgICAgICAgICAgICAgICAgJmJ1ZmZlcl9waW5fY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgICZtdXQgYnVmZmVyX3JlZmVyZW5jZV9iaXQsCiAgICAgICAgICAgICAgICAgICAgICAgIGNsb2NrX2hhbmQsCiAgICAgICAgICAgICAgICAgICAgICAgIHBvb2xfc2l6ZSwKICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICBpZiAoZXZpY3Rfc2xvdCA+PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBjbG9jayBoYW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGNsb2NrX2hhbmQgPSAoZXZpY3Rfc2xvdCArIDEpICUgcG9vbF9zaXplOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXZpY3Qgb2xkIHBhZ2UKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG9sZF9wYWdlX2lkOiBpMzIgPSBidWZmZXJfcG9vbFtldmljdF9zbG90IGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9sZF9wYWdlX2lkID49IDAgJiYgb2xkX3BhZ2VfaWQgPCA1MDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VfdG9fYnVmZmVyW29sZF9wYWdlX2lkIGFzIHVzaXplXSA9IC0xOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VfZXZpY3Rpb25zID0gcGFnZV9ldmljdGlvbnMgKyAxOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gTG9hZCBuZXcgcGFnZQogICAgICAgICAgICAgICAgICAgICAgICBidWZmZXJfcG9vbFtldmljdF9zbG90IGFzIHVzaXplXSA9IHBhZ2VfaWQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZmZlcl9kaXJ0eVtldmljdF9zbG90IGFzIHVzaXplXSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICBidWZmZXJfcGluX2NvdW50W2V2aWN0X3Nsb3QgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgYnVmZmVyX2xhc3RfdXNlZFtldmljdF9zbG90IGFzIHVzaXplXSA9IGN1cnJlbnRfdGltZTsKICAgICAgICAgICAgICAgICAgICAgICAgYnVmZmVyX3JlZmVyZW5jZV9iaXRbZXZpY3Rfc2xvdCBhcyB1c2l6ZV0gPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBwYWdlX3RvX2J1ZmZlcltwYWdlX2lkIGFzIHVzaXplXSA9IGV2aWN0X3Nsb3Q7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBTaW11bGF0ZSBwYWdlIG1vZGlmaWNhdGlvbnMgKG1hcmsgYXMgZGlydHkpCiAgICAgICAgICAgIGlmICgoYWNjZXNzX2NvdW50ICUgMykgPT0gMCAmJiBwYWdlX3RvX2J1ZmZlcltwYWdlX2lkIGFzIHVzaXplXSA+PSAwKSB7CiAgICAgICAgICAgICAgICBidWZmZXJfZGlydHlbKHBhZ2VfdG9fYnVmZmVyW3BhZ2VfaWQgYXMgdXNpemVdKSBhcyB1c2l6ZV0gPSB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjdXJyZW50X3RpbWUgPSBjdXJyZW50X3RpbWUgKyAxOwogICAgICAgICAgICBhY2Nlc3NfY291bnQgPSBhY2Nlc3NfY291bnQgKyAxOwogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQoKICAgICAgICByb3VuZCA9IHJvdW5kICsgMTsKICAgIH0KCiAgICAvLyBDYWxjdWxhdGUgaGl0IHJhdGlvCiAgICBsZXQgaGl0X3JhdGlvOiBpMzIgPSAoYnVmZmVyX2hpdHMgKiAxMDApIC8gKGJ1ZmZlcl9oaXRzICsgYnVmZmVyX21pc3Nlcyk7CgogICAgcHJpbnRsbkludChidWZmZXJfaGl0cyk7CiAgICBwcmludGxuSW50KGJ1ZmZlcl9taXNzZXMpOwogICAgcHJpbnRsbkludChoaXRfcmF0aW8pOwogICAgcHJpbnRsbkludChwYWdlX2V2aWN0aW9ucyk7CiAgICBwcmludGxuSW50KDI2MDA4KTsgLy8gRW5kIGJ1ZmZlciBwb29sIHRlc3QKfQoKLy8gRmluZCBmcmVlIGJ1ZmZlciBzbG90CmZuIGZpbmRGcmVlQnVmZmVyU2xvdChidWZmZXJfcG9vbDogJltpMzI7IDEwMF0sIHBvb2xfc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBwb29sX3NpemUpIHsKICAgICAgICBpZiAoYnVmZmVyX3Bvb2xbaSBhcyB1c2l6ZV0gPT0gLTEpIHsKICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH07CiAgICAtMQp9CgovLyBDTE9DSyBwYWdlIHJlcGxhY2VtZW50IGFsZ29yaXRobQpmbiBjbG9ja1BhZ2VSZXBsYWNlbWVudCgKICAgIGJ1ZmZlcl9wb29sOiAmW2kzMjsgMTAwXSwKICAgIHBpbl9jb3VudHM6ICZbaTMyOyAxMDBdLAogICAgcmVmZXJlbmNlX2JpdHM6ICZtdXQgW2Jvb2w7IDEwMF0sCiAgICBzdGFydF9oYW5kOiBpMzIsCiAgICBwb29sX3NpemU6IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IG11dCBjdXJyZW50X2hhbmQ6IGkzMiA9IHN0YXJ0X2hhbmQ7CiAgICBsZXQgbXV0IGN5Y2xlczogaTMyID0gMDsKCiAgICB3aGlsZSAoY3ljbGVzIDwgMikgewogICAgICAgIGlmIChwaW5fY291bnRzW2N1cnJlbnRfaGFuZCBhcyB1c2l6ZV0gPT0gMCkgewogICAgICAgICAgICBpZiAoIXJlZmVyZW5jZV9iaXRzW2N1cnJlbnRfaGFuZCBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50X2hhbmQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZWZlcmVuY2VfYml0c1tjdXJyZW50X2hhbmQgYXMgdXNpemVdID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGN1cnJlbnRfaGFuZCA9IChjdXJyZW50X2hhbmQgKyAxKSAlIHBvb2xfc2l6ZTsKICAgICAgICBpZiAoY3VycmVudF9oYW5kID09IHN0YXJ0X2hhbmQpIHsKICAgICAgICAgICAgY3ljbGVzID0gY3ljbGVzICsgMTsKICAgICAgICB9CiAgICB9CgogICAgLy8gSWYgbm8gcGFnZSBjYW4gYmUgZXZpY3RlZCwgcmV0dXJuIGZpcnN0IHVucGlubmVkIHBhZ2UKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgcG9vbF9zaXplKSB7CiAgICAgICAgaWYgKHBpbl9jb3VudHNbaSBhcyB1c2l6ZV0gPT0gMCkgewogICAgICAgICAgICByZXR1cm4gaTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIC0xCn0KCi8vIFRlc3QgNTogUXVlcnkgT3B0aW1pemF0aW9uIEVuZ2luZQovLyBUZXN0cyBjb3N0LWJhc2VkIG9wdGltaXphdGlvbiBhbmQgY29tcGxleCBkZWNpc2lvbiB0cmVlcwpmbiBwZXJmb3JtUXVlcnlPcHRpbWl6YXRpb25UZXN0KHRhYmxlX3NpemU6IGkzMikgewogICAgcHJpbnRsbkludCgyNjAwOSk7IC8vIFN0YXJ0IHF1ZXJ5IG9wdGltaXphdGlvbiB0ZXN0CgogICAgLy8gVGFibGUgc3RhdGlzdGljcyBmb3IgY29zdCBlc3RpbWF0aW9uCiAgICBsZXQgbXV0IHRhYmxlX2NhcmRpbmFsaXRpZXM6IFtpMzI7IDVdID0gWzEwMCwgMjAwLCAxNTAsIDMwMCwgMjUwXTsKICAgIGxldCBtdXQgdGFibGVfcGFnZXM6IFtpMzI7IDVdID0gWzEwLCAyMCwgMTUsIDMwLCAyNV07CiAgICBsZXQgbXV0IGluZGV4X3NlbGVjdGl2aXRpZXM6IFtbaTMyOyAzXTsgNV0gPSBbWzEwLCAyNSwgNTBdOyA1XTsgLy8gU2VsZWN0aXZpdHkgcGVyY2VudGFnZXMgZm9yIGRpZmZlcmVudCBpbmRleGVzCgogICAgLy8gUXVlcnkgcGxhbnMgYW5kIHRoZWlyIGNvc3RzCiAgICBsZXQgbXV0IHBsYW5fY29zdHM6IFtpMzI7IDIwXSA9IFswOyAyMF07CiAgICBsZXQgbXV0IHBsYW5fdHlwZXM6IFtpMzI7IDIwXSA9IFswOyAyMF07IC8vIDA9bmVzdGVkIGxvb3AsIDE9aGFzaCBqb2luLCAyPXNvcnQtbWVyZ2UKICAgIGxldCBtdXQgcGxhbl9jb3VudDogaTMyID0gMDsKCiAgICAvLyBTaW11bGF0ZSBjb21wbGV4IHF1ZXJ5IG9wdGltaXphdGlvbiBzY2VuYXJpb3MKICAgIGxldCBtdXQgcXVlcnlfaWQ6IGkzMiA9IDA7CiAgICB3aGlsZSAocXVlcnlfaWQgPCAxMCkgewogICAgICAgIC8vIEdlbmVyYXRlIGRpZmZlcmVudCBqb2luIG9yZGVycyBhbmQgYWNjZXNzIG1ldGhvZHMKICAgICAgICBsZXQgbnVtX3RhYmxlczogaTMyID0gKHF1ZXJ5X2lkICUgMykgKyAyOyAvLyAyLTQgdGFibGVzCiAgICAgICAgbGV0IG11dCBiZXN0X2Nvc3Q6IGkzMiA9IDk5OTk5OTsKICAgICAgICBsZXQgbXV0IGJlc3RfcGxhbjogaTMyID0gLTE7CgogICAgICAgIC8vIEVudW1lcmF0ZSBkaWZmZXJlbnQgam9pbiBvcmRlcnMKICAgICAgICBsZXQgbXV0IGpvaW5fb3JkZXI6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGpvaW5fb3JkZXIgPCA2ICYmIHBsYW5fY291bnQgPCAyMCkgewogICAgICAgICAgICBsZXQgbXV0IGN1cnJlbnRfY29zdDogaTMyID0gMDsKCiAgICAgICAgICAgIC8vIENvc3QgZXN0aW1hdGlvbiBmb3IgZGlmZmVyZW50IGpvaW4gYWxnb3JpdGhtcwogICAgICAgICAgICBpZiAoam9pbl9vcmRlciAlIDMgPT0gMCkgewogICAgICAgICAgICAgICAgLy8gTmVzdGVkIGxvb3Agam9pbgogICAgICAgICAgICAgICAgY3VycmVudF9jb3N0ID0KICAgICAgICAgICAgICAgICAgICBlc3RpbWF0ZU5lc3RlZExvb3BDb3N0KHRhYmxlX2NhcmRpbmFsaXRpZXMsIHRhYmxlX3BhZ2VzLCBudW1fdGFibGVzLCBxdWVyeV9pZCk7CiAgICAgICAgICAgICAgICBwbGFuX3R5cGVzW3BsYW5fY291bnQgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgfSBlbHNlIGlmIChqb2luX29yZGVyICUgMyA9PSAxKSB7CiAgICAgICAgICAgICAgICAvLyBIYXNoIGpvaW4KICAgICAgICAgICAgICAgIGN1cnJlbnRfY29zdCA9CiAgICAgICAgICAgICAgICAgICAgZXN0aW1hdGVIYXNoSm9pbkNvc3QodGFibGVfY2FyZGluYWxpdGllcywgdGFibGVfcGFnZXMsIG51bV90YWJsZXMsIHF1ZXJ5X2lkKTsKICAgICAgICAgICAgICAgIHBsYW5fdHlwZXNbcGxhbl9jb3VudCBhcyB1c2l6ZV0gPSAxOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gU29ydC1tZXJnZSBqb2luCiAgICAgICAgICAgICAgICBjdXJyZW50X2Nvc3QgPQogICAgICAgICAgICAgICAgICAgIGVzdGltYXRlU29ydE1lcmdlQ29zdCh0YWJsZV9jYXJkaW5hbGl0aWVzLCB0YWJsZV9wYWdlcywgbnVtX3RhYmxlcywgcXVlcnlfaWQpOwogICAgICAgICAgICAgICAgcGxhbl90eXBlc1twbGFuX2NvdW50IGFzIHVzaXplXSA9IDI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIEFkZCBpbmRleCBzZWxlY3Rpb24gY29zdAogICAgICAgICAgICBsZXQgaW5kZXhfY29zdDogaTMyID0gc2VsZWN0T3B0aW1hbEluZGV4KGluZGV4X3NlbGVjdGl2aXRpZXMsIG51bV90YWJsZXMsIHF1ZXJ5X2lkKTsKICAgICAgICAgICAgY3VycmVudF9jb3N0ID0gY3VycmVudF9jb3N0ICsgaW5kZXhfY29zdDsKCiAgICAgICAgICAgIHBsYW5fY29zdHNbcGxhbl9jb3VudCBhcyB1c2l6ZV0gPSBjdXJyZW50X2Nvc3Q7CgogICAgICAgICAgICBpZiAoY3VycmVudF9jb3N0IDwgYmVzdF9jb3N0KSB7CiAgICAgICAgICAgICAgICBiZXN0X2Nvc3QgPSBjdXJyZW50X2Nvc3Q7CiAgICAgICAgICAgICAgICBiZXN0X3BsYW4gPSBwbGFuX2NvdW50OwogICAgICAgICAgICB9CgogICAgICAgICAgICBwbGFuX2NvdW50ID0gcGxhbl9jb3VudCArIDE7CiAgICAgICAgICAgIGpvaW5fb3JkZXIgPSBqb2luX29yZGVyICsgMTsKICAgICAgICB9CgogICAgICAgIC8vIFNpbXVsYXRlIHBsYW4gZXhlY3V0aW9uIGNvc3QgdmVyaWZpY2F0aW9uCiAgICAgICAgaWYgKGJlc3RfcGxhbiA+PSAwKSB7CiAgICAgICAgICAgIGxldCBhY3R1YWxfY29zdDogaTMyID0gc2ltdWxhdGVQbGFuRXhlY3V0aW9uKAogICAgICAgICAgICAgICAgcGxhbl90eXBlc1tiZXN0X3BsYW4gYXMgdXNpemVdLAogICAgICAgICAgICAgICAgdGFibGVfY2FyZGluYWxpdGllcywKICAgICAgICAgICAgICAgIG51bV90YWJsZXMsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGxldCBjb3N0X2FjY3VyYWN5OiBpMzIgPQogICAgICAgICAgICAgICAgY2FsY3VsYXRlQ29zdEFjY3VyYWN5KHBsYW5fY29zdHNbYmVzdF9wbGFuIGFzIHVzaXplXSwgYWN0dWFsX2Nvc3QpOwogICAgICAgICAgICBwcmludGxuSW50KGNvc3RfYWNjdXJhY3kpOwogICAgICAgIH0KCiAgICAgICAgcXVlcnlfaWQgPSBxdWVyeV9pZCArIDE7CiAgICB9CgogICAgLy8gQW5hbHl6ZSBwbGFuIGRpc3RyaWJ1dGlvbgogICAgbGV0IG11dCBuZXN0ZWRfbG9vcF9jb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgaGFzaF9qb2luX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBzb3J0X21lcmdlX2NvdW50OiBpMzIgPSAwOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgcGxhbl9jb3VudCkgewogICAgICAgIGlmIChwbGFuX3R5cGVzW2kgYXMgdXNpemVdID09IDApIHsKICAgICAgICAgICAgbmVzdGVkX2xvb3BfY291bnQgPSBuZXN0ZWRfbG9vcF9jb3VudCArIDE7CiAgICAgICAgfSBlbHNlIGlmIChwbGFuX3R5cGVzW2kgYXMgdXNpemVdID09IDEpIHsKICAgICAgICAgICAgaGFzaF9qb2luX2NvdW50ID0gaGFzaF9qb2luX2NvdW50ICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzb3J0X21lcmdlX2NvdW50ID0gc29ydF9tZXJnZV9jb3VudCArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBwcmludGxuSW50KG5lc3RlZF9sb29wX2NvdW50KTsKICAgIHByaW50bG5JbnQoaGFzaF9qb2luX2NvdW50KTsKICAgIHByaW50bG5JbnQoc29ydF9tZXJnZV9jb3VudCk7CiAgICBwcmludGxuSW50KDI2MDEwKTsgLy8gRW5kIHF1ZXJ5IG9wdGltaXphdGlvbiB0ZXN0Cn0KCi8vIENvc3QgZXN0aW1hdGlvbiBmdW5jdGlvbnMKZm4gZXN0aW1hdGVOZXN0ZWRMb29wQ29zdCgKICAgIGNhcmRpbmFsaXRpZXM6IFtpMzI7IDVdLAogICAgcGFnZXM6IFtpMzI7IDVdLAogICAgbnVtX3RhYmxlczogaTMyLAogICAgcXVlcnlfaWQ6IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IG11dCBjb3N0OiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBudW1fdGFibGVzIC0gMSkgewogICAgICAgIGxldCBvdXRlcl90YWJsZTogaTMyID0gaSAlIDU7CiAgICAgICAgbGV0IGlubmVyX3RhYmxlOiBpMzIgPSAoaSArIDEpICUgNTsKICAgICAgICBjb3N0ID0gY29zdCArIGNhcmRpbmFsaXRpZXNbb3V0ZXJfdGFibGUgYXMgdXNpemVdICogcGFnZXNbaW5uZXJfdGFibGUgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIGNvc3QgKyAocXVlcnlfaWQgKiAxMDApIC8vIEFkZCBxdWVyeS1zcGVjaWZpYyBvdmVyaGVhZAp9CgpmbiBlc3RpbWF0ZUhhc2hKb2luQ29zdCgKICAgIGNhcmRpbmFsaXRpZXM6IFtpMzI7IDVdLAogICAgcGFnZXM6IFtpMzI7IDVdLAogICAgbnVtX3RhYmxlczogaTMyLAogICAgcXVlcnlfaWQ6IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IG11dCBjb3N0OiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBudW1fdGFibGVzIC0gMSkgewogICAgICAgIGxldCB0YWJsZTE6IGkzMiA9IGkgJSA1OwogICAgICAgIGxldCB0YWJsZTI6IGkzMiA9IChpICsgMSkgJSA1OwogICAgICAgIGNvc3QgPSBjb3N0ICsgcGFnZXNbdGFibGUxIGFzIHVzaXplXSArIHBhZ2VzW3RhYmxlMiBhcyB1c2l6ZV07IC8vIFNjYW4gYm90aCB0YWJsZXMgb25jZQogICAgICAgIGNvc3QgPSBjb3N0ICsgKGNhcmRpbmFsaXRpZXNbdGFibGUxIGFzIHVzaXplXSAvIDEwKTsgLy8gSGFzaCB0YWJsZSBidWlsZCBjb3N0CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgY29zdCArIChxdWVyeV9pZCAqIDUwKSAvLyBIYXNoIGpvaW4gaXMgdHlwaWNhbGx5IG1vcmUgZWZmaWNpZW50Cn0KCmZuIGVzdGltYXRlU29ydE1lcmdlQ29zdCgKICAgIGNhcmRpbmFsaXRpZXM6IFtpMzI7IDVdLAogICAgcGFnZXM6IFtpMzI7IDVdLAogICAgbnVtX3RhYmxlczogaTMyLAogICAgcXVlcnlfaWQ6IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IG11dCBjb3N0OiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBudW1fdGFibGVzIC0gMSkgewogICAgICAgIGxldCB0YWJsZTE6IGkzMiA9IGkgJSA1OwogICAgICAgIGxldCB0YWJsZTI6IGkzMiA9IChpICsgMSkgJSA1OwogICAgICAgIC8vIFNvcnQgY29zdDogTyhuIGxvZyBuKQogICAgICAgIGxldCBzb3J0X2Nvc3QxOiBpMzIgPQogICAgICAgICAgICBjYXJkaW5hbGl0aWVzW3RhYmxlMSBhcyB1c2l6ZV0gKiBsb2dCYXNlMihjYXJkaW5hbGl0aWVzW3RhYmxlMSBhcyB1c2l6ZV0pOwogICAgICAgIGxldCBzb3J0X2Nvc3QyOiBpMzIgPQogICAgICAgICAgICBjYXJkaW5hbGl0aWVzW3RhYmxlMiBhcyB1c2l6ZV0gKiBsb2dCYXNlMihjYXJkaW5hbGl0aWVzW3RhYmxlMiBhcyB1c2l6ZV0pOwogICAgICAgIGNvc3QgPSBjb3N0ICsgc29ydF9jb3N0MSArIHNvcnRfY29zdDI7CiAgICAgICAgY29zdCA9IGNvc3QgKyBwYWdlc1t0YWJsZTEgYXMgdXNpemVdICsgcGFnZXNbdGFibGUyIGFzIHVzaXplXTsgLy8gU2NhbiBjb3N0CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgY29zdCArIChxdWVyeV9pZCAqIDc1KSAvLyBTb3J0LW1lcmdlIGhhcyBoaWdoIHNldHVwIGNvc3QKfQoKLy8gU2ltcGxlIGxvZyBiYXNlIDIgYXBwcm94aW1hdGlvbgpmbiBsb2dCYXNlMihuOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobiA8PSAxKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CiAgICBpZiAobiA8PSAyKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CiAgICBpZiAobiA8PSA0KSB7CiAgICAgICAgcmV0dXJuIDI7CiAgICB9CiAgICBpZiAobiA8PSA4KSB7CiAgICAgICAgcmV0dXJuIDM7CiAgICB9CiAgICBpZiAobiA8PSAxNikgewogICAgICAgIHJldHVybiA0OwogICAgfQogICAgaWYgKG4gPD0gMzIpIHsKICAgICAgICByZXR1cm4gNTsKICAgIH0KICAgIGlmIChuIDw9IDY0KSB7CiAgICAgICAgcmV0dXJuIDY7CiAgICB9CiAgICBpZiAobiA8PSAxMjgpIHsKICAgICAgICByZXR1cm4gNzsKICAgIH0KICAgIGlmIChuIDw9IDI1NikgewogICAgICAgIHJldHVybiA4OwogICAgfQogICAgcmV0dXJuIDk7Cn0KCi8vIEluZGV4IHNlbGVjdGlvbiBvcHRpbWl6YXRpb24KZm4gc2VsZWN0T3B0aW1hbEluZGV4KHNlbGVjdGl2aXRpZXM6IFtbaTMyOyAzXTsgNV0sIG51bV90YWJsZXM6IGkzMiwgcXVlcnlfaWQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgdG90YWxfaW5kZXhfY29zdDogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbnVtX3RhYmxlcykgewogICAgICAgIGxldCB0YWJsZV9pZHg6IGkzMiA9IGkgJSA1OwogICAgICAgIGxldCBwcmVkaWNhdGVfdHlwZTogaTMyID0gKHF1ZXJ5X2lkICsgaSkgJSAzOwoKICAgICAgICAvLyBDaG9vc2UgaW5kZXggYmFzZWQgb24gc2VsZWN0aXZpdHkKICAgICAgICBsZXQgc2VsZWN0aXZpdHk6IGkzMiA9IHNlbGVjdGl2aXRpZXNbdGFibGVfaWR4IGFzIHVzaXplXVtwcmVkaWNhdGVfdHlwZSBhcyB1c2l6ZV07CiAgICAgICAgaWYgKHNlbGVjdGl2aXR5IDwgMjApIHsKICAgICAgICAgICAgdG90YWxfaW5kZXhfY29zdCA9IHRvdGFsX2luZGV4X2Nvc3QgKyAxMDsgLy8gSGlnaCBzZWxlY3Rpdml0eSBpbmRleAogICAgICAgIH0gZWxzZSBpZiAoc2VsZWN0aXZpdHkgPCA0MCkgewogICAgICAgICAgICB0b3RhbF9pbmRleF9jb3N0ID0gdG90YWxfaW5kZXhfY29zdCArIDI1OyAvLyBNZWRpdW0gc2VsZWN0aXZpdHkgaW5kZXgKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0b3RhbF9pbmRleF9jb3N0ID0gdG90YWxfaW5kZXhfY29zdCArIDUwOyAvLyBMb3cgc2VsZWN0aXZpdHkgLSB0YWJsZSBzY2FuCiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHRvdGFsX2luZGV4X2Nvc3QKfQoKLy8gU2ltdWxhdGUgYWN0dWFsIHBsYW4gZXhlY3V0aW9uCmZuIHNpbXVsYXRlUGxhbkV4ZWN1dGlvbihwbGFuX3R5cGU6IGkzMiwgY2FyZGluYWxpdGllczogW2kzMjsgNV0sIG51bV90YWJsZXM6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgZXhlY3V0aW9uX2Nvc3Q6IGkzMiA9IDA7CgogICAgaWYgKHBsYW5fdHlwZSA9PSAwKSB7CiAgICAgICAgLy8gTmVzdGVkIGxvb3AgZXhlY3V0aW9uIHNpbXVsYXRpb24KICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBudW1fdGFibGVzIC0gMSkgewogICAgICAgICAgICBsZXQgb3V0ZXJfc2l6ZTogaTMyID0gY2FyZGluYWxpdGllc1tpIGFzIHVzaXplICUgNV07CiAgICAgICAgICAgIGxldCBpbm5lcl9zaXplOiBpMzIgPSBjYXJkaW5hbGl0aWVzWyhpIGFzIHVzaXplICsgMSkgJSA1XTsKICAgICAgICAgICAgZXhlY3V0aW9uX2Nvc3QgPSBleGVjdXRpb25fY29zdCArIChvdXRlcl9zaXplICogaW5uZXJfc2l6ZSkgLyAxMDA7CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICB9IGVsc2UgaWYgKHBsYW5fdHlwZSA9PSAxKSB7CiAgICAgICAgLy8gSGFzaCBqb2luIGV4ZWN1dGlvbiBzaW11bGF0aW9uCiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgbnVtX3RhYmxlcyAtIDEpIHsKICAgICAgICAgICAgbGV0IHRhYmxlMV9zaXplOiBpMzIgPSBjYXJkaW5hbGl0aWVzW2kgYXMgdXNpemUgJSA1XTsKICAgICAgICAgICAgbGV0IHRhYmxlMl9zaXplOiBpMzIgPSBjYXJkaW5hbGl0aWVzWyhpIGFzIHVzaXplICsgMSkgJSA1XTsKICAgICAgICAgICAgZXhlY3V0aW9uX2Nvc3QgPSBleGVjdXRpb25fY29zdCArIHRhYmxlMV9zaXplICsgdGFibGUyX3NpemUgKyAodGFibGUxX3NpemUgLyAxMCk7CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgIC8vIFNvcnQtbWVyZ2UgZXhlY3V0aW9uIHNpbXVsYXRpb24KICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCBudW1fdGFibGVzIC0gMSkgewogICAgICAgICAgICBsZXQgdGFibGUxX3NpemU6IGkzMiA9IGNhcmRpbmFsaXRpZXNbaSBhcyB1c2l6ZSAlIDVdOwogICAgICAgICAgICBsZXQgdGFibGUyX3NpemU6IGkzMiA9IGNhcmRpbmFsaXRpZXNbKGkgYXMgdXNpemUgKyAxKSAlIDVdOwogICAgICAgICAgICBleGVjdXRpb25fY29zdCA9IGV4ZWN1dGlvbl9jb3N0ICsgdGFibGUxX3NpemUgKiAyICsgdGFibGUyX3NpemUgKiAyOyAvLyBTb3J0IG92ZXJoZWFkCiAgICAgICAgICAgIGV4ZWN1dGlvbl9jb3N0ID0gZXhlY3V0aW9uX2Nvc3QgKyB0YWJsZTFfc2l6ZSArIHRhYmxlMl9zaXplOyAvLyBNZXJnZSBjb3N0CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICB9CgogICAgZXhlY3V0aW9uX2Nvc3QKfQoKLy8gQ2FsY3VsYXRlIGNvc3QgZXN0aW1hdGlvbiBhY2N1cmFjeQpmbiBjYWxjdWxhdGVDb3N0QWNjdXJhY3koZXN0aW1hdGVkX2Nvc3Q6IGkzMiwgYWN0dWFsX2Nvc3Q6IGkzMikgLT4gaTMyIHsKICAgIGxldCBkaWZmZXJlbmNlOiBpMzIgPSBpZiAoZXN0aW1hdGVkX2Nvc3QgPiBhY3R1YWxfY29zdCkgewogICAgICAgIGVzdGltYXRlZF9jb3N0IC0gYWN0dWFsX2Nvc3QKICAgIH0gZWxzZSB7CiAgICAgICAgYWN0dWFsX2Nvc3QgLSBlc3RpbWF0ZWRfY29zdAogICAgfTsKCiAgICBsZXQgYWNjdXJhY3k6IGkzMiA9IDEwMCAtICgoZGlmZmVyZW5jZSAqIDEwMCkgLyBhY3R1YWxfY29zdCk7CiAgICBpZiAoYWNjdXJhY3kgPCAwKSB7IDAgfSBlbHNlIHsgYWNjdXJhY3kgfQp9CgovLyBUZXN0IDY6IEFkdmFuY2VkIEhhc2ggVGFibGUgT3BlcmF0aW9ucwovLyBUZXN0cyBkeW5hbWljIHJlc2l6aW5nIGFuZCBjb2xsaXNpb24gcmVzb2x1dGlvbiBhbGdvcml0aG1zCmZuIHBlcmZvcm1IYXNoVGFibGVUZXN0KGluaXRpYWxfc2l6ZTogaTMyKSB7CiAgICBwcmludGxuSW50KDI2MDExKTsgLy8gU3RhcnQgaGFzaCB0YWJsZSB0ZXN0CgogICAgLy8gSGFzaCB0YWJsZSB3aXRoIGxpbmVhciBwcm9iaW5nCiAgICBsZXQgbXV0IGhhc2hfdGFibGU6IFtpMzI7IDUwMF0gPSBbLTE7IDUwMF07CiAgICBsZXQgbXV0IGhhc2hfdmFsdWVzOiBbaTMyOyA1MDBdID0gWzA7IDUwMF07CiAgICBsZXQgbXV0IGhhc2hfdGFibGVfc2l6ZTogaTMyID0gMTAwOwogICAgbGV0IG11dCBoYXNoX2VudHJ5X2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBjb2xsaXNpb25fY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHJlaGFzaF9jb3VudDogaTMyID0gMDsKCiAgICAvLyBIYXNoIHRhYmxlIHdpdGggY2hhaW5pbmcgKHVzaW5nIGFycmF5cyB0byBzaW11bGF0ZSBsaW5rZWQgbGlzdHMpCiAgICBsZXQgbXV0IGNoYWluX3RhYmxlOiBbW2kzMjsgOF07IDEwMF0gPSBbWy0xOyA4XTsgMTAwXTsKICAgIGxldCBtdXQgY2hhaW5fdmFsdWVzOiBbW2kzMjsgOF07IDEwMF0gPSBbWzA7IDhdOyAxMDBdOwogICAgbGV0IG11dCBjaGFpbl9sZW5ndGhzOiBbaTMyOyAxMDBdID0gWzA7IDEwMF07CiAgICBsZXQgbXV0IGNoYWluX3RhYmxlX3NpemU6IGkzMiA9IDEwMDsKCiAgICAvLyBUZXN0IDE6IExpbmVhciBwcm9iaW5nIGhhc2ggdGFibGUgb3BlcmF0aW9ucwogICAgbGV0IG11dCBpbnNlcnRfb3BlcmF0aW9uczogaTMyID0gMDsKICAgIGxldCBtdXQgc3VjY2Vzc2Z1bF9pbnNlcnRzOiBpMzIgPSAwOwoKICAgIHdoaWxlIChpbnNlcnRfb3BlcmF0aW9ucyA8IGluaXRpYWxfc2l6ZSAmJiBpbnNlcnRfb3BlcmF0aW9ucyA8IDQwMCkgewogICAgICAgIGxldCBrZXk6IGkzMiA9IChpbnNlcnRfb3BlcmF0aW9ucyAqIDE3ICsgMjMpICUgMjAwMCArIDE7CiAgICAgICAgbGV0IHZhbHVlOiBpMzIgPSAoaW5zZXJ0X29wZXJhdGlvbnMgKiAxMSArIDcpICUgMTAwMCArIDE7CgogICAgICAgIC8vIENoZWNrIGxvYWQgZmFjdG9yIGFuZCByZXNpemUgaWYgbmVjZXNzYXJ5CiAgICAgICAgbGV0IGxvYWRfZmFjdG9yOiBpMzIgPSAoaGFzaF9lbnRyeV9jb3VudCAqIDEwMCkgLyBoYXNoX3RhYmxlX3NpemU7CiAgICAgICAgaWYgKGxvYWRfZmFjdG9yID4gNzAgJiYgaGFzaF90YWJsZV9zaXplIDwgMjUwKSB7CiAgICAgICAgICAgIC8vIFJlaGFzaCB0byBsYXJnZXIgdGFibGUKICAgICAgICAgICAgbGV0IG9sZF9zaXplOiBpMzIgPSBoYXNoX3RhYmxlX3NpemU7CiAgICAgICAgICAgIGhhc2hfdGFibGVfc2l6ZSA9IGhhc2hfdGFibGVfc2l6ZSAqIDI7CiAgICAgICAgICAgIHJlaGFzaF9jb3VudCA9IHJlaGFzaF9jb3VudCArIDE7CgogICAgICAgICAgICAvLyBTYXZlIG9sZCBlbnRyaWVzCiAgICAgICAgICAgIGxldCBtdXQgb2xkX2tleXM6IFtpMzI7IDUwMF0gPSBbLTE7IDUwMF07CiAgICAgICAgICAgIGxldCBtdXQgb2xkX3ZhbHVlczogW2kzMjsgNTAwXSA9IFswOyA1MDBdOwogICAgICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChpIDwgb2xkX3NpemUpIHsKICAgICAgICAgICAgICAgIG9sZF9rZXlzW2kgYXMgdXNpemVdID0gaGFzaF90YWJsZVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIG9sZF92YWx1ZXNbaSBhcyB1c2l6ZV0gPSBoYXNoX3ZhbHVlc1tpIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGhhc2hfdGFibGVbaSBhcyB1c2l6ZV0gPSAtMTsKICAgICAgICAgICAgICAgIGhhc2hfdmFsdWVzW2kgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gQ2xlYXIgZXh0ZW5kZWQgcG9ydGlvbgogICAgICAgICAgICB3aGlsZSAoaSA8IGhhc2hfdGFibGVfc2l6ZSkgewogICAgICAgICAgICAgICAgaGFzaF90YWJsZVtpIGFzIHVzaXplXSA9IC0xOwogICAgICAgICAgICAgICAgaGFzaF92YWx1ZXNbaSBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBoYXNoX2VudHJ5X2NvdW50ID0gMDsKCiAgICAgICAgICAgIC8vIFJlaW5zZXJ0IG9sZCBlbnRyaWVzCiAgICAgICAgICAgIGkgPSAwOwogICAgICAgICAgICB3aGlsZSAoaSA8IG9sZF9zaXplKSB7CiAgICAgICAgICAgICAgICBpZiAob2xkX2tleXNbaSBhcyB1c2l6ZV0gIT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICBpbnNlcnRMaW5lYXJQcm9iaW5nKAogICAgICAgICAgICAgICAgICAgICAgICAmbXV0IGhhc2hfdGFibGUsCiAgICAgICAgICAgICAgICAgICAgICAgICZtdXQgaGFzaF92YWx1ZXMsCiAgICAgICAgICAgICAgICAgICAgICAgIGhhc2hfdGFibGVfc2l6ZSwKICAgICAgICAgICAgICAgICAgICAgICAgb2xkX2tleXNbaSBhcyB1c2l6ZV0sCiAgICAgICAgICAgICAgICAgICAgICAgIG9sZF92YWx1ZXNbaSBhcyB1c2l6ZV0sCiAgICAgICAgICAgICAgICAgICAgICAgICZtdXQgY29sbGlzaW9uX2NvdW50LAogICAgICAgICAgICAgICAgICAgICAgICBoYXNoX2VudHJ5X2NvdW50LAogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIEluc2VydCBuZXcgZW50cnkKICAgICAgICBsZXQgaW5zZXJ0X3N1Y2Nlc3M6IGJvb2wgPSBpbnNlcnRMaW5lYXJQcm9iaW5nKAogICAgICAgICAgICAmbXV0IGhhc2hfdGFibGUsCiAgICAgICAgICAgICZtdXQgaGFzaF92YWx1ZXMsCiAgICAgICAgICAgIGhhc2hfdGFibGVfc2l6ZSwKICAgICAgICAgICAga2V5LAogICAgICAgICAgICB2YWx1ZSwKICAgICAgICAgICAgJm11dCBjb2xsaXNpb25fY291bnQsCiAgICAgICAgICAgIGhhc2hfZW50cnlfY291bnQsCiAgICAgICAgKTsKICAgICAgICBpZiAoaW5zZXJ0X3N1Y2Nlc3MpIHsKICAgICAgICAgICAgc3VjY2Vzc2Z1bF9pbnNlcnRzID0gc3VjY2Vzc2Z1bF9pbnNlcnRzICsgMTsKICAgICAgICAgICAgaGFzaF9lbnRyeV9jb3VudCA9IGhhc2hfZW50cnlfY291bnQgKyAxOwogICAgICAgIH0KCiAgICAgICAgaW5zZXJ0X29wZXJhdGlvbnMgPSBpbnNlcnRfb3BlcmF0aW9ucyArIDE7CiAgICB9CgogICAgLy8gVGVzdCAyOiBDaGFpbmluZyBoYXNoIHRhYmxlIG9wZXJhdGlvbnMKICAgIGxldCBtdXQgY2hhaW5fb3BlcmF0aW9uczogaTMyID0gMDsKICAgIGxldCBtdXQgY2hhaW5fc3VjY2Vzc2Z1bF9pbnNlcnRzOiBpMzIgPSAwOwoKICAgIHdoaWxlIChjaGFpbl9vcGVyYXRpb25zIDwgaW5pdGlhbF9zaXplICYmIGNoYWluX29wZXJhdGlvbnMgPCAzMDApIHsKICAgICAgICBsZXQga2V5OiBpMzIgPSAoY2hhaW5fb3BlcmF0aW9ucyAqIDEzICsgMzEpICUgMTUwMCArIDE7CiAgICAgICAgbGV0IHZhbHVlOiBpMzIgPSAoY2hhaW5fb3BlcmF0aW9ucyAqIDE5ICsgNSkgJSA4MDAgKyAxOwoKICAgICAgICBsZXQgaGFzaF9pbmRleDogaTMyID0ga2V5ICUgY2hhaW5fdGFibGVfc2l6ZTsKCiAgICAgICAgLy8gQ2hlY2sgaWYga2V5IGFscmVhZHkgZXhpc3RzCiAgICAgICAgbGV0IG11dCBmb3VuZDogYm9vbCA9IGZhbHNlOwogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IGNoYWluX2xlbmd0aHNbaGFzaF9pbmRleCBhcyB1c2l6ZV0gJiYgaSA8IDgpIHsKICAgICAgICAgICAgaWYgKGNoYWluX3RhYmxlW2hhc2hfaW5kZXggYXMgdXNpemVdW2kgYXMgdXNpemVdID09IGtleSkgewogICAgICAgICAgICAgICAgY2hhaW5fdmFsdWVzW2hhc2hfaW5kZXggYXMgdXNpemVdW2kgYXMgdXNpemVdID0gdmFsdWU7IC8vIFVwZGF0ZQogICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KCiAgICAgICAgLy8gSW5zZXJ0IG5ldyBlbnRyeSBpZiBub3QgZm91bmQgYW5kIHNwYWNlIGF2YWlsYWJsZQogICAgICAgIGlmICghZm91bmQgJiYgY2hhaW5fbGVuZ3Roc1toYXNoX2luZGV4IGFzIHVzaXplXSA8IDgpIHsKICAgICAgICAgICAgY2hhaW5fdGFibGVbaGFzaF9pbmRleCBhcyB1c2l6ZV1bKGNoYWluX2xlbmd0aHNbaGFzaF9pbmRleCBhcyB1c2l6ZV0pIGFzIHVzaXplXSA9IGtleTsKICAgICAgICAgICAgY2hhaW5fdmFsdWVzW2hhc2hfaW5kZXggYXMgdXNpemVdWyhjaGFpbl9sZW5ndGhzW2hhc2hfaW5kZXggYXMgdXNpemVdKSBhcyB1c2l6ZV0gPQogICAgICAgICAgICAgICAgdmFsdWU7CiAgICAgICAgICAgIGNoYWluX2xlbmd0aHNbaGFzaF9pbmRleCBhcyB1c2l6ZV0gPSBjaGFpbl9sZW5ndGhzW2hhc2hfaW5kZXggYXMgdXNpemVdICsgMTsKICAgICAgICAgICAgY2hhaW5fc3VjY2Vzc2Z1bF9pbnNlcnRzID0gY2hhaW5fc3VjY2Vzc2Z1bF9pbnNlcnRzICsgMTsKICAgICAgICB9CgogICAgICAgIGNoYWluX29wZXJhdGlvbnMgPSBjaGFpbl9vcGVyYXRpb25zICsgMTsKICAgIH0KCiAgICAvLyBUZXN0IDM6IEhhc2ggdGFibGUgbG9va3VwIHBlcmZvcm1hbmNlCiAgICBsZXQgbXV0IGxpbmVhcl9sb29rdXBfc3VjY2VzczogaTMyID0gMDsKICAgIGxldCBtdXQgY2hhaW5fbG9va3VwX3N1Y2Nlc3M6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGxvb2t1cF9vcGVyYXRpb25zOiBpMzIgPSAwOwoKICAgIHdoaWxlIChsb29rdXBfb3BlcmF0aW9ucyA8IDEwMCkgewogICAgICAgIGxldCBzZWFyY2hfa2V5OiBpMzIgPSAobG9va3VwX29wZXJhdGlvbnMgKiAyMyArIDE3KSAlIDEwMDAgKyAxOwoKICAgICAgICAvLyBMaW5lYXIgcHJvYmluZyBsb29rdXAKICAgICAgICBsZXQgbGluZWFyX3Jlc3VsdDogaTMyID0gbG9va3VwTGluZWFyUHJvYmluZygmaGFzaF90YWJsZSwgaGFzaF90YWJsZV9zaXplLCBzZWFyY2hfa2V5KTsKICAgICAgICBpZiAobGluZWFyX3Jlc3VsdCA+PSAwKSB7CiAgICAgICAgICAgIGxpbmVhcl9sb29rdXBfc3VjY2VzcyA9IGxpbmVhcl9sb29rdXBfc3VjY2VzcyArIDE7CiAgICAgICAgfQoKICAgICAgICAvLyBDaGFpbmluZyBsb29rdXAKICAgICAgICBsZXQgY2hhaW5fcmVzdWx0OiBpMzIgPQogICAgICAgICAgICBsb29rdXBDaGFpbmluZygmY2hhaW5fdGFibGUsICZjaGFpbl9sZW5ndGhzLCBjaGFpbl90YWJsZV9zaXplLCBzZWFyY2hfa2V5KTsKICAgICAgICBpZiAoY2hhaW5fcmVzdWx0ID49IDApIHsKICAgICAgICAgICAgY2hhaW5fbG9va3VwX3N1Y2Nlc3MgPSBjaGFpbl9sb29rdXBfc3VjY2VzcyArIDE7CiAgICAgICAgfQoKICAgICAgICBsb29rdXBfb3BlcmF0aW9ucyA9IGxvb2t1cF9vcGVyYXRpb25zICsgMTsKICAgIH0KCiAgICAvLyBDYWxjdWxhdGUgc3RhdGlzdGljcwogICAgbGV0IGxpbmVhcl9sb2FkX2ZhY3RvcjogaTMyID0gKGhhc2hfZW50cnlfY291bnQgKiAxMDApIC8gaGFzaF90YWJsZV9zaXplOwogICAgbGV0IGF2Z19jaGFpbl9sZW5ndGg6IGkzMiA9IGNhbGN1bGF0ZUF2ZXJhZ2VDaGFpbkxlbmd0aCgmY2hhaW5fbGVuZ3RocywgY2hhaW5fdGFibGVfc2l6ZSk7CgogICAgcHJpbnRsbkludChzdWNjZXNzZnVsX2luc2VydHMpOwogICAgcHJpbnRsbkludChjaGFpbl9zdWNjZXNzZnVsX2luc2VydHMpOwogICAgcHJpbnRsbkludChjb2xsaXNpb25fY291bnQpOwogICAgcHJpbnRsbkludChsaW5lYXJfbG9va3VwX3N1Y2Nlc3MpOwogICAgcHJpbnRsbkludChjaGFpbl9sb29rdXBfc3VjY2Vzcyk7CiAgICBwcmludGxuSW50KGxpbmVhcl9sb2FkX2ZhY3Rvcik7CiAgICBwcmludGxuSW50KGF2Z19jaGFpbl9sZW5ndGgpOwogICAgcHJpbnRsbkludChyZWhhc2hfY291bnQpOwogICAgcHJpbnRsbkludCgyNjAxMik7IC8vIEVuZCBoYXNoIHRhYmxlIHRlc3QKfQoKLy8gTGluZWFyIHByb2JpbmcgaW5zZXJ0aW9uCmZuIGluc2VydExpbmVhclByb2JpbmcoCiAgICB0YWJsZTogJm11dCBbaTMyOyA1MDBdLAogICAgdmFsdWVzOiAmbXV0IFtpMzI7IDUwMF0sCiAgICB0YWJsZV9zaXplOiBpMzIsCiAgICBrZXk6IGkzMiwKICAgIHZhbHVlOiBpMzIsCiAgICBjb2xsaXNpb25fY291bnQ6ICZtdXQgaTMyLAogICAgZW50cnlfY291bnQ6IGkzMiwKKSAtPiBib29sIHsKICAgIGxldCBtdXQgaGFzaF9pbmRleDogaTMyID0ga2V5ICUgdGFibGVfc2l6ZTsKICAgIGxldCBtdXQgcHJvYmVfY291bnQ6IGkzMiA9IDA7CgogICAgd2hpbGUgKHByb2JlX2NvdW50IDwgdGFibGVfc2l6ZSkgewogICAgICAgIGlmICh0YWJsZVtoYXNoX2luZGV4IGFzIHVzaXplXSA9PSAtMSkgewogICAgICAgICAgICAvLyBFbXB0eSBzbG90IGZvdW5kCiAgICAgICAgICAgIHRhYmxlW2hhc2hfaW5kZXggYXMgdXNpemVdID0ga2V5OwogICAgICAgICAgICB2YWx1ZXNbaGFzaF9pbmRleCBhcyB1c2l6ZV0gPSB2YWx1ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIGlmICh0YWJsZVtoYXNoX2luZGV4IGFzIHVzaXplXSA9PSBrZXkpIHsKICAgICAgICAgICAgLy8gS2V5IGFscmVhZHkgZXhpc3RzLCB1cGRhdGUgdmFsdWUKICAgICAgICAgICAgdmFsdWVzW2hhc2hfaW5kZXggYXMgdXNpemVdID0gdmFsdWU7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIENvbGxpc2lvbiAtIHByb2JlIG5leHQgc2xvdAogICAgICAgICAgICAqY29sbGlzaW9uX2NvdW50ID0gKmNvbGxpc2lvbl9jb3VudCArIDE7CiAgICAgICAgICAgIGhhc2hfaW5kZXggPSAoaGFzaF9pbmRleCArIDEpICUgdGFibGVfc2l6ZTsKICAgICAgICAgICAgcHJvYmVfY291bnQgPSBwcm9iZV9jb3VudCArIDE7CiAgICAgICAgfQogICAgfQoKICAgIGZhbHNlIC8vIFRhYmxlIGZ1bGwKfQoKLy8gTGluZWFyIHByb2JpbmcgbG9va3VwCmZuIGxvb2t1cExpbmVhclByb2JpbmcodGFibGU6ICZbaTMyOyA1MDBdLCB0YWJsZV9zaXplOiBpMzIsIGtleTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBoYXNoX2luZGV4OiBpMzIgPSBrZXkgJSB0YWJsZV9zaXplOwogICAgbGV0IG11dCBwcm9iZV9jb3VudDogaTMyID0gMDsKCiAgICB3aGlsZSAocHJvYmVfY291bnQgPCB0YWJsZV9zaXplKSB7CiAgICAgICAgaWYgKHRhYmxlW2hhc2hfaW5kZXggYXMgdXNpemVdID09IGtleSkgewogICAgICAgICAgICByZXR1cm4gaGFzaF9pbmRleDsKICAgICAgICB9IGVsc2UgaWYgKHRhYmxlW2hhc2hfaW5kZXggYXMgdXNpemVdID09IC0xKSB7CiAgICAgICAgICAgIHJldHVybiAtMTsgLy8gS2V5IG5vdCBmb3VuZAogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGhhc2hfaW5kZXggPSAoaGFzaF9pbmRleCArIDEpICUgdGFibGVfc2l6ZTsKICAgICAgICAgICAgcHJvYmVfY291bnQgPSBwcm9iZV9jb3VudCArIDE7CiAgICAgICAgfQogICAgfQoKICAgIC0xIC8vIEtleSBub3QgZm91bmQKfQoKLy8gQ2hhaW5pbmcgbG9va3VwCmZuIGxvb2t1cENoYWluaW5nKHRhYmxlOiAmW1tpMzI7IDhdOyAxMDBdLCBsZW5ndGhzOiAmW2kzMjsgMTAwXSwgdGFibGVfc2l6ZTogaTMyLCBrZXk6IGkzMikgLT4gaTMyIHsKICAgIGxldCBoYXNoX2luZGV4OiBpMzIgPSBrZXkgJSB0YWJsZV9zaXplOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbGVuZ3Roc1toYXNoX2luZGV4IGFzIHVzaXplXSAmJiBpIDwgOCkgewogICAgICAgIGlmICh0YWJsZVtoYXNoX2luZGV4IGFzIHVzaXplXVtpIGFzIHVzaXplXSA9PSBrZXkpIHsKICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAtMSAvLyBLZXkgbm90IGZvdW5kCn0KCi8vIENhbGN1bGF0ZSBhdmVyYWdlIGNoYWluIGxlbmd0aApmbiBjYWxjdWxhdGVBdmVyYWdlQ2hhaW5MZW5ndGgobGVuZ3RoczogJltpMzI7IDEwMF0sIHRhYmxlX3NpemU6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgdG90YWxfbGVuZ3RoOiBpMzIgPSAwOwogICAgbGV0IG11dCBub25fZW1wdHlfY2hhaW5zOiBpMzIgPSAwOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgdGFibGVfc2l6ZSkgewogICAgICAgIGlmIChsZW5ndGhzW2kgYXMgdXNpemVdID4gMCkgewogICAgICAgICAgICB0b3RhbF9sZW5ndGggPSB0b3RhbF9sZW5ndGggKyBsZW5ndGhzW2kgYXMgdXNpemVdOwogICAgICAgICAgICBub25fZW1wdHlfY2hhaW5zID0gbm9uX2VtcHR5X2NoYWlucyArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBpZiAobm9uX2VtcHR5X2NoYWlucyA+IDApIHsKICAgICAgICB0b3RhbF9sZW5ndGggLyBub25fZW1wdHlfY2hhaW5zCiAgICB9IGVsc2UgewogICAgICAgIDAKICAgIH0KfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (27, "comprehensive27", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEFkdmFuY2VkIE11bHRpLUxheWVyIENhY2hlIFN5c3RlbSB3aXRoIE1lbW9yeSBNYW5hZ2VtZW50IFNpbXVsYXRpb24KU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6CkNvbXBsZXggbXVsdGktbGV2ZWwgZGF0YSBzdHJ1Y3R1cmUgbWFuYWdlbWVudCB3aXRoIGNhY2hlIGhpZXJhcmNoaWVzCkFkdmFuY2VkIG1lbW9yeSBhbGxvY2F0aW9uIHNpbXVsYXRpb24gYW5kIGdhcmJhZ2UgY29sbGVjdGlvbiBwYXR0ZXJucwpDb21wbGV4IGFyaXRobWV0aWMgb3BlcmF0aW9ucyBhbmQgYml0IG1hbmlwdWxhdGlvbiBmb3IgaGFzaCBjb21wdXRhdGlvbnMKRGVlcCByZWN1cnNpdmUgZnVuY3Rpb24gY2FsbHMgd2l0aCB0YWlsLWNhbGwgb3B0aW1pemF0aW9uIG9wcG9ydHVuaXRpZXMKTXVsdGktZGltZW5zaW9uYWwgYXJyYXkgYWNjZXNzIHBhdHRlcm5zIHdpdGggY2FjaGUgbG9jYWxpdHkgY29uc2lkZXJhdGlvbnMKQnJhbmNoIHByZWRpY3Rpb24gZm9yIGNvbXBsZXggY29uZGl0aW9uYWwgbG9naWMgaW4gY2FjaGUgaGl0L21pc3Mgc2NlbmFyaW9zCkxvb3Agb3B0aW1pemF0aW9uIGluIG1lbW9yeSBtYW5hZ2VtZW50IGFuZCBjYWNoZSByZXBsYWNlbWVudCBhbGdvcml0aG1zCkZ1bmN0aW9uIGNhbGwgb3ZlcmhlYWQgb3B0aW1pemF0aW9uIGZvciBmcmVxdWVudGx5IGNhbGxlZCB1dGlsaXR5IGZ1bmN0aW9ucwoqLwoKLy8gY29tcHJlaGVuc2l2ZTI3LnJ4IC0gQWR2YW5jZWQgTXVsdGktTGF5ZXIgQ2FjaGUgU3lzdGVtIHdpdGggTWVtb3J5IE1hbmFnZW1lbnQgU2ltdWxhdGlvbgovLyBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKLy8gLSBDb21wbGV4IG11bHRpLWxldmVsIGRhdGEgc3RydWN0dXJlIG1hbmFnZW1lbnQgd2l0aCBjYWNoZSBoaWVyYXJjaGllcwovLyAtIEFkdmFuY2VkIG1lbW9yeSBhbGxvY2F0aW9uIHNpbXVsYXRpb24gYW5kIGdhcmJhZ2UgY29sbGVjdGlvbiBwYXR0ZXJucwovLyAtIENvbXBsZXggYXJpdGhtZXRpYyBvcGVyYXRpb25zIGFuZCBiaXQgbWFuaXB1bGF0aW9uIGZvciBoYXNoIGNvbXB1dGF0aW9ucwovLyAtIERlZXAgcmVjdXJzaXZlIGZ1bmN0aW9uIGNhbGxzIHdpdGggdGFpbC1jYWxsIG9wdGltaXphdGlvbiBvcHBvcnR1bml0aWVzCi8vIC0gTXVsdGktZGltZW5zaW9uYWwgYXJyYXkgYWNjZXNzIHBhdHRlcm5zIHdpdGggY2FjaGUgbG9jYWxpdHkgY29uc2lkZXJhdGlvbnMKLy8gLSBCcmFuY2ggcHJlZGljdGlvbiBmb3IgY29tcGxleCBjb25kaXRpb25hbCBsb2dpYyBpbiBjYWNoZSBoaXQvbWlzcyBzY2VuYXJpb3MKLy8gLSBMb29wIG9wdGltaXphdGlvbiBpbiBtZW1vcnkgbWFuYWdlbWVudCBhbmQgY2FjaGUgcmVwbGFjZW1lbnQgYWxnb3JpdGhtcwovLyAtIEZ1bmN0aW9uIGNhbGwgb3ZlcmhlYWQgb3B0aW1pemF0aW9uIGZvciBmcmVxdWVudGx5IGNhbGxlZCB1dGlsaXR5IGZ1bmN0aW9ucwoKZm4gbWFpbigpIHsKICAgIC8vIEluaXRpYWxpemUgYSBjb21wcmVoZW5zaXZlIGNhY2hlIHN5c3RlbSBzaW11bGF0aW9uCiAgICAvLyBUaGlzIHNpbXVsYXRlcyBhIDMtbGV2ZWwgY2FjaGUgaGllcmFyY2h5IHdpdGggTFJVIHJlcGxhY2VtZW50IHBvbGljeQogICAgcHJpbnRsbkludCg0Mik7IC8vIEV4cGVjdGVkIG91dHB1dCBtYXJrZXIKCiAgICAvLyBUZXN0IHRoZSBjYWNoZSBzeXN0ZW0gd2l0aCB2YXJpb3VzIGFjY2VzcyBwYXR0ZXJucwogICAgbGV0IGNhY2hlX3BlcmZvcm1hbmNlOiBpMzIgPSBydW5fY2FjaGVfc2ltdWxhdGlvbigpOwogICAgcHJpbnRsbkludChjYWNoZV9wZXJmb3JtYW5jZSk7CgogICAgLy8gVGVzdCBtZW1vcnkgbWFuYWdlbWVudCBhbGdvcml0aG1zCiAgICBsZXQgbWVtb3J5X2VmZmljaWVuY3k6IGkzMiA9IHJ1bl9tZW1vcnlfbWFuYWdlcigpOwogICAgcHJpbnRsbkludChtZW1vcnlfZWZmaWNpZW5jeSk7CgogICAgLy8gVGVzdCBoYXNoIHRhYmxlIG9wZXJhdGlvbnMgd2l0aCBjb2xsaXNpb24gcmVzb2x1dGlvbgogICAgbGV0IGhhc2hfb3BlcmF0aW9uczogaTMyID0gcnVuX2hhc2hfdGFibGVfdGVzdHMoKTsKICAgIHByaW50bG5JbnQoaGFzaF9vcGVyYXRpb25zKTsKCiAgICAvLyBUZXN0IHByaW9yaXR5IHF1ZXVlIG9wZXJhdGlvbnMgZm9yIGNhY2hlIHJlcGxhY2VtZW50CiAgICBsZXQgcHJpb3JpdHlfcXVldWVfb3BzOiBpMzIgPSBydW5fcHJpb3JpdHlfcXVldWVfdGVzdHMoKTsKICAgIHByaW50bG5JbnQocHJpb3JpdHlfcXVldWVfb3BzKTsKCiAgICAvLyBSdW4gY29tcHJlaGVuc2l2ZSBzeXN0ZW0gaW50ZWdyYXRpb24gdGVzdAogICAgbGV0IGludGVncmF0aW9uX3Jlc3VsdDogaTMyID0gcnVuX2ludGVncmF0ZWRfc3lzdGVtX3Rlc3QoKTsKICAgIHByaW50bG5JbnQoaW50ZWdyYXRpb25fcmVzdWx0KTsKCiAgICBwcmludGxuSW50KDk5KTsgLy8gRW5kIG1hcmtlcgogICAgZXhpdCgwKTsKfQoKLy8gQ2FjaGUgc3lzdGVtIGNvbnN0YW50cwpmbiBnZXRfbDFfY2FjaGVfc2l6ZSgpIC0+IGkzMiB7CiAgICA2NAp9CmZuIGdldF9sMl9jYWNoZV9zaXplKCkgLT4gaTMyIHsKICAgIDUxMgp9CmZuIGdldF9sM19jYWNoZV9zaXplKCkgLT4gaTMyIHsKICAgIDIwNDgKfQpmbiBnZXRfY2FjaGVfbGluZV9zaXplKCkgLT4gaTMyIHsKICAgIDY0Cn0KZm4gZ2V0X2Fzc29jaWF0aXZpdHkoKSAtPiBpMzIgewogICAgNAp9CgovLyBNZW1vcnkgbWFuYWdlbWVudCBjb25zdGFudHMKZm4gZ2V0X3BhZ2Vfc2l6ZSgpIC0+IGkzMiB7CiAgICA0MDk2Cn0KZm4gZ2V0X2hlYXBfc2l6ZSgpIC0+IGkzMiB7CiAgICA2NTUzNgp9CmZuIGdldF9nY190aHJlc2hvbGQoKSAtPiBpMzIgewogICAgODAKfQoKLy8gSGFzaCB0YWJsZSBjb25maWd1cmF0aW9uCmZuIGdldF9oYXNoX3RhYmxlX3NpemUoKSAtPiBpMzIgewogICAgMTAyNAp9CmZuIGdldF9tYXhfcHJvYmVfZGlzdGFuY2UoKSAtPiBpMzIgewogICAgMTYKfQoKLy8gQWR2YW5jZWQgY2FjaGUgc2ltdWxhdGlvbiB3aXRoIExSVSByZXBsYWNlbWVudCBwb2xpY3kKZm4gcnVuX2NhY2hlX3NpbXVsYXRpb24oKSAtPiBpMzIgewogICAgbGV0IHRvdGFsX2FjY2Vzc2VzOiBpMzIgPSAxMDAwMDsKICAgIGxldCBtdXQgY2FjaGVfaGl0czogaTMyID0gMDsKICAgIGxldCBtdXQgY2FjaGVfbWlzc2VzOiBpMzIgPSAwOwoKICAgIC8vIFNpbXVsYXRlIEwxIGNhY2hlICg2NCBlbnRyaWVzLCA0LXdheSBhc3NvY2lhdGl2ZSkKICAgIGxldCBtdXQgbDFfY2FjaGU6IFtpMzI7IDI1Nl0gPSBbMDsgMjU2XTsgLy8gdGFnLCB2YWxpZCwgbHJ1X2NvdW50ZXIsIGRhdGEKICAgIGxldCBtdXQgbDFfbHJ1X2NvdW50ZXI6IGkzMiA9IDA7CgogICAgLy8gU2ltdWxhdGUgTDIgY2FjaGUgKDUxMiBlbnRyaWVzLCA4LXdheSBhc3NvY2lhdGl2ZSkKICAgIGxldCBtdXQgbDJfY2FjaGU6IFtpMzI7IDQwOTZdID0gWzA7IDQwOTZdOwogICAgbGV0IG11dCBsMl9scnVfY291bnRlcjogaTMyID0gMDsKCiAgICAvLyBTaW11bGF0ZSBtZW1vcnkgYWNjZXNzIHBhdHRlcm5zCiAgICBsZXQgbXV0IGFjY2Vzc19wYXR0ZXJuOiBpMzIgPSAwOwogICAgd2hpbGUgKGFjY2Vzc19wYXR0ZXJuIDwgdG90YWxfYWNjZXNzZXMpIHsKICAgICAgICBsZXQgYWRkcmVzczogaTMyID0gZ2VuZXJhdGVfbWVtb3J5X2FkZHJlc3MoYWNjZXNzX3BhdHRlcm4pOwogICAgICAgIGxldCBjYWNoZV9yZXN1bHQ6IGkzMiA9IHNpbXVsYXRlX2NhY2hlX2FjY2VzcyhhZGRyZXNzLCAmbXV0IGwxX2NhY2hlLCAmbXV0IGwyX2NhY2hlKTsKCiAgICAgICAgaWYgKGNhY2hlX3Jlc3VsdCA+IDApIHsKICAgICAgICAgICAgY2FjaGVfaGl0cyA9IGNhY2hlX2hpdHMgKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNhY2hlX21pc3NlcyA9IGNhY2hlX21pc3NlcyArIDE7CiAgICAgICAgICAgIC8vIFNpbXVsYXRlIGNhY2hlIGxpbmUgZmlsbAogICAgICAgICAgICBsZXQgZmlsbF9yZXN1bHQ6IGkzMiA9IHNpbXVsYXRlX2NhY2hlX2ZpbGwoYWRkcmVzcywgJm11dCBsMV9jYWNoZSwgJm11dCBsMl9jYWNoZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBVcGRhdGUgTFJVIGNvdW50ZXJzCiAgICAgICAgbDFfbHJ1X2NvdW50ZXIgPSB1cGRhdGVfbHJ1X2NvdW50ZXJzX2wxKCZsMV9jYWNoZSwgbDFfbHJ1X2NvdW50ZXIpOwogICAgICAgIGwyX2xydV9jb3VudGVyID0gdXBkYXRlX2xydV9jb3VudGVyc19sMigmbDJfY2FjaGUsIGwyX2xydV9jb3VudGVyKTsKCiAgICAgICAgYWNjZXNzX3BhdHRlcm4gPSBhY2Nlc3NfcGF0dGVybiArIDE7CiAgICB9CgogICAgLy8gQ2FsY3VsYXRlIGNhY2hlIGhpdCByYXRpbyAoc2NhbGVkIGJ5IDEwMDAgZm9yIGludGVnZXIgcHJlY2lzaW9uKQogICAgbGV0IGhpdF9yYXRpbzogaTMyID0gKGNhY2hlX2hpdHMgKiAxMDAwKSAvIHRvdGFsX2FjY2Vzc2VzOwogICAgcmV0dXJuIGhpdF9yYXRpbzsKfQoKLy8gR2VuZXJhdGUgY29tcGxleCBtZW1vcnkgYWNjZXNzIHBhdHRlcm5zIGZvciB0ZXN0aW5nCmZuIGdlbmVyYXRlX21lbW9yeV9hZGRyZXNzKHBhdHRlcm5faW5kZXg6IGkzMikgLT4gaTMyIHsKICAgIGxldCBiYXNlX2FkZHJlc3M6IGkzMiA9IDB4MTAwMDAwMDA7CiAgICBsZXQgcGF0dGVybl90eXBlOiBpMzIgPSBwYXR0ZXJuX2luZGV4ICUgNzsKCiAgICBpZiAocGF0dGVybl90eXBlID09IDApIHsKICAgICAgICAvLyBTZXF1ZW50aWFsIGFjY2VzcyBwYXR0ZXJuCiAgICAgICAgYmFzZV9hZGRyZXNzICsgKHBhdHRlcm5faW5kZXggKiA0KQogICAgfSBlbHNlIGlmIChwYXR0ZXJuX3R5cGUgPT0gMSkgewogICAgICAgIC8vIFN0cmlkZWQgYWNjZXNzIHBhdHRlcm4KICAgICAgICBiYXNlX2FkZHJlc3MgKyAoKHBhdHRlcm5faW5kZXggKiA2NCkgJSA4MTkyKQogICAgfSBlbHNlIGlmIChwYXR0ZXJuX3R5cGUgPT0gMikgewogICAgICAgIC8vIFJhbmRvbSBhY2Nlc3MgcGF0dGVybgogICAgICAgIGJhc2VfYWRkcmVzcyArIChoYXNoX2Z1bmN0aW9uKHBhdHRlcm5faW5kZXgpICUgMTYzODQpCiAgICB9IGVsc2UgaWYgKHBhdHRlcm5fdHlwZSA9PSAzKSB7CiAgICAgICAgLy8gVGVtcG9yYWwgbG9jYWxpdHkgcGF0dGVybgogICAgICAgIGxldCBob3Rfc2V0X3NpemU6IGkzMiA9IDEyODsKICAgICAgICBiYXNlX2FkZHJlc3MgKyAoKHBhdHRlcm5faW5kZXggJSBob3Rfc2V0X3NpemUpICogNCkKICAgIH0gZWxzZSBpZiAocGF0dGVybl90eXBlID09IDQpIHsKICAgICAgICAvLyBTcGF0aWFsIGxvY2FsaXR5IHBhdHRlcm4KICAgICAgICBsZXQgYmxvY2tfc2l6ZTogaTMyID0gNjQ7CiAgICAgICAgbGV0IGJsb2NrX2lkOiBpMzIgPSBwYXR0ZXJuX2luZGV4IC8gYmxvY2tfc2l6ZTsKICAgICAgICBsZXQgb2Zmc2V0OiBpMzIgPSBwYXR0ZXJuX2luZGV4ICUgYmxvY2tfc2l6ZTsKICAgICAgICBiYXNlX2FkZHJlc3MgKyAoYmxvY2tfaWQgKiA0MDk2KSArIChvZmZzZXQgKiA0KQogICAgfSBlbHNlIGlmIChwYXR0ZXJuX3R5cGUgPT0gNSkgewogICAgICAgIC8vIFBvd2VyLW9mLTIgc3RyaWRlIHBhdHRlcm4KICAgICAgICBsZXQgbXV0IHN0cmlkZTogaTMyID0gMTsKICAgICAgICBsZXQgbXV0IHRlbXA6IGkzMiA9IHBhdHRlcm5faW5kZXg7CiAgICAgICAgd2hpbGUgKHRlbXAgPiAwKSB7CiAgICAgICAgICAgIHN0cmlkZSA9IHN0cmlkZSAqIDI7CiAgICAgICAgICAgIHRlbXAgPSB0ZW1wIC8gMjsKICAgICAgICB9CiAgICAgICAgYmFzZV9hZGRyZXNzICsgKChwYXR0ZXJuX2luZGV4ICogc3RyaWRlKSAlIDMyNzY4KQogICAgfSBlbHNlIHsKICAgICAgICAvLyBNaXhlZCBwYXR0ZXJuIHdpdGggYWxpYXNpbmcKICAgICAgICBiYXNlX2FkZHJlc3MgKyAoKHBhdHRlcm5faW5kZXggKiAxNyArIHBhdHRlcm5faW5kZXggKiBwYXR0ZXJuX2luZGV4KSAlIDY1NTM2KQogICAgfQp9CgovLyBDb21wbGV4IGhhc2ggZnVuY3Rpb24gZm9yIGFkZHJlc3MgZ2VuZXJhdGlvbgpmbiBoYXNoX2Z1bmN0aW9uKGtleTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBoYXNoOiBpMzIgPSBrZXk7CiAgICBoYXNoID0gKGhhc2ggXiAoaGFzaCA+PiAxNikpICUgMzI3Njg7CiAgICBoYXNoID0gaGFzaCAqIDB4OWYzYjsKICAgIGhhc2ggPSAoaGFzaCBeIChoYXNoID4+IDE2KSkgJSAzMjc2ODsKICAgIGhhc2ggPSBoYXNoICogMHg1MzNmOwogICAgaGFzaCA9IGhhc2ggXiAoaGFzaCA+PiAxNik7CiAgICByZXR1cm4gaGFzaDsKfQoKLy8gU2ltdWxhdGUgY2FjaGUgYWNjZXNzIHdpdGggY29tcGxleCBhc3NvY2lhdGl2ZSBsb29rdXAKZm4gc2ltdWxhdGVfY2FjaGVfYWNjZXNzKAogICAgYWRkcmVzczogaTMyLAogICAgbDFfY2FjaGU6ICZtdXQgW2kzMjsgMjU2XSwKICAgIGwyX2NhY2hlOiAmbXV0IFtpMzI7IDQwOTZdLAopIC0+IGkzMiB7CiAgICAvLyBMMSBDYWNoZSBsb29rdXAgKDQtd2F5IGFzc29jaWF0aXZlKQogICAgbGV0IGwxX2luZGV4OiBpMzIgPSAoYWRkcmVzcyAvIGdldF9jYWNoZV9saW5lX3NpemUoKSkgJSAxNjsKICAgIGxldCBsMV90YWc6IGkzMiA9IGFkZHJlc3MgLyAoZ2V0X2NhY2hlX2xpbmVfc2l6ZSgpICogMTYpOwoKICAgIGxldCBtdXQgd2F5OiBpMzIgPSAwOwogICAgd2hpbGUgKHdheSA8IGdldF9hc3NvY2lhdGl2aXR5KCkpIHsKICAgICAgICBsZXQgY2FjaGVfZW50cnlfYmFzZTogaTMyID0gKGwxX2luZGV4ICogZ2V0X2Fzc29jaWF0aXZpdHkoKSArIHdheSkgKiA0OwogICAgICAgIGxldCBzdG9yZWRfdGFnOiBpMzIgPSBsMV9jYWNoZVtjYWNoZV9lbnRyeV9iYXNlIGFzIHVzaXplXTsKICAgICAgICBsZXQgdmFsaWRfYml0OiBpMzIgPSBsMV9jYWNoZVtjYWNoZV9lbnRyeV9iYXNlIGFzIHVzaXplICsgMV07CgogICAgICAgIGlmICgodmFsaWRfYml0ID09IDEpICYmIChzdG9yZWRfdGFnID09IGwxX3RhZykpIHsKICAgICAgICAgICAgLy8gTDEgY2FjaGUgaGl0CiAgICAgICAgICAgIGwxX2NhY2hlW2NhY2hlX2VudHJ5X2Jhc2UgYXMgdXNpemUgKyAyXSA9IGdldF9jdXJyZW50X3RpbWVzdGFtcCgpOyAvLyBVcGRhdGUgTFJVCiAgICAgICAgICAgIHJldHVybiAxOyAvLyBMMSBoaXQKICAgICAgICB9CiAgICAgICAgd2F5ID0gd2F5ICsgMTsKICAgIH0KCiAgICAvLyBMMiBDYWNoZSBsb29rdXAgKDgtd2F5IGFzc29jaWF0aXZlKQogICAgbGV0IGwyX2luZGV4OiBpMzIgPSAoYWRkcmVzcyAvIGdldF9jYWNoZV9saW5lX3NpemUoKSkgJSA2NDsKICAgIGxldCBsMl90YWc6IGkzMiA9IGFkZHJlc3MgLyAoZ2V0X2NhY2hlX2xpbmVfc2l6ZSgpICogNjQpOwoKICAgIHdheSA9IDA7CiAgICB3aGlsZSAod2F5IDwgOCkgewogICAgICAgIGxldCBjYWNoZV9lbnRyeV9iYXNlOiBpMzIgPSAobDJfaW5kZXggKiA4ICsgd2F5KSAqIDQ7CiAgICAgICAgbGV0IHN0b3JlZF90YWc6IGkzMiA9IGwyX2NhY2hlW2NhY2hlX2VudHJ5X2Jhc2UgYXMgdXNpemVdOwogICAgICAgIGxldCB2YWxpZF9iaXQ6IGkzMiA9IGwyX2NhY2hlW2NhY2hlX2VudHJ5X2Jhc2UgYXMgdXNpemUgKyAxXTsKCiAgICAgICAgaWYgKCh2YWxpZF9iaXQgPT0gMSkgJiYgKHN0b3JlZF90YWcgPT0gbDJfdGFnKSkgewogICAgICAgICAgICAvLyBMMiBjYWNoZSBoaXQKICAgICAgICAgICAgbDJfY2FjaGVbY2FjaGVfZW50cnlfYmFzZSBhcyB1c2l6ZSArIDJdID0gZ2V0X2N1cnJlbnRfdGltZXN0YW1wKCk7IC8vIFVwZGF0ZSBMUlUKICAgICAgICAgICAgcmV0dXJuIDI7IC8vIEwyIGhpdAogICAgICAgIH0KICAgICAgICB3YXkgPSB3YXkgKyAxOwogICAgfQoKICAgIHJldHVybiAwOyAvLyBDYWNoZSBtaXNzCn0KCi8vIFNpbXVsYXRlIGNhY2hlIGxpbmUgZmlsbCB3aXRoIExSVSByZXBsYWNlbWVudApmbiBzaW11bGF0ZV9jYWNoZV9maWxsKGFkZHJlc3M6IGkzMiwgbDFfY2FjaGU6ICZtdXQgW2kzMjsgMjU2XSwgbDJfY2FjaGU6ICZtdXQgW2kzMjsgNDA5Nl0pIC0+IGkzMiB7CiAgICAvLyBGaWxsIEwxIGNhY2hlCiAgICBsZXQgbDFfaW5kZXg6IGkzMiA9IChhZGRyZXNzIC8gZ2V0X2NhY2hlX2xpbmVfc2l6ZSgpKSAlIDE2OwogICAgbGV0IGwxX3RhZzogaTMyID0gYWRkcmVzcyAvIChnZXRfY2FjaGVfbGluZV9zaXplKCkgKiAxNik7CgogICAgLy8gRmluZCBMUlUgd2F5IGluIEwxCiAgICBsZXQgbHJ1X3dheTogaTMyID0gZmluZF9scnVfd2F5X2wxKGwxX2NhY2hlLCBsMV9pbmRleCk7CiAgICBsZXQgY2FjaGVfZW50cnlfYmFzZTogaTMyID0gKGwxX2luZGV4ICogZ2V0X2Fzc29jaWF0aXZpdHkoKSArIGxydV93YXkpICogNDsKCiAgICBsMV9jYWNoZVtjYWNoZV9lbnRyeV9iYXNlIGFzIHVzaXplXSA9IGwxX3RhZzsKICAgIGwxX2NhY2hlW2NhY2hlX2VudHJ5X2Jhc2UgYXMgdXNpemUgKyAxXSA9IDE7IC8vIFNldCB2YWxpZAogICAgbDFfY2FjaGVbY2FjaGVfZW50cnlfYmFzZSBhcyB1c2l6ZSArIDJdID0gZ2V0X2N1cnJlbnRfdGltZXN0YW1wKCk7IC8vIFNldCBMUlUgdGltZXN0YW1wCiAgICBsMV9jYWNoZVtjYWNoZV9lbnRyeV9iYXNlIGFzIHVzaXplICsgM10gPSBzaW11bGF0ZV9tZW1vcnlfcmVhZChhZGRyZXNzKTsgLy8gTG9hZCBkYXRhCgogICAgLy8gRmlsbCBMMiBjYWNoZQogICAgbGV0IGwyX2luZGV4OiBpMzIgPSAoYWRkcmVzcyAvIGdldF9jYWNoZV9saW5lX3NpemUoKSkgJSA2NDsKICAgIGxldCBsMl90YWc6IGkzMiA9IGFkZHJlc3MgLyAoZ2V0X2NhY2hlX2xpbmVfc2l6ZSgpICogNjQpOwoKICAgIGxldCBsMl9scnVfd2F5OiBpMzIgPSBmaW5kX2xydV93YXlfbDIobDJfY2FjaGUsIGwyX2luZGV4KTsKICAgIGxldCBsMl9lbnRyeV9iYXNlOiBpMzIgPSAobDJfaW5kZXggKiA4ICsgbDJfbHJ1X3dheSkgKiA0OwoKICAgIGwyX2NhY2hlW2wyX2VudHJ5X2Jhc2UgYXMgdXNpemVdID0gbDJfdGFnOwogICAgbDJfY2FjaGVbbDJfZW50cnlfYmFzZSBhcyB1c2l6ZSArIDFdID0gMTsgLy8gU2V0IHZhbGlkCiAgICBsMl9jYWNoZVtsMl9lbnRyeV9iYXNlIGFzIHVzaXplICsgMl0gPSBnZXRfY3VycmVudF90aW1lc3RhbXAoKTsgLy8gU2V0IExSVSB0aW1lc3RhbXAKICAgIGwyX2NhY2hlW2wyX2VudHJ5X2Jhc2UgYXMgdXNpemUgKyAzXSA9IHNpbXVsYXRlX21lbW9yeV9yZWFkKGFkZHJlc3MpOyAvLyBMb2FkIGRhdGEKCiAgICByZXR1cm4gMTsKfQoKLy8gRmluZCBMUlUgd2F5IGluIEwxIGNhY2hlIHNldApmbiBmaW5kX2xydV93YXlfbDEobDFfY2FjaGU6ICZbaTMyOyAyNTZdLCBzZXRfaW5kZXg6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgb2xkZXN0X3RpbWVzdGFtcDogaTMyID0gMjE0NzQ4MzY0NzsgLy8gTWF4IGludAogICAgbGV0IG11dCBscnVfd2F5OiBpMzIgPSAwOwoKICAgIGxldCBtdXQgd2F5OiBpMzIgPSAwOwogICAgd2hpbGUgKHdheSA8IGdldF9hc3NvY2lhdGl2aXR5KCkpIHsKICAgICAgICBsZXQgY2FjaGVfZW50cnlfYmFzZTogaTMyID0gKHNldF9pbmRleCAqIGdldF9hc3NvY2lhdGl2aXR5KCkgKyB3YXkpICogNDsKICAgICAgICBsZXQgdGltZXN0YW1wOiBpMzIgPSBsMV9jYWNoZVtjYWNoZV9lbnRyeV9iYXNlIGFzIHVzaXplICsgMl07CiAgICAgICAgbGV0IHZhbGlkOiBpMzIgPSBsMV9jYWNoZVtjYWNoZV9lbnRyeV9iYXNlIGFzIHVzaXplICsgMV07CgogICAgICAgIGlmICh2YWxpZCA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiB3YXk7IC8vIEZvdW5kIGludmFsaWQgZW50cnkKICAgICAgICB9CgogICAgICAgIGlmICh0aW1lc3RhbXAgPCBvbGRlc3RfdGltZXN0YW1wKSB7CiAgICAgICAgICAgIG9sZGVzdF90aW1lc3RhbXAgPSB0aW1lc3RhbXA7CiAgICAgICAgICAgIGxydV93YXkgPSB3YXk7CiAgICAgICAgfQogICAgICAgIHdheSA9IHdheSArIDE7CiAgICB9CgogICAgcmV0dXJuIGxydV93YXk7Cn0KCi8vIEZpbmQgTFJVIHdheSBpbiBMMiBjYWNoZSBzZXQKZm4gZmluZF9scnVfd2F5X2wyKGwyX2NhY2hlOiAmW2kzMjsgNDA5Nl0sIHNldF9pbmRleDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBvbGRlc3RfdGltZXN0YW1wOiBpMzIgPSAyMTQ3NDgzNjQ3OyAvLyBNYXggaW50CiAgICBsZXQgbXV0IGxydV93YXk6IGkzMiA9IDA7CgogICAgbGV0IG11dCB3YXk6IGkzMiA9IDA7CiAgICB3aGlsZSAod2F5IDwgOCkgewogICAgICAgIGxldCBjYWNoZV9lbnRyeV9iYXNlOiBpMzIgPSAoc2V0X2luZGV4ICogOCArIHdheSkgKiA0OwogICAgICAgIGxldCB0aW1lc3RhbXA6IGkzMiA9IGwyX2NhY2hlW2NhY2hlX2VudHJ5X2Jhc2UgYXMgdXNpemUgKyAyXTsKICAgICAgICBsZXQgdmFsaWQ6IGkzMiA9IGwyX2NhY2hlW2NhY2hlX2VudHJ5X2Jhc2UgYXMgdXNpemUgKyAxXTsKCiAgICAgICAgaWYgKHZhbGlkID09IDApIHsKICAgICAgICAgICAgcmV0dXJuIHdheTsgLy8gRm91bmQgaW52YWxpZCBlbnRyeQogICAgICAgIH0KCiAgICAgICAgaWYgKHRpbWVzdGFtcCA8IG9sZGVzdF90aW1lc3RhbXApIHsKICAgICAgICAgICAgb2xkZXN0X3RpbWVzdGFtcCA9IHRpbWVzdGFtcDsKICAgICAgICAgICAgbHJ1X3dheSA9IHdheTsKICAgICAgICB9CiAgICAgICAgd2F5ID0gd2F5ICsgMTsKICAgIH0KCiAgICByZXR1cm4gbHJ1X3dheTsKfQoKLy8gVXBkYXRlIExSVSBjb3VudGVycyBmb3IgTDEgY2FjaGUKZm4gdXBkYXRlX2xydV9jb3VudGVyc19sMShsMV9jYWNoZTogJltpMzI7IDI1Nl0sIGN1cnJlbnRfY291bnRlcjogaTMyKSAtPiBpMzIgewogICAgcmV0dXJuIGN1cnJlbnRfY291bnRlciArIDE7Cn0KCi8vIFVwZGF0ZSBMUlUgY291bnRlcnMgZm9yIEwyIGNhY2hlCmZuIHVwZGF0ZV9scnVfY291bnRlcnNfbDIobDJfY2FjaGU6ICZbaTMyOyA0MDk2XSwgY3VycmVudF9jb3VudGVyOiBpMzIpIC0+IGkzMiB7CiAgICByZXR1cm4gY3VycmVudF9jb3VudGVyICsgMTsKfQoKLy8gR2V0IGN1cnJlbnQgdGltZXN0YW1wIGZvciBMUlUgdHJhY2tpbmcKZm4gZ2V0X2N1cnJlbnRfdGltZXN0YW1wKCkgLT4gaTMyIHsKICAgIC8vIFNpbXBsaWZpZWQgdGltZXN0YW1wIC0gaW4gcmVhbCBzeXN0ZW0gdGhpcyB3b3VsZCBiZSBjeWNsZSBjb3VudGVyCiAgICByZXR1cm4gaGFzaF9mdW5jdGlvbig0MikgJSAxMDAwMDAwOwp9CgovLyBTaW11bGF0ZSBtZW1vcnkgcmVhZCBvcGVyYXRpb24KZm4gc2ltdWxhdGVfbWVtb3J5X3JlYWQoYWRkcmVzczogaTMyKSAtPiBpMzIgewogICAgLy8gU2ltdWxhdGUgbWVtb3J5IGxhdGVuY3kgYW5kIHJldHVybiBkYXRhCiAgICBsZXQgZGF0YTogaTMyID0gYWRkcmVzcyAlIDY1NTM2OwogICAgcmV0dXJuIGhhc2hfZnVuY3Rpb24oZGF0YSk7Cn0KCi8vIEFkdmFuY2VkIG1lbW9yeSBtYW5hZ2VtZW50IHNpbXVsYXRpb24KZm4gcnVuX21lbW9yeV9tYW5hZ2VyKCkgLT4gaTMyIHsKICAgIGxldCB0b3RhbF9hbGxvY2F0aW9uczogaTMyID0gMTA7CiAgICBsZXQgYWxsb2NhdGlvbl9zaXplczogW2kzMjsgMTZdID0gWwogICAgICAgIDgsIDE2LCAzMiwgNjQsIDEyOCwgMjU2LCA1MTIsIDEwMjQsIDIwNDgsIDQwOTYsIDgxOTIsIDE2Mzg0LCAzMjc2OCwgNjU1MzYsIDEzMTA3MiwgMjYyMTQ0LAogICAgXTsKCiAgICAvLyBTaW11bGF0ZSBoZWFwIHdpdGggZnJlZSBibG9jayBtYW5hZ2VtZW50CiAgICBsZXQgbXV0IGhlYXA6IFtpMzI7IDE2Mzg0XSA9IFswOyAxNjM4NF07IC8vIFNpbXBsaWZpZWQgaGVhcCByZXByZXNlbnRhdGlvbgogICAgbGV0IG11dCBmcmVlX2Jsb2NrczogW2kzMjsgNDA5Nl0gPSBbMDsgNDA5Nl07IC8vIEZyZWUgYmxvY2sgbGlzdAogICAgbGV0IG11dCBhbGxvY2F0ZWRfYmxvY2tzOiBbaTMyOyA0MDk2XSA9IFswOyA0MDk2XTsgLy8gQWxsb2NhdGVkIGJsb2NrIGxpc3QKICAgIGxldCBtdXQgZnJlZV9jb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgYWxsb2NhdGVkX2NvdW50OiBpMzIgPSAwOwoKICAgIC8vIEluaXRpYWxpemUgZnJlZSBibG9jayBsaXN0IHdpdGggZW50aXJlIGhlYXAKICAgIGZyZWVfYmxvY2tzWzBdID0gMDsgLy8gU3RhcnQgYWRkcmVzcwogICAgZnJlZV9ibG9ja3NbMV0gPSA2NTUzNjsgLy8gU2l6ZSBpbiBieXRlcywgMTYzODQgKiA0CiAgICBmcmVlX2NvdW50ID0gMTsKCiAgICBsZXQgbXV0IGFsbG9jYXRpb25faW5kZXg6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHN1Y2Nlc3NmdWxfYWxsb2NhdGlvbnM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGZhaWxlZF9hbGxvY2F0aW9uczogaTMyID0gMDsKICAgIGxldCBtdXQgZ2FyYmFnZV9jb2xsZWN0aW9uczogaTMyID0gMDsKCiAgICB3aGlsZSAoYWxsb2NhdGlvbl9pbmRleCA8IHRvdGFsX2FsbG9jYXRpb25zKSB7CiAgICAgICAgbGV0IHNpemVfaW5kZXg6IGkzMiA9IGFsbG9jYXRpb25faW5kZXggJSAxNjsKICAgICAgICBsZXQgYWxsb2NhdGlvbl9zaXplOiBpMzIgPSBhbGxvY2F0aW9uX3NpemVzW3NpemVfaW5kZXggYXMgdXNpemVdOwoKICAgICAgICAvLyBUcnkgdG8gYWxsb2NhdGUgbWVtb3J5CiAgICAgICAgbGV0IG11dCBhbGxvY2F0ZWRfYWRkcmVzczogaTMyID0gYWxsb2NhdGVfbWVtb3J5KAogICAgICAgICAgICAmaGVhcCwKICAgICAgICAgICAgJm11dCBmcmVlX2Jsb2NrcywKICAgICAgICAgICAgJm11dCBhbGxvY2F0ZWRfYmxvY2tzLAogICAgICAgICAgICBmcmVlX2NvdW50LAogICAgICAgICAgICBhbGxvY2F0ZWRfY291bnQsCiAgICAgICAgICAgIGFsbG9jYXRpb25fc2l6ZSwKICAgICAgICApOwoKICAgICAgICBpZiAoYWxsb2NhdGVkX2FkZHJlc3MgPj0gMCkgewogICAgICAgICAgICBzdWNjZXNzZnVsX2FsbG9jYXRpb25zID0gc3VjY2Vzc2Z1bF9hbGxvY2F0aW9ucyArIDE7CiAgICAgICAgICAgIGFsbG9jYXRlZF9jb3VudCA9IGFsbG9jYXRlZF9jb3VudCArIDE7CgogICAgICAgICAgICAvLyBTaW11bGF0ZSBtZW1vcnkgdXNhZ2UKICAgICAgICAgICAgbGV0IHVzYWdlX3BhdHRlcm46IGkzMiA9IHNpbXVsYXRlX21lbW9yeV91c2FnZShhbGxvY2F0ZWRfYWRkcmVzcywgYWxsb2NhdGlvbl9zaXplKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBUcnkgZ2FyYmFnZSBjb2xsZWN0aW9uCiAgICAgICAgICAgIGxldCBnY19yZXN1bHQ6IGkzMiA9IHJ1bl9nYXJiYWdlX2NvbGxlY3Rpb24oCiAgICAgICAgICAgICAgICAmaGVhcCwKICAgICAgICAgICAgICAgICZtdXQgZnJlZV9ibG9ja3MsCiAgICAgICAgICAgICAgICAmbXV0IGFsbG9jYXRlZF9ibG9ja3MsCiAgICAgICAgICAgICAgICBmcmVlX2NvdW50LAogICAgICAgICAgICAgICAgYWxsb2NhdGVkX2NvdW50LAogICAgICAgICAgICApOwogICAgICAgICAgICBnYXJiYWdlX2NvbGxlY3Rpb25zID0gZ2FyYmFnZV9jb2xsZWN0aW9ucyArIDE7CgogICAgICAgICAgICBpZiAoZ2NfcmVzdWx0ID4gMCkgewogICAgICAgICAgICAgICAgLy8gUmV0cnkgYWxsb2NhdGlvbiBhZnRlciBHQwogICAgICAgICAgICAgICAgYWxsb2NhdGVkX2FkZHJlc3MgPSBhbGxvY2F0ZV9tZW1vcnkoCiAgICAgICAgICAgICAgICAgICAgJmhlYXAsCiAgICAgICAgICAgICAgICAgICAgJm11dCBmcmVlX2Jsb2NrcywKICAgICAgICAgICAgICAgICAgICAmbXV0IGFsbG9jYXRlZF9ibG9ja3MsCiAgICAgICAgICAgICAgICAgICAgZnJlZV9jb3VudCwKICAgICAgICAgICAgICAgICAgICBhbGxvY2F0ZWRfY291bnQsCiAgICAgICAgICAgICAgICAgICAgYWxsb2NhdGlvbl9zaXplLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGlmIChhbGxvY2F0ZWRfYWRkcmVzcyA+PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgc3VjY2Vzc2Z1bF9hbGxvY2F0aW9ucyA9IHN1Y2Nlc3NmdWxfYWxsb2NhdGlvbnMgKyAxOwogICAgICAgICAgICAgICAgICAgIGFsbG9jYXRlZF9jb3VudCA9IGFsbG9jYXRlZF9jb3VudCArIDE7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGZhaWxlZF9hbGxvY2F0aW9ucyA9IGZhaWxlZF9hbGxvY2F0aW9ucyArIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBmYWlsZWRfYWxsb2NhdGlvbnMgPSBmYWlsZWRfYWxsb2NhdGlvbnMgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBSYW5kb21seSBmcmVlIHNvbWUgYWxsb2NhdGVkIGJsb2NrcwogICAgICAgIGlmICgoYWxsb2NhdGlvbl9pbmRleCAlIDEwID09IDcpICYmIChhbGxvY2F0ZWRfY291bnQgPiAwKSkgewogICAgICAgICAgICBsZXQgZnJlZV9yZXN1bHQ6IGkzMiA9IGZyZWVfcmFuZG9tX2Jsb2NrKAogICAgICAgICAgICAgICAgJmhlYXAsCiAgICAgICAgICAgICAgICAmbXV0IGZyZWVfYmxvY2tzLAogICAgICAgICAgICAgICAgJm11dCBhbGxvY2F0ZWRfYmxvY2tzLAogICAgICAgICAgICAgICAgZnJlZV9jb3VudCwKICAgICAgICAgICAgICAgIGFsbG9jYXRlZF9jb3VudCwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKGZyZWVfcmVzdWx0ID4gMCkgewogICAgICAgICAgICAgICAgYWxsb2NhdGVkX2NvdW50ID0gYWxsb2NhdGVkX2NvdW50IC0gMTsKICAgICAgICAgICAgICAgIGZyZWVfY291bnQgPSBmcmVlX2NvdW50ICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgYWxsb2NhdGlvbl9pbmRleCA9IGFsbG9jYXRpb25faW5kZXggKyAxOwogICAgfQoKICAgIC8vIENhbGN1bGF0ZSBtZW1vcnkgbWFuYWdlbWVudCBlZmZpY2llbmN5CiAgICBsZXQgZWZmaWNpZW5jeTogaTMyID0KICAgICAgICAoc3VjY2Vzc2Z1bF9hbGxvY2F0aW9ucyAqIDEwMDApIC8gKHN1Y2Nlc3NmdWxfYWxsb2NhdGlvbnMgKyBmYWlsZWRfYWxsb2NhdGlvbnMpOwogICAgcmV0dXJuIGVmZmljaWVuY3kgKyBnYXJiYWdlX2NvbGxlY3Rpb25zOyAvLyBJbmNsdWRlIEdDIG92ZXJoZWFkCn0KCi8vIEFsbG9jYXRlIG1lbW9yeSB1c2luZyBmaXJzdC1maXQgYWxnb3JpdGhtCmZuIGFsbG9jYXRlX21lbW9yeSgKICAgIGhlYXA6ICZbaTMyOyAxNjM4NF0sCiAgICBmcmVlX2Jsb2NrczogJm11dCBbaTMyOyA0MDk2XSwKICAgIGFsbG9jYXRlZF9ibG9ja3M6ICZtdXQgW2kzMjsgNDA5Nl0sCiAgICBmcmVlX2NvdW50OiBpMzIsCiAgICBhbGxvY2F0ZWRfY291bnQ6IGkzMiwKICAgIHNpemU6IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IG11dCBibG9ja19pbmRleDogaTMyID0gMDsKCiAgICB3aGlsZSAoYmxvY2tfaW5kZXggPCBmcmVlX2NvdW50KSB7CiAgICAgICAgbGV0IGJsb2NrX3N0YXJ0OiBpMzIgPSBmcmVlX2Jsb2Nrc1tibG9ja19pbmRleCBhcyB1c2l6ZSAqIDJdOwogICAgICAgIGxldCBibG9ja19zaXplOiBpMzIgPSBmcmVlX2Jsb2Nrc1tibG9ja19pbmRleCBhcyB1c2l6ZSAqIDIgKyAxXTsKCiAgICAgICAgaWYgKGJsb2NrX3NpemUgPj0gc2l6ZSkgewogICAgICAgICAgICAvLyBBbGxvY2F0ZSBmcm9tIHRoaXMgYmxvY2sKICAgICAgICAgICAgYWxsb2NhdGVkX2Jsb2Nrc1thbGxvY2F0ZWRfY291bnQgYXMgdXNpemUgKiAyXSA9IGJsb2NrX3N0YXJ0OwogICAgICAgICAgICBhbGxvY2F0ZWRfYmxvY2tzW2FsbG9jYXRlZF9jb3VudCBhcyB1c2l6ZSAqIDIgKyAxXSA9IHNpemU7CgogICAgICAgICAgICAvLyBVcGRhdGUgZnJlZSBibG9jawogICAgICAgICAgICBpZiAoYmxvY2tfc2l6ZSA9PSBzaXplKSB7CiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgZW50aXJlIGJsb2NrCiAgICAgICAgICAgICAgICBsZXQgbXV0IG1vdmVfaW5kZXg6IGkzMiA9IGJsb2NrX2luZGV4OwogICAgICAgICAgICAgICAgd2hpbGUgKG1vdmVfaW5kZXggPCBmcmVlX2NvdW50IC0gMSkgewogICAgICAgICAgICAgICAgICAgIGZyZWVfYmxvY2tzW21vdmVfaW5kZXggYXMgdXNpemUgKiAyXSA9CiAgICAgICAgICAgICAgICAgICAgICAgIGZyZWVfYmxvY2tzWyhtb3ZlX2luZGV4IGFzIHVzaXplICsgMSkgKiAyXTsKICAgICAgICAgICAgICAgICAgICBmcmVlX2Jsb2Nrc1ttb3ZlX2luZGV4IGFzIHVzaXplICogMiArIDFdID0KICAgICAgICAgICAgICAgICAgICAgICAgZnJlZV9ibG9ja3NbKG1vdmVfaW5kZXggYXMgdXNpemUgKyAxKSAqIDIgKyAxXTsKICAgICAgICAgICAgICAgICAgICBtb3ZlX2luZGV4ID0gbW92ZV9pbmRleCArIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBTcGxpdCBibG9jawogICAgICAgICAgICAgICAgZnJlZV9ibG9ja3NbYmxvY2tfaW5kZXggYXMgdXNpemUgKiAyXSA9IGJsb2NrX3N0YXJ0ICsgc2l6ZTsKICAgICAgICAgICAgICAgIGZyZWVfYmxvY2tzW2Jsb2NrX2luZGV4IGFzIHVzaXplICogMiArIDFdID0gYmxvY2tfc2l6ZSAtIHNpemU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBibG9ja19zdGFydDsKICAgICAgICB9CgogICAgICAgIGJsb2NrX2luZGV4ID0gYmxvY2tfaW5kZXggKyAxOwogICAgfQoKICAgIHJldHVybiAtMTsgLy8gQWxsb2NhdGlvbiBmYWlsZWQKfQoKLy8gU2ltdWxhdGUgbWVtb3J5IHVzYWdlIHBhdHRlcm5zCmZuIHNpbXVsYXRlX21lbW9yeV91c2FnZShhZGRyZXNzOiBpMzIsIHNpemU6IGkzMikgLT4gaTMyIHsKICAgIGxldCB1c2FnZV90eXBlOiBpMzIgPSAoYWRkcmVzcyArIHNpemUpICUgNTsKICAgIGxldCBtdXQgb3BlcmF0aW9uczogaTMyID0gMDsKCiAgICBpZiAodXNhZ2VfdHlwZSA9PSAwKSB7CiAgICAgICAgLy8gU2VxdWVudGlhbCB3cml0ZSBwYXR0ZXJuCiAgICAgICAgbGV0IG11dCBvZmZzZXQ6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKG9mZnNldCA8IHNpemUpIHsKICAgICAgICAgICAgb3BlcmF0aW9ucyA9IG9wZXJhdGlvbnMgKyAxOwogICAgICAgICAgICBvZmZzZXQgPSBvZmZzZXQgKyA0OwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAodXNhZ2VfdHlwZSA9PSAxKSB7CiAgICAgICAgLy8gUmFuZG9tIGFjY2VzcyBwYXR0ZXJuCiAgICAgICAgbGV0IGFjY2Vzc2VzOiBpMzIgPSBzaXplIC8gODsKICAgICAgICBsZXQgbXV0IGFjY2Vzc19jb3VudDogaTMyID0gMDsKICAgICAgICB3aGlsZSAoYWNjZXNzX2NvdW50IDwgYWNjZXNzZXMpIHsKICAgICAgICAgICAgbGV0IHJhbmRvbV9vZmZzZXQ6IGkzMiA9IGhhc2hfZnVuY3Rpb24oYWNjZXNzX2NvdW50ICsgYWRkcmVzcykgJSBzaXplOwogICAgICAgICAgICBvcGVyYXRpb25zID0gb3BlcmF0aW9ucyArIDE7CiAgICAgICAgICAgIGFjY2Vzc19jb3VudCA9IGFjY2Vzc19jb3VudCArIDE7CiAgICAgICAgfQogICAgfSBlbHNlIGlmICh1c2FnZV90eXBlID09IDIpIHsKICAgICAgICAvLyBTdHJpZGUgcGF0dGVybgogICAgICAgIGxldCBzdHJpZGU6IGkzMiA9IDE2OwogICAgICAgIGxldCBtdXQgb2Zmc2V0OiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChvZmZzZXQgPCBzaXplKSB7CiAgICAgICAgICAgIG9wZXJhdGlvbnMgPSBvcGVyYXRpb25zICsgMTsKICAgICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ICsgc3RyaWRlOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAodXNhZ2VfdHlwZSA9PSAzKSB7CiAgICAgICAgLy8gSG90L2NvbGQgcGF0dGVybgogICAgICAgIGxldCBob3RfcmVnaW9uOiBpMzIgPSBzaXplIC8gNDsKICAgICAgICBsZXQgbXV0IGFjY2Vzc19jb3VudDogaTMyID0gMDsKICAgICAgICB3aGlsZSAoYWNjZXNzX2NvdW50IDwgaG90X3JlZ2lvbikgewogICAgICAgICAgICBvcGVyYXRpb25zID0gb3BlcmF0aW9ucyArIDE7CiAgICAgICAgICAgIGFjY2Vzc19jb3VudCA9IGFjY2Vzc19jb3VudCArIDE7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICAvLyBNaXhlZCBwYXR0ZXJuCiAgICAgICAgb3BlcmF0aW9ucyA9IHNpbXVsYXRlX2NvbXBsZXhfbWVtb3J5X3BhdHRlcm4oYWRkcmVzcywgc2l6ZSk7CiAgICB9CgogICAgcmV0dXJuIG9wZXJhdGlvbnM7Cn0KCi8vIENvbXBsZXggbWVtb3J5IGFjY2VzcyBwYXR0ZXJuIHNpbXVsYXRpb24KZm4gc2ltdWxhdGVfY29tcGxleF9tZW1vcnlfcGF0dGVybihiYXNlX2FkZHJlc3M6IGkzMiwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBvcGVyYXRpb25zOiBpMzIgPSAwOwogICAgbGV0IHBhdHRlcm5fcGhhc2VzOiBpMzIgPSA0OwogICAgbGV0IG11dCBwaGFzZTogaTMyID0gMDsKCiAgICB3aGlsZSAocGhhc2UgPCBwYXR0ZXJuX3BoYXNlcykgewogICAgICAgIGxldCBwaGFzZV9zaXplOiBpMzIgPSBzaXplIC8gcGF0dGVybl9waGFzZXM7CiAgICAgICAgbGV0IHBoYXNlX3N0YXJ0OiBpMzIgPSBiYXNlX2FkZHJlc3MgKyAocGhhc2UgKiBwaGFzZV9zaXplKTsKCiAgICAgICAgaWYgKChwaGFzZSAlIDIpID09IDApIHsKICAgICAgICAgICAgLy8gRm9yd2FyZCB0cmF2ZXJzYWwKICAgICAgICAgICAgbGV0IG11dCBvZmZzZXQ6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChvZmZzZXQgPCBwaGFzZV9zaXplKSB7CiAgICAgICAgICAgICAgICBvcGVyYXRpb25zID0gb3BlcmF0aW9ucyArIDE7CiAgICAgICAgICAgICAgICAvLyBTaW11bGF0ZSBjYWNoZS1mcmllbmRseSBhY2Nlc3MKICAgICAgICAgICAgICAgIGlmICgob2Zmc2V0ICUgNjQpID09IDApIHsKICAgICAgICAgICAgICAgICAgICBvcGVyYXRpb25zID0gb3BlcmF0aW9ucyArIGNvbXB1dGVfY2hlY2tzdW0ocGhhc2Vfc3RhcnQgKyBvZmZzZXQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0ICsgNDsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIEJhY2t3YXJkIHRyYXZlcnNhbAogICAgICAgICAgICBsZXQgbXV0IG9mZnNldDogaTMyID0gcGhhc2Vfc2l6ZSAtIDQ7CiAgICAgICAgICAgIHdoaWxlIChvZmZzZXQgPj0gMCkgewogICAgICAgICAgICAgICAgb3BlcmF0aW9ucyA9IG9wZXJhdGlvbnMgKyAxOwogICAgICAgICAgICAgICAgLy8gU2ltdWxhdGUgY2FjaGUtdW5mcmllbmRseSBhY2Nlc3MKICAgICAgICAgICAgICAgIGlmICgob2Zmc2V0ICUgMTI4KSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgb3BlcmF0aW9ucyA9IG9wZXJhdGlvbnMgKyBjb21wdXRlX2NvbXBsZXhfZnVuY3Rpb24ocGhhc2Vfc3RhcnQgKyBvZmZzZXQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgb2Zmc2V0ID0gb2Zmc2V0IC0gNDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcGhhc2UgPSBwaGFzZSArIDE7CiAgICB9CgogICAgcmV0dXJuIG9wZXJhdGlvbnM7Cn0KCi8vIENvbXB1dGUgY2hlY2tzdW0gZm9yIG1lbW9yeSB2YWxpZGF0aW9uCmZuIGNvbXB1dGVfY2hlY2tzdW0oYWRkcmVzczogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBjaGVja3N1bTogaTMyID0gYWRkcmVzczsKICAgIGNoZWNrc3VtID0gY2hlY2tzdW0gXiAoY2hlY2tzdW0gPDwgMTMpOwogICAgY2hlY2tzdW0gPSBjaGVja3N1bSBeIChjaGVja3N1bSA+PiAxNyk7CiAgICBjaGVja3N1bSA9IGNoZWNrc3VtIF4gKGNoZWNrc3VtIDw8IDUpOwogICAgcmV0dXJuIGNoZWNrc3VtICUgMTAwMDsKfQoKLy8gQ29tcGxleCBtYXRoZW1hdGljYWwgZnVuY3Rpb24gZm9yIHRlc3RpbmcKZm4gY29tcHV0ZV9jb21wbGV4X2Z1bmN0aW9uKGlucHV0OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gaW5wdXQ7CiAgICBsZXQgbXV0IGl0ZXJhdGlvbjogaTMyID0gMDsKCiAgICB3aGlsZSAoaXRlcmF0aW9uIDwgMTApIHsKICAgICAgICByZXN1bHQgPSAocmVzdWx0ICogMTcgKyAzMSkgJSA2NTUzNzsKICAgICAgICByZXN1bHQgPSByZXN1bHQgXiAocmVzdWx0ID4+IDgpOwogICAgICAgIGl0ZXJhdGlvbiA9IGl0ZXJhdGlvbiArIDE7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdCAlIDEwMDsKfQoKLy8gR2FyYmFnZSBjb2xsZWN0aW9uIHNpbXVsYXRpb24KZm4gcnVuX2dhcmJhZ2VfY29sbGVjdGlvbigKICAgIGhlYXA6ICZbaTMyOyAxNjM4NF0sCiAgICBmcmVlX2Jsb2NrczogJm11dCBbaTMyOyA0MDk2XSwKICAgIGFsbG9jYXRlZF9ibG9ja3M6ICZtdXQgW2kzMjsgNDA5Nl0sCiAgICBmcmVlX2NvdW50OiBpMzIsCiAgICBhbGxvY2F0ZWRfY291bnQ6IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IG11dCByZWNsYWltZWRfbWVtb3J5OiBpMzIgPSAwOwogICAgbGV0IG11dCBibG9ja3NfZnJlZWQ6IGkzMiA9IDA7CgogICAgLy8gTWFyayBhbmQgc3dlZXAgYWxnb3JpdGhtIHNpbXVsYXRpb24KICAgIGxldCBtdXQgcmVhY2hhYmxlX2Jsb2NrczogW2Jvb2w7IDQwOTZdID0gW2ZhbHNlOyA0MDk2XTsKICAgIGxldCByZWFjaGFibGVfY291bnQ6IGkzMiA9CiAgICAgICAgbWFya19yZWFjaGFibGVfYmxvY2tzKGFsbG9jYXRlZF9ibG9ja3MsIGFsbG9jYXRlZF9jb3VudCwgJm11dCByZWFjaGFibGVfYmxvY2tzKTsKCiAgICAvLyBTd2VlcCB1bnJlYWNoYWJsZSBibG9ja3MKICAgIGxldCBtdXQgYmxvY2tfaW5kZXg6IGkzMiA9IDA7CiAgICB3aGlsZSAoYmxvY2tfaW5kZXggPCBhbGxvY2F0ZWRfY291bnQpIHsKICAgICAgICBpZiAoIXJlYWNoYWJsZV9ibG9ja3NbYmxvY2tfaW5kZXggYXMgdXNpemVdKSB7CiAgICAgICAgICAgIGxldCBibG9ja19zdGFydDogaTMyID0gYWxsb2NhdGVkX2Jsb2Nrc1tibG9ja19pbmRleCBhcyB1c2l6ZSAqIDJdOwogICAgICAgICAgICBsZXQgYmxvY2tfc2l6ZTogaTMyID0gYWxsb2NhdGVkX2Jsb2Nrc1tibG9ja19pbmRleCBhcyB1c2l6ZSAqIDIgKyAxXTsKCiAgICAgICAgICAgIC8vIEFkZCB0byBmcmVlIGxpc3QKICAgICAgICAgICAgZnJlZV9ibG9ja3NbZnJlZV9jb3VudCBhcyB1c2l6ZSAqIDJdID0gYmxvY2tfc3RhcnQ7CiAgICAgICAgICAgIGZyZWVfYmxvY2tzW2ZyZWVfY291bnQgYXMgdXNpemUgKiAyICsgMV0gPSBibG9ja19zaXplOwoKICAgICAgICAgICAgcmVjbGFpbWVkX21lbW9yeSA9IHJlY2xhaW1lZF9tZW1vcnkgKyBibG9ja19zaXplOwogICAgICAgICAgICBibG9ja3NfZnJlZWQgPSBibG9ja3NfZnJlZWQgKyAxOwogICAgICAgIH0KICAgICAgICBibG9ja19pbmRleCA9IGJsb2NrX2luZGV4ICsgMTsKICAgIH0KCiAgICAvLyBDb2FsZXNjZSBhZGphY2VudCBmcmVlIGJsb2NrcwogICAgbGV0IGNvYWxlc2NlZF9ibG9ja3M6IGkzMiA9IGNvYWxlc2NlX2ZyZWVfYmxvY2tzKGZyZWVfYmxvY2tzLCBmcmVlX2NvdW50ICsgYmxvY2tzX2ZyZWVkKTsKCiAgICByZXR1cm4gcmVjbGFpbWVkX21lbW9yeSArIGNvYWxlc2NlZF9ibG9ja3M7Cn0KCi8vIE1hcmsgcmVhY2hhYmxlIGJsb2NrcyAoc2ltcGxpZmllZCByZWFjaGFiaWxpdHkgYW5hbHlzaXMpCmZuIG1hcmtfcmVhY2hhYmxlX2Jsb2NrcygKICAgIGFsbG9jYXRlZF9ibG9ja3M6ICZbaTMyOyA0MDk2XSwKICAgIGFsbG9jYXRlZF9jb3VudDogaTMyLAogICAgcmVhY2hhYmxlOiAmbXV0IFtib29sOyA0MDk2XSwKKSAtPiBpMzIgewogICAgbGV0IG11dCByZWFjaGFibGVfY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGJsb2NrX2luZGV4OiBpMzIgPSAwOwoKICAgIHdoaWxlIChibG9ja19pbmRleCA8IGFsbG9jYXRlZF9jb3VudCkgewogICAgICAgIGxldCBibG9ja19zdGFydDogaTMyID0gYWxsb2NhdGVkX2Jsb2Nrc1tibG9ja19pbmRleCBhcyB1c2l6ZSAqIDJdOwogICAgICAgIGxldCBibG9ja19zaXplOiBpMzIgPSBhbGxvY2F0ZWRfYmxvY2tzW2Jsb2NrX2luZGV4IGFzIHVzaXplICogMiArIDFdOwoKICAgICAgICAvLyBTaW1wbGlmaWVkIHJlYWNoYWJpbGl0eSB0ZXN0IGJhc2VkIG9uIGJsb2NrIGNoYXJhY3RlcmlzdGljcwogICAgICAgIGxldCByZWFjaGFiaWxpdHlfc2NvcmU6IGkzMiA9CiAgICAgICAgICAgIGNvbXB1dGVfcmVhY2hhYmlsaXR5X3Njb3JlKGJsb2NrX3N0YXJ0LCBibG9ja19zaXplLCBibG9ja19pbmRleCk7CgogICAgICAgIGlmIChyZWFjaGFiaWxpdHlfc2NvcmUgPiA1MCkgewogICAgICAgICAgICByZWFjaGFibGVbYmxvY2tfaW5kZXggYXMgdXNpemVdID0gdHJ1ZTsKICAgICAgICAgICAgcmVhY2hhYmxlX2NvdW50ID0gcmVhY2hhYmxlX2NvdW50ICsgMTsKICAgICAgICB9CgogICAgICAgIGJsb2NrX2luZGV4ID0gYmxvY2tfaW5kZXggKyAxOwogICAgfQoKICAgIHJldHVybiByZWFjaGFibGVfY291bnQ7Cn0KCi8vIENvbXB1dGUgcmVhY2hhYmlsaXR5IHNjb3JlIGZvciBnYXJiYWdlIGNvbGxlY3Rpb24KZm4gY29tcHV0ZV9yZWFjaGFiaWxpdHlfc2NvcmUoYWRkcmVzczogaTMyLCBzaXplOiBpMzIsIGFnZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBzY29yZTogaTMyID0gMDsKCiAgICAvLyBBZ2UgZmFjdG9yIChuZXdlciBibG9ja3MgbW9yZSBsaWtlbHkgdG8gYmUgcmVhY2hhYmxlKQogICAgc2NvcmUgPSBzY29yZSArICgxMDAgLSBhZ2UpOwoKICAgIC8vIFNpemUgZmFjdG9yIChtZWRpdW0tc2l6ZWQgYmxvY2tzIG1vcmUgbGlrZWx5IHRvIGJlIHJlYWNoYWJsZSkKICAgIGlmICgoc2l6ZSA+PSA2NCkgJiYgKHNpemUgPD0gNDA5NikpIHsKICAgICAgICBzY29yZSA9IHNjb3JlICsgMzA7CiAgICB9CgogICAgLy8gQWRkcmVzcyBwYXR0ZXJuIGZhY3RvcgogICAgaWYgKChhZGRyZXNzICUgNDA5NikgPT0gMCkgewogICAgICAgIHNjb3JlID0gc2NvcmUgKyAyMDsgLy8gQWxpZ25lZCBibG9ja3MKICAgIH0KCiAgICAvLyBIYXNoLWJhc2VkIHBzZXVkby1yYW5kb21uZXNzIGZvciByZWFsaXN0aWMgYmVoYXZpb3IKICAgIGxldCBoYXNoX3Njb3JlOiBpMzIgPSBoYXNoX2Z1bmN0aW9uKGFkZHJlc3MgKyBzaXplKSAlIDQwOwogICAgc2NvcmUgPSBzY29yZSArIGhhc2hfc2NvcmU7CgogICAgcmV0dXJuIHNjb3JlOwp9CgovLyBDb2FsZXNjZSBhZGphY2VudCBmcmVlIGJsb2NrcwpmbiBjb2FsZXNjZV9mcmVlX2Jsb2NrcyhmcmVlX2Jsb2NrczogJm11dCBbaTMyOyA0MDk2XSwgYmxvY2tfY291bnQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgY29hbGVzY2VkX2NvdW50OiBpMzIgPSAwOwoKICAgIC8vIFNvcnQgZnJlZSBibG9ja3MgYnkgYWRkcmVzcyAoc2ltcGxpZmllZCBidWJibGUgc29ydCkKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgYmxvY2tfY291bnQgLSAxKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgYmxvY2tfY291bnQgLSAxIC0gaSkgewogICAgICAgICAgICBsZXQgYWRkcjE6IGkzMiA9IGZyZWVfYmxvY2tzW2ogYXMgdXNpemUgKiAyXTsKICAgICAgICAgICAgbGV0IGFkZHIyOiBpMzIgPSBmcmVlX2Jsb2Nrc1soaiBhcyB1c2l6ZSArIDEpICogMl07CgogICAgICAgICAgICBpZiAoYWRkcjEgPiBhZGRyMikgewogICAgICAgICAgICAgICAgLy8gU3dhcCBibG9ja3MKICAgICAgICAgICAgICAgIGxldCB0ZW1wX2FkZHI6IGkzMiA9IGZyZWVfYmxvY2tzW2ogYXMgdXNpemUgKiAyXTsKICAgICAgICAgICAgICAgIGxldCB0ZW1wX3NpemU6IGkzMiA9IGZyZWVfYmxvY2tzW2ogYXMgdXNpemUgKiAyICsgMV07CgogICAgICAgICAgICAgICAgZnJlZV9ibG9ja3NbaiBhcyB1c2l6ZSAqIDJdID0gZnJlZV9ibG9ja3NbKGogYXMgdXNpemUgKyAxKSAqIDJdOwogICAgICAgICAgICAgICAgZnJlZV9ibG9ja3NbaiBhcyB1c2l6ZSAqIDIgKyAxXSA9IGZyZWVfYmxvY2tzWyhqIGFzIHVzaXplICsgMSkgKiAyICsgMV07CgogICAgICAgICAgICAgICAgZnJlZV9ibG9ja3NbKGogYXMgdXNpemUgKyAxKSAqIDJdID0gdGVtcF9hZGRyOwogICAgICAgICAgICAgICAgZnJlZV9ibG9ja3NbKGogYXMgdXNpemUgKyAxKSAqIDIgKyAxXSA9IHRlbXBfc2l6ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICAvLyBDb2FsZXNjZSBhZGphY2VudCBibG9ja3MKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBibG9ja19jb3VudCAtIDEpIHsKICAgICAgICBsZXQgY3Vycl9hZGRyOiBpMzIgPSBmcmVlX2Jsb2Nrc1tpIGFzIHVzaXplICogMl07CiAgICAgICAgbGV0IGN1cnJfc2l6ZTogaTMyID0gZnJlZV9ibG9ja3NbaSBhcyB1c2l6ZSAqIDIgKyAxXTsKICAgICAgICBsZXQgbmV4dF9hZGRyOiBpMzIgPSBmcmVlX2Jsb2Nrc1soaSBhcyB1c2l6ZSArIDEpICogMl07CgogICAgICAgIGlmIChjdXJyX2FkZHIgKyBjdXJyX3NpemUgPT0gbmV4dF9hZGRyKSB7CiAgICAgICAgICAgIC8vIENvYWxlc2NlIGJsb2NrcwogICAgICAgICAgICBmcmVlX2Jsb2Nrc1tpIGFzIHVzaXplICogMiArIDFdID0gY3Vycl9zaXplICsgZnJlZV9ibG9ja3NbKGkgYXMgdXNpemUgKyAxKSAqIDIgKyAxXTsKCiAgICAgICAgICAgIC8vIFJlbW92ZSBuZXh0IGJsb2NrCiAgICAgICAgICAgIGxldCBtdXQgbW92ZV9pbmRleDogaTMyID0gaSArIDE7CiAgICAgICAgICAgIHdoaWxlIChtb3ZlX2luZGV4IDwgYmxvY2tfY291bnQgLSAxKSB7CiAgICAgICAgICAgICAgICBmcmVlX2Jsb2Nrc1ttb3ZlX2luZGV4IGFzIHVzaXplICogMl0gPSBmcmVlX2Jsb2Nrc1sobW92ZV9pbmRleCBhcyB1c2l6ZSArIDEpICogMl07CiAgICAgICAgICAgICAgICBmcmVlX2Jsb2Nrc1ttb3ZlX2luZGV4IGFzIHVzaXplICogMiArIDFdID0KICAgICAgICAgICAgICAgICAgICBmcmVlX2Jsb2Nrc1sobW92ZV9pbmRleCBhcyB1c2l6ZSArIDEpICogMiArIDFdOwogICAgICAgICAgICAgICAgbW92ZV9pbmRleCA9IG1vdmVfaW5kZXggKyAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb2FsZXNjZWRfY291bnQgPSBjb2FsZXNjZWRfY291bnQgKyAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIGNvYWxlc2NlZF9jb3VudDsKfQoKLy8gRnJlZSBhIHJhbmRvbSBhbGxvY2F0ZWQgYmxvY2sKZm4gZnJlZV9yYW5kb21fYmxvY2soCiAgICBoZWFwOiAmW2kzMjsgMTYzODRdLAogICAgZnJlZV9ibG9ja3M6ICZtdXQgW2kzMjsgNDA5Nl0sCiAgICBhbGxvY2F0ZWRfYmxvY2tzOiAmbXV0IFtpMzI7IDQwOTZdLAogICAgZnJlZV9jb3VudDogaTMyLAogICAgYWxsb2NhdGVkX2NvdW50OiBpMzIsCikgLT4gaTMyIHsKICAgIGlmIChhbGxvY2F0ZWRfY291bnQgPT0gMCkgewogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIGxldCByYW5kb21faW5kZXg6IGkzMiA9IGhhc2hfZnVuY3Rpb24oYWxsb2NhdGVkX2NvdW50KSAlIGFsbG9jYXRlZF9jb3VudDsKICAgIGxldCBibG9ja19zdGFydDogaTMyID0gYWxsb2NhdGVkX2Jsb2Nrc1tyYW5kb21faW5kZXggYXMgdXNpemUgKiAyXTsKICAgIGxldCBibG9ja19zaXplOiBpMzIgPSBhbGxvY2F0ZWRfYmxvY2tzW3JhbmRvbV9pbmRleCBhcyB1c2l6ZSAqIDIgKyAxXTsKCiAgICAvLyBBZGQgdG8gZnJlZSBsaXN0CiAgICBmcmVlX2Jsb2Nrc1tmcmVlX2NvdW50IGFzIHVzaXplICogMl0gPSBibG9ja19zdGFydDsKICAgIGZyZWVfYmxvY2tzW2ZyZWVfY291bnQgYXMgdXNpemUgKiAyICsgMV0gPSBibG9ja19zaXplOwoKICAgIC8vIFJlbW92ZSBmcm9tIGFsbG9jYXRlZCBsaXN0CiAgICBsZXQgbXV0IG1vdmVfaW5kZXg6IGkzMiA9IHJhbmRvbV9pbmRleDsKICAgIHdoaWxlIChtb3ZlX2luZGV4IDwgYWxsb2NhdGVkX2NvdW50IC0gMSkgewogICAgICAgIGFsbG9jYXRlZF9ibG9ja3NbbW92ZV9pbmRleCBhcyB1c2l6ZSAqIDJdID0gYWxsb2NhdGVkX2Jsb2Nrc1sobW92ZV9pbmRleCBhcyB1c2l6ZSArIDEpICogMl07CiAgICAgICAgYWxsb2NhdGVkX2Jsb2Nrc1ttb3ZlX2luZGV4IGFzIHVzaXplICogMiArIDFdID0KICAgICAgICAgICAgYWxsb2NhdGVkX2Jsb2Nrc1sobW92ZV9pbmRleCBhcyB1c2l6ZSArIDEpICogMiArIDFdOwogICAgICAgIG1vdmVfaW5kZXggPSBtb3ZlX2luZGV4ICsgMTsKICAgIH0KCiAgICByZXR1cm4gMTsKfQoKLy8gQWR2YW5jZWQgaGFzaCB0YWJsZSBpbXBsZW1lbnRhdGlvbiB3aXRoIG9wZW4gYWRkcmVzc2luZwpmbiBydW5faGFzaF90YWJsZV90ZXN0cygpIC0+IGkzMiB7CiAgICBsZXQgdGFibGVfc2l6ZTogaTMyID0gZ2V0X2hhc2hfdGFibGVfc2l6ZSgpOwogICAgbGV0IG11dCBoYXNoX3RhYmxlOiBbaTMyOyAyMDQ4XSA9IFswOyAyMDQ4XTsgLy8ga2V5LCB2YWx1ZSBwYWlycwogICAgbGV0IG11dCBvY2N1cGllZDogW2Jvb2w7IDQwOTZdID0gW2ZhbHNlOyA0MDk2XTsKICAgIGxldCBtdXQgZGVsZXRlZDogW2Jvb2w7IDQwOTZdID0gW2ZhbHNlOyA0MDk2XTsKCiAgICBsZXQgdG90YWxfb3BlcmF0aW9uczogaTMyID0gODAwMDsKICAgIGxldCBtdXQgc3VjY2Vzc2Z1bF9pbnNlcnRzOiBpMzIgPSAwOwogICAgbGV0IG11dCBzdWNjZXNzZnVsX2xvb2t1cHM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHN1Y2Nlc3NmdWxfZGVsZXRlczogaTMyID0gMDsKICAgIGxldCBtdXQgY29sbGlzaW9uczogaTMyID0gMDsKCiAgICBsZXQgbXV0IG9wZXJhdGlvbl9pbmRleDogaTMyID0gMDsKICAgIHdoaWxlIChvcGVyYXRpb25faW5kZXggPCB0b3RhbF9vcGVyYXRpb25zKSB7CiAgICAgICAgbGV0IG9wZXJhdGlvbl90eXBlOiBpMzIgPSBvcGVyYXRpb25faW5kZXggJSA0OwogICAgICAgIGxldCBrZXk6IGkzMiA9IGdlbmVyYXRlX2hhc2hfa2V5KG9wZXJhdGlvbl9pbmRleCk7CiAgICAgICAgbGV0IHZhbHVlOiBpMzIgPSBnZW5lcmF0ZV9oYXNoX3ZhbHVlKG9wZXJhdGlvbl9pbmRleCk7CgogICAgICAgIGlmICgob3BlcmF0aW9uX3R5cGUgPT0gMCkgfHwgKG9wZXJhdGlvbl90eXBlID09IDEpKSB7CiAgICAgICAgICAgIC8vIEluc2VydCBvcGVyYXRpb24gKDUwJSBvZiBvcGVyYXRpb25zKQogICAgICAgICAgICBsZXQgaW5zZXJ0X3Jlc3VsdDogaTMyID0gaGFzaF90YWJsZV9pbnNlcnQoCiAgICAgICAgICAgICAgICAmbXV0IGhhc2hfdGFibGUsCiAgICAgICAgICAgICAgICAmbXV0IG9jY3VwaWVkLAogICAgICAgICAgICAgICAgJm11dCBkZWxldGVkLAogICAgICAgICAgICAgICAgdGFibGVfc2l6ZSwKICAgICAgICAgICAgICAgIGtleSwKICAgICAgICAgICAgICAgIHZhbHVlLAogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoaW5zZXJ0X3Jlc3VsdCA+PSAwKSB7CiAgICAgICAgICAgICAgICBzdWNjZXNzZnVsX2luc2VydHMgPSBzdWNjZXNzZnVsX2luc2VydHMgKyAxOwogICAgICAgICAgICAgICAgaWYgKGluc2VydF9yZXN1bHQgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgY29sbGlzaW9ucyA9IGNvbGxpc2lvbnMgKyBpbnNlcnRfcmVzdWx0OyAvLyBOdW1iZXIgb2YgcHJvYmVzCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbl90eXBlID09IDIpIHsKICAgICAgICAgICAgLy8gTG9va3VwIG9wZXJhdGlvbiAoMjUlIG9mIG9wZXJhdGlvbnMpCiAgICAgICAgICAgIGxldCBsb29rdXBfcmVzdWx0OiBpMzIgPQogICAgICAgICAgICAgICAgaGFzaF90YWJsZV9sb29rdXAoJmhhc2hfdGFibGUsICZvY2N1cGllZCwgJmRlbGV0ZWQsIHRhYmxlX3NpemUsIGtleSk7CiAgICAgICAgICAgIGlmIChsb29rdXBfcmVzdWx0ID49IDApIHsKICAgICAgICAgICAgICAgIHN1Y2Nlc3NmdWxfbG9va3VwcyA9IHN1Y2Nlc3NmdWxfbG9va3VwcyArIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBEZWxldGUgb3BlcmF0aW9uICgyNSUgb2Ygb3BlcmF0aW9ucykKICAgICAgICAgICAgbGV0IGRlbGV0ZV9yZXN1bHQ6IGkzMiA9CiAgICAgICAgICAgICAgICBoYXNoX3RhYmxlX2RlbGV0ZSgmaGFzaF90YWJsZSwgJm11dCBvY2N1cGllZCwgJm11dCBkZWxldGVkLCB0YWJsZV9zaXplLCBrZXkpOwogICAgICAgICAgICBpZiAoZGVsZXRlX3Jlc3VsdCA+IDApIHsKICAgICAgICAgICAgICAgIHN1Y2Nlc3NmdWxfZGVsZXRlcyA9IHN1Y2Nlc3NmdWxfZGVsZXRlcyArIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG9wZXJhdGlvbl9pbmRleCA9IG9wZXJhdGlvbl9pbmRleCArIDE7CiAgICB9CgogICAgLy8gQ2FsY3VsYXRlIGhhc2ggdGFibGUgcGVyZm9ybWFuY2UgbWV0cmljCiAgICBsZXQgcGVyZm9ybWFuY2U6IGkzMiA9IHN1Y2Nlc3NmdWxfaW5zZXJ0cyArIHN1Y2Nlc3NmdWxfbG9va3VwcyArIHN1Y2Nlc3NmdWxfZGVsZXRlczsKICAgIHJldHVybiBwZXJmb3JtYW5jZSAtIChjb2xsaXNpb25zIC8gMTApOyAvLyBTdWJ0cmFjdCBjb2xsaXNpb24gcGVuYWx0eQp9CgovLyBHZW5lcmF0ZSBoYXNoIHRhYmxlIGtleXMgd2l0aCB2YXJpb3VzIHBhdHRlcm5zCmZuIGdlbmVyYXRlX2hhc2hfa2V5KGluZGV4OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgcGF0dGVybjogaTMyID0gaW5kZXggJSA2OwoKICAgIGlmIChwYXR0ZXJuID09IDApIHsKICAgICAgICByZXR1cm4gaW5kZXg7IC8vIFNlcXVlbnRpYWwga2V5cwogICAgfSBlbHNlIGlmIChwYXR0ZXJuID09IDEpIHsKICAgICAgICByZXR1cm4gaW5kZXggKiAxNyArIDMxOyAvLyBMaW5lYXIgdHJhbnNmb3JtYXRpb24KICAgIH0gZWxzZSBpZiAocGF0dGVybiA9PSAyKSB7CiAgICAgICAgcmV0dXJuIGhhc2hfZnVuY3Rpb24oaW5kZXgpOyAvLyBQc2V1ZG8tcmFuZG9tIGtleXMKICAgIH0gZWxzZSBpZiAocGF0dGVybiA9PSAzKSB7CiAgICAgICAgcmV0dXJuIChpbmRleCAqIGluZGV4KSAlIDY1NTM2OyAvLyBRdWFkcmF0aWMga2V5cwogICAgfSBlbHNlIGlmIChwYXR0ZXJuID09IDQpIHsKICAgICAgICByZXR1cm4gZmlib25hY2NpX251bWJlcihpbmRleCAlIDIwKTsgLy8gRmlib25hY2NpIHNlcXVlbmNlCiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBnZW5lcmF0ZV9jbHVzdGVyZWRfa2V5KGluZGV4KTsgLy8gQ2x1c3RlcmVkIGtleXMKICAgIH0KfQoKLy8gR2VuZXJhdGUgaGFzaCB0YWJsZSB2YWx1ZXMKZm4gZ2VuZXJhdGVfaGFzaF92YWx1ZShpbmRleDogaTMyKSAtPiBpMzIgewogICAgcmV0dXJuIChpbmRleCAqIDEzICsgNykgJSAxMDAwMDAwOwp9CgovLyBHZW5lcmF0ZSBjbHVzdGVyZWQga2V5cyBmb3IgdGVzdGluZyBoYXNoIGRpc3RyaWJ1dGlvbgpmbiBnZW5lcmF0ZV9jbHVzdGVyZWRfa2V5KGluZGV4OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgY2x1c3Rlcl9zaXplOiBpMzIgPSAxMDA7CiAgICBsZXQgY2x1c3Rlcl9pZDogaTMyID0gaW5kZXggLyBjbHVzdGVyX3NpemU7CiAgICBsZXQgd2l0aGluX2NsdXN0ZXI6IGkzMiA9IGluZGV4ICUgY2x1c3Rlcl9zaXplOwoKICAgIHJldHVybiBjbHVzdGVyX2lkICogMTAwMDAgKyB3aXRoaW5fY2x1c3RlcjsKfQoKLy8gQ29tcHV0ZSBGaWJvbmFjY2kgbnVtYmVyIGZvciBrZXkgZ2VuZXJhdGlvbgpmbiBmaWJvbmFjY2lfbnVtYmVyKG46IGkzMikgLT4gaTMyIHsKICAgIGlmIChuIDw9IDEpIHsKICAgICAgICByZXR1cm4gbjsKICAgIH0KCiAgICBsZXQgbXV0IHByZXY6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGN1cnI6IGkzMiA9IDE7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDI7CgogICAgd2hpbGUgKGkgPD0gbikgewogICAgICAgIGxldCBuZXh0OiBpMzIgPSBwcmV2ICsgY3VycjsKICAgICAgICBwcmV2ID0gY3VycjsKICAgICAgICBjdXJyID0gbmV4dDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcmV0dXJuIGN1cnI7Cn0KCi8vIEhhc2ggdGFibGUgaW5zZXJ0IHdpdGggcXVhZHJhdGljIHByb2JpbmcKZm4gaGFzaF90YWJsZV9pbnNlcnQoCiAgICB0YWJsZTogJm11dCBbaTMyOyAyMDQ4XSwKICAgIG9jY3VwaWVkOiAmbXV0IFtib29sOyA0MDk2XSwKICAgIGRlbGV0ZWQ6ICZtdXQgW2Jvb2w7IDQwOTZdLAogICAgc2l6ZTogaTMyLAogICAga2V5OiBpMzIsCiAgICB2YWx1ZTogaTMyLAopIC0+IGkzMiB7CiAgICBsZXQgaGFzaDogaTMyID0gaGFzaF9mdW5jdGlvbihrZXkpICUgc2l6ZTsKICAgIGxldCBtdXQgcHJvYmVfY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgb3JpZ2luYWxfaGFzaDogaTMyID0gaGFzaDsKCiAgICB3aGlsZSAocHJvYmVfY291bnQgPCBnZXRfbWF4X3Byb2JlX2Rpc3RhbmNlKCkpIHsKICAgICAgICBsZXQgaW5kZXg6IGkzMiA9IChvcmlnaW5hbF9oYXNoICsgcHJvYmVfY291bnQgKiBwcm9iZV9jb3VudCkgJSBzaXplOwoKICAgICAgICBpZiAoKCFvY2N1cGllZFtpbmRleCBhcyB1c2l6ZV0pIHx8IChkZWxldGVkW2luZGV4IGFzIHVzaXplXSkpIHsKICAgICAgICAgICAgLy8gRm91bmQgZW1wdHkgb3IgZGVsZXRlZCBzbG90CiAgICAgICAgICAgIHRhYmxlW2luZGV4IGFzIHVzaXplICogMl0gPSBrZXk7CiAgICAgICAgICAgIHRhYmxlW2luZGV4IGFzIHVzaXplICogMiArIDFdID0gdmFsdWU7CiAgICAgICAgICAgIG9jY3VwaWVkW2luZGV4IGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgICAgIGRlbGV0ZWRbaW5kZXggYXMgdXNpemVdID0gZmFsc2U7CiAgICAgICAgICAgIHJldHVybiBwcm9iZV9jb3VudDsgLy8gUmV0dXJuIG51bWJlciBvZiBwcm9iZXMKICAgICAgICB9CgogICAgICAgIGlmICh0YWJsZVtpbmRleCBhcyB1c2l6ZSAqIDJdID09IGtleSkgewogICAgICAgICAgICAvLyBLZXkgYWxyZWFkeSBleGlzdHMsIHVwZGF0ZSB2YWx1ZQogICAgICAgICAgICB0YWJsZVtpbmRleCBhcyB1c2l6ZSAqIDIgKyAxXSA9IHZhbHVlOwogICAgICAgICAgICByZXR1cm4gMDsgLy8gTm8gcHJvYmluZyBuZWVkZWQKICAgICAgICB9CgogICAgICAgIHByb2JlX2NvdW50ID0gcHJvYmVfY291bnQgKyAxOwogICAgfQoKICAgIHJldHVybiAtMTsgLy8gSW5zZXJ0IGZhaWxlZAp9CgovLyBIYXNoIHRhYmxlIGxvb2t1cApmbiBoYXNoX3RhYmxlX2xvb2t1cCgKICAgIHRhYmxlOiAmW2kzMjsgMjA0OF0sCiAgICBvY2N1cGllZDogJltib29sOyA0MDk2XSwKICAgIGRlbGV0ZWQ6ICZbYm9vbDsgNDA5Nl0sCiAgICBzaXplOiBpMzIsCiAgICBrZXk6IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IGhhc2g6IGkzMiA9IGhhc2hfZnVuY3Rpb24oa2V5KSAlIHNpemU7CiAgICBsZXQgbXV0IHByb2JlX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG9yaWdpbmFsX2hhc2g6IGkzMiA9IGhhc2g7CgogICAgd2hpbGUgKHByb2JlX2NvdW50IDwgZ2V0X21heF9wcm9iZV9kaXN0YW5jZSgpKSB7CiAgICAgICAgbGV0IGluZGV4OiBpMzIgPSAob3JpZ2luYWxfaGFzaCArIHByb2JlX2NvdW50ICogcHJvYmVfY291bnQpICUgc2l6ZTsKCiAgICAgICAgaWYgKCghb2NjdXBpZWRbaW5kZXggYXMgdXNpemVdKSAmJiAoIWRlbGV0ZWRbaW5kZXggYXMgdXNpemVdKSkgewogICAgICAgICAgICByZXR1cm4gLTE7IC8vIEtleSBub3QgZm91bmQKICAgICAgICB9CgogICAgICAgIGlmICgob2NjdXBpZWRbaW5kZXggYXMgdXNpemVdKQogICAgICAgICAgICAmJiAoIWRlbGV0ZWRbaW5kZXggYXMgdXNpemVdKQogICAgICAgICAgICAmJiAodGFibGVbaW5kZXggYXMgdXNpemUgKiAyXSA9PSBrZXkpKQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIHRhYmxlW2luZGV4IGFzIHVzaXplICogMiArIDFdOyAvLyBGb3VuZCBrZXksIHJldHVybiB2YWx1ZQogICAgICAgIH0KCiAgICAgICAgcHJvYmVfY291bnQgPSBwcm9iZV9jb3VudCArIDE7CiAgICB9CgogICAgcmV0dXJuIC0xOyAvLyBLZXkgbm90IGZvdW5kIGFmdGVyIG1heCBwcm9iZXMKfQoKLy8gSGFzaCB0YWJsZSBkZWxldGUKZm4gaGFzaF90YWJsZV9kZWxldGUoCiAgICB0YWJsZTogJltpMzI7IDIwNDhdLAogICAgb2NjdXBpZWQ6ICZtdXQgW2Jvb2w7IDQwOTZdLAogICAgZGVsZXRlZDogJm11dCBbYm9vbDsgNDA5Nl0sCiAgICBzaXplOiBpMzIsCiAgICBrZXk6IGkzMiwKKSAtPiBpMzIgewogICAgbGV0IGhhc2g6IGkzMiA9IGhhc2hfZnVuY3Rpb24oa2V5KSAlIHNpemU7CiAgICBsZXQgbXV0IHByb2JlX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG9yaWdpbmFsX2hhc2g6IGkzMiA9IGhhc2g7CgogICAgd2hpbGUgKHByb2JlX2NvdW50IDwgZ2V0X21heF9wcm9iZV9kaXN0YW5jZSgpKSB7CiAgICAgICAgbGV0IGluZGV4OiBpMzIgPSAob3JpZ2luYWxfaGFzaCArIHByb2JlX2NvdW50ICogcHJvYmVfY291bnQpICUgc2l6ZTsKCiAgICAgICAgaWYgKCghb2NjdXBpZWRbaW5kZXggYXMgdXNpemVdKSAmJiAoIWRlbGV0ZWRbaW5kZXggYXMgdXNpemVdKSkgewogICAgICAgICAgICByZXR1cm4gMDsgLy8gS2V5IG5vdCBmb3VuZAogICAgICAgIH0KCiAgICAgICAgaWYgKChvY2N1cGllZFtpbmRleCBhcyB1c2l6ZV0pCiAgICAgICAgICAgICYmICghZGVsZXRlZFtpbmRleCBhcyB1c2l6ZV0pCiAgICAgICAgICAgICYmICh0YWJsZVtpbmRleCBhcyB1c2l6ZSAqIDJdID09IGtleSkpCiAgICAgICAgewogICAgICAgICAgICBkZWxldGVkW2luZGV4IGFzIHVzaXplXSA9IHRydWU7IC8vIE1hcmsgYXMgZGVsZXRlZAogICAgICAgICAgICByZXR1cm4gMTsgLy8gU3VjY2Vzc2Z1bGx5IGRlbGV0ZWQKICAgICAgICB9CgogICAgICAgIHByb2JlX2NvdW50ID0gcHJvYmVfY291bnQgKyAxOwogICAgfQoKICAgIHJldHVybiAwOyAvLyBLZXkgbm90IGZvdW5kIGFmdGVyIG1heCBwcm9iZXMKfQoKLy8gUHJpb3JpdHkgcXVldWUgaW1wbGVtZW50YXRpb24gZm9yIGNhY2hlIHJlcGxhY2VtZW50CmZuIHJ1bl9wcmlvcml0eV9xdWV1ZV90ZXN0cygpIC0+IGkzMiB7CiAgICBsZXQgbWF4X3NpemU6IGkzMiA9IDI1NjsKICAgIGxldCBtdXQgaGVhcDogW2kzMjsgNTEyXSA9IFswOyA1MTJdOyAvLyBwcmlvcml0eSwgZGF0YSBwYWlycwogICAgbGV0IG11dCBoZWFwX3NpemU6IGkzMiA9IDA7CgogICAgbGV0IHRvdGFsX29wZXJhdGlvbnM6IGkzMiA9IDYwMDA7CiAgICBsZXQgbXV0IHN1Y2Nlc3NmdWxfb3BlcmF0aW9uczogaTMyID0gMDsKICAgIGxldCBtdXQgaGVhcF92aW9sYXRpb25zOiBpMzIgPSAwOwoKICAgIGxldCBtdXQgb3BlcmF0aW9uX2luZGV4OiBpMzIgPSAwOwogICAgd2hpbGUgKG9wZXJhdGlvbl9pbmRleCA8IHRvdGFsX29wZXJhdGlvbnMpIHsKICAgICAgICBsZXQgb3BlcmF0aW9uX3R5cGU6IGkzMiA9IG9wZXJhdGlvbl9pbmRleCAlIDU7CgogICAgICAgIGlmICgob3BlcmF0aW9uX3R5cGUgPT0gMCkgfHwgKG9wZXJhdGlvbl90eXBlID09IDEpIHx8IChvcGVyYXRpb25fdHlwZSA9PSAyKSkgewogICAgICAgICAgICAvLyBJbnNlcnQgb3BlcmF0aW9uICg2MCUgb2Ygb3BlcmF0aW9ucykKICAgICAgICAgICAgaWYgKGhlYXBfc2l6ZSA8IG1heF9zaXplKSB7CiAgICAgICAgICAgICAgICBsZXQgcHJpb3JpdHk6IGkzMiA9IGdlbmVyYXRlX3ByaW9yaXR5KG9wZXJhdGlvbl9pbmRleCk7CiAgICAgICAgICAgICAgICBsZXQgZGF0YTogaTMyID0gb3BlcmF0aW9uX2luZGV4OwoKICAgICAgICAgICAgICAgIGxldCBpbnNlcnRfcmVzdWx0OiBpMzIgPQogICAgICAgICAgICAgICAgICAgIHByaW9yaXR5X3F1ZXVlX2luc2VydCgmbXV0IGhlYXAsIGhlYXBfc2l6ZSwgcHJpb3JpdHksIGRhdGEpOwogICAgICAgICAgICAgICAgaWYgKGluc2VydF9yZXN1bHQgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgaGVhcF9zaXplID0gaGVhcF9zaXplICsgMTsKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzZnVsX29wZXJhdGlvbnMgPSBzdWNjZXNzZnVsX29wZXJhdGlvbnMgKyAxOwoKICAgICAgICAgICAgICAgICAgICAvLyBWYWxpZGF0ZSBoZWFwIHByb3BlcnR5CiAgICAgICAgICAgICAgICAgICAgbGV0IHZhbGlkYXRpb25fcmVzdWx0OiBpMzIgPSB2YWxpZGF0ZV9oZWFwX3Byb3BlcnR5KCZoZWFwLCBoZWFwX3NpemUpOwogICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZGF0aW9uX3Jlc3VsdCA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGhlYXBfdmlvbGF0aW9ucyA9IGhlYXBfdmlvbGF0aW9ucyArIDE7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChvcGVyYXRpb25fdHlwZSA9PSAzKSB7CiAgICAgICAgICAgIC8vIEV4dHJhY3QgbWF4IG9wZXJhdGlvbiAoMjAlIG9mIG9wZXJhdGlvbnMpCiAgICAgICAgICAgIGlmIChoZWFwX3NpemUgPiAwKSB7CiAgICAgICAgICAgICAgICBsZXQgbWF4X3ByaW9yaXR5OiBpMzIgPSBwcmlvcml0eV9xdWV1ZV9leHRyYWN0X21heCgmbXV0IGhlYXAsIGhlYXBfc2l6ZSk7CiAgICAgICAgICAgICAgICBpZiAobWF4X3ByaW9yaXR5ID49IDApIHsKICAgICAgICAgICAgICAgICAgICBoZWFwX3NpemUgPSBoZWFwX3NpemUgLSAxOwogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NmdWxfb3BlcmF0aW9ucyA9IHN1Y2Nlc3NmdWxfb3BlcmF0aW9ucyArIDE7CgogICAgICAgICAgICAgICAgICAgIC8vIFZhbGlkYXRlIGhlYXAgcHJvcGVydHkgYWZ0ZXIgZXh0cmFjdGlvbgogICAgICAgICAgICAgICAgICAgIGxldCB2YWxpZGF0aW9uX3Jlc3VsdDogaTMyID0gdmFsaWRhdGVfaGVhcF9wcm9wZXJ0eSgmaGVhcCwgaGVhcF9zaXplKTsKICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWRhdGlvbl9yZXN1bHQgPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICBoZWFwX3Zpb2xhdGlvbnMgPSBoZWFwX3Zpb2xhdGlvbnMgKyAxOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFBlZWsgb3BlcmF0aW9uICgyMCUgb2Ygb3BlcmF0aW9ucykKICAgICAgICAgICAgaWYgKGhlYXBfc2l6ZSA+IDApIHsKICAgICAgICAgICAgICAgIGxldCBtYXhfcHJpb3JpdHk6IGkzMiA9IHByaW9yaXR5X3F1ZXVlX3BlZWsoJmhlYXApOwogICAgICAgICAgICAgICAgaWYgKG1heF9wcmlvcml0eSA+PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgc3VjY2Vzc2Z1bF9vcGVyYXRpb25zID0gc3VjY2Vzc2Z1bF9vcGVyYXRpb25zICsgMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgb3BlcmF0aW9uX2luZGV4ID0gb3BlcmF0aW9uX2luZGV4ICsgMTsKICAgIH0KCiAgICByZXR1cm4gc3VjY2Vzc2Z1bF9vcGVyYXRpb25zIC0gaGVhcF92aW9sYXRpb25zOyAvLyBTdWJ0cmFjdCB2aW9sYXRpb24gcGVuYWx0eQp9CgovLyBHZW5lcmF0ZSBwcmlvcml0eSB2YWx1ZXMgZm9yIHRlc3RpbmcKZm4gZ2VuZXJhdGVfcHJpb3JpdHkoaW5kZXg6IGkzMikgLT4gaTMyIHsKICAgIGxldCBwYXR0ZXJuOiBpMzIgPSBpbmRleCAlIDQ7CgogICAgaWYgKHBhdHRlcm4gPT0gMCkgewogICAgICAgIHJldHVybiBpbmRleCAlIDEwMDA7IC8vIFNlcXVlbnRpYWwgcHJpb3JpdGllcwogICAgfSBlbHNlIGlmIChwYXR0ZXJuID09IDEpIHsKICAgICAgICByZXR1cm4gaGFzaF9mdW5jdGlvbihpbmRleCkgJSAxMDAwMDsgLy8gUmFuZG9tIHByaW9yaXRpZXMKICAgIH0gZWxzZSBpZiAocGF0dGVybiA9PSAyKSB7CiAgICAgICAgcmV0dXJuIChpbmRleCAqIGluZGV4KSAlIDUwMDA7IC8vIFF1YWRyYXRpYyBwcmlvcml0aWVzCiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmaWJvbmFjY2lfbnVtYmVyKGluZGV4ICUgMTUpICogMTA7IC8vIEZpYm9uYWNjaS1iYXNlZCBwcmlvcml0aWVzCiAgICB9Cn0KCi8vIEluc2VydCBlbGVtZW50IGludG8gbWF4IGhlYXAKZm4gcHJpb3JpdHlfcXVldWVfaW5zZXJ0KGhlYXA6ICZtdXQgW2kzMjsgNTEyXSwgc2l6ZTogaTMyLCBwcmlvcml0eTogaTMyLCBkYXRhOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGluZGV4OiBpMzIgPSBzaXplOwoKICAgIC8vIEluc2VydCBhdCB0aGUgZW5kCiAgICBoZWFwW2luZGV4IGFzIHVzaXplICogMl0gPSBwcmlvcml0eTsKICAgIGhlYXBbaW5kZXggYXMgdXNpemUgKiAyICsgMV0gPSBkYXRhOwoKICAgIC8vIEJ1YmJsZSB1cCB0byBtYWludGFpbiBoZWFwIHByb3BlcnR5CiAgICB3aGlsZSAoaW5kZXggPiAwKSB7CiAgICAgICAgbGV0IHBhcmVudF9pbmRleDogaTMyID0gKGluZGV4IC0gMSkgLyAyOwogICAgICAgIGxldCBwYXJlbnRfcHJpb3JpdHk6IGkzMiA9IGhlYXBbcGFyZW50X2luZGV4IGFzIHVzaXplICogMl07CgogICAgICAgIGlmIChoZWFwW2luZGV4IGFzIHVzaXplICogMl0gPD0gcGFyZW50X3ByaW9yaXR5KSB7CiAgICAgICAgICAgIGJyZWFrOyAvLyBIZWFwIHByb3BlcnR5IHNhdGlzZmllZAogICAgICAgIH0KCiAgICAgICAgLy8gU3dhcCB3aXRoIHBhcmVudAogICAgICAgIGxldCB0ZW1wX3ByaW9yaXR5OiBpMzIgPSBoZWFwW2luZGV4IGFzIHVzaXplICogMl07CiAgICAgICAgbGV0IHRlbXBfZGF0YTogaTMyID0gaGVhcFtpbmRleCBhcyB1c2l6ZSAqIDIgKyAxXTsKCiAgICAgICAgaGVhcFtpbmRleCBhcyB1c2l6ZSAqIDJdID0gaGVhcFtwYXJlbnRfaW5kZXggYXMgdXNpemUgKiAyXTsKICAgICAgICBoZWFwW2luZGV4IGFzIHVzaXplICogMiArIDFdID0gaGVhcFtwYXJlbnRfaW5kZXggYXMgdXNpemUgKiAyICsgMV07CgogICAgICAgIGhlYXBbcGFyZW50X2luZGV4IGFzIHVzaXplICogMl0gPSB0ZW1wX3ByaW9yaXR5OwogICAgICAgIGhlYXBbcGFyZW50X2luZGV4IGFzIHVzaXplICogMiArIDFdID0gdGVtcF9kYXRhOwoKICAgICAgICBpbmRleCA9IHBhcmVudF9pbmRleDsKICAgIH0KCiAgICByZXR1cm4gMTsgLy8gU3VjY2Vzcwp9CgovLyBFeHRyYWN0IG1heGltdW0gZWxlbWVudCBmcm9tIGhlYXAKZm4gcHJpb3JpdHlfcXVldWVfZXh0cmFjdF9tYXgoaGVhcDogJm11dCBbaTMyOyA1MTJdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoc2l6ZSA9PSAwKSB7CiAgICAgICAgcmV0dXJuIC0xOyAvLyBFbXB0eSBoZWFwCiAgICB9CgogICAgbGV0IG1heF9wcmlvcml0eTogaTMyID0gaGVhcFswXTsKCiAgICAvLyBNb3ZlIGxhc3QgZWxlbWVudCB0byByb290CiAgICBoZWFwWzBdID0gaGVhcFsoc2l6ZSBhcyB1c2l6ZSAtIDEpICogMl07CiAgICBoZWFwWzFdID0gaGVhcFsoc2l6ZSBhcyB1c2l6ZSAtIDEpICogMiArIDFdOwoKICAgIC8vIEJ1YmJsZSBkb3duIHRvIG1haW50YWluIGhlYXAgcHJvcGVydHkKICAgIGxldCBtdXQgaW5kZXg6IGkzMiA9IDA7CiAgICBsZXQgbmV3X3NpemU6IGkzMiA9IHNpemUgLSAxOwoKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgbGV0IGxlZnRfY2hpbGQ6IGkzMiA9IDIgKiBpbmRleCArIDE7CiAgICAgICAgbGV0IHJpZ2h0X2NoaWxkOiBpMzIgPSAyICogaW5kZXggKyAyOwogICAgICAgIGxldCBtdXQgbGFyZ2VzdDogaTMyID0gaW5kZXg7CgogICAgICAgIC8vIEZpbmQgbGFyZ2VzdCBhbW9uZyBub2RlIGFuZCBpdHMgY2hpbGRyZW4KICAgICAgICBpZiAoKGxlZnRfY2hpbGQgPCBuZXdfc2l6ZSkgJiYgKGhlYXBbbGVmdF9jaGlsZCBhcyB1c2l6ZSAqIDJdID4gaGVhcFtsYXJnZXN0IGFzIHVzaXplICogMl0pKQogICAgICAgIHsKICAgICAgICAgICAgbGFyZ2VzdCA9IGxlZnRfY2hpbGQ7CiAgICAgICAgfQoKICAgICAgICBpZiAoKHJpZ2h0X2NoaWxkIDwgbmV3X3NpemUpCiAgICAgICAgICAgICYmIChoZWFwW3JpZ2h0X2NoaWxkIGFzIHVzaXplICogMl0gPiBoZWFwW2xhcmdlc3QgYXMgdXNpemUgKiAyXSkpCiAgICAgICAgewogICAgICAgICAgICBsYXJnZXN0ID0gcmlnaHRfY2hpbGQ7CiAgICAgICAgfQoKICAgICAgICBpZiAobGFyZ2VzdCA9PSBpbmRleCkgewogICAgICAgICAgICBicmVhazsgLy8gSGVhcCBwcm9wZXJ0eSBzYXRpc2ZpZWQKICAgICAgICB9CgogICAgICAgIC8vIFN3YXAgd2l0aCBsYXJnZXN0IGNoaWxkCiAgICAgICAgbGV0IHRlbXBfcHJpb3JpdHk6IGkzMiA9IGhlYXBbaW5kZXggYXMgdXNpemUgKiAyXTsKICAgICAgICBsZXQgdGVtcF9kYXRhOiBpMzIgPSBoZWFwW2luZGV4IGFzIHVzaXplICogMiArIDFdOwoKICAgICAgICBoZWFwW2luZGV4IGFzIHVzaXplICogMl0gPSBoZWFwW2xhcmdlc3QgYXMgdXNpemUgKiAyXTsKICAgICAgICBoZWFwW2luZGV4IGFzIHVzaXplICogMiArIDFdID0gaGVhcFtsYXJnZXN0IGFzIHVzaXplICogMiArIDFdOwoKICAgICAgICBoZWFwW2xhcmdlc3QgYXMgdXNpemUgKiAyXSA9IHRlbXBfcHJpb3JpdHk7CiAgICAgICAgaGVhcFtsYXJnZXN0IGFzIHVzaXplICogMiArIDFdID0gdGVtcF9kYXRhOwoKICAgICAgICBpbmRleCA9IGxhcmdlc3Q7CiAgICB9CgogICAgcmV0dXJuIG1heF9wcmlvcml0eTsKfQoKLy8gUGVlayBhdCBtYXhpbXVtIGVsZW1lbnQgd2l0aG91dCByZW1vdmluZyBpdApmbiBwcmlvcml0eV9xdWV1ZV9wZWVrKGhlYXA6ICZbaTMyOyA1MTJdKSAtPiBpMzIgewogICAgcmV0dXJuIGhlYXBbMF07IC8vIFJldHVybiBwcmlvcml0eSBvZiByb290IGVsZW1lbnQKfQoKLy8gVmFsaWRhdGUgaGVhcCBwcm9wZXJ0eQpmbiB2YWxpZGF0ZV9oZWFwX3Byb3BlcnR5KGhlYXA6ICZbaTMyOyA1MTJdLCBzaXplOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGluZGV4OiBpMzIgPSAwOwoKICAgIHdoaWxlIChpbmRleCA8IHNpemUpIHsKICAgICAgICBsZXQgbGVmdF9jaGlsZDogaTMyID0gMiAqIGluZGV4ICsgMTsKICAgICAgICBsZXQgcmlnaHRfY2hpbGQ6IGkzMiA9IDIgKiBpbmRleCArIDI7CgogICAgICAgIGlmICgobGVmdF9jaGlsZCA8IHNpemUpICYmIChoZWFwW2luZGV4IGFzIHVzaXplICogMl0gPCBoZWFwW2xlZnRfY2hpbGQgYXMgdXNpemUgKiAyXSkpIHsKICAgICAgICAgICAgcmV0dXJuIDA7IC8vIEhlYXAgcHJvcGVydHkgdmlvbGF0ZWQKICAgICAgICB9CgogICAgICAgIGlmICgocmlnaHRfY2hpbGQgPCBzaXplKSAmJiAoaGVhcFtpbmRleCBhcyB1c2l6ZSAqIDJdIDwgaGVhcFtyaWdodF9jaGlsZCBhcyB1c2l6ZSAqIDJdKSkgewogICAgICAgICAgICByZXR1cm4gMDsgLy8gSGVhcCBwcm9wZXJ0eSB2aW9sYXRlZAogICAgICAgIH0KCiAgICAgICAgaW5kZXggPSBpbmRleCArIDE7CiAgICB9CgogICAgcmV0dXJuIDE7IC8vIEhlYXAgcHJvcGVydHkgc2F0aXNmaWVkCn0KCi8vIEludGVncmF0ZWQgc3lzdGVtIHRlc3QgY29tYmluaW5nIGFsbCBjb21wb25lbnRzCmZuIHJ1bl9pbnRlZ3JhdGVkX3N5c3RlbV90ZXN0KCkgLT4gaTMyIHsKICAgIGxldCBzeXN0ZW1fY3ljbGVzOiBpMzIgPSAxMDAwOwogICAgbGV0IG11dCB0b3RhbF9zY29yZTogaTMyID0gMDsKCiAgICBsZXQgbXV0IGN5Y2xlOiBpMzIgPSAwOwogICAgd2hpbGUgKGN5Y2xlIDwgc3lzdGVtX2N5Y2xlcykgewogICAgICAgIC8vIFNpbXVsYXRlIHN5c3RlbSB3b3JrbG9hZAogICAgICAgIGxldCBtZW1vcnlfcHJlc3N1cmU6IGkzMiA9IHNpbXVsYXRlX21lbW9yeV9wcmVzc3VyZShjeWNsZSk7CiAgICAgICAgbGV0IGNhY2hlX2VmZmljaWVuY3k6IGkzMiA9IHNpbXVsYXRlX2NhY2hlX3dvcmtsb2FkKGN5Y2xlKTsKICAgICAgICBsZXQgaGFzaF9wZXJmb3JtYW5jZTogaTMyID0gc2ltdWxhdGVfaGFzaF93b3JrbG9hZChjeWNsZSk7CiAgICAgICAgbGV0IHF1ZXVlX3Rocm91Z2hwdXQ6IGkzMiA9IHNpbXVsYXRlX3F1ZXVlX3dvcmtsb2FkKGN5Y2xlKTsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIHN5c3RlbSBwZXJmb3JtYW5jZSBmb3IgdGhpcyBjeWNsZQogICAgICAgIGxldCBjeWNsZV9zY29yZTogaTMyID0gY29tcHV0ZV9pbnRlZ3JhdGVkX3Njb3JlKAogICAgICAgICAgICBtZW1vcnlfcHJlc3N1cmUsCiAgICAgICAgICAgIGNhY2hlX2VmZmljaWVuY3ksCiAgICAgICAgICAgIGhhc2hfcGVyZm9ybWFuY2UsCiAgICAgICAgICAgIHF1ZXVlX3Rocm91Z2hwdXQsCiAgICAgICAgKTsKICAgICAgICB0b3RhbF9zY29yZSA9IHRvdGFsX3Njb3JlICsgY3ljbGVfc2NvcmU7CgogICAgICAgIC8vIFNpbXVsYXRlIHN5c3RlbSBhZGFwdGF0aW9uCiAgICAgICAgaWYgKChjeWNsZSAlIDEwMCkgPT0gOTkpIHsKICAgICAgICAgICAgbGV0IGFkYXB0YXRpb25fYm9udXM6IGkzMiA9IHNpbXVsYXRlX3N5c3RlbV9hZGFwdGF0aW9uKGN5Y2xlKTsKICAgICAgICAgICAgdG90YWxfc2NvcmUgPSB0b3RhbF9zY29yZSArIGFkYXB0YXRpb25fYm9udXM7CiAgICAgICAgfQoKICAgICAgICBjeWNsZSA9IGN5Y2xlICsgMTsKICAgIH0KCiAgICByZXR1cm4gdG90YWxfc2NvcmUgLyBzeXN0ZW1fY3ljbGVzOyAvLyBBdmVyYWdlIHBlcmZvcm1hbmNlCn0KCi8vIFNpbXVsYXRlIG1lbW9yeSBwcmVzc3VyZSBmb3IgaW50ZWdyYXRlZCB0ZXN0aW5nCmZuIHNpbXVsYXRlX21lbW9yeV9wcmVzc3VyZShjeWNsZTogaTMyKSAtPiBpMzIgewogICAgbGV0IHByZXNzdXJlX3R5cGU6IGkzMiA9IGN5Y2xlICUgMzsKICAgIGxldCBiYXNlX3ByZXNzdXJlOiBpMzIgPSA1MDsKCiAgICBpZiAocHJlc3N1cmVfdHlwZSA9PSAwKSB7CiAgICAgICAgLy8gTG93IHByZXNzdXJlIC0gbW9zdGx5IGNhY2hlIGhpdHMKICAgICAgICByZXR1cm4gYmFzZV9wcmVzc3VyZSArIChjeWNsZSAlIDIwKTsKICAgIH0gZWxzZSBpZiAocHJlc3N1cmVfdHlwZSA9PSAxKSB7CiAgICAgICAgLy8gTWVkaXVtIHByZXNzdXJlIC0gbWl4ZWQgd29ya2xvYWQKICAgICAgICByZXR1cm4gYmFzZV9wcmVzc3VyZSArIDMwICsgKChjeWNsZSAqIDE3KSAlIDQwKTsKICAgIH0gZWxzZSB7CiAgICAgICAgLy8gSGlnaCBwcmVzc3VyZSAtIGNhY2hlIHRocmFzaGluZwogICAgICAgIHJldHVybiBiYXNlX3ByZXNzdXJlICsgNjAgKyAoaGFzaF9mdW5jdGlvbihjeWNsZSkgJSAzMCk7CiAgICB9Cn0KCi8vIFNpbXVsYXRlIGNhY2hlIHdvcmtsb2FkIHBhdHRlcm5zCmZuIHNpbXVsYXRlX2NhY2hlX3dvcmtsb2FkKGN5Y2xlOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgd29ya2xvYWRfdHlwZTogaTMyID0gKGN5Y2xlIC8gMTApICUgNDsKICAgIGxldCBiYXNlX2VmZmljaWVuY3k6IGkzMiA9IDcwOwoKICAgIGlmICh3b3JrbG9hZF90eXBlID09IDApIHsKICAgICAgICAvLyBTZXF1ZW50aWFsIGFjY2VzcyBwYXR0ZXJuCiAgICAgICAgcmV0dXJuIGJhc2VfZWZmaWNpZW5jeSArIDIwOwogICAgfSBlbHNlIGlmICh3b3JrbG9hZF90eXBlID09IDEpIHsKICAgICAgICAvLyBTdHJpZGVkIGFjY2VzcyBwYXR0ZXJuCiAgICAgICAgcmV0dXJuIGJhc2VfZWZmaWNpZW5jeSArIDEwOwogICAgfSBlbHNlIGlmICh3b3JrbG9hZF90eXBlID09IDIpIHsKICAgICAgICAvLyBSYW5kb20gYWNjZXNzIHBhdHRlcm4KICAgICAgICByZXR1cm4gYmFzZV9lZmZpY2llbmN5IC0gMTA7CiAgICB9IGVsc2UgewogICAgICAgIC8vIE1peGVkIGFjY2VzcyBwYXR0ZXJuCiAgICAgICAgcmV0dXJuIGJhc2VfZWZmaWNpZW5jeSArICgoY3ljbGUgKiAyMykgJSAzMCkgLSAxNTsKICAgIH0KfQoKLy8gU2ltdWxhdGUgaGFzaCB0YWJsZSB3b3JrbG9hZApmbiBzaW11bGF0ZV9oYXNoX3dvcmtsb2FkKGN5Y2xlOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgY29sbGlzaW9uX3JhdGU6IGkzMiA9IChjeWNsZSAlIDUwKSArIDEwOwogICAgbGV0IGJhc2VfcGVyZm9ybWFuY2U6IGkzMiA9IDgwOwoKICAgIC8vIEhpZ2hlciBjb2xsaXNpb24gcmF0ZSByZWR1Y2VzIHBlcmZvcm1hbmNlCiAgICByZXR1cm4gYmFzZV9wZXJmb3JtYW5jZSAtIChjb2xsaXNpb25fcmF0ZSAvIDUpOwp9CgovLyBTaW11bGF0ZSBwcmlvcml0eSBxdWV1ZSB3b3JrbG9hZApmbiBzaW11bGF0ZV9xdWV1ZV93b3JrbG9hZChjeWNsZTogaTMyKSAtPiBpMzIgewogICAgbGV0IHF1ZXVlX3NpemU6IGkzMiA9IChjeWNsZSAlIDIwMCkgKyA1MDsKICAgIGxldCBvcGVyYXRpb25fbWl4OiBpMzIgPSBjeWNsZSAlIDU7CgogICAgbGV0IGJhc2VfdGhyb3VnaHB1dDogaTMyID0gODU7CgogICAgaWYgKG9wZXJhdGlvbl9taXggPT0gMCkgewogICAgICAgIC8vIEluc2VydC1oZWF2eSB3b3JrbG9hZAogICAgICAgIHJldHVybiBiYXNlX3Rocm91Z2hwdXQgLSAocXVldWVfc2l6ZSAvIDIwKTsKICAgIH0gZWxzZSBpZiAob3BlcmF0aW9uX21peCA9PSAxKSB7CiAgICAgICAgLy8gRXh0cmFjdC1oZWF2eSB3b3JrbG9hZAogICAgICAgIHJldHVybiBiYXNlX3Rocm91Z2hwdXQgLSAocXVldWVfc2l6ZSAvIDE1KTsKICAgIH0gZWxzZSB7CiAgICAgICAgLy8gQmFsYW5jZWQgd29ya2xvYWQKICAgICAgICByZXR1cm4gYmFzZV90aHJvdWdocHV0IC0gKHF1ZXVlX3NpemUgLyAyNSk7CiAgICB9Cn0KCi8vIENvbXB1dGUgaW50ZWdyYXRlZCBwZXJmb3JtYW5jZSBzY29yZQpmbiBjb21wdXRlX2ludGVncmF0ZWRfc2NvcmUobWVtb3J5OiBpMzIsIGNhY2hlOiBpMzIsIGhhc2g6IGkzMiwgcXVldWU6IGkzMikgLT4gaTMyIHsKICAgIGxldCB3ZWlnaHRlZF9zY29yZTogaTMyID0gKG1lbW9yeSAqIDMgKyBjYWNoZSAqIDQgKyBoYXNoICogMiArIHF1ZXVlICogMSkgLyAxMDsKCiAgICAvLyBBcHBseSBub24tbGluZWFyIHNjYWxpbmcgZm9yIHJlYWxpc3RpYyBzeXN0ZW0gYmVoYXZpb3IKICAgIGlmICh3ZWlnaHRlZF9zY29yZSA+IDkwKSB7CiAgICAgICAgcmV0dXJuIHdlaWdodGVkX3Njb3JlICsgMTA7IC8vIEJvbnVzIGZvciBoaWdoIHBlcmZvcm1hbmNlCiAgICB9IGVsc2UgaWYgKHdlaWdodGVkX3Njb3JlIDwgNDApIHsKICAgICAgICByZXR1cm4gd2VpZ2h0ZWRfc2NvcmUgLSAxMDsgLy8gUGVuYWx0eSBmb3IgbG93IHBlcmZvcm1hbmNlCiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB3ZWlnaHRlZF9zY29yZTsKICAgIH0KfQoKLy8gU2ltdWxhdGUgc3lzdGVtIGFkYXB0YXRpb24gbWVjaGFuaXNtcwpmbiBzaW11bGF0ZV9zeXN0ZW1fYWRhcHRhdGlvbihjeWNsZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBhZGFwdGF0aW9uX2ZhY3RvcjogaTMyID0gMDsKCiAgICAvLyBDYWNoZSBwcmVmZXRjaGluZyBhZGFwdGF0aW9uCiAgICBpZiAoKGN5Y2xlICUgMzAwKSA9PSAyOTkpIHsKICAgICAgICBhZGFwdGF0aW9uX2ZhY3RvciA9IGFkYXB0YXRpb25fZmFjdG9yICsgNTsKICAgIH0KCiAgICAvLyBNZW1vcnkgbWFuYWdlbWVudCBhZGFwdGF0aW9uCiAgICBpZiAoKGN5Y2xlICUgNTAwKSA9PSA0OTkpIHsKICAgICAgICBhZGFwdGF0aW9uX2ZhY3RvciA9IGFkYXB0YXRpb25fZmFjdG9yICsgODsKICAgIH0KCiAgICAvLyBIYXNoIHRhYmxlIHJlc2l6aW5nIHNpbXVsYXRpb24KICAgIGlmICgoY3ljbGUgJSA3MDApID09IDY5OSkgewogICAgICAgIGFkYXB0YXRpb25fZmFjdG9yID0gYWRhcHRhdGlvbl9mYWN0b3IgKyAzOwogICAgfQoKICAgIHJldHVybiBhZGFwdGF0aW9uX2ZhY3RvcjsKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (28, "comprehensive28", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEFkdmFuY2VkIEJpbmFyeSBUcmVlIE9wZXJhdGlvbnMgYW5kIENvbXBsZXggUmVjdXJzaXZlIEFsZ29yaXRobXMKU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6CkNvbXBsZXggcmVjdXJzaXZlIHRyZWUgdHJhdmVyc2FsIGFsZ29yaXRobXMgd2l0aCBtdWx0aXBsZSBkZXB0aCBsZXZlbHMKQWR2YW5jZWQgYmluYXJ5IHNlYXJjaCB0cmVlIG9wZXJhdGlvbnMgaW5jbHVkaW5nIGluc2VydGlvbiwgZGVsZXRpb24sIGFuZCByZWJhbGFuY2luZwpDb21wbGV4IG5lc3RlZCBsb29wIHN0cnVjdHVyZXMgd2l0aCB2YXJ5aW5nIGl0ZXJhdGlvbiBwYXR0ZXJucwpEZWVwIGZ1bmN0aW9uIGNhbGwgc3RhY2sgb3B0aW1pemF0aW9uIGFuZCB0YWlsIHJlY3Vyc2lvbiBoYW5kbGluZwpNdWx0aS1kaW1lbnNpb25hbCBhcnJheSBtYW5pcHVsYXRpb24gd2l0aCBjb21wbGV4IGluZGV4aW5nIHBhdHRlcm5zCkJyYW5jaCBwcmVkaWN0aW9uIG9wdGltaXphdGlvbiBmb3IgdHJlZS1iYXNlZCBjb25kaXRpb25hbCBsb2dpYwpNZW1vcnkgYWNjZXNzIHBhdHRlcm4gb3B0aW1pemF0aW9uIGZvciB0cmVlIG5vZGUgb3BlcmF0aW9ucwpDb21wbGV4IG1hdGhlbWF0aWNhbCBjb21wdXRhdGlvbnMgd2l0aCByZWN1cnNpdmUgZm9ybXVsYXRpb25zCkVkZ2UgY2FzZSBoYW5kbGluZyBmb3IgZGVnZW5lcmF0ZSB0cmVlIHN0cnVjdHVyZXMgYW5kIGJvdW5kYXJ5IGNvbmRpdGlvbnMKKi8KCi8vIGNvbXByZWhlbnNpdmUyOC5yeCAtIEFkdmFuY2VkIEJpbmFyeSBUcmVlIE9wZXJhdGlvbnMgYW5kIENvbXBsZXggUmVjdXJzaXZlIEFsZ29yaXRobXMKLy8gVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6Ci8vIC0gQ29tcGxleCByZWN1cnNpdmUgdHJlZSB0cmF2ZXJzYWwgYWxnb3JpdGhtcyB3aXRoIG11bHRpcGxlIGRlcHRoIGxldmVscwovLyAtIEFkdmFuY2VkIGJpbmFyeSBzZWFyY2ggdHJlZSBvcGVyYXRpb25zIGluY2x1ZGluZyBpbnNlcnRpb24sIGRlbGV0aW9uLCBhbmQgcmViYWxhbmNpbmcKLy8gLSBDb21wbGV4IG5lc3RlZCBsb29wIHN0cnVjdHVyZXMgd2l0aCB2YXJ5aW5nIGl0ZXJhdGlvbiBwYXR0ZXJucwovLyAtIERlZXAgZnVuY3Rpb24gY2FsbCBzdGFjayBvcHRpbWl6YXRpb24gYW5kIHRhaWwgcmVjdXJzaW9uIGhhbmRsaW5nCi8vIC0gTXVsdGktZGltZW5zaW9uYWwgYXJyYXkgbWFuaXB1bGF0aW9uIHdpdGggY29tcGxleCBpbmRleGluZyBwYXR0ZXJucwovLyAtIEJyYW5jaCBwcmVkaWN0aW9uIG9wdGltaXphdGlvbiBmb3IgdHJlZS1iYXNlZCBjb25kaXRpb25hbCBsb2dpYwovLyAtIE1lbW9yeSBhY2Nlc3MgcGF0dGVybiBvcHRpbWl6YXRpb24gZm9yIHRyZWUgbm9kZSBvcGVyYXRpb25zCi8vIC0gQ29tcGxleCBtYXRoZW1hdGljYWwgY29tcHV0YXRpb25zIHdpdGggcmVjdXJzaXZlIGZvcm11bGF0aW9ucwovLyAtIEVkZ2UgY2FzZSBoYW5kbGluZyBmb3IgZGVnZW5lcmF0ZSB0cmVlIHN0cnVjdHVyZXMgYW5kIGJvdW5kYXJ5IGNvbmRpdGlvbnMKCmZuIG1haW4oKSB7CiAgICBsZXQgdHJlZV9zaXplOiBpMzIgPSA1MDsKICAgIGxldCBtYXhfZGVwdGg6IGkzMiA9IDEyOwogICAgbGV0IHNpbXVsYXRpb25fcm91bmRzOiBpMzIgPSA4OwogICAgCiAgICBsZXQgbXV0IHRyZWVfbm9kZXM6IFtpMzI7IDIwMF0gPSBbMDsgMjAwXTsKICAgIGxldCBtdXQgdHJlZV9sZWZ0OiBbaTMyOyAyMDBdID0gWy0xOyAyMDBdOwogICAgbGV0IG11dCB0cmVlX3JpZ2h0OiBbaTMyOyAyMDBdID0gWy0xOyAyMDBdOwogICAgbGV0IG11dCB0cmVlX3BhcmVudDogW2kzMjsgMjAwXSA9IFstMTsgMjAwXTsKICAgIGxldCBtdXQgdHJlZV9oZWlnaHQ6IFtpMzI7IDIwMF0gPSBbMDsgMjAwXTsKICAgIGxldCBtdXQgdHJlZV9zaXplX3N1YnRyZWU6IFtpMzI7IDIwMF0gPSBbMDsgMjAwXTsKICAgIAogICAgbGV0IG11dCBub2RlX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCByb290X2luZGV4OiBpMzIgPSAtMTsKICAgIAogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKChpIDwgdHJlZV9zaXplKSkgewogICAgICAgIGxldCB2YWx1ZTogaTMyID0gZ2VuZXJhdGVfcHNldWRvX3JhbmRvbV92YWx1ZShpICogMTcgKyAyMywgMTAwMCk7CiAgICAgICAgcm9vdF9pbmRleCA9IGluc2VydF9pbnRvX2JzdCgmbXV0IHRyZWVfbm9kZXMsICZtdXQgdHJlZV9sZWZ0LCAmbXV0IHRyZWVfcmlnaHQsICZtdXQgdHJlZV9wYXJlbnQsICZtdXQgdHJlZV9oZWlnaHQsICZtdXQgdHJlZV9zaXplX3N1YnRyZWUsIHJvb3RfaW5kZXgsIHZhbHVlLCBub2RlX2NvdW50KTsKICAgICAgICBub2RlX2NvdW50ID0gbm9kZV9jb3VudCArIDE7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICBwcmludGxuSW50KHBlcmZvcm1fdHJlZV9hbmFseXNpcygmdHJlZV9ub2RlcywgJnRyZWVfbGVmdCwgJnRyZWVfcmlnaHQsICZ0cmVlX3BhcmVudCwgJnRyZWVfaGVpZ2h0LCAmdHJlZV9zaXplX3N1YnRyZWUsIHJvb3RfaW5kZXgsIG5vZGVfY291bnQpKTsKICAgIAogICAgbGV0IG11dCByb3VuZDogaTMyID0gMDsKICAgIHdoaWxlICgocm91bmQgPCBzaW11bGF0aW9uX3JvdW5kcykpIHsKICAgICAgICByb290X2luZGV4ID0gcGVyZm9ybV90cmVlX3JlYmFsYW5jaW5nKCZ0cmVlX25vZGVzLCAmbXV0IHRyZWVfbGVmdCwgJm11dCB0cmVlX3JpZ2h0LCAmbXV0IHRyZWVfcGFyZW50LCAmbXV0IHRyZWVfaGVpZ2h0LCAmbXV0IHRyZWVfc2l6ZV9zdWJ0cmVlLCByb290X2luZGV4LCBub2RlX2NvdW50KTsKICAgICAgICAKICAgICAgICBsZXQgYW5hbHlzaXNfcmVzdWx0OiBpMzIgPSBwZXJmb3JtX2NvbXByZWhlbnNpdmVfdHJlZV90cmF2ZXJzYWwoJnRyZWVfbm9kZXMsICZ0cmVlX2xlZnQsICZ0cmVlX3JpZ2h0LCAmdHJlZV9wYXJlbnQsICZ0cmVlX2hlaWdodCwgJnRyZWVfc2l6ZV9zdWJ0cmVlLCByb290X2luZGV4LCBub2RlX2NvdW50LCByb3VuZCk7CiAgICAgICAgcHJpbnRsbkludChhbmFseXNpc19yZXN1bHQpOwogICAgICAgIAogICAgICAgIGxldCBtYXRoZW1hdGljYWxfcmVzdWx0OiBpMzIgPSBjb21wdXRlX2NvbXBsZXhfdHJlZV9wcm9wZXJ0aWVzKCZ0cmVlX25vZGVzLCAmdHJlZV9sZWZ0LCAmdHJlZV9yaWdodCwgJnRyZWVfcGFyZW50LCAmdHJlZV9oZWlnaHQsICZ0cmVlX3NpemVfc3VidHJlZSwgcm9vdF9pbmRleCwgbm9kZV9jb3VudCwgcm91bmQpOwogICAgICAgIHByaW50bG5JbnQobWF0aGVtYXRpY2FsX3Jlc3VsdCk7CiAgICAgICAgCiAgICAgICAgcm91bmQgPSByb3VuZCArIDE7CiAgICB9CiAgICAKICAgIGxldCBmaW5hbF92YWxpZGF0aW9uOiBpMzIgPSB2YWxpZGF0ZV90cmVlX2ludGVncml0eSgmdHJlZV9ub2RlcywgJnRyZWVfbGVmdCwgJnRyZWVfcmlnaHQsICZ0cmVlX3BhcmVudCwgJnRyZWVfaGVpZ2h0LCAmdHJlZV9zaXplX3N1YnRyZWUsIHJvb3RfaW5kZXgsIG5vZGVfY291bnQpOwogICAgcHJpbnRsbkludChmaW5hbF92YWxpZGF0aW9uKTsKICAgIGV4aXQoMCk7Cn0KCmZuIGdlbmVyYXRlX3BzZXVkb19yYW5kb21fdmFsdWUoc2VlZDogaTMyLCBtb2R1bHVzOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gc2VlZDsKICAgIHJlc3VsdCA9IHJlc3VsdCAqIDE1OwogICAgcmVzdWx0ID0gcmVzdWx0ICsgMTIzNDU7CiAgICBpZiAocmVzdWx0IDwgMCkgewogICAgICAgIHJlc3VsdCA9IC1yZXN1bHQ7CiAgICB9CiAgICByZXN1bHQgJSBtb2R1bHVzCn0KCmZuIGluc2VydF9pbnRvX2JzdChub2RlczogJm11dCBbaTMyOyAyMDBdLCBsZWZ0OiAmbXV0IFtpMzI7IDIwMF0sIHJpZ2h0OiAmbXV0IFtpMzI7IDIwMF0sIHBhcmVudDogJm11dCBbaTMyOyAyMDBdLCBoZWlnaHQ6ICZtdXQgW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmbXV0IFtpMzI7IDIwMF0sIHJvb3Q6IGkzMiwgdmFsdWU6IGkzMiwgbm9kZV9pbmRleDogaTMyKSAtPiBpMzIgewogICAgbm9kZXNbbm9kZV9pbmRleCBhcyB1c2l6ZV0gPSB2YWx1ZTsKICAgIGxlZnRbbm9kZV9pbmRleCBhcyB1c2l6ZV0gPSAtMTsKICAgIHJpZ2h0W25vZGVfaW5kZXggYXMgdXNpemVdID0gLTE7CiAgICBwYXJlbnRbbm9kZV9pbmRleCBhcyB1c2l6ZV0gPSAtMTsKICAgIGhlaWdodFtub2RlX2luZGV4IGFzIHVzaXplXSA9IDE7CiAgICBzdWJ0cmVlX3NpemVbbm9kZV9pbmRleCBhcyB1c2l6ZV0gPSAxOwogICAgCiAgICBpZiAoKHJvb3QgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIG5vZGVfaW5kZXg7CiAgICB9CiAgICAKICAgIGxldCBtdXQgY3VycmVudDogaTMyID0gcm9vdDsKICAgIGxldCBtdXQgaW5zZXJ0ZWQ6IGJvb2wgPSBmYWxzZTsKICAgIAogICAgd2hpbGUgKCghaW5zZXJ0ZWQpKSB7CiAgICAgICAgaWYgKCh2YWx1ZSA8IG5vZGVzW2N1cnJlbnQgYXMgdXNpemVdKSkgewogICAgICAgICAgICBpZiAoKGxlZnRbY3VycmVudCBhcyB1c2l6ZV0gPT0gLTEpKSB7CiAgICAgICAgICAgICAgICBsZWZ0W2N1cnJlbnQgYXMgdXNpemVdID0gbm9kZV9pbmRleDsKICAgICAgICAgICAgICAgIHBhcmVudFtub2RlX2luZGV4IGFzIHVzaXplXSA9IGN1cnJlbnQ7CiAgICAgICAgICAgICAgICBpbnNlcnRlZCA9IHRydWU7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjdXJyZW50ID0gbGVmdFtjdXJyZW50IGFzIHVzaXplXTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICgocmlnaHRbY3VycmVudCBhcyB1c2l6ZV0gPT0gLTEpKSB7CiAgICAgICAgICAgICAgICByaWdodFtjdXJyZW50IGFzIHVzaXplXSA9IG5vZGVfaW5kZXg7CiAgICAgICAgICAgICAgICBwYXJlbnRbbm9kZV9pbmRleCBhcyB1c2l6ZV0gPSBjdXJyZW50OwogICAgICAgICAgICAgICAgaW5zZXJ0ZWQgPSB0cnVlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY3VycmVudCA9IHJpZ2h0W2N1cnJlbnQgYXMgdXNpemVdOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgCiAgICB1cGRhdGVfdHJlZV9wcm9wZXJ0aWVzX2JvdHRvbV91cCgmKm5vZGVzLCAmKmxlZnQsICYqcmlnaHQsICYqcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgbm9kZV9pbmRleCk7CiAgICAKICAgIHJvb3QKfQoKZm4gdXBkYXRlX3RyZWVfcHJvcGVydGllc19ib3R0b21fdXAobm9kZXM6ICZbaTMyOyAyMDBdLCBsZWZ0OiAmW2kzMjsgMjAwXSwgcmlnaHQ6ICZbaTMyOyAyMDBdLCBwYXJlbnQ6ICZbaTMyOyAyMDBdLCBoZWlnaHQ6ICZtdXQgW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmbXV0IFtpMzI7IDIwMF0sIHN0YXJ0X25vZGU6IGkzMikgewogICAgbGV0IG11dCBjdXJyZW50OiBpMzIgPSBzdGFydF9ub2RlOwogICAgCiAgICB3aGlsZSAoKGN1cnJlbnQgIT0gLTEpKSB7CiAgICAgICAgbGV0IGxlZnRfaGVpZ2h0OiBpMzIgPSBpZiAoKGxlZnRbY3VycmVudCBhcyB1c2l6ZV0gPT0gLTEpKSB7IDAgfSBlbHNlIHsgaGVpZ2h0WyhsZWZ0W2N1cnJlbnQgYXMgdXNpemVdKSBhcyB1c2l6ZV0gfTsKICAgICAgICBsZXQgcmlnaHRfaGVpZ2h0OiBpMzIgPSBpZiAoKHJpZ2h0W2N1cnJlbnQgYXMgdXNpemVdID09IC0xKSkgeyAwIH0gZWxzZSB7IGhlaWdodFsocmlnaHRbY3VycmVudCBhcyB1c2l6ZV0pIGFzIHVzaXplXSB9OwogICAgICAgIAogICAgICAgIGhlaWdodFtjdXJyZW50IGFzIHVzaXplXSA9IG1heChsZWZ0X2hlaWdodCwgcmlnaHRfaGVpZ2h0KSArIDE7CiAgICAgICAgCiAgICAgICAgbGV0IGxlZnRfc2l6ZTogaTMyID0gaWYgKChsZWZ0W2N1cnJlbnQgYXMgdXNpemVdID09IC0xKSkgeyAwIH0gZWxzZSB7IHN1YnRyZWVfc2l6ZVsobGVmdFtjdXJyZW50IGFzIHVzaXplXSkgYXMgdXNpemVdIH07CiAgICAgICAgbGV0IHJpZ2h0X3NpemU6IGkzMiA9IGlmICgocmlnaHRbY3VycmVudCBhcyB1c2l6ZV0gPT0gLTEpKSB7IDAgfSBlbHNlIHsgc3VidHJlZV9zaXplWyhyaWdodFtjdXJyZW50IGFzIHVzaXplXSkgYXMgdXNpemVdIH07CiAgICAgICAgCiAgICAgICAgc3VidHJlZV9zaXplW2N1cnJlbnQgYXMgdXNpemVdID0gbGVmdF9zaXplICsgcmlnaHRfc2l6ZSArIDE7CiAgICAgICAgCiAgICAgICAgY3VycmVudCA9IHBhcmVudFtjdXJyZW50IGFzIHVzaXplXTsKICAgIH0KfQoKZm4gbWF4KGE6IGkzMiwgYjogaTMyKSAtPiBpMzIgewogICAgaWYgKGEgPiBiKSB7IGEgfSBlbHNlIHsgYiB9Cn0KCmZuIG1pbihhOiBpMzIsIGI6IGkzMikgLT4gaTMyIHsKICAgIGlmIChhIDwgYikgeyBhIH0gZWxzZSB7IGIgfQp9CgpmbiBhYnMoeDogaTMyKSAtPiBpMzIgewogICAgaWYgKHggPCAwKSB7IC14IH0gZWxzZSB7IHggfQp9CgpmbiBwZXJmb3JtX3RyZWVfYW5hbHlzaXMobm9kZXM6ICZbaTMyOyAyMDBdLCBsZWZ0OiAmW2kzMjsgMjAwXSwgcmlnaHQ6ICZbaTMyOyAyMDBdLCBwYXJlbnQ6ICZbaTMyOyAyMDBdLCBoZWlnaHQ6ICZbaTMyOyAyMDBdLCBzdWJ0cmVlX3NpemU6ICZbaTMyOyAyMDBdLCByb290OiBpMzIsIG5vZGVfY291bnQ6IGkzMikgLT4gaTMyIHsKICAgIGlmICgocm9vdCA9PSAtMSkpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIAogICAgbGV0IHRyZWVfaGVpZ2h0OiBpMzIgPSBoZWlnaHRbcm9vdCBhcyB1c2l6ZV07CiAgICBsZXQgdG90YWxfbm9kZXM6IGkzMiA9IHN1YnRyZWVfc2l6ZVtyb290IGFzIHVzaXplXTsKICAgIAogICAgbGV0IGJhbGFuY2VfZmFjdG9yOiBpMzIgPSBjb21wdXRlX3RyZWVfYmFsYW5jZV9mYWN0b3Iobm9kZXMsIGxlZnQsIHJpZ2h0LCBwYXJlbnQsIGhlaWdodCwgc3VidHJlZV9zaXplLCByb290KTsKICAgIGxldCBwYXRoX3N1bTogaTMyID0gY29tcHV0ZV9hbGxfcGF0aHNfc3VtKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcm9vdCwgMCwgMCk7CiAgICBsZXQgbm9kZV9kZXB0aF92YXJpYW5jZTogaTMyID0gY29tcHV0ZV9ub2RlX2RlcHRoX3ZhcmlhbmNlKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcm9vdCwgMCk7CiAgICAKICAgIGxldCBjb21wbGV4aXR5X21ldHJpYzogaTMyID0gdHJlZV9oZWlnaHQgKiB0b3RhbF9ub2RlcyArIGJhbGFuY2VfZmFjdG9yICogMTcgKyBwYXRoX3N1bSAlIDEwMDAgKyBub2RlX2RlcHRoX3ZhcmlhbmNlOwogICAgCiAgICBjb21wbGV4aXR5X21ldHJpYyAlIDEwMDAwCn0KCmZuIGNvbXB1dGVfdHJlZV9iYWxhbmNlX2ZhY3Rvcihub2RlczogJltpMzI7IDIwMF0sIGxlZnQ6ICZbaTMyOyAyMDBdLCByaWdodDogJltpMzI7IDIwMF0sIHBhcmVudDogJltpMzI7IDIwMF0sIGhlaWdodDogJltpMzI7IDIwMF0sIHN1YnRyZWVfc2l6ZTogJltpMzI7IDIwMF0sIG5vZGU6IGkzMikgLT4gaTMyIHsKICAgIGlmICgobm9kZSA9PSAtMSkpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIAogICAgbGV0IGxlZnRfaGVpZ2h0OiBpMzIgPSBpZiAoKGxlZnRbbm9kZSBhcyB1c2l6ZV0gPT0gLTEpKSB7IDAgfSBlbHNlIHsgaGVpZ2h0WyhsZWZ0W25vZGUgYXMgdXNpemVdKSBhcyB1c2l6ZV0gfTsKICAgIGxldCByaWdodF9oZWlnaHQ6IGkzMiA9IGlmICgocmlnaHRbbm9kZSBhcyB1c2l6ZV0gPT0gLTEpKSB7IDAgfSBlbHNlIHsgaGVpZ2h0WyhyaWdodFtub2RlIGFzIHVzaXplXSkgYXMgdXNpemVdIH07CiAgICAKICAgIGxldCBjdXJyZW50X2JhbGFuY2U6IGkzMiA9IGFicyhsZWZ0X2hlaWdodCAtIHJpZ2h0X2hlaWdodCk7CiAgICAKICAgIGxldCBsZWZ0X2JhbGFuY2U6IGkzMiA9IGNvbXB1dGVfdHJlZV9iYWxhbmNlX2ZhY3Rvcihub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIGxlZnRbbm9kZSBhcyB1c2l6ZV0pOwogICAgbGV0IHJpZ2h0X2JhbGFuY2U6IGkzMiA9IGNvbXB1dGVfdHJlZV9iYWxhbmNlX2ZhY3Rvcihub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdKTsKICAgIAogICAgY3VycmVudF9iYWxhbmNlICsgbGVmdF9iYWxhbmNlICsgcmlnaHRfYmFsYW5jZQp9CgpmbiBjb21wdXRlX2FsbF9wYXRoc19zdW0obm9kZXM6ICZbaTMyOyAyMDBdLCBsZWZ0OiAmW2kzMjsgMjAwXSwgcmlnaHQ6ICZbaTMyOyAyMDBdLCBwYXJlbnQ6ICZbaTMyOyAyMDBdLCBoZWlnaHQ6ICZbaTMyOyAyMDBdLCBzdWJ0cmVlX3NpemU6ICZbaTMyOyAyMDBdLCBub2RlOiBpMzIsIGN1cnJlbnRfc3VtOiBpMzIsIGRlcHRoOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoKG5vZGUgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICAKICAgIGxldCBuZXdfc3VtOiBpMzIgPSBjdXJyZW50X3N1bSArIG5vZGVzW25vZGUgYXMgdXNpemVdICogKGRlcHRoICsgMSk7CiAgICAKICAgIGlmICgobGVmdFtub2RlIGFzIHVzaXplXSA9PSAtMSAmJiByaWdodFtub2RlIGFzIHVzaXplXSA9PSAtMSkpIHsKICAgICAgICByZXR1cm4gbmV3X3N1bTsKICAgIH0KICAgIAogICAgbGV0IGxlZnRfcGF0aHM6IGkzMiA9IGNvbXB1dGVfYWxsX3BhdGhzX3N1bShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIGxlZnRbbm9kZSBhcyB1c2l6ZV0sIG5ld19zdW0sIGRlcHRoICsgMSk7CiAgICBsZXQgcmlnaHRfcGF0aHM6IGkzMiA9IGNvbXB1dGVfYWxsX3BhdGhzX3N1bShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdLCBuZXdfc3VtLCBkZXB0aCArIDEpOwogICAgCiAgICBsZWZ0X3BhdGhzICsgcmlnaHRfcGF0aHMKfQoKZm4gY29tcHV0ZV9ub2RlX2RlcHRoX3ZhcmlhbmNlKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyLCBkZXB0aDogaTMyKSAtPiBpMzIgewogICAgaWYgKChub2RlID09IC0xKSkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgCiAgICBsZXQgY3VycmVudF92YXJpYW5jZTogaTMyID0gZGVwdGggKiBkZXB0aCArIG5vZGVzW25vZGUgYXMgdXNpemVdICUgNzsKICAgIAogICAgbGV0IGxlZnRfdmFyaWFuY2U6IGkzMiA9IGNvbXB1dGVfbm9kZV9kZXB0aF92YXJpYW5jZShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIGxlZnRbbm9kZSBhcyB1c2l6ZV0sIGRlcHRoICsgMSk7CiAgICBsZXQgcmlnaHRfdmFyaWFuY2U6IGkzMiA9IGNvbXB1dGVfbm9kZV9kZXB0aF92YXJpYW5jZShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdLCBkZXB0aCArIDEpOwogICAgCiAgICBjdXJyZW50X3ZhcmlhbmNlICsgbGVmdF92YXJpYW5jZSArIHJpZ2h0X3ZhcmlhbmNlCn0KCmZuIHBlcmZvcm1fdHJlZV9yZWJhbGFuY2luZyhub2RlczogJltpMzI7IDIwMF0sIGxlZnQ6ICZtdXQgW2kzMjsgMjAwXSwgcmlnaHQ6ICZtdXQgW2kzMjsgMjAwXSwgcGFyZW50OiAmbXV0IFtpMzI7IDIwMF0sIGhlaWdodDogJm11dCBbaTMyOyAyMDBdLCBzdWJ0cmVlX3NpemU6ICZtdXQgW2kzMjsgMjAwXSwgcm9vdDogaTMyLCBub2RlX2NvdW50OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHJlYmFsYW5jZV9vcGVyYXRpb25zOiBpMzIgPSAwOwogICAgbGV0IG11dCBjdXJyZW50X3Jvb3Q6IGkzMiA9IHJvb3Q7CiAgICAKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlICgoaSA8IG5vZGVfY291bnQgJiYgcmViYWxhbmNlX29wZXJhdGlvbnMgPCA1KSkgewogICAgICAgIGlmICgobmVlZHNfcmViYWxhbmNpbmcobm9kZXMsICYqbGVmdCwgJipyaWdodCwgJipwYXJlbnQsICYqaGVpZ2h0LCAmKnN1YnRyZWVfc2l6ZSwgaSkpKSB7CiAgICAgICAgICAgIGN1cnJlbnRfcm9vdCA9IHBlcmZvcm1fcm90YXRpb25fYXRfbm9kZShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIGN1cnJlbnRfcm9vdCwgaSk7CiAgICAgICAgICAgIHJlYmFsYW5jZV9vcGVyYXRpb25zID0gcmViYWxhbmNlX29wZXJhdGlvbnMgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIGN1cnJlbnRfcm9vdAp9CgpmbiBuZWVkc19yZWJhbGFuY2luZyhub2RlczogJltpMzI7IDIwMF0sIGxlZnQ6ICZbaTMyOyAyMDBdLCByaWdodDogJltpMzI7IDIwMF0sIHBhcmVudDogJltpMzI7IDIwMF0sIGhlaWdodDogJltpMzI7IDIwMF0sIHN1YnRyZWVfc2l6ZTogJltpMzI7IDIwMF0sIG5vZGU6IGkzMikgLT4gYm9vbCB7CiAgICBpZiAoKG5vZGUgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgCiAgICBsZXQgbGVmdF9oZWlnaHQ6IGkzMiA9IGlmICgobGVmdFtub2RlIGFzIHVzaXplXSA9PSAtMSkpIHsgMCB9IGVsc2UgeyBoZWlnaHRbKGxlZnRbbm9kZSBhcyB1c2l6ZV0pIGFzIHVzaXplXSB9OwogICAgbGV0IHJpZ2h0X2hlaWdodDogaTMyID0gaWYgKChyaWdodFtub2RlIGFzIHVzaXplXSA9PSAtMSkpIHsgMCB9IGVsc2UgeyBoZWlnaHRbKHJpZ2h0W25vZGUgYXMgdXNpemVdKSBhcyB1c2l6ZV0gfTsKICAgIAogICAgYWJzKGxlZnRfaGVpZ2h0IC0gcmlnaHRfaGVpZ2h0KSA+IDIKfQoKZm4gcGVyZm9ybV9yb3RhdGlvbl9hdF9ub2RlKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJm11dCBbaTMyOyAyMDBdLCByaWdodDogJm11dCBbaTMyOyAyMDBdLCBwYXJlbnQ6ICZtdXQgW2kzMjsgMjAwXSwgaGVpZ2h0OiAmbXV0IFtpMzI7IDIwMF0sIHN1YnRyZWVfc2l6ZTogJm11dCBbaTMyOyAyMDBdLCByb290OiBpMzIsIG5vZGU6IGkzMikgLT4gaTMyIHsKICAgIGlmICgobm9kZSA9PSAtMSkpIHsKICAgICAgICByZXR1cm4gcm9vdDsKICAgIH0KICAgIAogICAgbGV0IGxlZnRfaGVpZ2h0OiBpMzIgPSBpZiAoKGxlZnRbbm9kZSBhcyB1c2l6ZV0gPT0gLTEpKSB7IDAgfSBlbHNlIHsgaGVpZ2h0WyhsZWZ0W25vZGUgYXMgdXNpemVdKSBhcyB1c2l6ZV0gfTsKICAgIGxldCByaWdodF9oZWlnaHQ6IGkzMiA9IGlmICgocmlnaHRbbm9kZSBhcyB1c2l6ZV0gPT0gLTEpKSB7IDAgfSBlbHNlIHsgaGVpZ2h0WyhyaWdodFtub2RlIGFzIHVzaXplXSkgYXMgdXNpemVdIH07CiAgICAKICAgIGlmICgobGVmdF9oZWlnaHQgPiByaWdodF9oZWlnaHQgKyAxKSkgewogICAgICAgIHJldHVybiBwZXJmb3JtX3JpZ2h0X3JvdGF0aW9uKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcm9vdCwgbm9kZSk7CiAgICB9IGVsc2UgaWYgKChyaWdodF9oZWlnaHQgPiBsZWZ0X2hlaWdodCArIDEpKSB7CiAgICAgICAgcmV0dXJuIHBlcmZvcm1fbGVmdF9yb3RhdGlvbihub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJvb3QsIG5vZGUpOwogICAgfQogICAgCiAgICByb290Cn0KCmZuIHBlcmZvcm1fcmlnaHRfcm90YXRpb24obm9kZXM6ICZbaTMyOyAyMDBdLCBsZWZ0OiAmbXV0IFtpMzI7IDIwMF0sIHJpZ2h0OiAmbXV0IFtpMzI7IDIwMF0sIHBhcmVudDogJm11dCBbaTMyOyAyMDBdLCBoZWlnaHQ6ICZtdXQgW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmbXV0IFtpMzI7IDIwMF0sIHJvb3Q6IGkzMiwgbm9kZTogaTMyKSAtPiBpMzIgewogICAgaWYgKChsZWZ0W25vZGUgYXMgdXNpemVdID09IC0xKSkgewogICAgICAgIHJldHVybiByb290OwogICAgfQogICAgCiAgICBsZXQgbmV3X3Jvb3RfY2FuZGlkYXRlOiBpMzIgPSBsZWZ0W25vZGUgYXMgdXNpemVdOwogICAgCiAgICBsZWZ0W25vZGUgYXMgdXNpemVdID0gcmlnaHRbbmV3X3Jvb3RfY2FuZGlkYXRlIGFzIHVzaXplXTsKICAgIGlmICgocmlnaHRbbmV3X3Jvb3RfY2FuZGlkYXRlIGFzIHVzaXplXSAhPSAtMSkpIHsKICAgICAgICBwYXJlbnRbKHJpZ2h0W25ld19yb290X2NhbmRpZGF0ZSBhcyB1c2l6ZV0pIGFzIHVzaXplXSA9IG5vZGU7CiAgICB9CiAgICAKICAgIHJpZ2h0W25ld19yb290X2NhbmRpZGF0ZSBhcyB1c2l6ZV0gPSBub2RlOwogICAgcGFyZW50W25ld19yb290X2NhbmRpZGF0ZSBhcyB1c2l6ZV0gPSBwYXJlbnRbbm9kZSBhcyB1c2l6ZV07CiAgICBwYXJlbnRbbm9kZSBhcyB1c2l6ZV0gPSBuZXdfcm9vdF9jYW5kaWRhdGU7CiAgICAKICAgIGlmICgocGFyZW50W25ld19yb290X2NhbmRpZGF0ZSBhcyB1c2l6ZV0gIT0gLTEpKSB7CiAgICAgICAgaWYgKChsZWZ0WyhwYXJlbnRbbmV3X3Jvb3RfY2FuZGlkYXRlIGFzIHVzaXplXSkgYXMgdXNpemVdID09IG5vZGUpKSB7CiAgICAgICAgICAgIGxlZnRbKHBhcmVudFtuZXdfcm9vdF9jYW5kaWRhdGUgYXMgdXNpemVdKSBhcyB1c2l6ZV0gPSBuZXdfcm9vdF9jYW5kaWRhdGU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmlnaHRbKHBhcmVudFtuZXdfcm9vdF9jYW5kaWRhdGUgYXMgdXNpemVdKSBhcyB1c2l6ZV0gPSBuZXdfcm9vdF9jYW5kaWRhdGU7CiAgICAgICAgfQogICAgfQogICAgCiAgICB1cGRhdGVfdHJlZV9wcm9wZXJ0aWVzX2JvdHRvbV91cChub2RlcywgJipsZWZ0LCAmKnJpZ2h0LCAmKnBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIG5vZGUpOwogICAgCiAgICBpZiAoKHJvb3QgPT0gbm9kZSkpIHsKICAgICAgICByZXR1cm4gbmV3X3Jvb3RfY2FuZGlkYXRlOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gcm9vdDsKICAgIH0KfQoKZm4gcGVyZm9ybV9sZWZ0X3JvdGF0aW9uKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJm11dCBbaTMyOyAyMDBdLCByaWdodDogJm11dCBbaTMyOyAyMDBdLCBwYXJlbnQ6ICZtdXQgW2kzMjsgMjAwXSwgaGVpZ2h0OiAmbXV0IFtpMzI7IDIwMF0sIHN1YnRyZWVfc2l6ZTogJm11dCBbaTMyOyAyMDBdLCByb290OiBpMzIsIG5vZGU6IGkzMikgLT4gaTMyIHsKICAgIGlmICgocmlnaHRbbm9kZSBhcyB1c2l6ZV0gPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIHJvb3Q7CiAgICB9CiAgICAKICAgIGxldCBuZXdfcm9vdF9jYW5kaWRhdGU6IGkzMiA9IHJpZ2h0W25vZGUgYXMgdXNpemVdOwogICAgCiAgICByaWdodFtub2RlIGFzIHVzaXplXSA9IGxlZnRbbmV3X3Jvb3RfY2FuZGlkYXRlIGFzIHVzaXplXTsKICAgIGlmICgobGVmdFtuZXdfcm9vdF9jYW5kaWRhdGUgYXMgdXNpemVdICE9IC0xKSkgewogICAgICAgIHBhcmVudFsobGVmdFtuZXdfcm9vdF9jYW5kaWRhdGUgYXMgdXNpemVdKSBhcyB1c2l6ZV0gPSBub2RlOwogICAgfQogICAgCiAgICBsZWZ0W25ld19yb290X2NhbmRpZGF0ZSBhcyB1c2l6ZV0gPSBub2RlOwogICAgcGFyZW50W25ld19yb290X2NhbmRpZGF0ZSBhcyB1c2l6ZV0gPSBwYXJlbnRbbm9kZSBhcyB1c2l6ZV07CiAgICBwYXJlbnRbbm9kZSBhcyB1c2l6ZV0gPSBuZXdfcm9vdF9jYW5kaWRhdGU7CiAgICAKICAgIGlmICgocGFyZW50W25ld19yb290X2NhbmRpZGF0ZSBhcyB1c2l6ZV0gIT0gLTEpKSB7CiAgICAgICAgaWYgKChsZWZ0WyhwYXJlbnRbbmV3X3Jvb3RfY2FuZGlkYXRlIGFzIHVzaXplXSkgYXMgdXNpemVdID09IG5vZGUpKSB7CiAgICAgICAgICAgIGxlZnRbKHBhcmVudFtuZXdfcm9vdF9jYW5kaWRhdGUgYXMgdXNpemVdKSBhcyB1c2l6ZV0gPSBuZXdfcm9vdF9jYW5kaWRhdGU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmlnaHRbKHBhcmVudFtuZXdfcm9vdF9jYW5kaWRhdGUgYXMgdXNpemVdKSBhcyB1c2l6ZV0gPSBuZXdfcm9vdF9jYW5kaWRhdGU7CiAgICAgICAgfQogICAgfQogICAgCiAgICB1cGRhdGVfdHJlZV9wcm9wZXJ0aWVzX2JvdHRvbV91cChub2RlcywgJipsZWZ0LCAmKnJpZ2h0LCAmKnBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIG5vZGUpOwogICAgCiAgICBpZiAoKHJvb3QgPT0gbm9kZSkpIHsKICAgICAgICByZXR1cm4gbmV3X3Jvb3RfY2FuZGlkYXRlOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gcm9vdDsKICAgIH0KfQoKZm4gcGVyZm9ybV9jb21wcmVoZW5zaXZlX3RyZWVfdHJhdmVyc2FsKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgcm9vdDogaTMyLCBub2RlX2NvdW50OiBpMzIsIHJvdW5kOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgaW5vcmRlcl9zdW06IGkzMiA9IHBlcmZvcm1faW5vcmRlcl90cmF2ZXJzYWxfd2l0aF9jb21wdXRhdGlvbihub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJvb3QsIHJvdW5kKTsKICAgIGxldCBwcmVvcmRlcl9zdW06IGkzMiA9IHBlcmZvcm1fcHJlb3JkZXJfdHJhdmVyc2FsX3dpdGhfY29tcHV0YXRpb24obm9kZXMsIGxlZnQsIHJpZ2h0LCBwYXJlbnQsIGhlaWdodCwgc3VidHJlZV9zaXplLCByb290LCByb3VuZCk7CiAgICBsZXQgcG9zdG9yZGVyX3N1bTogaTMyID0gcGVyZm9ybV9wb3N0b3JkZXJfdHJhdmVyc2FsX3dpdGhfY29tcHV0YXRpb24obm9kZXMsIGxlZnQsIHJpZ2h0LCBwYXJlbnQsIGhlaWdodCwgc3VidHJlZV9zaXplLCByb290LCByb3VuZCk7CiAgICAKICAgIGxldCBsZXZlbF9vcmRlcl9zdW06IGkzMiA9IHBlcmZvcm1fbGV2ZWxfb3JkZXJfdHJhdmVyc2FsX3NpbXVsYXRpb24obm9kZXMsIGxlZnQsIHJpZ2h0LCBwYXJlbnQsIGhlaWdodCwgc3VidHJlZV9zaXplLCByb290LCBub2RlX2NvdW50LCByb3VuZCk7CiAgICAKICAgIGxldCBkaWFnb25hbF9zdW06IGkzMiA9IGNvbXB1dGVfZGlhZ29uYWxfdHJhdmVyc2FsX3N1bShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJvb3QsIDAsIHJvdW5kKTsKICAgIAogICAgbGV0IGNvbWJpbmVkX3Jlc3VsdDogaTMyID0gKGlub3JkZXJfc3VtICogMTMgKyBwcmVvcmRlcl9zdW0gKiAxNyArIHBvc3RvcmRlcl9zdW0gKiAxOSArIGxldmVsX29yZGVyX3N1bSAqIDIzICsgZGlhZ29uYWxfc3VtICogMjkpICUgMTAwMDAwOwogICAgCiAgICBjb21iaW5lZF9yZXN1bHQKfQoKZm4gcGVyZm9ybV9pbm9yZGVyX3RyYXZlcnNhbF93aXRoX2NvbXB1dGF0aW9uKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyLCBtdWx0aXBsaWVyOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoKG5vZGUgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICAKICAgIGxldCBsZWZ0X3N1bTogaTMyID0gcGVyZm9ybV9pbm9yZGVyX3RyYXZlcnNhbF93aXRoX2NvbXB1dGF0aW9uKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgbGVmdFtub2RlIGFzIHVzaXplXSwgbXVsdGlwbGllcik7CiAgICBsZXQgY3VycmVudF9jb250cmlidXRpb246IGkzMiA9IG5vZGVzW25vZGUgYXMgdXNpemVdICogKG11bHRpcGxpZXIgKyAxKSArIGhlaWdodFtub2RlIGFzIHVzaXplXSAqIHN1YnRyZWVfc2l6ZVtub2RlIGFzIHVzaXplXTsKICAgIGxldCByaWdodF9zdW06IGkzMiA9IHBlcmZvcm1faW5vcmRlcl90cmF2ZXJzYWxfd2l0aF9jb21wdXRhdGlvbihub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdLCBtdWx0aXBsaWVyKTsKICAgIAogICAgbGVmdF9zdW0gKyBjdXJyZW50X2NvbnRyaWJ1dGlvbiArIHJpZ2h0X3N1bQp9CgpmbiBwZXJmb3JtX3ByZW9yZGVyX3RyYXZlcnNhbF93aXRoX2NvbXB1dGF0aW9uKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyLCBtdWx0aXBsaWVyOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoKG5vZGUgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICAKICAgIGxldCBjdXJyZW50X2NvbnRyaWJ1dGlvbjogaTMyID0gbm9kZXNbbm9kZSBhcyB1c2l6ZV0gKiAobXVsdGlwbGllciArIDIpICsgaGVpZ2h0W25vZGUgYXMgdXNpemVdICogaGVpZ2h0W25vZGUgYXMgdXNpemVdOwogICAgbGV0IGxlZnRfc3VtOiBpMzIgPSBwZXJmb3JtX3ByZW9yZGVyX3RyYXZlcnNhbF93aXRoX2NvbXB1dGF0aW9uKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgbGVmdFtub2RlIGFzIHVzaXplXSwgbXVsdGlwbGllcik7CiAgICBsZXQgcmlnaHRfc3VtOiBpMzIgPSBwZXJmb3JtX3ByZW9yZGVyX3RyYXZlcnNhbF93aXRoX2NvbXB1dGF0aW9uKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcmlnaHRbbm9kZSBhcyB1c2l6ZV0sIG11bHRpcGxpZXIpOwogICAgCiAgICBjdXJyZW50X2NvbnRyaWJ1dGlvbiArIGxlZnRfc3VtICsgcmlnaHRfc3VtCn0KCmZuIHBlcmZvcm1fcG9zdG9yZGVyX3RyYXZlcnNhbF93aXRoX2NvbXB1dGF0aW9uKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyLCBtdWx0aXBsaWVyOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoKG5vZGUgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICAKICAgIGxldCBsZWZ0X3N1bTogaTMyID0gcGVyZm9ybV9wb3N0b3JkZXJfdHJhdmVyc2FsX3dpdGhfY29tcHV0YXRpb24obm9kZXMsIGxlZnQsIHJpZ2h0LCBwYXJlbnQsIGhlaWdodCwgc3VidHJlZV9zaXplLCBsZWZ0W25vZGUgYXMgdXNpemVdLCBtdWx0aXBsaWVyKTsKICAgIGxldCByaWdodF9zdW06IGkzMiA9IHBlcmZvcm1fcG9zdG9yZGVyX3RyYXZlcnNhbF93aXRoX2NvbXB1dGF0aW9uKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcmlnaHRbbm9kZSBhcyB1c2l6ZV0sIG11bHRpcGxpZXIpOwogICAgbGV0IGN1cnJlbnRfY29udHJpYnV0aW9uOiBpMzIgPSBub2Rlc1tub2RlIGFzIHVzaXplXSAqIChtdWx0aXBsaWVyICsgMykgKyBzdWJ0cmVlX3NpemVbbm9kZSBhcyB1c2l6ZV0gKiBzdWJ0cmVlX3NpemVbbm9kZSBhcyB1c2l6ZV07CiAgICAKICAgIGxlZnRfc3VtICsgcmlnaHRfc3VtICsgY3VycmVudF9jb250cmlidXRpb24KfQoKZm4gcGVyZm9ybV9sZXZlbF9vcmRlcl90cmF2ZXJzYWxfc2ltdWxhdGlvbihub2RlczogJltpMzI7IDIwMF0sIGxlZnQ6ICZbaTMyOyAyMDBdLCByaWdodDogJltpMzI7IDIwMF0sIHBhcmVudDogJltpMzI7IDIwMF0sIGhlaWdodDogJltpMzI7IDIwMF0sIHN1YnRyZWVfc2l6ZTogJltpMzI7IDIwMF0sIHJvb3Q6IGkzMiwgbm9kZV9jb3VudDogaTMyLCByb3VuZDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBxdWV1ZTogW2kzMjsgMjAwXSA9IFstMTsgMjAwXTsKICAgIGxldCBtdXQgcXVldWVfZnJvbnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHF1ZXVlX3JlYXI6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGxldmVsX3N1bTogaTMyID0gMDsKICAgIGxldCBtdXQgY3VycmVudF9sZXZlbDogaTMyID0gMTsKICAgIAogICAgaWYgKChyb290ID09IC0xKSkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgCiAgICBxdWV1ZVtxdWV1ZV9yZWFyIGFzIHVzaXplXSA9IHJvb3Q7CiAgICBxdWV1ZV9yZWFyID0gcXVldWVfcmVhciArIDE7CiAgICAKICAgIHdoaWxlICgocXVldWVfZnJvbnQgPCBxdWV1ZV9yZWFyKSkgewogICAgICAgIGxldCBsZXZlbF9zaXplOiBpMzIgPSBxdWV1ZV9yZWFyIC0gcXVldWVfZnJvbnQ7CiAgICAgICAgbGV0IG11dCBsZXZlbF9jb250cmlidXRpb246IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBwcm9jZXNzZWRfaW5fbGV2ZWw6IGkzMiA9IDA7CiAgICAgICAgCiAgICAgICAgd2hpbGUgKChwcm9jZXNzZWRfaW5fbGV2ZWwgPCBsZXZlbF9zaXplICYmIHF1ZXVlX2Zyb250IDwgcXVldWVfcmVhcikpIHsKICAgICAgICAgICAgbGV0IGN1cnJlbnRfbm9kZTogaTMyID0gcXVldWVbcXVldWVfZnJvbnQgYXMgdXNpemVdOwogICAgICAgICAgICBxdWV1ZV9mcm9udCA9IHF1ZXVlX2Zyb250ICsgMTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGxldmVsX2NvbnRyaWJ1dGlvbiA9IGxldmVsX2NvbnRyaWJ1dGlvbiArIG5vZGVzW2N1cnJlbnRfbm9kZSBhcyB1c2l6ZV0gKiBjdXJyZW50X2xldmVsICsgaGVpZ2h0W2N1cnJlbnRfbm9kZSBhcyB1c2l6ZV0gKiAocm91bmQgKyAxKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICgobGVmdFtjdXJyZW50X25vZGUgYXMgdXNpemVdICE9IC0xKSkgewogICAgICAgICAgICAgICAgcXVldWVbcXVldWVfcmVhciBhcyB1c2l6ZV0gPSBsZWZ0W2N1cnJlbnRfbm9kZSBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBxdWV1ZV9yZWFyID0gcXVldWVfcmVhciArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICgocmlnaHRbY3VycmVudF9ub2RlIGFzIHVzaXplXSAhPSAtMSkpIHsKICAgICAgICAgICAgICAgIHF1ZXVlW3F1ZXVlX3JlYXIgYXMgdXNpemVdID0gcmlnaHRbY3VycmVudF9ub2RlIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIHF1ZXVlX3JlYXIgPSBxdWV1ZV9yZWFyICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgcHJvY2Vzc2VkX2luX2xldmVsID0gcHJvY2Vzc2VkX2luX2xldmVsICsgMTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgbGV2ZWxfc3VtID0gbGV2ZWxfc3VtICsgbGV2ZWxfY29udHJpYnV0aW9uICogY3VycmVudF9sZXZlbDsKICAgICAgICBjdXJyZW50X2xldmVsID0gY3VycmVudF9sZXZlbCArIDE7CiAgICB9CiAgICAKICAgIGxldmVsX3N1bQp9CgpmbiBjb21wdXRlX2RpYWdvbmFsX3RyYXZlcnNhbF9zdW0obm9kZXM6ICZbaTMyOyAyMDBdLCBsZWZ0OiAmW2kzMjsgMjAwXSwgcmlnaHQ6ICZbaTMyOyAyMDBdLCBwYXJlbnQ6ICZbaTMyOyAyMDBdLCBoZWlnaHQ6ICZbaTMyOyAyMDBdLCBzdWJ0cmVlX3NpemU6ICZbaTMyOyAyMDBdLCBub2RlOiBpMzIsIGRpYWdvbmFsX2xldmVsOiBpMzIsIHJvdW5kOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoKG5vZGUgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICAKICAgIGxldCBjdXJyZW50X2NvbnRyaWJ1dGlvbjogaTMyID0gbm9kZXNbbm9kZSBhcyB1c2l6ZV0gKiAoZGlhZ29uYWxfbGV2ZWwgKyAxKSArIGhlaWdodFtub2RlIGFzIHVzaXplXSAqIChyb3VuZCArIDEpOwogICAgCiAgICBsZXQgbGVmdF9kaWFnb25hbDogaTMyID0gY29tcHV0ZV9kaWFnb25hbF90cmF2ZXJzYWxfc3VtKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgbGVmdFtub2RlIGFzIHVzaXplXSwgZGlhZ29uYWxfbGV2ZWwgKyAxLCByb3VuZCk7CiAgICBsZXQgcmlnaHRfZGlhZ29uYWw6IGkzMiA9IGNvbXB1dGVfZGlhZ29uYWxfdHJhdmVyc2FsX3N1bShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdLCBkaWFnb25hbF9sZXZlbCwgcm91bmQpOwogICAgCiAgICBjdXJyZW50X2NvbnRyaWJ1dGlvbiArIGxlZnRfZGlhZ29uYWwgKyByaWdodF9kaWFnb25hbAp9CgpmbiBjb21wdXRlX2NvbXBsZXhfdHJlZV9wcm9wZXJ0aWVzKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgcm9vdDogaTMyLCBub2RlX2NvdW50OiBpMzIsIHJvdW5kOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgZmlib25hY2NpX3N1bTogaTMyID0gY29tcHV0ZV9maWJvbmFjY2lfc3VtX2Zvcl9ub2Rlcyhub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJvb3QsIHJvdW5kKTsKICAgIGxldCBwcmltZV9mYWN0b3Jfc3VtOiBpMzIgPSBjb21wdXRlX3ByaW1lX2ZhY3Rvcl9hbmFseXNpcyhub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJvb3QsIG5vZGVfY291bnQpOwogICAgbGV0IHJlY3Vyc2l2ZV9kZXB0aF9wcm9kdWN0OiBpMzIgPSBjb21wdXRlX3JlY3Vyc2l2ZV9kZXB0aF9wcm9kdWN0KG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcm9vdCwgMSwgcm91bmQpOwogICAgCiAgICBsZXQgbWF0aGVtYXRpY2FsX2NvbXBsZXhpdHk6IGkzMiA9IHBlcmZvcm1fbWF0aGVtYXRpY2FsX3NlcXVlbmNlX2FuYWx5c2lzKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcm9vdCwgcm91bmQpOwogICAgCiAgICBsZXQgbmVzdGVkX2xvb3BfY29tcHV0YXRpb246IGkzMiA9IHBlcmZvcm1fbmVzdGVkX2xvb3BfY29tcHV0YXRpb25fb25fdHJlZShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJvb3QsIG5vZGVfY291bnQsIHJvdW5kKTsKICAgIAogICAgbGV0IGZpbmFsX3Jlc3VsdDogaTMyID0gKGZpYm9uYWNjaV9zdW0gKiA3ICsgcHJpbWVfZmFjdG9yX3N1bSAqIDExICsgcmVjdXJzaXZlX2RlcHRoX3Byb2R1Y3QgKiAxMyArIG1hdGhlbWF0aWNhbF9jb21wbGV4aXR5ICogMTcgKyBuZXN0ZWRfbG9vcF9jb21wdXRhdGlvbiAqIDE5KSAlIDEwMDAwMDA7CiAgICAKICAgIGZpbmFsX3Jlc3VsdAp9CgpmbiBjb21wdXRlX2ZpYm9uYWNjaV9zdW1fZm9yX25vZGVzKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyLCByb3VuZDogaTMyKSAtPiBpMzIgewogICAgaWYgKChub2RlID09IC0xKSkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgCiAgICBsZXQgbm9kZV9maWJvbmFjY2k6IGkzMiA9IGNvbXB1dGVfZmlib25hY2NpX2l0ZXJhdGl2ZShub2Rlc1tub2RlIGFzIHVzaXplXSAlIDIwICsgcm91bmQgJSA1KTsKICAgIAogICAgbGV0IGxlZnRfZmlib25hY2NpOiBpMzIgPSBjb21wdXRlX2ZpYm9uYWNjaV9zdW1fZm9yX25vZGVzKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgbGVmdFtub2RlIGFzIHVzaXplXSwgcm91bmQpOwogICAgbGV0IHJpZ2h0X2ZpYm9uYWNjaTogaTMyID0gY29tcHV0ZV9maWJvbmFjY2lfc3VtX2Zvcl9ub2Rlcyhub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdLCByb3VuZCk7CiAgICAKICAgIG5vZGVfZmlib25hY2NpICsgbGVmdF9maWJvbmFjY2kgKyByaWdodF9maWJvbmFjY2kKfQoKZm4gY29tcHV0ZV9maWJvbmFjY2lfaXRlcmF0aXZlKG46IGkzMikgLT4gaTMyIHsKICAgIGlmIChuIDw9IDEpIHsKICAgICAgICByZXR1cm4gbjsKICAgIH0KICAgIAogICAgbGV0IG11dCBhOiBpMzIgPSAwOwogICAgbGV0IG11dCBiOiBpMzIgPSAxOwogICAgbGV0IG11dCBpOiBpMzIgPSAyOwogICAgCiAgICB3aGlsZSAoaSA8PSBuKSB7CiAgICAgICAgbGV0IHRlbXA6IGkzMiA9IGEgKyBiOwogICAgICAgIGEgPSBiOwogICAgICAgIGIgPSB0ZW1wOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIAogICAgYiAlIDEwMDAwCn0KCmZuIGNvbXB1dGVfcHJpbWVfZmFjdG9yX2FuYWx5c2lzKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyLCBub2RlX2NvdW50OiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoKG5vZGUgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICAKICAgIGxldCBwcmltZV9mYWN0b3JzOiBpMzIgPSBjb3VudF9wcmltZV9mYWN0b3JzKGFicyhub2Rlc1tub2RlIGFzIHVzaXplXSkgKyAxKTsKICAgIGxldCBoZWlnaHRfcHJpbWVfZmFjdG9yczogaTMyID0gY291bnRfcHJpbWVfZmFjdG9ycyhoZWlnaHRbbm9kZSBhcyB1c2l6ZV0gKyAxKTsKICAgIGxldCBzaXplX3ByaW1lX2ZhY3RvcnM6IGkzMiA9IGNvdW50X3ByaW1lX2ZhY3RvcnMoc3VidHJlZV9zaXplW25vZGUgYXMgdXNpemVdICsgMSk7CiAgICAKICAgIGxldCBjdXJyZW50X2NvbnRyaWJ1dGlvbjogaTMyID0gcHJpbWVfZmFjdG9ycyAqIDUgKyBoZWlnaHRfcHJpbWVfZmFjdG9ycyAqIDMgKyBzaXplX3ByaW1lX2ZhY3RvcnMgKiA3OwogICAgCiAgICBsZXQgbGVmdF9jb250cmlidXRpb246IGkzMiA9IGNvbXB1dGVfcHJpbWVfZmFjdG9yX2FuYWx5c2lzKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgbGVmdFtub2RlIGFzIHVzaXplXSwgbm9kZV9jb3VudCk7CiAgICBsZXQgcmlnaHRfY29udHJpYnV0aW9uOiBpMzIgPSBjb21wdXRlX3ByaW1lX2ZhY3Rvcl9hbmFseXNpcyhub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdLCBub2RlX2NvdW50KTsKICAgIAogICAgY3VycmVudF9jb250cmlidXRpb24gKyBsZWZ0X2NvbnRyaWJ1dGlvbiArIHJpZ2h0X2NvbnRyaWJ1dGlvbgp9CgpmbiBjb3VudF9wcmltZV9mYWN0b3JzKG46IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgbnVtOiBpMzIgPSBuOwogICAgbGV0IG11dCBjb3VudDogaTMyID0gMDsKICAgIGxldCBtdXQgZmFjdG9yOiBpMzIgPSAyOwogICAgCiAgICB3aGlsZSAoZmFjdG9yICogZmFjdG9yIDw9IG51bSkgewogICAgICAgIHdoaWxlIChudW0gJSBmYWN0b3IgPT0gMCkgewogICAgICAgICAgICBjb3VudCA9IGNvdW50ICsgMTsKICAgICAgICAgICAgbnVtID0gbnVtIC8gZmFjdG9yOwogICAgICAgIH0KICAgICAgICBmYWN0b3IgPSBmYWN0b3IgKyAxOwogICAgfQogICAgCiAgICBpZiAobnVtID4gMSkgewogICAgICAgIGNvdW50ID0gY291bnQgKyAxOwogICAgfQogICAgCiAgICBjb3VudAp9CgpmbiBjb21wdXRlX3JlY3Vyc2l2ZV9kZXB0aF9wcm9kdWN0KG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyLCBkZXB0aDogaTMyLCByb3VuZDogaTMyKSAtPiBpMzIgewogICAgaWYgKChub2RlID09IC0xKSkgewogICAgICAgIHJldHVybiAxOwogICAgfQogICAgCiAgICBsZXQgY3VycmVudF9mYWN0b3I6IGkzMiA9IChub2Rlc1tub2RlIGFzIHVzaXplXSAlIDEwICsgMSkgKiAoZGVwdGggJSA1ICsgMSkgKyAocm91bmQgJSAzICsgMSk7CiAgICAKICAgIGxldCBsZWZ0X3Byb2R1Y3Q6IGkzMiA9IGNvbXB1dGVfcmVjdXJzaXZlX2RlcHRoX3Byb2R1Y3Qobm9kZXMsIGxlZnQsIHJpZ2h0LCBwYXJlbnQsIGhlaWdodCwgc3VidHJlZV9zaXplLCBsZWZ0W25vZGUgYXMgdXNpemVdLCBkZXB0aCArIDEsIHJvdW5kKTsKICAgIGxldCByaWdodF9wcm9kdWN0OiBpMzIgPSBjb21wdXRlX3JlY3Vyc2l2ZV9kZXB0aF9wcm9kdWN0KG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcmlnaHRbbm9kZSBhcyB1c2l6ZV0sIGRlcHRoICsgMSwgcm91bmQpOwogICAgCiAgICAoY3VycmVudF9mYWN0b3IgKiBsZWZ0X3Byb2R1Y3QgJSAxMDAwMCAqIHJpZ2h0X3Byb2R1Y3QgJSAxMDAwMCkgJSAxMDAwMDAKfQoKZm4gcGVyZm9ybV9tYXRoZW1hdGljYWxfc2VxdWVuY2VfYW5hbHlzaXMobm9kZXM6ICZbaTMyOyAyMDBdLCBsZWZ0OiAmW2kzMjsgMjAwXSwgcmlnaHQ6ICZbaTMyOyAyMDBdLCBwYXJlbnQ6ICZbaTMyOyAyMDBdLCBoZWlnaHQ6ICZbaTMyOyAyMDBdLCBzdWJ0cmVlX3NpemU6ICZbaTMyOyAyMDBdLCBub2RlOiBpMzIsIHJvdW5kOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoKG5vZGUgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICAKICAgIGxldCBhcml0aG1ldGljX3NlcXVlbmNlOiBpMzIgPSBjb21wdXRlX2FyaXRobWV0aWNfc2VxdWVuY2Vfc3VtKG5vZGVzW25vZGUgYXMgdXNpemVdLCBoZWlnaHRbbm9kZSBhcyB1c2l6ZV0sIHN1YnRyZWVfc2l6ZVtub2RlIGFzIHVzaXplXSk7CiAgICBsZXQgZ2VvbWV0cmljX3NlcXVlbmNlOiBpMzIgPSBjb21wdXRlX2dlb21ldHJpY19zZXF1ZW5jZV9zdW0obm9kZXNbbm9kZSBhcyB1c2l6ZV0gJSA1ICsgMSwgaGVpZ2h0W25vZGUgYXMgdXNpemVdICUgMyArIDEsIHJvdW5kICUgNyArIDMpOwogICAgbGV0IHF1YWRyYXRpY19zZXF1ZW5jZTogaTMyID0gY29tcHV0ZV9xdWFkcmF0aWNfc2VxdWVuY2Vfc3VtKG5vZGVzW25vZGUgYXMgdXNpemVdLCBoZWlnaHRbbm9kZSBhcyB1c2l6ZV0sIHJvdW5kKTsKICAgIAogICAgbGV0IGxlZnRfYW5hbHlzaXM6IGkzMiA9IHBlcmZvcm1fbWF0aGVtYXRpY2FsX3NlcXVlbmNlX2FuYWx5c2lzKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgbGVmdFtub2RlIGFzIHVzaXplXSwgcm91bmQpOwogICAgbGV0IHJpZ2h0X2FuYWx5c2lzOiBpMzIgPSBwZXJmb3JtX21hdGhlbWF0aWNhbF9zZXF1ZW5jZV9hbmFseXNpcyhub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdLCByb3VuZCk7CiAgICAKICAgIGFyaXRobWV0aWNfc2VxdWVuY2UgKyBnZW9tZXRyaWNfc2VxdWVuY2UgKyBxdWFkcmF0aWNfc2VxdWVuY2UgKyBsZWZ0X2FuYWx5c2lzICsgcmlnaHRfYW5hbHlzaXMKfQoKZm4gY29tcHV0ZV9hcml0aG1ldGljX3NlcXVlbmNlX3N1bShmaXJzdF90ZXJtOiBpMzIsIGNvbW1vbl9kaWZmOiBpMzIsIG51bV90ZXJtczogaTMyKSAtPiBpMzIgewogICAgbGV0IHRlcm1zOiBpMzIgPSBtaW4oYWJzKG51bV90ZXJtcyksIDIwKTsKICAgIGxldCBhOiBpMzIgPSBmaXJzdF90ZXJtICUgMTAwOwogICAgbGV0IGQ6IGkzMiA9IGNvbW1vbl9kaWZmICUgMTA7CiAgICAKICAgIGxldCBzdW06IGkzMiA9IHRlcm1zICogKDIgKiBhICsgKHRlcm1zIC0gMSkgKiBkKSAvIDI7CiAgICAKICAgIGFicyhzdW0pICUgMTAwMDAKfQoKZm4gY29tcHV0ZV9nZW9tZXRyaWNfc2VxdWVuY2Vfc3VtKGZpcnN0X3Rlcm06IGkzMiwgcmF0aW86IGkzMiwgbnVtX3Rlcm1zOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgdGVybXM6IGkzMiA9IG1pbihhYnMobnVtX3Rlcm1zKSwgMTUpOwogICAgbGV0IGE6IGkzMiA9IGFicyhmaXJzdF90ZXJtKSAlIDEwICsgMTsKICAgIGxldCByOiBpMzIgPSBhYnMocmF0aW8pICUgMyArIDE7CiAgICAKICAgIGlmIChyID09IDEpIHsKICAgICAgICByZXR1cm4gKGEgKiB0ZXJtcykgJSAxMDAwMDsKICAgIH0KICAgIAogICAgbGV0IG11dCBzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGN1cnJlbnRfdGVybTogaTMyID0gYTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIAogICAgd2hpbGUgKGkgPCB0ZXJtcykgewogICAgICAgIHN1bSA9IChzdW0gKyBjdXJyZW50X3Rlcm0pICUgMTAwMDA7CiAgICAgICAgY3VycmVudF90ZXJtID0gKGN1cnJlbnRfdGVybSAqIHIpICUgMTAwMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIHN1bQp9CgpmbiBjb21wdXRlX3F1YWRyYXRpY19zZXF1ZW5jZV9zdW0oYmFzZTogaTMyLCBtdWx0aXBsaWVyOiBpMzIsIHJvdW5kczogaTMyKSAtPiBpMzIgewogICAgbGV0IHRlcm1zOiBpMzIgPSBtaW4oYWJzKHJvdW5kcyksIDI1KTsKICAgIGxldCBhOiBpMzIgPSBhYnMoYmFzZSkgJSAxMCArIDE7CiAgICBsZXQgYjogaTMyID0gYWJzKG11bHRpcGxpZXIpICUgNSArIDE7CiAgICAKICAgIGxldCBtdXQgc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAxOwogICAgCiAgICB3aGlsZSAoaSA8PSB0ZXJtcykgewogICAgICAgIGxldCB0ZXJtX3ZhbHVlOiBpMzIgPSBhICogaSAqIGkgKyBiICogaSArIChyb3VuZHMgJSA3KTsKICAgICAgICBzdW0gPSAoc3VtICsgdGVybV92YWx1ZSkgJSAxMDAwMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIHN1bQp9CgpmbiBwZXJmb3JtX25lc3RlZF9sb29wX2NvbXB1dGF0aW9uX29uX3RyZWUobm9kZXM6ICZbaTMyOyAyMDBdLCBsZWZ0OiAmW2kzMjsgMjAwXSwgcmlnaHQ6ICZbaTMyOyAyMDBdLCBwYXJlbnQ6ICZbaTMyOyAyMDBdLCBoZWlnaHQ6ICZbaTMyOyAyMDBdLCBzdWJ0cmVlX3NpemU6ICZbaTMyOyAyMDBdLCByb290OiBpMzIsIG5vZGVfY291bnQ6IGkzMiwgcm91bmQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgdG90YWxfY29tcHV0YXRpb246IGkzMiA9IDA7CiAgICAKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlICgoaSA8IG5vZGVfY291bnQpKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlICgoaiA8IG1pbihzdWJ0cmVlX3NpemVbaSBhcyB1c2l6ZV0sIDE1KSkpIHsKICAgICAgICAgICAgbGV0IG11dCBrOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoKGsgPCBtaW4oaGVpZ2h0W2kgYXMgdXNpemVdLCA4KSkpIHsKICAgICAgICAgICAgICAgIGxldCBjb21wdXRhdGlvbl92YWx1ZTogaTMyID0gKG5vZGVzW2kgYXMgdXNpemVdICogKGogKyAxKSAqIChrICsgMSkgKyByb3VuZCAqIChpICsgMSkpICUgMTAwMDsKICAgICAgICAgICAgICAgIHRvdGFsX2NvbXB1dGF0aW9uID0gKHRvdGFsX2NvbXB1dGF0aW9uICsgY29tcHV0YXRpb25fdmFsdWUpICUgMTAwMDAwOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBsZXQgaW5uZXJfbmVzdGVkX2NvbXB1dGF0aW9uOiBpMzIgPSBwZXJmb3JtX2lubmVyX25lc3RlZF9jb21wdXRhdGlvbihub2Rlc1tpIGFzIHVzaXplXSwgaiwgaywgcm91bmQpOwogICAgICAgICAgICAgICAgdG90YWxfY29tcHV0YXRpb24gPSAodG90YWxfY29tcHV0YXRpb24gKyBpbm5lcl9uZXN0ZWRfY29tcHV0YXRpb24pICUgMTAwMDAwOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBrID0gayArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAKICAgIHRvdGFsX2NvbXB1dGF0aW9uCn0KCmZuIHBlcmZvcm1faW5uZXJfbmVzdGVkX2NvbXB1dGF0aW9uKG5vZGVfdmFsdWU6IGkzMiwgb3V0ZXJfaW5kZXg6IGkzMiwgaW5uZXJfaW5kZXg6IGkzMiwgcm91bmQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgY29tcHV0YXRpb246IGkzMiA9IDA7CiAgICBsZXQgYmFzZV92YWx1ZTogaTMyID0gYWJzKG5vZGVfdmFsdWUpICUgNTAgKyAxOwogICAgCiAgICBsZXQgbXV0IHg6IGkzMiA9IDE7CiAgICB3aGlsZSAoeCA8PSBtaW4ob3V0ZXJfaW5kZXggKyAxLCA1KSkgewogICAgICAgIGxldCBtdXQgeTogaTMyID0gMTsKICAgICAgICB3aGlsZSAoeSA8PSBtaW4oaW5uZXJfaW5kZXggKyAxLCA0KSkgewogICAgICAgICAgICBsZXQgbXV0IHo6IGkzMiA9IDE7CiAgICAgICAgICAgIHdoaWxlICh6IDw9IG1pbihyb3VuZCArIDEsIDMpKSB7CiAgICAgICAgICAgICAgICBsZXQgdGVybTogaTMyID0gKGJhc2VfdmFsdWUgKiB4ICogeSAqIHogKyB4ICogeCArIHkgKiB5ICsgeiAqIHopICUgMTAwMDsKICAgICAgICAgICAgICAgIGNvbXB1dGF0aW9uID0gKGNvbXB1dGF0aW9uICsgdGVybSkgJSAxMDAwMDsKICAgICAgICAgICAgICAgIHogPSB6ICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICB5ID0geSArIDE7CiAgICAgICAgfQogICAgICAgIHggPSB4ICsgMTsKICAgIH0KICAgIAogICAgY29tcHV0YXRpb24KfQoKZm4gdmFsaWRhdGVfdHJlZV9pbnRlZ3JpdHkobm9kZXM6ICZbaTMyOyAyMDBdLCBsZWZ0OiAmW2kzMjsgMjAwXSwgcmlnaHQ6ICZbaTMyOyAyMDBdLCBwYXJlbnQ6ICZbaTMyOyAyMDBdLCBoZWlnaHQ6ICZbaTMyOyAyMDBdLCBzdWJ0cmVlX3NpemU6ICZbaTMyOyAyMDBdLCByb290OiBpMzIsIG5vZGVfY291bnQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBzdHJ1Y3R1cmVfdmFsaWRhdGlvbjogaTMyID0gdmFsaWRhdGVfdHJlZV9zdHJ1Y3R1cmVfcmVjdXJzaXZlKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcm9vdCwgLTEpOwogICAgbGV0IHByb3BlcnR5X3ZhbGlkYXRpb246IGkzMiA9IHZhbGlkYXRlX3RyZWVfcHJvcGVydGllc19jb21wcmVoZW5zaXZlKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcm9vdCwgbm9kZV9jb3VudCk7CiAgICBsZXQgY29uc2lzdGVuY3lfdmFsaWRhdGlvbjogaTMyID0gdmFsaWRhdGVfdHJlZV9jb25zaXN0ZW5jeV9jaGVja3Mobm9kZXMsIGxlZnQsIHJpZ2h0LCBwYXJlbnQsIGhlaWdodCwgc3VidHJlZV9zaXplLCByb290LCBub2RlX2NvdW50KTsKICAgIAogICAgbGV0IGVkZ2VfY2FzZV92YWxpZGF0aW9uOiBpMzIgPSB2YWxpZGF0ZV9lZGdlX2Nhc2VzX2FuZF9ib3VuZGFyaWVzKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcm9vdCwgbm9kZV9jb3VudCk7CiAgICAKICAgIGxldCBmaW5hbF9pbnRlZ3JpdHlfc2NvcmU6IGkzMiA9IHN0cnVjdHVyZV92YWxpZGF0aW9uICogMTMgKyBwcm9wZXJ0eV92YWxpZGF0aW9uICogMTcgKyBjb25zaXN0ZW5jeV92YWxpZGF0aW9uICogMTkgKyBlZGdlX2Nhc2VfdmFsaWRhdGlvbiAqIDIzOwogICAgCiAgICBmaW5hbF9pbnRlZ3JpdHlfc2NvcmUgJSAxMDAwMDAwCn0KCmZuIHZhbGlkYXRlX3RyZWVfc3RydWN0dXJlX3JlY3Vyc2l2ZShub2RlczogJltpMzI7IDIwMF0sIGxlZnQ6ICZbaTMyOyAyMDBdLCByaWdodDogJltpMzI7IDIwMF0sIHBhcmVudDogJltpMzI7IDIwMF0sIGhlaWdodDogJltpMzI7IDIwMF0sIHN1YnRyZWVfc2l6ZTogJltpMzI7IDIwMF0sIG5vZGU6IGkzMiwgZXhwZWN0ZWRfcGFyZW50OiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoKG5vZGUgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CiAgICAKICAgIGlmICgocGFyZW50W25vZGUgYXMgdXNpemVdICE9IGV4cGVjdGVkX3BhcmVudCkpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIAogICAgbGV0IGxlZnRfdmFsaWRhdGlvbjogaTMyID0gdmFsaWRhdGVfdHJlZV9zdHJ1Y3R1cmVfcmVjdXJzaXZlKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgbGVmdFtub2RlIGFzIHVzaXplXSwgbm9kZSk7CiAgICBsZXQgcmlnaHRfdmFsaWRhdGlvbjogaTMyID0gdmFsaWRhdGVfdHJlZV9zdHJ1Y3R1cmVfcmVjdXJzaXZlKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcmlnaHRbbm9kZSBhcyB1c2l6ZV0sIG5vZGUpOwogICAgCiAgICBsZXQgYnN0X3Byb3BlcnR5OiBpMzIgPSB2YWxpZGF0ZV9ic3RfcHJvcGVydHlfYXRfbm9kZShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIG5vZGUpOwogICAgCiAgICBsZWZ0X3ZhbGlkYXRpb24gKiByaWdodF92YWxpZGF0aW9uICogYnN0X3Byb3BlcnR5Cn0KCmZuIHZhbGlkYXRlX2JzdF9wcm9wZXJ0eV9hdF9ub2RlKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyKSAtPiBpMzIgewogICAgaWYgKChub2RlID09IC0xKSkgewogICAgICAgIHJldHVybiAxOwogICAgfQogICAgCiAgICBsZXQgbGVmdF9tYXg6IGkzMiA9IGZpbmRfbWF4aW11bV9pbl9zdWJ0cmVlKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgbGVmdFtub2RlIGFzIHVzaXplXSk7CiAgICBsZXQgcmlnaHRfbWluOiBpMzIgPSBmaW5kX21pbmltdW1faW5fc3VidHJlZShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdKTsKICAgIAogICAgbGV0IGxlZnRfdmFsaWQ6IGJvb2wgPSBsZWZ0W25vZGUgYXMgdXNpemVdID09IC0xIHx8IGxlZnRfbWF4IDwgbm9kZXNbbm9kZSBhcyB1c2l6ZV07CiAgICBsZXQgcmlnaHRfdmFsaWQ6IGJvb2wgPSByaWdodFtub2RlIGFzIHVzaXplXSA9PSAtMSB8fCByaWdodF9taW4gPiBub2Rlc1tub2RlIGFzIHVzaXplXTsKICAgIAogICAgaWYgKChsZWZ0X3ZhbGlkICYmIHJpZ2h0X3ZhbGlkKSkgeyAxIH0gZWxzZSB7IDAgfQp9CgpmbiBmaW5kX21heGltdW1faW5fc3VidHJlZShub2RlczogJltpMzI7IDIwMF0sIGxlZnQ6ICZbaTMyOyAyMDBdLCByaWdodDogJltpMzI7IDIwMF0sIHBhcmVudDogJltpMzI7IDIwMF0sIGhlaWdodDogJltpMzI7IDIwMF0sIHN1YnRyZWVfc2l6ZTogJltpMzI7IDIwMF0sIG5vZGU6IGkzMikgLT4gaTMyIHsKICAgIGlmICgobm9kZSA9PSAtMSkpIHsKICAgICAgICByZXR1cm4gLTEwMDAwMDsKICAgIH0KICAgIAogICAgbGV0IG11dCBjdXJyZW50OiBpMzIgPSBub2RlOwogICAgd2hpbGUgKChyaWdodFtjdXJyZW50IGFzIHVzaXplXSAhPSAtMSkpIHsKICAgICAgICBjdXJyZW50ID0gcmlnaHRbY3VycmVudCBhcyB1c2l6ZV07CiAgICB9CiAgICAKICAgIG5vZGVzW2N1cnJlbnQgYXMgdXNpemVdCn0KCmZuIGZpbmRfbWluaW11bV9pbl9zdWJ0cmVlKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyKSAtPiBpMzIgewogICAgaWYgKChub2RlID09IC0xKSkgewogICAgICAgIHJldHVybiAxMDAwMDA7CiAgICB9CiAgICAKICAgIGxldCBtdXQgY3VycmVudDogaTMyID0gbm9kZTsKICAgIHdoaWxlICgobGVmdFtjdXJyZW50IGFzIHVzaXplXSAhPSAtMSkpIHsKICAgICAgICBjdXJyZW50ID0gbGVmdFtjdXJyZW50IGFzIHVzaXplXTsKICAgIH0KICAgIAogICAgbm9kZXNbY3VycmVudCBhcyB1c2l6ZV0KfQoKZm4gdmFsaWRhdGVfdHJlZV9wcm9wZXJ0aWVzX2NvbXByZWhlbnNpdmUobm9kZXM6ICZbaTMyOyAyMDBdLCBsZWZ0OiAmW2kzMjsgMjAwXSwgcmlnaHQ6ICZbaTMyOyAyMDBdLCBwYXJlbnQ6ICZbaTMyOyAyMDBdLCBoZWlnaHQ6ICZbaTMyOyAyMDBdLCBzdWJ0cmVlX3NpemU6ICZbaTMyOyAyMDBdLCByb290OiBpMzIsIG5vZGVfY291bnQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgdmFsaWRhdGlvbl9zY29yZTogaTMyID0gMDsKICAgIAogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKChpIDwgbm9kZV9jb3VudCkpIHsKICAgICAgICBsZXQgZXhwZWN0ZWRfaGVpZ2h0OiBpMzIgPSBjb21wdXRlX2V4cGVjdGVkX2hlaWdodChub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIGkpOwogICAgICAgIGxldCBleHBlY3RlZF9zaXplOiBpMzIgPSBjb21wdXRlX2V4cGVjdGVkX3N1YnRyZWVfc2l6ZShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIGkpOwogICAgICAgIAogICAgICAgIGlmICgoZXhwZWN0ZWRfaGVpZ2h0ID09IGhlaWdodFtpIGFzIHVzaXplXSkpIHsKICAgICAgICAgICAgdmFsaWRhdGlvbl9zY29yZSA9IHZhbGlkYXRpb25fc2NvcmUgKyAxMDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKChleHBlY3RlZF9zaXplID09IHN1YnRyZWVfc2l6ZVtpIGFzIHVzaXplXSkpIHsKICAgICAgICAgICAgdmFsaWRhdGlvbl9zY29yZSA9IHZhbGlkYXRpb25fc2NvcmUgKyAxNTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgCiAgICB2YWxpZGF0aW9uX3Njb3JlCn0KCmZuIGNvbXB1dGVfZXhwZWN0ZWRfaGVpZ2h0KG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyKSAtPiBpMzIgewogICAgaWYgKChub2RlID09IC0xKSkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgCiAgICBsZXQgbGVmdF9oZWlnaHQ6IGkzMiA9IGlmICgobGVmdFtub2RlIGFzIHVzaXplXSA9PSAtMSkpIHsgMCB9IGVsc2UgeyBjb21wdXRlX2V4cGVjdGVkX2hlaWdodChub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIGxlZnRbbm9kZSBhcyB1c2l6ZV0pIH07CiAgICBsZXQgcmlnaHRfaGVpZ2h0OiBpMzIgPSBpZiAoKHJpZ2h0W25vZGUgYXMgdXNpemVdID09IC0xKSkgeyAwIH0gZWxzZSB7IGNvbXB1dGVfZXhwZWN0ZWRfaGVpZ2h0KG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcmlnaHRbbm9kZSBhcyB1c2l6ZV0pIH07CiAgICAKICAgIG1heChsZWZ0X2hlaWdodCwgcmlnaHRfaGVpZ2h0KSArIDEKfQoKZm4gY29tcHV0ZV9leHBlY3RlZF9zdWJ0cmVlX3NpemUobm9kZXM6ICZbaTMyOyAyMDBdLCBsZWZ0OiAmW2kzMjsgMjAwXSwgcmlnaHQ6ICZbaTMyOyAyMDBdLCBwYXJlbnQ6ICZbaTMyOyAyMDBdLCBoZWlnaHQ6ICZbaTMyOyAyMDBdLCBzdWJ0cmVlX3NpemU6ICZbaTMyOyAyMDBdLCBub2RlOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoKG5vZGUgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICAKICAgIGxldCBsZWZ0X3NpemU6IGkzMiA9IGlmICgobGVmdFtub2RlIGFzIHVzaXplXSA9PSAtMSkpIHsgMCB9IGVsc2UgeyBjb21wdXRlX2V4cGVjdGVkX3N1YnRyZWVfc2l6ZShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIGxlZnRbbm9kZSBhcyB1c2l6ZV0pIH07CiAgICBsZXQgcmlnaHRfc2l6ZTogaTMyID0gaWYgKChyaWdodFtub2RlIGFzIHVzaXplXSA9PSAtMSkpIHsgMCB9IGVsc2UgeyBjb21wdXRlX2V4cGVjdGVkX3N1YnRyZWVfc2l6ZShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdKSB9OwogICAgCiAgICBsZWZ0X3NpemUgKyByaWdodF9zaXplICsgMQp9CgpmbiB2YWxpZGF0ZV90cmVlX2NvbnNpc3RlbmN5X2NoZWNrcyhub2RlczogJltpMzI7IDIwMF0sIGxlZnQ6ICZbaTMyOyAyMDBdLCByaWdodDogJltpMzI7IDIwMF0sIHBhcmVudDogJltpMzI7IDIwMF0sIGhlaWdodDogJltpMzI7IDIwMF0sIHN1YnRyZWVfc2l6ZTogJltpMzI7IDIwMF0sIHJvb3Q6IGkzMiwgbm9kZV9jb3VudDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBjb25zaXN0ZW5jeV9zY29yZTogaTMyID0gMDsKICAgIAogICAgbGV0IHJlYWNoYWJsZV9ub2RlczogaTMyID0gY291bnRfcmVhY2hhYmxlX25vZGVzX2Zyb21fcm9vdChub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJvb3QpOwogICAgCiAgICBpZiAoKHJlYWNoYWJsZV9ub2RlcyA9PSBub2RlX2NvdW50KSkgewogICAgICAgIGNvbnNpc3RlbmN5X3Njb3JlID0gY29uc2lzdGVuY3lfc2NvcmUgKyAxMDA7CiAgICB9CiAgICAKICAgIGxldCBjeWNsZV9jaGVjazogaTMyID0gZGV0ZWN0X2N5Y2xlc19pbl90cmVlKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcm9vdCwgbm9kZV9jb3VudCk7CiAgICBpZiAoKGN5Y2xlX2NoZWNrID09IDApKSB7CiAgICAgICAgY29uc2lzdGVuY3lfc2NvcmUgPSBjb25zaXN0ZW5jeV9zY29yZSArIDIwMDsKICAgIH0KICAgIAogICAgbGV0IGJhbGFuY2VfY29uc2lzdGVuY3k6IGkzMiA9IGNoZWNrX2JhbGFuY2VfY29uc2lzdGVuY3kobm9kZXMsIGxlZnQsIHJpZ2h0LCBwYXJlbnQsIGhlaWdodCwgc3VidHJlZV9zaXplLCByb290KTsKICAgIGNvbnNpc3RlbmN5X3Njb3JlID0gY29uc2lzdGVuY3lfc2NvcmUgKyBiYWxhbmNlX2NvbnNpc3RlbmN5OwogICAgCiAgICBjb25zaXN0ZW5jeV9zY29yZQp9CgpmbiBjb3VudF9yZWFjaGFibGVfbm9kZXNfZnJvbV9yb290KG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyKSAtPiBpMzIgewogICAgaWYgKChub2RlID09IC0xKSkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgCiAgICBsZXQgbGVmdF9jb3VudDogaTMyID0gY291bnRfcmVhY2hhYmxlX25vZGVzX2Zyb21fcm9vdChub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIGxlZnRbbm9kZSBhcyB1c2l6ZV0pOwogICAgbGV0IHJpZ2h0X2NvdW50OiBpMzIgPSBjb3VudF9yZWFjaGFibGVfbm9kZXNfZnJvbV9yb290KG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcmlnaHRbbm9kZSBhcyB1c2l6ZV0pOwogICAgCiAgICAxICsgbGVmdF9jb3VudCArIHJpZ2h0X2NvdW50Cn0KCmZuIGRldGVjdF9jeWNsZXNfaW5fdHJlZShub2RlczogJltpMzI7IDIwMF0sIGxlZnQ6ICZbaTMyOyAyMDBdLCByaWdodDogJltpMzI7IDIwMF0sIHBhcmVudDogJltpMzI7IDIwMF0sIGhlaWdodDogJltpMzI7IDIwMF0sIHN1YnRyZWVfc2l6ZTogJltpMzI7IDIwMF0sIHJvb3Q6IGkzMiwgbm9kZV9jb3VudDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCB2aXNpdGVkOiBbYm9vbDsgMjAwXSA9IFtmYWxzZTsgMjAwXTsKICAgIAogICAgcGVyZm9ybV9kZnNfY3ljbGVfZGV0ZWN0aW9uKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcm9vdCwgJm11dCB2aXNpdGVkKQp9CgpmbiBwZXJmb3JtX2Rmc19jeWNsZV9kZXRlY3Rpb24obm9kZXM6ICZbaTMyOyAyMDBdLCBsZWZ0OiAmW2kzMjsgMjAwXSwgcmlnaHQ6ICZbaTMyOyAyMDBdLCBwYXJlbnQ6ICZbaTMyOyAyMDBdLCBoZWlnaHQ6ICZbaTMyOyAyMDBdLCBzdWJ0cmVlX3NpemU6ICZbaTMyOyAyMDBdLCBub2RlOiBpMzIsIHZpc2l0ZWQ6ICZtdXQgW2Jvb2w7IDIwMF0pIC0+IGkzMiB7CiAgICBpZiAoKG5vZGUgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICAKICAgIGlmICgodmlzaXRlZFtub2RlIGFzIHVzaXplXSkpIHsKICAgICAgICByZXR1cm4gMTsKICAgIH0KICAgIAogICAgdmlzaXRlZFtub2RlIGFzIHVzaXplXSA9IHRydWU7CiAgICAKICAgIGxldCBsZWZ0X2N5Y2xlOiBpMzIgPSBwZXJmb3JtX2Rmc19jeWNsZV9kZXRlY3Rpb24obm9kZXMsIGxlZnQsIHJpZ2h0LCBwYXJlbnQsIGhlaWdodCwgc3VidHJlZV9zaXplLCBsZWZ0W25vZGUgYXMgdXNpemVdLCB2aXNpdGVkKTsKICAgIGxldCByaWdodF9jeWNsZTogaTMyID0gcGVyZm9ybV9kZnNfY3ljbGVfZGV0ZWN0aW9uKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcmlnaHRbbm9kZSBhcyB1c2l6ZV0sIHZpc2l0ZWQpOwogICAgCiAgICB2aXNpdGVkW25vZGUgYXMgdXNpemVdID0gZmFsc2U7CiAgICAKICAgIGxlZnRfY3ljbGUgKyByaWdodF9jeWNsZQp9CgpmbiBjaGVja19iYWxhbmNlX2NvbnNpc3RlbmN5KG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyKSAtPiBpMzIgewogICAgaWYgKChub2RlID09IC0xKSkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgCiAgICBsZXQgbGVmdF9oZWlnaHQ6IGkzMiA9IGlmICgobGVmdFtub2RlIGFzIHVzaXplXSA9PSAtMSkpIHsgMCB9IGVsc2UgeyBoZWlnaHRbKGxlZnRbbm9kZSBhcyB1c2l6ZV0pIGFzIHVzaXplXSB9OwogICAgbGV0IHJpZ2h0X2hlaWdodDogaTMyID0gaWYgKChyaWdodFtub2RlIGFzIHVzaXplXSA9PSAtMSkpIHsgMCB9IGVsc2UgeyBoZWlnaHRbKHJpZ2h0W25vZGUgYXMgdXNpemVdKSBhcyB1c2l6ZV0gfTsKICAgIAogICAgbGV0IGJhbGFuY2VfZmFjdG9yOiBpMzIgPSBhYnMobGVmdF9oZWlnaHQgLSByaWdodF9oZWlnaHQpOwogICAgbGV0IGJhbGFuY2Vfc2NvcmU6IGkzMiA9IGlmICgoYmFsYW5jZV9mYWN0b3IgPD0gMykpIHsgMTAgfSBlbHNlIHsgMCB9OwogICAgCiAgICBsZXQgbGVmdF9iYWxhbmNlOiBpMzIgPSBjaGVja19iYWxhbmNlX2NvbnNpc3RlbmN5KG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgbGVmdFtub2RlIGFzIHVzaXplXSk7CiAgICBsZXQgcmlnaHRfYmFsYW5jZTogaTMyID0gY2hlY2tfYmFsYW5jZV9jb25zaXN0ZW5jeShub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdKTsKICAgIAogICAgYmFsYW5jZV9zY29yZSArIGxlZnRfYmFsYW5jZSArIHJpZ2h0X2JhbGFuY2UKfQoKZm4gdmFsaWRhdGVfZWRnZV9jYXNlc19hbmRfYm91bmRhcmllcyhub2RlczogJltpMzI7IDIwMF0sIGxlZnQ6ICZbaTMyOyAyMDBdLCByaWdodDogJltpMzI7IDIwMF0sIHBhcmVudDogJltpMzI7IDIwMF0sIGhlaWdodDogJltpMzI7IDIwMF0sIHN1YnRyZWVfc2l6ZTogJltpMzI7IDIwMF0sIHJvb3Q6IGkzMiwgbm9kZV9jb3VudDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBlZGdlX2Nhc2Vfc2NvcmU6IGkzMiA9IDA7CiAgICAKICAgIGlmICgocm9vdCA9PSAtMSAmJiBub2RlX2NvdW50ID09IDApKSB7CiAgICAgICAgZWRnZV9jYXNlX3Njb3JlID0gZWRnZV9jYXNlX3Njb3JlICsgNTA7CiAgICB9CiAgICAKICAgIGlmICgocm9vdCAhPSAtMSAmJiBwYXJlbnRbcm9vdCBhcyB1c2l6ZV0gPT0gLTEpKSB7CiAgICAgICAgZWRnZV9jYXNlX3Njb3JlID0gZWRnZV9jYXNlX3Njb3JlICsgMzA7CiAgICB9CiAgICAKICAgIGxldCBzaW5nbGVfbm9kZV90cmVlczogaTMyID0gY291bnRfc2luZ2xlX25vZGVfc3VidHJlZXMobm9kZXMsIGxlZnQsIHJpZ2h0LCBwYXJlbnQsIGhlaWdodCwgc3VidHJlZV9zaXplLCByb290KTsKICAgIGVkZ2VfY2FzZV9zY29yZSA9IGVkZ2VfY2FzZV9zY29yZSArIHNpbmdsZV9ub2RlX3RyZWVzICogNTsKICAgIAogICAgbGV0IGxlYWZfbm9kZXM6IGkzMiA9IGNvdW50X2xlYWZfbm9kZXMobm9kZXMsIGxlZnQsIHJpZ2h0LCBwYXJlbnQsIGhlaWdodCwgc3VidHJlZV9zaXplLCByb290KTsKICAgIGxldCBpbnRlcm5hbF9ub2RlczogaTMyID0gbm9kZV9jb3VudCAtIGxlYWZfbm9kZXM7CiAgICAKICAgIGlmICgobGVhZl9ub2RlcyA+IDAgJiYgaW50ZXJuYWxfbm9kZXMgPj0gMCkpIHsKICAgICAgICBlZGdlX2Nhc2Vfc2NvcmUgPSBlZGdlX2Nhc2Vfc2NvcmUgKyAyNTsKICAgIH0KICAgIAogICAgbGV0IG1heF9kZXB0aDogaTMyID0gZmluZF9tYXhpbXVtX2RlcHRoKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgcm9vdCwgMCk7CiAgICBpZiAoKG1heF9kZXB0aCA+IDAgJiYgbWF4X2RlcHRoIDw9IG5vZGVfY291bnQpKSB7CiAgICAgICAgZWRnZV9jYXNlX3Njb3JlID0gZWRnZV9jYXNlX3Njb3JlICsgMjA7CiAgICB9CiAgICAKICAgIGVkZ2VfY2FzZV9zY29yZQp9CgpmbiBjb3VudF9zaW5nbGVfbm9kZV9zdWJ0cmVlcyhub2RlczogJltpMzI7IDIwMF0sIGxlZnQ6ICZbaTMyOyAyMDBdLCByaWdodDogJltpMzI7IDIwMF0sIHBhcmVudDogJltpMzI7IDIwMF0sIGhlaWdodDogJltpMzI7IDIwMF0sIHN1YnRyZWVfc2l6ZTogJltpMzI7IDIwMF0sIG5vZGU6IGkzMikgLT4gaTMyIHsKICAgIGlmICgobm9kZSA9PSAtMSkpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIAogICAgbGV0IGlzX3NpbmdsZV9ub2RlOiBpMzIgPSBpZiAoKGxlZnRbbm9kZSBhcyB1c2l6ZV0gPT0gLTEgJiYgcmlnaHRbbm9kZSBhcyB1c2l6ZV0gPT0gLTEpKSB7IDEgfSBlbHNlIHsgMCB9OwogICAgCiAgICBsZXQgbGVmdF9zaW5nbGU6IGkzMiA9IGNvdW50X3NpbmdsZV9ub2RlX3N1YnRyZWVzKG5vZGVzLCBsZWZ0LCByaWdodCwgcGFyZW50LCBoZWlnaHQsIHN1YnRyZWVfc2l6ZSwgbGVmdFtub2RlIGFzIHVzaXplXSk7CiAgICBsZXQgcmlnaHRfc2luZ2xlOiBpMzIgPSBjb3VudF9zaW5nbGVfbm9kZV9zdWJ0cmVlcyhub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdKTsKICAgIAogICAgaXNfc2luZ2xlX25vZGUgKyBsZWZ0X3NpbmdsZSArIHJpZ2h0X3NpbmdsZQp9CgpmbiBjb3VudF9sZWFmX25vZGVzKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyKSAtPiBpMzIgewogICAgaWYgKChub2RlID09IC0xKSkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgCiAgICBpZiAoKGxlZnRbbm9kZSBhcyB1c2l6ZV0gPT0gLTEgJiYgcmlnaHRbbm9kZSBhcyB1c2l6ZV0gPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CiAgICAKICAgIGxldCBsZWZ0X2xlYXZlczogaTMyID0gY291bnRfbGVhZl9ub2Rlcyhub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIGxlZnRbbm9kZSBhcyB1c2l6ZV0pOwogICAgbGV0IHJpZ2h0X2xlYXZlczogaTMyID0gY291bnRfbGVhZl9ub2Rlcyhub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdKTsKICAgIAogICAgbGVmdF9sZWF2ZXMgKyByaWdodF9sZWF2ZXMKfQoKZm4gZmluZF9tYXhpbXVtX2RlcHRoKG5vZGVzOiAmW2kzMjsgMjAwXSwgbGVmdDogJltpMzI7IDIwMF0sIHJpZ2h0OiAmW2kzMjsgMjAwXSwgcGFyZW50OiAmW2kzMjsgMjAwXSwgaGVpZ2h0OiAmW2kzMjsgMjAwXSwgc3VidHJlZV9zaXplOiAmW2kzMjsgMjAwXSwgbm9kZTogaTMyLCBjdXJyZW50X2RlcHRoOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoKG5vZGUgPT0gLTEpKSB7CiAgICAgICAgcmV0dXJuIGN1cnJlbnRfZGVwdGg7CiAgICB9CiAgICAKICAgIGxldCBsZWZ0X2RlcHRoOiBpMzIgPSBmaW5kX21heGltdW1fZGVwdGgobm9kZXMsIGxlZnQsIHJpZ2h0LCBwYXJlbnQsIGhlaWdodCwgc3VidHJlZV9zaXplLCBsZWZ0W25vZGUgYXMgdXNpemVdLCBjdXJyZW50X2RlcHRoICsgMSk7CiAgICBsZXQgcmlnaHRfZGVwdGg6IGkzMiA9IGZpbmRfbWF4aW11bV9kZXB0aChub2RlcywgbGVmdCwgcmlnaHQsIHBhcmVudCwgaGVpZ2h0LCBzdWJ0cmVlX3NpemUsIHJpZ2h0W25vZGUgYXMgdXNpemVdLCBjdXJyZW50X2RlcHRoICsgMSk7CiAgICAKICAgIG1heChsZWZ0X2RlcHRoLCByaWdodF9kZXB0aCkKfQ==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (29, "comprehensive29", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEN1c3RvbSBWaXJ0dWFsIE1hY2hpbmUgRXhlY3V0aW9uIFNpbXVsYXRpb24KU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6CkxhcmdlIHN3aXRjaC1jYXNlIHN0eWxlIGRpc3BhdGNoIGZvciBpbnN0cnVjdGlvbiBkZWNvZGluZyAoc2ltdWxhdGVkIHdpdGggaWYtZWxzZSBjaGFpbnMpLgpDb21wbGV4IGFyaXRobWV0aWMgYW5kIGJpdHdpc2Ugb3BlcmF0aW9ucyBmb3IgQUxVIHNpbXVsYXRpb24uClBvaW50ZXItbGlrZSBhcml0aG1ldGljIHVzaW5nIGFycmF5IGluZGljZXMgZm9yIG1lbW9yeSBhbmQgc3RhY2sgYWNjZXNzLgpEZWVwbHkgbmVzdGVkIGNvbmRpdGlvbmFsIGxvZ2ljIGZvciBpbnN0cnVjdGlvbiBleGVjdXRpb24gYW5kIGZsYWcgdXBkYXRlcy4KTG9vcCBwZXJmb3JtYW5jZSBmb3IgcHJvZ3JhbSBleGVjdXRpb24gY3ljbGUgYW5kIG1lbW9yeSBpbml0aWFsaXphdGlvbi4KT3B0aW1pemF0aW9uIG9mIG11bHRpLWRpbWVuc2lvbmFsIGFycmF5IGFjY2Vzc2VzIGZvciByZWdpc3RlciBmaWxlIGFuZCBtZW1vcnkgc2ltdWxhdGlvbi4KRnVuY3Rpb24gY2FsbCBvdmVyaGVhZCBmb3IgaGFuZGxpbmcgVk0gc3Vicm91dGluZXMgYW5kIHN5c3RlbSBjYWxscy4KQnJhbmNoIHByZWRpY3Rpb24gaW4gdGhlIGNvbnRleHQgb2YgZnJlcXVlbnQgY29uZGl0aW9uYWwganVtcHMgaW4gdGhlIFZNIHByb2dyYW0uCiovCgovLyBjb21wcmVoZW5zaXZlMjkucnggLSBDdXN0b20gVmlydHVhbCBNYWNoaW5lIEV4ZWN1dGlvbiBTaW11bGF0aW9uCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIExhcmdlIHN3aXRjaC1jYXNlIHN0eWxlIGRpc3BhdGNoIGZvciBpbnN0cnVjdGlvbiBkZWNvZGluZyAoc2ltdWxhdGVkIHdpdGggaWYtZWxzZSBjaGFpbnMpLgovLyAtIENvbXBsZXggYXJpdGhtZXRpYyBhbmQgYml0d2lzZSBvcGVyYXRpb25zIGZvciBBTFUgc2ltdWxhdGlvbi4KLy8gLSBQb2ludGVyLWxpa2UgYXJpdGhtZXRpYyB1c2luZyBhcnJheSBpbmRpY2VzIGZvciBtZW1vcnkgYW5kIHN0YWNrIGFjY2Vzcy4KLy8gLSBEZWVwbHkgbmVzdGVkIGNvbmRpdGlvbmFsIGxvZ2ljIGZvciBpbnN0cnVjdGlvbiBleGVjdXRpb24gYW5kIGZsYWcgdXBkYXRlcy4KLy8gLSBMb29wIHBlcmZvcm1hbmNlIGZvciBwcm9ncmFtIGV4ZWN1dGlvbiBjeWNsZSBhbmQgbWVtb3J5IGluaXRpYWxpemF0aW9uLgovLyAtIE9wdGltaXphdGlvbiBvZiBtdWx0aS1kaW1lbnNpb25hbCBhcnJheSBhY2Nlc3NlcyBmb3IgcmVnaXN0ZXIgZmlsZSBhbmQgbWVtb3J5IHNpbXVsYXRpb24uCi8vIC0gRnVuY3Rpb24gY2FsbCBvdmVyaGVhZCBmb3IgaGFuZGxpbmcgVk0gc3Vicm91dGluZXMgYW5kIHN5c3RlbSBjYWxscy4KLy8gLSBCcmFuY2ggcHJlZGljdGlvbiBpbiB0aGUgY29udGV4dCBvZiBmcmVxdWVudCBjb25kaXRpb25hbCBqdW1wcyBpbiB0aGUgVk0gcHJvZ3JhbS4KCmNvbnN0IFJFR0lTVEVSX0NPVU5UOiBpMzIgPSAxNjsKY29uc3QgTUVNT1JZX1NJWkU6IGkzMiA9IDIwNDg7CmNvbnN0IFNUQUNLX1NJWkU6IGkzMiA9IDI1NjsKCmZuIGluaXRfdm0oCiAgICByZWdpc3RlcnM6ICZtdXQgW2kzMjsgMTZdLAogICAgbWVtb3J5OiAmbXV0IFtpMzI7IDIwNDhdLAogICAgc3RhY2s6ICZtdXQgW2kzMjsgMjU2XSwKICAgIHBjOiAmbXV0IGkzMiwKICAgIHNwOiAmbXV0IGkzMiwKICAgIHpmOiAmbXV0IGJvb2wsCiAgICBjZjogJm11dCBib29sLAogICAgaGFsdDogJm11dCBib29sLAopIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgUkVHSVNURVJfQ09VTlQpIHsKICAgICAgICByZWdpc3RlcnNbaSBhcyB1c2l6ZV0gPSAwOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBNRU1PUllfU0laRSkgewogICAgICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IDA7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IFNUQUNLX1NJWkUpIHsKICAgICAgICBzdGFja1tpIGFzIHVzaXplXSA9IDA7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgICpwYyA9IDA7CiAgICAqc3AgPSBTVEFDS19TSVpFOwogICAgKnpmID0gZmFsc2U7CiAgICAqY2YgPSBmYWxzZTsKICAgICpoYWx0ID0gZmFsc2U7Cn0KCmZuIGxvYWRfcHJvZ3JhbShtZW1vcnk6ICZtdXQgW2kzMjsgMjA0OF0pIHsKICAgIC8vIEEgY29tcGxleCBwcm9ncmFtIHRvIHRlc3QgdmFyaW91cyBpbnN0cnVjdGlvbnMgYW5kIGxvZ2ljLgogICAgLy8gVGhpcyBwcm9ncmFtIGNhbGN1bGF0ZXMgRmlib25hY2NpIG51bWJlcnMgaXRlcmF0aXZlbHkgYW5kIHJlY3Vyc2l2ZWx5LAogICAgLy8gcGVyZm9ybXMgc29tZSBjb21wbGV4IGFyaXRobWV0aWMsIGFuZCB0ZXN0cyBjb25kaXRpb25hbCBicmFuY2hlcy4KCiAgICAvLyBPcGNvZGVzOgogICAgLy8gMDogSEFMVCwgMTogTU9WX1JFRywgMjogTU9WX0lNTSwgMzogQURELCA0OiBTVUIsIDU6IE1VTCwgNjogRElWCiAgICAvLyA3OiBBTkQsIDg6IE9SLCA5OiBYT1IsIDEwOiBOT1QsIDExOiBTSEwsIDEyOiBTSFIKICAgIC8vIDEzOiBQVVNILCAxNDogUE9QLCAxNTogTE9BRCwgMTY6IFNUT1JFCiAgICAvLyAxNzogSk1QLCAxODogSlosIDE5OiBKTlosIDIwOiBKQywgMjE6IEpOQwogICAgLy8gMjI6IENBTEwsIDIzOiBSRVQsIDI0OiBDTVBfUkVHLCAyNTogQ01QX0lNTQogICAgLy8gMjY6IFBSSU5UX1JFRwoKICAgIGxldCBwcm9ncmFtOiBbaTMyOyAxNjhdID0gWwogICAgICAgIC8vIC0tLSBQYXJ0IDE6IEl0ZXJhdGl2ZSBGaWJvbmFjY2kgLS0tCiAgICAgICAgLy8gUjA6IG4sIFIxOiBhLCBSMjogYiwgUjM6IHRlbXAsIFI0OiBjb3VudGVyCiAgICAgICAgMiwgMCwgMTUsICAgICAgIC8vIE1PViBSMCwgMTUgKENhbGN1bGF0ZSBGaWIoMTUpKQogICAgICAgIDIsIDEsIDAsICAgICAgICAvLyBNT1YgUjEsIDAgIChhID0gMCkKICAgICAgICAyLCAyLCAxLCAgICAgICAgLy8gTU9WIFIyLCAxICAoYiA9IDEpCiAgICAgICAgMSwgNCwgMCwgICAgICAgIC8vIE1PViBSNCwgUjAgKGNvdW50ZXIgPSBuKQogICAgICAgIDI1LCA0LCAxLCAgICAgICAvLyBDTVAgUjQsIDEKICAgICAgICAxOCwgMzYsIDAsICAgICAgLy8gSlogZmliX2l0ZXJfZW5kIChpZiBuIDw9IDEsIGp1bXAgdG8gZW5kKQoKICAgICAgICAvLyBMb29wIHN0YXJ0IChwYz0yMSkKICAgICAgICAxLCAzLCAxLCAgICAgICAgLy8gTU9WIFIzLCBSMSAodGVtcCA9IGEpCiAgICAgICAgMSwgMSwgMiwgICAgICAgIC8vIE1PViBSMSwgUjIgKGEgPSBiKQogICAgICAgIDMsIDIsIDMsIDAsICAgICAvLyBBREQgUjIsIFIzIChiID0gYiArIHRlbXApCiAgICAgICAgNCwgNCwgMSwgMCwgICAgIC8vIFNVQiBSNCwgMQogICAgICAgIDI1LCA0LCAxLCAgICAgICAvLyBDTVAgUjQsIDEKICAgICAgICAxOSwgMjEsIDAsICAgICAgLy8gSk5aIGxvb3Bfc3RhcnQKCiAgICAgICAgLy8gZmliX2l0ZXJfZW5kIChwYz0zNikKICAgICAgICAyNiwgMSwgMCwgICAgICAgLy8gUFJJTlRfUkVHIFIxIChQcmludCByZXN1bHQgb2YgaXRlcmF0aXZlIGZpYikKCiAgICAgICAgLy8gLS0tIFBhcnQgMjogUmVjdXJzaXZlIEZpYm9uYWNjaSBTZXR1cCAtLS0KICAgICAgICAyLCAwLCAxMCwgICAgICAgLy8gTU9WIFIwLCAxMCAoQ2FsY3VsYXRlIEZpYigxMCkgcmVjdXJzaXZlbHkpCiAgICAgICAgMTMsIDAsIDAsICAgICAgIC8vIFBVU0ggUjAKICAgICAgICAyMiwgODEsIDAsICAgICAgLy8gQ0FMTCBmaWJfcmVjdXJzaXZlCiAgICAgICAgMTQsIDEsIDAsICAgICAgIC8vIFBPUCBSMSAoZ2V0IHJlc3VsdCkKICAgICAgICAyNiwgMSwgMCwgICAgICAgLy8gUFJJTlRfUkVHIFIxCgogICAgICAgIC8vIC0tLSBQYXJ0IDM6IENvbXBsZXggYXJpdGhtZXRpYyBhbmQgYml0d2lzZSBvcHMgLS0tCiAgICAgICAgMiwgNSwgMTIzNDUsICAgIC8vIE1PViBSNSwgMTIzNDUKICAgICAgICAyLCA2LCA1NDMyMSwgICAgLy8gTU9WIFI2LCA1NDMyMQogICAgICAgIDcsIDUsIDYsIDAsICAgICAvLyBBTkQgUjUsIFI2CiAgICAgICAgMjYsIDUsIDAsICAgICAgIC8vIFBSSU5UX1JFRyBSNQogICAgICAgIDIsIDUsIDEyMzQ1LCAgICAvLyBSZXNldCBSNQogICAgICAgIDgsIDUsIDYsIDAsICAgICAvLyBPUiBSNSwgUjYKICAgICAgICAyNiwgNSwgMCwgICAgICAgLy8gUFJJTlRfUkVHIFI1CiAgICAgICAgMTEsIDUsIDMsIDAsICAgIC8vIFNITCBSNSwgMwogICAgICAgIDI2LCA1LCAwLCAgICAgICAvLyBQUklOVF9SRUcgUjUKICAgICAgICAxMiwgNSwgNSwgMCwgICAgLy8gU0hSIFI1LCA1CiAgICAgICAgMjYsIDUsIDAsICAgICAgIC8vIFBSSU5UX1JFRyBSNQoKICAgICAgICAwLCAwLCAwLCAgICAgICAgLy8gSEFMVAoKICAgICAgICAvLyAtLS0gZmliX3JlY3Vyc2l2ZSBmdW5jdGlvbiAocGM9ODEpIC0tLQogICAgICAgIC8vIEFyZyBpcyBvbiBzdGFjaywgUjAgaXMgdXNlZCBmb3IgY2FsY3VsYXRpb25zCiAgICAgICAgMTMsIDE0LCAwLCAgICAgIC8vIFBVU0ggUjE0IChsaW5rIHJlZ2lzdGVyKQogICAgICAgIDEzLCAyLCAwLCAgICAgICAvLyBQVVNIIFIyCiAgICAgICAgMTMsIDMsIDAsICAgICAgIC8vIFBVU0ggUjMKCiAgICAgICAgLy8gTG9hZCBhcmd1bWVudAogICAgICAgIDE1LCAwLCAxLCA0LCAgICAvLyBMT0FEIFIwLCBbU1ArNF0gKGFyZyBpcyBhdCBzcCs0KndvcmRfc2l6ZSwgc2ltcGxpZmllZCBoZXJlKQogICAgICAgIAogICAgICAgIDI1LCAwLCAyLCAgICAgICAvLyBDTVAgUjAsIDIKICAgICAgICAyMCwgMTA4LCAwLCAgICAgLy8gSkMgZmliX2Jhc2VfY2FzZSAoaWYgbiA8IDIpCgogICAgICAgIC8vIFJlY3Vyc2l2ZSBzdGVwCiAgICAgICAgNCwgMCwgMSwgMCwgICAgIC8vIFNVQiBSMCwgMSAobi0xKQogICAgICAgIDEzLCAwLCAwLCAgICAgICAvLyBQVVNIIFIwCiAgICAgICAgMjIsIDgxLCAwLCAgICAgIC8vIENBTEwgZmliX3JlY3Vyc2l2ZQogICAgICAgIDE0LCAyLCAwLCAgICAgICAvLyBQT1AgUjIgKHJlc3VsdCBvZiBmaWIobi0xKSkKCiAgICAgICAgNCwgMCwgMSwgMCwgICAgIC8vIFNVQiBSMCwgMSAobi0yKQogICAgICAgIDEzLCAwLCAwLCAgICAgICAvLyBQVVNIIFIwCiAgICAgICAgMjIsIDgxLCAwLCAgICAgIC8vIENBTEwgZmliX3JlY3Vyc2l2ZQogICAgICAgIDE0LCAzLCAwLCAgICAgICAvLyBQT1AgUjMgKHJlc3VsdCBvZiBmaWIobi0yKSkKCiAgICAgICAgMywgMCwgMiwgMywgICAgIC8vIEFERCBSMCwgUjIsIFIzCiAgICAgICAgMTcsIDExNCwgMCwgICAgIC8vIEpNUCBmaWJfZW5kCgogICAgICAgIC8vIGZpYl9iYXNlX2Nhc2UgKHBjPTEwOCkKICAgICAgICAxNSwgMCwgMSwgNCwgICAgLy8gTE9BRCBSMCwgW1NQKzRdCiAgICAgICAgCiAgICAgICAgLy8gZmliX2VuZCAocGM9MTE0KQogICAgICAgIDE2LCAwLCAxLCA0LCAgICAvLyBTVE9SRSBSMCwgW1NQKzRdIChzdG9yZSByZXR1cm4gdmFsdWUpCiAgICAgICAgMTQsIDMsIDAsICAgICAgIC8vIFBPUCBSMwogICAgICAgIDE0LCAyLCAwLCAgICAgICAvLyBQT1AgUjIKICAgICAgICAxNCwgMTQsIDAsICAgICAgLy8gUE9QIFIxNAogICAgICAgIDIzLCAwLCAwICAgICAgICAvLyBSRVQKICAgIF07CgogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAxNjgpIHsKICAgICAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSBwcm9ncmFtW2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKZm4gZmV0Y2hfZGVjb2RlX2V4ZWN1dGUoCiAgICByZWdpc3RlcnM6ICZtdXQgW2kzMjsgMTZdLAogICAgbWVtb3J5OiAmbXV0IFtpMzI7IDIwNDhdLAogICAgc3RhY2s6ICZtdXQgW2kzMjsgMjU2XSwKICAgIHBjOiAmbXV0IGkzMiwKICAgIHNwOiAmbXV0IGkzMiwKICAgIHpmOiAmbXV0IGJvb2wsCiAgICBjZjogJm11dCBib29sLAogICAgaGFsdDogJm11dCBib29sLAopIHsKICAgIHdoaWxlICgoKmhhbHQpID09IGZhbHNlKSB7CiAgICAgICAgaWYgKCgqcGMpIDwgMCB8fCAoKnBjKSA+PSBNRU1PUllfU0laRSkgewogICAgICAgICAgICAqaGFsdCA9IHRydWU7CiAgICAgICAgfQogICAgICAgIGlmICgoKmhhbHQpID09IHRydWUpIHsKICAgICAgICAgICAgLy8gbG9vcCBleGl0CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbGV0IG9wY29kZTogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZV07CiAgICAgICAgICAgICpwYyA9ICgqcGMpICsgMTsKCiAgICAgICAgICAgIC8vIFNpbXVsYXRpbmcgYSBzd2l0Y2ggc3RhdGVtZW50IHdpdGggaWYtZWxzZSBpZgogICAgICAgICAgICBpZiAob3Bjb2RlID09IDApIHsgLy8gSEFMVAogICAgICAgICAgICAgICAgKmhhbHQgPSB0cnVlOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSAxKSB7IC8vIE1PVl9SRUcKICAgICAgICAgICAgICAgIGxldCByX2RzdDogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBsZXQgcl9zcmM6IGkzMiA9IG1lbW9yeVsqcGMgYXMgdXNpemUgKyAxXTsKICAgICAgICAgICAgICAgIHJlZ2lzdGVyc1tyX2RzdCBhcyB1c2l6ZV0gPSByZWdpc3RlcnNbcl9zcmMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgKnBjID0gKCpwYykgKyAyOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSAyKSB7IC8vIE1PVl9JTU0KICAgICAgICAgICAgICAgIGxldCByX2RzdDogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBsZXQgaW1tOiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplICsgMV07CiAgICAgICAgICAgICAgICByZWdpc3RlcnNbcl9kc3QgYXMgdXNpemVdID0gaW1tOwogICAgICAgICAgICAgICAgKnBjID0gKCpwYykgKyAyOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSAzKSB7IC8vIEFERAogICAgICAgICAgICAgICAgbGV0IHJfZHN0OiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGxldCByX3NyYzogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICAgICAgbGV0IHJlczogaTMyID0gcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSArIHJlZ2lzdGVyc1tyX3NyYyBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAvLyBTaW1wbGlmaWVkIG92ZXJmbG93IGNoZWNrCiAgICAgICAgICAgICAgICBpZiAocmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSA+IDAgJiYgcmVnaXN0ZXJzW3Jfc3JjIGFzIHVzaXplXSA+IDAgJiYgcmVzIDwgMCkgewogICAgICAgICAgICAgICAgICAgICpjZiA9IHRydWU7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlZ2lzdGVyc1tyX2RzdCBhcyB1c2l6ZV0gPCAwICYmIHJlZ2lzdGVyc1tyX3NyYyBhcyB1c2l6ZV0gPCAwICYmIHJlcyA+IDApIHsKICAgICAgICAgICAgICAgICAgICAqY2YgPSB0cnVlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAqY2YgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJlZ2lzdGVyc1tyX2RzdCBhcyB1c2l6ZV0gPSByZXM7CiAgICAgICAgICAgICAgICAqemYgPSByZXMgPT0gMDsKICAgICAgICAgICAgICAgICpwYyA9ICgqcGMpICsgMjsKICAgICAgICAgICAgfSBlbHNlIGlmIChvcGNvZGUgPT0gNCkgeyAvLyBTVUIKICAgICAgICAgICAgICAgIGxldCByX2RzdDogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBsZXQgcl9zcmM6IGkzMiA9IG1lbW9yeVsqcGMgYXMgdXNpemUgKyAxXTsKICAgICAgICAgICAgICAgIGxldCByZXM6IGkzMiA9IHJlZ2lzdGVyc1tyX2RzdCBhcyB1c2l6ZV0gLSByZWdpc3RlcnNbcl9zcmMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgLy8gU2ltcGxpZmllZCBib3Jyb3cgY2hlY2sKICAgICAgICAgICAgICAgIGlmIChyZWdpc3RlcnNbcl9kc3QgYXMgdXNpemVdID4gMCAmJiByZWdpc3RlcnNbcl9zcmMgYXMgdXNpemVdIDwgMCAmJiByZXMgPCAwKSB7CiAgICAgICAgICAgICAgICAgICAgKmNmID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSA8IDAgJiYgcmVnaXN0ZXJzW3Jfc3JjIGFzIHVzaXplXSA+IDAgJiYgcmVzID4gMCkgewogICAgICAgICAgICAgICAgICAgICpjZiA9IHRydWU7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICpjZiA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSA9IHJlczsKICAgICAgICAgICAgICAgICp6ZiA9IHJlcyA9PSAwOwogICAgICAgICAgICAgICAgKnBjID0gKCpwYykgKyAyOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSA1KSB7IC8vIE1VTAogICAgICAgICAgICAgICAgbGV0IHJfZHN0OiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGxldCByX3NyYzogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICAgICAgcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSA9IHJlZ2lzdGVyc1tyX2RzdCBhcyB1c2l6ZV0gKiByZWdpc3RlcnNbcl9zcmMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgKnpmID0gcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSA9PSAwOwogICAgICAgICAgICAgICAgKnBjID0gKCpwYykgKyAyOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSA2KSB7IC8vIERJVgogICAgICAgICAgICAgICAgbGV0IHJfZHN0OiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGxldCByX3NyYzogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICAgICAgaWYgKHJlZ2lzdGVyc1tyX3NyYyBhcyB1c2l6ZV0gIT0gMCkgewogICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyc1tyX2RzdCBhcyB1c2l6ZV0gPSByZWdpc3RlcnNbcl9kc3QgYXMgdXNpemVdIC8gcmVnaXN0ZXJzW3Jfc3JjIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgKmhhbHQgPSB0cnVlOyAvLyBEaXZpc2lvbiBieSB6ZXJvCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgKnpmID0gcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSA9PSAwOwogICAgICAgICAgICAgICAgKnBjID0gKCpwYykgKyAyOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSA3KSB7IC8vIEFORAogICAgICAgICAgICAgICAgbGV0IHJfZHN0OiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGxldCByX3NyYzogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICAgICAgcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSA9IHJlZ2lzdGVyc1tyX2RzdCBhcyB1c2l6ZV0gJiByZWdpc3RlcnNbcl9zcmMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgKnpmID0gcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSA9PSAwOwogICAgICAgICAgICAgICAgKnBjID0gKCpwYykgKyAyOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSA4KSB7IC8vIE9SCiAgICAgICAgICAgICAgICBsZXQgcl9kc3Q6IGkzMiA9IG1lbW9yeVsqcGMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgbGV0IHJfc3JjOiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplICsgMV07CiAgICAgICAgICAgICAgICByZWdpc3RlcnNbcl9kc3QgYXMgdXNpemVdID0gcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSB8IHJlZ2lzdGVyc1tyX3NyYyBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAqemYgPSByZWdpc3RlcnNbcl9kc3QgYXMgdXNpemVdID09IDA7CiAgICAgICAgICAgICAgICAqcGMgPSAoKnBjKSArIDI7CiAgICAgICAgICAgIH0gZWxzZSBpZiAob3Bjb2RlID09IDkpIHsgLy8gWE9SCiAgICAgICAgICAgICAgICBsZXQgcl9kc3Q6IGkzMiA9IG1lbW9yeVsqcGMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgbGV0IHJfc3JjOiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplICsgMV07CiAgICAgICAgICAgICAgICByZWdpc3RlcnNbcl9kc3QgYXMgdXNpemVdID0gcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSBeIHJlZ2lzdGVyc1tyX3NyYyBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAqemYgPSByZWdpc3RlcnNbcl9kc3QgYXMgdXNpemVdID09IDA7CiAgICAgICAgICAgICAgICAqcGMgPSAoKnBjKSArIDI7CiAgICAgICAgICAgIH0gZWxzZSBpZiAob3Bjb2RlID09IDEwKSB7IC8vIE5PVAogICAgICAgICAgICAgICAgbGV0IHJfZHN0OiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIHJlZ2lzdGVyc1tyX2RzdCBhcyB1c2l6ZV0gPSAhcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICp6ZiA9IHJlZ2lzdGVyc1tyX2RzdCBhcyB1c2l6ZV0gPT0gMDsKICAgICAgICAgICAgICAgICpwYyA9ICgqcGMpICsgMTsKICAgICAgICAgICAgfSBlbHNlIGlmIChvcGNvZGUgPT0gMTEpIHsgLy8gU0hMCiAgICAgICAgICAgICAgICBsZXQgcl9kc3Q6IGkzMiA9IG1lbW9yeVsqcGMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgbGV0IGltbTogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICAgICAgcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSA9IHJlZ2lzdGVyc1tyX2RzdCBhcyB1c2l6ZV0gPDwgKGltbSBhcyB1MzIpOwogICAgICAgICAgICAgICAgKnpmID0gcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSA9PSAwOwogICAgICAgICAgICAgICAgKnBjID0gKCpwYykgKyAyOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSAxMikgeyAvLyBTSFIKICAgICAgICAgICAgICAgIGxldCByX2RzdDogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBsZXQgaW1tOiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplICsgMV07CiAgICAgICAgICAgICAgICByZWdpc3RlcnNbcl9kc3QgYXMgdXNpemVdID0gcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSA+PiAoaW1tIGFzIHUzMik7CiAgICAgICAgICAgICAgICAqemYgPSByZWdpc3RlcnNbcl9kc3QgYXMgdXNpemVdID09IDA7CiAgICAgICAgICAgICAgICAqcGMgPSAoKnBjKSArIDI7CiAgICAgICAgICAgIH0gZWxzZSBpZiAob3Bjb2RlID09IDEzKSB7IC8vIFBVU0gKICAgICAgICAgICAgICAgIGxldCByX3NyYzogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAqc3AgPSAoKnNwKSAtIDE7CiAgICAgICAgICAgICAgICBzdGFja1sqc3AgYXMgdXNpemVdID0gcmVnaXN0ZXJzW3Jfc3JjIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICpwYyA9ICgqcGMpICsgMTsKICAgICAgICAgICAgfSBlbHNlIGlmIChvcGNvZGUgPT0gMTQpIHsgLy8gUE9QCiAgICAgICAgICAgICAgICBsZXQgcl9kc3Q6IGkzMiA9IG1lbW9yeVsqcGMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgcmVnaXN0ZXJzW3JfZHN0IGFzIHVzaXplXSA9IHN0YWNrWypzcCBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAqc3AgPSAoKnNwKSArIDE7CiAgICAgICAgICAgICAgICAqcGMgPSAoKnBjKSArIDE7CiAgICAgICAgICAgIH0gZWxzZSBpZiAob3Bjb2RlID09IDE1KSB7IC8vIExPQUQKICAgICAgICAgICAgICAgIGxldCByX2RzdDogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBsZXQgcl9hZGRyOiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplICsgMV07CiAgICAgICAgICAgICAgICBsZXQgb2Zmc2V0OiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplICsgMl07CiAgICAgICAgICAgICAgICBsZXQgYWRkcjogaTMyID0gcmVnaXN0ZXJzW3JfYWRkciBhcyB1c2l6ZV0gKyBvZmZzZXQ7CiAgICAgICAgICAgICAgICBpZiAoYWRkciA+PSAwICYmIGFkZHIgPCBNRU1PUllfU0laRSkgewogICAgICAgICAgICAgICAgICAgIHJlZ2lzdGVyc1tyX2RzdCBhcyB1c2l6ZV0gPSBtZW1vcnlbYWRkciBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICpoYWx0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAqcGMgPSAoKnBjKSArIDM7CiAgICAgICAgICAgIH0gZWxzZSBpZiAob3Bjb2RlID09IDE2KSB7IC8vIFNUT1JFCiAgICAgICAgICAgICAgICBsZXQgcl9zcmM6IGkzMiA9IG1lbW9yeVsqcGMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgbGV0IHJfYWRkcjogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICAgICAgbGV0IG9mZnNldDogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZSArIDJdOwogICAgICAgICAgICAgICAgbGV0IGFkZHI6IGkzMiA9IHJlZ2lzdGVyc1tyX2FkZHIgYXMgdXNpemVdICsgb2Zmc2V0OwogICAgICAgICAgICAgICAgaWYgKGFkZHIgPj0gMCAmJiBhZGRyIDwgTUVNT1JZX1NJWkUpIHsKICAgICAgICAgICAgICAgICAgICBtZW1vcnlbYWRkciBhcyB1c2l6ZV0gPSByZWdpc3RlcnNbcl9zcmMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAqaGFsdCA9IHRydWU7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgKnBjID0gKCpwYykgKyAzOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSAxNykgeyAvLyBKTVAKICAgICAgICAgICAgICAgICpwYyA9IG1lbW9yeVsqcGMgYXMgdXNpemVdOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSAxOCkgeyAvLyBKWgogICAgICAgICAgICAgICAgaWYgKCp6ZikgewogICAgICAgICAgICAgICAgICAgICpwYyA9IG1lbW9yeVsqcGMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAqcGMgPSAoKnBjKSArIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAob3Bjb2RlID09IDE5KSB7IC8vIEpOWgogICAgICAgICAgICAgICAgaWYgKCEqemYpIHsKICAgICAgICAgICAgICAgICAgICAqcGMgPSBtZW1vcnlbKnBjIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgKnBjID0gKCpwYykgKyAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSAyMCkgeyAvLyBKQwogICAgICAgICAgICAgICAgaWYgKCpjZikgewogICAgICAgICAgICAgICAgICAgICpwYyA9IG1lbW9yeVsqcGMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAqcGMgPSAoKnBjKSArIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAob3Bjb2RlID09IDIxKSB7IC8vIEpOQwogICAgICAgICAgICAgICAgaWYgKCEqY2YpIHsKICAgICAgICAgICAgICAgICAgICAqcGMgPSBtZW1vcnlbKnBjIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgKnBjID0gKCpwYykgKyAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSAyMikgeyAvLyBDQUxMCiAgICAgICAgICAgICAgICAqc3AgPSAoKnNwKSAtIDE7CiAgICAgICAgICAgICAgICBzdGFja1sqc3AgYXMgdXNpemVdID0gKCpwYykgKyAxOyAvLyBQdXNoIHJldHVybiBhZGRyZXNzCiAgICAgICAgICAgICAgICAqcGMgPSBtZW1vcnlbKnBjIGFzIHVzaXplXTsKICAgICAgICAgICAgfSBlbHNlIGlmIChvcGNvZGUgPT0gMjMpIHsgLy8gUkVUCiAgICAgICAgICAgICAgICAqcGMgPSBzdGFja1sqc3AgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgKnNwID0gKCpzcCkgKyAxOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wY29kZSA9PSAyNCkgeyAvLyBDTVBfUkVHCiAgICAgICAgICAgICAgICBsZXQgcjE6IGkzMiA9IG1lbW9yeVsqcGMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgbGV0IHIyOiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplICsgMV07CiAgICAgICAgICAgICAgICBsZXQgdmFsMTogaTMyID0gcmVnaXN0ZXJzW3IxIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGxldCB2YWwyOiBpMzIgPSByZWdpc3RlcnNbcjIgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgKnpmID0gdmFsMSA9PSB2YWwyOwogICAgICAgICAgICAgICAgKmNmID0gdmFsMSA8IHZhbDI7CiAgICAgICAgICAgICAgICAqcGMgPSAoKnBjKSArIDI7CiAgICAgICAgICAgIH0gZWxzZSBpZiAob3Bjb2RlID09IDI1KSB7IC8vIENNUF9JTU0KICAgICAgICAgICAgICAgIGxldCByMTogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBsZXQgaW1tOiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplICsgMV07CiAgICAgICAgICAgICAgICBsZXQgdmFsMTogaTMyID0gcmVnaXN0ZXJzW3IxIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICp6ZiA9IHZhbDEgPT0gaW1tOwogICAgICAgICAgICAgICAgKmNmID0gdmFsMSA8IGltbTsKICAgICAgICAgICAgICAgICpwYyA9ICgqcGMpICsgMjsKICAgICAgICAgICAgfSBlbHNlIGlmIChvcGNvZGUgPT0gMjYpIHsgLy8gUFJJTlRfUkVHCiAgICAgICAgICAgICAgICBsZXQgcl9zcmM6IGkzMiA9IG1lbW9yeVsqcGMgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgcHJpbnRsbkludChyZWdpc3RlcnNbcl9zcmMgYXMgdXNpemVdKTsKICAgICAgICAgICAgICAgICpwYyA9ICgqcGMpICsgMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIEludmFsaWQgb3Bjb2RlCiAgICAgICAgICAgICAgICAqaGFsdCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCmZuIG1haW4oKSB7CgogICAgbGV0IG11dCByZWdpc3RlcnM6IFtpMzI7IDE2XSA9IFswOyAxNl07CiAgICBsZXQgbXV0IG1lbW9yeTogW2kzMjsgMjA0OF0gPSBbMDsgMjA0OF07CiAgICBsZXQgbXV0IHN0YWNrOiBbaTMyOyAyNTZdID0gWzA7IDI1Nl07CgogICAgbGV0IG11dCBwYzogaTMyID0gMDsKICAgIGxldCBtdXQgc3A6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHpmOiBib29sID0gZmFsc2U7CiAgICBsZXQgbXV0IGNmOiBib29sID0gZmFsc2U7CiAgICBsZXQgbXV0IGhhbHQ6IGJvb2wgPSBmYWxzZTsKCiAgICBpbml0X3ZtKAogICAgICAgICZtdXQgcmVnaXN0ZXJzLAogICAgICAgICZtdXQgbWVtb3J5LAogICAgICAgICZtdXQgc3RhY2ssCiAgICAgICAgJm11dCBwYywKICAgICAgICAmbXV0IHNwLAogICAgICAgICZtdXQgemYsCiAgICAgICAgJm11dCBjZiwKICAgICAgICAmbXV0IGhhbHQsCiAgICApOwogICAgbG9hZF9wcm9ncmFtKCZtdXQgbWVtb3J5KTsKICAgIGZldGNoX2RlY29kZV9leGVjdXRlKAogICAgICAgICZtdXQgcmVnaXN0ZXJzLAogICAgICAgICZtdXQgbWVtb3J5LAogICAgICAgICZtdXQgc3RhY2ssCiAgICAgICAgJm11dCBwYywKICAgICAgICAmbXV0IHNwLAogICAgICAgICZtdXQgemYsCiAgICAgICAgJm11dCBjZiwKICAgICAgICAmbXV0IGhhbHQsCiAgICApOwogICAgCiAgICAvLyBGaW5hbCBjaGVjayB0byBlbnN1cmUgaGFsdCB3b3JrZWQKICAgIGlmIChoYWx0KSB7CiAgICAgICAgcHJpbnRsbkludCgxMzM3KTsKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnRsbkludCg5OTk5KTsKICAgIH0KICAgIGV4aXQoMCk7Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (30, "comprehensive30", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEFkdmFuY2VkIE1lbW9yeSBNYW5hZ2VtZW50IFNpbXVsYXRpb24KU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6ClNpbXVsYXRpb24gb2YgZHluYW1pYyBtZW1vcnkgYWxsb2NhdGlvbiB3aXRoIGEgc3RhdGljIGJ1ZmZlci4KQ29tcGxleCBhcnJheSBtYW5pcHVsYXRpb24gYW5kIGluZGV4LWJhc2VkIHBvaW50ZXIgYXJpdGhtZXRpYy4KTWFuYWdlbWVudCBvZiBkYXRhIHN0cnVjdHVyZXMgbGlrZSBmcmVlIGxpc3RzIGZvciBtZW1vcnkgYmxvY2tzLgpMb29wLWhlYXZ5IGxvZ2ljIGZvciBzZWFyY2hpbmcgYW5kIGNvYWxlc2NpbmcgbWVtb3J5IGJsb2Nrcy4KT3B0aW1pemF0aW9uIG9mIGNvbmRpdGlvbmFsIGJyYW5jaGVzIGZvciBtZW1vcnkgc3RhdGUgY2hlY2tzLgoqLwoKLy8gY29tcHJlaGVuc2l2ZTMwLnJ4IC0gQWR2YW5jZWQgTWVtb3J5IE1hbmFnZW1lbnQgU2ltdWxhdGlvbgovLyBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKLy8gLSBTaW11bGF0aW9uIG9mIGR5bmFtaWMgbWVtb3J5IGFsbG9jYXRpb24gd2l0aCBhIHN0YXRpYyBidWZmZXIuCi8vIC0gQ29tcGxleCBhcnJheSBtYW5pcHVsYXRpb24gYW5kIGluZGV4LWJhc2VkIHBvaW50ZXIgYXJpdGhtZXRpYy4KLy8gLSBNYW5hZ2VtZW50IG9mIGRhdGEgc3RydWN0dXJlcyBsaWtlIGZyZWUgbGlzdHMgZm9yIG1lbW9yeSBibG9ja3MuCi8vIC0gTG9vcC1oZWF2eSBsb2dpYyBmb3Igc2VhcmNoaW5nIGFuZCBjb2FsZXNjaW5nIG1lbW9yeSBibG9ja3MuCi8vIC0gT3B0aW1pemF0aW9uIG9mIGNvbmRpdGlvbmFsIGJyYW5jaGVzIGZvciBtZW1vcnkgc3RhdGUgY2hlY2tzLgoKY29uc3QgSEVBUF9TSVpFOiB1c2l6ZSA9IDEwMjQ7CmNvbnN0IEJMT0NLX0hFQURFUl9TSVpFOiBpMzIgPSAyOwpjb25zdCBGUkVFX0ZMQUc6IGkzMiA9IDA7CmNvbnN0IFVTRURfRkxBRzogaTMyID0gMTsKCmZuIG1haW4oKSB7CiAgICBsZXQgbXV0IGhlYXA6IFtpMzI7IEhFQVBfU0laRV0gPSBbMDsgSEVBUF9TSVpFXTsKICAgIGxldCBtdXQgZnJlZV9saXN0X2hlYWQ6IGkzMiA9IDA7CgogICAgaW5pdF9oZWFwKCZtdXQgaGVhcCwgJm11dCBmcmVlX2xpc3RfaGVhZCk7CgogICAgbGV0IG11dCBwMTogaTMyID0gMDsKICAgIGxldCBtdXQgcDI6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHAzOiBpMzIgPSAwOwogICAgbGV0IG11dCBwNDogaTMyID0gMDsKICAgIGxldCBtdXQgcDU6IGkzMiA9IDA7CgogICAgcDEgPSBteV9tYWxsb2MoJm11dCBoZWFwLCAmbXV0IGZyZWVfbGlzdF9oZWFkLCAxMDApOwogICAgaWYgKHAxID4gMCkgewogICAgICAgIHByaW50bG5JbnQoMTAwMSk7CiAgICAgICAgZmlsbF9tZW1vcnkoJm11dCBoZWFwLCBwMSwgMTAwLCAxKTsKICAgICAgICB2ZXJpZnlfbWVtb3J5KCZtdXQgaGVhcCwgcDEsIDEwMCwgMSk7CiAgICB9CgogICAgcDIgPSBteV9tYWxsb2MoJm11dCBoZWFwLCAmbXV0IGZyZWVfbGlzdF9oZWFkLCAyMDApOwogICAgaWYgKHAyID4gMCkgewogICAgICAgIHByaW50bG5JbnQoMTAwMik7CiAgICAgICAgZmlsbF9tZW1vcnkoJm11dCBoZWFwLCBwMiwgMjAwLCAyKTsKICAgICAgICB2ZXJpZnlfbWVtb3J5KCZtdXQgaGVhcCwgcDIsIDIwMCwgMik7CiAgICB9CgogICAgcDMgPSBteV9tYWxsb2MoJm11dCBoZWFwLCAmbXV0IGZyZWVfbGlzdF9oZWFkLCAxNTApOwogICAgaWYgKHAzID4gMCkgewogICAgICAgIHByaW50bG5JbnQoMTAwMyk7CiAgICAgICAgZmlsbF9tZW1vcnkoJm11dCBoZWFwLCBwMywgMTUwLCAzKTsKICAgICAgICB2ZXJpZnlfbWVtb3J5KCZtdXQgaGVhcCwgcDMsIDE1MCwgMyk7CiAgICB9CgogICAgbXlfZnJlZSgmbXV0IGhlYXAsICZtdXQgZnJlZV9saXN0X2hlYWQsIHAyKTsKICAgIHZlcmlmeV9tZW1vcnkoJmhlYXAsIHAyLCAyMDAsIDIpOwogICAgcHJpbnRsbkludCgxMDA0KTsKCiAgICBwNCA9IG15X21hbGxvYygmbXV0IGhlYXAsICZtdXQgZnJlZV9saXN0X2hlYWQsIDUwKTsKICAgIGlmIChwNCA+IDApIHsKICAgICAgICBwcmludGxuSW50KDEwMDUpOwogICAgICAgIGZpbGxfbWVtb3J5KCZtdXQgaGVhcCwgcDQsIDUwLCA0KTsKICAgICAgICB2ZXJpZnlfbWVtb3J5KCZoZWFwLCBwNCwgNTAsIDIpOwogICAgfQoKICAgIHA1ID0gbXlfbWFsbG9jKCZtdXQgaGVhcCwgJm11dCBmcmVlX2xpc3RfaGVhZCwgMjUwKTsKICAgIGlmIChwNSA8IDApIHsKICAgICAgICBwcmludGxuSW50KDEwMDYpOwogICAgfQoKICAgIG15X2ZyZWUoJm11dCBoZWFwLCAmbXV0IGZyZWVfbGlzdF9oZWFkLCBwMSk7CiAgICBteV9mcmVlKCZtdXQgaGVhcCwgJm11dCBmcmVlX2xpc3RfaGVhZCwgcDMpOwogICAgbXlfZnJlZSgmbXV0IGhlYXAsICZtdXQgZnJlZV9saXN0X2hlYWQsIHA0KTsKICAgIHByaW50bG5JbnQoMTAwNyk7CgogICAgcDEgPSBteV9tYWxsb2MoJm11dCBoZWFwLCAmbXV0IGZyZWVfbGlzdF9oZWFkLCA4MDApOwogICAgaWYgKHAxID4gMCkgewogICAgICAgIHByaW50bG5JbnQoMTAwOCk7CiAgICAgICAgZmlsbF9tZW1vcnkoJm11dCBoZWFwLCBwMSwgODAwLCA1KTsKICAgICAgICB2ZXJpZnlfbWVtb3J5KCZtdXQgaGVhcCwgcDEsIDgwMCwgNSk7CiAgICB9CgogICAgcHJpbnRsbkludCg5OTk5KTsKICAgIGV4aXQoMCk7Cn0KCmZuIGluaXRfaGVhcChoZWFwOiAmbXV0IFtpMzI7IEhFQVBfU0laRV0sIGZyZWVfbGlzdF9oZWFkOiAmbXV0IGkzMikgewogICAgaGVhcFswXSA9IEhFQVBfU0laRSBhcyBpMzIgLSBCTE9DS19IRUFERVJfU0laRTsKICAgIGhlYXBbMV0gPSBGUkVFX0ZMQUc7CiAgICBoZWFwWzJdID0gLTE7CiAgICAqZnJlZV9saXN0X2hlYWQgPSAwOwp9CgpmbiBteV9tYWxsb2MoaGVhcDogJm11dCBbaTMyOyBIRUFQX1NJWkVdLCBmcmVlX2xpc3RfaGVhZDogJm11dCBpMzIsIHNpemU6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgY3VycmVudDogaTMyID0gKmZyZWVfbGlzdF9oZWFkOwogICAgbGV0IG11dCBwcmV2OiBpMzIgPSAtMTsKICAgIGxldCByZXF1aXJlZF9zaXplOiBpMzIgPSBzaXplOwoKICAgIHdoaWxlIChjdXJyZW50ICE9IC0xKSB7CiAgICAgICAgbGV0IGJsb2NrX3NpemU6IGkzMiA9IGhlYXBbY3VycmVudCBhcyB1c2l6ZV07CiAgICAgICAgbGV0IGlzX2ZyZWU6IGkzMiA9IGhlYXBbY3VycmVudCBhcyB1c2l6ZSArIDFdOwoKICAgICAgICBpZiAoaXNfZnJlZSA9PSBGUkVFX0ZMQUcgJiYgYmxvY2tfc2l6ZSA+PSByZXF1aXJlZF9zaXplKSB7CiAgICAgICAgICAgIGxldCByZW1haW5pbmdfc2l6ZTogaTMyID0gYmxvY2tfc2l6ZSAtIHJlcXVpcmVkX3NpemUgLSBCTE9DS19IRUFERVJfU0laRTsKICAgICAgICAgICAgaWYgKHJlbWFpbmluZ19zaXplID4gQkxPQ0tfSEVBREVSX1NJWkUpIHsKICAgICAgICAgICAgICAgIGxldCBuZXdfYmxvY2tfcG9zOiBpMzIgPSBjdXJyZW50ICsgQkxPQ0tfSEVBREVSX1NJWkUgKyByZXF1aXJlZF9zaXplOwogICAgICAgICAgICAgICAgaGVhcFtuZXdfYmxvY2tfcG9zIGFzIHVzaXplXSA9IHJlbWFpbmluZ19zaXplOwogICAgICAgICAgICAgICAgaGVhcFtuZXdfYmxvY2tfcG9zIGFzIHVzaXplICsgMV0gPSBGUkVFX0ZMQUc7CiAgICAgICAgICAgICAgICBoZWFwW25ld19ibG9ja19wb3MgYXMgdXNpemUgKyAyXSA9IGhlYXBbY3VycmVudCBhcyB1c2l6ZSArIDJdOwoKICAgICAgICAgICAgICAgIGhlYXBbY3VycmVudCBhcyB1c2l6ZV0gPSByZXF1aXJlZF9zaXplOwogICAgICAgICAgICAgICAgaGVhcFtjdXJyZW50IGFzIHVzaXplICsgMV0gPSBVU0VEX0ZMQUc7CiAgICAgICAgICAgICAgICBoZWFwW2N1cnJlbnQgYXMgdXNpemUgKyAyXSA9IG5ld19ibG9ja19wb3M7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBoZWFwW2N1cnJlbnQgYXMgdXNpemUgKyAxXSA9IFVTRURfRkxBRzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHByZXYgPT0gLTEpIHsKICAgICAgICAgICAgICAgIGlmIChyZW1haW5pbmdfc2l6ZSA+IEJMT0NLX0hFQURFUl9TSVpFKSB7CiAgICAgICAgICAgICAgICAgICAgKmZyZWVfbGlzdF9oZWFkID0gY3VycmVudCArIEJMT0NLX0hFQURFUl9TSVpFICsgcmVxdWlyZWRfc2l6ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgKmZyZWVfbGlzdF9oZWFkID0gaGVhcFtjdXJyZW50IGFzIHVzaXplICsgMl07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAocmVtYWluaW5nX3NpemUgPiBCTE9DS19IRUFERVJfU0laRSkgewogICAgICAgICAgICAgICAgICAgIGhlYXBbcHJldiBhcyB1c2l6ZSArIDJdID0gY3VycmVudCArIEJMT0NLX0hFQURFUl9TSVpFICsgcmVxdWlyZWRfc2l6ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaGVhcFtwcmV2IGFzIHVzaXplICsgMl0gPSBoZWFwW2N1cnJlbnQgYXMgdXNpemUgKyAyXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gY3VycmVudCArIEJMT0NLX0hFQURFUl9TSVpFOwogICAgICAgIH0KICAgICAgICBwcmV2ID0gY3VycmVudDsKICAgICAgICBjdXJyZW50ID0gaGVhcFtjdXJyZW50IGFzIHVzaXplICsgMl07CiAgICB9CiAgICByZXR1cm4gLTE7Cn0KCmZuIG15X2ZyZWUoaGVhcDogJm11dCBbaTMyOyBIRUFQX1NJWkVdLCBmcmVlX2xpc3RfaGVhZDogJm11dCBpMzIsIHB0cjogaTMyKSB7CiAgICBpZiAocHRyIDw9IEJMT0NLX0hFQURFUl9TSVpFKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgbGV0IGJsb2NrX3N0YXJ0OiBpMzIgPSBwdHIgLSBCTE9DS19IRUFERVJfU0laRTsKICAgIGhlYXBbYmxvY2tfc3RhcnQgYXMgdXNpemUgKyAxXSA9IEZSRUVfRkxBRzsKCiAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9ICpmcmVlX2xpc3RfaGVhZDsKICAgIGxldCBtdXQgcHJldjogaTMyID0gLTE7CiAgICB3aGlsZSAoY3VycmVudCAhPSAtMSAmJiBjdXJyZW50IDwgYmxvY2tfc3RhcnQpIHsKICAgICAgICBwcmV2ID0gY3VycmVudDsKICAgICAgICBjdXJyZW50ID0gaGVhcFtjdXJyZW50IGFzIHVzaXplICsgMl07CiAgICB9CgogICAgaWYgKHByZXYgPT0gLTEpIHsKICAgICAgICBoZWFwW2Jsb2NrX3N0YXJ0IGFzIHVzaXplICsgMl0gPSAqZnJlZV9saXN0X2hlYWQ7CiAgICAgICAgKmZyZWVfbGlzdF9oZWFkID0gYmxvY2tfc3RhcnQ7CiAgICB9IGVsc2UgewogICAgICAgIGhlYXBbYmxvY2tfc3RhcnQgYXMgdXNpemUgKyAyXSA9IGhlYXBbcHJldiBhcyB1c2l6ZSArIDJdOwogICAgICAgIGhlYXBbcHJldiBhcyB1c2l6ZSArIDJdID0gYmxvY2tfc3RhcnQ7CiAgICB9CgogICAgY29hbGVzY2UoaGVhcCwgKmZyZWVfbGlzdF9oZWFkKTsKfQoKZm4gY29hbGVzY2UoaGVhcDogJm11dCBbaTMyOyBIRUFQX1NJWkVdLCBmcmVlX2xpc3RfaGVhZDogaTMyKSB7CiAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9IGZyZWVfbGlzdF9oZWFkOwogICAgd2hpbGUgKGN1cnJlbnQgIT0gLTEpIHsKICAgICAgICBsZXQgbmV4dF9wdHJfaW5fbGlzdDogaTMyID0gaGVhcFtjdXJyZW50IGFzIHVzaXplICsgMl07CiAgICAgICAgbGV0IGJsb2NrX3NpemU6IGkzMiA9IGhlYXBbY3VycmVudCBhcyB1c2l6ZV07CiAgICAgICAgbGV0IHBoeXNpY2FsX25leHRfYmxvY2s6IGkzMiA9IGN1cnJlbnQgKyBCTE9DS19IRUFERVJfU0laRSArIGJsb2NrX3NpemU7CgogICAgICAgIGlmIChwaHlzaWNhbF9uZXh0X2Jsb2NrID09IG5leHRfcHRyX2luX2xpc3QpIHsKICAgICAgICAgICAgbGV0IG5leHRfYmxvY2tfc2l6ZTogaTMyID0gaGVhcFtuZXh0X3B0cl9pbl9saXN0IGFzIHVzaXplXTsKICAgICAgICAgICAgbGV0IG5ld19zaXplOiBpMzIgPSBibG9ja19zaXplICsgQkxPQ0tfSEVBREVSX1NJWkUgKyBuZXh0X2Jsb2NrX3NpemU7CiAgICAgICAgICAgIGhlYXBbY3VycmVudCBhcyB1c2l6ZV0gPSBuZXdfc2l6ZTsKICAgICAgICAgICAgaGVhcFtjdXJyZW50IGFzIHVzaXplICsgMl0gPSBoZWFwW25leHRfcHRyX2luX2xpc3QgYXMgdXNpemUgKyAyXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjdXJyZW50ID0gaGVhcFtjdXJyZW50IGFzIHVzaXplICsgMl07CiAgICAgICAgfQogICAgfQp9CgpmbiBmaWxsX21lbW9yeShoZWFwOiAmbXV0IFtpMzI7IEhFQVBfU0laRV0sIHN0YXJ0OiBpMzIsIHNpemU6IGkzMiwgdmFsdWU6IGkzMikgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBzaXplKSB7CiAgICAgICAgaGVhcFsoc3RhcnQgKyBpKSBhcyB1c2l6ZV0gPSB2YWx1ZSAqIDEwMDAwICsgaTsKICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCmZuIHZlcmlmeV9tZW1vcnkoaGVhcDogJltpMzI7IEhFQVBfU0laRV0sIHN0YXJ0OiBpMzIsIHNpemU6IGkzMiwgdmFsdWU6IGkzMikgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgbGV0IG11dCBlcnJvcnM6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IHNpemUpIHsKICAgICAgICBpZiAoaGVhcFsoc3RhcnQgKyBpKSBhcyB1c2l6ZV0gIT0gdmFsdWUgKiAxMDAwMCArIGkpIHsKICAgICAgICAgICAgZXJyb3JzID0gZXJyb3JzICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgaWYgKGVycm9ycyA+IDApIHsKICAgICAgICBwcmludGxuSW50KC05OTkpOwogICAgfQp9CgpmbiBjb21wbGV4X21lbW9yeV9jaHVybihoZWFwOiAmbXV0IFtpMzI7IEhFQVBfU0laRV0sIGZyZWVfbGlzdF9oZWFkOiAmbXV0IGkzMikgewogICAgbGV0IG11dCBwOiBbaTMyOyAyMF0gPSBbMDsgMjBdOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAyMCkgewogICAgICAgIHBbaSBhcyB1c2l6ZV0gPSBteV9tYWxsb2MoaGVhcCwgZnJlZV9saXN0X2hlYWQsIDIwICsgaSAqIDIpOwogICAgICAgIGlmIChwW2kgYXMgdXNpemVdID4gMCkgewogICAgICAgICAgICBmaWxsX21lbW9yeShoZWFwLCBwW2kgYXMgdXNpemVdLCAyMCArIGkgKiAyLCAxMCArIGkpOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDIwKSB7CiAgICAgICAgaWYgKGkgJSAyID09IDApIHsKICAgICAgICAgICAgbXlfZnJlZShoZWFwLCBmcmVlX2xpc3RfaGVhZCwgcFtpIGFzIHVzaXplXSk7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBpID0gMTsKICAgIHdoaWxlIChpIDwgMjApIHsKICAgICAgICBpZiAoaSAlIDIgIT0gMCkgewogICAgICAgICAgICB2ZXJpZnlfbWVtb3J5KGhlYXAsIHBbaSBhcyB1c2l6ZV0sIDIwICsgaSAqIDIsIDEwICsgaSk7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBsZXQgbXV0IHBfbGFyZ2U6IGkzMiA9IG15X21hbGxvYyhoZWFwLCBmcmVlX2xpc3RfaGVhZCwgMzAwKTsKICAgIGlmIChwX2xhcmdlID4gMCkgewogICAgICAgIGZpbGxfbWVtb3J5KGhlYXAsIHBfbGFyZ2UsIDMwMCwgMTAwKTsKICAgIH0KCiAgICBpID0gMTsKICAgIHdoaWxlIChpIDwgMjApIHsKICAgICAgICBpZiAoaSAlIDIgIT0gMCkgewogICAgICAgICAgICBteV9mcmVlKGhlYXAsIGZyZWVfbGlzdF9oZWFkLCBwW2kgYXMgdXNpemVdKTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIG15X2ZyZWUoaGVhcCwgZnJlZV9saXN0X2hlYWQsIHBfbGFyZ2UpOwoKICAgIGxldCBmaW5hbF9hbGxvYzogaTMyID0gbXlfbWFsbG9jKGhlYXAsIGZyZWVfbGlzdF9oZWFkLCBIRUFQX1NJWkUgYXMgaTMyIC0gMTAwKTsKICAgIGlmIChmaW5hbF9hbGxvYyA+IDApIHsKICAgICAgICBwcmludGxuSW50KDg4ODgpOwogICAgfQp9CgpmbiBhbm90aGVyX2xldmVsX29mX3Njb3BlKCkgewogICAgbGV0IG11dCBoZWFwOiBbaTMyOyBIRUFQX1NJWkVdID0gWzA7IEhFQVBfU0laRV07CiAgICBsZXQgbXV0IGZyZWVfbGlzdF9oZWFkOiBpMzIgPSAwOwogICAgaW5pdF9oZWFwKCZtdXQgaGVhcCwgJm11dCBmcmVlX2xpc3RfaGVhZCk7CiAgICBjb21wbGV4X21lbW9yeV9jaHVybigmbXV0IGhlYXAsICZtdXQgZnJlZV9saXN0X2hlYWQpOwoKICAgIGxldCBtdXQgcDE6IGkzMiA9IDA7CiAgICB7CiAgICAgICAgbGV0IG11dCBwMjogaTMyID0gbXlfbWFsbG9jKCZtdXQgaGVhcCwgJm11dCBmcmVlX2xpc3RfaGVhZCwgNTApOwogICAgICAgIGlmIChwMiA+IDApIHsKICAgICAgICAgICAgZmlsbF9tZW1vcnkoJm11dCBoZWFwLCBwMiwgNTAsIDUwKTsKICAgICAgICAgICAgcDEgPSBwMjsKICAgICAgICB9CiAgICB9CgogICAgaWYgKHAxID4gMCkgewogICAgICAgIHZlcmlmeV9tZW1vcnkoJmhlYXAsIHAxLCA1MCwgNTApOwogICAgfQoKICAgIGxldCBtdXQgb3V0ZXJfdmFyOiBpMzIgPSAxOwogICAgaWYgKG91dGVyX3ZhciA9PSAxKSB7CiAgICAgICAgbGV0IGlubmVyX3ZhcjogaTMyID0gMjsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCAxMCkgewogICAgICAgICAgICBsZXQgbG9vcF92YXI6IGkzMiA9IGk7CiAgICAgICAgICAgIGlmIChpID09IDUpIHsKICAgICAgICAgICAgICAgIGxldCBtdXQgYW5vdGhlcl9ibG9ja192YXI6IGkzMiA9IDU7CiAgICAgICAgICAgICAgICBhbm90aGVyX2Jsb2NrX3ZhciA9IGFub3RoZXJfYmxvY2tfdmFyICsgbG9vcF92YXI7CiAgICAgICAgICAgICAgICBwcmludGxuSW50KGFub3RoZXJfYmxvY2tfdmFyKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgfQoKICAgIGxldCBtdXQgdGVzdF9wdHI6IGkzMiA9IG15X21hbGxvYygmbXV0IGhlYXAsICZtdXQgZnJlZV9saXN0X2hlYWQsIDEwKTsKICAgIGlmICh0ZXN0X3B0ciA+IDApIHsKICAgICAgICBmaWxsX21lbW9yeSgmbXV0IGhlYXAsIHRlc3RfcHRyLCAxMCwgOTkpOwogICAgfQoKICAgIGxldCBtdXQgYW5vdGhlcl9wdHI6IGkzMiA9IDA7CiAgICBpZiAodHJ1ZSkgewogICAgICAgIGxldCB0ZW1wX3B0cjogaTMyID0gbXlfbWFsbG9jKCZtdXQgaGVhcCwgJm11dCBmcmVlX2xpc3RfaGVhZCwgMjApOwogICAgICAgIGlmICh0ZW1wX3B0ciA+IDApIHsKICAgICAgICAgICAgZmlsbF9tZW1vcnkoJm11dCBoZWFwLCB0ZW1wX3B0ciwgMjAsIDg4KTsKICAgICAgICAgICAgYW5vdGhlcl9wdHIgPSB0ZW1wX3B0cjsKICAgICAgICB9CiAgICB9CgogICAgaWYgKGFub3RoZXJfcHRyID4gMCkgewogICAgICAgIHZlcmlmeV9tZW1vcnkoJmhlYXAsIGFub3RoZXJfcHRyLCAyMCwgODgpOwogICAgfQoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgNSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IHB0cl9hcnI6IFtpMzI7IDVdID0gWzA7IDVdOwogICAgICAgIHdoaWxlIChqIDwgNSkgewogICAgICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICAgICAgICAgIGxldCBzaXplOiBpMzIgPSAoaSArIGogKyAxKSAqIDI7CiAgICAgICAgICAgIHB0cl9hcnJbaiBhcyB1c2l6ZV0gPSBteV9tYWxsb2MoJm11dCBoZWFwLCAmbXV0IGZyZWVfbGlzdF9oZWFkLCBzaXplKTsKICAgICAgICAgICAgaWYgKHB0cl9hcnJbaiBhcyB1c2l6ZV0gPiAwKSB7CiAgICAgICAgICAgICAgICBmaWxsX21lbW9yeSgmbXV0IGhlYXAsIHB0cl9hcnJbaiBhcyB1c2l6ZV0sIHNpemUsIGkgKiAxMCArIGopOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CgogICAgICAgIGogPSAwOwogICAgICAgIHdoaWxlIChqIDwgNSkgewogICAgICAgICAgICBpZiAocHRyX2FycltqIGFzIHVzaXplXSA+IDApIHsKICAgICAgICAgICAgICAgIG15X2ZyZWUoJm11dCBoZWFwLCAmbXV0IGZyZWVfbGlzdF9oZWFkLCBwdHJfYXJyW2ogYXMgdXNpemVdKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBsZXQgZmluYWxfY2hlY2s6IGkzMiA9IG15X21hbGxvYygmbXV0IGhlYXAsICZtdXQgZnJlZV9saXN0X2hlYWQsIEhFQVBfU0laRSBhcyBpMzIgLSA1MCk7CiAgICBpZiAoZmluYWxfY2hlY2sgPiAwKSB7CiAgICAgICAgcHJpbnRsbkludCg3Nzc3KTsKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnRsbkludCgtNzc3Nyk7CiAgICB9CgogICAgewogICAgICAgIGxldCBtdXQgc2hhZG93X3ZhcjogaTMyID0gMTA7CiAgICAgICAgaWYgKHNoYWRvd192YXIgPiA1KSB7CiAgICAgICAgICAgIGxldCBtdXQgc2hhZG93X3ZhcjogaTMyID0gMjA7CiAgICAgICAgICAgIHNoYWRvd192YXIgPSBzaGFkb3dfdmFyICsgMTsKICAgICAgICAgICAgcHJpbnRsbkludChzaGFkb3dfdmFyKTsKICAgICAgICB9CiAgICAgICAgcHJpbnRsbkludChzaGFkb3dfdmFyKTsKICAgIH0KCiAgICBsZXQgdGVtcF9wdHJfZm9yX2Vycm9yOiBpMzIgPSBteV9tYWxsb2MoJm11dCBoZWFwLCAmbXV0IGZyZWVfbGlzdF9oZWFkLCAxKTsKICAgIG15X2ZyZWUoJm11dCBoZWFwLCAmbXV0IGZyZWVfbGlzdF9oZWFkLCB0ZW1wX3B0cl9mb3JfZXJyb3IpOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (31, "comprehensive31", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IFN0YWNrLUJhc2VkIFZpcnR1YWwgTWFjaGluZSBJbnRlcnByZXRlcgpTdW1tYXJ5OiBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKRGV0YWlsczoKTGFyZ2UgaW5zdHJ1Y3Rpb24gZGlzcGF0Y2ggbG9vcCAoc2ltdWxhdGluZyBhIHN3aXRjaCBzdGF0ZW1lbnQpLgpTdGFjayBtYW5pcHVsYXRpb24gdXNpbmcgYXJyYXktYmFzZWQgZGF0YSBzdHJ1Y3R1cmVzLgpQcm9ncmFtIGZsb3cgY29udHJvbCBiYXNlZCBvbiBpbnRlcnByZXRlZCBieXRlY29kZS4KSW50ZWdlciBhcml0aG1ldGljIGFuZCBsb2dpY2FsIG9wZXJhdGlvbnMgd2l0aGluIHRoZSBWTS4KRnVuY3Rpb24gY2FsbCBzaW11bGF0aW9uIGFuZCBzdGFjayBmcmFtZSBtYW5hZ2VtZW50LgoqLwoKLy8gY29tcHJlaGVuc2l2ZTMxLnJ4IC0gU3RhY2stQmFzZWQgVmlydHVhbCBNYWNoaW5lIEludGVycHJldGVyCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIExhcmdlIGluc3RydWN0aW9uIGRpc3BhdGNoIGxvb3AgKHNpbXVsYXRpbmcgYSBzd2l0Y2ggc3RhdGVtZW50KS4KLy8gLSBTdGFjayBtYW5pcHVsYXRpb24gdXNpbmcgYXJyYXktYmFzZWQgZGF0YSBzdHJ1Y3R1cmVzLgovLyAtIFByb2dyYW0gZmxvdyBjb250cm9sIGJhc2VkIG9uIGludGVycHJldGVkIGJ5dGVjb2RlLgovLyAtIEludGVnZXIgYXJpdGhtZXRpYyBhbmQgbG9naWNhbCBvcGVyYXRpb25zIHdpdGhpbiB0aGUgVk0uCi8vIC0gRnVuY3Rpb24gY2FsbCBzaW11bGF0aW9uIGFuZCBzdGFjayBmcmFtZSBtYW5hZ2VtZW50LgoKY29uc3QgU1RBQ0tfU0laRTogdXNpemUgPSAyNTY7CmNvbnN0IFBST0dfTUVNX1NJWkU6IHVzaXplID0gMTAyNDsKCmNvbnN0IFBVU0g6IGkzMiA9IDE7CmNvbnN0IFBPUDogaTMyID0gMjsKY29uc3QgQUREOiBpMzIgPSAzOwpjb25zdCBTVUI6IGkzMiA9IDQ7CmNvbnN0IE1VTDogaTMyID0gNTsKY29uc3QgRElWOiBpMzIgPSA2Owpjb25zdCBFUTogaTMyID0gNzsKY29uc3QgTFQ6IGkzMiA9IDg7CmNvbnN0IEdUOiBpMzIgPSA5Owpjb25zdCBKTVA6IGkzMiA9IDEwOwpjb25zdCBKWjogaTMyID0gMTE7CmNvbnN0IEpOWjogaTMyID0gMTI7CmNvbnN0IENBTEw6IGkzMiA9IDEzOwpjb25zdCBSRVQ6IGkzMiA9IDE0Owpjb25zdCBQUklOVDogaTMyID0gMTU7CmNvbnN0IEhBTFQ6IGkzMiA9IDA7CgpzdHJ1Y3QgVk0gewogICAgcGM6IGkzMiwKICAgIHNwOiBpMzIsCiAgICBzdGFjazogW2kzMjsgU1RBQ0tfU0laRV0sCiAgICBwcm9ncmFtOiBbaTMyOyBQUk9HX01FTV9TSVpFXSwKfQoKZm4gbWFpbigpIHsKICAgIGxldCBtdXQgdm06IFZNID0gVk0gewogICAgICAgIHBjOiAwLAogICAgICAgIHNwOiBTVEFDS19TSVpFIGFzIGkzMiAtIDEsCiAgICAgICAgc3RhY2s6IFswOyBTVEFDS19TSVpFXSwKICAgICAgICBwcm9ncmFtOiBbMDsgUFJPR19NRU1fU0laRV0sCiAgICB9OwoKICAgIGxvYWRfcHJvZ3JhbSgmbXV0IHZtKTsKICAgIGV4ZWN1dGUoJm11dCB2bSk7CiAgICBwcmludGxuSW50KDk5OTkpOwogICAgZXhpdCgwKTsKfQoKZm4gbG9hZF9wcm9ncmFtKHZtOiAmbXV0IFZNKSB7CiAgICBsZXQgbXV0IHByb2c6IFtpMzI7IFBST0dfTUVNX1NJWkVdID0gWzA7IFBST0dfTUVNX1NJWkVdOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICBwcm9nW2kgYXMgdXNpemVdID0gUFVTSDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IDEwOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gUFVTSDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IDIwOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gQ0FMTDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IDUwOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gUFJJTlQ7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBIQUxUOyBpID0gaSArIDE7CgogICAgaSA9IDUwOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBVU0g7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSA1OyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gUFVTSDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IDM7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBTVUI7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBQUklOVDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBVU0g7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSAxMDA7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBDQUxMOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gMjAwOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gQUREOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gUkVUOyBpID0gaSArIDE7CgogICAgaSA9IDEwMDsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBQVVNIOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gMTsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBVU0g7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSAxOyBpID0gaSArIDE7CiAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICB3aGlsZSAoaiA8IDEwKSB7CiAgICAgICAgcHJvZ1tpIGFzIHVzaXplXSA9IEFERDsgaSA9IGkgKyAxOwogICAgICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBQVVNIOyBpID0gaSArIDE7CiAgICAgICAgcHJvZ1tpIGFzIHVzaXplXSA9IHZtLnN0YWNrWyh2bS5zcCkgYXMgdXNpemVdOyBpID0gaSArIDE7CiAgICAgICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBVU0g7IGkgPSBpICsgMTsKICAgICAgICBwcm9nW2kgYXMgdXNpemVdID0gdm0uc3RhY2tbKHZtLnNwIC0gMSkgYXMgdXNpemVdOyBpID0gaSArIDE7CiAgICAgICAgaiA9IGogKyAxOwogICAgfQogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBPUDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBSSU5UOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gUkVUOyBpID0gaSArIDE7CgogICAgaSA9IDIwMDsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBQVVNIOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gMTA7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBQVVNIOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gMDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBVU0g7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSAxOyBpID0gaSArIDE7CiAgICBsZXQgbG9vcF9zdGFydDogaTMyID0gaTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBQVVNIOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gdm0uc3RhY2tbKHZtLnNwIC0gMikgYXMgdXNpemVdOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gUFVTSDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IHZtLnN0YWNrWyh2bS5zcCAtIDIpIGFzIHVzaXplXTsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IEFERDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBPUDsgaSA9IGkgKyAxOwogICAgdm0uc3RhY2tbKHZtLnNwIC0gMikgYXMgdXNpemVdID0gdm0uc3RhY2tbKHZtLnNwKSBhcyB1c2l6ZV07CiAgICBwcm9nW2kgYXMgdXNpemVdID0gdm0uc3RhY2tbKHZtLnNwIC0gMikgYXMgdXNpemVdOwogICAgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBPUDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBVU0g7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSB2bS5zdGFja1sodm0uc3AgLSAxKSBhcyB1c2l6ZV07IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBQVVNIOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gMTsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IEFERDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBPUDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IHZtLnN0YWNrWyh2bS5zcCAtIDEpIGFzIHVzaXplXTsKICAgIHZtLnN0YWNrWyh2bS5zcCAtIDEpIGFzIHVzaXplXSA9IHZtLnN0YWNrWyh2bS5zcCkgYXMgdXNpemVdOwogICAgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBPUDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBVU0g7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSB2bS5zdGFja1sodm0uc3ApIGFzIHVzaXplXTsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBVU0g7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSAxMDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IExUOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gSk5aOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gbG9vcF9zdGFydDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBPUDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBPUDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFJFVDsgaSA9IGkgKyAxOwoKICAgIHZtLnByb2dyYW0gPSBwcm9nOwp9CgpmbiBleGVjdXRlKHZtOiAmbXV0IFZNKSB7CiAgICBsZXQgbXV0IHJ1bm5pbmc6IGJvb2wgPSB0cnVlOwogICAgd2hpbGUgKHJ1bm5pbmcpIHsKICAgICAgICBsZXQgb3A6IGkzMiA9IGZldGNoKHZtKTsKICAgICAgICBpZiAob3AgPT0gSEFMVCkgewogICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIGlmIChvcCA9PSBQVVNIKSB7CiAgICAgICAgICAgIGxldCB2YWw6IGkzMiA9IGZldGNoKHZtKTsKICAgICAgICAgICAgcHVzaCh2bSwgdmFsKTsKICAgICAgICB9IGVsc2UgaWYgKG9wID09IFBPUCkgewogICAgICAgICAgICBwb3Aodm0pOwogICAgICAgIH0gZWxzZSBpZiAob3AgPT0gQUREKSB7CiAgICAgICAgICAgIGxldCBiOiBpMzIgPSBwb3Aodm0pOwogICAgICAgICAgICBsZXQgYTogaTMyID0gcG9wKHZtKTsKICAgICAgICAgICAgcHVzaCh2bSwgYSArIGIpOwogICAgICAgIH0gZWxzZSBpZiAob3AgPT0gU1VCKSB7CiAgICAgICAgICAgIGxldCBiOiBpMzIgPSBwb3Aodm0pOwogICAgICAgICAgICBsZXQgYTogaTMyID0gcG9wKHZtKTsKICAgICAgICAgICAgcHVzaCh2bSwgYSAtIGIpOwogICAgICAgIH0gZWxzZSBpZiAob3AgPT0gTVVMKSB7CiAgICAgICAgICAgIGxldCBiOiBpMzIgPSBwb3Aodm0pOwogICAgICAgICAgICBsZXQgYTogaTMyID0gcG9wKHZtKTsKICAgICAgICAgICAgcHVzaCh2bSwgYSAqIGIpOwogICAgICAgIH0gZWxzZSBpZiAob3AgPT0gRElWKSB7CiAgICAgICAgICAgIGxldCBiOiBpMzIgPSBwb3Aodm0pOwogICAgICAgICAgICBsZXQgYTogaTMyID0gcG9wKHZtKTsKICAgICAgICAgICAgaWYgKGIgIT0gMCkgewogICAgICAgICAgICAgICAgcHVzaCh2bSwgYSAvIGIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcHJpbnRsbkludCgtMSk7CiAgICAgICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKG9wID09IEVRKSB7CiAgICAgICAgICAgIGxldCBiOiBpMzIgPSBwb3Aodm0pOwogICAgICAgICAgICBsZXQgYTogaTMyID0gcG9wKHZtKTsKICAgICAgICAgICAgcHVzaCh2bSwgaWYgKGEgPT0gYikgeyAxIH0gZWxzZSB7IDAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChvcCA9PSBMVCkgewogICAgICAgICAgICBsZXQgYjogaTMyID0gcG9wKHZtKTsKICAgICAgICAgICAgbGV0IGE6IGkzMiA9IHBvcCh2bSk7CiAgICAgICAgICAgIHB1c2godm0sIGlmIChhIDwgYikgeyAxIH0gZWxzZSB7IDAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChvcCA9PSBHVCkgewogICAgICAgICAgICBsZXQgYjogaTMyID0gcG9wKHZtKTsKICAgICAgICAgICAgbGV0IGE6IGkzMiA9IHBvcCh2bSk7CiAgICAgICAgICAgIHB1c2godm0sIGlmIChhID4gYikgeyAxIH0gZWxzZSB7IDAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChvcCA9PSBKTVApIHsKICAgICAgICAgICAgdm0ucGMgPSBmZXRjaCh2bSk7CiAgICAgICAgfSBlbHNlIGlmIChvcCA9PSBKWikgewogICAgICAgICAgICBsZXQgYWRkcjogaTMyID0gZmV0Y2godm0pOwogICAgICAgICAgICBpZiAocG9wKHZtKSA9PSAwKSB7CiAgICAgICAgICAgICAgICB2bS5wYyA9IGFkZHI7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKG9wID09IEpOWikgewogICAgICAgICAgICBsZXQgYWRkcjogaTMyID0gZmV0Y2godm0pOwogICAgICAgICAgICBpZiAocG9wKHZtKSAhPSAwKSB7CiAgICAgICAgICAgICAgICB2bS5wYyA9IGFkZHI7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKG9wID09IENBTEwpIHsKICAgICAgICAgICAgbGV0IGFkZHI6IGkzMiA9IGZldGNoKHZtKTsKICAgICAgICAgICAgcHVzaCh2bSwgdm0ucGMpOwogICAgICAgICAgICB2bS5wYyA9IGFkZHI7CiAgICAgICAgfSBlbHNlIGlmIChvcCA9PSBSRVQpIHsKICAgICAgICAgICAgdm0ucGMgPSBwb3Aodm0pOwogICAgICAgIH0gZWxzZSBpZiAob3AgPT0gUFJJTlQpIHsKICAgICAgICAgICAgcHJpbnRsbkludCh2bS5zdGFja1sodm0uc3ApIGFzIHVzaXplXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHJpbnRsbkludCgtMik7CiAgICAgICAgICAgIHJ1bm5pbmcgPSBmYWxzZTsKICAgICAgICB9CiAgICB9Cn0KCmZuIGZldGNoKHZtOiAmbXV0IFZNKSAtPiBpMzIgewogICAgbGV0IGluc3RydWN0aW9uOiBpMzIgPSB2bS5wcm9ncmFtWyh2bS5wYykgYXMgdXNpemVdOwogICAgdm0ucGMgPSB2bS5wYyArIDE7CiAgICByZXR1cm4gaW5zdHJ1Y3Rpb247Cn0KCmZuIHB1c2godm06ICZtdXQgVk0sIHZhbDogaTMyKSB7CiAgICB2bS5zcCA9ICh2bS5zcCArIDEpICUgKFNUQUNLX1NJWkUgYXMgaTMyKTsKICAgIHZtLnN0YWNrWyh2bS5zcCkgYXMgdXNpemVdID0gdmFsOwp9CgpmbiBwb3Aodm06ICZtdXQgVk0pIC0+IGkzMiB7CiAgICBsZXQgdmFsOiBpMzIgPSB2bS5zdGFja1sodm0uc3ApIGFzIHVzaXplXTsKICAgIHZtLnNwID0gdm0uc3AgLSAxOwogICAgaWYgKHZtLnNwIDwgMCkgewogICAgICAgIHZtLnNwICs9IFNUQUNLX1NJWkUgYXMgaTMyOwogICAgfQogICAgcmV0dXJuIHZhbDsKfQoKZm4gZGVlcF9yZWN1cnNpdmVfdGVzdCh2bTogJm11dCBWTSwgZGVwdGg6IGkzMikgewogICAgaWYgKGRlcHRoIDw9IDApIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBwdXNoKHZtLCBkZXB0aCk7CiAgICBkZWVwX3JlY3Vyc2l2ZV90ZXN0KHZtLCBkZXB0aCAtIDEpOwogICAgbGV0IHZhbDogaTMyID0gcG9wKHZtKTsKICAgIHB1c2godm0sIHZhbCArIDEpOwp9CgpmbiBjb21wbGV4X3N0YWNrX21hbmlwdWxhdGlvbih2bTogJm11dCBWTSkgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAyMCkgewogICAgICAgIHB1c2godm0sIGkpOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCAxMCkgewogICAgICAgIGxldCBhOiBpMzIgPSBwb3Aodm0pOwogICAgICAgIGxldCBiOiBpMzIgPSBwb3Aodm0pOwogICAgICAgIHB1c2godm0sIGEgKyBiKTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICBwcmludGxuSW50KHBvcCh2bSkpOwp9CgpmbiBydW5fZmlib25hY2NpX2luX3ZtKHZtOiAmbXV0IFZNLCBuOiBpMzIpIHsKICAgIGxldCBtdXQgcHJvZzogW2kzMjsgUFJPR19NRU1fU0laRV0gPSBbMDsgUFJPR19NRU1fU0laRV07CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CgogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBVU0g7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBuOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gQ0FMTDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IDEwOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gUFJJTlQ7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBIQUxUOyBpID0gaSArIDE7CgogICAgaSA9IDEwOwogICAgbGV0IGZpYl9zdGFydDogaTMyID0gaTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBQVVNIOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gdm0uc3RhY2tbKHZtLnNwKSBhcyB1c2l6ZV07IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBQVVNIOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gMjsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IExUOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gSlo7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBmaWJfc3RhcnQgKyAyMDsgaSA9IGkgKyAxOwoKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBQVVNIOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gdm0uc3RhY2tbKHZtLnNwKSBhcyB1c2l6ZV07IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBQVVNIOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gMTsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFNVQjsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IENBTEw7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBmaWJfc3RhcnQ7IGkgPSBpICsgMTsKCiAgICBwcm9nW2kgYXMgdXNpemVdID0gUFVTSDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IHZtLnN0YWNrWyh2bS5zcCArIDEpIGFzIHVzaXplXTsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IFBVU0g7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSAyOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gU1VCOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gQ0FMTDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IGZpYl9zdGFydDsgaSA9IGkgKyAxOwoKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBBREQ7IGkgPSBpICsgMTsKICAgIHByb2dbaSBhcyB1c2l6ZV0gPSBSRVQ7IGkgPSBpICsgMTsKCiAgICBpID0gZmliX3N0YXJ0ICsgMjA7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gUE9QOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gUFVTSDsgaSA9IGkgKyAxOwogICAgcHJvZ1tpIGFzIHVzaXplXSA9IHZtLnN0YWNrWyh2bS5zcCkgYXMgdXNpemVdOyBpID0gaSArIDE7CiAgICBwcm9nW2kgYXMgdXNpemVdID0gUkVUOyBpID0gaSArIDE7CgogICAgbGV0IG11dCBvbGRfcHJvZzogW2kzMjsgUFJPR19NRU1fU0laRV0gPSB2bS5wcm9ncmFtOwogICAgbGV0IG9sZF9wYzogaTMyID0gdm0ucGM7CiAgICBsZXQgb2xkX3NwOiBpMzIgPSB2bS5zcDsKCiAgICB2bS5wcm9ncmFtID0gcHJvZzsKICAgIHZtLnBjID0gMDsKICAgIHZtLnNwID0gU1RBQ0tfU0laRSBhcyBpMzIgLSAxOwogICAgZXhlY3V0ZSh2bSk7CgogICAgdm0ucHJvZ3JhbSA9IG9sZF9wcm9nOwogICAgdm0ucGMgPSBvbGRfcGM7CiAgICB2bS5zcCA9IG9sZF9zcDsKfQoKZm4gZXJyb3JfY2FzZV90ZXN0KHZtOiBWTSkgewogICAgbGV0IG11dCBsb2NhbF92bTogVk0gPSB2bTsKICAgIGxvY2FsX3ZtLnNwID0gbG9jYWxfdm0uc3AgKyAxMDsKICAgIGlmIChsb2NhbF92bS5zcCA+IFNUQUNLX1NJWkUgYXMgaTMyKSB7CiAgICAgICAgcHJpbnRsbkludCgtMTAwKTsKICAgIH0KICAgIGxvY2FsX3ZtLnNwID0gU1RBQ0tfU0laRSBhcyBpMzIgLSAxMDsKICAgIGxldCB2YWw6IGkzMiA9IHBvcCgmbXV0IGxvY2FsX3ZtKTsKICAgIHByaW50bG5JbnQodmFsKTsKfQoKZm4gYW5vdGhlcl90ZXN0X3NjZW5hcmlvKCkgewogICAgbGV0IG11dCB2bTogVk0gPSBWTSB7CiAgICAgICAgcGM6IDAsCiAgICAgICAgc3A6IFNUQUNLX1NJWkUgYXMgaTMyIC0gMSwKICAgICAgICBzdGFjazogWzA7IFNUQUNLX1NJWkVdLAogICAgICAgIHByb2dyYW06IFswOyBQUk9HX01FTV9TSVpFXSwKICAgIH07CiAgICBydW5fZmlib25hY2NpX2luX3ZtKCZtdXQgdm0sIDE1KTsKICAgIGNvbXBsZXhfc3RhY2tfbWFuaXB1bGF0aW9uKCZtdXQgdm0pOwogICAgZGVlcF9yZWN1cnNpdmVfdGVzdCgmbXV0IHZtLCAzMCk7CiAgICBlcnJvcl9jYXNlX3Rlc3Qodm0pOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (32, "comprehensive32", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IFRleHQgUHJvY2Vzc2luZyBhbmQgUGF0dGVybiBNYXRjaGluZyBFbmdpbmUKU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6CkNvbXBsZXggc3RhdGUgbWFjaGluZSBsb2dpYyBmb3IgcGF0dGVybiBtYXRjaGluZy4KTGFyZ2UgYXJyYXkgdHJhdmVyc2FscyBmb3IgdGV4dCBwcm9jZXNzaW5nLgpOZXN0ZWQgbG9vcHMgYW5kIGNvbmRpdGlvbmFscyBmb3IgZmluZGluZyBzdWItcGF0dGVybnMuCkZ1bmN0aW9uIGNhbGxzIHdpdGggbXVsdGlwbGUgYXJyYXktYmFzZWQgYXJndW1lbnRzLgpCcmFuY2ggcHJlZGljdGlvbiBpbiB0ZXh0IGFuYWx5c2lzIGxvb3BzLgoqLwoKLy8gVW5pZmllZCBSTkc6IFBhcmvigJNNaWxsZXIgKGE9MTY4MDcsIG09MjE0NzQ4MzY0NykgdXNpbmcgU2NocmFnZSBtZXRob2QgdG8gYXZvaWQgb3ZlcmZsb3cKZm4gcG1fcmFuZF91cGRhdGUoeDogaTMyKSAtPiBpMzIgewogICAgbGV0IGE6IGkzMiA9IDE2ODA3OwogICAgbGV0IG06IGkzMiA9IDIxNDc0ODM2NDc7CiAgICBsZXQgcTogaTMyID0gMTI3NzczOyAvLyBtIC8gYQogICAgbGV0IHI6IGkzMiA9IDI4MzY7IC8vIG0gJSBhCiAgICBsZXQgbXV0IGs6IGkzMiA9IHggLyBxOwogICAgbGV0IG11dCBuZXdfeDogaTMyID0gYSAqICh4IC0gayAqIHEpIC0gciAqIGs7CiAgICBpZiAobmV3X3ggPD0gMCkgewogICAgICAgIG5ld194ICs9IG07CiAgICB9CiAgICByZXR1cm4gbmV3X3g7Cn0KCi8vIGNvbXByZWhlbnNpdmUzMi5yeCAtIFRleHQgUHJvY2Vzc2luZyBhbmQgUGF0dGVybiBNYXRjaGluZyBFbmdpbmUKLy8gVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6Ci8vIC0gQ29tcGxleCBzdGF0ZSBtYWNoaW5lIGxvZ2ljIGZvciBwYXR0ZXJuIG1hdGNoaW5nLgovLyAtIExhcmdlIGFycmF5IHRyYXZlcnNhbHMgZm9yIHRleHQgcHJvY2Vzc2luZy4KLy8gLSBOZXN0ZWQgbG9vcHMgYW5kIGNvbmRpdGlvbmFscyBmb3IgZmluZGluZyBzdWItcGF0dGVybnMuCi8vIC0gRnVuY3Rpb24gY2FsbHMgd2l0aCBtdWx0aXBsZSBhcnJheS1iYXNlZCBhcmd1bWVudHMuCi8vIC0gQnJhbmNoIHByZWRpY3Rpb24gaW4gdGV4dCBhbmFseXNpcyBsb29wcy4KCmNvbnN0IFRFWFRfU0laRTogdXNpemUgPSAxMDI0Owpjb25zdCBQQVRURVJOX1NJWkU6IHVzaXplID0gNjQ7CgpmbiBtYWluKCkgewogICAgbGV0IG11dCB0ZXh0OiBbaTMyOyBURVhUX1NJWkVdID0gWzA7IFRFWFRfU0laRV07CiAgICBnZW5lcmF0ZV90ZXh0KCZtdXQgdGV4dCwgMTIzNDUpOwoKICAgIGxldCBtdXQgcGF0dGVybjE6IFtpMzI7IFBBVFRFUk5fU0laRV0gPSBbMDsgUEFUVEVSTl9TSVpFXTsKICAgIGxldCBwYXR0ZXJuMV9sZW46IGkzMiA9IDM7CiAgICBwYXR0ZXJuMVswXSA9IDY1OwogICAgcGF0dGVybjFbMV0gPSA2NjsKICAgIHBhdHRlcm4xWzJdID0gNjc7CgogICAgbGV0IG11dCBwYXR0ZXJuMjogW2kzMjsgUEFUVEVSTl9TSVpFXSA9IFswOyBQQVRURVJOX1NJWkVdOwogICAgbGV0IHBhdHRlcm4yX2xlbjogaTMyID0gNTsKICAgIHBhdHRlcm4yWzBdID0gODg7CiAgICBwYXR0ZXJuMlsxXSA9IDg5OwogICAgcGF0dGVybjJbMl0gPSA5MDsKICAgIHBhdHRlcm4yWzNdID0gODg7CiAgICBwYXR0ZXJuMls0XSA9IDg5OwoKICAgIGxldCBtdXQgcGF0dGVybjM6IFtpMzI7IFBBVFRFUk5fU0laRV0gPSBbMDsgUEFUVEVSTl9TSVpFXTsKICAgIGxldCBwYXR0ZXJuM19sZW46IGkzMiA9IDI7CiAgICBwYXR0ZXJuM1swXSA9IDEwMDsKICAgIHBhdHRlcm4zWzFdID0gMTAwOwoKICAgIGxldCBtdXQgY291bnQxOiBpMzIgPSBmaW5kX3BhdHRlcm4oJnRleHQsICZwYXR0ZXJuMSwgcGF0dGVybjFfbGVuKTsKICAgIHByaW50bG5JbnQoY291bnQxKTsKCiAgICBsZXQgbXV0IGNvdW50MjogaTMyID0gZmluZF9wYXR0ZXJuX3dpdGhfd2lsZGNhcmQoJnRleHQsICZwYXR0ZXJuMiwgcGF0dGVybjJfbGVuLCA5MCk7CiAgICBwcmludGxuSW50KGNvdW50Mik7CgogICAgbGV0IG11dCBjb3VudDM6IGkzMiA9IGZpbmRfY29tcGxleF9wYXR0ZXJuKCZ0ZXh0KTsKICAgIHByaW50bG5JbnQoY291bnQzKTsKCiAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gYW5hbHl6ZV90ZXh0X2ZyZXF1ZW5jeSgmdGV4dCk7CiAgICBwcmludGxuSW50KHJlc3VsdCk7CgogICAgbGV0IG11dCBlcnJvcl9yZXM6IGkzMiA9IHRyaWdnZXJfZXJyb3JfcGF0aCgmdGV4dCwgJnBhdHRlcm4xLCBwYXR0ZXJuMV9sZW4pOwogICAgcHJpbnRsbkludChlcnJvcl9yZXMpOwoKICAgIHByaW50bG5JbnQoOTk5OSk7CiAgICBleGl0KDApOwp9CgpmbiBnZW5lcmF0ZV90ZXh0KHRleHQ6ICZtdXQgW2kzMjsgVEVYVF9TSVpFXSwgc2VlZDogaTMyKSB7CiAgICBsZXQgbXV0IGN1cnJlbnRfc2VlZDogaTMyID0gc2VlZDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgVEVYVF9TSVpFIGFzIGkzMikgewogICAgICAgIGN1cnJlbnRfc2VlZCA9IChwbV9yYW5kX3VwZGF0ZShjdXJyZW50X3NlZWQpIC8gNjU1MzYpICUgMzI3Njg7CiAgICAgICAgdGV4dFtpIGFzIHVzaXplXSA9IDY1ICsgKGN1cnJlbnRfc2VlZCAlIDI2KTsKICAgICAgICBpZiAoaSAlIDEwID09IDApIHsKICAgICAgICAgICAgdGV4dFtpIGFzIHVzaXplXSA9IDY1ICsgKGkgLyAxMDApOwogICAgICAgIH0KICAgICAgICBpZiAoaSAlIDI3ID09IDApIHsKICAgICAgICAgICAgdGV4dFtpIGFzIHVzaXplXSA9IDY2OwogICAgICAgIH0KICAgICAgICBpZiAoaSAlIDQyID09IDApIHsKICAgICAgICAgICAgdGV4dFtpIGFzIHVzaXplXSA9IDY3OwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCmZuIGZpbmRfcGF0dGVybih0ZXh0OiAmW2kzMjsgVEVYVF9TSVpFXSwgcGF0dGVybjogJltpMzI7IFBBVFRFUk5fU0laRV0sIHBfbGVuOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGNvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPD0gVEVYVF9TSVpFIGFzIGkzMiAtIHBfbGVuKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgZm91bmQ6IGJvb2wgPSB0cnVlOwogICAgICAgIHdoaWxlIChqIDwgcF9sZW4pIHsKICAgICAgICAgICAgaWYgKHRleHRbKGkgKyBqKSBhcyB1c2l6ZV0gIT0gcGF0dGVybltqIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgZm91bmQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaWYgKGZvdW5kKSB7CiAgICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICByZXR1cm4gY291bnQ7Cn0KCmZuIGZpbmRfcGF0dGVybl93aXRoX3dpbGRjYXJkKAogICAgdGV4dDogJltpMzI7IFRFWFRfU0laRV0sCiAgICBwYXR0ZXJuOiAmW2kzMjsgUEFUVEVSTl9TSVpFXSwKICAgIHBfbGVuOiBpMzIsCiAgICB3aWxkY2FyZDogaTMyLAopIC0+IGkzMiB7CiAgICBsZXQgbXV0IGNvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPD0gVEVYVF9TSVpFIGFzIGkzMiAtIHBfbGVuKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgZm91bmQ6IGJvb2wgPSB0cnVlOwogICAgICAgIHdoaWxlIChqIDwgcF9sZW4pIHsKICAgICAgICAgICAgaWYgKHBhdHRlcm5baiBhcyB1c2l6ZV0gIT0gd2lsZGNhcmQgJiYgdGV4dFsoaSArIGopIGFzIHVzaXplXSAhPSBwYXR0ZXJuW2ogYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBmb3VuZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpZiAoZm91bmQpIHsKICAgICAgICAgICAgY291bnQgPSBjb3VudCArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJldHVybiBjb3VudDsKfQoKZm4gZmluZF9jb21wbGV4X3BhdHRlcm4odGV4dDogJltpMzI7IFRFWFRfU0laRV0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IGNvdW50OiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBURVhUX1NJWkUgYXMgaTMyIC0gNSkgewogICAgICAgIGlmICh0ZXh0W2kgYXMgdXNpemVdID09IHRleHRbaSBhcyB1c2l6ZSArIDNdCiAgICAgICAgICAgICYmIHRleHRbaSBhcyB1c2l6ZSArIDFdID09IHRleHRbaSBhcyB1c2l6ZSArIDRdCiAgICAgICAgICAgICYmIHRleHRbaSBhcyB1c2l6ZV0gPCB0ZXh0W2kgYXMgdXNpemUgKyAyXSkKICAgICAgICB7CiAgICAgICAgICAgIGxldCBtdXQgc3VtOiBpMzIgPSAwOwogICAgICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChrIDwgNSkgewogICAgICAgICAgICAgICAgc3VtID0gc3VtICsgdGV4dFsoaSArIGspIGFzIHVzaXplXTsKICAgICAgICAgICAgICAgIGsgPSBrICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc3VtID4gMzUwKSB7CiAgICAgICAgICAgICAgICBjb3VudCA9IGNvdW50ICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICByZXR1cm4gY291bnQ7Cn0KCmZuIGFuYWx5emVfdGV4dF9mcmVxdWVuY3kodGV4dDogJltpMzI7IFRFWFRfU0laRV0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IGZyZXE6IFtpMzI7IDI2XSA9IFswOyAyNl07CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IFRFWFRfU0laRSBhcyBpMzIpIHsKICAgICAgICBsZXQgY2hhcl9jb2RlOiBpMzIgPSB0ZXh0W2kgYXMgdXNpemVdOwogICAgICAgIGlmIChjaGFyX2NvZGUgPj0gNjUgJiYgY2hhcl9jb2RlIDw9IDkwKSB7CiAgICAgICAgICAgIGZyZXFbY2hhcl9jb2RlIGFzIHVzaXplIC0gNjVdID0gZnJlcVtjaGFyX2NvZGUgYXMgdXNpemUgLSA2NV0gKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgbGV0IG11dCBtYXhfZnJlcTogaTMyID0gMDsKICAgIGxldCBtdXQgbWF4X2NoYXI6IGkzMiA9IC0xOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDI2KSB7CiAgICAgICAgaWYgKGZyZXFbaSBhcyB1c2l6ZV0gPiBtYXhfZnJlcSkgewogICAgICAgICAgICBtYXhfZnJlcSA9IGZyZXFbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIG1heF9jaGFyID0gaSArIDY1OwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICByZXR1cm4gbWF4X2NoYXIgKiAxMDAwICsgbWF4X2ZyZXE7Cn0KCmZuIHN0YXRlX21hY2hpbmVfc2VhcmNoKHRleHQ6ICZbaTMyOyBURVhUX1NJWkVdKSAtPiBpMzIgewogICAgbGV0IG11dCBzdGF0ZTogaTMyID0gMDsKICAgIGxldCBtdXQgY291bnQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IFRFWFRfU0laRSBhcyBpMzIpIHsKICAgICAgICBsZXQgY3VycmVudF9jaGFyOiBpMzIgPSB0ZXh0W2kgYXMgdXNpemVdOwogICAgICAgIGlmIChzdGF0ZSA9PSAwKSB7CiAgICAgICAgICAgIGlmIChjdXJyZW50X2NoYXIgPT0gNjUpIHsKICAgICAgICAgICAgICAgIHN0YXRlID0gMTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoc3RhdGUgPT0gMSkgewogICAgICAgICAgICBpZiAoY3VycmVudF9jaGFyID09IDY2KSB7CiAgICAgICAgICAgICAgICBzdGF0ZSA9IDI7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudF9jaGFyICE9IDY1KSB7CiAgICAgICAgICAgICAgICBzdGF0ZSA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHN0YXRlID09IDIpIHsKICAgICAgICAgICAgaWYgKGN1cnJlbnRfY2hhciA9PSA2NykgewogICAgICAgICAgICAgICAgc3RhdGUgPSAzOwogICAgICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRfY2hhciA9PSA2NSkgewogICAgICAgICAgICAgICAgc3RhdGUgPSAxOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc3RhdGUgPSAwOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PSAzKSB7CiAgICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxOwogICAgICAgICAgICBpZiAoY3VycmVudF9jaGFyID09IDY1KSB7CiAgICAgICAgICAgICAgICBzdGF0ZSA9IDE7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzdGF0ZSA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcmV0dXJuIGNvdW50Owp9CgpmbiB0cmlnZ2VyX2Vycm9yX3BhdGgodGV4dDogJltpMzI7IFRFWFRfU0laRV0sIHBhdHRlcm46ICZbaTMyOyBQQVRURVJOX1NJWkVdLCBwX2xlbjogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBsb2NhbF90ZXh0OiBbaTMyOyBURVhUX1NJWkVdID0gKnRleHQ7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IFRFWFRfU0laRSBhcyBpMzIpIHsKICAgICAgICBsb2NhbF90ZXh0W2kgYXMgdXNpemVdID0gbG9jYWxfdGV4dFtpIGFzIHVzaXplXSArIGkgJSAxMDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgbGV0IG11dCBjb3VudDogaTMyID0gMDsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPD0gVEVYVF9TSVpFIGFzIGkzMiAtIHBfbGVuKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgbWF0Y2hfc2NvcmU6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBwX2xlbikgewogICAgICAgICAgICBpZiAobG9jYWxfdGV4dFsoaSArIGopIGFzIHVzaXplXSA9PSBwYXR0ZXJuW2ogYXMgdXNpemVdKSB7CiAgICAgICAgICAgICAgICBtYXRjaF9zY29yZSA9IG1hdGNoX3Njb3JlICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAobWF0Y2hfc2NvcmUgPiAwKSB7CiAgICAgICAgICAgIGxldCBtdXQgaXNfcHJpbWU6IGJvb2wgPSB0cnVlOwogICAgICAgICAgICBpZiAobWF0Y2hfc2NvcmUgPCAyKSB7CiAgICAgICAgICAgICAgICBpc19wcmltZSA9IGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBtdXQgazogaTMyID0gMjsKICAgICAgICAgICAgd2hpbGUgKGsgKiBrIDw9IG1hdGNoX3Njb3JlKSB7CiAgICAgICAgICAgICAgICBpZiAobWF0Y2hfc2NvcmUgJSBrID09IDApIHsKICAgICAgICAgICAgICAgICAgICBpc19wcmltZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgayA9IGsgKyAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoaXNfcHJpbWUpIHsKICAgICAgICAgICAgICAgIGNvdW50ID0gY291bnQgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBsZXQgbXV0IGFub3RoZXJfdmFsOiBpMzIgPSAwOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDEwMCkgewogICAgICAgIGlmIChpICUgMyA9PSAwKSB7CiAgICAgICAgICAgIGFub3RoZXJfdmFsID0gYW5vdGhlcl92YWwgKyB0ZXh0W2kgYXMgdXNpemVdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFub3RoZXJfdmFsID0gYW5vdGhlcl92YWwgLSB0ZXh0W2kgYXMgdXNpemVdOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgbGV0IGZpbmFsX3Jlc3VsdDogaTMyID0gY291bnQgKyBhbm90aGVyX3ZhbDsKICAgIGlmIChmaW5hbF9yZXN1bHQgPiAxMDAwKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICByZXR1cm4gZmluYWxfcmVzdWx0Owp9CgpmbiBhbm90aGVyX2xldmVsX29mX3NlYXJjaCh0ZXh0OiAmW2kzMjsgVEVYVF9TSVpFXSkgewogICAgbGV0IG11dCBwYXR0ZXJuOiBbaTMyOyBQQVRURVJOX1NJWkVdID0gWzA7IFBBVFRFUk5fU0laRV07CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IFBBVFRFUk5fU0laRSBhcyBpMzIpIHsKICAgICAgICBwYXR0ZXJuW2kgYXMgdXNpemVdID0gNzAgKyBpICUgNTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgbGV0IG11dCBwb3M6IGkzMiA9IC0xOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IChURVhUX1NJWkUgLSBQQVRURVJOX1NJWkUpIGFzIGkzMikgewogICAgICAgIGxldCBtdXQgZm91bmQ6IGJvb2wgPSB0cnVlOwogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IFBBVFRFUk5fU0laRSBhcyBpMzIpIHsKICAgICAgICAgICAgaWYgKHRleHRbKGkgKyBqKSBhcyB1c2l6ZV0gIT0gcGF0dGVybltqIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgZm91bmQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaWYgKGZvdW5kKSB7CiAgICAgICAgICAgIHBvcyA9IGk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICBwcmludGxuSW50KHBvcyk7Cn0KCmZuIHlldF9hbm90aGVyX3NlYXJjaF9mdW5jdGlvbigpIHsKICAgIGxldCBtdXQgdGV4dDogW2kzMjsgVEVYVF9TSVpFXSA9IFswOyBURVhUX1NJWkVdOwogICAgZ2VuZXJhdGVfdGV4dCgmbXV0IHRleHQsIDU0MzIxKTsKICAgIGxldCBtdXQgcmVzdWx0MTogaTMyID0gc3RhdGVfbWFjaGluZV9zZWFyY2goJnRleHQpOwogICAgYW5vdGhlcl9sZXZlbF9vZl9zZWFyY2goJnRleHQpOwogICAgcHJpbnRsbkludChyZXN1bHQxKTsKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (33, "comprehensive33", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IE11bHRpLUFnZW50IFNpbXVsYXRpb24gb24gYSAyRCBHcmlkClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpNdWx0aS1kaW1lbnNpb25hbCBhcnJheSBhY2Nlc3MgYW5kIG1hbmlwdWxhdGlvbi4KQ29tcGxleCBvYmplY3Qtb3JpZW50ZWQtc3R5bGUgcHJvZ3JhbW1pbmcgd2l0aCBzdHJ1Y3RzLgpTaW11bGF0aW9uIGxvb3BzIHdpdGggbWFueSBzdGF0ZSB1cGRhdGVzIHBlciB0aWNrLgpEZWNpc2lvbi1tYWtpbmcgbG9naWMgd2l0aCBkZWVwIGNvbmRpdGlvbmFsIGJyYW5jaGVzLgpJbnRlcmFjdGlvbiBiZXR3ZWVuIG11bHRpcGxlIGNvbXBsZXggZGF0YSBzdHJ1Y3R1cmVzLgoqLwoKLy8gVW5pZmllZCBSTkc6IFBhcmvigJNNaWxsZXIgKGE9MTY4MDcsIG09MjE0NzQ4MzY0NykgdXNpbmcgU2NocmFnZSBtZXRob2QgdG8gYXZvaWQgb3ZlcmZsb3cKZm4gcG1fcmFuZF91cGRhdGUoeDogaTMyKSAtPiBpMzIgewogICAgbGV0IGE6IGkzMiA9IDE2ODA3OwogICAgbGV0IG06IGkzMiA9IDIxNDc0ODM2NDc7CiAgICBsZXQgcTogaTMyID0gMTI3NzczOyAvLyBtIC8gYQogICAgbGV0IHI6IGkzMiA9IDI4MzY7IC8vIG0gJSBhCiAgICBsZXQgbXV0IGs6IGkzMiA9IHggLyBxOwogICAgbGV0IG11dCBuZXdfeDogaTMyID0gYSAqICh4IC0gayAqIHEpIC0gciAqIGs7CiAgICBpZiAobmV3X3ggPD0gMCkgewogICAgICAgIG5ld194ICs9IG07CiAgICB9CiAgICByZXR1cm4gbmV3X3g7Cn0KCi8vIGNvbXByZWhlbnNpdmUzMy5yeCAtIE11bHRpLUFnZW50IFNpbXVsYXRpb24gb24gYSAyRCBHcmlkCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIE11bHRpLWRpbWVuc2lvbmFsIGFycmF5IGFjY2VzcyBhbmQgbWFuaXB1bGF0aW9uLgovLyAtIENvbXBsZXggb2JqZWN0LW9yaWVudGVkLXN0eWxlIHByb2dyYW1taW5nIHdpdGggc3RydWN0cy4KLy8gLSBTaW11bGF0aW9uIGxvb3BzIHdpdGggbWFueSBzdGF0ZSB1cGRhdGVzIHBlciB0aWNrLgovLyAtIERlY2lzaW9uLW1ha2luZyBsb2dpYyB3aXRoIGRlZXAgY29uZGl0aW9uYWwgYnJhbmNoZXMuCi8vIC0gSW50ZXJhY3Rpb24gYmV0d2VlbiBtdWx0aXBsZSBjb21wbGV4IGRhdGEgc3RydWN0dXJlcy4KCmNvbnN0IEdSSURfV0lEVEg6IGkzMiA9IDUwOwpjb25zdCBHUklEX0hFSUdIVDogaTMyID0gNTA7CmNvbnN0IE5VTV9BR0VOVFM6IGkzMiA9IDIwOwpjb25zdCBTSU1VTEFUSU9OX1RJQ0tTOiBpMzIgPSAxMDA7Cgpjb25zdCBHUklEX1dJRFRIX1VTSVpFOiB1c2l6ZSA9IDUwOwpjb25zdCBHUklEX0hFSUdIVF9VU0laRTogdXNpemUgPSA1MDsKY29uc3QgTlVNX0FHRU5UU19VU0laRTogdXNpemUgPSAyMDsKCnN0cnVjdCBBZ2VudCB7CiAgICBpZDogaTMyLAogICAgeDogaTMyLAogICAgeTogaTMyLAogICAgZW5lcmd5OiBpMzIsCiAgICB0YXJnZXRfeDogaTMyLAogICAgdGFyZ2V0X3k6IGkzMiwKICAgIGFjdGl2ZTogYm9vbCwKfQoKc3RydWN0IFdvcmxkIHsKICAgIGdyaWQ6IFtbaTMyOyBHUklEX1dJRFRIX1VTSVpFXTsgR1JJRF9IRUlHSFRfVVNJWkVdLAogICAgYWdlbnRzOiBbQWdlbnQ7IE5VTV9BR0VOVFNfVVNJWkVdLAp9CgpmbiBtYWluKCkgewogICAgbGV0IG11dCB3b3JsZDogV29ybGQgPSBXb3JsZCB7CiAgICAgICAgZ3JpZDogW1swOyBHUklEX1dJRFRIX1VTSVpFXTsgR1JJRF9IRUlHSFRfVVNJWkVdLAogICAgICAgIGFnZW50czogW0FnZW50IHsKICAgICAgICAgICAgaWQ6IDAsCiAgICAgICAgICAgIHg6IDAsCiAgICAgICAgICAgIHk6IDAsCiAgICAgICAgICAgIGVuZXJneTogMCwKICAgICAgICAgICAgdGFyZ2V0X3g6IDAsCiAgICAgICAgICAgIHRhcmdldF95OiAwLAogICAgICAgICAgICBhY3RpdmU6IGZhbHNlLAogICAgICAgIH07IE5VTV9BR0VOVFNfVVNJWkVdLAogICAgfTsKCiAgICBpbml0aWFsaXplX3dvcmxkKCZtdXQgd29ybGQsIDk4NzY1KTsKCiAgICBsZXQgbXV0IHRpY2s6IGkzMiA9IDA7CiAgICB3aGlsZSAodGljayA8IFNJTVVMQVRJT05fVElDS1MpIHsKICAgICAgICB1cGRhdGVfd29ybGQoJm11dCB3b3JsZCk7CiAgICAgICAgcHJvY2Vzc19pbnRlcmFjdGlvbnMoJm11dCB3b3JsZCk7CiAgICAgICAgaWYgKHRpY2sgJSAxMCA9PSAwKSB7CiAgICAgICAgICAgIHJ1bl9kaWFnbm9zdGljcygmbXV0IHdvcmxkKTsKICAgICAgICB9CiAgICAgICAgdGljayA9IHRpY2sgKyAxOwogICAgfQoKICAgIGZpbmFsX3JlcG9ydCgmd29ybGQpOwogICAgcHJpbnRsbkludCg5OTk5KTsKICAgIGV4aXQoMCk7Cn0KCmZuIGluaXRpYWxpemVfd29ybGQod29ybGQ6ICZtdXQgV29ybGQsIHNlZWQ6IGkzMikgewogICAgbGV0IG11dCBjdXJyZW50X3NlZWQ6IGkzMiA9IHNlZWQ7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IE5VTV9BR0VOVFMpIHsKICAgICAgICBjdXJyZW50X3NlZWQgPSAocG1fcmFuZF91cGRhdGUoY3VycmVudF9zZWVkKSAvIDY1NTM2KSAlIDMyNzY4OwogICAgICAgIGxldCB4OiBpMzIgPSBjdXJyZW50X3NlZWQgJSBHUklEX1dJRFRIOwogICAgICAgIGN1cnJlbnRfc2VlZCA9IChwbV9yYW5kX3VwZGF0ZShjdXJyZW50X3NlZWQpIC8gNjU1MzYpICUgMzI3Njg7CiAgICAgICAgbGV0IHk6IGkzMiA9IGN1cnJlbnRfc2VlZCAlIEdSSURfSEVJR0hUOwogICAgICAgIGN1cnJlbnRfc2VlZCA9IChwbV9yYW5kX3VwZGF0ZShjdXJyZW50X3NlZWQpIC8gNjU1MzYpICUgMzI3Njg7CiAgICAgICAgbGV0IGVuZXJneTogaTMyID0gMTAwICsgKGN1cnJlbnRfc2VlZCAlIDEwMCk7CgogICAgICAgIHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS5pZCA9IGk7CiAgICAgICAgd29ybGQuYWdlbnRzW2kgYXMgdXNpemVdLnggPSB4OwogICAgICAgIHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS55ID0geTsKICAgICAgICB3b3JsZC5hZ2VudHNbaSBhcyB1c2l6ZV0uZW5lcmd5ID0gZW5lcmd5OwogICAgICAgIHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS5hY3RpdmUgPSB0cnVlOwogICAgICAgIHdvcmxkLmdyaWRbeSBhcyB1c2l6ZV1beCBhcyB1c2l6ZV0gPSBpICsgMTsKICAgICAgICB1cGRhdGVfYWdlbnRfdGFyZ2V0KCZtdXQgd29ybGQuYWdlbnRzW2kgYXMgdXNpemVdLCBjdXJyZW50X3NlZWQpOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgR1JJRF9IRUlHSFQpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBHUklEX1dJRFRIKSB7CiAgICAgICAgICAgIGlmICh3b3JsZC5ncmlkW2kgYXMgdXNpemVdW2ogYXMgdXNpemVdID09IDApIHsKICAgICAgICAgICAgICAgIGN1cnJlbnRfc2VlZCA9IChwbV9yYW5kX3VwZGF0ZShjdXJyZW50X3NlZWQpIC8gNjU1MzYpICUgMzI3Njg7CiAgICAgICAgICAgICAgICBpZiAoY3VycmVudF9zZWVkICUgMTAgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIHdvcmxkLmdyaWRbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSAtMSAqIChjdXJyZW50X3NlZWQgJSA1ICsgMSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCmZuIHVwZGF0ZV9hZ2VudF90YXJnZXQoYWdlbnQ6ICZtdXQgQWdlbnQsIHNlZWQ6IGkzMikgewogICAgbGV0IG11dCBuZXdfc2VlZDogaTMyID0gc2VlZDsKICAgIG5ld19zZWVkID0gKHBtX3JhbmRfdXBkYXRlKG5ld19zZWVkKSAvIDY1NTM2KSAlIDMyNzY4OwogICAgYWdlbnQudGFyZ2V0X3ggPSBuZXdfc2VlZCAlIEdSSURfV0lEVEg7CiAgICBuZXdfc2VlZCA9IChwbV9yYW5kX3VwZGF0ZShuZXdfc2VlZCkgLyA2NTUzNikgJSAzMjc2ODsKICAgIGFnZW50LnRhcmdldF95ID0gbmV3X3NlZWQgJSBHUklEX0hFSUdIVDsKfQoKZm4gdXBkYXRlX3dvcmxkKHdvcmxkOiAmbXV0IFdvcmxkKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IE5VTV9BR0VOVFMpIHsKICAgICAgICBpZiAod29ybGQuYWdlbnRzW2kgYXMgdXNpemVdLmFjdGl2ZSkgewogICAgICAgICAgICBsZXQgYWdlbnQ6ICZtdXQgQWdlbnQgPSAmbXV0IHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXTsKICAgICAgICAgICAgbGV0IG9sZF94OiBpMzIgPSBhZ2VudC54OwogICAgICAgICAgICBsZXQgb2xkX3k6IGkzMiA9IGFnZW50Lnk7CgogICAgICAgICAgICBpZiAoYWdlbnQueCA8IGFnZW50LnRhcmdldF94KSB7CiAgICAgICAgICAgICAgICBhZ2VudC54ID0gYWdlbnQueCArIDE7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoYWdlbnQueCA+IGFnZW50LnRhcmdldF94KSB7CiAgICAgICAgICAgICAgICBhZ2VudC54ID0gYWdlbnQueCAtIDE7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChhZ2VudC55IDwgYWdlbnQudGFyZ2V0X3kpIHsKICAgICAgICAgICAgICAgIGFnZW50LnkgPSBhZ2VudC55ICsgMTsKICAgICAgICAgICAgfSBlbHNlIGlmIChhZ2VudC55ID4gYWdlbnQudGFyZ2V0X3kpIHsKICAgICAgICAgICAgICAgIGFnZW50LnkgPSBhZ2VudC55IC0gMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYWdlbnQueCA9IGNsYW1wKGFnZW50LngsIDAsIEdSSURfV0lEVEggLSAxKTsKICAgICAgICAgICAgYWdlbnQueSA9IGNsYW1wKGFnZW50LnksIDAsIEdSSURfSEVJR0hUIC0gMSk7CgogICAgICAgICAgICBhZ2VudC5lbmVyZ3kgPSBhZ2VudC5lbmVyZ3kgLSAxOwoKICAgICAgICAgICAgaWYgKHdvcmxkLmdyaWRbKGFnZW50LnkpIGFzIHVzaXplXVsoYWdlbnQueCkgYXMgdXNpemVdID09IDApIHsKICAgICAgICAgICAgICAgIHdvcmxkLmdyaWRbb2xkX3kgYXMgdXNpemVdW29sZF94IGFzIHVzaXplXSA9IDA7CiAgICAgICAgICAgICAgICB3b3JsZC5ncmlkWyhhZ2VudC55KSBhcyB1c2l6ZV1bKGFnZW50LngpIGFzIHVzaXplXSA9IGFnZW50LmlkICsgMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFnZW50LnggPSBvbGRfeDsKICAgICAgICAgICAgICAgIGFnZW50LnkgPSBvbGRfeTsKICAgICAgICAgICAgICAgIGFnZW50LmVuZXJneSA9IGFnZW50LmVuZXJneSAtIDU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChhZ2VudC54ID09IGFnZW50LnRhcmdldF94ICYmIGFnZW50LnkgPT0gYWdlbnQudGFyZ2V0X3kpIHsKICAgICAgICAgICAgICAgIHVwZGF0ZV9hZ2VudF90YXJnZXQoYWdlbnQsIGFnZW50LmlkICsgYWdlbnQuZW5lcmd5KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGFnZW50LmVuZXJneSA8PSAwKSB7CiAgICAgICAgICAgICAgICBhZ2VudC5hY3RpdmUgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHdvcmxkLmdyaWRbKGFnZW50LnkpIGFzIHVzaXplXVsoYWdlbnQueCkgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCmZuIHByb2Nlc3NfaW50ZXJhY3Rpb25zKHdvcmxkOiAmbXV0IFdvcmxkKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IE5VTV9BR0VOVFMpIHsKICAgICAgICBpZiAoIXdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS5hY3RpdmUpIHsKICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSBpICsgMTsKICAgICAgICB3aGlsZSAoaiA8IE5VTV9BR0VOVFMpIHsKICAgICAgICAgICAgaWYgKCF3b3JsZC5hZ2VudHNbaiBhcyB1c2l6ZV0uYWN0aXZlKSB7CiAgICAgICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IGFnZW50MTogJkFnZW50ID0gJndvcmxkLmFnZW50c1tpIGFzIHVzaXplXTsKICAgICAgICAgICAgbGV0IGFnZW50MjogJkFnZW50ID0gJndvcmxkLmFnZW50c1tqIGFzIHVzaXplXTsKCiAgICAgICAgICAgIGxldCBkaXN0X3g6IGkzMiA9IGFnZW50MS54IC0gYWdlbnQyLng7CiAgICAgICAgICAgIGxldCBkaXN0X3k6IGkzMiA9IGFnZW50MS55IC0gYWdlbnQyLnk7CgogICAgICAgICAgICBpZiAoZGlzdF94ICogZGlzdF94ICsgZGlzdF95ICogZGlzdF95IDwgNCkgewogICAgICAgICAgICAgICAgaWYgKGFnZW50MS5lbmVyZ3kgPiBhZ2VudDIuZW5lcmd5KSB7CiAgICAgICAgICAgICAgICAgICAgd29ybGQuYWdlbnRzW2kgYXMgdXNpemVdLmVuZXJneSA9IHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS5lbmVyZ3kgKyAxMDsKICAgICAgICAgICAgICAgICAgICB3b3JsZC5hZ2VudHNbaiBhcyB1c2l6ZV0uZW5lcmd5ID0gd29ybGQuYWdlbnRzW2ogYXMgdXNpemVdLmVuZXJneSAtIDEwOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB3b3JsZC5hZ2VudHNbaSBhcyB1c2l6ZV0uZW5lcmd5ID0gd29ybGQuYWdlbnRzW2kgYXMgdXNpemVdLmVuZXJneSAtIDEwOwogICAgICAgICAgICAgICAgICAgIHdvcmxkLmFnZW50c1tqIGFzIHVzaXplXS5lbmVyZ3kgPSB3b3JsZC5hZ2VudHNbaiBhcyB1c2l6ZV0uZW5lcmd5ICsgMTA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KCiAgICAgICAgbGV0IHg6IGkzMiA9IHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS54OwogICAgICAgIGxldCB5OiBpMzIgPSB3b3JsZC5hZ2VudHNbaSBhcyB1c2l6ZV0ueTsKICAgICAgICBpZiAod29ybGQuZ3JpZFt5IGFzIHVzaXplXVt4IGFzIHVzaXplXSA8IDApIHsKICAgICAgICAgICAgd29ybGQuYWdlbnRzW2kgYXMgdXNpemVdLmVuZXJneSA9CiAgICAgICAgICAgICAgICB3b3JsZC5hZ2VudHNbaSBhcyB1c2l6ZV0uZW5lcmd5ICsgd29ybGQuZ3JpZFt5IGFzIHVzaXplXVt4IGFzIHVzaXplXSAqIC0xMDsKICAgICAgICAgICAgd29ybGQuZ3JpZFt5IGFzIHVzaXplXVt4IGFzIHVzaXplXSA9IHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS5pZCArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKZm4gcnVuX2RpYWdub3N0aWNzKHdvcmxkOiAmbXV0IFdvcmxkKSB7CiAgICBsZXQgbXV0IHRvdGFsX2VuZXJneTogaTMyID0gMDsKICAgIGxldCBtdXQgYWN0aXZlX2FnZW50czogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgTlVNX0FHRU5UUykgewogICAgICAgIGlmICh3b3JsZC5hZ2VudHNbaSBhcyB1c2l6ZV0uYWN0aXZlKSB7CiAgICAgICAgICAgIHRvdGFsX2VuZXJneSA9IHRvdGFsX2VuZXJneSArIHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS5lbmVyZ3k7CiAgICAgICAgICAgIGFjdGl2ZV9hZ2VudHMgPSBhY3RpdmVfYWdlbnRzICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcHJpbnRsbkludCgxMDAwMDAgKyBhY3RpdmVfYWdlbnRzKTsKICAgIHByaW50bG5JbnQoMjAwMDAwICsgdG90YWxfZW5lcmd5KTsKICAgIHByb3Zva2VfZXJyb3Iod29ybGQpOwp9CgpmbiBmaW5hbF9yZXBvcnQod29ybGQ6ICZXb3JsZCkgewogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBOVU1fQUdFTlRTKSB7CiAgICAgICAgaWYgKHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS5hY3RpdmUpIHsKICAgICAgICAgICAgcHJpbnRsbkludCh3b3JsZC5hZ2VudHNbaSBhcyB1c2l6ZV0uaWQgKiAxMDAwMCArIHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS5lbmVyZ3kpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHByaW50bG5JbnQod29ybGQuYWdlbnRzW2kgYXMgdXNpemVdLmlkICogMTAwMDAgKyAtMSk7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KfQoKZm4gY2xhbXAodmFsOiBpMzIsIG1pbjogaTMyLCBtYXg6IGkzMikgLT4gaTMyIHsKICAgIGlmICh2YWwgPCBtaW4pIHsKICAgICAgICByZXR1cm4gbWluOwogICAgfQogICAgaWYgKHZhbCA+IG1heCkgewogICAgICAgIHJldHVybiBtYXg7CiAgICB9CiAgICByZXR1cm4gdmFsOwp9CgpmbiBwcm92b2tlX2Vycm9yKHdvcmxkOiAmbXV0IFdvcmxkKSB7CiAgICBsZXQgbXV0IGFnZW50X2NvcHk6IEFnZW50ID0gd29ybGQuYWdlbnRzWzBdOwogICAgYWdlbnRfY29weS5lbmVyZ3kgPSAtMTAwOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgTlVNX0FHRU5UUykgewogICAgICAgIGlmICh3b3JsZC5hZ2VudHNbaSBhcyB1c2l6ZV0uYWN0aXZlKSB7CiAgICAgICAgICAgIGlmICh3b3JsZC5hZ2VudHNbaSBhcyB1c2l6ZV0uZW5lcmd5ID4gMTUwKSB7CiAgICAgICAgICAgICAgICBsZXQgbXV0IHRlbXBfYWdlbnQ6IEFnZW50ID0gd29ybGQuYWdlbnRzW2kgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgdGVtcF9hZ2VudC5lbmVyZ3kgPSB0ZW1wX2FnZW50LmVuZXJneSAvIDI7CiAgICAgICAgICAgICAgICBpZiAodGVtcF9hZ2VudC5lbmVyZ3kgPiAxMDApIHsKICAgICAgICAgICAgICAgICAgICBwcmludGxuSW50KHRlbXBfYWdlbnQuaWQgKyA1MDAwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgbGV0IG11dCBzdHJvbmdlc3RfYWdlbnRfaWQ6IGkzMiA9IC0xOwogICAgbGV0IG11dCBtYXhfZW5lcmd5OiBpMzIgPSAtMTsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBOVU1fQUdFTlRTKSB7CiAgICAgICAgaWYgKHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS5hY3RpdmUpIHsKICAgICAgICAgICAgaWYgKHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS5lbmVyZ3kgPiBtYXhfZW5lcmd5KSB7CiAgICAgICAgICAgICAgICBtYXhfZW5lcmd5ID0gd29ybGQuYWdlbnRzW2kgYXMgdXNpemVdLmVuZXJneTsKICAgICAgICAgICAgICAgIHN0cm9uZ2VzdF9hZ2VudF9pZCA9IHdvcmxkLmFnZW50c1tpIGFzIHVzaXplXS5pZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgaWYgKHN0cm9uZ2VzdF9hZ2VudF9pZCAhPSAtMSkgewogICAgICAgIHdvcmxkLmFnZW50c1tzdHJvbmdlc3RfYWdlbnRfaWQgYXMgdXNpemVdLmVuZXJneSA9IDA7CiAgICB9Cn0KCmZuIGFub3RoZXJfc2ltdWxhdGlvbl9zY2VuYXJpbygpIHsKICAgIGxldCBtdXQgd29ybGQ6IFdvcmxkID0gV29ybGQgewogICAgICAgIGdyaWQ6IFtbMDsgR1JJRF9XSURUSF9VU0laRV07IEdSSURfSEVJR0hUX1VTSVpFXSwKICAgICAgICBhZ2VudHM6IFtBZ2VudCB7CiAgICAgICAgICAgIGlkOiAwLAogICAgICAgICAgICB4OiAwLAogICAgICAgICAgICB5OiAwLAogICAgICAgICAgICBlbmVyZ3k6IDAsCiAgICAgICAgICAgIHRhcmdldF94OiAwLAogICAgICAgICAgICB0YXJnZXRfeTogMCwKICAgICAgICAgICAgYWN0aXZlOiBmYWxzZSwKICAgICAgICB9OyBOVU1fQUdFTlRTX1VTSVpFXSwKICAgIH07CiAgICBpbml0aWFsaXplX3dvcmxkKCZtdXQgd29ybGQsIDExMjIzKTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgNTApIHsKICAgICAgICB1cGRhdGVfd29ybGQoJm11dCB3b3JsZCk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcHJvY2Vzc19pbnRlcmFjdGlvbnMoJm11dCB3b3JsZCk7CiAgICBmaW5hbF9yZXBvcnQoJndvcmxkKTsKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (34, "comprehensive34", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEhpZXJhcmNoaWNhbCBEYXRhIFByb2Nlc3NpbmcgYW5kIFRyZWUgVHJhdmVyc2FsClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpSZWN1cnNpdmUgZGF0YSBzdHJ1Y3R1cmVzIChzaW11bGF0ZWQgdHJlZXMgdXNpbmcgYXJyYXlzKS4KQ29tcGxleCByZWN1cnNpdmUgYWxnb3JpdGhtcyBmb3IgdHJlZSB0cmF2ZXJzYWwgYW5kIG1hbmlwdWxhdGlvbi4KRHluYW1pYy1saWtlIGJlaGF2aW9yIHNpbXVsYXRpb24gd2l0aCBzdGF0aWMgYXJyYXlzLgpQZXJmb3JtYW5jZSBvZiBmdW5jdGlvbiBjYWxscyBhbmQgc3RhY2sgdXNhZ2UgaW4gZGVlcCByZWN1cnNpb24uCkNvbmRpdGlvbmFsIGxvZ2ljIGZvciBub2RlIHByb2Nlc3NpbmcgYmFzZWQgb24gdHlwZSBhbmQgdmFsdWUuCiovCgovLyBjb21wcmVoZW5zaXZlMzQucnggLSBIaWVyYXJjaGljYWwgRGF0YSBQcm9jZXNzaW5nIGFuZCBUcmVlIFRyYXZlcnNhbAovLyBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKLy8gLSBSZWN1cnNpdmUgZGF0YSBzdHJ1Y3R1cmVzIChzaW11bGF0ZWQgdHJlZXMgdXNpbmcgYXJyYXlzKS4KLy8gLSBDb21wbGV4IHJlY3Vyc2l2ZSBhbGdvcml0aG1zIGZvciB0cmVlIHRyYXZlcnNhbCBhbmQgbWFuaXB1bGF0aW9uLgovLyAtIER5bmFtaWMtbGlrZSBiZWhhdmlvciBzaW11bGF0aW9uIHdpdGggc3RhdGljIGFycmF5cy4KLy8gLSBQZXJmb3JtYW5jZSBvZiBmdW5jdGlvbiBjYWxscyBhbmQgc3RhY2sgdXNhZ2UgaW4gZGVlcCByZWN1cnNpb24uCi8vIC0gQ29uZGl0aW9uYWwgbG9naWMgZm9yIG5vZGUgcHJvY2Vzc2luZyBiYXNlZCBvbiB0eXBlIGFuZCB2YWx1ZS4KCmNvbnN0IE5PREVfUE9PTF9TSVpFOiBpMzIgPSA1MTI7CmNvbnN0IE5PREVfUE9PTF9VU0laRTogdXNpemUgPSA1MTI7CmNvbnN0IE5PREVfU0laRTogaTMyID0gNDsKCmNvbnN0IFRZUEVfSU5URVJOQUw6IGkzMiA9IDE7CmNvbnN0IFRZUEVfTEVBRjogaTMyID0gMjsKCnN0cnVjdCBOb2RlIHsKICAgIG5vZGVfdHlwZTogaTMyLAogICAgdmFsdWU6IGkzMiwKICAgIGxlZnQ6IGkzMiwKICAgIHJpZ2h0OiBpMzIsCn0KCnN0cnVjdCBUcmVlIHsKICAgIHBvb2w6IFtOb2RlOyBOT0RFX1BPT0xfVVNJWkVdLAogICAgcm9vdDogaTMyLAogICAgbmV4dF9mcmVlOiBpMzIsCn0KCmZuIG1haW4oKSB7CiAgICBsZXQgbXV0IHRyZWU6IFRyZWUgPSBUcmVlIHsKICAgICAgICBwb29sOiBbTm9kZSB7IG5vZGVfdHlwZTogMCwgdmFsdWU6IDAsIGxlZnQ6IC0xLCByaWdodDogLTEgfTsgTk9ERV9QT09MX1VTSVpFXSwKICAgICAgICByb290OiAtMSwKICAgICAgICBuZXh0X2ZyZWU6IDAsCiAgICB9OwoKICAgIGluaXRpYWxpemVfcG9vbCgmbXV0IHRyZWUpOwoKICAgIHRyZWUucm9vdCA9IGJ1aWxkX2NvbXBsZXhfdHJlZSgmbXV0IHRyZWUsIDQsIDEwMCk7CgogICAgbGV0IG11dCBzdW06IGkzMiA9IHN1bV90cmVlKCZ0cmVlLCB0cmVlLnJvb3QpOwogICAgcHJpbnRsbkludChzdW0pOwoKICAgIGxldCBtdXQgaGVpZ2h0OiBpMzIgPSBmaW5kX2hlaWdodCgmdHJlZSwgdHJlZS5yb290KTsKICAgIHByaW50bG5JbnQoaGVpZ2h0KTsKCiAgICBsZXQgbXV0IHNlYXJjaF92YWw6IGkzMiA9IDEyNTsKICAgIGxldCBtdXQgZm91bmQ6IGJvb2wgPSBmaW5kX3ZhbHVlKCZ0cmVlLCB0cmVlLnJvb3QsIHNlYXJjaF92YWwpOwogICAgaWYgKGZvdW5kKSB7CiAgICAgICAgcHJpbnRsbkludChzZWFyY2hfdmFsKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnRsbkludCgtMSk7CiAgICB9CgogICAgbGV0IHJvb3Q6IGkzMiA9IHRyZWUucm9vdDsKICAgIG1pcnJvcl90cmVlKCZtdXQgdHJlZSwgcm9vdCk7CiAgICBzdW0gPSBzdW1fdHJlZSgmdHJlZSwgcm9vdCk7CiAgICBwcmludGxuSW50KHN1bSk7CgogICAgbGV0IG11dCBlcnJvcl9zdW06IGkzMiA9IHByb2Nlc3Nfd2l0aF9zaGFkb3dfZXJyb3IoJnRyZWUsIHRyZWUucm9vdCwgMTApOwogICAgcHJpbnRsbkludChlcnJvcl9zdW0pOwoKICAgIHByaW50bG5JbnQoOTk5OSk7CiAgICBleGl0KDApOwp9CgpmbiBpbml0aWFsaXplX3Bvb2wodHJlZTogJm11dCBUcmVlKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IE5PREVfUE9PTF9TSVpFKSB7CiAgICAgICAgdHJlZS5wb29sW2kgYXMgdXNpemVdLmxlZnQgPSBpICsgMTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICB0cmVlLnBvb2xbTk9ERV9QT09MX1VTSVpFIC0gMV0ubGVmdCA9IC0xOwogICAgdHJlZS5uZXh0X2ZyZWUgPSAwOwp9CgpmbiBhbGxvY19ub2RlKHRyZWU6ICZtdXQgVHJlZSkgLT4gaTMyIHsKICAgIGlmICh0cmVlLm5leHRfZnJlZSA9PSAtMSkgewogICAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIGxldCBuZXdfbm9kZV9pZHg6IGkzMiA9IHRyZWUubmV4dF9mcmVlOwogICAgdHJlZS5uZXh0X2ZyZWUgPSB0cmVlLnBvb2xbbmV3X25vZGVfaWR4IGFzIHVzaXplXS5sZWZ0OwogICAgdHJlZS5wb29sW25ld19ub2RlX2lkeCBhcyB1c2l6ZV0ubGVmdCA9IC0xOwogICAgdHJlZS5wb29sW25ld19ub2RlX2lkeCBhcyB1c2l6ZV0ucmlnaHQgPSAtMTsKICAgIHJldHVybiBuZXdfbm9kZV9pZHg7Cn0KCmZuIGJ1aWxkX2NvbXBsZXhfdHJlZSh0cmVlOiAmbXV0IFRyZWUsIGRlcHRoOiBpMzIsIGJhc2VfdmFsdWU6IGkzMikgLT4gaTMyIHsKICAgIGlmIChkZXB0aCA8PSAwKSB7CiAgICAgICAgbGV0IGxlYWZfaWR4OiBpMzIgPSBhbGxvY19ub2RlKHRyZWUpOwogICAgICAgIGlmIChsZWFmX2lkeCAhPSAtMSkgewogICAgICAgICAgICB0cmVlLnBvb2xbbGVhZl9pZHggYXMgdXNpemVdLm5vZGVfdHlwZSA9IFRZUEVfTEVBRjsKICAgICAgICAgICAgdHJlZS5wb29sW2xlYWZfaWR4IGFzIHVzaXplXS52YWx1ZSA9IGJhc2VfdmFsdWUgJSAyNTY7CiAgICAgICAgfQogICAgICAgIHJldHVybiBsZWFmX2lkeDsKICAgIH0KCiAgICBsZXQgcm9vdF9pZHg6IGkzMiA9IGFsbG9jX25vZGUodHJlZSk7CiAgICBpZiAocm9vdF9pZHggPT0gLTEpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CgogICAgdHJlZS5wb29sW3Jvb3RfaWR4IGFzIHVzaXplXS5ub2RlX3R5cGUgPSBUWVBFX0lOVEVSTkFMOwogICAgdHJlZS5wb29sW3Jvb3RfaWR4IGFzIHVzaXplXS52YWx1ZSA9IGJhc2VfdmFsdWU7CgogICAgdHJlZS5wb29sW3Jvb3RfaWR4IGFzIHVzaXplXS5sZWZ0ID0gYnVpbGRfY29tcGxleF90cmVlKHRyZWUsIGRlcHRoIC0gMSwgYmFzZV92YWx1ZSAqIDIgKyAxKTsKICAgIHRyZWUucG9vbFtyb290X2lkeCBhcyB1c2l6ZV0ucmlnaHQgPSBidWlsZF9jb21wbGV4X3RyZWUodHJlZSwgZGVwdGggLSAxLCBiYXNlX3ZhbHVlICogMyAtIDEpOwoKICAgIHJldHVybiByb290X2lkeDsKfQoKZm4gc3VtX3RyZWUodHJlZTogJlRyZWUsIG5vZGVfaWR4OiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobm9kZV9pZHggPT0gLTEpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAgICBsZXQgbm9kZTogJk5vZGUgPSAmdHJlZS5wb29sW25vZGVfaWR4IGFzIHVzaXplXTsKICAgIGlmIChub2RlLm5vZGVfdHlwZSA9PSBUWVBFX0xFQUYpIHsKICAgICAgICByZXR1cm4gbm9kZS52YWx1ZTsKICAgIH0KCiAgICBsZXQgbGVmdF9zdW06IGkzMiA9IHN1bV90cmVlKHRyZWUsIG5vZGUubGVmdCk7CiAgICBsZXQgcmlnaHRfc3VtOiBpMzIgPSBzdW1fdHJlZSh0cmVlLCBub2RlLnJpZ2h0KTsKCiAgICByZXR1cm4gbm9kZS52YWx1ZSArIGxlZnRfc3VtICsgcmlnaHRfc3VtOwp9CgpmbiBmaW5kX2hlaWdodCh0cmVlOiAmVHJlZSwgbm9kZV9pZHg6IGkzMikgLT4gaTMyIHsKICAgIGlmIChub2RlX2lkeCA9PSAtMSkgewogICAgICAgIHJldHVybiAwOwogICAgfQogICAgbGV0IGxlZnRfaGVpZ2h0OiBpMzIgPSBmaW5kX2hlaWdodCh0cmVlLCB0cmVlLnBvb2xbbm9kZV9pZHggYXMgdXNpemVdLmxlZnQpOwogICAgbGV0IHJpZ2h0X2hlaWdodDogaTMyID0gZmluZF9oZWlnaHQodHJlZSwgdHJlZS5wb29sW25vZGVfaWR4IGFzIHVzaXplXS5yaWdodCk7CiAgICBpZiAobGVmdF9oZWlnaHQgPiByaWdodF9oZWlnaHQpIHsKICAgICAgICByZXR1cm4gbGVmdF9oZWlnaHQgKyAxOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gcmlnaHRfaGVpZ2h0ICsgMTsKICAgIH0KfQoKZm4gZmluZF92YWx1ZSh0cmVlOiAmVHJlZSwgbm9kZV9pZHg6IGkzMiwgdmFsdWU6IGkzMikgLT4gYm9vbCB7CiAgICBpZiAobm9kZV9pZHggPT0gLTEpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBsZXQgbm9kZTogJk5vZGUgPSAmdHJlZS5wb29sW25vZGVfaWR4IGFzIHVzaXplXTsKICAgIGlmIChub2RlLnZhbHVlID09IHZhbHVlKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICBpZiAoZmluZF92YWx1ZSh0cmVlLCBub2RlLmxlZnQsIHZhbHVlKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgaWYgKGZpbmRfdmFsdWUodHJlZSwgbm9kZS5yaWdodCwgdmFsdWUpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICByZXR1cm4gZmFsc2U7Cn0KCmZuIG1pcnJvcl90cmVlKHRyZWU6ICZtdXQgVHJlZSwgbm9kZV9pZHg6IGkzMikgewogICAgaWYgKG5vZGVfaWR4ID09IC0xKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgbGV0IG5vZGU6ICZtdXQgTm9kZSA9ICZtdXQgdHJlZS5wb29sW25vZGVfaWR4IGFzIHVzaXplXTsKICAgIGxldCB0ZW1wOiBpMzIgPSBub2RlLmxlZnQ7CiAgICBub2RlLmxlZnQgPSBub2RlLnJpZ2h0OwogICAgbm9kZS5yaWdodCA9IHRlbXA7CiAgICAKICAgIGxldCBsZWZ0OiBpMzIgPSBub2RlLmxlZnQ7CiAgICBsZXQgcmlnaHQ6IGkzMiA9IG5vZGUucmlnaHQ7CiAgICBtaXJyb3JfdHJlZSh0cmVlLCBsZWZ0KTsKICAgIG1pcnJvcl90cmVlKHRyZWUsIHJpZ2h0KTsKfQoKZm4gcHJvY2Vzc193aXRoX3NoYWRvd19lcnJvcih0cmVlOiAmVHJlZSwgbm9kZV9pZHg6IGkzMiwgdGhyZXNob2xkOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobm9kZV9pZHggPT0gLTEpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAgICBsZXQgbXV0IGN1cnJlbnRfc3VtOiBpMzIgPSAwOwogICAgbGV0IG5vZGU6ICZOb2RlID0gJnRyZWUucG9vbFtub2RlX2lkeCBhcyB1c2l6ZV07CgogICAgaWYgKG5vZGUudmFsdWUgPiB0aHJlc2hvbGQpIHsKICAgICAgICBjdXJyZW50X3N1bSA9IGN1cnJlbnRfc3VtICsgbm9kZS52YWx1ZTsKICAgICAgICBsZXQgbXV0IHRocmVzaG9sZDogaTMyID0gdGhyZXNob2xkICsgMTA7CiAgICAgICAgaWYgKG5vZGUubm9kZV90eXBlID09IFRZUEVfSU5URVJOQUwpIHsKICAgICAgICAgICAgY3VycmVudF9zdW0gPSBjdXJyZW50X3N1bSArIHByb2Nlc3Nfd2l0aF9zaGFkb3dfZXJyb3IodHJlZSwgbm9kZS5sZWZ0LCB0aHJlc2hvbGQpOwogICAgICAgICAgICBjdXJyZW50X3N1bSA9IGN1cnJlbnRfc3VtICsgcHJvY2Vzc193aXRoX3NoYWRvd19lcnJvcih0cmVlLCBub2RlLnJpZ2h0LCB0aHJlc2hvbGQpOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKG5vZGUubm9kZV90eXBlID09IFRZUEVfSU5URVJOQUwpIHsKICAgICAgICAgICAgbGV0IG11dCB0aHJlc2hvbGQ6IGkzMiA9IHRocmVzaG9sZCAtIDI7CiAgICAgICAgICAgIGN1cnJlbnRfc3VtID0gY3VycmVudF9zdW0gKyBwcm9jZXNzX3dpdGhfc2hhZG93X2Vycm9yKHRyZWUsIG5vZGUubGVmdCwgdGhyZXNob2xkKTsKICAgICAgICAgICAgY3VycmVudF9zdW0gPSBjdXJyZW50X3N1bSArIHByb2Nlc3Nfd2l0aF9zaGFkb3dfZXJyb3IodHJlZSwgbm9kZS5yaWdodCwgdGhyZXNob2xkKTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gY3VycmVudF9zdW07Cn0KCmZuIHBydW5lX3RyZWUodHJlZTogJm11dCBUcmVlLCBub2RlX2lkeDogaTMyLCBtYXhfZGVwdGg6IGkzMiwgY3VycmVudF9kZXB0aDogaTMyKSB7CiAgICBpZiAobm9kZV9pZHggPT0gLTEgfHwgY3VycmVudF9kZXB0aCA+PSBtYXhfZGVwdGgpIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoY3VycmVudF9kZXB0aCA9PSBtYXhfZGVwdGggLSAxKSB7CiAgICAgICAgbGV0IG5vZGU6ICZOb2RlID0gJnRyZWUucG9vbFtub2RlX2lkeCBhcyB1c2l6ZV07CiAgICAgICAgbGV0IGxlZnQ6IGkzMiA9IG5vZGUubGVmdDsKICAgICAgICBsZXQgcmlnaHQ6IGkzMiA9IG5vZGUucmlnaHQ7CiAgICAgICAgZnJlZV90cmVlKHRyZWUsIGxlZnQpOwogICAgICAgIGZyZWVfdHJlZSh0cmVlLCByaWdodCk7CiAgICAgICAgbGV0IG5vZGU6ICZtdXQgTm9kZSA9ICZtdXQgdHJlZS5wb29sW25vZGVfaWR4IGFzIHVzaXplXTsKICAgICAgICBub2RlLmxlZnQgPSAtMTsKICAgICAgICBub2RlLnJpZ2h0ID0gLTE7CiAgICAgICAgbm9kZS5ub2RlX3R5cGUgPSBUWVBFX0xFQUY7CiAgICB9IGVsc2UgewogICAgICAgIGxldCBub2RlOiAmTm9kZSA9ICZ0cmVlLnBvb2xbbm9kZV9pZHggYXMgdXNpemVdOwogICAgICAgIGxldCBsZWZ0OiBpMzIgPSBub2RlLmxlZnQ7CiAgICAgICAgbGV0IHJpZ2h0OiBpMzIgPSBub2RlLnJpZ2h0OwogICAgICAgIHBydW5lX3RyZWUodHJlZSwgbGVmdCwgbWF4X2RlcHRoLCBjdXJyZW50X2RlcHRoICsgMSk7CiAgICAgICAgcHJ1bmVfdHJlZSh0cmVlLCByaWdodCwgbWF4X2RlcHRoLCBjdXJyZW50X2RlcHRoICsgMSk7CiAgICB9Cn0KCmZuIGZyZWVfdHJlZSh0cmVlOiAmbXV0IFRyZWUsIG5vZGVfaWR4OiBpMzIpIHsKICAgIGlmIChub2RlX2lkeCA9PSAtMSkgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGZyZWVfdHJlZSh0cmVlLCB0cmVlLnBvb2xbbm9kZV9pZHggYXMgdXNpemVdLmxlZnQpOwogICAgZnJlZV90cmVlKHRyZWUsIHRyZWUucG9vbFtub2RlX2lkeCBhcyB1c2l6ZV0ucmlnaHQpOwogICAgdHJlZS5wb29sW25vZGVfaWR4IGFzIHVzaXplXS5sZWZ0ID0gdHJlZS5uZXh0X2ZyZWU7CiAgICB0cmVlLm5leHRfZnJlZSA9IG5vZGVfaWR4Owp9CgpmbiBhbm90aGVyX3RyZWVfb3BlcmF0aW9uKCkgewogICAgbGV0IG11dCB0cmVlOiBUcmVlID0gVHJlZSB7CiAgICAgICAgcG9vbDogW05vZGUgeyBub2RlX3R5cGU6IDAsIHZhbHVlOiAwLCBsZWZ0OiAtMSwgcmlnaHQ6IC0xIH07IE5PREVfUE9PTF9VU0laRV0sCiAgICAgICAgcm9vdDogLTEsCiAgICAgICAgbmV4dF9mcmVlOiAwLAogICAgfTsKICAgIGluaXRpYWxpemVfcG9vbCgmbXV0IHRyZWUpOwogICAgdHJlZS5yb290ID0gYnVpbGRfY29tcGxleF90cmVlKCZtdXQgdHJlZSwgNSwgNTApOwogICAgbGV0IHJvb3Q6IGkzMiA9IHRyZWUucm9vdDsKICAgIHBydW5lX3RyZWUoJm11dCB0cmVlLCByb290LCAzLCAwKTsKICAgIGxldCBzdW06IGkzMiA9IHN1bV90cmVlKCZ0cmVlLCByb290KTsKICAgIHByaW50bG5JbnQoc3VtKTsKfQoKZm4geWV0X2Fub3RoZXJfc2NlbmFyaW8oKSB7CiAgICBsZXQgbXV0IHRyZWU6IFRyZWUgPSBUcmVlIHsKICAgICAgICBwb29sOiBbTm9kZSB7IG5vZGVfdHlwZTogMCwgdmFsdWU6IDAsIGxlZnQ6IC0xLCByaWdodDogLTEgfTsgTk9ERV9QT09MX1VTSVpFXSwKICAgICAgICByb290OiAtMSwKICAgICAgICBuZXh0X2ZyZWU6IDAsCiAgICB9OwogICAgaW5pdGlhbGl6ZV9wb29sKCZtdXQgdHJlZSk7CiAgICB0cmVlLnJvb3QgPSBidWlsZF9jb21wbGV4X3RyZWUoJm11dCB0cmVlLCA2LCAyMCk7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IDEwKSB7CiAgICAgICAgbGV0IHJvb3Q6IGkzMiA9IHRyZWUucm9vdDsKICAgICAgICBtaXJyb3JfdHJlZSgmbXV0IHRyZWUsIHJvb3QpOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIGxldCBoZWlnaHQ6IGkzMiA9IGZpbmRfaGVpZ2h0KCZ0cmVlLCB0cmVlLnJvb3QpOwogICAgcHJpbnRsbkludChoZWlnaHQpOwogICAgYW5vdGhlcl90cmVlX29wZXJhdGlvbigpOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (35, "comprehensive35", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEFkdmFuY2VkIENvbnRyb2wgRmxvdyBhbmQgTG9naWMgUHV6emxlClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpEZWVwbHkgbmVzdGVkIGFuZCBjb21wbGV4IGNvbnRyb2wgZmxvdyBzdHJ1Y3R1cmVzIChpZiwgd2hpbGUsIGZvcikuCkludHJpY2F0ZSBib29sZWFuIGxvZ2ljIGFuZCBzdGF0ZSB0cmFuc2l0aW9ucy4KT3B0aW1pemF0aW9uIG9mIGxvb3AgaW52YXJpYW50cyBhbmQgYnJhbmNoIHByZWRpY3Rpb24uCkNvcnJlY3QgaGFuZGxpbmcgb2YgdmFyaWFibGUgbGlmZXRpbWVzIGFjcm9zcyBjb21wbGV4IHNjb3Blcy4KRnVuY3Rpb24gY2FsbHMgd2l0aGluIGRlZXBseSBuZXN0ZWQgbG9vcHMuCiovCgovLyBVbmlmaWVkIFJORzogUGFya+KAk01pbGxlciAoYT0xNjgwNywgbT0yMTQ3NDgzNjQ3KSB1c2luZyBTY2hyYWdlIG1ldGhvZCB0byBhdm9pZCBvdmVyZmxvdwpmbiBwbV9yYW5kX3VwZGF0ZSh4OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgYTogaTMyID0gMTY4MDc7CiAgICBsZXQgbTogaTMyID0gMjE0NzQ4MzY0NzsKICAgIGxldCBxOiBpMzIgPSAxMjc3NzM7IC8vIG0gLyBhCiAgICBsZXQgcjogaTMyID0gMjgzNjsgLy8gbSAlIGEKICAgIGxldCBrOiBpMzIgPSB4IC8gcTsKICAgIGxldCBtdXQgbmV3X3g6IGkzMiA9IGEgKiAoeCAtIGsgKiBxKSAtIHIgKiBrOwogICAgaWYgKG5ld194IDw9IDApIHsKICAgICAgICBuZXdfeCArPSBtOwogICAgfQogICAgcmV0dXJuIG5ld194Owp9CgovLyBjb21wcmVoZW5zaXZlMzUucnggLSBBZHZhbmNlZCBDb250cm9sIEZsb3cgYW5kIExvZ2ljIFB1enpsZQovLyBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKLy8gLSBEZWVwbHkgbmVzdGVkIGFuZCBjb21wbGV4IGNvbnRyb2wgZmxvdyBzdHJ1Y3R1cmVzIChpZiwgd2hpbGUsIGZvcikuCi8vIC0gSW50cmljYXRlIGJvb2xlYW4gbG9naWMgYW5kIHN0YXRlIHRyYW5zaXRpb25zLgovLyAtIE9wdGltaXphdGlvbiBvZiBsb29wIGludmFyaWFudHMgYW5kIGJyYW5jaCBwcmVkaWN0aW9uLgovLyAtIENvcnJlY3QgaGFuZGxpbmcgb2YgdmFyaWFibGUgbGlmZXRpbWVzIGFjcm9zcyBjb21wbGV4IHNjb3Blcy4KLy8gLSBGdW5jdGlvbiBjYWxscyB3aXRoaW4gZGVlcGx5IG5lc3RlZCBsb29wcy4KCmNvbnN0IE1BWkVfU0laRTogdXNpemUgPSAyMDsKY29uc3QgTUFYX1NURVBTOiBpMzIgPSAxMDAwOwoKZm4gbWFpbigpIHsKICAgIGxldCBtdXQgbWF6ZTogW1tpMzI7IE1BWkVfU0laRV07IE1BWkVfU0laRV0gPSBbWzA7IE1BWkVfU0laRV07IE1BWkVfU0laRV07CiAgICBnZW5lcmF0ZV9tYXplKCZtdXQgbWF6ZSwgNTQzMjEpOwoKICAgIGxldCBzdGFydF94OiB1c2l6ZSA9IDE7CiAgICBsZXQgc3RhcnRfeTogdXNpemUgPSAxOwogICAgbWF6ZVtzdGFydF95XVtzdGFydF94XSA9IDA7CgogICAgbGV0IGVuZF94OiB1c2l6ZSA9IE1BWkVfU0laRSAtIDI7CiAgICBsZXQgZW5kX3k6IHVzaXplID0gTUFaRV9TSVpFIC0gMjsKICAgIG1hemVbZW5kX3ldW2VuZF94XSA9IDA7CgogICAgbGV0IHBhdGhfbGVuOiBpMzIgPSBzb2x2ZV9tYXplKAogICAgICAgICZtdXQgbWF6ZSwKICAgICAgICBzdGFydF94IGFzIGkzMiwKICAgICAgICBzdGFydF95IGFzIGkzMiwKICAgICAgICBlbmRfeCBhcyBpMzIsCiAgICAgICAgZW5kX3kgYXMgaTMyLAogICAgKTsKICAgIHByaW50bG5JbnQocGF0aF9sZW4pOwoKICAgIGxldCBwdXp6bGVfcmVzdWx0OiBpMzIgPSBzb2x2ZV9sb2dpY19wdXp6bGUoKTsKICAgIHByaW50bG5JbnQocHV6emxlX3Jlc3VsdCk7CgogICAgbGV0IGVycm9yX3ZhbDogaTMyID0gcnVuX2NvbnRyb2xfZmxvd19wdXp6bGUoKTsKICAgIHByaW50bG5JbnQoZXJyb3JfdmFsKTsKCiAgICBwcmludGxuSW50KDk5OTkpOwogICAgZXhpdCgwKTsKfQoKZm4gZ2VuZXJhdGVfbWF6ZShtYXplOiAmbXV0IFtbaTMyOyBNQVpFX1NJWkVdOyBNQVpFX1NJWkVdLCBzZWVkOiBpMzIpIHsKICAgIGxldCBtdXQgY3VycmVudF9zZWVkOiBpMzIgPSBzZWVkOwogICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICB3aGlsZSAoaSA8IE1BWkVfU0laRSkgewogICAgICAgIGxldCBtdXQgajogdXNpemUgPSAwOwogICAgICAgIHdoaWxlIChqIDwgTUFaRV9TSVpFKSB7CiAgICAgICAgICAgIGlmIChpID09IDAgfHwgaiA9PSAwIHx8IGkgPT0gTUFaRV9TSVpFIC0gMSB8fCBqID09IE1BWkVfU0laRSAtIDEpIHsKICAgICAgICAgICAgICAgIG1hemVbaV1bal0gPSAxOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY3VycmVudF9zZWVkID0gKHBtX3JhbmRfdXBkYXRlKGN1cnJlbnRfc2VlZCkgLyA2NTUzNikgJSAzMjc2ODsKICAgICAgICAgICAgICAgIGlmIChjdXJyZW50X3NlZWQgJSA0ID09IDApIHsKICAgICAgICAgICAgICAgICAgICBtYXplW2ldW2pdID0gMTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgbWF6ZVtpXVtqXSA9IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9Cn0KCmZuIHNvbHZlX21hemUoCiAgICBtYXplOiAmbXV0IFtbaTMyOyBNQVpFX1NJWkVdOyBNQVpFX1NJWkVdLAogICAgc3RhcnRfeDogaTMyLAogICAgc3RhcnRfeTogaTMyLAogICAgZW5kX3g6IGkzMiwKICAgIGVuZF95OiBpMzIsCikgLT4gaTMyIHsKICAgIGxldCBtdXQgeDogaTMyID0gc3RhcnRfeDsKICAgIGxldCBtdXQgeTogaTMyID0gc3RhcnRfeTsKICAgIGxldCBtdXQgc3RlcHM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGRpcjogaTMyID0gMDsKCiAgICB3aGlsZSAoc3RlcHMgPCBNQVhfU1RFUFMpIHsKICAgICAgICBpZiAoeCA9PSBlbmRfeCAmJiB5ID09IGVuZF95KSB7CiAgICAgICAgICAgIHJldHVybiBzdGVwczsKICAgICAgICB9CgogICAgICAgIGxldCBtdXQgdHVybmVkOiBib29sID0gZmFsc2U7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgNCkgewogICAgICAgICAgICBsZXQgbmV4dF9kaXI6IGkzMiA9IChkaXIgKyAzICsgaSkgJSA0OwogICAgICAgICAgICBsZXQgbXV0IG5leHRfeDogaTMyID0geDsKICAgICAgICAgICAgbGV0IG11dCBuZXh0X3k6IGkzMiA9IHk7CgogICAgICAgICAgICBpZiAobmV4dF9kaXIgPT0gMCkgewogICAgICAgICAgICAgICAgbmV4dF95ID0gbmV4dF95IC0gMTsKICAgICAgICAgICAgfSBlbHNlIGlmIChuZXh0X2RpciA9PSAxKSB7CiAgICAgICAgICAgICAgICBuZXh0X3ggPSBuZXh0X3ggKyAxOwogICAgICAgICAgICB9IGVsc2UgaWYgKG5leHRfZGlyID09IDIpIHsKICAgICAgICAgICAgICAgIG5leHRfeSA9IG5leHRfeSArIDE7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBuZXh0X3ggPSBuZXh0X3ggLSAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobWF6ZVtuZXh0X3kgYXMgdXNpemVdW25leHRfeCBhcyB1c2l6ZV0gPT0gMCkgewogICAgICAgICAgICAgICAgeCA9IG5leHRfeDsKICAgICAgICAgICAgICAgIHkgPSBuZXh0X3k7CiAgICAgICAgICAgICAgICBkaXIgPSBuZXh0X2RpcjsKICAgICAgICAgICAgICAgIHR1cm5lZCA9IHRydWU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoIXR1cm5lZCkgewogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIHN0ZXBzID0gc3RlcHMgKyAxOwogICAgfQogICAgcmV0dXJuIC0xOwp9CgpmbiBzb2x2ZV9sb2dpY19wdXp6bGUoKSAtPiBpMzIgewogICAgbGV0IG11dCBhOiBpMzIgPSAwOwogICAgbGV0IG11dCBiOiBpMzIgPSAwOwogICAgbGV0IG11dCBjOiBpMzIgPSAwOwogICAgbGV0IG11dCBkOiBpMzIgPSAwOwogICAgbGV0IG11dCBlOiBpMzIgPSAwOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgMTAwMDApIHsKICAgICAgICBhID0gKGkgJSA1KSArIDE7CiAgICAgICAgYiA9IChpIC8gNSAlIDUpICsgMTsKICAgICAgICBjID0gKGkgLyAyNSAlIDUpICsgMTsKICAgICAgICBkID0gKGkgLyAxMjUgJSA1KSArIDE7CiAgICAgICAgZSA9IChpIC8gNjI1ICUgNSkgKyAxOwoKICAgICAgICBpZiAoYSA9PSBiCiAgICAgICAgICAgIHx8IGEgPT0gYwogICAgICAgICAgICB8fCBhID09IGQKICAgICAgICAgICAgfHwgYSA9PSBlCiAgICAgICAgICAgIHx8IGIgPT0gYwogICAgICAgICAgICB8fCBiID09IGQKICAgICAgICAgICAgfHwgYiA9PSBlCiAgICAgICAgICAgIHx8IGMgPT0gZAogICAgICAgICAgICB8fCBjID09IGUKICAgICAgICAgICAgfHwgZCA9PSBlKQogICAgICAgIHsKICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CgogICAgICAgIGxldCBtdXQgY29uZDE6IGJvb2wgPSAoYyA9PSAxKTsKICAgICAgICBsZXQgbXV0IGNvbmQyOiBib29sID0gKGIgPT0gMik7CiAgICAgICAgbGV0IG11dCBjb25kMzogYm9vbCA9IChhID09IDUpOwogICAgICAgIGxldCBtdXQgY29uZDQ6IGJvb2wgPSAoZCAhPSAxKTsKICAgICAgICBsZXQgbXV0IGNvbmQ1OiBib29sID0gKGUgPT0gNCk7CgogICAgICAgIGlmICgoYSA9PSAzKSAhPSAoY29uZDEpKSB7CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGlmICgoYiA9PSAyKSAhPSAoY29uZDIpKSB7CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGlmICgoYyA9PSA0KSAhPSAoY29uZDMpKSB7CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGlmICgoZCA9PSAxKSAhPSAoY29uZDQpKSB7CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGlmICgoZSA9PSAzKSAhPSAoY29uZDUpKSB7CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gYSAqIDEwMDAwICsgYiAqIDEwMDAgKyBjICogMTAwICsgZCAqIDEwICsgZTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICByZXR1cm4gLTE7Cn0KCmZuIHJ1bl9jb250cm9sX2Zsb3dfcHV6emxlKCkgLT4gaTMyIHsKICAgIGxldCBtdXQgeDogaTMyID0gMTsKICAgIGxldCBtdXQgeTogaTMyID0gMTsKICAgIGxldCBtdXQgejogaTMyID0gMTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICB3aGlsZSAoaSA8IDEwMCkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IDUpIHsKICAgICAgICAgICAgaWYgKGkgJSAyID09IDApIHsKICAgICAgICAgICAgICAgIHggPSB4ICsgKHkgJSAoaiArIDEpKTsKICAgICAgICAgICAgICAgIGlmICh4ID4gMTAwKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IG11dCBrOiBpMzIgPSAwOwogICAgICAgICAgICAgICAgICAgIHdoaWxlIChrIDwgMykgewogICAgICAgICAgICAgICAgICAgICAgICB5ID0geSArIHogKiBrOwogICAgICAgICAgICAgICAgICAgICAgICBrID0gayArIDE7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB5ID0geSArIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB5ID0geSArICh4ICUgKGogKyAxKSk7CiAgICAgICAgICAgICAgICBpZiAoeSA+IDE1MCkgewogICAgICAgICAgICAgICAgICAgIGxldCBtdXQgazogaTMyID0gMDsKICAgICAgICAgICAgICAgICAgICB3aGlsZSAoayA8IDQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgeiA9IHogKyB4ICogazsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHogJSAzID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggPSB4IC0gazsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBrID0gayArIDE7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CgogICAgICAgIGlmIChpICUgMTAgPT0gMCkgewogICAgICAgICAgICBsZXQgdGVtcF92YWw6IGkzMiA9IHggKyB5ICsgejsKICAgICAgICAgICAgaWYgKHRlbXBfdmFsICUgNyA9PSAwKSB7CiAgICAgICAgICAgICAgICBsZXQgbXV0IGltbXV0YWJsZV92YWw6IGkzMiA9IGk7CiAgICAgICAgICAgICAgICBpZiAoaSA+IDUwKSB7CiAgICAgICAgICAgICAgICAgICAgaW1tdXRhYmxlX3ZhbCA9IGkgKyAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgeiA9IHogKyBpbW11dGFibGVfdmFsOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJldHVybiB4ICsgeSArIHo7Cn0KCmZuIGFub3RoZXJfcHV6emxlKCkgewogICAgbGV0IG11dCBzdGF0ZTogaTMyID0gMDsKICAgIGxldCBtdXQgY291bnRlcjogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgNTAwKSB7CiAgICAgICAgY291bnRlciA9IGNvdW50ZXIgKyAxOwogICAgICAgIHN0YXRlID0gKHN0YXRlICsgaSAqIDMpICUgMTc7CiAgICAgICAgaWYgKHN0YXRlIDwgNSkgewogICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChqIDwgc3RhdGUpIHsKICAgICAgICAgICAgICAgIGNvdW50ZXIgPSBjb3VudGVyICsgajsKICAgICAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoc3RhdGUgPCAxMikgewogICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDEwOwogICAgICAgICAgICB3aGlsZSAoaiA+IHN0YXRlKSB7CiAgICAgICAgICAgICAgICBjb3VudGVyID0gY291bnRlciAtIGo7CiAgICAgICAgICAgICAgICBqID0gaiAtIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb3VudGVyID0gY291bnRlciAqIDI7CiAgICAgICAgICAgIGlmIChjb3VudGVyID4gMTAwMDApIHsKICAgICAgICAgICAgICAgIGNvdW50ZXIgPSBjb3VudGVyIC8gMzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICBwcmludGxuSW50KGNvdW50ZXIpOwp9CgpmbiB5ZXRfYW5vdGhlcl9jb250cm9sX2Zsb3coKSB7CiAgICBsZXQgbXV0IGE6IGkzMiA9IDE7CiAgICBsZXQgbXV0IGI6IGkzMiA9IDE7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IDEwKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgMTApIHsKICAgICAgICAgICAgbGV0IG11dCBrOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoayA8IDEwKSB7CiAgICAgICAgICAgICAgICBpZiAoKGkgKyBqICogMiArIGsgKiAzKSAlIDUgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGEgPSBhICsgMTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgYiA9IGIgKyAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGEgPiBiKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHRlbXA6IGkzMiA9IGE7CiAgICAgICAgICAgICAgICAgICAgYSA9IGI7CiAgICAgICAgICAgICAgICAgICAgYiA9IHRlbXA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBrID0gayArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICBwcmludGxuSW50KGEgKiAxMDAwICsgYik7Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (36, "comprehensive36", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEN1c3RvbSBNZW1vcnkgQWxsb2NhdG9yIFNpbXVsYXRpb24KU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6ClNpbXVsYXRpb24gb2YgZHluYW1pYyBtZW1vcnkgbWFuYWdlbWVudCB3aXRoIGEgc3RhdGljIGJ1ZmZlci4KQ29tcGxleCBhcnJheSBtYW5pcHVsYXRpb24gYW5kIGludGVnZXItYmFzZWQgcG9pbnRlciBhcml0aG1ldGljLgpNYW5hZ2VtZW50IG9mIGRhdGEgc3RydWN0dXJlcyByZXByZXNlbnRpbmcgbWVtb3J5IGJsb2NrcyAoZS5nLiwgZnJlZSBsaXN0cykuCkxvb3AtaGVhdnkgc2VhcmNoZXMgZm9yIG1lbW9yeSBhbGxvY2F0aW9uIChlLmcuLCBmaXJzdC1maXQgYWxnb3JpdGhtKS4KT3B0aW1pemF0aW9uIG9mIGZyZXF1ZW50IGZ1bmN0aW9uIGNhbGxzIGZvciBhbGxvYy9mcmVlIG9wZXJhdGlvbnMuCkhhbmRsaW5nIG9mIG1lbW9yeSBmcmFnbWVudGF0aW9uIGFuZCBjb2FsZXNjaW5nIHNjZW5hcmlvcy4KU2NvcGUgYW5kIGxpZmV0aW1lIGNoYWxsZW5nZXMgd2l0aCBtZW1vcnkgc3RhdGUgdmFyaWFibGVzLgoqLwoKLy8gY29tcHJlaGVuc2l2ZTM2LnJ4IC0gQ3VzdG9tIE1lbW9yeSBBbGxvY2F0b3IgU2ltdWxhdGlvbgovLyBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKLy8gLSBTaW11bGF0aW9uIG9mIGR5bmFtaWMgbWVtb3J5IG1hbmFnZW1lbnQgd2l0aCBhIHN0YXRpYyBidWZmZXIuCi8vIC0gQ29tcGxleCBhcnJheSBtYW5pcHVsYXRpb24gYW5kIGludGVnZXItYmFzZWQgcG9pbnRlciBhcml0aG1ldGljLgovLyAtIE1hbmFnZW1lbnQgb2YgZGF0YSBzdHJ1Y3R1cmVzIHJlcHJlc2VudGluZyBtZW1vcnkgYmxvY2tzIChlLmcuLCBmcmVlIGxpc3RzKS4KLy8gLSBMb29wLWhlYXZ5IHNlYXJjaGVzIGZvciBtZW1vcnkgYWxsb2NhdGlvbiAoZS5nLiwgZmlyc3QtZml0IGFsZ29yaXRobSkuCi8vIC0gT3B0aW1pemF0aW9uIG9mIGZyZXF1ZW50IGZ1bmN0aW9uIGNhbGxzIGZvciBhbGxvYy9mcmVlIG9wZXJhdGlvbnMuCi8vIC0gSGFuZGxpbmcgb2YgbWVtb3J5IGZyYWdtZW50YXRpb24gYW5kIGNvYWxlc2Npbmcgc2NlbmFyaW9zLgovLyAtIFNjb3BlIGFuZCBsaWZldGltZSBjaGFsbGVuZ2VzIHdpdGggbWVtb3J5IHN0YXRlIHZhcmlhYmxlcy4KCmNvbnN0IEhFQVBfU0laRTogaTMyID0gMjA0ODsKY29uc3QgQkxPQ0tfSEVBREVSX1NJWkU6IGkzMiA9IDI7CmNvbnN0IEJMT0NLX1NUQVRVU19GUkVFOiBpMzIgPSAwOwpjb25zdCBCTE9DS19TVEFUVVNfVVNFRDogaTMyID0gMTsKCmZuIGluaXRfYWxsb2NhdG9yKGhlYXA6ICZtdXQgW2kzMjsgMjA0OF0sIGlzX2luaXRpYWxpemVkOiAmbXV0IGJvb2wpIHsKICAgIGlmICgqaXNfaW5pdGlhbGl6ZWQpIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBoZWFwWzBdID0gSEVBUF9TSVpFIC0gQkxPQ0tfSEVBREVSX1NJWkU7CiAgICBoZWFwWzFdID0gQkxPQ0tfU1RBVFVTX0ZSRUU7CiAgICBoZWFwWzJdID0gLTE7CiAgICAqaXNfaW5pdGlhbGl6ZWQgPSB0cnVlOwp9CgpmbiBjdXN0b21fYWxsb2MoaGVhcDogJm11dCBbaTMyOyAyMDQ4XSwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IHJlcXVpcmVkX3NpemU6IGkzMiA9IHNpemU7CiAgICBpZiAocmVxdWlyZWRfc2l6ZSA8PSAwKSB7CiAgICAgICAgcmV0dXJuIC0xOwogICAgfQoKICAgIGxldCBtdXQgY3VycmVudF9ibG9ja19wdHI6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGJlc3RfZml0X3B0cjogaTMyID0gLTE7CiAgICBsZXQgbXV0IGJlc3RfZml0X3NpemU6IGkzMiA9IEhFQVBfU0laRSArIDE7CgogICAgd2hpbGUgKGN1cnJlbnRfYmxvY2tfcHRyIDwgSEVBUF9TSVpFKSB7CiAgICAgICAgbGV0IGJsb2NrX3NpemU6IGkzMiA9IGhlYXBbY3VycmVudF9ibG9ja19wdHIgYXMgdXNpemVdOwogICAgICAgIGxldCBibG9ja19zdGF0dXM6IGkzMiA9IGhlYXBbY3VycmVudF9ibG9ja19wdHIgYXMgdXNpemUgKyAxXTsKCiAgICAgICAgaWYgKGJsb2NrX3N0YXR1cyA9PSBCTE9DS19TVEFUVVNfRlJFRSkgewogICAgICAgICAgICBpZiAoYmxvY2tfc2l6ZSA+PSByZXF1aXJlZF9zaXplKSB7CiAgICAgICAgICAgICAgICBpZiAoYmxvY2tfc2l6ZSA8IGJlc3RfZml0X3NpemUpIHsKICAgICAgICAgICAgICAgICAgICBiZXN0X2ZpdF9wdHIgPSBjdXJyZW50X2Jsb2NrX3B0cjsKICAgICAgICAgICAgICAgICAgICBiZXN0X2ZpdF9zaXplID0gYmxvY2tfc2l6ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGJsb2NrX3NpemUgPD0gMCkgewogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY3VycmVudF9ibG9ja19wdHIgPSBjdXJyZW50X2Jsb2NrX3B0ciArIGJsb2NrX3NpemUgKyBCTE9DS19IRUFERVJfU0laRTsKICAgIH0KCiAgICBpZiAoYmVzdF9maXRfcHRyICE9IC0xKSB7CiAgICAgICAgbGV0IG9yaWdpbmFsX3NpemU6IGkzMiA9IGhlYXBbYmVzdF9maXRfcHRyIGFzIHVzaXplXTsKICAgICAgICBsZXQgcmVtYWluaW5nX3NpemU6IGkzMiA9IG9yaWdpbmFsX3NpemUgLSByZXF1aXJlZF9zaXplIC0gQkxPQ0tfSEVBREVSX1NJWkU7CgogICAgICAgIGlmIChyZW1haW5pbmdfc2l6ZSA+IEJMT0NLX0hFQURFUl9TSVpFKSB7CiAgICAgICAgICAgIGhlYXBbYmVzdF9maXRfcHRyIGFzIHVzaXplXSA9IHJlcXVpcmVkX3NpemU7CiAgICAgICAgICAgIGhlYXBbYmVzdF9maXRfcHRyIGFzIHVzaXplICsgMV0gPSBCTE9DS19TVEFUVVNfVVNFRDsKCiAgICAgICAgICAgIGxldCBuZXdfYmxvY2tfcHRyOiBpMzIgPSBiZXN0X2ZpdF9wdHIgKyByZXF1aXJlZF9zaXplICsgQkxPQ0tfSEVBREVSX1NJWkU7CiAgICAgICAgICAgIGhlYXBbbmV3X2Jsb2NrX3B0ciBhcyB1c2l6ZV0gPSByZW1haW5pbmdfc2l6ZTsKICAgICAgICAgICAgaGVhcFtuZXdfYmxvY2tfcHRyIGFzIHVzaXplICsgMV0gPSBCTE9DS19TVEFUVVNfRlJFRTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBoZWFwW2Jlc3RfZml0X3B0ciBhcyB1c2l6ZSArIDFdID0gQkxPQ0tfU1RBVFVTX1VTRUQ7CiAgICAgICAgfQogICAgICAgIHJldHVybiBiZXN0X2ZpdF9wdHIgKyBCTE9DS19IRUFERVJfU0laRTsKICAgIH0KCiAgICByZXR1cm4gLTE7Cn0KCmZuIGN1c3RvbV9mcmVlKGhlYXA6ICZtdXQgW2kzMjsgMjA0OF0sIHB0cjogaTMyKSB7CiAgICBpZiAocHRyIDw9IEJMT0NLX0hFQURFUl9TSVpFKSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgbGV0IGJsb2NrX3B0cjogaTMyID0gcHRyIC0gQkxPQ0tfSEVBREVSX1NJWkU7CiAgICBoZWFwW2Jsb2NrX3B0ciBhcyB1c2l6ZSArIDFdID0gQkxPQ0tfU1RBVFVTX0ZSRUU7CgogICAgbGV0IG11dCBjdXJyZW50X3B0cjogaTMyID0gMDsKICAgIHdoaWxlIChjdXJyZW50X3B0ciA8IEhFQVBfU0laRSkgewogICAgICAgIGxldCBjdXJyZW50X3NpemU6IGkzMiA9IGhlYXBbY3VycmVudF9wdHIgYXMgdXNpemVdOwogICAgICAgIGlmIChjdXJyZW50X3NpemUgPD0gMCkgewogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgbGV0IG5leHRfcHRyOiBpMzIgPSBjdXJyZW50X3B0ciArIGN1cnJlbnRfc2l6ZSArIEJMT0NLX0hFQURFUl9TSVpFOwogICAgICAgIGlmIChuZXh0X3B0ciA8IEhFQVBfU0laRSkgewogICAgICAgICAgICBpZiAoaGVhcFtjdXJyZW50X3B0ciBhcyB1c2l6ZSArIDFdID09IEJMT0NLX1NUQVRVU19GUkVFKSB7CiAgICAgICAgICAgICAgICBpZiAoaGVhcFtuZXh0X3B0ciBhcyB1c2l6ZSArIDFdID09IEJMT0NLX1NUQVRVU19GUkVFKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IG5leHRfc2l6ZTogaTMyID0gaGVhcFtuZXh0X3B0ciBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICAgICAgaGVhcFtjdXJyZW50X3B0ciBhcyB1c2l6ZV0gPSBjdXJyZW50X3NpemUgKyBuZXh0X3NpemUgKyBCTE9DS19IRUFERVJfU0laRTsKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjdXJyZW50X3B0ciA9IG5leHRfcHRyOwogICAgfQp9CgpmbiBtYWluKCkgewogICAgbGV0IG11dCBoZWFwOiBbaTMyOyAyMDQ4XSA9IFswOyAyMDQ4XTsKICAgIGxldCBtdXQgaXNfaW5pdGlhbGl6ZWQ6IGJvb2wgPSBmYWxzZTsKICAgIGluaXRfYWxsb2NhdG9yKCZtdXQgaGVhcCwgJm11dCBpc19pbml0aWFsaXplZCk7CiAgICBsZXQgbXV0IHRvdGFsX2FsbG9jYXRpb25zOiBpMzIgPSAwOwogICAgbGV0IG11dCBmYWlsZWRfYWxsb2NhdGlvbnM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGFsbG9jYXRpb25zOiBbaTMyOyAxMDBdID0gWzA7IDEwMF07CiAgICBsZXQgbXV0IGFsbG9jYXRpb25fY291bnQ6IGkzMiA9IDA7CgogICAgd2hpbGUgKGkgPCAyMDApIHsKICAgICAgICBsZXQgc2l6ZV9zZWxlY3RvcjogaTMyID0gaSAlIDEwOwogICAgICAgIGxldCBtdXQgYWxsb2Nfc2l6ZTogaTMyID0gMDsKICAgICAgICBpZiAoc2l6ZV9zZWxlY3RvciA9PSAwKSB7CiAgICAgICAgICAgIGFsbG9jX3NpemUgPSAxMDsKICAgICAgICB9IGVsc2UgaWYgKHNpemVfc2VsZWN0b3IgPT0gMSkgewogICAgICAgICAgICBhbGxvY19zaXplID0gNTA7CiAgICAgICAgfSBlbHNlIGlmIChzaXplX3NlbGVjdG9yID09IDIpIHsKICAgICAgICAgICAgYWxsb2Nfc2l6ZSA9IDI1OwogICAgICAgIH0gZWxzZSBpZiAoc2l6ZV9zZWxlY3RvciA9PSAzKSB7CiAgICAgICAgICAgIGFsbG9jX3NpemUgPSAxMjA7CiAgICAgICAgfSBlbHNlIGlmIChzaXplX3NlbGVjdG9yID09IDQpIHsKICAgICAgICAgICAgYWxsb2Nfc2l6ZSA9IDU7CiAgICAgICAgfSBlbHNlIGlmIChzaXplX3NlbGVjdG9yID09IDUpIHsKICAgICAgICAgICAgYWxsb2Nfc2l6ZSA9IDgwOwogICAgICAgIH0gZWxzZSBpZiAoc2l6ZV9zZWxlY3RvciA9PSA2KSB7CiAgICAgICAgICAgIGFsbG9jX3NpemUgPSAyMDA7CiAgICAgICAgfSBlbHNlIGlmIChzaXplX3NlbGVjdG9yID09IDcpIHsKICAgICAgICAgICAgYWxsb2Nfc2l6ZSA9IDE1OwogICAgICAgIH0gZWxzZSBpZiAoc2l6ZV9zZWxlY3RvciA9PSA4KSB7CiAgICAgICAgICAgIGFsbG9jX3NpemUgPSAzMDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbGxvY19zaXplID0gNjA7CiAgICAgICAgfQoKICAgICAgICBsZXQgcHRyOiBpMzIgPSBjdXN0b21fYWxsb2MoJm11dCBoZWFwLCBhbGxvY19zaXplKTsKICAgICAgICBpZiAocHRyICE9IC0xKSB7CiAgICAgICAgICAgIGlmIChhbGxvY2F0aW9uX2NvdW50IDwgMTAwKSB7CiAgICAgICAgICAgICAgICBhbGxvY2F0aW9uc1thbGxvY2F0aW9uX2NvdW50IGFzIHVzaXplXSA9IHB0cjsKICAgICAgICAgICAgICAgIGFsbG9jYXRpb25fY291bnQgPSBhbGxvY2F0aW9uX2NvdW50ICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0b3RhbF9hbGxvY2F0aW9ucyA9IHRvdGFsX2FsbG9jYXRpb25zICsgMTsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IGFsbG9jX3NpemUpIHsKICAgICAgICAgICAgICAgIGhlYXBbKHB0ciArIGopIGFzIHVzaXplXSA9IChwdHIgKyBqKSAlIDEyODsKICAgICAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZhaWxlZF9hbGxvY2F0aW9ucyA9IGZhaWxlZF9hbGxvY2F0aW9ucyArIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoaSAlIDUgPT0gNCkgewogICAgICAgICAgICBsZXQgbXV0IGZyZWVfaWR4OiBpMzIgPSAwOwogICAgICAgICAgICBpZiAoYWxsb2NhdGlvbl9jb3VudCA+IDApIHsKICAgICAgICAgICAgICAgIGZyZWVfaWR4ID0gKGkgKiAxNykgJSBhbGxvY2F0aW9uX2NvdW50OwogICAgICAgICAgICAgICAgbGV0IGZyZWVfcHRyOiBpMzIgPSBhbGxvY2F0aW9uc1tmcmVlX2lkeCBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBpZiAoZnJlZV9wdHIgIT0gMCkgewogICAgICAgICAgICAgICAgICAgIGN1c3RvbV9mcmVlKCZtdXQgaGVhcCwgZnJlZV9wdHIpOwogICAgICAgICAgICAgICAgICAgIGFsbG9jYXRpb25zW2ZyZWVfaWR4IGFzIHVzaXplXSA9IDA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGxldCBtdXQgZmluYWxfc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBrOiBpMzIgPSAwOwogICAgd2hpbGUgKGsgPCBhbGxvY2F0aW9uX2NvdW50KSB7CiAgICAgICAgbGV0IHB0cjogaTMyID0gYWxsb2NhdGlvbnNbayBhcyB1c2l6ZV07CiAgICAgICAgaWYgKHB0ciAhPSAwKSB7CiAgICAgICAgICAgIGxldCBibG9ja19wdHI6IGkzMiA9IHB0ciAtIEJMT0NLX0hFQURFUl9TSVpFOwogICAgICAgICAgICBsZXQgc2l6ZTogaTMyID0gaGVhcFtibG9ja19wdHIgYXMgdXNpemVdOwogICAgICAgICAgICBsZXQgbXV0IGw6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChsIDwgc2l6ZSkgewogICAgICAgICAgICAgICAgZmluYWxfc3VtID0gZmluYWxfc3VtICsgaGVhcFsocHRyICsgbCkgYXMgdXNpemVdOwogICAgICAgICAgICAgICAgbCA9IGwgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGsgPSBrICsgMTsKICAgIH0KCiAgICBsZXQgbXV0IHRvdGFsX2ZyZWVfc3BhY2U6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGN1cnJlbnRfYmxvY2tfcHRyOiBpMzIgPSAwOwogICAgd2hpbGUgKGN1cnJlbnRfYmxvY2tfcHRyIDwgSEVBUF9TSVpFKSB7CiAgICAgICAgbGV0IGJsb2NrX3NpemU6IGkzMiA9IGhlYXBbY3VycmVudF9ibG9ja19wdHIgYXMgdXNpemVdOwogICAgICAgIGxldCBibG9ja19zdGF0dXM6IGkzMiA9IGhlYXBbY3VycmVudF9ibG9ja19wdHIgYXMgdXNpemUgKyAxXTsKICAgICAgICBpZiAoYmxvY2tfc3RhdHVzID09IEJMT0NLX1NUQVRVU19GUkVFKSB7CiAgICAgICAgICAgIHRvdGFsX2ZyZWVfc3BhY2UgPSB0b3RhbF9mcmVlX3NwYWNlICsgYmxvY2tfc2l6ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGJsb2NrX3NpemUgPD0gMCkgewogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY3VycmVudF9ibG9ja19wdHIgPSBjdXJyZW50X2Jsb2NrX3B0ciArIGJsb2NrX3NpemUgKyBCTE9DS19IRUFERVJfU0laRTsKICAgIH0KCiAgICBpZiAodHJ1ZSkgewogICAgICAgIGxldCBtdXQgZGVidWdfaW5mbzogaTMyID0gMTsKICAgICAgICB3aGlsZSAoZGVidWdfaW5mbyA8IDUpIHsKICAgICAgICAgICAgbGV0IG11dCBpbm5lcl9jb3VudGVyOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaW5uZXJfY291bnRlciA8IGRlYnVnX2luZm8pIHsKICAgICAgICAgICAgICAgIGlubmVyX2NvdW50ZXIgPSBpbm5lcl9jb3VudGVyICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBkZWJ1Z19pbmZvID0gZGVidWdfaW5mbyArIDE7CiAgICAgICAgfQogICAgfQoKICAgIHByaW50bG5JbnQodG90YWxfYWxsb2NhdGlvbnMpOwogICAgcHJpbnRsbkludChmYWlsZWRfYWxsb2NhdGlvbnMpOwogICAgcHJpbnRsbkludChmaW5hbF9zdW0pOwogICAgcHJpbnRsbkludCh0b3RhbF9mcmVlX3NwYWNlKTsKCiAgICBsZXQgbXV0IG06IGkzMiA9IDA7CiAgICB3aGlsZSAobSA8IDEwMCkgewogICAgICAgIGlmIChhbGxvY2F0aW9uc1ttIGFzIHVzaXplXSAhPSAwKSB7CiAgICAgICAgICAgIGN1c3RvbV9mcmVlKCZtdXQgaGVhcCwgYWxsb2NhdGlvbnNbbSBhcyB1c2l6ZV0pOwogICAgICAgIH0KICAgICAgICBtID0gbSArIDE7CiAgICB9CgogICAgbGV0IGZpbmFsX3B0cjogaTMyID0gY3VzdG9tX2FsbG9jKCZtdXQgaGVhcCwgMTAyNCk7CiAgICBpZiAoZmluYWxfcHRyICE9IC0xKSB7CiAgICAgICAgcHJpbnRsbkludCgxKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnRsbkludCgwKTsKICAgIH0KCiAgICBsZXQgYW5vdGhlcl9wdHI6IGkzMiA9IGN1c3RvbV9hbGxvYygmbXV0IGhlYXAsIDEwMjQpOwogICAgaWYgKGFub3RoZXJfcHRyICE9IC0xKSB7CiAgICAgICAgcHJpbnRsbkludCgxKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnRsbkludCgwKTsKICAgIH0KCiAgICBjdXN0b21fZnJlZSgmbXV0IGhlYXAsIGZpbmFsX3B0cik7CiAgICBsZXQgbGFzdF9wdHI6IGkzMiA9IGN1c3RvbV9hbGxvYygmbXV0IGhlYXAsIDIwMDApOwogICAgaWYgKGxhc3RfcHRyICE9IC0xKSB7CiAgICAgICAgcHJpbnRsbkludCgxKTsKICAgIH0gZWxzZSB7CiAgICAgICAgcHJpbnRsbkludCgwKTsKICAgIH0KCiAgICBsZXQgbXV0IGZpbmFsX2NoZWNrX3N1bTogaTMyID0gMDsKICAgIGxldCBtdXQgcDogaTMyID0gMDsKICAgIHdoaWxlIChwIDwgSEVBUF9TSVpFKSB7CiAgICAgICAgZmluYWxfY2hlY2tfc3VtID0gZmluYWxfY2hlY2tfc3VtICsgaGVhcFtwIGFzIHVzaXplXTsKICAgICAgICBwID0gcCArIDE7CiAgICB9CiAgICBwcmludGxuSW50KGZpbmFsX2NoZWNrX3N1bSAlIDEwMDApOwoKICAgIGlmIChmYWxzZSkgewogICAgICAgIGxldCBtdXQgZGVhZF9jb2RlX3ZhbDogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IHE6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKHEgPCAxMDAwKSB7CiAgICAgICAgICAgIGRlYWRfY29kZV92YWwgPSBkZWFkX2NvZGVfdmFsICsgcTsKICAgICAgICAgICAgcSA9IHEgKyAxOwogICAgICAgIH0KICAgICAgICBwcmludGxuSW50KGRlYWRfY29kZV92YWwpOwogICAgfQoKICAgIGxldCBtdXQgcjogaTMyID0gMDsKICAgIGxldCBtdXQgY29tcGxleF9jYWxjOiBpMzIgPSAwOwogICAgd2hpbGUgKHIgPCA1MCkgewogICAgICAgIGxldCBtdXQgczogaTMyID0gMDsKICAgICAgICB3aGlsZSAocyA8IDUwKSB7CiAgICAgICAgICAgIGlmICgociAqIHMpICUgMyA9PSAwKSB7CiAgICAgICAgICAgICAgICBjb21wbGV4X2NhbGMgPSBjb21wbGV4X2NhbGMgKyByIC0gczsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbXBsZXhfY2FsYyA9IGNvbXBsZXhfY2FsYyArIHMgLSByOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHMgPSBzICsgMTsKICAgICAgICB9CiAgICAgICAgciA9IHIgKyAxOwogICAgfQogICAgcHJpbnRsbkludChjb21wbGV4X2NhbGMpOwoKICAgIGxldCBtdXQgYTogaTMyID0gMTA7CiAgICBsZXQgYjogaTMyID0gMjA7CiAgICBpZiAoYSA8IGIpIHsKICAgICAgICBsZXQgYzogaTMyID0gMzA7CiAgICAgICAgYSA9IGEgKyBjOwogICAgfSBlbHNlIHsKICAgICAgICBsZXQgZDogaTMyID0gNDA7CiAgICAgICAgYSA9IGEgKyBkOwogICAgfQoKICAgIGlmICh0cnVlKSB7CiAgICAgICAgbGV0IGE6IGJvb2wgPSBmYWxzZTsKICAgICAgICBpZiAoYSkgewogICAgICAgICAgICBwcmludGxuSW50KDEwMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHJpbnRsbkludCgyMDApOwogICAgICAgIH0KICAgIH0KICAgIHByaW50bG5JbnQoYSk7CgogICAgbGV0IG11dCBvdXRlcl92YXI6IGkzMiA9IDE7CiAgICB3aGlsZSAob3V0ZXJfdmFyIDwgMykgewogICAgICAgIGxldCBtdXQgaW5uZXJfdmFyOiBpMzIgPSAxMDsKICAgICAgICBpZiAob3V0ZXJfdmFyID09IDEpIHsKICAgICAgICAgICAgbGV0IG11dCB0ZW1wX3ZhcjogaTMyID0gMTAwOwogICAgICAgICAgICBpbm5lcl92YXIgPSBpbm5lcl92YXIgKyB0ZW1wX3ZhcjsKICAgICAgICB9CiAgICAgICAgcHJpbnRsbkludChpbm5lcl92YXIpOwogICAgICAgIG91dGVyX3ZhciA9IG91dGVyX3ZhciArIDE7CiAgICB9CgogICAgbGV0IG11dCB4OiBpMzIgPSA1OwogICAgbGV0IHk6IGkzMiA9IHg7CiAgICB4ID0gMTA7CiAgICBwcmludGxuSW50KHkpOwoKICAgIGxldCBtdXQgejogaTMyID0gMDsKICAgIHdoaWxlICh6IDwgMSkgewogICAgICAgIGxldCBtdXQgbG9vcF9zY29wZWQ6IGkzMiA9IDEyMzsKICAgICAgICBpZiAodHJ1ZSkgewogICAgICAgICAgICBsb29wX3Njb3BlZCA9IDQ1NjsKICAgICAgICB9CiAgICAgICAgcHJpbnRsbkludChsb29wX3Njb3BlZCk7CiAgICAgICAgeiA9IHogKyAxOwogICAgfQoKICAgIGlmICh0cnVlKSB7CiAgICAgICAgbGV0IG11dCBzaGFkb3dfdmFyOiBpMzIgPSAxMTE7CiAgICAgICAgcHJpbnRsbkludChzaGFkb3dfdmFyKTsKICAgIH0KICAgIGxldCBtdXQgc2hhZG93X3ZhcjogaTMyID0gMjIyOwogICAgcHJpbnRsbkludChzaGFkb3dfdmFyKTsKCiAgICBsZXQgbXV0IGNoZWNrOiBpMzIgPSAwOwogICAgaWYgKGNoZWNrID09IDApIHsKICAgICAgICBsZXQgbXV0IHZhbDogaTMyID0gMTA7CiAgICAgICAgdmFsID0gdmFsICsgMTsKICAgIH0KCiAgICBsZXQgbXV0IGZpbmFsX3ZhbDogaTMyID0gMDsKICAgIGlmICh0cnVlKSB7CiAgICAgICAgbGV0IG11dCB0ZW1wX2ZpbmFsOiBpMzIgPSAxMDAwOwogICAgICAgIGZpbmFsX3ZhbCA9IHRlbXBfZmluYWw7CiAgICB9CgogICAgbGV0IG11dCBhbm90aGVyX2NoZWNrOiBpMzIgPSAwOwogICAgaWYgKGFub3RoZXJfY2hlY2sgPT0gMCkgewogICAgICAgIGxldCBtdXQgdmFsMjogaTMyID0gMjA7CiAgICAgICAgdmFsMiA9IHZhbDIgKyAxOwogICAgfSBlbHNlIHsKICAgICAgICBsZXQgbXV0IHZhbDI6IGkzMiA9IDMwOwogICAgICAgIHZhbDIgPSB2YWwyICsgMTsKICAgIH0KCiAgICBsZXQgbXV0IG11dF9vdXRlcjogaTMyID0gNTA7CiAgICBpZiAodHJ1ZSkgewogICAgICAgIGxldCBtdXRfb3V0ZXI6IGkzMiA9IDYwOwogICAgICAgIGlmICh0cnVlKSB7CiAgICAgICAgICAgIGxldCBtdXRfb3V0ZXI6IGkzMiA9IDcwOwogICAgICAgICAgICBwcmludGxuSW50KG11dF9vdXRlcik7CiAgICAgICAgfQogICAgICAgIHByaW50bG5JbnQobXV0X291dGVyKTsKICAgIH0KICAgIHByaW50bG5JbnQobXV0X291dGVyKTsKCiAgICBsZXQgbXV0IGVycm9yX3ZhcjogaTMyID0gMDsKICAgIGxldCBtdXQgaW5uZXJfZXJyb3JfdmFyOiBpMzIgPSAxOwogICAgZXJyb3JfdmFyID0gaW5uZXJfZXJyb3JfdmFyOwogICAgaW5uZXJfZXJyb3JfdmFyID0gMjsKICAgIGV4aXQoMCk7Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (37, "comprehensive37", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IFNpbXBsZSBWaXJ0dWFsIE1hY2hpbmUgSW50ZXJwcmV0ZXIKU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6CkxhcmdlIHN3aXRjaC1saWtlIGNvbnRyb2wgZmxvdyAoaWYtZWxzZS1pZiAoY2hhaW5zKSBmb3Igb3Bjb2RlIGRpc3BhdGNoLikKQXJyYXktYmFzZWQgc3RhY2sgYW5kIGluc3RydWN0aW9uIG1lbW9yeSBtYW5pcHVsYXRpb24uCkxvb3Agb3B0aW1pemF0aW9uIGZvciB0aGUgbWFpbiBmZXRjaC1kZWNvZGUtZXhlY3V0ZSBjeWNsZS4KSW50ZWdlciBhcml0aG1ldGljIGFuZCBsb2dpY2FsIG9wZXJhdGlvbnMgd2l0aGluIGEgc2ltdWxhdGVkIGVudmlyb25tZW50LgpGdW5jdGlvbiBjYWxsIG92ZXJoZWFkIGZvciBtb2R1bGFyaXplZCBWTSBjb21wb25lbnRzLgpCcmFuY2ggcHJlZGljdGlvbiBpbiB0aGUgY29udGV4dCBvZiBhIFZNJ3MgY29uZGl0aW9uYWwganVtcHMuCk11dGFiaWxpdHkgdHJhY2tpbmcgYW5kIHBvdGVudGlhbCBjb25mbGljdHMgaW4gVk0gc3RhdGUgbWFuYWdlbWVudC4KKi8KCi8vIGNvbXByZWhlbnNpdmUzNy5yeCAtIFNpbXBsZSBWaXJ0dWFsIE1hY2hpbmUgSW50ZXJwcmV0ZXIKLy8gVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6Ci8vIC0gTGFyZ2Ugc3dpdGNoLWxpa2UgY29udHJvbCBmbG93IChpZi1lbHNlLWlmIGNoYWlucykgZm9yIG9wY29kZSBkaXNwYXRjaC4KLy8gLSBBcnJheS1iYXNlZCBzdGFjayBhbmQgaW5zdHJ1Y3Rpb24gbWVtb3J5IG1hbmlwdWxhdGlvbi4KLy8gLSBMb29wIG9wdGltaXphdGlvbiBmb3IgdGhlIG1haW4gZmV0Y2gtZGVjb2RlLWV4ZWN1dGUgY3ljbGUuCi8vIC0gSW50ZWdlciBhcml0aG1ldGljIGFuZCBsb2dpY2FsIG9wZXJhdGlvbnMgd2l0aGluIGEgc2ltdWxhdGVkIGVudmlyb25tZW50LgovLyAtIEZ1bmN0aW9uIGNhbGwgb3ZlcmhlYWQgZm9yIG1vZHVsYXJpemVkIFZNIGNvbXBvbmVudHMuCi8vIC0gQnJhbmNoIHByZWRpY3Rpb24gaW4gdGhlIGNvbnRleHQgb2YgYSBWTSdzIGNvbmRpdGlvbmFsIGp1bXBzLgovLyAtIE11dGFiaWxpdHkgdHJhY2tpbmcgYW5kIHBvdGVudGlhbCBjb25mbGljdHMgaW4gVk0gc3RhdGUgbWFuYWdlbWVudC4KCmNvbnN0IE1FTU9SWV9TSVpFOiBpMzIgPSAxMDI0Owpjb25zdCBTVEFDS19TSVpFOiBpMzIgPSAyNTY7Cgpjb25zdCBIQUxUOiBpMzIgPSAwOwpjb25zdCBQVVNIOiBpMzIgPSAxOwpjb25zdCBQT1A6IGkzMiA9IDI7CmNvbnN0IEFERDogaTMyID0gMzsKY29uc3QgU1VCOiBpMzIgPSA0Owpjb25zdCBNVUw6IGkzMiA9IDU7CmNvbnN0IERJVjogaTMyID0gNjsKY29uc3QgUFJJTlQ6IGkzMiA9IDc7CmNvbnN0IEpNUDogaTMyID0gODsKY29uc3QgSlo6IGkzMiA9IDk7CmNvbnN0IEpOWjogaTMyID0gMTA7CmNvbnN0IEVROiBpMzIgPSAxMTsKY29uc3QgTFQ6IGkzMiA9IDEyOwpjb25zdCBTVE9SRTogaTMyID0gMTM7CmNvbnN0IExPQUQ6IGkzMiA9IDE0Owpjb25zdCBEVVA6IGkzMiA9IDE1OwoKZm4gcHVzaF9zdGFjayhzdGFjazogJm11dCBbaTMyOyAyNTZdLCBzcDogJm11dCBpMzIsIHZhbDogaTMyKSB7CiAgICBpZiAoKnNwIDwgU1RBQ0tfU0laRSAtIDEpIHsKICAgICAgICAqc3AgPSAqc3AgKyAxOwogICAgICAgIHN0YWNrWypzcCBhcyB1c2l6ZV0gPSB2YWw7CiAgICB9Cn0KCmZuIHBvcF9zdGFjayhzdGFjazogJltpMzI7IDI1Nl0sIHNwOiAmbXV0IGkzMikgLT4gaTMyIHsKICAgIGlmICgqc3AgPiAtMSkgewogICAgICAgIGxldCB2YWw6IGkzMiA9IHN0YWNrWypzcCBhcyB1c2l6ZV07CiAgICAgICAgKnNwID0gKnNwIC0gMTsKICAgICAgICByZXR1cm4gdmFsOwogICAgfQogICAgcmV0dXJuIDA7Cn0KCmZuIGxvYWRfcHJvZ3JhbShtZW1vcnk6ICZtdXQgW2kzMjsgMTAyNF0pIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKCiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSBQVVNIOyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSAxMDsgaSA9IGkgKyAxOwogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gU1RPUkU7IGkgPSBpICsgMTsKICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IDI1NjsgaSA9IGkgKyAxOwoKICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IFBVU0g7IGkgPSBpICsgMTsKICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IDE7IGkgPSBpICsgMTsKICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IFNUT1JFOyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSAyNTc7IGkgPSBpICsgMTsKCiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSBQVVNIOyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSAxOyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSBTVE9SRTsgaSA9IGkgKyAxOwogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gMjU4OyBpID0gaSArIDE7CgogICAgbGV0IGxvb3Bfc3RhcnQ6IGkzMiA9IGk7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSBMT0FEOyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSAyNTY7IGkgPSBpICsgMTsKICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IFBVU0g7IGkgPSBpICsgMTsKICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IDE7IGkgPSBpICsgMTsKICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IFNVQjsgaSA9IGkgKyAxOwogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gRFVQOyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSBTVE9SRTsgaSA9IGkgKyAxOwogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gMjU2OyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSBKWjsgaSA9IGkgKyAxOwogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gNTA7IGkgPSBpICsgMTsKCiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSBMT0FEOyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSAyNTc7IGkgPSBpICsgMTsKICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IExPQUQ7IGkgPSBpICsgMTsKICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IDI1ODsgaSA9IGkgKyAxOwogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gQUREOyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSBEVVA7IGkgPSBpICsgMTsKICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IFNUT1JFOyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSAyNTc7IGkgPSBpICsgMTsKICAgIG1lbW9yeVtpIGFzIHVzaXplXSA9IFBPUDsgaSA9IGkgKyAxOwogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gTE9BRDsgaSA9IGkgKyAxOwogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gMjU3OyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSBTVE9SRTsgaSA9IGkgKyAxOwogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gMjU4OyBpID0gaSArIDE7CgogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gSk1QOyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSBsb29wX3N0YXJ0OyBpID0gaSArIDE7CgogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gTE9BRDsgaSA9IGkgKyAxOwogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gMjU4OyBpID0gaSArIDE7CiAgICBtZW1vcnlbaSBhcyB1c2l6ZV0gPSBQUklOVDsgaSA9IGkgKyAxOwogICAgbWVtb3J5W2kgYXMgdXNpemVdID0gSEFMVDsgaSA9IGkgKyAxOwoKICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgIHdoaWxlIChqIDwgMjApIHsKICAgICAgICBsZXQgazogaTMyID0gMTAwICsgaiAqIDEwOwogICAgICAgIG1lbW9yeVtrIGFzIHVzaXplXSA9IFBVU0g7CiAgICAgICAgbWVtb3J5W2sgYXMgdXNpemUrMV0gPSBqOwogICAgICAgIG1lbW9yeVtrIGFzIHVzaXplKzJdID0gUFVTSDsKICAgICAgICBtZW1vcnlbayBhcyB1c2l6ZSszXSA9IGogKyAxOwogICAgICAgIG1lbW9yeVtrIGFzIHVzaXplKzRdID0gTVVMOwogICAgICAgIG1lbW9yeVtrIGFzIHVzaXplKzVdID0gUFJJTlQ7CiAgICAgICAgbWVtb3J5W2sgYXMgdXNpemUrNl0gPSBQT1A7CiAgICAgICAgaiA9IGogKyAxOwogICAgfQogICAgbWVtb3J5Wzk5XSA9IEpNUDsKICAgIG1lbW9yeVsxMDBdID0gMTAwOwoKICAgIGxldCBtdXQgZmFjdG9yaWFsX2FkZHI6IGkzMiA9IDQwMDsKICAgIG1lbW9yeVtmYWN0b3JpYWxfYWRkciBhcyB1c2l6ZV0gPSBTVE9SRTsgZmFjdG9yaWFsX2FkZHIgPSBmYWN0b3JpYWxfYWRkciArIDE7CiAgICBtZW1vcnlbZmFjdG9yaWFsX2FkZHIgYXMgdXNpemVdID0gNTAwOyBmYWN0b3JpYWxfYWRkciA9IGZhY3RvcmlhbF9hZGRyICsgMTsKICAgIG1lbW9yeVtmYWN0b3JpYWxfYWRkciBhcyB1c2l6ZV0gPSBMT0FEOyBmYWN0b3JpYWxfYWRkciA9IGZhY3RvcmlhbF9hZGRyICsgMTsKICAgIG1lbW9yeVtmYWN0b3JpYWxfYWRkciBhcyB1c2l6ZV0gPSA1MDA7IGZhY3RvcmlhbF9hZGRyID0gZmFjdG9yaWFsX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZhY3RvcmlhbF9hZGRyIGFzIHVzaXplXSA9IFBVU0g7IGZhY3RvcmlhbF9hZGRyID0gZmFjdG9yaWFsX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZhY3RvcmlhbF9hZGRyIGFzIHVzaXplXSA9IDE7IGZhY3RvcmlhbF9hZGRyID0gZmFjdG9yaWFsX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZhY3RvcmlhbF9hZGRyIGFzIHVzaXplXSA9IExUOyBmYWN0b3JpYWxfYWRkciA9IGZhY3RvcmlhbF9hZGRyICsgMTsKICAgIG1lbW9yeVtmYWN0b3JpYWxfYWRkciBhcyB1c2l6ZV0gPSBKWjsgZmFjdG9yaWFsX2FkZHIgPSBmYWN0b3JpYWxfYWRkciArIDE7CiAgICBtZW1vcnlbZmFjdG9yaWFsX2FkZHIgYXMgdXNpemVdID0gZmFjdG9yaWFsX2FkZHIgKyAxMjsgZmFjdG9yaWFsX2FkZHIgPSBmYWN0b3JpYWxfYWRkciArIDE7CiAgICBtZW1vcnlbZmFjdG9yaWFsX2FkZHIgYXMgdXNpemVdID0gUFVTSDsgZmFjdG9yaWFsX2FkZHIgPSBmYWN0b3JpYWxfYWRkciArIDE7CiAgICBtZW1vcnlbZmFjdG9yaWFsX2FkZHIgYXMgdXNpemVdID0gMTsgZmFjdG9yaWFsX2FkZHIgPSBmYWN0b3JpYWxfYWRkciArIDE7CiAgICBtZW1vcnlbZmFjdG9yaWFsX2FkZHIgYXMgdXNpemVdID0gSk1QOyBmYWN0b3JpYWxfYWRkciA9IGZhY3RvcmlhbF9hZGRyICsgMTsKICAgIG1lbW9yeVtmYWN0b3JpYWxfYWRkciBhcyB1c2l6ZV0gPSA1MDA7CgogICAgbWVtb3J5W2ZhY3RvcmlhbF9hZGRyIGFzIHVzaXplXSA9IExPQUQ7IGZhY3RvcmlhbF9hZGRyID0gZmFjdG9yaWFsX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZhY3RvcmlhbF9hZGRyIGFzIHVzaXplXSA9IDUwMDsgZmFjdG9yaWFsX2FkZHIgPSBmYWN0b3JpYWxfYWRkciArIDE7CiAgICBtZW1vcnlbZmFjdG9yaWFsX2FkZHIgYXMgdXNpemVdID0gUFVTSDsgZmFjdG9yaWFsX2FkZHIgPSBmYWN0b3JpYWxfYWRkciArIDE7CiAgICBtZW1vcnlbZmFjdG9yaWFsX2FkZHIgYXMgdXNpemVdID0gMTsgZmFjdG9yaWFsX2FkZHIgPSBmYWN0b3JpYWxfYWRkciArIDE7CiAgICBtZW1vcnlbZmFjdG9yaWFsX2FkZHIgYXMgdXNpemVdID0gU1VCOyBmYWN0b3JpYWxfYWRkciA9IGZhY3RvcmlhbF9hZGRyICsgMTsKICAgIG1lbW9yeVtmYWN0b3JpYWxfYWRkciBhcyB1c2l6ZV0gPSBKTVA7CiAgICBtZW1vcnlbZmFjdG9yaWFsX2FkZHIgYXMgdXNpemVdID0gNDAwOwoKICAgIGxldCBtdXQgZmliX2FkZHI6IGkzMiA9IDYwMDsKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSBTVE9SRTsgZmliX2FkZHIgPSBmaWJfYWRkciArIDE7CiAgICBtZW1vcnlbZmliX2FkZHIgYXMgdXNpemVdID0gNzAwOyBmaWJfYWRkciA9IGZpYl9hZGRyICsgMTsKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSBMT0FEOyBmaWJfYWRkciA9IGZpYl9hZGRyICsgMTsKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSA3MDA7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZpYl9hZGRyIGFzIHVzaXplXSA9IFBVU0g7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZpYl9hZGRyIGFzIHVzaXplXSA9IDI7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZpYl9hZGRyIGFzIHVzaXplXSA9IExUOyBmaWJfYWRkciA9IGZpYl9hZGRyICsgMTsKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSBKWjsgZmliX2FkZHIgPSBmaWJfYWRkciArIDE7CiAgICBtZW1vcnlbZmliX2FkZHIgYXMgdXNpemVdID0gZmliX2FkZHIgKyA0OyBmaWJfYWRkciA9IGZpYl9hZGRyICsgMTsKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSBMT0FEOyBmaWJfYWRkciA9IGZpYl9hZGRyICsgMTsKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSA3MDA7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZpYl9hZGRyIGFzIHVzaXplXSA9IEpNUDsgZmliX2FkZHIgPSBmaWJfYWRkciArIDE7CiAgICBtZW1vcnlbZmliX2FkZHIgYXMgdXNpemVdID0gODAwOwoKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSBMT0FEOyBmaWJfYWRkciA9IGZpYl9hZGRyICsgMTsKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSA3MDA7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZpYl9hZGRyIGFzIHVzaXplXSA9IFBVU0g7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZpYl9hZGRyIGFzIHVzaXplXSA9IDE7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZpYl9hZGRyIGFzIHVzaXplXSA9IFNVQjsgZmliX2FkZHIgPSBmaWJfYWRkciArIDE7CiAgICBtZW1vcnlbZmliX2FkZHIgYXMgdXNpemVdID0gSk1QOyBmaWJfYWRkciA9IGZpYl9hZGRyICsgMTsKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSA2MDA7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwoKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSBMT0FEOyBmaWJfYWRkciA9IGZpYl9hZGRyICsgMTsKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSA3MDA7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZpYl9hZGRyIGFzIHVzaXplXSA9IFBVU0g7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZpYl9hZGRyIGFzIHVzaXplXSA9IDI7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZpYl9hZGRyIGFzIHVzaXplXSA9IFNVQjsgZmliX2FkZHIgPSBmaWJfYWRkciArIDE7CiAgICBtZW1vcnlbZmliX2FkZHIgYXMgdXNpemVdID0gSk1QOyBmaWJfYWRkciA9IGZpYl9hZGRyICsgMTsKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSA2MDA7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwoKICAgIG1lbW9yeVtmaWJfYWRkciBhcyB1c2l6ZV0gPSBBREQ7IGZpYl9hZGRyID0gZmliX2FkZHIgKyAxOwogICAgbWVtb3J5W2ZpYl9hZGRyIGFzIHVzaXplXSA9IEpNUDsgZmliX2FkZHIgPSBmaWJfYWRkciArIDE7CiAgICBtZW1vcnlbZmliX2FkZHIgYXMgdXNpemVdID0gODAwOwp9CgpmbiBleGVjdXRlX2N5Y2xlKG1lbW9yeTogJm11dCBbaTMyOyAxMDI0XSwgcGM6ICZtdXQgaTMyLCBzdGFjazogJm11dCBbaTMyOyAyNTZdLCBzcDogJm11dCBpMzIsIHJ1bm5pbmc6ICZtdXQgYm9vbCkgewogICAgbGV0IGluc3RydWN0aW9uOiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplXTsKICAgICpwYyA9ICpwYyArIDE7CgogICAgaWYgKGluc3RydWN0aW9uID09IEhBTFQpIHsKICAgICAgICAqcnVubmluZyA9IGZhbHNlOwogICAgfSBlbHNlIGlmIChpbnN0cnVjdGlvbiA9PSBQVVNIKSB7CiAgICAgICAgbGV0IHZhbHVlOiBpMzIgPSBtZW1vcnlbKnBjIGFzIHVzaXplXTsKICAgICAgICAqcGMgPSAqcGMgKyAxOwogICAgICAgIHB1c2hfc3RhY2soc3RhY2ssIHNwLCB2YWx1ZSk7CiAgICB9IGVsc2UgaWYgKGluc3RydWN0aW9uID09IFBPUCkgewogICAgICAgIHBvcF9zdGFjayhzdGFjaywgc3ApOwogICAgfSBlbHNlIGlmIChpbnN0cnVjdGlvbiA9PSBBREQpIHsKICAgICAgICBsZXQgYjogaTMyID0gcG9wX3N0YWNrKHN0YWNrLCBzcCk7CiAgICAgICAgbGV0IGE6IGkzMiA9IHBvcF9zdGFjayhzdGFjaywgc3ApOwogICAgICAgIHB1c2hfc3RhY2soc3RhY2ssIHNwLCBhICsgYik7CiAgICB9IGVsc2UgaWYgKGluc3RydWN0aW9uID09IFNVQikgewogICAgICAgIGxldCBiOiBpMzIgPSBwb3Bfc3RhY2soc3RhY2ssIHNwKTsKICAgICAgICBsZXQgYTogaTMyID0gcG9wX3N0YWNrKHN0YWNrLCBzcCk7CiAgICAgICAgcHVzaF9zdGFjayhzdGFjaywgc3AsIGEgLSBiKTsKICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb24gPT0gTVVMKSB7CiAgICAgICAgbGV0IGI6IGkzMiA9IHBvcF9zdGFjayhzdGFjaywgc3ApOwogICAgICAgIGxldCBhOiBpMzIgPSBwb3Bfc3RhY2soc3RhY2ssIHNwKTsKICAgICAgICBwdXNoX3N0YWNrKHN0YWNrLCBzcCwgYSAqIGIpOwogICAgfSBlbHNlIGlmIChpbnN0cnVjdGlvbiA9PSBESVYpIHsKICAgICAgICBsZXQgYjogaTMyID0gcG9wX3N0YWNrKHN0YWNrLCBzcCk7CiAgICAgICAgbGV0IGE6IGkzMiA9IHBvcF9zdGFjayhzdGFjaywgc3ApOwogICAgICAgIGlmIChiICE9IDApIHsKICAgICAgICAgICAgcHVzaF9zdGFjayhzdGFjaywgc3AsIGEgLyBiKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAqcnVubmluZyA9IGZhbHNlOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb24gPT0gUFJJTlQpIHsKICAgICAgICBsZXQgdmFsOiBpMzIgPSBwb3Bfc3RhY2soc3RhY2ssIHNwKTsKICAgICAgICBwcmludGxuSW50KHZhbCk7CiAgICB9IGVsc2UgaWYgKGluc3RydWN0aW9uID09IEpNUCkgewogICAgICAgICpwYyA9IG1lbW9yeVsqcGMgYXMgdXNpemVdOwogICAgfSBlbHNlIGlmIChpbnN0cnVjdGlvbiA9PSBKWikgewogICAgICAgIGxldCB2YWw6IGkzMiA9IHBvcF9zdGFjayhzdGFjaywgc3ApOwogICAgICAgIGlmICh2YWwgPT0gMCkgewogICAgICAgICAgICAqcGMgPSBtZW1vcnlbKnBjIGFzIHVzaXplXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAqcGMgPSAqcGMgKyAxOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb24gPT0gSk5aKSB7CiAgICAgICAgbGV0IHZhbDogaTMyID0gcG9wX3N0YWNrKHN0YWNrLCBzcCk7CiAgICAgICAgaWYgKHZhbCAhPSAwKSB7CiAgICAgICAgICAgICpwYyA9IG1lbW9yeVsqcGMgYXMgdXNpemVdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICpwYyA9ICpwYyArIDE7CiAgICAgICAgfQogICAgfSBlbHNlIGlmIChpbnN0cnVjdGlvbiA9PSBFUSkgewogICAgICAgIGxldCBiOiBpMzIgPSBwb3Bfc3RhY2soc3RhY2ssIHNwKTsKICAgICAgICBsZXQgYTogaTMyID0gcG9wX3N0YWNrKHN0YWNrLCBzcCk7CiAgICAgICAgaWYgKGEgPT0gYikgewogICAgICAgICAgICBwdXNoX3N0YWNrKHN0YWNrLCBzcCwgMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHVzaF9zdGFjayhzdGFjaywgc3AsIDApOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb24gPT0gTFQpIHsKICAgICAgICBsZXQgYjogaTMyID0gcG9wX3N0YWNrKHN0YWNrLCBzcCk7CiAgICAgICAgbGV0IGE6IGkzMiA9IHBvcF9zdGFjayhzdGFjaywgc3ApOwogICAgICAgIGlmIChhIDwgYikgewogICAgICAgICAgICBwdXNoX3N0YWNrKHN0YWNrLCBzcCwgMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHVzaF9zdGFjayhzdGFjaywgc3AsIDApOwogICAgICAgIH0KICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb24gPT0gU1RPUkUpIHsKICAgICAgICBsZXQgYWRkcjogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZV07CiAgICAgICAgKnBjID0gKnBjICsgMTsKICAgICAgICBsZXQgdmFsOiBpMzIgPSBwb3Bfc3RhY2soc3RhY2ssIHNwKTsKICAgICAgICBtZW1vcnlbYWRkciBhcyB1c2l6ZV0gPSB2YWw7CiAgICB9IGVsc2UgaWYgKGluc3RydWN0aW9uID09IExPQUQpIHsKICAgICAgICBsZXQgYWRkcjogaTMyID0gbWVtb3J5WypwYyBhcyB1c2l6ZV07CiAgICAgICAgKnBjID0gKnBjICsgMTsKICAgICAgICBsZXQgdmFsOiBpMzIgPSBtZW1vcnlbYWRkciBhcyB1c2l6ZV07CiAgICAgICAgcHVzaF9zdGFjayhzdGFjaywgc3AsIHZhbCk7CiAgICB9IGVsc2UgaWYgKGluc3RydWN0aW9uID09IERVUCkgewogICAgICAgIGxldCB2YWw6IGkzMiA9IHN0YWNrWypzcCBhcyB1c2l6ZV07CiAgICAgICAgcHVzaF9zdGFjayhzdGFjaywgc3AsIHZhbCk7CiAgICB9Cn0KCmZuIG1haW4oKSB7CiAgICBsZXQgbXV0IG1lbW9yeTogW2kzMjsgMTAyNF0gPSBbMDsgMTAyNF07CiAgICBsZXQgbXV0IHN0YWNrOiBbaTMyOyAyNTZdID0gWzA7IDI1Nl07CiAgICBsZXQgbXV0IHBjOiBpMzIgPSAwOwogICAgbGV0IG11dCBzcDogaTMyID0gLTE7CiAgICBsZXQgbXV0IHJ1bm5pbmc6IGJvb2wgPSB0cnVlOwogICAgbG9hZF9wcm9ncmFtKCZtdXQgbWVtb3J5KTsKCiAgICBsZXQgbXV0IGN5Y2xlX2NvdW50OiBpMzIgPSAwOwogICAgbGV0IG1heF9jeWNsZXM6IGkzMiA9IDUwMDA7CgogICAgd2hpbGUgKHJ1bm5pbmcpIHsKICAgICAgICBpZiAoY3ljbGVfY291bnQgPiBtYXhfY3ljbGVzKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBleGVjdXRlX2N5Y2xlKCZtdXQgbWVtb3J5LCAmbXV0IHBjLCAmbXV0IHN0YWNrLCAmbXV0IHNwLCAmbXV0IHJ1bm5pbmcpOwogICAgICAgIGN5Y2xlX2NvdW50ID0gY3ljbGVfY291bnQgKyAxOwogICAgfQoKICAgIHByaW50bG5JbnQoY3ljbGVfY291bnQpOwogICAgcHJpbnRsbkludChzcCk7CgogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgbGV0IG11dCBjaGVja3N1bTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgU1RBQ0tfU0laRSkgewogICAgICAgIGNoZWNrc3VtID0gY2hlY2tzdW0gKyBzdGFja1tpIGFzIHVzaXplXTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICBwcmludGxuSW50KGNoZWNrc3VtKTsKCiAgICBwYyA9IDEwMDsKICAgIHNwID0gLTE7CiAgICBydW5uaW5nID0gdHJ1ZTsKICAgIGN5Y2xlX2NvdW50ID0gMDsKICAgIHdoaWxlIChydW5uaW5nKSB7CiAgICAgICAgaWYgKGN5Y2xlX2NvdW50ID4gMTAwKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBleGVjdXRlX2N5Y2xlKCZtdXQgbWVtb3J5LCAmbXV0IHBjLCAmbXV0IHN0YWNrLCAmbXV0IHNwLCAmbXV0IHJ1bm5pbmcpOwogICAgICAgIGN5Y2xlX2NvdW50ID0gY3ljbGVfY291bnQgKyAxOwogICAgfQoKICAgIGxldCBtdXQgdm1fc3RhdGU6IGkzMiA9IDE7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IDEwKSB7CiAgICAgICAgbGV0IHZtX3N0YXRlOiBpMzIgPSB2bV9zdGF0ZSArIGk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcHJpbnRsbkludCh2bV9zdGF0ZSk7CiAgICBleGl0KDApOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (38, "comprehensive38", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IENvbXBsZXggRGF0YSBTdHJ1Y3R1cmUgU2ltdWxhdGlvbjogQi1UcmVlClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpTaW11bGF0aW5nIGEgY29tcGxleCwgcG9pbnRlci1oZWF2eSBkYXRhIHN0cnVjdHVyZSAoQi1UcmVlKSB1c2luZyBhcnJheXMuClJlY3Vyc2l2ZSBpbnNlcnRpb24gYW5kIHNlYXJjaCBhbGdvcml0aG1zIHdpdGggZGVlcCBjYWxsIHN0YWNrcy4KTWFuYWdlbWVudCBvZiBub2RlIHNwbGl0dGluZyBhbmQgbWVyZ2luZywgaW52b2x2aW5nIHNpZ25pZmljYW50IGRhdGEgbW92ZW1lbnQuCkxvb3Agb3B0aW1pemF0aW9ucyBmb3Igc2VhcmNoaW5nIGtleXMgd2l0aGluIGEgbm9kZS4KQnJhbmNoIHByZWRpY3Rpb24gZm9yIGhhbmRsaW5nIGRpZmZlcmVudCBjYXNlcyBpbiBCLVRyZWUgb3BlcmF0aW9ucyAoZS5nLiwgbm9kZSBmdWxsLCBsZWFmL2ludGVybmFsIG5vZGUpLgpBcnJheSBpbmRleGluZyBhbmQgYXJpdGhtZXRpYyBmb3IgbmF2aWdhdGluZyB0aGUgdHJlZSBzdHJ1Y3R1cmUuClNjb3BlIGVycm9ycyByZWxhdGVkIHRvIHJlY3Vyc2l2ZSBoZWxwZXIgZnVuY3Rpb24gc3RhdGUuCiovCgovLyBjb21wcmVoZW5zaXZlMzgucnggLSBDb21wbGV4IERhdGEgU3RydWN0dXJlIFNpbXVsYXRpb246IEItVHJlZQovLyBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKLy8gLSBTaW11bGF0aW5nIGEgY29tcGxleCwgcG9pbnRlci1oZWF2eSBkYXRhIHN0cnVjdHVyZSAoQi1UcmVlKSB1c2luZyBhcnJheXMuCi8vIC0gUmVjdXJzaXZlIGluc2VydGlvbiBhbmQgc2VhcmNoIGFsZ29yaXRobXMgd2l0aCBkZWVwIGNhbGwgc3RhY2tzLgovLyAtIE1hbmFnZW1lbnQgb2Ygbm9kZSBzcGxpdHRpbmcgYW5kIG1lcmdpbmcsIGludm9sdmluZyBzaWduaWZpY2FudCBkYXRhIG1vdmVtZW50LgovLyAtIExvb3Agb3B0aW1pemF0aW9ucyBmb3Igc2VhcmNoaW5nIGtleXMgd2l0aGluIGEgbm9kZS4KLy8gLSBCcmFuY2ggcHJlZGljdGlvbiBmb3IgaGFuZGxpbmcgZGlmZmVyZW50IGNhc2VzIGluIEItVHJlZSBvcGVyYXRpb25zIChlLmcuLCBub2RlIGZ1bGwsIGxlYWYvaW50ZXJuYWwgbm9kZSkuCi8vIC0gQXJyYXkgaW5kZXhpbmcgYW5kIGFyaXRobWV0aWMgZm9yIG5hdmlnYXRpbmcgdGhlIHRyZWUgc3RydWN0dXJlLgovLyAtIFNjb3BlIGVycm9ycyByZWxhdGVkIHRvIHJlY3Vyc2l2ZSBoZWxwZXIgZnVuY3Rpb24gc3RhdGUuCgpjb25zdCBPUkRFUjogaTMyID0gNTsKY29uc3QgTUFYX0tFWVM6IGkzMiA9IE9SREVSIC0gMTsKY29uc3QgTUlOX0tFWVM6IGkzMiA9IChPUkRFUiAtIDEpIC8gMjsKY29uc3QgUE9PTF9TSVpFOiB1c2l6ZSA9IDIwMDsKCnN0cnVjdCBQb29scyB7CiAgICBub2RlX3Bvb2xfa2V5czogW1tpMzI7IDVdOyBQT09MX1NJWkVdLAogICAgbm9kZV9wb29sX2NoaWxkcmVuOiBbW2kzMjsgNl07IFBPT0xfU0laRV0sCiAgICBub2RlX3Bvb2xfaXNfbGVhZjogW2Jvb2w7IFBPT0xfU0laRV0sCiAgICBub2RlX3Bvb2xfbnVtX2tleXM6IFtpMzI7IFBPT0xfU0laRV0sCiAgICBuZXh0X25vZGVfaWR4OiBpMzIsCiAgICByb290X25vZGVfaWR4OiBpMzIsCn0KCmZuIGNyZWF0ZV9ub2RlKHBvb2xzOiAmbXV0IFBvb2xzLCBpc19sZWFmOiBib29sKSAtPiBpMzIgewogICAgbGV0IGlkeDogaTMyID0gcG9vbHMubmV4dF9ub2RlX2lkeDsKICAgIHBvb2xzLm5leHRfbm9kZV9pZHggPSBwb29scy5uZXh0X25vZGVfaWR4ICsgMTsKICAgIHBvb2xzLm5vZGVfcG9vbF9pc19sZWFmW2lkeCBhcyB1c2l6ZV0gPSBpc19sZWFmOwogICAgcG9vbHMubm9kZV9wb29sX251bV9rZXlzW2lkeCBhcyB1c2l6ZV0gPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBNQVhfS0VZUykgewogICAgICAgIHBvb2xzLm5vZGVfcG9vbF9rZXlzW2lkeCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gPSAwOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBPUkRFUikgewogICAgICAgIHBvb2xzLm5vZGVfcG9vbF9jaGlsZHJlbltpZHggYXMgdXNpemVdW2kgYXMgdXNpemVdID0gLTE7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcmV0dXJuIGlkeDsKfQoKZm4gc3BsaXRfY2hpbGQocG9vbHM6ICZtdXQgUG9vbHMsIHBhcmVudF9pZHg6IGkzMiwgY2hpbGRfaWR4X2luX3BhcmVudDogaTMyLCBjaGlsZF9pZHg6IGkzMikgewogICAgbGV0IG5ld19ub2RlX2lkeDogaTMyID0gY3JlYXRlX25vZGUocG9vbHMsIHBvb2xzLm5vZGVfcG9vbF9pc19sZWFmW2NoaWxkX2lkeCBhcyB1c2l6ZV0pOwogICAgcG9vbHMubm9kZV9wb29sX251bV9rZXlzW25ld19ub2RlX2lkeCBhcyB1c2l6ZV0gPSBNSU5fS0VZUzsKCiAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICB3aGlsZSAoaiA8IE1JTl9LRVlTKSB7CiAgICAgICAgcG9vbHMubm9kZV9wb29sX2tleXNbbmV3X25vZGVfaWR4IGFzIHVzaXplXVtqIGFzIHVzaXplXSA9CiAgICAgICAgICAgIHBvb2xzLm5vZGVfcG9vbF9rZXlzW2NoaWxkX2lkeCBhcyB1c2l6ZV1bKGogKyBNSU5fS0VZUyArIDEpIGFzIHVzaXplXTsKICAgICAgICBqID0gaiArIDE7CiAgICB9CgogICAgaWYgKCFwb29scy5ub2RlX3Bvb2xfaXNfbGVhZltjaGlsZF9pZHggYXMgdXNpemVdKSB7CiAgICAgICAgaiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBNSU5fS0VZUyArIDEpIHsKICAgICAgICAgICAgcG9vbHMubm9kZV9wb29sX2NoaWxkcmVuW25ld19ub2RlX2lkeCBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPQogICAgICAgICAgICAgICAgcG9vbHMubm9kZV9wb29sX2NoaWxkcmVuW2NoaWxkX2lkeCBhcyB1c2l6ZV1bKGogKyBNSU5fS0VZUyArIDEpIGFzIHVzaXplXTsKICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgIH0KCiAgICBwb29scy5ub2RlX3Bvb2xfbnVtX2tleXNbY2hpbGRfaWR4IGFzIHVzaXplXSA9IE1JTl9LRVlTOwoKICAgIGogPSBwb29scy5ub2RlX3Bvb2xfbnVtX2tleXNbcGFyZW50X2lkeCBhcyB1c2l6ZV07CiAgICB3aGlsZSAoaiA+IGNoaWxkX2lkeF9pbl9wYXJlbnQpIHsKICAgICAgICBwb29scy5ub2RlX3Bvb2xfY2hpbGRyZW5bcGFyZW50X2lkeCBhcyB1c2l6ZV1baiBhcyB1c2l6ZSArIDFdID0KICAgICAgICAgICAgcG9vbHMubm9kZV9wb29sX2NoaWxkcmVuW3BhcmVudF9pZHggYXMgdXNpemVdW2ogYXMgdXNpemVdOwogICAgICAgIGogPSBqIC0gMTsKICAgIH0KICAgIHBvb2xzLm5vZGVfcG9vbF9jaGlsZHJlbltwYXJlbnRfaWR4IGFzIHVzaXplXVtjaGlsZF9pZHhfaW5fcGFyZW50IGFzIHVzaXplICsgMV0gPSBuZXdfbm9kZV9pZHg7CgogICAgaiA9IHBvb2xzLm5vZGVfcG9vbF9udW1fa2V5c1twYXJlbnRfaWR4IGFzIHVzaXplXSAtIDE7CiAgICB3aGlsZSAoaiA+PSBjaGlsZF9pZHhfaW5fcGFyZW50KSB7CiAgICAgICAgcG9vbHMubm9kZV9wb29sX2tleXNbcGFyZW50X2lkeCBhcyB1c2l6ZV1baiBhcyB1c2l6ZSArIDFdID0KICAgICAgICAgICAgcG9vbHMubm9kZV9wb29sX2tleXNbcGFyZW50X2lkeCBhcyB1c2l6ZV1baiBhcyB1c2l6ZV07CiAgICAgICAgaiA9IGogLSAxOwogICAgfQoKICAgIHBvb2xzLm5vZGVfcG9vbF9rZXlzW3BhcmVudF9pZHggYXMgdXNpemVdW2NoaWxkX2lkeF9pbl9wYXJlbnQgYXMgdXNpemVdID0KICAgICAgICBwb29scy5ub2RlX3Bvb2xfa2V5c1tjaGlsZF9pZHggYXMgdXNpemVdW01JTl9LRVlTIGFzIHVzaXplXTsKICAgIHBvb2xzLm5vZGVfcG9vbF9udW1fa2V5c1twYXJlbnRfaWR4IGFzIHVzaXplXSA9CiAgICAgICAgcG9vbHMubm9kZV9wb29sX251bV9rZXlzW3BhcmVudF9pZHggYXMgdXNpemVdICsgMTsKfQoKZm4gaW5zZXJ0X25vbl9mdWxsKHBvb2xzOiAmbXV0IFBvb2xzLCBub2RlX2lkeDogaTMyLCBrZXk6IGkzMikgewogICAgaWYgKG5vZGVfaWR4IDwgMCkgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGxldCBtdXQgaTogaTMyID0gcG9vbHMubm9kZV9wb29sX251bV9rZXlzW25vZGVfaWR4IGFzIHVzaXplXSAtIDE7CgogICAgaWYgKHBvb2xzLm5vZGVfcG9vbF9pc19sZWFmW25vZGVfaWR4IGFzIHVzaXplXSkgewogICAgICAgIHdoaWxlIChpID49IDApIHsKICAgICAgICAgICAgaWYgKHBvb2xzLm5vZGVfcG9vbF9rZXlzW25vZGVfaWR4IGFzIHVzaXplXVtpIGFzIHVzaXplXSA8PSBrZXkpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHBvb2xzLm5vZGVfcG9vbF9rZXlzW25vZGVfaWR4IGFzIHVzaXplXVtpIGFzIHVzaXplICsgMV0gPQogICAgICAgICAgICAgICAgcG9vbHMubm9kZV9wb29sX2tleXNbbm9kZV9pZHggYXMgdXNpemVdW2kgYXMgdXNpemVdOwogICAgICAgICAgICBpID0gaSAtIDE7CiAgICAgICAgfQogICAgICAgIHBvb2xzLm5vZGVfcG9vbF9rZXlzW25vZGVfaWR4IGFzIHVzaXplXVsoaSArIDEpIGFzIHVzaXplXSA9IGtleTsKICAgICAgICBwb29scy5ub2RlX3Bvb2xfbnVtX2tleXNbbm9kZV9pZHggYXMgdXNpemVdID0KICAgICAgICAgICAgcG9vbHMubm9kZV9wb29sX251bV9rZXlzW25vZGVfaWR4IGFzIHVzaXplXSArIDE7CiAgICB9IGVsc2UgewogICAgICAgIHdoaWxlIChpID49IDApIHsKICAgICAgICAgICAgaWYgKHBvb2xzLm5vZGVfcG9vbF9rZXlzW25vZGVfaWR4IGFzIHVzaXplXVtpIGFzIHVzaXplXSA8PSBrZXkpIHsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpIC0gMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIGxldCBjaGlsZF90b19pbnNlcnRfaWR4OiBpMzIgPSBwb29scy5ub2RlX3Bvb2xfY2hpbGRyZW5bbm9kZV9pZHggYXMgdXNpemVdW2kgYXMgdXNpemVdOwogICAgICAgIGlmIChjaGlsZF90b19pbnNlcnRfaWR4ID49IDAKICAgICAgICAgICAgJiYgcG9vbHMubm9kZV9wb29sX251bV9rZXlzW2NoaWxkX3RvX2luc2VydF9pZHggYXMgdXNpemVdID09IE1BWF9LRVlTKQogICAgICAgIHsKICAgICAgICAgICAgc3BsaXRfY2hpbGQocG9vbHMsIG5vZGVfaWR4LCBpLCBjaGlsZF90b19pbnNlcnRfaWR4KTsKICAgICAgICAgICAgaWYgKGtleSA+IHBvb2xzLm5vZGVfcG9vbF9rZXlzW25vZGVfaWR4IGFzIHVzaXplXVtpIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGluc2VydF9ub25fZnVsbCgKICAgICAgICAgICAgcG9vbHMsCiAgICAgICAgICAgIHBvb2xzLm5vZGVfcG9vbF9jaGlsZHJlbltub2RlX2lkeCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0sCiAgICAgICAgICAgIGtleSwKICAgICAgICApOwogICAgfQp9CgpmbiBpbnNlcnQocG9vbHM6ICZtdXQgUG9vbHMsIGtleTogaTMyKSB7CiAgICBpZiAocG9vbHMucm9vdF9ub2RlX2lkeCA9PSAtMSkgewogICAgICAgIHBvb2xzLnJvb3Rfbm9kZV9pZHggPSBjcmVhdGVfbm9kZShwb29scywgdHJ1ZSk7CiAgICAgICAgcG9vbHMubm9kZV9wb29sX2tleXNbcG9vbHMucm9vdF9ub2RlX2lkeCBhcyB1c2l6ZV1bMF0gPSBrZXk7CiAgICAgICAgcG9vbHMubm9kZV9wb29sX251bV9rZXlzW3Bvb2xzLnJvb3Rfbm9kZV9pZHggYXMgdXNpemVdID0gMTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgbGV0IHJvb3Q6IGkzMiA9IHBvb2xzLnJvb3Rfbm9kZV9pZHg7CiAgICBpZiAocG9vbHMubm9kZV9wb29sX251bV9rZXlzW3Jvb3QgYXMgdXNpemVdID09IE1BWF9LRVlTKSB7CiAgICAgICAgbGV0IG5ld19yb290X2lkeDogaTMyID0gY3JlYXRlX25vZGUocG9vbHMsIGZhbHNlKTsKICAgICAgICBwb29scy5yb290X25vZGVfaWR4ID0gbmV3X3Jvb3RfaWR4OwogICAgICAgIHBvb2xzLm5vZGVfcG9vbF9jaGlsZHJlbltuZXdfcm9vdF9pZHggYXMgdXNpemVdWzBdID0gcm9vdDsKICAgICAgICBzcGxpdF9jaGlsZChwb29scywgbmV3X3Jvb3RfaWR4LCAwLCByb290KTsKICAgICAgICBpbnNlcnRfbm9uX2Z1bGwocG9vbHMsIG5ld19yb290X2lkeCwga2V5KTsKICAgIH0gZWxzZSB7CiAgICAgICAgaW5zZXJ0X25vbl9mdWxsKHBvb2xzLCByb290LCBrZXkpOwogICAgfQp9CgpmbiBzZWFyY2hfcmVjdXJzaXZlKHBvb2xzOiAmUG9vbHMsIG5vZGVfaWR4OiBpMzIsIGtleTogaTMyKSAtPiBib29sIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgcG9vbHMubm9kZV9wb29sX251bV9rZXlzW25vZGVfaWR4IGFzIHVzaXplXSkgewogICAgICAgIGlmIChrZXkgPCBwb29scy5ub2RlX3Bvb2xfa2V5c1tub2RlX2lkeCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGlmIChrZXkgPT0gcG9vbHMubm9kZV9wb29sX2tleXNbbm9kZV9pZHggYXMgdXNpemVdW2kgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgaWYgKHBvb2xzLm5vZGVfcG9vbF9pc19sZWFmW25vZGVfaWR4IGFzIHVzaXplXSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0gZWxzZSB7CiAgICAgICAgbGV0IGNoaWxkX2lkeDogaTMyID0gcG9vbHMubm9kZV9wb29sX2NoaWxkcmVuW25vZGVfaWR4IGFzIHVzaXplXVtpIGFzIHVzaXplXTsKICAgICAgICBpZiAoY2hpbGRfaWR4ID09IC0xKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNlYXJjaF9yZWN1cnNpdmUocG9vbHMsIGNoaWxkX2lkeCwga2V5KTsKICAgIH0KfQoKZm4gdHJhdmVyc2VfYW5kX3N1bShwb29sczogJlBvb2xzLCBub2RlX2lkeDogaTMyKSAtPiBpMzIgewogICAgaWYgKG5vZGVfaWR4ID09IC0xKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CiAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIGxldCBpc19sZWFmOiBib29sID0gcG9vbHMubm9kZV9wb29sX2lzX2xlYWZbbm9kZV9pZHggYXMgdXNpemVdOwoKICAgIHdoaWxlIChpIDwgcG9vbHMubm9kZV9wb29sX251bV9rZXlzW25vZGVfaWR4IGFzIHVzaXplXSkgewogICAgICAgIGlmICghaXNfbGVhZikgewogICAgICAgICAgICBzdW0gPSBzdW0KICAgICAgICAgICAgICAgICsgdHJhdmVyc2VfYW5kX3N1bSgKICAgICAgICAgICAgICAgICAgICBwb29scywKICAgICAgICAgICAgICAgICAgICBwb29scy5ub2RlX3Bvb2xfY2hpbGRyZW5bbm9kZV9pZHggYXMgdXNpemVdW2kgYXMgdXNpemVdLAogICAgICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgc3VtID0gc3VtICsgcG9vbHMubm9kZV9wb29sX2tleXNbbm9kZV9pZHggYXMgdXNpemVdW2kgYXMgdXNpemVdOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIGlmICghaXNfbGVhZikgewogICAgICAgIHN1bSA9IHN1bQogICAgICAgICAgICArIHRyYXZlcnNlX2FuZF9zdW0oCiAgICAgICAgICAgICAgICBwb29scywKICAgICAgICAgICAgICAgIHBvb2xzLm5vZGVfcG9vbF9jaGlsZHJlbltub2RlX2lkeCBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0sCiAgICAgICAgICAgICk7CiAgICB9CiAgICByZXR1cm4gc3VtOwp9CgpmbiBnZXRfaGVpZ2h0KHBvb2xzOiAmUG9vbHMsIG5vZGVfaWR4OiBpMzIpIC0+IGkzMiB7CiAgICBpZiAobm9kZV9pZHggPT0gLTEpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIGlmIChwb29scy5ub2RlX3Bvb2xfaXNfbGVhZltub2RlX2lkeCBhcyB1c2l6ZV0pIHsKICAgICAgICByZXR1cm4gMTsKICAgIH0KICAgIHJldHVybiAxICsgZ2V0X2hlaWdodChwb29scywgcG9vbHMubm9kZV9wb29sX2NoaWxkcmVuW25vZGVfaWR4IGFzIHVzaXplXVswXSk7Cn0KCmZuIG1haW4oKSB7CiAgICBsZXQgbXV0IHBvb2xzOiBQb29scyA9IFBvb2xzIHsKICAgICAgICBub2RlX3Bvb2xfa2V5czogW1swOyA1XTsgUE9PTF9TSVpFXSwKICAgICAgICBub2RlX3Bvb2xfY2hpbGRyZW46IFtbLTE7IDZdOyBQT09MX1NJWkVdLAogICAgICAgIG5vZGVfcG9vbF9pc19sZWFmOiBbZmFsc2U7IFBPT0xfU0laRV0sCiAgICAgICAgbm9kZV9wb29sX251bV9rZXlzOiBbMDsgUE9PTF9TSVpFXSwKICAgICAgICBuZXh0X25vZGVfaWR4OiAwLAogICAgICAgIHJvb3Rfbm9kZV9pZHg6IC0xLAogICAgfTsKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGtleXNfdG9faW5zZXJ0OiBbaTMyOyAxMDBdID0gWzA7IDEwMF07CiAgICBsZXQgbXV0IGN1cnJlbnQ6IGkzMiA9IDEwMDsKICAgIGxldCBtdXQgc3RlcDogaTMyID0gMzc7CiAgICBsZXQgbW9kdWx1czogaTMyID0gMjUxOwoKICAgIHdoaWxlIChpIDwgMTAwKSB7CiAgICAgICAgY3VycmVudCA9IChjdXJyZW50ICsgc3RlcCkgJSBtb2R1bHVzOwogICAgICAgIGtleXNfdG9faW5zZXJ0W2kgYXMgdXNpemVdID0gY3VycmVudDsKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDEwMCkgewogICAgICAgIGluc2VydCgmbXV0IHBvb2xzLCBrZXlzX3RvX2luc2VydFtpIGFzIHVzaXplXSk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGxldCBtdXQgZm91bmRfY291bnQ6IGkzMiA9IDA7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgMTAwKSB7CiAgICAgICAgaWYgKHNlYXJjaF9yZWN1cnNpdmUoJnBvb2xzLCBwb29scy5yb290X25vZGVfaWR4LCBrZXlzX3RvX2luc2VydFtpIGFzIHVzaXplXSkpIHsKICAgICAgICAgICAgZm91bmRfY291bnQgPSBmb3VuZF9jb3VudCArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHByaW50bG5JbnQoZm91bmRfY291bnQpOwoKICAgIGxldCBtdXQgbm90X2ZvdW5kX2NvdW50OiBpMzIgPSAwOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDUwKSB7CiAgICAgICAgaWYgKCFzZWFyY2hfcmVjdXJzaXZlKCZwb29scywgcG9vbHMucm9vdF9ub2RlX2lkeCwgMzAwICsgaSkpIHsKICAgICAgICAgICAgbm90X2ZvdW5kX2NvdW50ID0gbm90X2ZvdW5kX2NvdW50ICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcHJpbnRsbkludChub3RfZm91bmRfY291bnQpOwoKICAgIGxldCBzdW06IGkzMiA9IHRyYXZlcnNlX2FuZF9zdW0oJnBvb2xzLCBwb29scy5yb290X25vZGVfaWR4KTsKICAgIHByaW50bG5JbnQoc3VtKTsKCiAgICBsZXQgaGVpZ2h0OiBpMzIgPSBnZXRfaGVpZ2h0KCZwb29scywgcG9vbHMucm9vdF9ub2RlX2lkeCk7CiAgICBwcmludGxuSW50KGhlaWdodCk7CgogICAgaW5zZXJ0KCZtdXQgcG9vbHMsIDUwMCk7CiAgICBpbnNlcnQoJm11dCBwb29scywgNTAxKTsKICAgIGluc2VydCgmbXV0IHBvb2xzLCA1MDIpOwogICAgaW5zZXJ0KCZtdXQgcG9vbHMsIDUwMyk7CiAgICBpbnNlcnQoJm11dCBwb29scywgNTA0KTsKICAgIGluc2VydCgmbXV0IHBvb2xzLCA1MDUpOwoKICAgIGxldCBuZXdfc3VtOiBpMzIgPSB0cmF2ZXJzZV9hbmRfc3VtKCZwb29scywgcG9vbHMucm9vdF9ub2RlX2lkeCk7CiAgICBwcmludGxuSW50KG5ld19zdW0pOwoKICAgIGxldCBuZXdfaGVpZ2h0OiBpMzIgPSBnZXRfaGVpZ2h0KCZwb29scywgcG9vbHMucm9vdF9ub2RlX2lkeCk7CiAgICBwcmludGxuSW50KG5ld19oZWlnaHQpOwoKICAgIGxldCBtdXQgZmluYWxfY2hlY2s6IGkzMiA9IDA7CiAgICBpZiAoc2VhcmNoX3JlY3Vyc2l2ZSgmcG9vbHMsIHBvb2xzLnJvb3Rfbm9kZV9pZHgsIDUwMykpIHsKICAgICAgICBmaW5hbF9jaGVjayA9IDE7CiAgICB9CiAgICBwcmludGxuSW50KGZpbmFsX2NoZWNrKTsKCiAgICBpZiAoIXNlYXJjaF9yZWN1cnNpdmUoJnBvb2xzLCBwb29scy5yb290X25vZGVfaWR4LCA5OTkpKSB7CiAgICAgICAgZmluYWxfY2hlY2sgPSAyOwogICAgfQogICAgcHJpbnRsbkludChmaW5hbF9jaGVjayk7CgogICAgbGV0IG11dCBqOiBpMzIgPSAxMDA7CiAgICB3aGlsZSAoaiA8IDE1MCkgewogICAgICAgIGluc2VydCgmbXV0IHBvb2xzLCBqICogMyk7CiAgICAgICAgaiA9IGogKyAxOwogICAgfQoKICAgIGxldCBmaW5hbF9zdW06IGkzMiA9IHRyYXZlcnNlX2FuZF9zdW0oJnBvb2xzLCBwb29scy5yb290X25vZGVfaWR4KTsKICAgIHByaW50bG5JbnQoZmluYWxfc3VtKTsKICAgIHByaW50bG5JbnQoZ2V0X2hlaWdodCgmcG9vbHMsIHBvb2xzLnJvb3Rfbm9kZV9pZHgpKTsKCiAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHRvdGFsX25vZGVzOiBpMzIgPSAwOwogICAgd2hpbGUgKGsgPCBwb29scy5uZXh0X25vZGVfaWR4KSB7CiAgICAgICAgaWYgKHBvb2xzLm5vZGVfcG9vbF9udW1fa2V5c1trIGFzIHVzaXplXSA+IDApIHsKICAgICAgICAgICAgdG90YWxfbm9kZXMgPSB0b3RhbF9ub2RlcyArIDE7CiAgICAgICAgfQogICAgICAgIGsgPSBrICsgMTsKICAgIH0KICAgIHByaW50bG5JbnQodG90YWxfbm9kZXMpOwoKICAgIGxldCBtdXQgZXJyb3JfZmxhZzogYm9vbCA9IGZhbHNlOwogICAgbGV0IG11dCBtOiBpMzIgPSAwOwogICAgd2hpbGUgKG0gPCAxMCkgewogICAgICAgIGlmIChtID4gNSkgewogICAgICAgICAgICBsZXQgbXV0IGVycm9yX2ZsYWc6IGJvb2wgPSB0cnVlOwogICAgICAgIH0KICAgICAgICBtID0gbSArIDE7CiAgICB9CgogICAgaWYgKGVycm9yX2ZsYWcpIHsKICAgICAgICBwcmludGxuSW50KDk5OSk7CiAgICB9IGVsc2UgewogICAgICAgIHByaW50bG5JbnQoODg4KTsKICAgIH0KICAgIGV4aXQoMCk7Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (39, "comprehensive39", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEFkdmFuY2VkIENvbnRyb2wgRmxvdyBhbmQgTG9naWMgU2ltdWxhdGlvbgpTdW1tYXJ5OiBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKRGV0YWlsczoKRGVlcGx5IG5lc3RlZCBhbmQgY29tcGxleCBjb25kaXRpb25hbCAoaWYgICAgbGV0IG11dCBwOiBpMzIgPSAwOwogICAgd2hpbGUgKHAgPCAxMCkgewogICAgICAgIGxldCBtdXQgdGVtcDogaTMyID0gcCAqIHA7CiAgICAgICAgaWYgKHAgJSAyID09IDApIHsKICAgICAgICAgICAgbGV0IG11dCB0ZW1wOiBpMzIgPSBwICogMjsKICAgICAgICAgICAgZmluYWxfdmFsID0gZmluYWxfdmFsICsgdGVtcDsKICAgICAgICB9CiAgICAgICAgZmluYWxfdmFsID0gZmluYWxfdmFsICsgdGVtcDsKICAgICAgICBwID0gcCArIDE7CiAgICB9IGxvb3AgKHdoaWxlKSBzdHJ1Y3R1cmVzLgpTdGF0ZSBtYWNoaW5lIGltcGxlbWVudGF0aW9uIHdpdGggaW50cmljYXRlIHRyYW5zaXRpb24gbG9naWMuCkJvb2xlYW4gbG9naWMgb3B0aW1pemF0aW9uIGFuZCBzaG9ydC1jaXJjdWl0aW5nIGJlaGF2aW9yLgpMb29wIHVucm9sbGluZyBhbmQgZnVzaW9uIGluIHRoZSBjb250ZXh0IG9mIHN0YXRlIHVwZGF0ZXMuCkVmZmljaWVudCBoYW5kbGluZyBvZiBtdWx0aS1kaW1lbnNpb25hbCBhcnJheXMgZm9yIHN0b3Jpbmcgc3RhdGUgdGFibGVzLgpCcmFuY2ggcHJlZGljdGlvbiBhY2N1cmFjeSBmb3IgaXJyZWd1bGFyLCBkYXRhLWRyaXZlbiBjb250cm9sIGZsb3cuCkNvcnJlY3QgaGFuZGxpbmcgb2YgdmFyaWFibGUgc2hhZG93aW5nIGFuZCBtdXRhYmlsaXR5IGluIG5lc3RlZCBzY29wZXMuCiovCgovLyBVbmlmaWVkIFJORzogUGFya+KAk01pbGxlciAoYT0xNjgwNywgbT0yMTQ3NDgzNjQ3KSB1c2luZyBTY2hyYWdlIG1ldGhvZCB0byBhdm9pZCBvdmVyZmxvdwpmbiBwbV9yYW5kX3VwZGF0ZSh4OiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgYTogaTMyID0gMTY4MDc7CiAgICBsZXQgbTogaTMyID0gMjE0NzQ4MzY0NzsKICAgIGxldCBxOiBpMzIgPSAxMjc3NzM7IC8vIG0gLyBhCiAgICBsZXQgcjogaTMyID0gMjgzNjsgLy8gbSAlIGEKICAgIGxldCBtdXQgazogaTMyID0geCAvIHE7CiAgICBsZXQgbXV0IG5ld194OiBpMzIgPSBhICogKHggLSBrICogcSkgLSByICogazsKICAgIGlmIChuZXdfeCA8PSAwKSB7CiAgICAgICAgbmV3X3ggKz0gbTsKICAgIH0KICAgIHJldHVybiBuZXdfeDsKfQoKLy8gY29tcHJlaGVuc2l2ZTM5LnJ4IC0gQWR2YW5jZWQgQ29udHJvbCBGbG93IGFuZCBMb2dpYyBTaW11bGF0aW9uCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIERlZXBseSBuZXN0ZWQgYW5kIGNvbXBsZXggY29uZGl0aW9uYWwgKGlmL2Vsc2UpIGFuZCBsb29wICh3aGlsZSkgc3RydWN0dXJlcy4KLy8gLSBTdGF0ZSBtYWNoaW5lIGltcGxlbWVudGF0aW9uIHdpdGggaW50cmljYXRlIHRyYW5zaXRpb24gbG9naWMuCi8vIC0gQm9vbGVhbiBsb2dpYyBvcHRpbWl6YXRpb24gYW5kIHNob3J0LWNpcmN1aXRpbmcgYmVoYXZpb3IuCi8vIC0gTG9vcCB1bnJvbGxpbmcgYW5kIGZ1c2lvbiBpbiB0aGUgY29udGV4dCBvZiBzdGF0ZSB1cGRhdGVzLgovLyAtIEVmZmljaWVudCBoYW5kbGluZyBvZiBtdWx0aS1kaW1lbnNpb25hbCBhcnJheXMgZm9yIHN0b3Jpbmcgc3RhdGUgdGFibGVzLgovLyAtIEJyYW5jaCBwcmVkaWN0aW9uIGFjY3VyYWN5IGZvciBpcnJlZ3VsYXIsIGRhdGEtZHJpdmVuIGNvbnRyb2wgZmxvdy4KLy8gLSBDb3JyZWN0IGhhbmRsaW5nIG9mIHZhcmlhYmxlIHNoYWRvd2luZyBhbmQgbXV0YWJpbGl0eSBpbiBuZXN0ZWQgc2NvcGVzLgoKY29uc3QgU1RBVEVfQTogdXNpemUgPSAwOwpjb25zdCBTVEFURV9COiB1c2l6ZSA9IDE7CmNvbnN0IFNUQVRFX0M6IHVzaXplID0gMjsKY29uc3QgU1RBVEVfRDogdXNpemUgPSAzOwpjb25zdCBTVEFURV9FOiB1c2l6ZSA9IDQ7CmNvbnN0IFNUQVRFX0Y6IHVzaXplID0gNTsKY29uc3QgU1RBVEVfRzogdXNpemUgPSA2Owpjb25zdCBTVEFURV9IOiB1c2l6ZSA9IDc7Cgpjb25zdCBJTlBVVF9YOiB1c2l6ZSA9IDA7CmNvbnN0IElOUFVUX1k6IHVzaXplID0gMTsKY29uc3QgSU5QVVRfWjogdXNpemUgPSAyOwpjb25zdCBOVU1fSU5QVVRTOiBpMzIgPSAzOwoKZm4gc2V0dXBfZnNtKHRyYW5zaXRpb25fdGFibGU6ICZtdXQgW1t1c2l6ZTsgM107IDhdLCBvdXRwdXRfdGFibGU6ICZtdXQgW1tpMzI7IDNdOyA4XSkgewogICAgdHJhbnNpdGlvbl90YWJsZVtTVEFURV9BXVtJTlBVVF9YXSA9IFNUQVRFX0I7CiAgICB0cmFuc2l0aW9uX3RhYmxlW1NUQVRFX0FdW0lOUFVUX1ldID0gU1RBVEVfQzsKICAgIHRyYW5zaXRpb25fdGFibGVbU1RBVEVfQV1bSU5QVVRfWl0gPSBTVEFURV9BOwogICAgb3V0cHV0X3RhYmxlW1NUQVRFX0FdW0lOUFVUX1hdID0gMTsKICAgIG91dHB1dF90YWJsZVtTVEFURV9BXVtJTlBVVF9ZXSA9IDA7CiAgICBvdXRwdXRfdGFibGVbU1RBVEVfQV1bSU5QVVRfWl0gPSAtMTsKCiAgICB0cmFuc2l0aW9uX3RhYmxlW1NUQVRFX0JdW0lOUFVUX1hdID0gU1RBVEVfRDsKICAgIHRyYW5zaXRpb25fdGFibGVbU1RBVEVfQl1bSU5QVVRfWV0gPSBTVEFURV9FOwogICAgdHJhbnNpdGlvbl90YWJsZVtTVEFURV9CXVtJTlBVVF9aXSA9IFNUQVRFX0E7CiAgICBvdXRwdXRfdGFibGVbU1RBVEVfQl1bSU5QVVRfWF0gPSAyOwogICAgb3V0cHV0X3RhYmxlW1NUQVRFX0JdW0lOUFVUX1ldID0gMzsKICAgIG91dHB1dF90YWJsZVtTVEFURV9CXVtJTlBVVF9aXSA9IDA7CgogICAgdHJhbnNpdGlvbl90YWJsZVtTVEFURV9DXVtJTlBVVF9YXSA9IFNUQVRFX0Y7CiAgICB0cmFuc2l0aW9uX3RhYmxlW1NUQVRFX0NdW0lOUFVUX1ldID0gU1RBVEVfRzsKICAgIHRyYW5zaXRpb25fdGFibGVbU1RBVEVfQ11bSU5QVVRfWl0gPSBTVEFURV9COwogICAgb3V0cHV0X3RhYmxlW1NUQVRFX0NdW0lOUFVUX1hdID0gNTsKICAgIG91dHB1dF90YWJsZVtTVEFURV9DXVtJTlBVVF9ZXSA9IDg7CiAgICBvdXRwdXRfdGFibGVbU1RBVEVfQ11bSU5QVVRfWl0gPSAxMzsKCiAgICB0cmFuc2l0aW9uX3RhYmxlW1NUQVRFX0RdW0lOUFVUX1hdID0gU1RBVEVfSDsKICAgIHRyYW5zaXRpb25fdGFibGVbU1RBVEVfRF1bSU5QVVRfWV0gPSBTVEFURV9BOwogICAgdHJhbnNpdGlvbl90YWJsZVtTVEFURV9EXVtJTlBVVF9aXSA9IFNUQVRFX0I7CiAgICBvdXRwdXRfdGFibGVbU1RBVEVfRF1bSU5QVVRfWF0gPSAyMTsKICAgIG91dHB1dF90YWJsZVtTVEFURV9EXVtJTlBVVF9ZXSA9IDM0OwogICAgb3V0cHV0X3RhYmxlW1NUQVRFX0RdW0lOUFVUX1pdID0gNTU7CgogICAgdHJhbnNpdGlvbl90YWJsZVtTVEFURV9FXVtJTlBVVF9YXSA9IFNUQVRFX0M7CiAgICB0cmFuc2l0aW9uX3RhYmxlW1NUQVRFX0VdW0lOUFVUX1ldID0gU1RBVEVfRjsKICAgIHRyYW5zaXRpb25fdGFibGVbU1RBVEVfRV1bSU5QVVRfWl0gPSBTVEFURV9FOwogICAgb3V0cHV0X3RhYmxlW1NUQVRFX0VdW0lOUFVUX1hdID0gLTE7CiAgICBvdXRwdXRfdGFibGVbU1RBVEVfRV1bSU5QVVRfWV0gPSAtMjsKICAgIG91dHB1dF90YWJsZVtTVEFURV9FXVtJTlBVVF9aXSA9IC0zOwoKICAgIHRyYW5zaXRpb25fdGFibGVbU1RBVEVfRl1bSU5QVVRfWF0gPSBTVEFURV9HOwogICAgdHJhbnNpdGlvbl90YWJsZVtTVEFURV9GXVtJTlBVVF9ZXSA9IFNUQVRFX0g7CiAgICB0cmFuc2l0aW9uX3RhYmxlW1NUQVRFX0ZdW0lOUFVUX1pdID0gU1RBVEVfRDsKICAgIG91dHB1dF90YWJsZVtTVEFURV9GXVtJTlBVVF9YXSA9IDEwOwogICAgb3V0cHV0X3RhYmxlW1NUQVRFX0ZdW0lOUFVUX1ldID0gMjA7CiAgICBvdXRwdXRfdGFibGVbU1RBVEVfRl1bSU5QVVRfWl0gPSAzMDsKCiAgICB0cmFuc2l0aW9uX3RhYmxlW1NUQVRFX0ddW0lOUFVUX1hdID0gU1RBVEVfQTsKICAgIHRyYW5zaXRpb25fdGFibGVbU1RBVEVfR11bSU5QVVRfWV0gPSBTVEFURV9COwogICAgdHJhbnNpdGlvbl90YWJsZVtTVEFURV9HXVtJTlBVVF9aXSA9IFNUQVRFX0M7CiAgICBvdXRwdXRfdGFibGVbU1RBVEVfR11bSU5QVVRfWF0gPSA0MDsKICAgIG91dHB1dF90YWJsZVtTVEFURV9HXVtJTlBVVF9ZXSA9IDUwOwogICAgb3V0cHV0X3RhYmxlW1NUQVRFX0ddW0lOUFVUX1pdID0gNjA7CgogICAgdHJhbnNpdGlvbl90YWJsZVtTVEFURV9IXVtJTlBVVF9YXSA9IFNUQVRFX0U7CiAgICB0cmFuc2l0aW9uX3RhYmxlW1NUQVRFX0hdW0lOUFVUX1ldID0gU1RBVEVfRDsKICAgIHRyYW5zaXRpb25fdGFibGVbU1RBVEVfSF1bSU5QVVRfWl0gPSBTVEFURV9GOwogICAgb3V0cHV0X3RhYmxlW1NUQVRFX0hdW0lOUFVUX1hdID0gNzA7CiAgICBvdXRwdXRfdGFibGVbU1RBVEVfSF1bSU5QVVRfWV0gPSA4MDsKICAgIG91dHB1dF90YWJsZVtTVEFURV9IXVtJTlBVVF9aXSA9IDkwOwp9CgpmbiBydW5fZnNtKAogICAgdHJhbnNpdGlvbl90YWJsZTogJm11dCBbW3VzaXplOyAzXTsgOF0sCiAgICBvdXRwdXRfdGFibGU6ICZtdXQgW1tpMzI7IDNdOyA4XSwKICAgIGlucHV0czogW2kzMjsgMTAwXSwKICAgIGxlbjogdXNpemUsCikgLT4gaTMyIHsKICAgIGxldCBtdXQgY3VycmVudF9zdGF0ZTogdXNpemUgPSBTVEFURV9BOwogICAgbGV0IG11dCBhY2N1bXVsYXRlZF9vdXRwdXQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKCiAgICB3aGlsZSAoaSA8IGxlbikgewogICAgICAgIGxldCBpbnB1dDogaTMyID0gaW5wdXRzW2kgYXMgdXNpemVdOwogICAgICAgIGlmIChpbnB1dCA+PSAwKSB7CiAgICAgICAgICAgIGlmIChpbnB1dCA8IE5VTV9JTlBVVFMpIHsKICAgICAgICAgICAgICAgIGxldCBvdXRwdXQ6IGkzMiA9IG91dHB1dF90YWJsZVtjdXJyZW50X3N0YXRlIGFzIHVzaXplXVtpbnB1dCBhcyB1c2l6ZV07CiAgICAgICAgICAgICAgICBsZXQgbmV4dF9zdGF0ZTogdXNpemUgPSB0cmFuc2l0aW9uX3RhYmxlW2N1cnJlbnRfc3RhdGUgYXMgdXNpemVdW2lucHV0IGFzIHVzaXplXTsKCiAgICAgICAgICAgICAgICBpZiAob3V0cHV0ID4gMCkgewogICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50X3N0YXRlICUgMiA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGVkX291dHB1dCA9IGFjY3VtdWxhdGVkX291dHB1dCArIG91dHB1dCAqIDI7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZWRfb3V0cHV0ID0gYWNjdW11bGF0ZWRfb3V0cHV0ICsgb3V0cHV0OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGFjY3VtdWxhdGVkX291dHB1dCA+IDEwMCkgewogICAgICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlZF9vdXRwdXQgPSBhY2N1bXVsYXRlZF9vdXRwdXQgKyBvdXRwdXQ7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZWRfb3V0cHV0ID0gYWNjdW11bGF0ZWRfb3V0cHV0IC0gb3V0cHV0OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgICAgICAgICBsZXQgbXV0IHRlbXBfY2FsYzogaTMyID0gMDsKICAgICAgICAgICAgICAgIHdoaWxlIChqIDwgb3V0cHV0ICUgMTApIHsKICAgICAgICAgICAgICAgICAgICBpZiAoaiAlIDIgPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICB0ZW1wX2NhbGMgPSB0ZW1wX2NhbGMgKyBqOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBfY2FsYyA9IHRlbXBfY2FsYyAtIGo7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGFjY3VtdWxhdGVkX291dHB1dCA9IGFjY3VtdWxhdGVkX291dHB1dCArIHRlbXBfY2FsYzsKCiAgICAgICAgICAgICAgICBjdXJyZW50X3N0YXRlID0gbmV4dF9zdGF0ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICByZXR1cm4gYWNjdW11bGF0ZWRfb3V0cHV0Owp9CgpmbiBnZW5lcmF0ZV9pbnB1dHMoc2VlZDogaTMyLCBsZW46IGkzMikgLT4gW2kzMjsgMTAwXSB7CiAgICBsZXQgbXV0IGlucHV0czogW2kzMjsgMTAwXSA9IFswOyAxMDBdOwogICAgbGV0IG11dCBjdXJyZW50X3ZhbDogaTMyID0gc2VlZDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgbGVuKSB7CiAgICAgICAgY3VycmVudF92YWwgPSBwbV9yYW5kX3VwZGF0ZShjdXJyZW50X3ZhbCkgLyA2NTUzNjsKICAgICAgICBpbnB1dHNbaSBhcyB1c2l6ZV0gPSBjdXJyZW50X3ZhbCAlIE5VTV9JTlBVVFM7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcmV0dXJuIGlucHV0czsKfQoKZm4gbWFpbigpIHsKICAgIGxldCBtdXQgdHJhbnNpdGlvbl90YWJsZTogW1t1c2l6ZTsgM107IDhdID0gW1swOyAzXTsgOF07CiAgICBsZXQgbXV0IG91dHB1dF90YWJsZTogW1tpMzI7IDNdOyA4XSA9IFtbMDsgM107IDhdOwogICAgc2V0dXBfZnNtKCZtdXQgdHJhbnNpdGlvbl90YWJsZSwgJm11dCBvdXRwdXRfdGFibGUpOwoKICAgIGxldCBpbnB1dHMxOiBbaTMyOyAxMDBdID0gZ2VuZXJhdGVfaW5wdXRzKDQyLCAxMDApOwogICAgbGV0IHJlc3VsdDE6IGkzMiA9IHJ1bl9mc20oJm11dCB0cmFuc2l0aW9uX3RhYmxlLCAmbXV0IG91dHB1dF90YWJsZSwgaW5wdXRzMSwgMTAwKTsKICAgIHByaW50bG5JbnQocmVzdWx0MSk7CgogICAgbGV0IGlucHV0czI6IFtpMzI7IDEwMF0gPSBnZW5lcmF0ZV9pbnB1dHMoMTMzNywgODApOwogICAgbGV0IHJlc3VsdDI6IGkzMiA9IHJ1bl9mc20oJm11dCB0cmFuc2l0aW9uX3RhYmxlLCAmbXV0IG91dHB1dF90YWJsZSwgaW5wdXRzMiwgODApOwogICAgcHJpbnRsbkludChyZXN1bHQyKTsKCiAgICBsZXQgbXV0IGN1c3RvbV9pbnB1dHM6IFtpMzI7IDEwMF0gPSBbMDsgMTAwXTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgNTApIHsKICAgICAgICBjdXN0b21faW5wdXRzW2kgYXMgdXNpemVdID0gKGkgKiBpKSAlIE5VTV9JTlBVVFM7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgbGV0IHJlc3VsdDM6IGkzMiA9IHJ1bl9mc20oJm11dCB0cmFuc2l0aW9uX3RhYmxlLCAmbXV0IG91dHB1dF90YWJsZSwgY3VzdG9tX2lucHV0cywgNTApOwogICAgcHJpbnRsbkludChyZXN1bHQzKTsKCiAgICBsZXQgbXV0IGNvdW50ZXI6IGkzMiA9IDA7CiAgICBsZXQgbXV0IG91dGVyX2xvb3A6IGkzMiA9IDA7CiAgICB3aGlsZSAob3V0ZXJfbG9vcCA8IDEwKSB7CiAgICAgICAgbGV0IG11dCBpbm5lcl9sb29wOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpbm5lcl9sb29wIDwgMTApIHsKICAgICAgICAgICAgaWYgKG91dGVyX2xvb3AgJSAyID09IDApIHsKICAgICAgICAgICAgICAgIGlmIChpbm5lcl9sb29wICUgMyA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgY291bnRlciA9IGNvdW50ZXIgKyAxOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjb3VudGVyID0gY291bnRlciAtIDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoaW5uZXJfbG9vcCAlIDIgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGNvdW50ZXIgPSBjb3VudGVyICsgMjsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY291bnRlciA9IGNvdW50ZXIgLSAyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlubmVyX2xvb3AgPSBpbm5lcl9sb29wICsgMTsKICAgICAgICB9CiAgICAgICAgb3V0ZXJfbG9vcCA9IG91dGVyX2xvb3AgKyAxOwogICAgfQogICAgcHJpbnRsbkludChjb3VudGVyKTsKCiAgICBsZXQgbXV0IGE6IGkzMiA9IDEwOwogICAgbGV0IG11dCBiOiBpMzIgPSAyMDsKICAgIGxldCBtdXQgYzogaTMyID0gMzA7CgogICAgaWYgKGEgPiBiKSB7CiAgICAgICAgaWYgKGIgPiBjKSB7CiAgICAgICAgICAgIHByaW50bG5JbnQoMSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHJpbnRsbkludCgyKTsKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgIGlmIChiIDwgYykgewogICAgICAgICAgICBpZiAoYSA8IGMpIHsKICAgICAgICAgICAgICAgIHByaW50bG5JbnQoMyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBwcmludGxuSW50KDQpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHJpbnRsbkludCg1KTsKICAgICAgICB9CiAgICB9CgogICAgbGV0IG11dCB4OiBpMzIgPSAwOwogICAgbGV0IG11dCB5OiBpMzIgPSAwOwogICAgbGV0IG11dCB6OiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAxMDApIHsKICAgICAgICBsZXQgc2VsOiBpMzIgPSBpICUgNjsKICAgICAgICBpZiAoc2VsID09IDApIHsKICAgICAgICAgICAgeCA9IHggKyAxOwogICAgICAgIH0gZWxzZSBpZiAoc2VsID09IDEpIHsKICAgICAgICAgICAgeCA9IHggLSAxOwogICAgICAgIH0gZWxzZSBpZiAoc2VsID09IDIpIHsKICAgICAgICAgICAgeSA9IHkgKyB4OwogICAgICAgIH0gZWxzZSBpZiAoc2VsID09IDMpIHsKICAgICAgICAgICAgeSA9IHkgLSB4OwogICAgICAgIH0gZWxzZSBpZiAoc2VsID09IDQpIHsKICAgICAgICAgICAgeiA9IHogKyB5OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHogPSB6IC0geTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcHJpbnRsbkludCh4KTsKICAgIHByaW50bG5JbnQoeSk7CiAgICBwcmludGxuSW50KHopOwoKICAgIGxldCBtdXQgc2hhZG93OiBpMzIgPSAxMDA7CiAgICBpZiAoc2hhZG93ID4gNTApIHsKICAgICAgICBsZXQgbXV0IHNoYWRvdzogaTMyID0gMjAwOwogICAgICAgIGlmIChzaGFkb3cgPiAxNTApIHsKICAgICAgICAgICAgbGV0IG11dCBzaGFkb3c6IGkzMiA9IDMwMDsKICAgICAgICAgICAgc2hhZG93ID0gc2hhZG93ICsgMTsKICAgICAgICAgICAgcHJpbnRsbkludChzaGFkb3cpOwogICAgICAgIH0KICAgICAgICBzaGFkb3cgPSBzaGFkb3cgKyAxOwogICAgICAgIHByaW50bG5JbnQoc2hhZG93KTsKICAgIH0KICAgIHNoYWRvdyA9IHNoYWRvdyArIDE7CiAgICBwcmludGxuSW50KHNoYWRvdyk7CgogICAgbGV0IG11dCBrOiBpMzIgPSAwOwogICAgd2hpbGUgKGsgPCAxKSB7CiAgICAgICAgbGV0IG11dCBsb29wX3ZhcjogaTMyID0gMTIzOwogICAgICAgIGxvb3BfdmFyID0gbG9vcF92YXIgKyAxOwogICAgICAgIGsgPSBrICsgMTsKICAgIH0KCiAgICBsZXQgbXV0IG06IGkzMiA9IDA7CiAgICB3aGlsZSAobSA8IDIpIHsKICAgICAgICBsZXQgbXV0IGFub3RoZXJfbG9vcF92YXI6IGkzMiA9IDQ1NjsKICAgICAgICBpZiAobSA9PSAwKSB7CiAgICAgICAgICAgIGxldCBtdXQgYW5vdGhlcl9sb29wX3ZhcjogaTMyID0gNzg5OwogICAgICAgICAgICBhbm90aGVyX2xvb3BfdmFyID0gYW5vdGhlcl9sb29wX3ZhciArIDE7CiAgICAgICAgICAgIHByaW50bG5JbnQoYW5vdGhlcl9sb29wX3Zhcik7CiAgICAgICAgfQogICAgICAgIHByaW50bG5JbnQoYW5vdGhlcl9sb29wX3Zhcik7CiAgICAgICAgbSA9IG0gKyAxOwogICAgfQoKICAgIGxldCBtdXQgZmluYWxfdmFsOiBpMzIgPSAwOwogICAgbGV0IG11dCBwOiBpMzIgPSAwOwogICAgd2hpbGUgKHAgPCAxMCkgewogICAgICAgIGxldCBtdXQgdGVtcDogaTMyID0gcCAqIHA7CiAgICAgICAgaWYgKHAgJSAyID09IDApIHsKICAgICAgICAgICAgbGV0IG11dCB0ZW1wOiBpMzIgPSBwICogMjsKICAgICAgICAgICAgZmluYWxfdmFsID0gZmluYWxfdmFsICsgdGVtcDsKICAgICAgICB9CiAgICAgICAgZmluYWxfdmFsID0gZmluYWxfdmFsICsgdGVtcDsKICAgICAgICBwID0gcCArIDE7CiAgICB9CiAgICBwcmludGxuSW50KGZpbmFsX3ZhbCk7CiAgICBleGl0KDApOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (40, "comprehensive40", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IExhcmdlLVNjYWxlIEFycmF5IGFuZCBNYXRyaXggQ29tcHV0YXRpb25zClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpNdWx0aS1kaW1lbnNpb25hbCBhcnJheSBhY2Nlc3MgcGF0dGVybnMgYW5kIGFkZHJlc3MgY2FsY3VsYXRpb24uCkxvb3AgaW50ZXJjaGFuZ2UsIGZ1c2lvbiwgYW5kIHRpbGluZyBmb3IgaW1wcm92ZWQgY2FjaGUgcGVyZm9ybWFuY2UuClN0cmVuZ3RoIHJlZHVjdGlvbiBhbmQgaW5kdWN0aW9uIHZhcmlhYmxlIGFuYWx5c2lzIGluIG5lc3RlZCBsb29wcy4KVmVjdG9yaXphdGlvbiBvZiBhcml0aG1ldGljIG9wZXJhdGlvbnMgb24gYXJyYXkgZWxlbWVudHMgKGlmIChhcHBsaWNhYmxlKS4pCkNvbXBsZXggZGF0YSBkZXBlbmRlbmNpZXMgYW5kIHRoZWlyIGltcGFjdCBvbiBsb29wIHBhcmFsbGVsaXphdGlvbi4KQnJhbmNoIHByZWRpY3Rpb24gd2l0aGluIGxvb3AgYm9kaWVzIGZvciBkYXRhLWRlcGVuZGVudCBvcGVyYXRpb25zLgpDb3JyZWN0IGhhbmRsaW5nIG9mIGFycmF5IGJvdW5kcyBhbmQgbWVtb3J5IGFjY2Vzcy4KKi8KCi8vIGNvbXByZWhlbnNpdmU0MC5yeCAtIExhcmdlLVNjYWxlIEFycmF5IGFuZCBNYXRyaXggQ29tcHV0YXRpb25zCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIE11bHRpLWRpbWVuc2lvbmFsIGFycmF5IGFjY2VzcyBwYXR0ZXJucyBhbmQgYWRkcmVzcyBjYWxjdWxhdGlvbi4KLy8gLSBMb29wIGludGVyY2hhbmdlLCBmdXNpb24sIGFuZCB0aWxpbmcgZm9yIGltcHJvdmVkIGNhY2hlIHBlcmZvcm1hbmNlLgovLyAtIFN0cmVuZ3RoIHJlZHVjdGlvbiBhbmQgaW5kdWN0aW9uIHZhcmlhYmxlIGFuYWx5c2lzIGluIG5lc3RlZCBsb29wcy4KLy8gLSBWZWN0b3JpemF0aW9uIG9mIGFyaXRobWV0aWMgb3BlcmF0aW9ucyBvbiBhcnJheSBlbGVtZW50cyAoaWYgYXBwbGljYWJsZSkuCi8vIC0gQ29tcGxleCBkYXRhIGRlcGVuZGVuY2llcyBhbmQgdGhlaXIgaW1wYWN0IG9uIGxvb3AgcGFyYWxsZWxpemF0aW9uLgovLyAtIEJyYW5jaCBwcmVkaWN0aW9uIHdpdGhpbiBsb29wIGJvZGllcyBmb3IgZGF0YS1kZXBlbmRlbnQgb3BlcmF0aW9ucy4KLy8gLSBDb3JyZWN0IGhhbmRsaW5nIG9mIGFycmF5IGJvdW5kcyBhbmQgbWVtb3J5IGFjY2Vzcy4KCmNvbnN0IFNJWkU6IGkzMiA9IDQwOwpjb25zdCBIQUxGX1NJWkU6IGkzMiA9IDIwOwoKZm4gaW5pdF9tYXRyaXgobWF0OiBbW2kzMjsgNDBdOyA0MF0sIHNlZWQ6IGkzMikgLT4gW1tpMzI7IDQwXTsgNDBdIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIGxldCBtdXQgbmV3X21hdDogW1tpMzI7IDQwXTsgNDBdID0gbWF0OwogICAgd2hpbGUgKGkgPCBTSVpFKSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgU0laRSkgewogICAgICAgICAgICBuZXdfbWF0W2kgYXMgdXNpemVdW2ogYXMgdXNpemVdID0gKGkgKiBTSVpFICsgaiArIHNlZWQpICUgMTAwOwogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJldHVybiBuZXdfbWF0Owp9CgpmbiBtYXRyaXhfbXVsdGlwbHkoYTogW1tpMzI7IDQwXTsgNDBdLCBiOiBbW2kzMjsgNDBdOyA0MF0pIC0+IFtbaTMyOyA0MF07IDQwXSB7CiAgICBsZXQgbXV0IHJlc3VsdDogW1tpMzI7IDQwXTsgNDBdID0gW1swOyA0MF07IDQwXTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgU0laRSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaiA8IFNJWkUpIHsKICAgICAgICAgICAgLy8gVXNlIHUzMiBmb3IgaW50ZXJtZWRpYXRlIG11bHRpcGx5LWFkZCB0byBlbXVsYXRlIHR3bydzLWNvbXBsZW1lbnQgd3JhcHBpbmcKICAgICAgICAgICAgLy8gd2l0aG91dCBjaGFuZ2luZyB0aGUgYXJyYXkgZWxlbWVudCB0eXBlcyAoc3RpbGwgaTMyKS4gVGhpcyBhdm9pZHMgcGFuaWMKICAgICAgICAgICAgLy8gZnJvbSBzaWduZWQgb3ZlcmZsb3cgaW4gZGVidWcgd2hpbGUgcHJlc2VydmluZyBiaXR3aXNlIHdyYXBwaW5nIHNlbWFudGljcy4KICAgICAgICAgICAgbGV0IG11dCBzdW1fdTogdTMyID0gMHUzMjsKICAgICAgICAgICAgbGV0IG11dCBrOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoayA8IFNJWkUpIHsKICAgICAgICAgICAgICAgIGxldCBhX3U6IHUzMiA9IGFbaSBhcyB1c2l6ZV1bayBhcyB1c2l6ZV0gYXMgdTMyOwogICAgICAgICAgICAgICAgbGV0IGJfdTogdTMyID0gYltrIGFzIHVzaXplXVtqIGFzIHVzaXplXSBhcyB1MzI7CiAgICAgICAgICAgICAgICBzdW1fdSA9IHN1bV91ICsgKGFfdSAqIGJfdSk7CiAgICAgICAgICAgICAgICBrID0gayArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVzdWx0W2kgYXMgdXNpemVdW2ogYXMgdXNpemVdID0gc3VtX3UgYXMgaTMyOwogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7Cn0KCmZuIGFwcGx5X3N0ZW5jaWwobWF0OiBbW2kzMjsgNDBdOyA0MF0pIC0+IFtbaTMyOyA0MF07IDQwXSB7CiAgICBsZXQgbXV0IHJlc3VsdDogW1tpMzI7IDQwXTsgNDBdID0gW1swOyA0MF07IDQwXTsKICAgIGxldCBtdXQgaTogaTMyID0gMTsKICAgIHdoaWxlIChpIDwgU0laRSAtIDEpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDE7CiAgICAgICAgd2hpbGUgKGogPCBTSVpFIC0gMSkgewogICAgICAgICAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgICAgICAgICAgc3VtID0gc3VtICsgbWF0W2kgYXMgdXNpemUtMV1baiBhcyB1c2l6ZS0xXTsKICAgICAgICAgICAgc3VtID0gc3VtICsgbWF0W2kgYXMgdXNpemUtMV1baiBhcyB1c2l6ZV07CiAgICAgICAgICAgIHN1bSA9IHN1bSArIG1hdFtpIGFzIHVzaXplLTFdW2ogYXMgdXNpemUrMV07CiAgICAgICAgICAgIHN1bSA9IHN1bSArIG1hdFtpIGFzIHVzaXplXVtqIGFzIHVzaXplLTFdOwogICAgICAgICAgICBzdW0gPSBzdW0gKyBtYXRbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gKiAtODsKICAgICAgICAgICAgc3VtID0gc3VtICsgbWF0W2kgYXMgdXNpemVdW2ogYXMgdXNpemUrMV07CiAgICAgICAgICAgIHN1bSA9IHN1bSArIG1hdFtpIGFzIHVzaXplKzFdW2ogYXMgdXNpemUtMV07CiAgICAgICAgICAgIHN1bSA9IHN1bSArIG1hdFtpIGFzIHVzaXplKzFdW2ogYXMgdXNpemVdOwogICAgICAgICAgICBzdW0gPSBzdW0gKyBtYXRbaSBhcyB1c2l6ZSsxXVtqIGFzIHVzaXplKzFdOwogICAgICAgICAgICByZXN1bHRbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV0gPSBzdW0gLyAzOwogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7Cn0KCmZuIHRyYW5zcG9zZV9hbmRfYWRkKG1hdDogW1tpMzI7IDQwXTsgNDBdKSAtPiBbW2kzMjsgNDBdOyA0MF0gewogICAgbGV0IG11dCByZXN1bHQ6IFtbaTMyOyA0MF07IDQwXSA9IG1hdDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgU0laRSkgewogICAgICAgIGxldCBtdXQgajogaTMyID0gaTsKICAgICAgICB3aGlsZSAoaiA8IFNJWkUpIHsKICAgICAgICAgICAgbGV0IHRlbXA6IGkzMiA9IHJlc3VsdFtpIGFzIHVzaXplXVtqIGFzIHVzaXplXTsKICAgICAgICAgICAgcmVzdWx0W2kgYXMgdXNpemVdW2ogYXMgdXNpemVdID0gcmVzdWx0W2ogYXMgdXNpemVdW2kgYXMgdXNpemVdICsgdGVtcDsKICAgICAgICAgICAgcmVzdWx0W2ogYXMgdXNpemVdW2kgYXMgdXNpemVdID0gdGVtcCArIHJlc3VsdFtqIGFzIHVzaXplXVtpIGFzIHVzaXplXTsKICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0Owp9CgpmbiBzdWJfbWF0cml4X3N1bShtYXQ6IFtbaTMyOyA0MF07IDQwXSkgLT4gaTMyIHsKICAgIGxldCBtdXQgdG90YWxfc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBIQUxGX1NJWkUpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGogPCBIQUxGX1NJWkUpIHsKICAgICAgICAgICAgdG90YWxfc3VtID0gdG90YWxfc3VtICsgbWF0W2kgYXMgdXNpemVdW2ogYXMgdXNpemVdOwogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIGkgPSBIQUxGX1NJWkU7CiAgICB3aGlsZSAoaSA8IFNJWkUpIHsKICAgICAgICBsZXQgbXV0IGo6IGkzMiA9IEhBTEZfU0laRTsKICAgICAgICB3aGlsZSAoaiA8IFNJWkUpIHsKICAgICAgICAgICAgdG90YWxfc3VtID0gdG90YWxfc3VtICsgbWF0W2kgYXMgdXNpemVdW2ogYXMgdXNpemVdOwogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJldHVybiB0b3RhbF9zdW07Cn0KCmZuIGRpYWdvbmFsX3Byb2Nlc3NpbmcobWF0OiBbW2kzMjsgNDBdOyA0MF0pIC0+IGkzMiB7CiAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gMDsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgU0laRSkgewogICAgICAgIGlmIChtYXRbaSBhcyB1c2l6ZV1baSBhcyB1c2l6ZV0gPiA1MCkgewogICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgKyBtYXRbaSBhcyB1c2l6ZV1bKFNJWkUgLSAxIC0gaSkgYXMgdXNpemVdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCAtIG1hdFtpIGFzIHVzaXplXVtpIGFzIHVzaXplXTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKfQoKZm4gbWFpbigpIHsKICAgIGxldCBtdXQgbWF0cml4X2E6IFtbaTMyOyA0MF07IDQwXSA9IFtbMDsgNDBdOyA0MF07CiAgICBsZXQgbXV0IG1hdHJpeF9iOiBbW2kzMjsgNDBdOyA0MF0gPSBbWzA7IDQwXTsgNDBdOwoKICAgIG1hdHJpeF9hID0gaW5pdF9tYXRyaXgobWF0cml4X2EsIDEyMyk7CiAgICBtYXRyaXhfYiA9IGluaXRfbWF0cml4KG1hdHJpeF9iLCA0NTYpOwoKICAgIGxldCBtdXQgbWF0cml4X2M6IFtbaTMyOyA0MF07IDQwXSA9IG1hdHJpeF9tdWx0aXBseShtYXRyaXhfYSwgbWF0cml4X2IpOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgNSkgewogICAgICAgIG1hdHJpeF9jID0gYXBwbHlfc3RlbmNpbChtYXRyaXhfYyk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGxldCBzdW0xOiBpMzIgPSBzdWJfbWF0cml4X3N1bShtYXRyaXhfYyk7CiAgICBwcmludGxuSW50KHN1bTEpOwoKICAgIGxldCBkaWFnX3JlczE6IGkzMiA9IGRpYWdvbmFsX3Byb2Nlc3NpbmcobWF0cml4X2MpOwogICAgcHJpbnRsbkludChkaWFnX3JlczEpOwoKICAgIGxldCBtdXQgbWF0cml4X2Q6IFtbaTMyOyA0MF07IDQwXSA9IHRyYW5zcG9zZV9hbmRfYWRkKG1hdHJpeF9jKTsKCiAgICBsZXQgc3VtMjogaTMyID0gc3ViX21hdHJpeF9zdW0obWF0cml4X2QpOwogICAgcHJpbnRsbkludChzdW0yKTsKCiAgICBsZXQgZGlhZ19yZXMyOiBpMzIgPSBkaWFnb25hbF9wcm9jZXNzaW5nKG1hdHJpeF9kKTsKICAgIHByaW50bG5JbnQoZGlhZ19yZXMyKTsKCiAgICBsZXQgbXV0IG1hdHJpeF9lOiBbW2kzMjsgNDBdOyA0MF0gPSBtYXRyaXhfbXVsdGlwbHkobWF0cml4X2QsIG1hdHJpeF9hKTsKCiAgICBsZXQgc3VtMzogaTMyID0gc3ViX21hdHJpeF9zdW0obWF0cml4X2UpOwogICAgcHJpbnRsbkludChzdW0zKTsKCiAgICBsZXQgbXV0IGNoZWNrc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgd2hpbGUgKGogPCBTSVpFKSB7CiAgICAgICAgbGV0IG11dCBrOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChrIDwgU0laRSkgewogICAgICAgICAgICBpZiAoKGogKyBrKSAlIDIgPT0gMCkgewogICAgICAgICAgICAgICAgY2hlY2tzdW0gPSBjaGVja3N1bSArIG1hdHJpeF9lW2ogYXMgdXNpemVdW2sgYXMgdXNpemVdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY2hlY2tzdW0gPSBjaGVja3N1bSAtIG1hdHJpeF9lW2ogYXMgdXNpemVdW2sgYXMgdXNpemVdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGsgPSBrICsgMTsKICAgICAgICB9CiAgICAgICAgaiA9IGogKyAxOwogICAgfQogICAgcHJpbnRsbkludChjaGVja3N1bSk7CgogICAgbGV0IG11dCBtOiBpMzIgPSAwOwogICAgd2hpbGUgKG0gPCBTSVpFKSB7CiAgICAgICAgbGV0IG11dCByb3dfbWF4OiBpMzIgPSAtOTk5OTk5OwogICAgICAgIGxldCBtdXQgbjogaTMyID0gMDsKICAgICAgICB3aGlsZSAobiA8IFNJWkUpIHsKICAgICAgICAgICAgaWYgKG1hdHJpeF9lW20gYXMgdXNpemVdW24gYXMgdXNpemVdID4gcm93X21heCkgewogICAgICAgICAgICAgICAgcm93X21heCA9IG1hdHJpeF9lW20gYXMgdXNpemVdW24gYXMgdXNpemVdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG4gPSBuICsgMTsKICAgICAgICB9CiAgICAgICAgcHJpbnRsbkludChyb3dfbWF4KTsKICAgICAgICBtID0gbSArIDE7CiAgICB9CgogICAgbGV0IG11dCBwOiBpMzIgPSAwOwogICAgd2hpbGUgKHAgPCBTSVpFKSB7CiAgICAgICAgbGV0IG11dCBjb2xfbWluOiBpMzIgPSA5OTk5OTk7CiAgICAgICAgbGV0IG11dCBxOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChxIDwgU0laRSkgewogICAgICAgICAgICBpZiAobWF0cml4X2VbcSBhcyB1c2l6ZV1bcCBhcyB1c2l6ZV0gPCBjb2xfbWluKSB7CiAgICAgICAgICAgICAgICBjb2xfbWluID0gbWF0cml4X2VbcSBhcyB1c2l6ZV1bcCBhcyB1c2l6ZV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcSA9IHEgKyAxOwogICAgICAgIH0KICAgICAgICBwcmludGxuSW50KGNvbF9taW4pOwogICAgICAgIHAgPSBwICsgMTsKICAgIH0KCiAgICBsZXQgbXV0IHRlbXBfbWF0OiBbW2kzMjsgNDBdOyA0MF0gPSBtYXRyaXhfYTsKICAgIGxldCBtdXQgcjogaTMyID0gMDsKICAgIHdoaWxlIChyIDwgU0laRSkgewogICAgICAgIGxldCBtdXQgczogaTMyID0gMDsKICAgICAgICB3aGlsZSAocyA8IFNJWkUpIHsKICAgICAgICAgICAgbGV0IHRlbXBfdmFsOiBpMzIgPSB0ZW1wX21hdFtyIGFzIHVzaXplXVtzIGFzIHVzaXplXTsKICAgICAgICAgICAgdGVtcF9tYXRbciBhcyB1c2l6ZV1bcyBhcyB1c2l6ZV0gPSB0ZW1wX21hdFtzIGFzIHVzaXplXVtyIGFzIHVzaXplXTsKICAgICAgICAgICAgdGVtcF9tYXRbcyBhcyB1c2l6ZV1bciBhcyB1c2l6ZV0gPSB0ZW1wX3ZhbDsKICAgICAgICAgICAgcyA9IHMgKyAxOwogICAgICAgIH0KICAgICAgICByID0gciArIDE7CiAgICB9CgogICAgbGV0IG11dCBmaW5hbF9zdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IHQ6IGkzMiA9IDA7CiAgICB3aGlsZSAodCA8IFNJWkUpIHsKICAgICAgICBsZXQgbXV0IHU6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKHUgPCBTSVpFKSB7CiAgICAgICAgICAgIGZpbmFsX3N1bSA9IGZpbmFsX3N1bSArIHRlbXBfbWF0W3QgYXMgdXNpemVdW3UgYXMgdXNpemVdOwogICAgICAgICAgICB1ID0gdSArIDE7CiAgICAgICAgfQogICAgICAgIHQgPSB0ICsgMTsKICAgIH0KICAgIHByaW50bG5JbnQoZmluYWxfc3VtKTsKICAgIGV4aXQoMCk7Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (41, "comprehensive41", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IFNpbXVsYXRpb24gb2YgYSBTaW1wbGUgRmlsZSBTeXN0ZW0KU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6ClNpbXVsYXRpbmcgYSBibG9jay1iYXNlZCBmaWxlIHN5c3RlbSB1c2luZyBhIGxhcmdlIGFycmF5LgpNYW5hZ2luZyBjb21wbGV4LCBpbnRlcmNvbm5lY3RlZCBkYXRhIHN0cnVjdHVyZXMgKGlub2RlcywgZGF0YSBibG9ja3MsIGZyZWUgbGlzdHMpLgpQb2ludGVyLWxpa2UgbG9naWMgdXNpbmcgYXJyYXkgaW5kaWNlcyBmb3IgYmxvY2sgcmVmZXJlbmNlcy4KRGVlcGx5IG5lc3RlZCBsb2dpYyBmb3IgZmlsZSBvcGVyYXRpb25zIChjcmVhdGUsIHdyaXRlLCByZWFkLCBkZWxldGUpLgpPcHRpbWl6YXRpb24gb2YgbG9vcHMgZm9yIHNlYXJjaGluZyBkaXJlY3RvcmllcyBhbmQgYWxsb2NhdGluZyBibG9ja3MuCkhhbmRsaW5nIG9mIGVycm9yIGNvbmRpdGlvbnMgYW5kIHN0YXRlIGNvbnNpc3RlbmN5LgpDb3JyZWN0bmVzcyBvZiB2YXJpYWJsZSBsaWZldGltZXMgYW5kIG11dGFiaWxpdHkgaW4gYSBjb21wbGV4IHNpbXVsYXRpb24uCiovCgovLyBjb21wcmVoZW5zaXZlNDEucnggLSBTaW11bGF0aW9uIG9mIGEgU2ltcGxlIEZpbGUgU3lzdGVtCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIFNpbXVsYXRpbmcgYSBibG9jay1iYXNlZCBmaWxlIHN5c3RlbSB1c2luZyBhIGxhcmdlIGFycmF5LgovLyAtIE1hbmFnaW5nIGNvbXBsZXgsIGludGVyY29ubmVjdGVkIGRhdGEgc3RydWN0dXJlcyAoaW5vZGVzLCBkYXRhIGJsb2NrcywgZnJlZSBsaXN0cykuCi8vIC0gUG9pbnRlci1saWtlIGxvZ2ljIHVzaW5nIGFycmF5IGluZGljZXMgZm9yIGJsb2NrIHJlZmVyZW5jZXMuCi8vIC0gRGVlcGx5IG5lc3RlZCBsb2dpYyBmb3IgZmlsZSBvcGVyYXRpb25zIChjcmVhdGUsIHdyaXRlLCByZWFkLCBkZWxldGUpLgovLyAtIE9wdGltaXphdGlvbiBvZiBsb29wcyBmb3Igc2VhcmNoaW5nIGRpcmVjdG9yaWVzIGFuZCBhbGxvY2F0aW5nIGJsb2Nrcy4KLy8gLSBIYW5kbGluZyBvZiBlcnJvciBjb25kaXRpb25zIGFuZCBzdGF0ZSBjb25zaXN0ZW5jeS4KLy8gLSBDb3JyZWN0bmVzcyBvZiB2YXJpYWJsZSBsaWZldGltZXMgYW5kIG11dGFiaWxpdHkgaW4gYSBjb21wbGV4IHNpbXVsYXRpb24uCgpjb25zdCBCTE9DS19TSVpFOiBpMzIgPSA2NDsKY29uc3QgTlVNX0JMT0NLUzogaTMyID0gMjU2Owpjb25zdCBGU19TSVpFOiBpMzIgPSBCTE9DS19TSVpFICogTlVNX0JMT0NLUzsKY29uc3QgTUFYX0lOT0RFUzogaTMyID0gMTI4Owpjb25zdCBNQVhfRklMRU5BTUVfTEVOOiBpMzIgPSAxNjsKY29uc3QgSU5PREVfU0laRTogaTMyID0gMjQ7CmNvbnN0IFJPT1RfSU5PREVfTlVNOiBpMzIgPSAwOwoKY29uc3QgSU5PREVfVFlQRV9GUkVFOiBpMzIgPSAwOwpjb25zdCBJTk9ERV9UWVBFX0ZJTEU6IGkzMiA9IDE7CmNvbnN0IElOT0RFX1RZUEVfRElSOiBpMzIgPSAyOwoKc3RydWN0IEZTIHsKICAgIGZzX2RhdGE6IFtpMzI7IDE2Mzg0XSwKICAgIGlub2RlX3RhYmxlX3R5cGU6IFtpMzI7IDEyOF0sCiAgICBpbm9kZV90YWJsZV9zaXplOiBbaTMyOyAxMjhdLAogICAgaW5vZGVfdGFibGVfYmxvY2tzOiBbW2kzMjsgNl07IDEyOF0sCiAgICBmcmVlX2Jsb2NrX2JpdG1hcDogW2Jvb2w7IDI1Nl0sCiAgICBmcmVlX2lub2RlX2JpdG1hcDogW2Jvb2w7IDEyOF0sCn0KCmZuIG5ld19mcygpIC0+IEZTIHsKICAgIGxldCBmczogRlMgPSBGUyB7CiAgICAgICAgZnNfZGF0YTogWzA7IDE2Mzg0XSwKICAgICAgICBpbm9kZV90YWJsZV90eXBlOiBbMDsgMTI4XSwKICAgICAgICBpbm9kZV90YWJsZV9zaXplOiBbMDsgMTI4XSwKICAgICAgICBpbm9kZV90YWJsZV9ibG9ja3M6IFtbMDsgNl07IDEyOF0sCiAgICAgICAgZnJlZV9ibG9ja19iaXRtYXA6IFtmYWxzZTsgMjU2XSwKICAgICAgICBmcmVlX2lub2RlX2JpdG1hcDogW2ZhbHNlOyAxMjhdLAogICAgfTsKICAgIHJldHVybiBmczsKfQoKZm4gZnNfZm9ybWF0KGZzOiAmbXV0IEZTKSB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IE5VTV9CTE9DS1MpIHsKICAgICAgICBmcy5mcmVlX2Jsb2NrX2JpdG1hcFtpIGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IE1BWF9JTk9ERVMpIHsKICAgICAgICBmcy5mcmVlX2lub2RlX2JpdG1hcFtpIGFzIHVzaXplXSA9IHRydWU7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQoKICAgIGxldCByb290X2lub2RlOiBpMzIgPSBhbGxvY2F0ZV9pbm9kZShmcyk7CiAgICBsZXQgcm9vdF9ibG9jazogaTMyID0gYWxsb2NhdGVfYmxvY2soZnMpOwogICAgZnMuaW5vZGVfdGFibGVfdHlwZVtyb290X2lub2RlIGFzIHVzaXplXSA9IElOT0RFX1RZUEVfRElSOwogICAgZnMuaW5vZGVfdGFibGVfc2l6ZVtyb290X2lub2RlIGFzIHVzaXplXSA9IDA7CiAgICBmcy5pbm9kZV90YWJsZV9ibG9ja3Nbcm9vdF9pbm9kZSBhcyB1c2l6ZV1bMF0gPSByb290X2Jsb2NrOwp9CgpmbiBhbGxvY2F0ZV9pbm9kZShmczogJm11dCBGUykgLT4gaTMyIHsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgTUFYX0lOT0RFUykgewogICAgICAgIGlmIChmcy5mcmVlX2lub2RlX2JpdG1hcFtpIGFzIHVzaXplXSkgewogICAgICAgICAgICBmcy5mcmVlX2lub2RlX2JpdG1hcFtpIGFzIHVzaXplXSA9IGZhbHNlOwogICAgICAgICAgICBmcy5pbm9kZV90YWJsZV90eXBlW2kgYXMgdXNpemVdID0gSU5PREVfVFlQRV9GUkVFOwogICAgICAgICAgICBmcy5pbm9kZV90YWJsZV9zaXplW2kgYXMgdXNpemVdID0gMDsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IDYpIHsKICAgICAgICAgICAgICAgIGZzLmlub2RlX3RhYmxlX2Jsb2Nrc1tpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9IDA7CiAgICAgICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJldHVybiAtMTsKfQoKZm4gYWxsb2NhdGVfYmxvY2soZnM6ICZtdXQgRlMpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IE5VTV9CTE9DS1MpIHsKICAgICAgICBpZiAoZnMuZnJlZV9ibG9ja19iaXRtYXBbaSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgZnMuZnJlZV9ibG9ja19iaXRtYXBbaSBhcyB1c2l6ZV0gPSBmYWxzZTsKICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJldHVybiAtMTsKfQoKZm4gZmluZF9pbl9kaXIoZnM6ICZGUywgZGlyX2lub2RlX251bTogaTMyLCBmaWxlbmFtZTogW2kzMjsgMTZdKSAtPiBpMzIgewogICAgbGV0IGRpcl9zaXplOiBpMzIgPSBmcy5pbm9kZV90YWJsZV9zaXplW2Rpcl9pbm9kZV9udW0gYXMgdXNpemVdOwogICAgbGV0IG51bV9lbnRyaWVzOiBpMzIgPSBkaXJfc2l6ZSAvIElOT0RFX1NJWkU7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IG51bV9lbnRyaWVzKSB7CiAgICAgICAgbGV0IGJsb2NrX2lkeDogaTMyID0gaSAqIElOT0RFX1NJWkUgLyBCTE9DS19TSVpFOwogICAgICAgIGxldCBvZmZzZXRfaW5fYmxvY2s6IGkzMiA9IChpICogSU5PREVfU0laRSkgJSBCTE9DS19TSVpFOwogICAgICAgIGxldCBkYXRhX2Jsb2NrOiBpMzIgPSBmcy5pbm9kZV90YWJsZV9ibG9ja3NbZGlyX2lub2RlX251bSBhcyB1c2l6ZV1bYmxvY2tfaWR4IGFzIHVzaXplXTsKICAgICAgICBsZXQgZW50cnlfYWRkcjogaTMyID0gZGF0YV9ibG9jayAqIEJMT0NLX1NJWkUgKyBvZmZzZXRfaW5fYmxvY2s7CgogICAgICAgIGxldCBtdXQgZmxhZzogYm9vbCA9IHRydWU7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgTUFYX0ZJTEVOQU1FX0xFTikgewogICAgICAgICAgICBpZiAoZnMuZnNfZGF0YVsoZW50cnlfYWRkciArIGopIGFzIHVzaXplXSAhPSBmaWxlbmFtZVtqIGFzIHVzaXplXSkgewogICAgICAgICAgICAgICAgZmxhZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgIH0KICAgICAgICBpZiAoZmxhZykgewogICAgICAgICAgICByZXR1cm4gZnMuZnNfZGF0YVsoZW50cnlfYWRkciArIE1BWF9GSUxFTkFNRV9MRU4pIGFzIHVzaXplXTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcmV0dXJuIC0xOwp9CgpmbiBjcmVhdGVfZmlsZShmczogJm11dCBGUywgcGFyZW50X2Rpcl9pbm9kZTogaTMyLCBmaWxlbmFtZTogW2kzMjsgMTZdKSAtPiBpMzIgewogICAgaWYgKGZpbmRfaW5fZGlyKGZzLCBwYXJlbnRfZGlyX2lub2RlLCBmaWxlbmFtZSkgIT0gLTEpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBsZXQgbmV3X2lub2RlX251bTogaTMyID0gYWxsb2NhdGVfaW5vZGUoZnMpOwogICAgaWYgKG5ld19pbm9kZV9udW0gPT0gLTEpIHsKICAgICAgICByZXR1cm4gLTE7CiAgICB9CiAgICBmcy5pbm9kZV90YWJsZV90eXBlW25ld19pbm9kZV9udW0gYXMgdXNpemVdID0gSU5PREVfVFlQRV9GSUxFOwoKICAgIGxldCBkaXJfc2l6ZTogaTMyID0gZnMuaW5vZGVfdGFibGVfc2l6ZVtwYXJlbnRfZGlyX2lub2RlIGFzIHVzaXplXTsKICAgIGxldCBibG9ja19pZHg6IGkzMiA9IGRpcl9zaXplIC8gQkxPQ0tfU0laRTsKICAgIGxldCBvZmZzZXRfaW5fYmxvY2s6IGkzMiA9IGRpcl9zaXplICUgQkxPQ0tfU0laRTsKICAgIGxldCBkYXRhX2Jsb2NrOiBpMzIgPSBmcy5pbm9kZV90YWJsZV9ibG9ja3NbcGFyZW50X2Rpcl9pbm9kZSBhcyB1c2l6ZV1bYmxvY2tfaWR4IGFzIHVzaXplXTsKICAgIGxldCBlbnRyeV9hZGRyOiBpMzIgPSBkYXRhX2Jsb2NrICogQkxPQ0tfU0laRSArIG9mZnNldF9pbl9ibG9jazsKCiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IE1BWF9GSUxFTkFNRV9MRU4pIHsKICAgICAgICBmcy5mc19kYXRhWyhlbnRyeV9hZGRyICsgaSkgYXMgdXNpemVdID0gZmlsZW5hbWVbaSBhcyB1c2l6ZV07CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgZnMuZnNfZGF0YVsoZW50cnlfYWRkciArIE1BWF9GSUxFTkFNRV9MRU4pIGFzIHVzaXplXSA9IG5ld19pbm9kZV9udW07CiAgICBmcy5pbm9kZV90YWJsZV9zaXplW3BhcmVudF9kaXJfaW5vZGUgYXMgdXNpemVdID0gZGlyX3NpemUgKyBJTk9ERV9TSVpFOwoKICAgIHJldHVybiBuZXdfaW5vZGVfbnVtOwp9CgpmbiB3cml0ZV9maWxlKGZzOiAmbXV0IEZTLCBpbm9kZV9udW06IGkzMiwgZGF0YTogW2kzMjsgMTAwXSwgbGVuOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGJ5dGVzX3dyaXR0ZW46IGkzMiA9IDA7CiAgICBsZXQgbXV0IGRhdGFfcHRyOiBpMzIgPSAwOwogICAgbGV0IG11dCBibG9ja19hbGxvY19jb3VudDogaTMyID0gMDsKICAgIC8vIENsYW1wIHJlcXVlc3RlZCBsZW5ndGggdG8gdGhlIHNpemUgb2YgdGhlIHByb3ZpZGVkIGRhdGEgYnVmZmVyIHRvIGF2b2lkIG91dC1vZi1ib3VuZHMuCiAgICBsZXQgbXV0IG1heF9sZW46IGkzMiA9IGxlbjsKICAgIGlmIChtYXhfbGVuID4gMTAwKSB7CiAgICAgICAgbWF4X2xlbiA9IDEwMDsKICAgIH0KCiAgICB3aGlsZSAoZGF0YV9wdHIgPCBtYXhfbGVuKSB7CiAgICAgICAgbGV0IGJsb2NrX2lkeDogaTMyID0gZnMuaW5vZGVfdGFibGVfc2l6ZVtpbm9kZV9udW0gYXMgdXNpemVdIC8gQkxPQ0tfU0laRTsKICAgICAgICBpZiAoYmxvY2tfaWR4ID49IDYpIHsKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICBsZXQgbXV0IGN1cnJlbnRfYmxvY2s6IGkzMiA9IGZzLmlub2RlX3RhYmxlX2Jsb2Nrc1tpbm9kZV9udW0gYXMgdXNpemVdW2Jsb2NrX2lkeCBhcyB1c2l6ZV07CiAgICAgICAgaWYgKGN1cnJlbnRfYmxvY2sgPT0gMCkgewogICAgICAgICAgICBjdXJyZW50X2Jsb2NrID0gYWxsb2NhdGVfYmxvY2soZnMpOwogICAgICAgICAgICBpZiAoY3VycmVudF9ibG9jayA9PSAtMSkgewogICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZzLmlub2RlX3RhYmxlX2Jsb2Nrc1tpbm9kZV9udW0gYXMgdXNpemVdW2Jsb2NrX2lkeCBhcyB1c2l6ZV0gPSBjdXJyZW50X2Jsb2NrOwogICAgICAgICAgICBibG9ja19hbGxvY19jb3VudCA9IGJsb2NrX2FsbG9jX2NvdW50ICsgMTsKICAgICAgICB9CgogICAgICAgIGxldCBvZmZzZXRfaW5fYmxvY2s6IGkzMiA9IGZzLmlub2RlX3RhYmxlX3NpemVbaW5vZGVfbnVtIGFzIHVzaXplXSAlIEJMT0NLX1NJWkU7CiAgICAgICAgbGV0IHdyaXRlX2FkZHI6IGkzMiA9IGN1cnJlbnRfYmxvY2sgKiBCTE9DS19TSVpFICsgb2Zmc2V0X2luX2Jsb2NrOwogICAgICAgIGZzLmZzX2RhdGFbd3JpdGVfYWRkciBhcyB1c2l6ZV0gPSBkYXRhW2RhdGFfcHRyIGFzIHVzaXplXTsKCiAgICAgICAgZnMuaW5vZGVfdGFibGVfc2l6ZVtpbm9kZV9udW0gYXMgdXNpemVdID0gZnMuaW5vZGVfdGFibGVfc2l6ZVtpbm9kZV9udW0gYXMgdXNpemVdICsgMTsKICAgICAgICBkYXRhX3B0ciA9IGRhdGFfcHRyICsgMTsKICAgICAgICBieXRlc193cml0dGVuID0gYnl0ZXNfd3JpdHRlbiArIDE7CiAgICB9CiAgICByZXR1cm4gYnl0ZXNfd3JpdHRlbjsKfQoKZm4gcmVhZF9maWxlKGZzOiAmRlMsIGlub2RlX251bTogaTMyKSAtPiBpMzIgewogICAgbGV0IHNpemU6IGkzMiA9IGZzLmlub2RlX3RhYmxlX3NpemVbaW5vZGVfbnVtIGFzIHVzaXplXTsKICAgIGxldCBtdXQgY2hlY2tzdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGJ5dGVzX3JlYWQ6IGkzMiA9IDA7CgogICAgd2hpbGUgKGJ5dGVzX3JlYWQgPCBzaXplKSB7CiAgICAgICAgbGV0IGJsb2NrX2lkeDogaTMyID0gYnl0ZXNfcmVhZCAvIEJMT0NLX1NJWkU7CiAgICAgICAgbGV0IG9mZnNldF9pbl9ibG9jazogaTMyID0gYnl0ZXNfcmVhZCAlIEJMT0NLX1NJWkU7CiAgICAgICAgbGV0IGRhdGFfYmxvY2s6IGkzMiA9IGZzLmlub2RlX3RhYmxlX2Jsb2Nrc1tpbm9kZV9udW0gYXMgdXNpemVdW2Jsb2NrX2lkeCBhcyB1c2l6ZV07CiAgICAgICAgbGV0IHJlYWRfYWRkcjogaTMyID0gZGF0YV9ibG9jayAqIEJMT0NLX1NJWkUgKyBvZmZzZXRfaW5fYmxvY2s7CiAgICAgICAgY2hlY2tzdW0gPSBjaGVja3N1bSArIGZzLmZzX2RhdGFbcmVhZF9hZGRyIGFzIHVzaXplXTsKICAgICAgICBieXRlc19yZWFkID0gYnl0ZXNfcmVhZCArIDE7CiAgICB9CiAgICByZXR1cm4gY2hlY2tzdW07Cn0KCmZuIHN0cl90b19hcnIoczogaTMyKSAtPiBbaTMyOyAxNl0gewogICAgbGV0IG11dCBhcnI6IFtpMzI7IDE2XSA9IFswOyAxNl07CiAgICBpZiAocyA9PSAxKSB7CiAgICAgICAgYXJyWzBdID0gMTAyOyBhcnJbMV0gPSAxMDU7IGFyclsyXSA9IDEwODsgYXJyWzNdID0gMTAxOyBhcnJbNF0gPSA0OTsKICAgIH0gZWxzZSBpZiAocyA9PSAyKSB7CiAgICAgICAgYXJyWzBdID0gMTAwOyBhcnJbMV0gPSA5NzsgYXJyWzJdID0gMTE2OyBhcnJbM10gPSA5NzsKICAgIH0gZWxzZSBpZiAocyA9PSAzKSB7CiAgICAgICAgYXJyWzBdID0gMTE2OyBhcnJbMV0gPSAxMDE7IGFyclsyXSA9IDEwOTsgYXJyWzNdID0gMTEyOwogICAgfQogICAgcmV0dXJuIGFycjsKfQoKZm4gbWFpbigpIHsKICAgIGxldCBtdXQgZnM6IEZTID0gbmV3X2ZzKCk7CiAgICBmc19mb3JtYXQoJm11dCBmcyk7CgogICAgbGV0IGZpbGUxX25hbWU6IFtpMzI7IDE2XSA9IHN0cl90b19hcnIoMSk7CiAgICBsZXQgZmlsZTFfaW5vZGU6IGkzMiA9IGNyZWF0ZV9maWxlKCZtdXQgZnMsIFJPT1RfSU5PREVfTlVNLCBmaWxlMV9uYW1lKTsKICAgIHByaW50bG5JbnQoZmlsZTFfaW5vZGUpOwoKICAgIGxldCBtdXQgZGF0YTE6IFtpMzI7IDEwMF0gPSBbMDsgMTAwXTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgMTAwKSB7CiAgICAgICAgZGF0YTFbaSBhcyB1c2l6ZV0gPSBpICogMzsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICBsZXQgd3JpdHRlbjE6IGkzMiA9IHdyaXRlX2ZpbGUoJm11dCBmcywgZmlsZTFfaW5vZGUsIGRhdGExLCA4MCk7CiAgICBwcmludGxuSW50KHdyaXR0ZW4xKTsKCiAgICBsZXQgY2hlY2tzdW0xOiBpMzIgPSByZWFkX2ZpbGUoJmZzLCBmaWxlMV9pbm9kZSk7CiAgICBwcmludGxuSW50KGNoZWNrc3VtMSk7CgogICAgbGV0IGZpbGUyX25hbWU6IFtpMzI7IDE2XSA9IHN0cl90b19hcnIoMik7CiAgICBsZXQgZmlsZTJfaW5vZGU6IGkzMiA9IGNyZWF0ZV9maWxlKCZtdXQgZnMsIFJPT1RfSU5PREVfTlVNLCBmaWxlMl9uYW1lKTsKICAgIHByaW50bG5JbnQoZmlsZTJfaW5vZGUpOwoKICAgIGxldCBtdXQgZGF0YTI6IFtpMzI7IDEwMF0gPSBbMDsgMTAwXTsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCAxMDApIHsKICAgICAgICBkYXRhMltpIGFzIHVzaXplXSA9IDEwMCAtIGk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgbGV0IHdyaXR0ZW4yOiBpMzIgPSB3cml0ZV9maWxlKCZtdXQgZnMsIGZpbGUyX2lub2RlLCBkYXRhMiwgMTUwKTsKICAgIHByaW50bG5JbnQod3JpdHRlbjIpOwoKICAgIGxldCBjaGVja3N1bTI6IGkzMiA9IHJlYWRfZmlsZSgmZnMsIGZpbGUyX2lub2RlKTsKICAgIHByaW50bG5JbnQoY2hlY2tzdW0yKTsKCiAgICBsZXQgZm91bmRfaW5vZGU6IGkzMiA9IGZpbmRfaW5fZGlyKCZmcywgUk9PVF9JTk9ERV9OVU0sIGZpbGUxX25hbWUpOwogICAgcHJpbnRsbkludChmb3VuZF9pbm9kZSk7CgogICAgbGV0IG5vdF9mb3VuZF9uYW1lOiBbaTMyOyAxNl0gPSBzdHJfdG9fYXJyKDMpOwogICAgbGV0IG5vdF9mb3VuZF9pbm9kZTogaTMyID0gZmluZF9pbl9kaXIoJmZzLCBST09UX0lOT0RFX05VTSwgbm90X2ZvdW5kX25hbWUpOwogICAgcHJpbnRsbkludChub3RfZm91bmRfaW5vZGUpOwoKICAgIGxldCBtdXQgZnJlZV9ibG9ja3M6IGkzMiA9IDA7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgTlVNX0JMT0NLUykgewogICAgICAgIGlmIChmcy5mcmVlX2Jsb2NrX2JpdG1hcFtpIGFzIHVzaXplXSkgewogICAgICAgICAgICBmcmVlX2Jsb2NrcyA9IGZyZWVfYmxvY2tzICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcHJpbnRsbkludChmcmVlX2Jsb2Nrcyk7CgogICAgbGV0IG11dCBmcmVlX2lub2RlczogaTMyID0gMDsKICAgIGkgPSAwOwogICAgd2hpbGUgKGkgPCBNQVhfSU5PREVTKSB7CiAgICAgICAgaWYgKGZzLmZyZWVfaW5vZGVfYml0bWFwW2kgYXMgdXNpemVdKSB7CiAgICAgICAgICAgIGZyZWVfaW5vZGVzID0gZnJlZV9pbm9kZXMgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICBwcmludGxuSW50KGZyZWVfaW5vZGVzKTsKCiAgICBsZXQgbXV0IGZzX2NoZWNrc3VtOiBpMzIgPSAwOwogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IEZTX1NJWkUpIHsKICAgICAgICBmc19jaGVja3N1bSA9IGZzX2NoZWNrc3VtICsgZnMuZnNfZGF0YVtpIGFzIHVzaXplXTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICBwcmludGxuSW50KGZzX2NoZWNrc3VtICUgMTAwMDApOwoKICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgIHdoaWxlIChqIDwgMTApIHsKICAgICAgICBsZXQgbXV0IGRhdGE6IFtpMzI7IDEwMF0gPSBbMDsgMTAwXTsKICAgICAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGsgPCAxMCkgewogICAgICAgICAgICBkYXRhW2sgYXMgdXNpemVdID0gaiAqIDEwICsgazsKICAgICAgICAgICAgayA9IGsgKyAxOwogICAgICAgIH0KICAgICAgICB3cml0ZV9maWxlKCZtdXQgZnMsIGZpbGUxX2lub2RlLCBkYXRhLCAxMCk7CiAgICAgICAgaiA9IGogKyAxOwogICAgfQogICAgcHJpbnRsbkludChyZWFkX2ZpbGUoJmZzLCBmaWxlMV9pbm9kZSkpOwoKICAgIGxldCBtdXQgZmluYWxfc3RhdHVzOiBpMzIgPSAxOwogICAgbGV0IG11dCBrOiBpMzIgPSAwOwogICAgd2hpbGUgKGsgPCA1KSB7CiAgICAgICAgbGV0IG11dCBmaW5hbF9zdGF0dXM6IGkzMiA9IGZpbmFsX3N0YXR1cyArIGs7CiAgICAgICAgayA9IGsgKyAxOwogICAgfQogICAgcHJpbnRsbkludChmaW5hbF9zdGF0dXMpOwogICAgZXhpdCgwKTsKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (42, "comprehensive42", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEN1c3RvbSBNZW1vcnkgQWxsb2NhdG9yIFNpbXVsYXRpb24KU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6ClNpbXVsYXRlZCBwb2ludGVyIGFyaXRobWV0aWMgYW5kIG1lbW9yeSBtYW5hZ2VtZW50IHRocm91Z2ggYXJyYXkgbWFuaXB1bGF0aW9uLgpDb21wbGV4IGxpbmtlZC1saXN0IGRhdGEgc3RydWN0dXJlIHVwZGF0ZXMgd2l0aGluIGEgbGFyZ2UgYnVmZmVyLgpMb29wLWludGVuc2l2ZSBhbGxvY2F0aW9uIGFuZCBkZWFsbG9jYXRpb24gcGF0dGVybnMgdG8gdGVzdCBwZXJmb3JtYW5jZS4KTWFuYWdlbWVudCBvZiBtZW1vcnkgZnJhZ21lbnRhdGlvbiBhbmQgY29hbGVzY2luZyBsb2dpYy4KT3B0aW1pemF0aW9uIG9mIGRlZXBseSBuZXN0ZWQgY29uZGl0aW9uYWwgc3RhdGVtZW50cyBmb3IgYmxvY2sgbWFuYWdlbWVudC4KU2NvcGUgcmVzb2x1dGlvbiBmb3IgdmFyaWFibGVzIGFjcm9zcyBkaWZmZXJlbnQgYWxsb2NhdGlvbiBwaGFzZXMuCiovCgovLyBjb21wcmVoZW5zaXZlNDIucnggLSBDdXN0b20gTWVtb3J5IEFsbG9jYXRvciBTaW11bGF0aW9uCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIFNpbXVsYXRlZCBwb2ludGVyIGFyaXRobWV0aWMgYW5kIG1lbW9yeSBtYW5hZ2VtZW50IHRocm91Z2ggYXJyYXkgbWFuaXB1bGF0aW9uLgovLyAtIENvbXBsZXggbGlua2VkLWxpc3QgZGF0YSBzdHJ1Y3R1cmUgdXBkYXRlcyB3aXRoaW4gYSBsYXJnZSBidWZmZXIuCi8vIC0gTG9vcC1pbnRlbnNpdmUgYWxsb2NhdGlvbiBhbmQgZGVhbGxvY2F0aW9uIHBhdHRlcm5zIHRvIHRlc3QgcGVyZm9ybWFuY2UuCi8vIC0gTWFuYWdlbWVudCBvZiBtZW1vcnkgZnJhZ21lbnRhdGlvbiBhbmQgY29hbGVzY2luZyBsb2dpYy4KLy8gLSBPcHRpbWl6YXRpb24gb2YgZGVlcGx5IG5lc3RlZCBjb25kaXRpb25hbCBzdGF0ZW1lbnRzIGZvciBibG9jayBtYW5hZ2VtZW50LgovLyAtIFNjb3BlIHJlc29sdXRpb24gZm9yIHZhcmlhYmxlcyBhY3Jvc3MgZGlmZmVyZW50IGFsbG9jYXRpb24gcGhhc2VzLgoKZm4gbWFpbigpIHsKICAgIGxldCBtdXQgaGVhcDogW2kzMjsgMTAyNF0gPSBbMDsgMTAyNF07CiAgICBsZXQgbXV0IGZyZWVfbGlzdF9oZWFkOiBpMzIgPSAwOwogICAgLy8gVG90YWwgbnVtYmVyIG9mIGJsb2NrcyBpbiB0aGUgaGVhcCAoaGVhcF9zaXplIC8gYmxvY2tfc2l6ZSkKICAgIGxldCB0b3RhbF9ibG9ja3M6IGkzMiA9IDY0OyAvLyAxMDI0IC8gMTYKCiAgICBmbiBpbml0X2hlYXAoaGVhcDogJm11dCBbaTMyOyAxMDI0XSwgZnJlZV9saXN0X2hlYWQ6ICZtdXQgaTMyKSB7CiAgICAgICAgbGV0IGhlYXBfc2l6ZTogaTMyID0gMTAyNDsKICAgICAgICBsZXQgYmxvY2tfc2l6ZTogaTMyID0gMTY7CiAgICAgICAgbGV0IG51bV9ibG9ja3M6IGkzMiA9IGhlYXBfc2l6ZSAvIGJsb2NrX3NpemU7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgbnVtX2Jsb2NrcykgewogICAgICAgICAgICBsZXQgY3VycmVudF9hZGRyOiBpMzIgPSBpICogYmxvY2tfc2l6ZTsKICAgICAgICAgICAgaGVhcFtjdXJyZW50X2FkZHIgYXMgdXNpemVdID0gKGkgKyAxKSAqIGJsb2NrX3NpemU7IC8vIE5leHQgcG9pbnRlcgogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIGhlYXBbKChudW1fYmxvY2tzIC0gMSkgKiBibG9ja19zaXplKSBhcyB1c2l6ZV0gPSAtMTsgLy8gRW5kIG9mIGxpc3QKICAgICAgICAqZnJlZV9saXN0X2hlYWQgPSAwOwogICAgfQoKICAgIGZuIGFsbG9jKGhlYXA6ICZtdXQgW2kzMjsgMTAyNF0sIGZyZWVfbGlzdF9oZWFkOiAmbXV0IGkzMikgLT4gaTMyIHsKICAgICAgICBpZiAoKmZyZWVfbGlzdF9oZWFkID09IC0xKSB7CiAgICAgICAgICAgIHJldHVybiAtMTsgLy8gT3V0IG9mIG1lbW9yeQogICAgICAgIH0KICAgICAgICBsZXQgYmxvY2tfYWRkcjogaTMyID0gKmZyZWVfbGlzdF9oZWFkOwogICAgICAgICpmcmVlX2xpc3RfaGVhZCA9IGhlYXBbYmxvY2tfYWRkciBhcyB1c2l6ZV07CiAgICAgICAgaGVhcFtibG9ja19hZGRyIGFzIHVzaXplXSA9IC0yOyAvLyBNYXJrIGFzIGFsbG9jYXRlZAogICAgICAgIHJldHVybiBibG9ja19hZGRyOwogICAgfQoKICAgIGZuIGZyZWUoaGVhcDogJm11dCBbaTMyOyAxMDI0XSwgZnJlZV9saXN0X2hlYWQ6ICZtdXQgaTMyLCBhZGRyOiBpMzIpIHsKICAgICAgICBoZWFwW2FkZHIgYXMgdXNpemVdID0gKmZyZWVfbGlzdF9oZWFkOwogICAgICAgICpmcmVlX2xpc3RfaGVhZCA9IGFkZHI7CiAgICB9CgogICAgaW5pdF9oZWFwKCZtdXQgaGVhcCwgJm11dCBmcmVlX2xpc3RfaGVhZCk7CgogICAgbGV0IG11dCBhbGxvY2F0aW9uczogW2kzMjsgNjRdID0gWzA7IDY0XTsKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIGxldCBtdXQgc3VjY2Vzc2Z1bF9hbGxvY3M6IGkzMiA9IDA7CgogICAgd2hpbGUgKGkgPCA2NCkgewogICAgICAgIGxldCBhZGRyOiBpMzIgPSBhbGxvYygmbXV0IGhlYXAsICZtdXQgZnJlZV9saXN0X2hlYWQpOwogICAgICAgIGlmIChhZGRyICE9IC0xKSB7CiAgICAgICAgICAgIGFsbG9jYXRpb25zW2kgYXMgdXNpemVdID0gYWRkcjsKICAgICAgICAgICAgc3VjY2Vzc2Z1bF9hbGxvY3MgPSBzdWNjZXNzZnVsX2FsbG9jcyArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgMzIpIHsKICAgICAgICBpZiAoaSAlIDIgPT0gMCkgewogICAgICAgICAgICBmcmVlKCZtdXQgaGVhcCwgJm11dCBmcmVlX2xpc3RfaGVhZCwgYWxsb2NhdGlvbnNbaSBhcyB1c2l6ZV0pOwogICAgICAgICAgICBhbGxvY2F0aW9uc1tpIGFzIHVzaXplXSA9IC0xOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgaSA9IDA7CiAgICB3aGlsZSAoaSA8IDE2KSB7CiAgICAgICAgbGV0IGFkZHI6IGkzMiA9IGFsbG9jKCZtdXQgaGVhcCwgJm11dCBmcmVlX2xpc3RfaGVhZCk7CiAgICAgICAgaWYgKGFkZHIgIT0gLTEpIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICBsZXQgbXV0IHBsYWNlZDogYm9vbCA9IGZhbHNlOwogICAgICAgICAgICB3aGlsZSAoaiA8IDY0KSB7CiAgICAgICAgICAgICAgICBpZiAoYWxsb2NhdGlvbnNbaiBhcyB1c2l6ZV0gPT0gLTEgJiYgIXBsYWNlZCkgewogICAgICAgICAgICAgICAgICAgIGFsbG9jYXRpb25zW2ogYXMgdXNpemVdID0gYWRkcjsKICAgICAgICAgICAgICAgICAgICBwbGFjZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBsZXQgbXV0IGFjdGl2ZV9ibG9ja3M6IGkzMiA9IDA7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgNjQpIHsKICAgICAgICBpZiAoYWxsb2NhdGlvbnNbaSBhcyB1c2l6ZV0gIT0gLTEpIHsKICAgICAgICAgICAgYWN0aXZlX2Jsb2NrcyA9IGFjdGl2ZV9ibG9ja3MgKyAxOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgLy8gQ29tcHV0ZSBmcmFnbWVudGF0aW9uIG1ldHJpYyB3aGVuIGVub3VnaCBibG9ja3MgYXJlIGFjdGl2ZS4KICAgIC8vIEhvaXN0ZWQgdmFyaWFibGUgdG8gYXZvaWQgc2NvcGUgZXJyb3IgJiBndWFyZCBhZ2FpbnN0IGRpdmlkZS1ieS16ZXJvLgogICAgbGV0IG11dCBmcmFnbWVudGF0aW9uX21ldHJpYzogaTMyID0gMDsgLy8gMCBtZWFucyBlaXRoZXIgZnVsbHkgdXNlZCBvciBub3QgY29tcHV0ZWQuCiAgICBpZiAoYWN0aXZlX2Jsb2NrcyA+IDQwKSB7CiAgICAgICAgbGV0IG11dCBtYXhfY29udGlndW91c19mcmVlOiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgY3VycmVudF9jb250aWd1b3VzOiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgY3VycmVudF9wdHI6IGkzMiA9IGZyZWVfbGlzdF9oZWFkOwogICAgICAgIHdoaWxlIChjdXJyZW50X3B0ciAhPSAtMSkgewogICAgICAgICAgICBjdXJyZW50X2NvbnRpZ3VvdXMgPSBjdXJyZW50X2NvbnRpZ3VvdXMgKyAxOwogICAgICAgICAgICBsZXQgbmV4dF9wdHI6IGkzMiA9IGhlYXBbY3VycmVudF9wdHIgYXMgdXNpemVdOwogICAgICAgICAgICBpZiAobmV4dF9wdHIgIT0gY3VycmVudF9wdHIgKyAxNikgewogICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRfY29udGlndW91cyA+IG1heF9jb250aWd1b3VzX2ZyZWUpIHsKICAgICAgICAgICAgICAgICAgICBtYXhfY29udGlndW91c19mcmVlID0gY3VycmVudF9jb250aWd1b3VzOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY3VycmVudF9jb250aWd1b3VzID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBjdXJyZW50X3B0ciA9IG5leHRfcHRyOwogICAgICAgIH0KICAgICAgICAvLyBTYWZlIGRlbm9taW5hdG9yOiByZW1haW5pbmcgZnJlZSBibG9ja3MuIElmIHplcm8sIGZyYWdtZW50YXRpb24gaXMgZGVmaW5lZCBhcyAwLgogICAgICAgIGxldCByZW1haW5pbmdfZnJlZTogaTMyID0gdG90YWxfYmxvY2tzIC0gYWN0aXZlX2Jsb2NrczsgLy8gY291bGQgYmUgMAogICAgICAgIGlmIChyZW1haW5pbmdfZnJlZSA+IDApIHsKICAgICAgICAgICAgZnJhZ21lbnRhdGlvbl9tZXRyaWMgPSBtYXhfY29udGlndW91c19mcmVlICogMTAwIC8gcmVtYWluaW5nX2ZyZWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZnJhZ21lbnRhdGlvbl9tZXRyaWMgPSAwOyAvLyBObyBmcmVlIHNwYWNlIC0+IHRyZWF0IGFzIG5vIG1lYXN1cmFibGUgZnJhZ21lbnRhdGlvbi4KICAgICAgICB9CiAgICB9CgogICAgaWYgKGFjdGl2ZV9ibG9ja3MgPCA0OCkgewogICAgICAgIGxldCBtdXQgaTogaTMyID0gMzI7CiAgICAgICAgd2hpbGUgKGkgPCA2NCkgewogICAgICAgICAgICBpZiAoaSAlIDMgPT0gMCkgewogICAgICAgICAgICAgICAgaWYgKGFsbG9jYXRpb25zW2kgYXMgdXNpemVdICE9IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgZnJlZSgmbXV0IGhlYXAsICZtdXQgZnJlZV9saXN0X2hlYWQsIGFsbG9jYXRpb25zW2kgYXMgdXNpemVdKTsKICAgICAgICAgICAgICAgICAgICBhbGxvY2F0aW9uc1tpIGFzIHVzaXplXSA9IC0xOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICB9CgogICAgbGV0IG11dCBmaW5hbF9jaGVja19zdW06IGkzMiA9IDA7CiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgMTAyNCkgewogICAgICAgIGlmIChoZWFwW2kgYXMgdXNpemVdID09IC0yKSB7CiAgICAgICAgICAgIGZpbmFsX2NoZWNrX3N1bSA9IGZpbmFsX2NoZWNrX3N1bSArIGk7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBwcmludGxuSW50KGZyYWdtZW50YXRpb25fbWV0cmljKTsgLy8gMCBpZiAobm90IGNvbXB1dGVkIG9yIGZ1bGx5IGFsbG9jYXRlZCkKICAgIHByaW50bG5JbnQoZmluYWxfY2hlY2tfc3VtKTsKICAgIGV4aXQoMCk7Cn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (43, "comprehensive43", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IFNpbXBsZSBTdGFjay1CYXNlZCBJbnRlcnByZXRlcgpTdW1tYXJ5OiBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKRGV0YWlsczoKTGFyZ2Ugc3dpdGNoLWxpa2UgZGlzcGF0Y2ggbG9vcHMgZm9yIGluc3RydWN0aW9uIHByb2Nlc3NpbmcuCkFycmF5IG1hbmlwdWxhdGlvbiBmb3Igc3RhY2sgYW5kIHByb2dyYW0gbWVtb3J5LgpEZWVwbHkgbmVzdGVkIGZ1bmN0aW9uIGNhbGxzIGFuZCByZWN1cnNpb24gc2ltdWxhdGlvbi4KQ29tcGxleCBjb25kaXRpb25hbCBsb2dpYyBmb3IganVtcHMgYW5kIGNvbnRyb2wgZmxvdy4KUGVyZm9ybWFuY2Ugb2YgaW50ZWdlciBhcml0aG1ldGljIGFuZCBjb21wYXJpc29ucy4KTXV0YWJpbGl0eSBhbmFseXNpcyBpbiBmdW5jdGlvbnMgbW9kaWZ5aW5nIHNoYXJlZCBzdGF0ZS4KKi8KCi8vIGNvbXByZWhlbnNpdmU0My5yeCAtIFNpbXBsZSBTdGFjay1CYXNlZCBJbnRlcnByZXRlcgovLyBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKLy8gLSBMYXJnZSBzd2l0Y2gtbGlrZSBkaXNwYXRjaCBsb29wcyBmb3IgaW5zdHJ1Y3Rpb24gcHJvY2Vzc2luZy4KLy8gLSBBcnJheSBtYW5pcHVsYXRpb24gZm9yIHN0YWNrIGFuZCBwcm9ncmFtIG1lbW9yeS4KLy8gLSBEZWVwbHkgbmVzdGVkIGZ1bmN0aW9uIGNhbGxzIGFuZCByZWN1cnNpb24gc2ltdWxhdGlvbi4KLy8gLSBDb21wbGV4IGNvbmRpdGlvbmFsIGxvZ2ljIGZvciBqdW1wcyBhbmQgY29udHJvbCBmbG93LgovLyAtIFBlcmZvcm1hbmNlIG9mIGludGVnZXIgYXJpdGhtZXRpYyBhbmQgY29tcGFyaXNvbnMuCi8vIC0gTXV0YWJpbGl0eSBhbmFseXNpcyBpbiBmdW5jdGlvbnMgbW9kaWZ5aW5nIHNoYXJlZCBzdGF0ZS4KCmZuIG1haW4oKSB7CiAgICBsZXQgbXV0IHByb2dyYW06IFtpMzI7IDI1Nl0gPSBbMDsgMjU2XTsKICAgIGxldCBtdXQgc3RhY2s6IFtpMzI7IDI1Nl0gPSBbMDsgMjU2XTsKICAgIGxldCBtdXQgc3A6IGkzMiA9IC0xOwogICAgbGV0IG11dCBwYzogaTMyID0gMDsKICAgIGxldCBtdXQgaGFsdDogYm9vbCA9IGZhbHNlOwoKICAgIC8vIE9wY29kZXM6IDE6UFVTSCwgMjpQT1AsIDM6QURELCA0OlNVQiwgNTpNVUwsIDY6RElWLCA3OkpNUCwgODpKWiwgOTpKTlosIDEwOkVRLCAxMTpMVCwgMTI6R1QsIDEzOlBSSU5ULCAxNDpIQUxULCAxNTpEVVAKCiAgICBmbiBsb2FkX3Byb2dyYW0ocHJvZzogJm11dCBbaTMyOyAyNTZdKSB7CiAgICAgICAgLy8gQ2FsY3VsYXRlIGZhY3RvcmlhbCBvZiA4CiAgICAgICAgcHJvZ1swXSA9IDE7IHByb2dbMV0gPSA4OyAgICAgICAvLyBQVVNIIDggKG4pCiAgICAgICAgcHJvZ1syXSA9IDE7IHByb2dbM10gPSAxOyAgICAgICAvLyBQVVNIIDEgKHJlc3VsdCkKICAgICAgICAvLyBMb29wIHN0YXJ0IChwYz00KQogICAgICAgIHByb2dbNF0gPSAxNTsgICAgICAgICAgICAgICAgICAgLy8gRFVQIChkdXBsaWNhdGUgbikKICAgICAgICBwcm9nWzVdID0gMTsgcHJvZ1s2XSA9IDE7ICAgICAgIC8vIFBVU0ggMQogICAgICAgIHByb2dbN10gPSAxMTsgICAgICAgICAgICAgICAgICAgLy8gTFQgKG4gPCAxPykKICAgICAgICBwcm9nWzhdID0gOTsgcHJvZ1s5XSA9IDE0OyAgICAgIC8vIEpOWiB0byBsb29wX2VuZCAocGM9MTgpCiAgICAgICAgLy8gaWYgbiA8IDEsIGp1bXAgdG8gcHJpbnQKICAgICAgICBwcm9nWzEwXSA9IDc7IHByb2dbMTFdID0gMjA7ICAgICAvLyBKTVAgdG8gcHJpbnRfcmVzdWx0IChwYz0zMCkKICAgICAgICAvLyBsb29wX2JvZHkgKHBjPTEyKQogICAgICAgIHByb2dbMTJdID0gNTsgICAgICAgICAgICAgICAgICAgLy8gTVVMIChyZXN1bHQgPSByZXN1bHQgKiBuKQogICAgICAgIHByb2dbMTNdID0gMTsgcHJvZ1sxNF0gPSAtMTsgICAgLy8gUFVTSCAtMQogICAgICAgIHByb2dbMTVdID0gMzsgICAgICAgICAgICAgICAgICAgLy8gQUREIChuID0gbiAtIDEpCiAgICAgICAgcHJvZ1sxNl0gPSA3OyBwcm9nWzE3XSA9IDQ7ICAgICAgLy8gSk1QIHRvIGxvb3Bfc3RhcnQgKHBjPTQpCiAgICAgICAgLy8gbG9vcF9lbmQgKHBjPTE4KQogICAgICAgIHByb2dbMThdID0gMjsgICAgICAgICAgICAgICAgICAgLy8gUE9QIChuKQogICAgICAgIHByb2dbMTldID0gNzsgcHJvZ1syMF0gPSAxMjsgICAgIC8vIEpNUCB0byBsb29wX2JvZHkgKHBjPTEyKQogICAgICAgIC8vIHByaW50X3Jlc3VsdCAocGM9MjEpCiAgICAgICAgcHJvZ1syMV0gPSAxMzsgICAgICAgICAgICAgICAgICAvLyBQUklOVCByZXN1bHQKICAgICAgICBwcm9nWzIyXSA9IDE0OyAgICAgICAgICAgICAgICAgIC8vIEhBTFQKCiAgICAgICAgLy8gU29tZSBkZWFkIGNvZGUgdG8gaW5jcmVhc2UgY29tcGxleGl0eQogICAgICAgIGxldCBtdXQgaTogaTMyID0gMzA7CiAgICAgICAgd2hpbGUgKGkgPCAyNTApIHsKICAgICAgICAgICAgcHJvZ1tpIGFzIHVzaXplXSA9IDE7CiAgICAgICAgICAgIHByb2dbaSBhcyB1c2l6ZSsxXSA9IGk7CiAgICAgICAgICAgIHByb2dbaSBhcyB1c2l6ZSsyXSA9IDE1OwogICAgICAgICAgICBwcm9nW2kgYXMgdXNpemUrM10gPSAyOwogICAgICAgICAgICBpID0gaSArIDQ7CiAgICAgICAgfQogICAgfQoKICAgIC8vIEhpZGRlbiBFcnJvcjogVGhpcyBmdW5jdGlvbiBpcyBkZWNsYXJlZCB0byB0YWtlIGFuIGltbXV0YWJsZSBwcm9ncmFtIGFycmF5LAogICAgLy8gYnV0IGl0IHRyaWVzIHRvIG1vZGlmeSBpdC4gVGhpcyBzaG91bGQgY2F1c2UgYSBtdXRhYmlsaXR5IGNvbmZsaWN0IGVycm9yLgogICAgZm4gc2VsZl9tb2RpZnlfY29kZShwcm9nOiAmbXV0IFtpMzI7IDI1Nl0sIHBjOiBpMzIpIHsKICAgICAgICBpZiAocGMgPiAxMCAmJiBwcm9nW3BjIGFzIHVzaXplLTFdID09IDE1KSB7IC8vIElmIChwcmV2aW91cyBpbnN0cnVjdGlvbiB3YXMgRFVQKQogICAgICAgICAgICBwcm9nW3BjIGFzIHVzaXplXSA9IDI7IC8vIENoYW5nZSBuZXh0IGluc3RydWN0aW9uIHRvIFBPUAogICAgICAgIH0KICAgIH0KCiAgICBsb2FkX3Byb2dyYW0oJm11dCBwcm9ncmFtKTsKCiAgICB3aGlsZSAoIWhhbHQpIHsKICAgICAgICBsZXQgaW5zdHJ1Y3Rpb246IGkzMiA9IHByb2dyYW1bcGMgYXMgdXNpemVdOwogICAgICAgIHBjID0gcGMgKyAxOwoKICAgICAgICAvLyBUaGlzIGNhbGwgaW50cm9kdWNlcyB0aGUgaGlkZGVuIGVycm9yLgogICAgICAgIHNlbGZfbW9kaWZ5X2NvZGUoJm11dCBwcm9ncmFtLCBwYyk7CgogICAgICAgIGlmIChpbnN0cnVjdGlvbiA9PSAxKSB7IC8vIFBVU0gKICAgICAgICAgICAgbGV0IHZhbHVlOiBpMzIgPSBwcm9ncmFtW3BjIGFzIHVzaXplXTsKICAgICAgICAgICAgcGMgPSBwYyArIDE7CiAgICAgICAgICAgIHNwID0gc3AgKyAxOwogICAgICAgICAgICBzdGFja1tzcCBhcyB1c2l6ZV0gPSB2YWx1ZTsKICAgICAgICB9IGVsc2UgaWYgKGluc3RydWN0aW9uID09IDIpIHsgLy8gUE9QCiAgICAgICAgICAgIHNwID0gc3AgLSAxOwogICAgICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb24gPT0gMykgeyAvLyBBREQKICAgICAgICAgICAgbGV0IGI6IGkzMiA9IHN0YWNrW3NwIGFzIHVzaXplXTsKICAgICAgICAgICAgc3AgPSBzcCAtIDE7CiAgICAgICAgICAgIGxldCBhOiBpMzIgPSBzdGFja1tzcCBhcyB1c2l6ZV07CiAgICAgICAgICAgIHN0YWNrW3NwIGFzIHVzaXplXSA9IGEgKyBiOwogICAgICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb24gPT0gNCkgeyAvLyBTVUIKICAgICAgICAgICAgbGV0IGI6IGkzMiA9IHN0YWNrW3NwIGFzIHVzaXplXTsKICAgICAgICAgICAgc3AgPSBzcCAtIDE7CiAgICAgICAgICAgIGxldCBhOiBpMzIgPSBzdGFja1tzcCBhcyB1c2l6ZV07CiAgICAgICAgICAgIHN0YWNrW3NwIGFzIHVzaXplXSA9IGEgLSBiOwogICAgICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb24gPT0gNSkgeyAvLyBNVUwKICAgICAgICAgICAgbGV0IGI6IGkzMiA9IHN0YWNrW3NwIGFzIHVzaXplXTsKICAgICAgICAgICAgc3AgPSBzcCAtIDE7CiAgICAgICAgICAgIGxldCBhOiBpMzIgPSBzdGFja1tzcCBhcyB1c2l6ZV07CiAgICAgICAgICAgIHN0YWNrW3NwIGFzIHVzaXplXSA9IGEgKiBiOwogICAgICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb24gPT0gNikgeyAvLyBESVYKICAgICAgICAgICAgbGV0IGI6IGkzMiA9IHN0YWNrW3NwIGFzIHVzaXplXTsKICAgICAgICAgICAgc3AgPSBzcCAtIDE7CiAgICAgICAgICAgIGxldCBhOiBpMzIgPSBzdGFja1tzcCBhcyB1c2l6ZV07CiAgICAgICAgICAgIHN0YWNrW3NwIGFzIHVzaXplXSA9IGEgLyBiOwogICAgICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb24gPT0gNykgeyAvLyBKTVAKICAgICAgICAgICAgcGMgPSBwcm9ncmFtW3BjIGFzIHVzaXplXTsKICAgICAgICB9IGVsc2UgaWYgKGluc3RydWN0aW9uID09IDgpIHsgLy8gSloKICAgICAgICAgICAgbGV0IHZhbDogaTMyID0gc3RhY2tbc3AgYXMgdXNpemVdOwogICAgICAgICAgICBzcCA9IHNwIC0gMTsKICAgICAgICAgICAgaWYgKHZhbCA9PSAwKSB7CiAgICAgICAgICAgICAgICBwYyA9IHByb2dyYW1bcGMgYXMgdXNpemVdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcGMgPSBwYyArIDE7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGluc3RydWN0aW9uID09IDkpIHsgLy8gSk5aCiAgICAgICAgICAgIGxldCB2YWw6IGkzMiA9IHN0YWNrW3NwIGFzIHVzaXplXTsKICAgICAgICAgICAgc3AgPSBzcCAtIDE7CiAgICAgICAgICAgIGlmICh2YWwgIT0gMCkgewogICAgICAgICAgICAgICAgcGMgPSBwcm9ncmFtW3BjIGFzIHVzaXplXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHBjID0gcGMgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChpbnN0cnVjdGlvbiA9PSAxMCkgeyAvLyBFUQogICAgICAgICAgICBsZXQgYjogaTMyID0gc3RhY2tbc3AgYXMgdXNpemVdOwogICAgICAgICAgICBzcCA9IHNwIC0gMTsKICAgICAgICAgICAgbGV0IGE6IGkzMiA9IHN0YWNrW3NwIGFzIHVzaXplXTsKICAgICAgICAgICAgaWYgKGEgPT0gYikgeyBzdGFja1tzcCBhcyB1c2l6ZV0gPSAxOyB9IGVsc2UgeyBzdGFja1tzcCBhcyB1c2l6ZV0gPSAwOyB9CiAgICAgICAgfSBlbHNlIGlmIChpbnN0cnVjdGlvbiA9PSAxMSkgeyAvLyBMVAogICAgICAgICAgICBsZXQgYjogaTMyID0gc3RhY2tbc3AgYXMgdXNpemVdOwogICAgICAgICAgICBzcCA9IHNwIC0gMTsKICAgICAgICAgICAgbGV0IGE6IGkzMiA9IHN0YWNrW3NwIGFzIHVzaXplXTsKICAgICAgICAgICAgaWYgKGEgPCBiKSB7IHN0YWNrW3NwIGFzIHVzaXplXSA9IDE7IH0gZWxzZSB7IHN0YWNrW3NwIGFzIHVzaXplXSA9IDA7IH0KICAgICAgICB9IGVsc2UgaWYgKGluc3RydWN0aW9uID09IDEyKSB7IC8vIEdUCiAgICAgICAgICAgIGxldCBiOiBpMzIgPSBzdGFja1tzcCBhcyB1c2l6ZV07CiAgICAgICAgICAgIHNwID0gc3AgLSAxOwogICAgICAgICAgICBsZXQgYTogaTMyID0gc3RhY2tbc3AgYXMgdXNpemVdOwogICAgICAgICAgICBpZiAoYSA+IGIpIHsgc3RhY2tbc3AgYXMgdXNpemVdID0gMTsgfSBlbHNlIHsgc3RhY2tbc3AgYXMgdXNpemVdID0gMDsgfQogICAgICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb24gPT0gMTMpIHsgLy8gUFJJTlQKICAgICAgICAgICAgcHJpbnRsbkludChzdGFja1tzcCBhcyB1c2l6ZV0pOwogICAgICAgIH0gZWxzZSBpZiAoaW5zdHJ1Y3Rpb24gPT0gMTQpIHsgLy8gSEFMVAogICAgICAgICAgICBoYWx0ID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgaWYgKGluc3RydWN0aW9uID09IDE1KSB7IC8vIERVUAogICAgICAgICAgICBsZXQgdmFsOiBpMzIgPSBzdGFja1tzcCBhcyB1c2l6ZV07CiAgICAgICAgICAgIHNwID0gc3AgKyAxOwogICAgICAgICAgICBzdGFja1tzcCBhcyB1c2l6ZV0gPSB2YWw7CiAgICAgICAgfQoKICAgICAgICBpZiAocGMgPCAwIHx8IHBjID49IDI1NikgewogICAgICAgICAgICBoYWx0ID0gdHJ1ZTsKICAgICAgICB9CiAgICB9CiAgICBleGl0KDApOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (44, "comprehensive44", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IE11bHRpLUFnZW50IFN5c3RlbSBTaW11bGF0aW9uClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpDb21wbGV4IG9iamVjdC1saWtlIHN0cnVjdHVyZXMgdXNpbmcgYXJyYXlzIGFuZCBzdHJ1Y3RzLgpTaW11bGF0aW9uIG9mIHBhcmFsbGVsIGJlaGF2aW9yIGFuZCBpbnRlcmFjdGlvbiBpbiBhIHNpbmdsZSB0aHJlYWQuCkFkdmFuY2VkIG11bHRpLWRpbWVuc2lvbmFsIGFycmF5IGFjY2VzcyBhbmQgdXBkYXRlcy4KQnJhbmNoIHByZWRpY3Rpb24gZm9yIGFnZW50IGRlY2lzaW9uLW1ha2luZyBsb2dpYy4KTG9vcCB1bnJvbGxpbmcgYW5kIG9wdGltaXphdGlvbiBmb3Igc3RhdGUgdXBkYXRlIGN5Y2xlcy4KRnVuY3Rpb24gY2FsbCBvdmVyaGVhZCB3aXRoIGNvbXBsZXggc3RhdGUgcGFzc2luZy4KKi8KCi8vIGNvbXByZWhlbnNpdmU0NC5yeCAtIE11bHRpLUFnZW50IFN5c3RlbSBTaW11bGF0aW9uCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIENvbXBsZXggb2JqZWN0LWxpa2Ugc3RydWN0dXJlcyB1c2luZyBhcnJheXMgYW5kIHN0cnVjdHMuCi8vIC0gU2ltdWxhdGlvbiBvZiBwYXJhbGxlbCBiZWhhdmlvciBhbmQgaW50ZXJhY3Rpb24gaW4gYSBzaW5nbGUgdGhyZWFkLgovLyAtIEFkdmFuY2VkIG11bHRpLWRpbWVuc2lvbmFsIGFycmF5IGFjY2VzcyBhbmQgdXBkYXRlcy4KLy8gLSBCcmFuY2ggcHJlZGljdGlvbiBmb3IgYWdlbnQgZGVjaXNpb24tbWFraW5nIGxvZ2ljLgovLyAtIExvb3AgdW5yb2xsaW5nIGFuZCBvcHRpbWl6YXRpb24gZm9yIHN0YXRlIHVwZGF0ZSBjeWNsZXMuCi8vIC0gRnVuY3Rpb24gY2FsbCBvdmVyaGVhZCB3aXRoIGNvbXBsZXggc3RhdGUgcGFzc2luZy4KCmZuIG1haW4oKSB7CiAgICBzdHJ1Y3QgQWdlbnQgewogICAgICAgIGlkOiBpMzIsCiAgICAgICAgeDogaTMyLAogICAgICAgIHk6IGkzMiwKICAgICAgICBlbmVyZ3k6IGkzMiwKICAgICAgICB0YXJnZXRfeDogaTMyLAogICAgICAgIHRhcmdldF95OiBpMzIsCiAgICAgICAgc3RhdGU6IGkzMiwgLy8gMDogaWRsZSwgMTogbW92aW5nLCAyOiBjb2xsZWN0aW5nCiAgICB9CgogICAgbGV0IG11dCB3b3JsZDogW1tpMzI7IDY0XTsgNjRdID0gW1swOyA2NF07IDY0XTsKICAgIGxldCBtdXQgYWdlbnRzOiBbQWdlbnQ7IDMyXSA9IFtBZ2VudCB7CiAgICAgICAgaWQ6IDAsCiAgICAgICAgeDogMCwKICAgICAgICB5OiAwLAogICAgICAgIGVuZXJneTogMCwKICAgICAgICB0YXJnZXRfeDogMCwKICAgICAgICB0YXJnZXRfeTogMCwKICAgICAgICBzdGF0ZTogMCwKICAgIH07IDMyXTsKICAgIGxldCBudW1fYWdlbnRzOiBpMzIgPSAzMjsKICAgIGxldCB3b3JsZF9zaXplOiBpMzIgPSA2NDsKCiAgICBmbiBpbml0X3dvcmxkKHdvcmxkOiAmbXV0IFtbaTMyOyA2NF07IDY0XSwgYWdlbnRzOiAmbXV0IFtBZ2VudDsgMzJdKSB7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgNjQpIHsKICAgICAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgICAgICB3aGlsZSAoaiA8IDY0KSB7CiAgICAgICAgICAgICAgICB3b3JsZFtpIGFzIHVzaXplXVtqIGFzIHVzaXplXSA9IChpICogaiArIGkgKyBqKSAlIDEwMDsgLy8gUmVzb3VyY2UgZGVuc2l0eQogICAgICAgICAgICAgICAgaiA9IGogKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CgogICAgICAgIGkgPSAwOwogICAgICAgIHdoaWxlIChpIDwgMzIpIHsKICAgICAgICAgICAgYWdlbnRzW2kgYXMgdXNpemVdLmlkID0gaTsKICAgICAgICAgICAgYWdlbnRzW2kgYXMgdXNpemVdLnggPSAoaSAqIDEzKSAlIDY0OwogICAgICAgICAgICBhZ2VudHNbaSBhcyB1c2l6ZV0ueSA9IChpICogMzEpICUgNjQ7CiAgICAgICAgICAgIGFnZW50c1tpIGFzIHVzaXplXS5lbmVyZ3kgPSAxMDA7CiAgICAgICAgICAgIGFnZW50c1tpIGFzIHVzaXplXS5zdGF0ZSA9IDA7CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICB9CgogICAgZm4gZmluZF9uZXdfdGFyZ2V0KGFnZW50OiAmQWdlbnQsIHdvcmxkOiAmW1tpMzI7IDY0XTsgNjRdKSAtPiBpMzIgewogICAgICAgIGxldCBtdXQgYmVzdF94OiBpMzIgPSAtMTsKICAgICAgICBsZXQgbXV0IGJlc3RfeTogaTMyID0gLTE7CiAgICAgICAgbGV0IG11dCBtYXhfcmVzOiBpMzIgPSAtMTsKICAgICAgICBsZXQgbXV0IGR4OiBpMzIgPSAtNTsKICAgICAgICB3aGlsZSAoZHggPD0gNSkgewogICAgICAgICAgICBsZXQgbXV0IGR5OiBpMzIgPSAtNTsKICAgICAgICAgICAgd2hpbGUgKGR5IDw9IDUpIHsKICAgICAgICAgICAgICAgIGxldCBueDogaTMyID0gKGFnZW50LnggKyBkeCArIDY0KSAlIDY0OwogICAgICAgICAgICAgICAgbGV0IG55OiBpMzIgPSAoYWdlbnQueSArIGR5ICsgNjQpICUgNjQ7CiAgICAgICAgICAgICAgICBpZiAod29ybGRbbnggYXMgdXNpemVdW255IGFzIHVzaXplXSA+IG1heF9yZXMpIHsKICAgICAgICAgICAgICAgICAgICBtYXhfcmVzID0gd29ybGRbbnggYXMgdXNpemVdW255IGFzIHVzaXplXTsKICAgICAgICAgICAgICAgICAgICBiZXN0X3ggPSBueDsKICAgICAgICAgICAgICAgICAgICBiZXN0X3kgPSBueTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGR5ID0gZHkgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGR4ID0gZHggKyAxOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYmVzdF94ICogMTAwMCArIGJlc3RfeTsKICAgIH0KCiAgICBmbiB1cGRhdGVfYWdlbnQoYWdlbnQ6ICZtdXQgQWdlbnQsIHdvcmxkOiAmbXV0IFtbaTMyOyA2NF07IDY0XSkgewogICAgICAgIGlmIChhZ2VudC5lbmVyZ3kgPD0gMCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGFnZW50LmVuZXJneSA9IGFnZW50LmVuZXJneSAtIDE7CgogICAgICAgIGlmIChhZ2VudC5zdGF0ZSA9PSAwKSB7CiAgICAgICAgICAgIC8vIElkbGUKICAgICAgICAgICAgbGV0IHRhcmdldDogaTMyID0gZmluZF9uZXdfdGFyZ2V0KGFnZW50LCB3b3JsZCk7CiAgICAgICAgICAgIGFnZW50LnRhcmdldF94ID0gdGFyZ2V0IC8gMTAwMDsKICAgICAgICAgICAgYWdlbnQudGFyZ2V0X3kgPSB0YXJnZXQgJSAxMDAwOwogICAgICAgICAgICBhZ2VudC5zdGF0ZSA9IDE7CiAgICAgICAgfSBlbHNlIGlmIChhZ2VudC5zdGF0ZSA9PSAxKSB7CiAgICAgICAgICAgIC8vIE1vdmluZwogICAgICAgICAgICBpZiAoYWdlbnQueCA9PSBhZ2VudC50YXJnZXRfeCAmJiBhZ2VudC55ID09IGFnZW50LnRhcmdldF95KSB7CiAgICAgICAgICAgICAgICBhZ2VudC5zdGF0ZSA9IDI7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoYWdlbnQueCA8IGFnZW50LnRhcmdldF94KSB7CiAgICAgICAgICAgICAgICAgICAgYWdlbnQueCA9IGFnZW50LnggKyAxOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhZ2VudC54ID4gYWdlbnQudGFyZ2V0X3gpIHsKICAgICAgICAgICAgICAgICAgICBhZ2VudC54ID0gYWdlbnQueCAtIDE7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGFnZW50LnkgPCBhZ2VudC50YXJnZXRfeSkgewogICAgICAgICAgICAgICAgICAgIGFnZW50LnkgPSBhZ2VudC55ICsgMTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWdlbnQueSA+IGFnZW50LnRhcmdldF95KSB7CiAgICAgICAgICAgICAgICAgICAgYWdlbnQueSA9IGFnZW50LnkgLSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChhZ2VudC5zdGF0ZSA9PSAyKSB7CiAgICAgICAgICAgIC8vIENvbGxlY3RpbmcKICAgICAgICAgICAgbGV0IHJlczogaTMyID0gd29ybGRbKGFnZW50LngpIGFzIHVzaXplXVsoYWdlbnQueSkgYXMgdXNpemVdOwogICAgICAgICAgICBpZiAocmVzID4gMCkgewogICAgICAgICAgICAgICAgYWdlbnQuZW5lcmd5ID0gYWdlbnQuZW5lcmd5ICsgcmVzIC8gNTsKICAgICAgICAgICAgICAgIHdvcmxkWyhhZ2VudC54KSBhcyB1c2l6ZV1bKGFnZW50LnkpIGFzIHVzaXplXSA9CiAgICAgICAgICAgICAgICAgICAgd29ybGRbKGFnZW50LngpIGFzIHVzaXplXVsoYWdlbnQueSkgYXMgdXNpemVdIC0gcmVzIC8gMTAgLSAxOwogICAgICAgICAgICAgICAgaWYgKHdvcmxkWyhhZ2VudC54KSBhcyB1c2l6ZV1bKGFnZW50LnkpIGFzIHVzaXplXSA8IDApIHsKICAgICAgICAgICAgICAgICAgICB3b3JsZFsoYWdlbnQueCkgYXMgdXNpemVdWyhhZ2VudC55KSBhcyB1c2l6ZV0gPSAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGFnZW50LnN0YXRlID0gMDsKICAgICAgICB9CiAgICB9CgogICAgaW5pdF93b3JsZCgmbXV0IHdvcmxkLCAmbXV0IGFnZW50cyk7CgogICAgbGV0IG11dCB0aW1lX3N0ZXA6IGkzMiA9IDA7CiAgICB3aGlsZSAodGltZV9zdGVwIDwgMjAwKSB7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgMzIpIHsKICAgICAgICAgICAgdXBkYXRlX2FnZW50KCZtdXQgYWdlbnRzW2kgYXMgdXNpemVdLCAmbXV0IHdvcmxkKTsKICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KCiAgICAgICAgLy8gSGlkZGVuIEVycm9yOiBgdG90YWxfZW5lcmd5YCBpcyBkZWNsYXJlZCBhcyBpbW11dGFibGUgYnV0IGlzIG1vZGlmaWVkCiAgICAgICAgLy8gaW5zaWRlIHRoZSBsb29wLiBUaGlzIHNob3VsZCBjYXVzZSBhIG11dGFiaWxpdHkgZXJyb3IuCiAgICAgICAgaWYgKHRpbWVfc3RlcCAlIDIwID09IDApIHsKICAgICAgICAgICAgbGV0IG11dCB0b3RhbF9lbmVyZ3k6IGkzMiA9IDA7CiAgICAgICAgICAgIGxldCBtdXQgajogaTMyID0gMDsKICAgICAgICAgICAgd2hpbGUgKGogPCAzMikgewogICAgICAgICAgICAgICAgdG90YWxfZW5lcmd5ID0gdG90YWxfZW5lcmd5ICsgYWdlbnRzW2ogYXMgdXNpemVdLmVuZXJneTsKICAgICAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBwcmludGxuSW50KHRvdGFsX2VuZXJneSk7CiAgICAgICAgfQogICAgICAgIHRpbWVfc3RlcCA9IHRpbWVfc3RlcCArIDE7CiAgICB9CgogICAgbGV0IG11dCBmaW5hbF93b3JsZF9zdW06IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IDY0KSB7CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgNjQpIHsKICAgICAgICAgICAgZmluYWxfd29ybGRfc3VtID0gZmluYWxfd29ybGRfc3VtICsgd29ybGRbaSBhcyB1c2l6ZV1baiBhcyB1c2l6ZV07CiAgICAgICAgICAgIGogPSBqICsgMTsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcHJpbnRsbkludChmaW5hbF93b3JsZF9zdW0pOwogICAgZXhpdCgwKTsKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (45, "comprehensive45", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEFkdmFuY2VkIERhdGEgQ29tcHJlc3Npb24gKExlbXBlbC1aaXYtbGlrZSkKU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6ClN0cmluZy1saWtlIG9wZXJhdGlvbnMgb24gaW50ZWdlciBhcnJheXMuCkNvbXBsZXggc2VhcmNoIGFsZ29yaXRobXMgd2l0aGluIGEgc2xpZGluZyB3aW5kb3cuCkR5bmFtaWMgZGF0YSBzdHJ1Y3R1cmUgYmVoYXZpb3IgKGRpY3Rpb25hcnkpIHNpbXVsYXRlZCB3aXRoIGFycmF5cy4KSGlnaC1kZW1hbmQgbG9vcCBvcHRpbWl6YXRpb25zIGZvciBwYXR0ZXJuIG1hdGNoaW5nLgpQZXJmb3JtYW5jZSBvZiBhcnJheSBzbGljaW5nIGFuZCBjb3B5aW5nIHNpbXVsYXRpb25zLgpCcmFuY2hpbmcgbG9naWMgZm9yIGhhbmRsaW5nIG1hdGNoZXMgdnMuIGxpdGVyYWxzLgoqLwoKLy8gY29tcHJlaGVuc2l2ZTQ1LnJ4IC0gQWR2YW5jZWQgRGF0YSBDb21wcmVzc2lvbiAoTGVtcGVsLVppdi1saWtlKQovLyBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKLy8gLSBTdHJpbmctbGlrZSBvcGVyYXRpb25zIG9uIGludGVnZXIgYXJyYXlzLgovLyAtIENvbXBsZXggc2VhcmNoIGFsZ29yaXRobXMgd2l0aGluIGEgc2xpZGluZyB3aW5kb3cuCi8vIC0gRHluYW1pYyBkYXRhIHN0cnVjdHVyZSBiZWhhdmlvciAoZGljdGlvbmFyeSkgc2ltdWxhdGVkIHdpdGggYXJyYXlzLgovLyAtIEhpZ2gtZGVtYW5kIGxvb3Agb3B0aW1pemF0aW9ucyBmb3IgcGF0dGVybiBtYXRjaGluZy4KLy8gLSBQZXJmb3JtYW5jZSBvZiBhcnJheSBzbGljaW5nIGFuZCBjb3B5aW5nIHNpbXVsYXRpb25zLgovLyAtIEJyYW5jaGluZyBsb2dpYyBmb3IgaGFuZGxpbmcgbWF0Y2hlcyB2cy4gbGl0ZXJhbHMuCgpmbiBtYWluKCkgewogICAgbGV0IG11dCBpbnB1dF9kYXRhOiBbaTMyOyA1MTJdID0gWzA7IDUxMl07CiAgICBsZXQgbXV0IGNvbXByZXNzZWRfZGF0YTogW2kzMjsgNTEyXSA9IFswOyA1MTJdOwogICAgbGV0IG11dCBjb21wcmVzc2VkX2xlbjogaTMyID0gMDsKCiAgICBmbiBnZW5lcmF0ZV9pbnB1dChkYXRhOiAmbXV0IFtpMzI7IDUxMl0pIHsKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCA1MTIpIHsKICAgICAgICAgICAgaWYgKGkgJSAyMCA8IDEwKSB7CiAgICAgICAgICAgICAgICBkYXRhW2kgYXMgdXNpemVdID0gKGkgJSAxMCkgKyA2NTsgLy8gJ0EnIHRocm91Z2ggJ0onCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBkYXRhW2kgYXMgdXNpemVdID0gKGkgKiAxNyAlIDE1KSArIDk3OyAvLyAnYScgdGhyb3VnaCAnbycKICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIC8vIENyZWF0ZSBzb21lIGxvbmcgcmVwZWF0aW5nIHBhdHRlcm5zCiAgICAgICAgaSA9IDEwMDsKICAgICAgICB3aGlsZSAoaSA8IDEyMCkgewogICAgICAgICAgICBkYXRhW2kgYXMgdXNpemVdID0gZGF0YVtpIGFzIHVzaXplIC0gMjBdOwogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSAzMDA7CiAgICAgICAgd2hpbGUgKGkgPCAzMzApIHsKICAgICAgICAgICAgZGF0YVtpIGFzIHVzaXplXSA9IGRhdGFbaSBhcyB1c2l6ZSAtIDMwXTsKICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KICAgIH0KCiAgICBmbiBmaW5kX2xvbmdlc3RfbWF0Y2goZGF0YTogJltpMzI7IDUxMl0sIGN1cnJlbnRfcG9zOiBpMzIsIHNlYXJjaF9idWZmZXJfc3RhcnQ6IGkzMikgLT4gaTMyIHsKICAgICAgICBsZXQgbXV0IGJlc3RfbWF0Y2hfbGVuOiBpMzIgPSAwOwogICAgICAgIGxldCBtdXQgYmVzdF9tYXRjaF9vZmZzZXQ6IGkzMiA9IDA7CiAgICAgICAgbGV0IG1heF9sb29rYWhlYWQ6IGkzMiA9IDE4OwoKICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IGN1cnJlbnRfcG9zIC0gMTsKICAgICAgICB3aGlsZSAoaSA+PSBzZWFyY2hfYnVmZmVyX3N0YXJ0KSB7CiAgICAgICAgICAgIGxldCBtdXQgY3VycmVudF9tYXRjaF9sZW46IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChjdXJyZW50X3BvcyArIGN1cnJlbnRfbWF0Y2hfbGVuIDwgNTEyICYmCiAgICAgICAgICAgICAgICAgIGN1cnJlbnRfbWF0Y2hfbGVuIDwgbWF4X2xvb2thaGVhZCAmJgogICAgICAgICAgICAgICAgICBkYXRhWyhpICsgY3VycmVudF9tYXRjaF9sZW4pIGFzIHVzaXplXSA9PSBkYXRhWyhjdXJyZW50X3BvcyArIGN1cnJlbnRfbWF0Y2hfbGVuKSBhcyB1c2l6ZV0pIHsKICAgICAgICAgICAgICAgIGN1cnJlbnRfbWF0Y2hfbGVuID0gY3VycmVudF9tYXRjaF9sZW4gKyAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY3VycmVudF9tYXRjaF9sZW4gPiBiZXN0X21hdGNoX2xlbikgewogICAgICAgICAgICAgICAgYmVzdF9tYXRjaF9sZW4gPSBjdXJyZW50X21hdGNoX2xlbjsKICAgICAgICAgICAgICAgIGJlc3RfbWF0Y2hfb2Zmc2V0ID0gY3VycmVudF9wb3MgLSBpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpIC0gMTsKICAgICAgICB9CgogICAgICAgIGlmIChiZXN0X21hdGNoX2xlbiA+PSAzKSB7CiAgICAgICAgICAgIHJldHVybiAoYmVzdF9tYXRjaF9vZmZzZXQgKiAxMDAwKSArIGJlc3RfbWF0Y2hfbGVuOwogICAgICAgIH0KICAgICAgICByZXR1cm4gMDsKICAgIH0KCiAgICBnZW5lcmF0ZV9pbnB1dCgmbXV0IGlucHV0X2RhdGEpOwoKICAgIGxldCBtdXQgY3VycmVudF9wb3M6IGkzMiA9IDA7CiAgICBsZXQgd2luZG93X3NpemU6IGkzMiA9IDEyODsKCiAgICB3aGlsZSAoY3VycmVudF9wb3MgPCA1MTIpIHsKICAgICAgICBsZXQgc2VhcmNoX2J1ZmZlcl9zdGFydDogaTMyID0gaWYgKGN1cnJlbnRfcG9zID4gd2luZG93X3NpemUpIHsKICAgICAgICAgICAgY3VycmVudF9wb3MgLSB3aW5kb3dfc2l6ZQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIDAKICAgICAgICB9OwoKICAgICAgICBsZXQgbWF0Y2hfcmVzdWx0OiBpMzIgPSBmaW5kX2xvbmdlc3RfbWF0Y2goJmlucHV0X2RhdGEsIGN1cnJlbnRfcG9zLCBzZWFyY2hfYnVmZmVyX3N0YXJ0KTsKCiAgICAgICAgaWYgKG1hdGNoX3Jlc3VsdCA+IDApIHsKICAgICAgICAgICAgbGV0IG9mZnNldDogaTMyID0gbWF0Y2hfcmVzdWx0IC8gMTAwMDsKICAgICAgICAgICAgbGV0IGxlbjogaTMyID0gbWF0Y2hfcmVzdWx0ICUgMTAwMDsKCiAgICAgICAgICAgIGNvbXByZXNzZWRfZGF0YVtjb21wcmVzc2VkX2xlbiBhcyB1c2l6ZV0gPSAxOyAvLyBUeXBlIDE6IG1hdGNoCiAgICAgICAgICAgIGNvbXByZXNzZWRfbGVuID0gY29tcHJlc3NlZF9sZW4gKyAxOwogICAgICAgICAgICBjb21wcmVzc2VkX2RhdGFbY29tcHJlc3NlZF9sZW4gYXMgdXNpemVdID0gb2Zmc2V0OwogICAgICAgICAgICBjb21wcmVzc2VkX2xlbiA9IGNvbXByZXNzZWRfbGVuICsgMTsKICAgICAgICAgICAgY29tcHJlc3NlZF9kYXRhW2NvbXByZXNzZWRfbGVuIGFzIHVzaXplXSA9IGxlbjsKICAgICAgICAgICAgY29tcHJlc3NlZF9sZW4gPSBjb21wcmVzc2VkX2xlbiArIDE7CiAgICAgICAgICAgIGN1cnJlbnRfcG9zID0gY3VycmVudF9wb3MgKyBsZW47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gRml4ZWQ6IGRlY2xhcmUgYW5kIGFzc2lnbiBsaXRlcmFsX3ZhbHVlIG91dHNpZGUgdGhlIGlubmVyIGlmIGJsb2NrCiAgICAgICAgICAgIC8vIHRvIGVuc3VyZSBpdCBpcyBhbHdheXMgaW4gc2NvcGUuCiAgICAgICAgICAgIGxldCBsaXRlcmFsX3ZhbHVlOiBpMzIgPSBpbnB1dF9kYXRhW2N1cnJlbnRfcG9zIGFzIHVzaXplXTsKICAgICAgICAgICAgaWYgKGNvbXByZXNzZWRfbGVuIDwgNTEwKSB7CiAgICAgICAgICAgICAgICBjb21wcmVzc2VkX2RhdGFbY29tcHJlc3NlZF9sZW4gYXMgdXNpemVdID0gMDsgLy8gVHlwZSAwOiBsaXRlcmFsCiAgICAgICAgICAgICAgICBjb21wcmVzc2VkX2xlbiA9IGNvbXByZXNzZWRfbGVuICsgMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb21wcmVzc2VkX2RhdGFbY29tcHJlc3NlZF9sZW4gYXMgdXNpemVdID0gbGl0ZXJhbF92YWx1ZTsKICAgICAgICAgICAgY29tcHJlc3NlZF9sZW4gPSBjb21wcmVzc2VkX2xlbiArIDE7CiAgICAgICAgICAgIGN1cnJlbnRfcG9zID0gY3VycmVudF9wb3MgKyAxOwogICAgICAgIH0KICAgIH0KCiAgICBsZXQgbXV0IGNoZWNrc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCBjb21wcmVzc2VkX2xlbikgewogICAgICAgIGNoZWNrc3VtID0gY2hlY2tzdW0gKyBjb21wcmVzc2VkX2RhdGFbaSBhcyB1c2l6ZV0gKiAoaSArIDEpOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHByaW50bG5JbnQoY2hlY2tzdW0pOwogICAgcHJpbnRsbkludChjb21wcmVzc2VkX2xlbik7CiAgICBleGl0KDApOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (46, "comprehensive46", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IFJheSBUcmFjaW5nIFNjZW5lIFJlbmRlcmVyClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpGbG9hdGluZy1wb2ludC1saWtlIGNhbGN1bGF0aW9ucyB1c2luZyBzY2FsZWQgaW50ZWdlcnMuCkNvbXBsZXggZ2VvbWV0cmljIGNvbXB1dGF0aW9ucyAoaW50ZXJzZWN0aW9ucywgbm9ybWFscykuCkRlZXAgcmVjdXJzaW9uIGZvciByYXkgYm91bmNpbmcgYW5kIHJlZmxlY3Rpb25zLgpQZXJmb3JtYW5jZSBvZiB2ZWN0b3ItbGlrZSBvcGVyYXRpb25zIG9uIHNtYWxsIGFycmF5cy4KT3B0aW1pemF0aW9uIG9mIGxvb3BzIG92ZXIgcGl4ZWxzIGFuZCBvYmplY3RzLgpGdW5jdGlvbiBpbmxpbmluZyBmb3IgbWF0aCBhbmQgdXRpbGl0eSBmdW5jdGlvbnMuCiovCgovLyBjb21wcmVoZW5zaXZlNDYucnggLSBSYXkgVHJhY2luZyBTY2VuZSBSZW5kZXJlcgovLyBUaGlzIHRlc3QgY29tcHJlaGVuc2l2ZWx5IGV2YWx1YXRlcyBjb21waWxlciBvcHRpbWl6YXRpb25zIGZvcjoKLy8gLSBGbG9hdGluZy1wb2ludC1saWtlIGNhbGN1bGF0aW9ucyB1c2luZyBzY2FsZWQgaW50ZWdlcnMuCi8vIC0gQ29tcGxleCBnZW9tZXRyaWMgY29tcHV0YXRpb25zIChpbnRlcnNlY3Rpb25zLCBub3JtYWxzKS4KLy8gLSBEZWVwIHJlY3Vyc2lvbiBmb3IgcmF5IGJvdW5jaW5nIGFuZCByZWZsZWN0aW9ucy4KLy8gLSBQZXJmb3JtYW5jZSBvZiB2ZWN0b3ItbGlrZSBvcGVyYXRpb25zIG9uIHNtYWxsIGFycmF5cy4KLy8gLSBPcHRpbWl6YXRpb24gb2YgbG9vcHMgb3ZlciBwaXhlbHMgYW5kIG9iamVjdHMuCi8vIC0gRnVuY3Rpb24gaW5saW5pbmcgZm9yIG1hdGggYW5kIHV0aWxpdHkgZnVuY3Rpb25zLgoKY29uc3Qgc2NhbGU6IGkzMiA9IDgwOyAvLyBTY2FsZSBmYWN0b3IgZm9yIGZpeGVkLXBvaW50IGFyaXRobWV0aWMKZm4gbWFpbigpIHsKICAgIHN0cnVjdCBWZWMzIHsgeDogaTMyLCB5OiBpMzIsIHo6IGkzMiwgfQogICAgc3RydWN0IFJheSB7IG9yaWdpbjogVmVjMywgZGlyOiBWZWMzLCB9CiAgICBzdHJ1Y3QgU3BoZXJlIHsgY2VudGVyOiBWZWMzLCByYWRpdXM6IGkzMiwgY29sb3I6IFZlYzMsIH0KICAgIHN0cnVjdCBMaWdodCB7IHBvczogVmVjMywgaW50ZW5zaXR5OiBpMzIsIH0KCiAgICBsZXQgbXV0IHNjcmVlbjogW1tpMzI7IDY0XTsgNjRdID0gW1swOyA2NF07IDY0XTsKICAgIGxldCBtdXQgc3BoZXJlczogW1NwaGVyZTsgNF0gPSBbCiAgICAgICAgU3BoZXJlIHsgY2VudGVyOiBWZWMzIHt4OjAseTowLHo6MH0sIHJhZGl1czogMCwgY29sb3I6IFZlYzMge3g6MCx5OjAsejowfSB9OyA0CiAgICBdOwogICAgbGV0IG11dCBsaWdodHM6IFtMaWdodDsgMl0gPSBbCiAgICAgICAgTGlnaHQgeyBwb3M6IFZlYzMge3g6MCx5OjAsejowfSwgaW50ZW5zaXR5OiAwIH07IDIKICAgIF07CgogICAgZm4gc2V0dXBfc2NlbmUoc3BoZXJlczogJm11dCBbU3BoZXJlOyA0XSwgbGlnaHRzOiAmbXV0IFtMaWdodDsgMl0pIHsKICAgICAgICBzcGhlcmVzWzBdID0gU3BoZXJlIHsgY2VudGVyOiBWZWMzIHsgeDogMCwgeTogLTEgKiBzY2FsZSwgejogMyAqIHNjYWxlIH0sIHJhZGl1czogMSAqIHNjYWxlLCBjb2xvcjogVmVjMyB7IHg6IDI1NSwgeTogMCwgejogMCB9IH07CiAgICAgICAgc3BoZXJlc1sxXSA9IFNwaGVyZSB7IGNlbnRlcjogVmVjMyB7IHg6IDIgKiBzY2FsZSwgeTogMCwgejogNCAqIHNjYWxlIH0sIHJhZGl1czogMSAqIHNjYWxlLCBjb2xvcjogVmVjMyB7IHg6IDAsIHk6IDAsIHo6IDI1NSB9IH07CiAgICAgICAgc3BoZXJlc1syXSA9IFNwaGVyZSB7IGNlbnRlcjogVmVjMyB7IHg6IC0yICogc2NhbGUsIHk6IDAsIHo6IDQgKiBzY2FsZSB9LCByYWRpdXM6IDEgKiBzY2FsZSwgY29sb3I6IFZlYzMgeyB4OiAwLCB5OiAyNTUsIHo6IDAgfSB9OwogICAgICAgIHNwaGVyZXNbM10gPSBTcGhlcmUgeyBjZW50ZXI6IFZlYzMgeyB4OiAwLCB5OiAtMjAxICogc2NhbGUsIHo6IDAgfSwgcmFkaXVzOiAyMDAgKiBzY2FsZSwgY29sb3I6IFZlYzMgeyB4OiAyMDAsIHk6IDIwMCwgejogMCB9IH07CiAgICAgICAgbGlnaHRzWzBdID0gTGlnaHQgeyBwb3M6IFZlYzMgeyB4OiAtMjAgKiBzY2FsZSwgeTogMjAgKiBzY2FsZSwgejogLTIwICogc2NhbGUgfSwgaW50ZW5zaXR5OiAxNTAgfTsKICAgICAgICBsaWdodHNbMV0gPSBMaWdodCB7IHBvczogVmVjMyB7IHg6IDIwICogc2NhbGUsIHk6IDMwICogc2NhbGUsIHo6IC0xMCAqIHNjYWxlIH0sIGludGVuc2l0eTogMTIwIH07CiAgICB9CgogICAgZm4gdmVjX2RvdChhOiAmVmVjMywgYjogJlZlYzMpIC0+IGkzMiB7CiAgICAgICAgcmV0dXJuIChhLnggKiBiLnggKyBhLnkgKiBiLnkgKyBhLnogKiBiLnopIC8gc2NhbGU7CiAgICB9CgogICAgZm4gdmVjX3N1YihhOiAmVmVjMywgYjogJlZlYzMpIC0+IFZlYzMgewogICAgICAgIHJldHVybiBWZWMzIHsgeDogYS54IC0gYi54LCB5OiBhLnkgLSBiLnksIHo6IGEueiAtIGIueiB9OwogICAgfQoKICAgIGZuIGludGVyc2VjdChyYXk6ICZSYXksIHNwaGVyZTogJlNwaGVyZSkgLT4gaTMyIHsKICAgICAgICBsZXQgb2M6IFZlYzMgPSB2ZWNfc3ViKCZyYXkub3JpZ2luLCAmc3BoZXJlLmNlbnRlcik7CiAgICAgICAgbGV0IGE6IGkzMiA9IHZlY19kb3QoJnJheS5kaXIsICZyYXkuZGlyKTsKICAgICAgICBsZXQgYjogaTMyID0gMiAqIHZlY19kb3QoJm9jLCAmcmF5LmRpcik7CiAgICAgICAgbGV0IGM6IGkzMiA9IHZlY19kb3QoJm9jLCAmb2MpIC0gKHNwaGVyZS5yYWRpdXMgKiBzcGhlcmUucmFkaXVzKSAvIHNjYWxlOwogICAgICAgIGxldCBkaXNjcmltaW5hbnQ6IGkzMiA9IGIgKiBiIC0gNCAqIGEgKiBjIC8gc2NhbGU7CiAgICAgICAgaWYgKGRpc2NyaW1pbmFudCA8IDApIHsKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0KICAgICAgICAvLyBTaW1wbGlmaWVkIHRvIHJldHVybiBuZWFyZXN0IGludGVyc2VjdGlvbgogICAgICAgIHJldHVybiAoLWIgLSBpc3FydChkaXNjcmltaW5hbnQpKSAvICgyICogYSAvIHNjYWxlKTsKICAgIH0KICAgIAogICAgLy8gSGlkZGVuIEVycm9yOiBgaXNxcnRgIGlzIGRlZmluZWQgYWZ0ZXIgaXQgaXMgZmlyc3QgdXNlZCBpbiBgaW50ZXJzZWN0YC4KICAgIC8vIEEgc2ltcGxlLCBzaW5nbGUtcGFzcyBjb21waWxlciB3b3VsZCBmYWlsIGhlcmUuCiAgICBmbiBpc3FydChuOiBpMzIpIC0+IGkzMiB7CiAgICAgICAgaWYgKG4gPCAwKSB7IHJldHVybiAwOyB9CiAgICAgICAgbGV0IG11dCB4OiBpMzIgPSBuOwogICAgICAgIGxldCBtdXQgeTogaTMyID0gKHggKyAxKSAvIDI7CiAgICAgICAgd2hpbGUgKHkgPCB4KSB7CiAgICAgICAgICAgIHggPSB5OwogICAgICAgICAgICB5ID0gKHggKyBuIC8geCkgLyAyOwogICAgICAgIH0KICAgICAgICByZXR1cm4geDsKICAgIH0KCiAgICBzZXR1cF9zY2VuZSgmbXV0IHNwaGVyZXMsICZtdXQgbGlnaHRzKTsKCiAgICBsZXQgd2lkdGg6IGkzMiA9IDY0OwogICAgbGV0IGhlaWdodDogaTMyID0gNjQ7CiAgICBsZXQgbXV0IHk6IGkzMiA9IDA7CiAgICB3aGlsZSAoeSA8IGhlaWdodCkgewogICAgICAgIGxldCBtdXQgeDogaTMyID0gMDsKICAgICAgICB3aGlsZSAoeCA8IHdpZHRoKSB7CiAgICAgICAgICAgIGxldCByYXlfZGlyOiBWZWMzID0gVmVjMyB7CiAgICAgICAgICAgICAgICB4OiAoeCAtIHdpZHRoIC8gMikgKiBzY2FsZSAvIHdpZHRoLAogICAgICAgICAgICAgICAgeTogKHkgLSBoZWlnaHQgLyAyKSAqIHNjYWxlIC8gaGVpZ2h0LAogICAgICAgICAgICAgICAgejogc2NhbGUKICAgICAgICAgICAgfTsKICAgICAgICAgICAgbGV0IHJheTogUmF5ID0gUmF5IHsgb3JpZ2luOiBWZWMzIHsgeDogMCwgeTogMCwgejogLTEgKiBzY2FsZSB9LCBkaXI6IHJheV9kaXIgfTsKCiAgICAgICAgICAgIGxldCBtdXQgbWluX2Rpc3Q6IGkzMiA9IDEwMDAwICogc2NhbGU7CiAgICAgICAgICAgIGxldCBtdXQgaGl0X2NvbG9yOiBWZWMzID0gVmVjMyB7IHg6IDIwLCB5OiAyMCwgejogNDAgfTsgLy8gQmFja2dyb3VuZCBjb2xvcgogICAgICAgICAgICBsZXQgbXV0IHM6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChzIDwgNCkgewogICAgICAgICAgICAgICAgbGV0IGRpc3Q6IGkzMiA9IGludGVyc2VjdCgmcmF5LCAmc3BoZXJlc1tzIGFzIHVzaXplXSk7CiAgICAgICAgICAgICAgICBpZiAoZGlzdCA+IDAgJiYgZGlzdCA8IG1pbl9kaXN0KSB7CiAgICAgICAgICAgICAgICAgICAgbWluX2Rpc3QgPSBkaXN0OwogICAgICAgICAgICAgICAgICAgIGhpdF9jb2xvciA9IHNwaGVyZXNbcyBhcyB1c2l6ZV0uY29sb3I7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzID0gcyArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2NyZWVuW3ggYXMgdXNpemVdW3kgYXMgdXNpemVdID0gKGhpdF9jb2xvci54ICsgaGl0X2NvbG9yLnkgKyBoaXRfY29sb3IueikgLyAzOwogICAgICAgICAgICB4ID0geCArIDE7CiAgICAgICAgfQogICAgICAgIHkgPSB5ICsgMTsKICAgIH0KCiAgICBsZXQgbXV0IGNoZWNrc3VtOiBpMzIgPSAwOwogICAgeSA9IDA7CiAgICB3aGlsZSAoeSA8IGhlaWdodCkgewogICAgICAgIGxldCBtdXQgeDogaTMyID0gMDsKICAgICAgICB3aGlsZSAoeCA8IHdpZHRoKSB7CiAgICAgICAgICAgIGNoZWNrc3VtID0gY2hlY2tzdW0gKyBzY3JlZW5beCBhcyB1c2l6ZV1beSBhcyB1c2l6ZV0gKiAoeCArIHkgKiB3aWR0aCk7CiAgICAgICAgICAgIHggPSB4ICsgMTsKICAgICAgICB9CiAgICAgICAgeSA9IHkgKyAxOwogICAgfQogICAgcHJpbnRsbkludChjaGVja3N1bSk7CiAgICBleGl0KDApOwp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (47, "comprehensive47", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEdlbmV0aWMgQWxnb3JpdGhtIGZvciBPcHRpbWl6YXRpb24KU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6ClNpbXVsYXRpb24gb2YgZXZvbHV0aW9uYXJ5IHByb2Nlc3NlcyB3aXRoIHNlbGVjdGlvbiwgY3Jvc3NvdmVyLCBhbmQgbXV0YXRpb24uCkNvbXBsZXggZml0bmVzcyBmdW5jdGlvbiBjYWxjdWxhdGlvbnMgaW52b2x2aW5nIG5vbi1saW5lYXIgb3BlcmF0aW9ucy4KTWFuYWdlbWVudCBvZiBhIHBvcHVsYXRpb24gb2YgY2FuZGlkYXRlIHNvbHV0aW9ucyAobGFyZ2UgYXJyYXkgb2Ygc3RydWN0cykuClJhbmRvbSBudW1iZXIgZ2VuZXJhdGlvbiBhbmQgaXRzIGltcGFjdCBvbiBjb250cm9sIGZsb3cuCkxvb3AtaGVhdnkgb3BlcmF0aW9ucyBmb3IgZXZhbHVhdGluZyBhbmQgZXZvbHZpbmcgdGhlIHBvcHVsYXRpb24uClJlLXVzZSBvZiB2YXJpYWJsZXMgd2l0aCBkaWZmZXJlbnQgbWVhbmluZ3MgaW4gZGlmZmVyZW50IHNjb3Blcy4KKi8KCi8vIGNvbXByZWhlbnNpdmU0Ny5yeCAtIEdlbmV0aWMgQWxnb3JpdGhtIGZvciBPcHRpbWl6YXRpb24KLy8gVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6Ci8vIC0gU2ltdWxhdGlvbiBvZiBldm9sdXRpb25hcnkgcHJvY2Vzc2VzIHdpdGggc2VsZWN0aW9uLCBjcm9zc292ZXIsIGFuZCBtdXRhdGlvbi4KLy8gLSBDb21wbGV4IGZpdG5lc3MgZnVuY3Rpb24gY2FsY3VsYXRpb25zIGludm9sdmluZyBub24tbGluZWFyIG9wZXJhdGlvbnMuCi8vIC0gTWFuYWdlbWVudCBvZiBhIHBvcHVsYXRpb24gb2YgY2FuZGlkYXRlIHNvbHV0aW9ucyAobGFyZ2UgYXJyYXkgb2Ygc3RydWN0cykuCi8vIC0gUmFuZG9tIG51bWJlciBnZW5lcmF0aW9uIGFuZCBpdHMgaW1wYWN0IG9uIGNvbnRyb2wgZmxvdy4KLy8gLSBMb29wLWhlYXZ5IG9wZXJhdGlvbnMgZm9yIGV2YWx1YXRpbmcgYW5kIGV2b2x2aW5nIHRoZSBwb3B1bGF0aW9uLgovLyAtIFJlLXVzZSBvZiB2YXJpYWJsZXMgd2l0aCBkaWZmZXJlbnQgbWVhbmluZ3MgaW4gZGlmZmVyZW50IHNjb3Blcy4KCmZuIG1haW4oKSB7CiAgICBzdHJ1Y3QgQ2hyb21vc29tZSB7CiAgICAgICAgZ2VuZXM6IFtpMzI7IDE2XSwKICAgICAgICBmaXRuZXNzOiBpMzIsCiAgICB9CgogICAgbGV0IG11dCBwb3B1bGF0aW9uOiBbQ2hyb21vc29tZTsgNjRdID0gW0Nocm9tb3NvbWUgewogICAgICAgIGdlbmVzOiBbMDsgMTZdLAogICAgICAgIGZpdG5lc3M6IDAsCiAgICB9OyA2NF07CiAgICBsZXQgbXV0IHJuZ19zZWVkOiBpMzIgPSAxMjM0NTsKCiAgICBmbiBwc2V1ZG9fcmFuZChzZWVkOiAmbXV0IGkzMikgLT4gaTMyIHsKICAgICAgICAqc2VlZCA9ICgqc2VlZCAqIDEyNyArIDE2Nzc3MzM3KSAmIDE2Nzc3MjE1OwogICAgICAgIHJldHVybiAqc2VlZDsKICAgIH0KCiAgICBmbiBpbml0X3BvcHVsYXRpb24ocG9wOiAmbXV0IFtDaHJvbW9zb21lOyA2NF0sIHNlZWQ6ICZtdXQgaTMyKSB7CiAgICAgICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCA2NCkgewogICAgICAgICAgICBsZXQgbXV0IGo6IHVzaXplID0gMDsKICAgICAgICAgICAgd2hpbGUgKGogPCAxNikgewogICAgICAgICAgICAgICAgcG9wW2kgYXMgdXNpemVdLmdlbmVzW2ogYXMgdXNpemVdID0gcHNldWRvX3JhbmQoc2VlZCkgJSAyMDAgLSAxMDA7CiAgICAgICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBGaXRuZXNzIGZ1bmN0aW9uOiB0cnkgdG8gbWFrZSBnZW5lcyBzdW0gdG8gYSB0YXJnZXQsIHdpdGggcGVuYWx0aWVzCiAgICBmbiBjYWxjdWxhdGVfZml0bmVzcyhjaHJvbTogJm11dCBDaHJvbW9zb21lKSB7CiAgICAgICAgbGV0IHRhcmdldF9zdW06IGkzMiA9IDUwMDsKICAgICAgICBsZXQgbXV0IHN1bTogaTMyID0gMDsKICAgICAgICBsZXQgbXV0IHBlbmFsdHk6IGkzMiA9IDA7CiAgICAgICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCAxNikgewogICAgICAgICAgICBzdW0gPSBzdW0gKyBjaHJvbS5nZW5lc1tpIGFzIHVzaXplXTsKICAgICAgICAgICAgaWYgKGNocm9tLmdlbmVzW2kgYXMgdXNpemVdID4gOTAgfHwgY2hyb20uZ2VuZXNbaSBhcyB1c2l6ZV0gPCAtOTApIHsKICAgICAgICAgICAgICAgIHBlbmFsdHkgPSBwZW5hbHR5ICsgKGNocm9tLmdlbmVzW2kgYXMgdXNpemVdICogY2hyb20uZ2VuZXNbaSBhcyB1c2l6ZV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICAgICAgbGV0IGRpZmY6IGkzMiA9IHRhcmdldF9zdW0gLSBzdW07CiAgICAgICAgY2hyb20uZml0bmVzcyA9IC0oZGlmZiAqIGRpZmYpIC0gcGVuYWx0eTsgLy8gTWF4aW1pemUgZml0bmVzcyAoY2xvc2VyIHRvIDAgaXMgYmV0dGVyKQogICAgfQoKICAgIGZuIGV2YWx1YXRlX3BvcHVsYXRpb24ocG9wOiAmbXV0IFtDaHJvbW9zb21lOyA2NF0pIHsKICAgICAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgICAgICB3aGlsZSAoaSA8IDY0KSB7CiAgICAgICAgICAgIGNhbGN1bGF0ZV9maXRuZXNzKCZtdXQgcG9wW2kgYXMgdXNpemVdKTsKICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KICAgIH0KCiAgICBmbiBzZWxlY3Rpb24ocG9wOiAmW0Nocm9tb3NvbWU7IDY0XSwgc2VlZDogJm11dCBpMzIpIC0+IGkzMiB7CiAgICAgICAgbGV0IHRvdXJuYW1lbnRfc2l6ZTogaTMyID0gNTsKICAgICAgICBsZXQgbXV0IGJlc3RfaW5kZXg6IGkzMiA9IC0xOwogICAgICAgIGxldCBtdXQgYmVzdF9maXRuZXNzOiBpMzIgPSAtOTk5OTk5OTk7CiAgICAgICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChpIDwgdG91cm5hbWVudF9zaXplKSB7CiAgICAgICAgICAgIGxldCBpZHg6IHVzaXplID0gcHNldWRvX3JhbmQoc2VlZCkgYXMgdXNpemUgJSA2NDsKICAgICAgICAgICAgaWYgKHBvcFtpZHggYXMgdXNpemVdLmZpdG5lc3MgPiBiZXN0X2ZpdG5lc3MpIHsKICAgICAgICAgICAgICAgIGJlc3RfZml0bmVzcyA9IHBvcFtpZHggYXMgdXNpemVdLmZpdG5lc3M7CiAgICAgICAgICAgICAgICBiZXN0X2luZGV4ID0gaWR4IGFzIGkzMjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgICAgIHJldHVybiBiZXN0X2luZGV4OwogICAgfQoKICAgIGZuIGNyb3Nzb3ZlcigKICAgICAgICBwYXJlbnQxOiAmQ2hyb21vc29tZSwKICAgICAgICBwYXJlbnQyOiAmQ2hyb21vc29tZSwKICAgICAgICBjaGlsZDogJm11dCBDaHJvbW9zb21lLAogICAgICAgIHNlZWQ6ICZtdXQgaTMyLAogICAgKSB7CiAgICAgICAgbGV0IGNyb3Nzb3Zlcl9wb2ludDogaTMyID0gcHNldWRvX3JhbmQoc2VlZCkgJSAxNjsKICAgICAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgICAgICB3aGlsZSAoaSA8IDE2KSB7CiAgICAgICAgICAgIGlmIChpIDwgY3Jvc3NvdmVyX3BvaW50IGFzIHVzaXplKSB7CiAgICAgICAgICAgICAgICBjaGlsZC5nZW5lc1tpIGFzIHVzaXplXSA9IHBhcmVudDEuZ2VuZXNbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjaGlsZC5nZW5lc1tpIGFzIHVzaXplXSA9IHBhcmVudDIuZ2VuZXNbaSBhcyB1c2l6ZV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KICAgIH0KCiAgICBmbiBtdXRhdGUoY2hyb206ICZtdXQgQ2hyb21vc29tZSwgc2VlZDogJm11dCBpMzIpIHsKICAgICAgICBsZXQgbXV0YXRpb25fcmF0ZTogaTMyID0gMTA7IC8vIG91dCBvZiAxMDAKICAgICAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgICAgICB3aGlsZSAoaSA8IDE2KSB7CiAgICAgICAgICAgIGlmIChwc2V1ZG9fcmFuZChzZWVkKSAlIDEwMCA8IG11dGF0aW9uX3JhdGUpIHsKICAgICAgICAgICAgICAgIGNocm9tLmdlbmVzW2kgYXMgdXNpemVdID0gY2hyb20uZ2VuZXNbaSBhcyB1c2l6ZV0gKyAocHNldWRvX3JhbmQoc2VlZCkgJSAyMCAtIDEwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpID0gaSArIDE7CiAgICAgICAgfQogICAgfQoKICAgIGluaXRfcG9wdWxhdGlvbigmbXV0IHBvcHVsYXRpb24sICZtdXQgcm5nX3NlZWQpOwoKICAgIGxldCBtdXQgZ2VuZXJhdGlvbjogaTMyID0gMDsKICAgIHdoaWxlIChnZW5lcmF0aW9uIDwgNTApIHsKICAgICAgICBldmFsdWF0ZV9wb3B1bGF0aW9uKCZtdXQgcG9wdWxhdGlvbik7CiAgICAgICAgbGV0IG11dCBuZXdfcG9wdWxhdGlvbjogW0Nocm9tb3NvbWU7IDY0XSA9IFtDaHJvbW9zb21lIHsKICAgICAgICAgICAgZ2VuZXM6IFswOyAxNl0sCiAgICAgICAgICAgIGZpdG5lc3M6IDAsCiAgICAgICAgfTsgNjRdOwoKICAgICAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgICAgICB3aGlsZSAoaSA8IDY0KSB7CiAgICAgICAgICAgIGxldCBwMV9pZHg6IHVzaXplID0gc2VsZWN0aW9uKCZwb3B1bGF0aW9uLCAmbXV0IHJuZ19zZWVkKSBhcyB1c2l6ZTsKICAgICAgICAgICAgbGV0IHAyX2lkeDogdXNpemUgPSBzZWxlY3Rpb24oJnBvcHVsYXRpb24sICZtdXQgcm5nX3NlZWQpIGFzIHVzaXplOwogICAgICAgICAgICBjcm9zc292ZXIoCiAgICAgICAgICAgICAgICAmcG9wdWxhdGlvbltwMV9pZHggYXMgdXNpemVdLAogICAgICAgICAgICAgICAgJnBvcHVsYXRpb25bcDJfaWR4IGFzIHVzaXplXSwKICAgICAgICAgICAgICAgICZtdXQgbmV3X3BvcHVsYXRpb25baSBhcyB1c2l6ZV0sCiAgICAgICAgICAgICAgICAmbXV0IHJuZ19zZWVkLAogICAgICAgICAgICApOwogICAgICAgICAgICBtdXRhdGUoJm11dCBuZXdfcG9wdWxhdGlvbltpIGFzIHVzaXplXSwgJm11dCBybmdfc2VlZCk7CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CgogICAgICAgIC8vIEhpZGRlbiBFcnJvcjogVGhlIHZhcmlhYmxlIGBpYCBpcyByZS1kZWNsYXJlZCBpbiB0aGlzIGlubmVyIHNjb3BlLAogICAgICAgIC8vIHNoYWRvd2luZyB0aGUgb3V0ZXIgYGlgLiBBIGNvbXBpbGVyIHNob3VsZCBjYXRjaCB0aGlzIHJlLWRlY2xhcmF0aW9uCiAgICAgICAgLy8gaW4gdGhlIHNhbWUgZnVuY3Rpb24gYmxvY2suCiAgICAgICAgbGV0IG11dCBpOiB1c2l6ZSA9IDA7CiAgICAgICAgd2hpbGUgKGkgPCA2NCkgewogICAgICAgICAgICBwb3B1bGF0aW9uW2kgYXMgdXNpemVdID0gbmV3X3BvcHVsYXRpb25baSBhcyB1c2l6ZV07CiAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICB9CiAgICAgICAgZ2VuZXJhdGlvbiA9IGdlbmVyYXRpb24gKyAxOwogICAgfQoKICAgIGV2YWx1YXRlX3BvcHVsYXRpb24oJm11dCBwb3B1bGF0aW9uKTsKICAgIGxldCBtdXQgYmVzdF9maXRuZXNzOiBpMzIgPSAtOTk5OTk5OTk7CiAgICBsZXQgbXV0IGk6IHVzaXplID0gMDsKICAgIHdoaWxlIChpIDwgNjQpIHsKICAgICAgICBpZiAocG9wdWxhdGlvbltpIGFzIHVzaXplXS5maXRuZXNzID4gYmVzdF9maXRuZXNzKSB7CiAgICAgICAgICAgIGJlc3RfZml0bmVzcyA9IHBvcHVsYXRpb25baSBhcyB1c2l6ZV0uZml0bmVzczsKICAgICAgICB9CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgcHJpbnRsbkludChiZXN0X2ZpdG5lc3MpOwogICAgZXhpdCgwKTsKfQo=", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (48, "comprehensive48", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEFkdmFuY2VkIExvZ2lzdGljcyBhbmQgU3VwcGx5IENoYWluIFNpbXVsYXRpb24KU3VtbWFyeTogVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6CkRldGFpbHM6Ck1hbmFnZW1lbnQgb2YgY29tcGxleCwgbmVzdGVkIGRhdGEgc3RydWN0dXJlcyBmb3IgaW52ZW50b3J5IGFuZCBvcmRlcnMKT3B0aW1pemF0aW9uIG9mIGFycmF5LWhlYXZ5IG9wZXJhdGlvbnMgZm9yIHN0b2NrIG1hbmFnZW1lbnQKQnJhbmNoIHByZWRpY3Rpb24gYW5kIG9wdGltaXphdGlvbiBpbiBjb21wbGV4IGNvbmRpdGlvbmFsIGxvZ2ljIGZvciBvcmRlciBwcm9jZXNzaW5nCkZ1bmN0aW9uIGNhbGwgb3B0aW1pemF0aW9uIGluIGEgZGVlcGx5IG5lc3RlZCBjYWxsIGdyYXBoCkludGVnZXIgYXJpdGhtZXRpYyBhbmQgZGF0YSBmbG93IGFuYWx5c2lzIGluIGEgc2ltdWxhdGVkIGVudmlyb25tZW50CkNvcm5lciBjYXNlIGhhbmRsaW5nIGZvciBzdG9jayBsZXZlbHMgKGUuZy4sIHplcm8gc3RvY2ssIGJhY2tvcmRlcnMpCiovCgovLyBjb21wcmVoZW5zaXZlNDgucnggLSBBZHZhbmNlZCBMb2dpc3RpY3MgYW5kIFN1cHBseSBDaGFpbiBTaW11bGF0aW9uCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIE1hbmFnZW1lbnQgb2YgY29tcGxleCwgbmVzdGVkIGRhdGEgc3RydWN0dXJlcyBmb3IgaW52ZW50b3J5IGFuZCBvcmRlcnMKLy8gLSBPcHRpbWl6YXRpb24gb2YgYXJyYXktaGVhdnkgb3BlcmF0aW9ucyBmb3Igc3RvY2sgbWFuYWdlbWVudAovLyAtIEJyYW5jaCBwcmVkaWN0aW9uIGFuZCBvcHRpbWl6YXRpb24gaW4gY29tcGxleCBjb25kaXRpb25hbCBsb2dpYyBmb3Igb3JkZXIgcHJvY2Vzc2luZwovLyAtIEZ1bmN0aW9uIGNhbGwgb3B0aW1pemF0aW9uIGluIGEgZGVlcGx5IG5lc3RlZCBjYWxsIGdyYXBoCi8vIC0gSW50ZWdlciBhcml0aG1ldGljIGFuZCBkYXRhIGZsb3cgYW5hbHlzaXMgaW4gYSBzaW11bGF0ZWQgZW52aXJvbm1lbnQKLy8gLSBDb3JuZXIgY2FzZSBoYW5kbGluZyBmb3Igc3RvY2sgbGV2ZWxzIChlLmcuLCB6ZXJvIHN0b2NrLCBiYWNrb3JkZXJzKQoKZm4gbWFpbigpIHsKICAgIGxldCBtdXQgd2FyZWhvdXNlX3N0b2NrX0E6IGkzMiA9IDEwMDA7CiAgICBsZXQgbXV0IHdhcmVob3VzZV9zdG9ja19COiBpMzIgPSAxNTAwOwogICAgbGV0IG11dCB3YXJlaG91c2Vfc3RvY2tfQzogaTMyID0gODAwOwoKICAgIGxldCBtdXQgcGVuZGluZ19vcmRlcnNfQTogaTMyID0gMDsKICAgIGxldCBtdXQgcGVuZGluZ19vcmRlcnNfQjogaTMyID0gMDsKICAgIGxldCBtdXQgcGVuZGluZ19vcmRlcnNfQzogaTMyID0gMDsKCiAgICBsZXQgbXV0IHByb2Nlc3NlZF9vcmRlcnM6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHRvdGFsX3JldmVudWU6IGkzMiA9IDA7CgogICAgbGV0IHByaWNlX0E6IGkzMiA9IDEwOwogICAgbGV0IHByaWNlX0I6IGkzMiA9IDE1OwogICAgbGV0IHByaWNlX0M6IGkzMiA9IDIwOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgMjAwKSB7CiAgICAgICAgbGV0IG9yZGVyX3R5cGU6IGkzMiA9IGkgJSAzOwogICAgICAgIGxldCBvcmRlcl9xdWFudGl0eTogaTMyID0gKGkgKiA3ICsgMTUpICUgNTAgKyAxMDsKCiAgICAgICAgaWYgKG9yZGVyX3R5cGUgPT0gMCkgewogICAgICAgICAgICBwZW5kaW5nX29yZGVyc19BID0gcGVuZGluZ19vcmRlcnNfQSArIG9yZGVyX3F1YW50aXR5OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChvcmRlcl90eXBlID09IDEpIHsKICAgICAgICAgICAgICAgIHBlbmRpbmdfb3JkZXJzX0IgPSBwZW5kaW5nX29yZGVyc19CICsgb3JkZXJfcXVhbnRpdHk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBwZW5kaW5nX29yZGVyc19DID0gcGVuZGluZ19vcmRlcnNfQyArIG9yZGVyX3F1YW50aXR5OwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoaSAlIDEwID09IDApIHsKICAgICAgICAgICAgd2FyZWhvdXNlX3N0b2NrX0EgPSB3YXJlaG91c2Vfc3RvY2tfQSArIDIwMDsKICAgICAgICAgICAgd2FyZWhvdXNlX3N0b2NrX0IgPSB3YXJlaG91c2Vfc3RvY2tfQiArIDMwMDsKICAgICAgICAgICAgd2FyZWhvdXNlX3N0b2NrX0MgPSB3YXJlaG91c2Vfc3RvY2tfQyArIDE1MDsKICAgICAgICB9CgogICAgICAgIGxldCBtdXQgY2FuX3Byb2Nlc3NfQTogYm9vbCA9IGZhbHNlOwogICAgICAgIGxldCBtdXQgY2FuX3Byb2Nlc3NfQjogYm9vbCA9IGZhbHNlOwogICAgICAgIGxldCBtdXQgY2FuX3Byb2Nlc3NfQzogYm9vbCA9IGZhbHNlOwoKICAgICAgICBpZiAocGVuZGluZ19vcmRlcnNfQSA+IDApIHsKICAgICAgICAgICAgaWYgKHdhcmVob3VzZV9zdG9ja19BID49IHBlbmRpbmdfb3JkZXJzX0EpIHsKICAgICAgICAgICAgICAgIGNhbl9wcm9jZXNzX0EgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChwZW5kaW5nX29yZGVyc19CID4gMCkgewogICAgICAgICAgICBpZiAod2FyZWhvdXNlX3N0b2NrX0IgPj0gcGVuZGluZ19vcmRlcnNfQikgewogICAgICAgICAgICAgICAgY2FuX3Byb2Nlc3NfQiA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHBlbmRpbmdfb3JkZXJzX0MgPiAwKSB7CiAgICAgICAgICAgIGlmICh3YXJlaG91c2Vfc3RvY2tfQyA+PSBwZW5kaW5nX29yZGVyc19DKSB7CiAgICAgICAgICAgICAgICBjYW5fcHJvY2Vzc19DID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbGV0IG11dCBzcGVjaWFsX2JvbnVzOiBpMzIgPSAwOwoKICAgICAgICBpZiAoY2FuX3Byb2Nlc3NfQSkgewogICAgICAgICAgICBsZXQgcmV2ZW51ZV9BOiBpMzIgPSBpZiAocGVuZGluZ19vcmRlcnNfQSA+IDUwKSB7CiAgICAgICAgICAgICAgICBsZXQgZGlzY291bnQ6IGkzMiA9IDU7CiAgICAgICAgICAgICAgICBzcGVjaWFsX2JvbnVzID0gMTAwOwogICAgICAgICAgICAgICAgcGVuZGluZ19vcmRlcnNfQSAqIChwcmljZV9BIC0gZGlzY291bnQpCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBwZW5kaW5nX29yZGVyc19BICogcHJpY2VfQQogICAgICAgICAgICB9OwogICAgICAgICAgICB3YXJlaG91c2Vfc3RvY2tfQSA9IHdhcmVob3VzZV9zdG9ja19BIC0gcGVuZGluZ19vcmRlcnNfQTsKICAgICAgICAgICAgdG90YWxfcmV2ZW51ZSA9IHRvdGFsX3JldmVudWUgKyByZXZlbnVlX0E7CiAgICAgICAgICAgIHByb2Nlc3NlZF9vcmRlcnMgPSBwcm9jZXNzZWRfb3JkZXJzICsgcGVuZGluZ19vcmRlcnNfQTsKICAgICAgICAgICAgcGVuZGluZ19vcmRlcnNfQSA9IDA7CiAgICAgICAgfQoKICAgICAgICBpZiAoY2FuX3Byb2Nlc3NfQikgewogICAgICAgICAgICBsZXQgcmV2ZW51ZV9COiBpMzIgPSBpZiAocGVuZGluZ19vcmRlcnNfQiA+IDQwKSB7CiAgICAgICAgICAgICAgICBsZXQgZGlzY291bnQ6IGkzMiA9IDM7CiAgICAgICAgICAgICAgICBwZW5kaW5nX29yZGVyc19CICogKHByaWNlX0IgLSBkaXNjb3VudCkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHBlbmRpbmdfb3JkZXJzX0IgKiBwcmljZV9CCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHdhcmVob3VzZV9zdG9ja19CID0gd2FyZWhvdXNlX3N0b2NrX0IgLSBwZW5kaW5nX29yZGVyc19COwogICAgICAgICAgICB0b3RhbF9yZXZlbnVlID0gdG90YWxfcmV2ZW51ZSArIHJldmVudWVfQjsKICAgICAgICAgICAgcHJvY2Vzc2VkX29yZGVycyA9IHByb2Nlc3NlZF9vcmRlcnMgKyBwZW5kaW5nX29yZGVyc19COwogICAgICAgICAgICBwZW5kaW5nX29yZGVyc19CID0gMDsKICAgICAgICB9CgogICAgICAgIGlmIChjYW5fcHJvY2Vzc19DKSB7CiAgICAgICAgICAgIGxldCByZXZlbnVlX0M6IGkzMiA9IGlmIChwZW5kaW5nX29yZGVyc19DID4gMzApIHsKICAgICAgICAgICAgICAgIGxldCBkaXNjb3VudDogaTMyID0gMjsKICAgICAgICAgICAgICAgIHBlbmRpbmdfb3JkZXJzX0MgKiAocHJpY2VfQyAtIGRpc2NvdW50KQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcGVuZGluZ19vcmRlcnNfQyAqIHByaWNlX0MKICAgICAgICAgICAgfTsKICAgICAgICAgICAgd2FyZWhvdXNlX3N0b2NrX0MgPSB3YXJlaG91c2Vfc3RvY2tfQyAtIHBlbmRpbmdfb3JkZXJzX0M7CiAgICAgICAgICAgIHRvdGFsX3JldmVudWUgPSB0b3RhbF9yZXZlbnVlICsgcmV2ZW51ZV9DOwogICAgICAgICAgICBwcm9jZXNzZWRfb3JkZXJzID0gcHJvY2Vzc2VkX29yZGVycyArIHBlbmRpbmdfb3JkZXJzX0M7CiAgICAgICAgICAgIHBlbmRpbmdfb3JkZXJzX0MgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKGkgJSAyNSA9PSAwKSB7CiAgICAgICAgICAgIGxldCBhdWRpdF9yZXN1bHQ6IGkzMiA9IHBlcmZvcm1fYXVkaXQoCiAgICAgICAgICAgICAgICB3YXJlaG91c2Vfc3RvY2tfQSwKICAgICAgICAgICAgICAgIHdhcmVob3VzZV9zdG9ja19CLAogICAgICAgICAgICAgICAgd2FyZWhvdXNlX3N0b2NrX0MsCiAgICAgICAgICAgICAgICB0b3RhbF9yZXZlbnVlLAogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoYXVkaXRfcmVzdWx0IDwgMCkgewogICAgICAgICAgICAgICAgdG90YWxfcmV2ZW51ZSA9IHRvdGFsX3JldmVudWUgKyBzcGVjaWFsX2JvbnVzOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpID0gaSArIDE7CiAgICB9CgogICAgcHJpbnRsbkludCh0b3RhbF9yZXZlbnVlKTsKICAgIHByaW50bG5JbnQocHJvY2Vzc2VkX29yZGVycyk7CiAgICBwcmludGxuSW50KHdhcmVob3VzZV9zdG9ja19BKTsKICAgIHByaW50bG5JbnQod2FyZWhvdXNlX3N0b2NrX0IpOwogICAgcHJpbnRsbkludCh3YXJlaG91c2Vfc3RvY2tfQyk7CiAgICBleGl0KDApOwp9CgpmbiBwZXJmb3JtX2F1ZGl0KHN0b2NrX2E6IGkzMiwgc3RvY2tfYjogaTMyLCBzdG9ja19jOiBpMzIsIHJldmVudWU6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgc2NvcmU6IGkzMiA9IDA7CiAgICBpZiAoc3RvY2tfYSA8IDEwMCkgewogICAgICAgIHNjb3JlID0gc2NvcmUgLSAxMDsKICAgIH0gZWxzZSB7CiAgICAgICAgc2NvcmUgPSBzY29yZSArIDU7CiAgICB9CiAgICBpZiAoc3RvY2tfYiA8IDE1MCkgewogICAgICAgIHNjb3JlID0gc2NvcmUgLSAxMDsKICAgIH0gZWxzZSB7CiAgICAgICAgc2NvcmUgPSBzY29yZSArIDU7CiAgICB9CiAgICBpZiAoc3RvY2tfYyA8IDgwKSB7CiAgICAgICAgc2NvcmUgPSBzY29yZSAtIDEwOwogICAgfSBlbHNlIHsKICAgICAgICBzY29yZSA9IHNjb3JlICsgNTsKICAgIH0KCiAgICBpZiAocmV2ZW51ZSA+IDUwMDAwKSB7CiAgICAgICAgc2NvcmUgPSBzY29yZSArIDIwOwogICAgfSBlbHNlIHsKICAgICAgICBpZiAocmV2ZW51ZSA+IDIwMDAwKSB7CiAgICAgICAgICAgIHNjb3JlID0gc2NvcmUgKyAxMDsKICAgICAgICB9CiAgICB9CgogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgbGV0IG11dCB0ZW1wX3JldjogaTMyID0gcmV2ZW51ZTsKICAgIHdoaWxlIChpIDwgNSkgewogICAgICAgIHRlbXBfcmV2ID0gdGVtcF9yZXYgLyAoaSArIDEpOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHNjb3JlID0gc2NvcmUgKyB0ZW1wX3JldiAlIDEwOwoKICAgIGlmIChzY29yZSA+IDE1KSB7CiAgICAgICAgMQogICAgfSBlbHNlIHsKICAgICAgICBpZiAoc2NvcmUgPiAwKSB7CiAgICAgICAgICAgIDAKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAtMQogICAgICAgIH0KICAgIH0KfQoKZm4gYW5vdGhlcl9sZXZlbF9vZl9wcm9jZXNzaW5nKGRhdGE6IGkzMiwgZmFjdG9yOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICBsZXQgbXV0IHJlc3VsdDogaTMyID0gZGF0YTsKICAgIHdoaWxlIChpIDwgMTApIHsKICAgICAgICBpZiAoaSAlIDIgPT0gMCkgewogICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgKyAoZmFjdG9yICogaSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0IC0gKGZhY3RvciAqIGkgLyAyKTsKICAgICAgICB9CiAgICAgICAgbGV0IG11dCBqOiBpMzIgPSAwOwogICAgICAgIHdoaWxlIChqIDwgNSkgewogICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgKyBqOwogICAgICAgICAgICBqID0gaiArIDE7CiAgICAgICAgfQogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJlc3VsdAp9CgpmbiB5ZXRfYW5vdGhlcl9mdW5jdGlvbih2YWwxOiBpMzIsIHZhbDI6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgaW50ZXJtZWRpYXRlOiBpMzIgPSBpZiAodmFsMSA+IHZhbDIpIHsKICAgICAgICB2YWwxIC0gdmFsMgogICAgfSBlbHNlIHsKICAgICAgICB2YWwyIC0gdmFsMQogICAgfTsKCiAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICB3aGlsZSAoayA8IDUpIHsKICAgICAgICBpbnRlcm1lZGlhdGUgPSBhbm90aGVyX2xldmVsX29mX3Byb2Nlc3NpbmcoaW50ZXJtZWRpYXRlLCBrICsgMSk7CiAgICAgICAgayA9IGsgKyAxOwogICAgfQoKICAgIGlmIChpbnRlcm1lZGlhdGUgPiAxMDAwKSB7CiAgICAgICAgcmV0dXJuIDEwMDA7CiAgICB9CiAgICBpbnRlcm1lZGlhdGUKfQoKZm4gcHJvY2Vzc19jb21wbGV4X2RhdGEoYTogaTMyLCBiOiBpMzIsIGM6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgcmVzMTogaTMyID0geWV0X2Fub3RoZXJfZnVuY3Rpb24oYSwgYik7CiAgICBsZXQgbXV0IHJlczI6IGkzMiA9IHlldF9hbm90aGVyX2Z1bmN0aW9uKGIsIGMpOwogICAgbGV0IG11dCByZXMzOiBpMzIgPSB5ZXRfYW5vdGhlcl9mdW5jdGlvbihhLCBjKTsKCiAgICBsZXQgbXV0IGZpbmFsX3ZhbDogaTMyID0gcmVzMSArIHJlczIgKyByZXMzOwoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIHdoaWxlIChpIDwgMTApIHsKICAgICAgICBmaW5hbF92YWwgPSBmaW5hbF92YWwgLSBpICogaTsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICBmaW5hbF92YWwKfQoKZm4gc2ltdWxhdGVfZXh0ZXJuYWxfZmFjdG9ycyhjdXJyZW50X3JldjogaTMyKSAtPiBpMzIgewogICAgbGV0IG1hcmtldF9jb25kaXRpb246IGkzMiA9IGN1cnJlbnRfcmV2ICUgNTsKICAgIGlmIChtYXJrZXRfY29uZGl0aW9uID09IDApIHsKICAgICAgICAtNTAwCiAgICB9IGVsc2UgewogICAgICAgIGlmIChtYXJrZXRfY29uZGl0aW9uID09IDEpIHsKICAgICAgICAgICAgMjAwCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKG1hcmtldF9jb25kaXRpb24gPT0gMikgewogICAgICAgICAgICAgICAgMAogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKG1hcmtldF9jb25kaXRpb24gPT0gMykgewogICAgICAgICAgICAgICAgICAgIDEwMDAKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLTEwMAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgpmbiBmaW5hbF9jaGVjayhzdG9ja19hOiBpMzIsIHN0b2NrX2I6IGkzMiwgc3RvY2tfYzogaTMyLCByZXZlbnVlOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHNjb3JlOiBpMzIgPSAwOwogICAgaWYgKHN0b2NrX2EgPiA1MDApIHsKICAgICAgICBzY29yZSA9IHNjb3JlICsgMTsKICAgIH0KICAgIGlmIChzdG9ja19iID4gODAwKSB7CiAgICAgICAgc2NvcmUgPSBzY29yZSArIDE7CiAgICB9CiAgICBpZiAoc3RvY2tfYyA+IDQwMCkgewogICAgICAgIHNjb3JlID0gc2NvcmUgKyAxOwogICAgfQogICAgaWYgKHJldmVudWUgPiAxMDAwMDApIHsKICAgICAgICBzY29yZSA9IHNjb3JlICsgMjsKICAgIH0KICAgIHNjb3JlCn0K", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (49, "comprehensive49", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEFkdmFuY2VkIE1lbW9yeSBNYW5hZ2VtZW50IGFuZCBEYXRhIFN0cnVjdHVyZSBTaW11bGF0aW9uClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpTaW11bGF0aW9uIG9mIGEgY3VzdG9tIG1lbW9yeSBhbGxvY2F0b3Igd2l0aCBibG9jayBzcGxpdHRpbmcgYW5kIG1lcmdpbmcKQ29tcGxleCBwb2ludGVyLWxpa2UgaW50ZWdlciBhcml0aG1ldGljIGZvciBtYW5hZ2luZyBtZW1vcnkgYmxvY2tzCk9wdGltaXphdGlvbiBvZiBtdWx0aS1kaW1lbnNpb25hbCBhcnJheXMgZm9yIHJlcHJlc2VudGluZyBtZW1vcnkgaGVhcHMKRGVlcGx5IG5lc3RlZCBjb25kaXRpb25hbCBsb2dpYyBmb3IgbWVtb3J5IGFsbG9jYXRpb24gYW5kIGRlYWxsb2NhdGlvbiBzdHJhdGVnaWVzCkxvb3AtaGVhdnkgY29kZSBmb3Igc2VhcmNoaW5nIGFuZCBtYW5pcHVsYXRpbmcgbWVtb3J5IGJsb2NrcwpGdW5jdGlvbiBjYWxsIG92ZXJoZWFkIGluIGEgcmVjdXJzaXZlIG1lbW9yeSBtYW5hZ2VtZW50IHNjZW5hcmlvCkVkZ2UgY2FzZXMgaW4gbWVtb3J5IG1hbmFnZW1lbnQsIHN1Y2ggYXMgZnJhZ21lbnRhdGlvbiBhbmQgb3V0LW9mLW1lbW9yeS4KKi8KCi8vIGNvbXByZWhlbnNpdmU0OS5yeCAtIEFkdmFuY2VkIE1lbW9yeSBNYW5hZ2VtZW50IGFuZCBEYXRhIFN0cnVjdHVyZSBTaW11bGF0aW9uCi8vIFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgovLyAtIFNpbXVsYXRpb24gb2YgYSBjdXN0b20gbWVtb3J5IGFsbG9jYXRvciB3aXRoIGJsb2NrIHNwbGl0dGluZyBhbmQgbWVyZ2luZwovLyAtIENvbXBsZXggcG9pbnRlci1saWtlIGludGVnZXIgYXJpdGhtZXRpYyBmb3IgbWFuYWdpbmcgbWVtb3J5IGJsb2NrcwovLyAtIE9wdGltaXphdGlvbiBvZiBtdWx0aS1kaW1lbnNpb25hbCBhcnJheXMgZm9yIHJlcHJlc2VudGluZyBtZW1vcnkgaGVhcHMKLy8gLSBEZWVwbHkgbmVzdGVkIGNvbmRpdGlvbmFsIGxvZ2ljIGZvciBtZW1vcnkgYWxsb2NhdGlvbiBhbmQgZGVhbGxvY2F0aW9uIHN0cmF0ZWdpZXMKLy8gLSBMb29wLWhlYXZ5IGNvZGUgZm9yIHNlYXJjaGluZyBhbmQgbWFuaXB1bGF0aW5nIG1lbW9yeSBibG9ja3MKLy8gLSBGdW5jdGlvbiBjYWxsIG92ZXJoZWFkIGluIGEgcmVjdXJzaXZlIG1lbW9yeSBtYW5hZ2VtZW50IHNjZW5hcmlvCi8vIC0gRWRnZSBjYXNlcyBpbiBtZW1vcnkgbWFuYWdlbWVudCwgc3VjaCBhcyBmcmFnbWVudGF0aW9uIGFuZCBvdXQtb2YtbWVtb3J5LgoKZm4gbWFpbigpIHsKICAgIGxldCBtdXQgbWVtb3J5OiBbaTMyOyAxMDI0XSA9IFswOyAxMDI0XTsKICAgIC8vIGJsb2NrIGZvcm1hdDogW2lzX2ZyZWUsIHNpemUsIHByZXZfYmxvY2tfcHRyLCBuZXh0X2Jsb2NrX3B0cl0KICAgIC8vIGlzX2ZyZWU6IDEgZm9yIGZyZWUsIDAgZm9yIGFsbG9jYXRlZAogICAgbWVtb3J5WzBdID0gMTsKICAgIG1lbW9yeVsxXSA9IDEwMjA7IC8vIHNpemUgb2YgYmxvY2ssIGV4Y2x1ZGluZyBoZWFkZXIKICAgIG1lbW9yeVsyXSA9IC0xOyAvLyBwcmV2CiAgICBtZW1vcnlbM10gPSAtMTsgLy8gbmV4dAoKICAgIGxldCBtdXQgYWxsb2NfcHRyMTogaTMyID0gYWxsb2NhdGUoJm11dCBtZW1vcnksIDI1Nik7CiAgICBwcmludGxuSW50KGFsbG9jX3B0cjEpOwoKICAgIGxldCBtdXQgYWxsb2NfcHRyMjogaTMyID0gYWxsb2NhdGUoJm11dCBtZW1vcnksIDEyOCk7CiAgICBwcmludGxuSW50KGFsbG9jX3B0cjIpOwoKICAgIGxldCBtdXQgYWxsb2NfcHRyMzogaTMyID0gYWxsb2NhdGUoJm11dCBtZW1vcnksIDUxMik7CiAgICBwcmludGxuSW50KGFsbG9jX3B0cjMpOwoKICAgIGRlYWxsb2NhdGUoJm11dCBtZW1vcnksIGFsbG9jX3B0cjIpOwoKICAgIGxldCBtdXQgYWxsb2NfcHRyNDogaTMyID0gYWxsb2NhdGUoJm11dCBtZW1vcnksIDY0KTsKICAgIHByaW50bG5JbnQoYWxsb2NfcHRyNCk7CgogICAgZGVhbGxvY2F0ZSgmbXV0IG1lbW9yeSwgYWxsb2NfcHRyMSk7CiAgICBkZWFsbG9jYXRlKCZtdXQgbWVtb3J5LCBhbGxvY19wdHIzKTsKCiAgICBsZXQgbXV0IGFsbG9jX3B0cjU6IGkzMiA9IGFsbG9jYXRlKCZtdXQgbWVtb3J5LCA3NjgpOwogICAgcHJpbnRsbkludChhbGxvY19wdHI1KTsKCiAgICBsZXQgbXV0IGo6IGkzMiA9IDA7CiAgICB3aGlsZSAoaiA8IDEwKSB7CiAgICAgICAgbGV0IG11dCB0ZW1wX3B0cjogaTMyID0gYWxsb2NhdGUoJm11dCBtZW1vcnksIDEwKTsKICAgICAgICBpZiAodGVtcF9wdHIgPT0gLTEpIHsKICAgICAgICAgICAgLy8gVGhpcyBwYXJ0IG9mIHRoZSBjb2RlIGhhcyBhIGxvZ2ljIGVycm9yLgogICAgICAgICAgICAvLyBUaGUgdmFyaWFibGUgYGFsbG9jX3B0cl9pbnZhbGlkYCBpcyBkZWNsYXJlZCBidXQgbmV2ZXIgdXNlZC4KICAgICAgICAgICAgLy8gQSBkaWZmZXJlbnQgdmFyaWFibGUgYGFsbG9jX3B0cjRgIGlzIGRlYWxsb2NhdGVkIGluc3RlYWQsIHdoaWNoIG1pZ2h0IGJlIGEgYnVnLgogICAgICAgICAgICBsZXQgbXV0IGFsbG9jX3B0cl9pbnZhbGlkOiBpMzIgPSAtMTsKICAgICAgICAgICAgZGVhbGxvY2F0ZSgmbXV0IG1lbW9yeSwgYWxsb2NfcHRyNCk7IC8vIENvbXBpbGUgRXJyb3I6IGBhbGxvY19wdHI0YCBtaWdodCBiZSB1c2VkIGFmdGVyIGRlYWxsb2NhdGlvbgogICAgICAgIH0KICAgICAgICBqID0gaiArIDE7CiAgICB9CgogICAgcHJpbnRfbWVtb3J5X3N0YXRlKCZtdXQgbWVtb3J5KTsKICAgIGV4aXQoMCk7Cn0KCmZuIGFsbG9jYXRlKG1lbW9yeTogJm11dCBbaTMyOyAxMDI0XSwgc2l6ZTogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBjdXJyZW50X3B0cjogaTMyID0gMDsKICAgIGxldCBtdXQgYmVzdF9maXRfcHRyOiBpMzIgPSAtMTsKICAgIGxldCBtdXQgYmVzdF9maXRfc2l6ZTogaTMyID0gMTAyNTsKCiAgICB3aGlsZSAoY3VycmVudF9wdHIgIT0gLTEpIHsKICAgICAgICBsZXQgaXNfZnJlZTogaTMyID0gbWVtb3J5W2N1cnJlbnRfcHRyIGFzIHVzaXplXTsKICAgICAgICBsZXQgYmxvY2tfc2l6ZTogaTMyID0gbWVtb3J5W2N1cnJlbnRfcHRyIGFzIHVzaXplICsgMV07CgogICAgICAgIGlmIChpc19mcmVlID09IDEpIHsKICAgICAgICAgICAgaWYgKGJsb2NrX3NpemUgPj0gc2l6ZSkgewogICAgICAgICAgICAgICAgaWYgKGJsb2NrX3NpemUgPCBiZXN0X2ZpdF9zaXplKSB7CiAgICAgICAgICAgICAgICAgICAgYmVzdF9maXRfc2l6ZSA9IGJsb2NrX3NpemU7CiAgICAgICAgICAgICAgICAgICAgYmVzdF9maXRfcHRyID0gY3VycmVudF9wdHI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY3VycmVudF9wdHIgPSBtZW1vcnlbY3VycmVudF9wdHIgYXMgdXNpemUgKyAzXTsKICAgIH0KCiAgICBpZiAoYmVzdF9maXRfcHRyICE9IC0xKSB7CiAgICAgICAgbGV0IGJsb2NrX3NpemU6IGkzMiA9IG1lbW9yeVtiZXN0X2ZpdF9wdHIgYXMgdXNpemUgKyAxXTsKICAgICAgICBsZXQgcmVtYWluaW5nX3NpemU6IGkzMiA9IGJsb2NrX3NpemUgLSBzaXplIC0gNDsKCiAgICAgICAgaWYgKHJlbWFpbmluZ19zaXplID4gOCkgewogICAgICAgICAgICAvLyBTcGxpdCB0aGUgYmxvY2sKICAgICAgICAgICAgbWVtb3J5W2Jlc3RfZml0X3B0ciBhcyB1c2l6ZSArIDFdID0gc2l6ZTsKICAgICAgICAgICAgbWVtb3J5W2Jlc3RfZml0X3B0ciBhcyB1c2l6ZV0gPSAwOyAvLyBNYXJrIGFzIGFsbG9jYXRlZAoKICAgICAgICAgICAgbGV0IG5ld19ibG9ja19wdHI6IGkzMiA9IGJlc3RfZml0X3B0ciArIHNpemUgKyA0OwogICAgICAgICAgICBtZW1vcnlbbmV3X2Jsb2NrX3B0ciBhcyB1c2l6ZV0gPSAxOyAvLyBpc19mcmVlCiAgICAgICAgICAgIG1lbW9yeVtuZXdfYmxvY2tfcHRyIGFzIHVzaXplICsgMV0gPSByZW1haW5pbmdfc2l6ZTsKICAgICAgICAgICAgbWVtb3J5W25ld19ibG9ja19wdHIgYXMgdXNpemUgKyAyXSA9IGJlc3RfZml0X3B0cjsgLy8gcHJldgogICAgICAgICAgICBtZW1vcnlbbmV3X2Jsb2NrX3B0ciBhcyB1c2l6ZSArIDNdID0gbWVtb3J5W2Jlc3RfZml0X3B0ciBhcyB1c2l6ZSArIDNdOyAvLyBuZXh0CgogICAgICAgICAgICBsZXQgb3JpZ2luYWxfbmV4dF9wdHI6IGkzMiA9IG1lbW9yeVtiZXN0X2ZpdF9wdHIgYXMgdXNpemUgKyAzXTsKICAgICAgICAgICAgaWYgKG9yaWdpbmFsX25leHRfcHRyICE9IC0xKSB7CiAgICAgICAgICAgICAgICBtZW1vcnlbb3JpZ2luYWxfbmV4dF9wdHIgYXMgdXNpemUgKyAyXSA9IG5ld19ibG9ja19wdHI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbWVtb3J5W2Jlc3RfZml0X3B0ciBhcyB1c2l6ZSArIDNdID0gbmV3X2Jsb2NrX3B0cjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBBbGxvY2F0ZSB0aGUgd2hvbGUgYmxvY2sKICAgICAgICAgICAgbWVtb3J5W2Jlc3RfZml0X3B0ciBhcyB1c2l6ZV0gPSAwOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYmVzdF9maXRfcHRyICsgNDsgLy8gUmV0dXJuIHBvaW50ZXIgdG8gZGF0YSBhcmVhCiAgICB9CgogICAgcmV0dXJuIC0xOyAvLyBObyBzdWl0YWJsZSBibG9jayBmb3VuZAp9CgpmbiBkZWFsbG9jYXRlKG1lbW9yeTogJm11dCBbaTMyOyAxMDI0XSwgcHRyOiBpMzIpIHsKICAgIGlmIChwdHIgPCA0KSB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgbGV0IGJsb2NrX3B0cjogaTMyID0gcHRyIC0gNDsKICAgIG1lbW9yeVtibG9ja19wdHIgYXMgdXNpemVdID0gMTsgLy8gTWFyayBhcyBmcmVlCgogICAgLy8gVHJ5IHRvIG1lcmdlIHdpdGggbmV4dCBibG9jawogICAgbGV0IG5leHRfYmxvY2tfcHRyOiBpMzIgPSBtZW1vcnlbYmxvY2tfcHRyIGFzIHVzaXplICsgM107CiAgICBpZiAobmV4dF9ibG9ja19wdHIgIT0gLTEpIHsKICAgICAgICBpZiAobWVtb3J5W25leHRfYmxvY2tfcHRyIGFzIHVzaXplXSA9PSAxKSB7CiAgICAgICAgICAgIGxldCBuZXh0X2Jsb2NrX3NpemU6IGkzMiA9IG1lbW9yeVtuZXh0X2Jsb2NrX3B0ciBhcyB1c2l6ZSArIDFdOwogICAgICAgICAgICBtZW1vcnlbYmxvY2tfcHRyIGFzIHVzaXplICsgMV0gPSBtZW1vcnlbYmxvY2tfcHRyIGFzIHVzaXplICsgMV0gKyBuZXh0X2Jsb2NrX3NpemUgKyA0OwogICAgICAgICAgICBsZXQgbmV4dF9uZXh0X3B0cjogaTMyID0gbWVtb3J5W25leHRfYmxvY2tfcHRyIGFzIHVzaXplICsgM107CiAgICAgICAgICAgIG1lbW9yeVtibG9ja19wdHIgYXMgdXNpemUgKyAzXSA9IG5leHRfbmV4dF9wdHI7CiAgICAgICAgICAgIGlmIChuZXh0X25leHRfcHRyICE9IC0xKSB7CiAgICAgICAgICAgICAgICBtZW1vcnlbbmV4dF9uZXh0X3B0ciBhcyB1c2l6ZSArIDJdID0gYmxvY2tfcHRyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vIFRyeSB0byBtZXJnZSB3aXRoIHByZXYgYmxvY2sKICAgIGxldCBwcmV2X2Jsb2NrX3B0cjogaTMyID0gbWVtb3J5W2Jsb2NrX3B0ciBhcyB1c2l6ZSArIDJdOwogICAgaWYgKHByZXZfYmxvY2tfcHRyICE9IC0xKSB7CiAgICAgICAgaWYgKG1lbW9yeVtwcmV2X2Jsb2NrX3B0ciBhcyB1c2l6ZV0gPT0gMSkgewogICAgICAgICAgICBsZXQgY3VycmVudF9ibG9ja19zaXplOiBpMzIgPSBtZW1vcnlbYmxvY2tfcHRyIGFzIHVzaXplICsgMV07CiAgICAgICAgICAgIG1lbW9yeVtwcmV2X2Jsb2NrX3B0ciBhcyB1c2l6ZSArIDFdID0KICAgICAgICAgICAgICAgIG1lbW9yeVtwcmV2X2Jsb2NrX3B0ciBhcyB1c2l6ZSArIDFdICsgY3VycmVudF9ibG9ja19zaXplICsgNDsKICAgICAgICAgICAgbGV0IG5leHRfcHRyOiBpMzIgPSBtZW1vcnlbYmxvY2tfcHRyIGFzIHVzaXplICsgM107CiAgICAgICAgICAgIG1lbW9yeVtwcmV2X2Jsb2NrX3B0ciBhcyB1c2l6ZSArIDNdID0gbmV4dF9wdHI7CiAgICAgICAgICAgIGlmIChuZXh0X3B0ciAhPSAtMSkgewogICAgICAgICAgICAgICAgbWVtb3J5W25leHRfcHRyIGFzIHVzaXplICsgMl0gPSBwcmV2X2Jsb2NrX3B0cjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKZm4gcHJpbnRfbWVtb3J5X3N0YXRlKG1lbW9yeTogJm11dCBbaTMyOyAxMDI0XSkgewogICAgbGV0IG11dCBjdXJyZW50X3B0cjogaTMyID0gMDsKICAgIGxldCBtdXQgdG90YWxfZnJlZTogaTMyID0gMDsKICAgIGxldCBtdXQgdG90YWxfYWxsb2NhdGVkOiBpMzIgPSAwOwogICAgbGV0IG11dCBudW1fZnJhZ21lbnRzOiBpMzIgPSAwOwoKICAgIHdoaWxlIChjdXJyZW50X3B0ciAhPSAtMSkgewogICAgICAgIGxldCBpc19mcmVlOiBpMzIgPSBtZW1vcnlbY3VycmVudF9wdHIgYXMgdXNpemVdOwogICAgICAgIGxldCBibG9ja19zaXplOiBpMzIgPSBtZW1vcnlbY3VycmVudF9wdHIgYXMgdXNpemUgKyAxXTsKCiAgICAgICAgaWYgKGlzX2ZyZWUgPT0gMSkgewogICAgICAgICAgICB0b3RhbF9mcmVlID0gdG90YWxfZnJlZSArIGJsb2NrX3NpemU7CiAgICAgICAgICAgIG51bV9mcmFnbWVudHMgPSBudW1fZnJhZ21lbnRzICsgMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0b3RhbF9hbGxvY2F0ZWQgPSB0b3RhbF9hbGxvY2F0ZWQgKyBibG9ja19zaXplOwogICAgICAgIH0KICAgICAgICBjdXJyZW50X3B0ciA9IG1lbW9yeVtjdXJyZW50X3B0ciBhcyB1c2l6ZSArIDNdOwogICAgfQogICAgcHJpbnRsbkludCh0b3RhbF9mcmVlKTsKICAgIHByaW50bG5JbnQodG90YWxfYWxsb2NhdGVkKTsKICAgIHByaW50bG5JbnQobnVtX2ZyYWdtZW50cyk7Cn0KCmZuIGRlZXBfcmVjdXJzaXZlX2NoZWNrKG1lbW9yeTogJm11dCBbaTMyOyAxMDI0XSwgZGVwdGg6IGkzMiwgcHRyOiBpMzIpIC0+IGkzMiB7CiAgICBpZiAoZGVwdGggPD0gMCkgewogICAgICAgIHJldHVybiAxOwogICAgfQogICAgaWYgKHB0ciA9PSAtMSkgewogICAgICAgIHJldHVybiAwOwogICAgfQoKICAgIGlmIChtZW1vcnlbcHRyIGFzIHVzaXplICsgMV0gPiAxMDApIHsKICAgICAgICBkZWVwX3JlY3Vyc2l2ZV9jaGVjayhtZW1vcnksIGRlcHRoIC0gMSwgbWVtb3J5W3B0ciBhcyB1c2l6ZSArIDNdKQogICAgfSBlbHNlIHsKICAgICAgICBkZWVwX3JlY3Vyc2l2ZV9jaGVjayhtZW1vcnksIGRlcHRoIC0gMSwgbWVtb3J5W3B0ciBhcyB1c2l6ZSArIDJdKQogICAgfQp9CgpmbiBhbm90aGVyX3V0aWxpdHlfZnVuY3Rpb24obWVtb3J5OiAmbXV0IFtpMzI7IDEwMjRdLCBzdGFydF9wdHI6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgcDogaTMyID0gc3RhcnRfcHRyOwogICAgbGV0IG11dCBjb3VudDogaTMyID0gMDsKICAgIHdoaWxlIChwICE9IC0xKSB7CiAgICAgICAgaWYgKG1lbW9yeVtwIGFzIHVzaXplXSA9PSAwKSB7CiAgICAgICAgICAgIC8vIGlmIGFsbG9jYXRlZAogICAgICAgICAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICAgICAgICAgIHdoaWxlIChpIDwgbWVtb3J5W3AgYXMgdXNpemUgKyAxXSkgewogICAgICAgICAgICAgICAgLy8gQSBtZWFuaW5nbGVzcyBidXQgY29tcGxleCBjYWxjdWxhdGlvbgogICAgICAgICAgICAgICAgY291bnQgPSBjb3VudCArIG1lbW9yeVsocCArIDQgKyBpKSBhcyB1c2l6ZV0gKiAoaSAlIDMgLSAxKTsKICAgICAgICAgICAgICAgIGkgPSBpICsgMTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwID0gbWVtb3J5W3AgYXMgdXNpemUgKyAzXTsKICAgIH0KICAgIGNvdW50Cn0KCmZuIGNvbXBsZXhfbWVtb3J5X3NjYW4obWVtb3J5OiAmbXV0IFtpMzI7IDEwMjRdKSAtPiBpMzIgewogICAgbGV0IG11dCByZXN1bHQ6IGkzMiA9IDA7CiAgICBsZXQgbXV0IGk6IGkzMiA9IDA7CiAgICB3aGlsZSAoaSA8IDUpIHsKICAgICAgICByZXN1bHQgPSByZXN1bHQgKyBhbm90aGVyX3V0aWxpdHlfZnVuY3Rpb24obWVtb3J5LCBpICogMTApOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KICAgIHJlc3VsdAp9Cg==", 0);
INSERT INTO TestCases (test_case_id, test_case_disp_name, problem_phase, source_code_base64, verdict) VALUES (50, "comprehensive50", 2, "LyoKVGVzdCBQYWNrYWdlOiBTZW1hbnRpYy0yClRlc3QgVGFyZ2V0OiBjb21wcmVoZW5zaXZlCkF1dGhvcjogV2VueGluIFpoZW5nClRpbWU6IDIwMjUtMDgtMTcKVmVyZGljdDogUGFzcwpUZXN0IE5hbWU6IEludHJpY2F0ZSBTdGF0ZSBNYWNoaW5lIGFuZCBQcm90b2NvbCBTaW11bGF0aW9uClN1bW1hcnk6IFRoaXMgdGVzdCBjb21wcmVoZW5zaXZlbHkgZXZhbHVhdGVzIGNvbXBpbGVyIG9wdGltaXphdGlvbnMgZm9yOgpEZXRhaWxzOgpTdGF0ZSB0cmFuc2l0aW9uIGxvZ2ljIGluIGEgY29tcGxleCwgbXVsdGktc3RhdGUgZmluaXRlIGF1dG9tYXRvbgpPcHRpbWl6YXRpb24gb2YgYXJyYXkgbG9va3VwcyBmb3Igc3RhdGUgdHJhbnNpdGlvbiB0YWJsZXMKQnJhbmNoIHByZWRpY3Rpb24gZm9yIGhhbmRsaW5nIHZhcmlvdXMgaW5wdXQgZXZlbnRzIGFuZCBzdGF0ZSBjaGFuZ2VzCkRlZXBseSBuZXN0ZWQgZnVuY3Rpb24gY2FsbHMgZm9yIHByb2Nlc3NpbmcgcHJvdG9jb2wgbWVzc2FnZXMKSW50ZWdlciBhcml0aG1ldGljIGZvciBjaGVja3N1bXMgYW5kIHNlcXVlbmNlIG51bWJlciB2YWxpZGF0aW9uCkxvb3Agb3B0aW1pemF0aW9uIGZvciBwcm9jZXNzaW5nIHN0cmVhbXMgb2YgaW5wdXQgZGF0YQpIYW5kbGluZyBvZiBlcnJvciBzdGF0ZXMgYW5kIHJlY292ZXJ5IHBhdGhzIGluIHRoZSBzdGF0ZSBtYWNoaW5lLgoqLwoKLy8gY29tcHJlaGVuc2l2ZTUwLnJ4IC0gSW50cmljYXRlIFN0YXRlIE1hY2hpbmUgYW5kIFByb3RvY29sIFNpbXVsYXRpb24KLy8gVGhpcyB0ZXN0IGNvbXByZWhlbnNpdmVseSBldmFsdWF0ZXMgY29tcGlsZXIgb3B0aW1pemF0aW9ucyBmb3I6Ci8vIC0gU3RhdGUgdHJhbnNpdGlvbiBsb2dpYyBpbiBhIGNvbXBsZXgsIG11bHRpLXN0YXRlIGZpbml0ZSBhdXRvbWF0b24KLy8gLSBPcHRpbWl6YXRpb24gb2YgYXJyYXkgbG9va3VwcyBmb3Igc3RhdGUgdHJhbnNpdGlvbiB0YWJsZXMKLy8gLSBCcmFuY2ggcHJlZGljdGlvbiBmb3IgaGFuZGxpbmcgdmFyaW91cyBpbnB1dCBldmVudHMgYW5kIHN0YXRlIGNoYW5nZXMKLy8gLSBEZWVwbHkgbmVzdGVkIGZ1bmN0aW9uIGNhbGxzIGZvciBwcm9jZXNzaW5nIHByb3RvY29sIG1lc3NhZ2VzCi8vIC0gSW50ZWdlciBhcml0aG1ldGljIGZvciBjaGVja3N1bXMgYW5kIHNlcXVlbmNlIG51bWJlciB2YWxpZGF0aW9uCi8vIC0gTG9vcCBvcHRpbWl6YXRpb24gZm9yIHByb2Nlc3Npbmcgc3RyZWFtcyBvZiBpbnB1dCBkYXRhCi8vIC0gSGFuZGxpbmcgb2YgZXJyb3Igc3RhdGVzIGFuZCByZWNvdmVyeSBwYXRocyBpbiB0aGUgc3RhdGUgbWFjaGluZS4KCmZuIG1haW4oKSB7CiAgICBsZXQgbXV0IHN0YXRlOiBpMzIgPSAwOyAvLyAwOiBJRExFLCAxOiBDT05ORUNUSU5HLCAyOiBDT05ORUNURUQsIDM6IERJU0NPTk5FQ1RJTkcsIDQ6IEVSUk9SCiAgICBsZXQgbXV0IHNlcXVlbmNlX251bWJlcjogaTMyID0gMDsKICAgIGxldCBtdXQgbGFzdF9hY2s6IGkzMiA9IC0xOwogICAgbGV0IG11dCByZXRyYW5zbWlzc2lvbl9jb3VudDogaTMyID0gMDsKCiAgICBsZXQgbXV0IGlucHV0X3N0cmVhbTogW2kzMjsgNjBdID0gWzA7IDYwXTsKICAgIGxldCBtdXQgaTogdXNpemUgPSAwOwogICAgd2hpbGUgKGkgPCA2MCkgewogICAgICAgIGlucHV0X3N0cmVhbVtpIGFzIHVzaXplXSA9IGkgYXMgaTMyICUgODsKICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICAvLyBFdmVudCB0eXBlczogMDogUkVRX0NPTk5FQ1QsIDE6IEFDS19DT05ORUNULCAyOiBEQVRBLCAzOiBBQ0tfREFUQSwgNDogUkVRX0RJU0NPTk5FQ1QsIDU6IEFDS19ESVNDT05ORUNULCA2OiBUSU1FT1VULCA3OiBDT1JSVVBUX0RBVEEKCiAgICBpID0gMDsKICAgIHdoaWxlIChpIDwgNjApIHsKICAgICAgICBsZXQgZXZlbnQ6IGkzMiA9IGlucHV0X3N0cmVhbVtpIGFzIHVzaXplXTsKICAgICAgICBsZXQgbXV0IHBheWxvYWQ6IGkzMiA9ICBpIGFzIGkzMiAqIDEwOwoKICAgICAgICBzdGF0ZSA9IHByb2Nlc3NfZXZlbnQoc3RhdGUsIGV2ZW50LCBwYXlsb2FkLCBzZXF1ZW5jZV9udW1iZXIsIGxhc3RfYWNrLCByZXRyYW5zbWlzc2lvbl9jb3VudCk7CgogICAgICAgIGlmIChzdGF0ZSA9PSAxKSB7IC8vIENPTk5FQ1RJTkcKICAgICAgICAgICAgc2VxdWVuY2VfbnVtYmVyID0gMDsKICAgICAgICAgICAgbGFzdF9hY2sgPSAtMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoc3RhdGUgPT0gMikgeyAvLyBDT05ORUNURUQKICAgICAgICAgICAgICAgIGlmIChldmVudCA9PSAyKSB7IC8vIERBVEEKICAgICAgICAgICAgICAgICAgICBzZXF1ZW5jZV9udW1iZXIgPSBzZXF1ZW5jZV9udW1iZXIgKyAxOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQgPT0gMykgeyAvLyBBQ0tfREFUQQogICAgICAgICAgICAgICAgICAgICAgICBsYXN0X2FjayA9IHBheWxvYWQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKHN0YXRlID09IDQpIHsgLy8gRVJST1IKICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGEgY29tcGlsZSBlcnJvci4gVGhlIHZhcmlhYmxlIGBuZXdfc3RhdGVgIGlzIGRlZmluZWQgaW4gYSBkaWZmZXJlbnQgc2NvcGUuCiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGludGVudGlvbiBtaWdodCBiZSB0byByZXNldCB0aGUgc3RhdGUsIGJ1dCBpdCdzIGFjY2Vzc2luZyBhbiBvdXQtb2Ytc2NvcGUgdmFyaWFibGUuCiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSAwOyAvLyBDb21waWxlIEVycm9yOiBgbmV3X3N0YXRlYCBpcyBub3QgZGVmaW5lZCBpbiB0aGlzIHNjb3BlCiAgICAgICAgICAgICAgICAgICAgcmV0cmFuc21pc3Npb25fY291bnQgPSAwOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAobGFzdF9hY2sgPCBzZXF1ZW5jZV9udW1iZXIgLSA1KSB7CiAgICAgICAgICAgIHJldHJhbnNtaXNzaW9uX2NvdW50ID0gcmV0cmFuc21pc3Npb25fY291bnQgKyAxOwogICAgICAgICAgICBpZiAocmV0cmFuc21pc3Npb25fY291bnQgPiAzKSB7CiAgICAgICAgICAgICAgICBzdGF0ZSA9IDQ7IC8vIEVSUk9SCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcHJpbnRsbkludChzdGF0ZSk7CiAgICAgICAgaSA9IGkgKyAxOwogICAgfQogICAgZXhpdCgwKTsKfQoKZm4gcHJvY2Vzc19ldmVudChjdXJyZW50X3N0YXRlOiBpMzIsIGV2ZW50OiBpMzIsIHBheWxvYWQ6IGkzMiwgc2VxOiBpMzIsIGFjazogaTMyLCByZXRfY291bnQ6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgbmV3X3N0YXRlOiBpMzIgPSBjdXJyZW50X3N0YXRlOwoKICAgIGlmIChjdXJyZW50X3N0YXRlID09IDApIHsgLy8gSURMRQogICAgICAgIGlmIChldmVudCA9PSAwKSB7IC8vIFJFUV9DT05ORUNUCiAgICAgICAgICAgIG5ld19zdGF0ZSA9IDE7IC8vIENPTk5FQ1RJTkcKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgIGlmIChjdXJyZW50X3N0YXRlID09IDEpIHsgLy8gQ09OTkVDVElORwogICAgICAgICAgICBpZiAoZXZlbnQgPT0gMSkgeyAvLyBBQ0tfQ09OTkVDVAogICAgICAgICAgICAgICAgbmV3X3N0YXRlID0gMjsgLy8gQ09OTkVDVEVECiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoZXZlbnQgPT0gNikgeyAvLyBUSU1FT1VUCiAgICAgICAgICAgICAgICAgICAgbmV3X3N0YXRlID0gMDsgLy8gSURMRQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKGN1cnJlbnRfc3RhdGUgPT0gMikgeyAvLyBDT05ORUNURUQKICAgICAgICAgICAgICAgIGlmIChldmVudCA9PSAyKSB7IC8vIERBVEEKICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWRhdGVfY2hlY2tzdW0ocGF5bG9hZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJvY2VzcyBkYXRhCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgbmV3X3N0YXRlID0gNDsgLy8gRVJST1IKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmIChldmVudCA9PSAzKSB7IC8vIEFDS19EQVRBCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXlsb2FkID4gYWNrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGUgd2luZG93CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQgPT0gNCkgeyAvLyBSRVFfRElTQ09OTkVDVAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3X3N0YXRlID0gMzsgLy8gRElTQ09OTkVDVElORwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50ID09IDcpIHsgLy8gQ09SUlVQVF9EQVRBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3X3N0YXRlID0gNDsgLy8gRVJST1IKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChjdXJyZW50X3N0YXRlID09IDMpIHsgLy8gRElTQ09OTkVDVElORwogICAgICAgICAgICAgICAgICAgIGlmIChldmVudCA9PSA1KSB7IC8vIEFDS19ESVNDT05ORUNUCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld19zdGF0ZSA9IDA7IC8vIElETEUKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQgPT0gNikgeyAvLyBUSU1FT1VUCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdfc3RhdGUgPSAwOyAvLyBJRExFCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50X3N0YXRlID09IDQpIHsgLy8gRVJST1IKICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW4gYSByZWFsIHNjZW5hcmlvLCB0aGlzIG1pZ2h0IHRyaWdnZXIgYSByZXNldC4KICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGVyZSwgd2UganVzdCBzdGF5IGluIHRoZSBlcnJvciBzdGF0ZS4KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gY29tcGxleF9zdGF0ZV9sb2dpYyhuZXdfc3RhdGUsIGV2ZW50LCBwYXlsb2FkKTsKfQoKZm4gdmFsaWRhdGVfY2hlY2tzdW0ocGF5bG9hZDogaTMyKSAtPiBib29sIHsKICAgIC8vIEEgc2ltcGxlLCBidXQgcG90ZW50aWFsbHkgcGVyZm9ybWFuY2UtaW50ZW5zaXZlIGNoZWNrc3VtIGxvZ2ljCiAgICBsZXQgbXV0IGNoZWNrc3VtOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAxOwogICAgd2hpbGUgKGkgPD0gcGF5bG9hZCkgewogICAgICAgIGlmIChwYXlsb2FkICUgaSA9PSAwKSB7CiAgICAgICAgICAgIGNoZWNrc3VtID0gY2hlY2tzdW0gKyBpOwogICAgICAgIH0KICAgICAgICBpID0gaSArIDE7CiAgICB9CiAgICByZXR1cm4gY2hlY2tzdW0gJSAyID09IDA7Cn0KCmZuIGNvbXBsZXhfc3RhdGVfbG9naWMoc3RhdGU6IGkzMiwgZXZlbnQ6IGkzMiwgcGF5bG9hZDogaTMyKSAtPiBpMzIgewogICAgbGV0IG11dCBmaW5hbF9zdGF0ZTogaTMyID0gc3RhdGU7CiAgICBpZiAoZXZlbnQgPT0gNikgeyAvLyBUSU1FT1VUCiAgICAgICAgaWYgKHN0YXRlID09IDIpIHsgLy8gQ09OTkVDVEVECiAgICAgICAgICAgIGZpbmFsX3N0YXRlID0gcGVyZm9ybV9yZWNvdmVyeShzdGF0ZSwgcGF5bG9hZCk7CiAgICAgICAgfQogICAgfQoKICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgIGxldCBtdXQgdGVtcF92YWw6IGkzMiA9IHBheWxvYWQ7CiAgICB3aGlsZSAoaSA8IDUpIHsKICAgICAgICB0ZW1wX3ZhbCA9IHRlbXBfdmFsIC8gKGkgKyAyKSArIGkgKiBpOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBpZiAodGVtcF92YWwgJSAxMCA9PSAwKSB7CiAgICAgICAgaWYgKGZpbmFsX3N0YXRlICE9IDQpIHsKICAgICAgICAgICAgZmluYWxfc3RhdGUgPSA0OyAvLyBFUlJPUgogICAgICAgIH0KICAgIH0KICAgIHJldHVybiBmaW5hbF9zdGF0ZTsKfQoKZm4gcGVyZm9ybV9yZWNvdmVyeShzdGF0ZTogaTMyLCBwYXlsb2FkOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IHJlY292ZXJ5X3Njb3JlOiBpMzIgPSAwOwogICAgbGV0IG11dCBpOiBpMzIgPSAwOwogICAgd2hpbGUgKGkgPCAxMCkgewogICAgICAgIHJlY292ZXJ5X3Njb3JlID0gcmVjb3Zlcnlfc2NvcmUgKyAocGF5bG9hZCAlIChpICsgMSkpOwogICAgICAgIGkgPSBpICsgMTsKICAgIH0KCiAgICBpZiAocmVjb3Zlcnlfc2NvcmUgPiAyMCkgewogICAgICAgIHJldHVybiBzdGF0ZTsgLy8gUmVjb3Zlcnkgc3VjY2Vzc2Z1bAogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gNDsgLy8gUmVjb3ZlcnkgZmFpbGVkLCBnbyB0byBFUlJPUiBzdGF0ZQogICAgfQp9CgpmbiBhbm90aGVyX2xheWVyX29mX3Byb3RvY29sKGV2ZW50OiBpMzIsIGRhdGE6IGkzMikgLT4gaTMyIHsKICAgIGxldCBtdXQgcmVzdWx0OiBpMzIgPSBkYXRhOwogICAgaWYgKGV2ZW50ID09IDIpIHsgLy8gREFUQQogICAgICAgIGxldCBtdXQgaTogaTMyID0gMDsKICAgICAgICB3aGlsZSAoaSA8IDUpIHsKICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICsgaTsKICAgICAgICAgICAgaSA9IGkgKyAxOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGV2ZW50ID09IDMpIHsgLy8gQUNLX0RBVEEKICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0IC0gMTA7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHJlc3VsdDsKfQoKZm4geWV0X2Fub3RoZXJfcHJvdG9jb2xfZnVuY3Rpb24odmFsMTogaTMyLCB2YWwyOiBpMzIpIC0+IGkzMiB7CiAgICBsZXQgbXV0IGludGVybWVkaWF0ZTogaTMyID0gdmFsMSArIHZhbDI7CiAgICBsZXQgbXV0IGs6IGkzMiA9IDA7CiAgICB3aGlsZSAoayA8IDMpIHsKICAgICAgICBpbnRlcm1lZGlhdGUgPSBhbm90aGVyX2xheWVyX29mX3Byb3RvY29sKGssIGludGVybWVkaWF0ZSk7CiAgICAgICAgayA9IGsgKyAxOwogICAgfQogICAgcmV0dXJuIGludGVybWVkaWF0ZTsKfQoKZm4gcHJvY2Vzc19jb21wbGV4X3BhY2tldChhOiBpMzIsIGI6IGkzMiwgYzogaTMyKSAtPiBpMzIgewogICAgbGV0IHJlczE6IGkzMiA9IHlldF9hbm90aGVyX3Byb3RvY29sX2Z1bmN0aW9uKGEsIGIpOwogICAgbGV0IHJlczI6IGkzMiA9IHlldF9hbm90aGVyX3Byb3RvY29sX2Z1bmN0aW9uKGIsIGMpOwogICAgbGV0IHJlczM6IGkzMiA9IHlldF9hbm90aGVyX3Byb3RvY29sX2Z1bmN0aW9uKGEsIGMpOwogICAgcmVzMSAtIHJlczIgKyByZXMzCn0K", 0);
